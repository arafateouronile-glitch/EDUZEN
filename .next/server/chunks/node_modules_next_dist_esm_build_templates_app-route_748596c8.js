module.exports=[126151,e=>{"use strict";var t=e.i(747909),i=e.i(174017),n=e.i(996250),o=e.i(759756),s=e.i(561916),r=e.i(174677),l=e.i(869741),a=e.i(316795),p=e.i(487718),d=e.i(995169),x=e.i(47587),g=e.i(666012),c=e.i(570101),u=e.i(626937),m=e.i(10372),f=e.i(193695);e.i(52474);var h=e.i(257297),y=e.i(89171),b=e.i(15638);let v=`
  <div style="width: 100%; padding: 10px 0 10px 0; margin-bottom: 12px; font-family: 'Times New Roman', Times, serif;">
    <table cellpadding="0" cellspacing="0" style="width: 100%; border: 0; table-layout: fixed;">
      <tr>
        <td style="width: 70%; vertical-align: top; padding-right: 15px; border: 0; text-align: left;">
          <p style="font-weight: bold; font-size: 7.5pt; font-family: 'Times New Roman', Times, serif; margin: 0 0 3px 0; color: #1A1A1A; line-height: 1.2;">
            {ecole_nom}
          </p>
          <p style="font-size: 7.5pt; font-family: 'Times New Roman', Times, serif; color: #666; margin: 1px 0; line-height: 1.3;">
            {ecole_adresse}
          </p>
          <p style="font-size: 7.5pt; font-family: 'Times New Roman', Times, serif; color: #666; margin: 1px 0; line-height: 1.3;">
            {ecole_code_postal} {ecole_ville}
          </p>
          <p style="font-size: 7.5pt; font-family: 'Times New Roman', Times, serif; color: #666; margin: 1px 0; line-height: 1.3;">
            Email : {ecole_email}
          </p>
          <p style="font-size: 7.5pt; font-family: 'Times New Roman', Times, serif; color: #666; margin: 1px 0; line-height: 1.3;">
            Tel : {ecole_telephone}
          </p>
        </td>
        <td style="width: 30%; vertical-align: top; border: 0; text-align: right;">
          {ecole_logo}
        </td>
      </tr>
    </table>
  </div>
`,A=`
  <div style="padding: 8px 0 6px 0; margin-top: 10px; background-color: #FAFAFA; font-family: 'Times New Roman', Times, serif;">
    <p style="font-size: 7pt; font-family: 'Times New Roman', Times, serif; color: #1A1A1A; margin: 0; text-align: center; font-weight: 500; line-height: 1.3;">
      {ecole_nom} | {ecole_adresse} {ecole_ville} {ecole_code_postal} | Num\xe9ro SIRET: {ecole_siret}
    </p>
    <p style="font-size: 7pt; font-family: 'Times New Roman', Times, serif; color: #666; margin: 2px 0 0 0; text-align: center; line-height: 1.2;">
      Num\xe9ro de d\xe9claration d'activit\xe9: {ecole_numero_declaration} <em>(aupr\xe8s du pr\xe9fet de r\xe9gion de: {ecole_region})</em>
    </p>
    <p style="font-size: 7pt; font-family: 'Times New Roman', Times, serif; color: #888; font-style: italic; margin: 2px 0 0 0; text-align: center; line-height: 1.2;">
      Cet enregistrement ne vaut pas l'agr\xe9ment de l'\xc9tat.
    </p>
  </div>
`;function z(e,t){return`
    <div style="margin-top: 40px;">
      <p style="text-align: center; margin-bottom: 25px; font-size: 10pt;">
        Fait \xe0 {ecole_ville}, le {date_jour}
      </p>
      
      <div style="display: flex; justify-content: space-between;">
        <div style="width: 45%; text-align: center;">
          <p style="font-weight: bold; margin-bottom: 50px; font-size: 10pt;">${e}</p>
          <p style="margin-bottom: 8px; font-size: 10pt;">{ecole_nom}</p>
          <div style="border-top: 1px solid #1A1A1A; margin: 0 auto; width: 80%; padding-top: 8px;">
            <p style="font-size: 9pt; color: #666;">Signature</p>
          </div>
        </div>
        <div style="width: 45%; text-align: center;">
          <p style="font-weight: bold; margin-bottom: 50px; font-size: 10pt;">${t}</p>
          <p style="margin-bottom: 8px; font-size: 10pt;">{eleve_nom} {eleve_prenom}</p>
          <div style="border-top: 1px solid #1A1A1A; margin: 0 auto; width: 80%; padding-top: 8px;">
            <p style="font-size: 9pt; color: #666;">Signature</p>
          </div>
        </div>
      </div>
    </div>
  `}let _={convention:{type:"convention",name:"Contrat de formation professionnelle",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 25px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;">
          Contrat de formation professionnelle
        </h1>
        <p style="font-size: 9pt; color: #666; margin: 0; font-style: italic;">
          (Article L. 6353-1 du Code du Travail D\xe9cret N\xb0 2018-1341 du 28 d\xe9cembre 2018)
        </p>
      </div>

      <div style="margin-bottom: 25px;">
        <p style="font-weight: bold; margin: 0 0 12px 0; font-size: 11pt;">Entre l'organisme de formation : {ecole_nom}</p>
        <p style="margin: 0 0 3px 0; font-size: 10pt;">immatricul\xe9e au RCS de sous le num\xe9ro {ecole_siret}</p>
        <p style="margin: 0 0 10px 0; font-size: 10pt;">Dont le si\xe8ge social est situ\xe9 {ecole_adresse} {ecole_code_postal} {ecole_ville}.</p>
        
        <p style="margin: 12px 0 0 0; font-size: 10pt;">
          Repr\xe9sent\xe9e aux fins des pr\xe9sentes par {ecole_representant} en sa qualit\xe9 de repr\xe9sentant, d\xfbment habilit\xe9(e).
        </p>
        <p style="margin: 5px 0 0 0; font-size: 10pt;">
          D\xe9claration d'activit\xe9 n\xb0{ecole_numero_declaration} aupr\xe8s de la pr\xe9fecture de la r\xe9gion {ecole_region}.
        </p>
        
        <p style="margin: 15px 0 5px 0; font-weight: bold; font-style: italic; font-size: 10pt;">
          Ci-apr\xe8s d\xe9nomm\xe9e \xab l'Organisme de Formation \xbb
        </p>
        
        <p style="margin: 20px 0 10px 0; font-weight: bold; font-size: 11pt;">D'une part</p>
        
        <p style="margin: 20px 0 10px 0; font-weight: bold; font-size: 11pt;">Et {eleve_prenom} {eleve_nom}</p>
        
        <p style="margin: 15px 0 5px 0; font-weight: bold; font-style: italic; font-size: 10pt;">
          Ci-apr\xe8s d\xe9nomm\xe9e \xab le B\xe9n\xe9ficiaire \xbb
        </p>
        
        <p style="margin: 20px 0 10px 0; font-weight: bold; font-size: 11pt;">D'autre part</p>
        
        <p style="margin: 20px 0 15px 0; font-style: italic; font-size: 10pt;">
          Ci-apr\xe8s individuellement ou collectivement d\xe9sign\xe9(s) la ou les \xab Partie(s) \xbb
        </p>
      </div>

      <p style="text-align: justify; line-height: 1.6; margin: 20px 0; font-size: 10pt;">
        Il est conclu un contrat de formation professionnelle conform\xe9ment aux dispositions des articles L. 6311-1 \xe0 L. 6363-2 du Code du Travail, et 
        \xe9galement en application des dispositions du Livre III de la 6\xe8me partie et des cat\xe9gories pr\xe9vues \xe0 l'article L6313.1 du Code du Travail relatif \xe0 la 
        formation professionnelle continue tout au long de la vie
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">1. Objet du contrat</h2>
      <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
        Aux termes du pr\xe9sent contrat, l'Organisme de Formation s'engage \xe0 organiser l'action de formation suivante :
      </p>
      <p style="font-weight: bold; font-size: 11pt; margin: 10px 0;">{formation_nom} DU {session_debut} au {session_fin}</p>
      
      <p style="margin: 10px 0 5px 0; font-size: 10pt;">
        Cat\xe9gorie de l'action de formation (art. L6313-1 du code du travail) :<br/>
        <strong>Action de formation</strong>
      </p>
      
      <p style="margin: 15px 0 8px 0; font-size: 10pt;">
        Dipl\xf4me vis\xe9 : <strong>Certification (dont CQP) ou habilitation enregistr\xe9e au R\xe9pertoire National des Certifications Professionnelles (RNCP)</strong>
      </p>
      
      <p style="margin: 15px 0 5px 0; font-size: 10pt;">Objectifs : {formation_objectifs}</p>
      <p style="margin: 5px 0; font-size: 10pt;">Contenu de l'action de formation et moyens pr\xe9vus : Annexe 1</p>
      <p style="margin: 5px 0; font-size: 10pt;">Dur\xe9e : <strong>{formation_duree}</strong></p>
      <p style="margin: 5px 0; font-size: 10pt;">Lieu de la formation : <strong>{session_lieu}</strong></p>
      <p style="margin: 5px 0; font-size: 10pt;">Effectifs form\xe9s : <strong>{session_effectif}</strong></p>

      <table style="width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 10pt;">
        <thead>
          <tr style="background-color: #F3F4F6;">
            <th style="padding: 8px; text-align: left; border: 1px solid #E5E7EB; font-weight: bold;">Date</th>
            <th style="padding: 8px; text-align: center; border: 1px solid #E5E7EB; font-weight: bold;">Heure</th>
            <th style="padding: 8px; text-align: right; border: 1px solid #E5E7EB; font-weight: bold;">Lieu</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding: 8px; border: 1px solid #E5E7EB;">du {session_debut} au {session_fin}</td>
            <td style="padding: 8px; text-align: center; border: 1px solid #E5E7EB;">en pr\xe9sentiel</td>
            <td style="padding: 8px; text-align: right; border: 1px solid #E5E7EB;">en pr\xe9sentiel</td>
          </tr>
        </tbody>
      </table>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">2. Effectif form\xe9</h2>
      
      <p style="font-size: 10pt; margin: 0 0 10px 0;"><strong>Public vis\xe9 au sens de l'article L 6313-3 du Code du Travail :</strong></p>
      <ul style="margin: 10px 0 10px 20px; font-size: 10pt; line-height: 1.6;">
        <li>les actions de formation ont pour objet de permettre \xe0 toute personne sans qualification professionnelle ou sans contrat de travail d'acc\xe9der dans les meilleures conditions \xe0 un emploi</li>
        <li>favoriser l'adaptation des travailleurs \xe0 leur poste de travail, \xe0 l'\xe9volution des emplois ainsi que leur maintien dans l'emploi et de participer au d\xe9veloppement des comp\xe9tences en lien ou non avec leur poste de travail. Elles peuvent permettre \xe0 des travailleurs d'acqu\xe9rir une qualification plus \xe9lev\xe9e</li>
        <li>r\xe9duire, pour les travailleurs dont l'emploi est menac\xe9, les risques r\xe9sultant d'une qualification inadapt\xe9e \xe0 l'\xe9volution des techniques et des structures des entreprises, en les pr\xe9parant \xe0 une mutation d'activit\xe9 soit dans le cadre, soit en dehors de leur entreprise. Elles peuvent permettre \xe0 des salari\xe9s dont le contrat de travail est rompu d'acc\xe9der \xe0 des emplois exigeant une qualification diff\xe9rente, ou \xe0 des non-salari\xe9s d'acc\xe9der \xe0 de nouvelles activit\xe9s professionnelles</li>
        <li>favoriser la mobilit\xe9 professionnelle.</li>
      </ul>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">3. Prix de la formation</h2>
      <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
        En contrepartie de cette action de formation, le b\xe9n\xe9ficiaire (ou le financeur dans le cadre d'une subrogation de paiement) s'acquittera des co\xfbts 
        suivants qui couvrent l'int\xe9gralit\xe9 des frais engag\xe9s par l'organisme de formation pour cette session :
      </p>
      
      <table style="width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 10pt;">
        <thead>
          <tr style="background-color: #F3F4F6;">
            <th style="padding: 8px; text-align: left; border: 1px solid #E5E7EB; font-weight: bold;">Description</th>
            <th style="padding: 8px; text-align: right; border: 1px solid #E5E7EB; font-weight: bold;">Prix</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding: 8px; border: 1px solid #E5E7EB;">Formation</td>
            <td style="padding: 8px; text-align: right; border: 1px solid #E5E7EB;">{montant_ttc}‚Ç¨</td>
          </tr>
        </tbody>
      </table>
      
      <p style="margin: 10px 0 5px 0; font-size: 10pt;">L'organisme de formation atteste \xeatre exon\xe9r\xe9 de TVA.</p>
      <p style="margin: 5px 0; font-size: 10pt; font-weight: bold;">TOTAL NET DE TAXES : {montant_ttc}‚Ç¨</p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">4. Modalit\xe9s de d\xe9roulement (pr\xe9sentiel, \xe0 distance, mixte, en situation de travail) et de suivi</h2>
      <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
        La Formation s'effectue Formation pr\xe9sentielle.
      </p>
      <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
        Des feuilles de pr\xe9sence seront sign\xe9es par les Stagiaires et le(s) formateur(s) par demi-journ\xe9e de formation, l'objectif \xe9tant de justifier la 
        r\xe9alisation de la Formation.
      </p>
      <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
        L'appr\xe9ciation des r\xe9sultats se fera \xe0 travers la mise en ≈ìuvre QCM et/ou grilles d'\xe9valuation et/ou travaux pratiques et/ou fiches d'\xe9valuation 
        et/ou mises en situation et/ou autre.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">5. Moyens de sanction (dipl\xf4me, titre professionnel, certification, attestation de fin de formation ou autres)</h2>
      <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
        \xc0 l'issue de la Formation, l'Organisme de Formation d\xe9livre au Stagiaire le {diplome_ou_certification} en cas de r\xe9ussite.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">6. D\xe9dit ou abandon</h2>
      <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
        En cas de d\xe9dit par le B\xe9n\xe9ficiaire \xe0 moins de 7 jours francs avant le d\xe9but de l'action mentionn\xe9e \xe0 l'article 1, ou d'abandon en cours de 
        Formation par un ou plusieurs Stagiaire(s), l'Organisme de Formation (i) remboursera sur le co\xfbt total, les sommes qu'il n'aura pas r\xe9ellement 
        d\xe9pens\xe9es ou engag\xe9es pour la r\xe9alisation de ladite action et/ou (ii) proposera une nouvelle date de Formation.
      </p>
      <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
        Le cas \xe9ch\xe9ant, le B\xe9n\xe9ficiaire s'engage au versement d'un montant de 20 % du co\xfbt total de la Formation \xe0 titre de d\xe9dommagement, cette 
        somme ne pouvant faire l'objet d'un financement par fonds publics ou paritaires.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">7. Modalit\xe9s de r\xe8glement</h2>
      <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
        Le paiement sera d\xfb en totalit\xe9 \xe0 r\xe9ception d'une facture \xe9mise par l'Organisme de Formation \xe0 destination du B\xe9n\xe9ficiaire.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">8. Propri\xe9t\xe9 intellectuelle</h2>
      <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
        Les supports de formation, quelle qu'en soit la forme, et les contenus de toute nature (textes, images, visuels, musiques, logos, marques, base de 
        donn\xe9es, etc.) exploit\xe9s par l'Organisme de Formation dans le cadre de l'action de formation sont prot\xe9g\xe9s par tous droits de propri\xe9t\xe9 
        intellectuelle ou droits des producteurs de bases de donn\xe9es en vigueur. Tous d\xe9sassemblages, d\xe9compilations, d\xe9cryptages, extractions, 
        r\xe9utilisations, copies et plus g\xe9n\xe9ralement, tous actes de reproduction, repr\xe9sentation, diffusion et utilisation de l'un quelconque de ces 
        \xe9l\xe9ments, en tout ou partie, sans l'autorisation de l'Organisme de Formation sont strictement interdits et pourront faire l'objet de poursuites 
        judiciaires.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">9. Donn\xe9es \xe0 caract\xe8re personnel</h2>
      <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
        L'Organisme de Formation pratique une politique de protection des donn\xe9es personnelles dont les caract\xe9ristiques sont explicit\xe9es dans la 
        politique de confidentialit\xe9.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">10. Diff\xe9rents \xe9ventuels</h2>
      <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
        Si une contestation ou un diff\xe9rend ne peuvent \xeatre r\xe9gl\xe9s \xe0 l'amiable, le Tribunal de {ecole_ville} sera seul comp\xe9tent pour r\xe9gler le litige.
      </p>

      <p style="text-align: center; margin: 30px 0 20px 0; font-size: 10pt;">
        Document r\xe9alis\xe9 en 2 exemplaires \xe0 {ecole_ville}, le {date_jour}.
      </p>

      <div style="margin-top: 40px;">
        <p style="text-align: center; margin-bottom: 25px; font-size: 10pt;">
          Pour l'organisme de formation,
        </p>
        
        <div style="display: flex; justify-content: space-between;">
          <div style="width: 45%; text-align: center;">
            <p style="font-weight: bold; margin-bottom: 50px; font-size: 10pt;">Pour l'Organisme de Formation</p>
            <p style="margin-bottom: 8px; font-size: 10pt;">{ecole_nom}</p>
            <div style="border-top: 1px solid #1A1A1A; margin: 0 auto; width: 80%; padding-top: 8px;">
              <p style="font-size: 9pt; color: #666;">Signature</p>
            </div>
          </div>
          <div style="width: 45%; text-align: center;">
            <p style="font-weight: bold; margin-bottom: 50px; font-size: 10pt;">Pour le B\xe9n\xe9ficiaire</p>
            <p style="margin-bottom: 8px; font-size: 10pt;">{eleve_nom} {eleve_prenom}</p>
            <div style="border-top: 1px solid #1A1A1A; margin: 0 auto; width: 80%; padding-top: 8px;">
              <p style="font-size: 9pt; color: #666;">Signature</p>
            </div>
          </div>
        </div>
      </div>

      <div style="page-break-before: always; margin-top: 40px;">
        <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Annexe 1 : Programme de formation</h2>
        <p style="font-size: 10pt; margin: 0 0 10px 0;"><strong>Nom de la session :</strong> {formation_nom} DU {session_debut} au {session_fin}</p>
        
        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">DUR\xc9E ET LIEU DE FORMATION</h3>
        <ul style="margin: 10px 0 20px 20px; font-size: 10pt; line-height: 1.6;">
          <li>Dur\xe9e en heures : {formation_duree}</li>
          <li>Lieu : {session_lieu}</li>
        </ul>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">PUBLIC CONCERN\xc9</h3>
        <p style="font-size: 10pt; margin: 0 0 20px 0;">{formation_public_concerne}</p>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">PR\xc9REQUIS</h3>
        <div style="font-size: 10pt; margin: 0 0 20px 0;">
          {formation_prerequis}
        </div>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">QUALIT\xc9 ET INDICATEURS DE R\xc9SULTATS</h3>
        <p style="font-size: 10pt; margin: 0 0 20px 0;">{formation_qualite_et_resultats}</p>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">ACCESSIBILIT\xc9</h3>
        <p style="font-size: 10pt; margin: 0 0 20px 0;">Formation accessible aux personnes en situation de handicap. Pour toutes demandes d'adaptation, veuillez contacter notre r\xe9f\xe9rent handicap.</p>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">OBJECTIFS</h3>
        <div style="font-size: 10pt; margin: 0 0 20px 0;">
          {formation_objectifs}
        </div>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">CONTENU DE LA FORMATION</h3>
        <div style="font-size: 10pt; margin: 0 0 20px 0;">
          {formation_contenu}
        </div>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">ORGANISATION DE LA FORMATION</h3>
        <ul style="margin: 10px 0 20px 20px; font-size: 10pt; line-height: 1.6;">
          <li><strong>\xc9quipe p\xe9dagogique :</strong> {formation_equipe_pedagogique}</li>
          <li><strong>Ressources p\xe9dagogiques et techniques pr\xe9vues :</strong> {formation_ressources}</li>
          <li>accueil des Stagiaires dans une salle d\xe9di\xe9e \xe0 la formation,</li>
          <li>fourniture des supports de formation : {formation_supports}</li>
        </ul>
      </div>

      <div style="page-break-before: always; margin-top: 40px;">
        <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Annexe 2 : R\xe8glement Int\xe9rieur</h2>
        
        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">Article 1 - Objet et champ d'application</h3>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 15px 0; font-size: 10pt;">
          Conform\xe9ment aux dispositions des articles L.6352-3, L.6352-4 et R.6352-1 \xe0 R.6352-15 du Code du Travail, le pr\xe9sent r\xe8glement a pour objet de 
          d\xe9terminer les principales mesures applicables en mati\xe8re de sant\xe9, de s\xe9curit\xe9 et de discipline aux stagiaires de l'organisme de formation, 
          d\xe9nomm\xe9 ci-apr\xe8s.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 15px 0; font-size: 10pt;">
          Tout stagiaire doit respecter les termes du pr\xe9sent r\xe8glement durant toute la dur\xe9e de l'action de formation.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
          Toutefois, lorsque la formation se d\xe9roule dans une entreprise d\xe9j\xe0 dot\xe9e d'un r\xe8glement int\xe9rieur, les mesures de sant\xe9 et de s\xe9curit\xe9 
          applicables aux stagiaires sont celles de ce r\xe8glement.
        </p>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">Article 2 - Hygi\xe8ne et s\xe9curit\xe9</h3>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Chaque stagiaire doit veiller au respect des consignes g\xe9n\xe9rales et particuli\xe8res en mati\xe8re d'hygi\xe8ne et de s\xe9curit\xe9, sous peine de sanctions 
          disciplinaires.
        </p>
        <p style="font-size: 10pt; margin: 10px 0 5px 0; font-weight: bold;">Propret\xe9 des locaux</p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Les stagiaires doivent maintenir en ordre et en \xe9tat de propret\xe9 constante les locaux o\xf9 se d\xe9roule la formation. \xc0 ce titre, il leur est interdit de 
          manger dans les salles de cours.
        </p>
        <p style="font-size: 10pt; margin: 10px 0 5px 0; font-weight: bold;">Alcool et produits stup\xe9fiants</p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          L'introduction et la consommation de produits stup\xe9fiants ou de boissons alcoolis\xe9es est strictement interdite.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Il est \xe9galement interdit de p\xe9n\xe9trer ou de demeurer dans l'\xe9tablissement en \xe9tat d'ivresse ou sous l'emprise de produits stup\xe9fiants.
        </p>
        <p style="font-size: 10pt; margin: 10px 0 5px 0; font-weight: bold;">Consignes de s\xe9curit\xe9 ‚Äì Incendie</p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Les consignes d'incendie et notamment un plan de localisation des extincteurs et des issues de secours sont affich\xe9s dans les locaux de formation 
          de mani\xe8re \xe0 \xeatre connus des stagiaires.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Les stagiaires sont tenu\xb7e\xb7s d'ex\xe9cuter sans d\xe9lai l'ordre d'\xe9vacuation donn\xe9 par l'animateur de la formation ou par un salari\xe9 de l'entreprise o\xf9 
          se d\xe9roule la formation.
        </p>
        <p style="font-size: 10pt; margin: 10px 0 5px 0; font-weight: bold;">Accident - d\xe9claration</p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Tout accident ou incident survenu \xe0 l'occasion ou en cours de formation doit \xeatre imm\xe9diatement d\xe9clar\xe9 par le\xb7la stagiaire accident\xe9\xb7e ou les 
          personnes t\xe9moins de l'accident, \xe0 l'organisme de formation.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Conform\xe9ment \xe0 l'article R. 6342-3 du Code du Travail, l'accident survenu au\xb7\xe0 la stagiaire pendant qu'il\xb7elle se trouve sur le lieu de formation ou 
          pendant qu'il\xb7elle s'y rend ou en revient, fait l'objet d'une d\xe9claration par l'organisme de formation aupr\xe8s de la caisse de s\xe9curit\xe9 sociale.
        </p>
        <p style="font-size: 10pt; margin: 10px 0 5px 0; font-weight: bold;">Interdiction de fumer ou de vapoter</p>
        <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
          Il est interdit de fumer ou de vapoter (utilisation d'une cigarette \xe9lectronique) dans les locaux de formation.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
          Les stagiaires sont toutefois autoris\xe9\xb7e\xb7s pendant leur temps de pause \xe0 aller fumer ou vapoter \xe0 l'ext\xe9rieur de l'\xe9tablissement.
        </p>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">Article 3 ‚Äì Horaires, absences et retards</h3>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Les horaires de la formation seront communiqu\xe9s aux stagiaires au pr\xe9alable. Les stagiaires sont tenu\xb7e\xb7s de respecter ces horaires.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Sauf autorisation express, les stagiaires ne peuvent pas s'absenter pendant les heures de formation. L'\xe9margement devra \xeatre fait au d\xe9but ou \xe0 
          la fin de chaque atelier selon la pratique de l'organisme de formation.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          En cas d'absence ou retard, les stagiaires en informent dans les plus brefs d\xe9lais l'organisme de formation et s'en justifier.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          L'employeur du stagiaire est inform\xe9 des absences dans les meilleurs d\xe9lais qui suivent la connaissance par l'organisme de formation.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
          De plus, pour les stagiaires dont le co\xfbt de la formation est pris en charge par un financeur externe (OPCO, P\xf4le Emploi, Caisse des D\xe9p\xf4ts), les 
          absences non justifi\xe9es entra\xeenent une retenue sur la prise en charge du co\xfbt de la formation, proportionnelle \xe0 la dur\xe9e de l'absence.
        </p>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">Article 4 - Comportement</h3>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Il est demand\xe9 \xe0 tout stagiaire d'avoir un comportement garantissant le respect des r\xe8gles \xe9l\xe9mentaires de savoir vivre, de savoir \xeatre en 
          collectivit\xe9 et le bon d\xe9roulement des formations.
        </p>
        <p style="font-size: 10pt; margin: 10px 0 5px 0; font-weight: bold;">\xc0 titre d'exemple, il est formellement interdit aux stagiaires :</p>
        <ul style="margin: 10px 0 10px 20px; font-size: 10pt; line-height: 1.6;">
          <li>De modifier, d'utiliser \xe0 une fin tierce ou de diffuser les supports de formation sans l'autorisation express de l'organisme de formation ;</li>
          <li>De modifier les r\xe9glages des param\xe8tres de l'ordinateur ;</li>
          <li>D'utiliser leurs t\xe9l\xe9phones portables durant les sessions \xe0 des fins autres que celles de la formation.</li>
        </ul>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">Article 5 : Acc\xe8s aux locaux</h3>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Les stagiaires ont acc\xe8s aux locaux o\xf9 se d\xe9roule la formation exclusivement pour suivre le stage auquel ils\xb7elles sont inscrit\xb7e\xb7s. Ils\xb7elles ne 
          peuvent y entrer ou y demeurer \xe0 d'autres fins, sauf autorisation.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
          Il leur est interdit d'\xeatre accompagn\xe9\xb7e\xb7s de personnes non inscrites au stage.
        </p>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">Article 6 - Utilisation du mat\xe9riel</h3>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Tout\xb7e stagiaire est tenu\xb7e de conserver en bon \xe9tat le mat\xe9riel et la documentation mis \xe0 la disposition par l'organisme de formation.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          L'utilisation du mat\xe9riel \xe0 d'autres fins, notamment personnelles est interdite, sauf pour le mat\xe9riel mis \xe0 disposition \xe0 cet effet.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Il est formellement interdit de diffuser les codes personnels n\xe9cessaires pour se connecter \xe0 l'espace extranet.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          A la fin du stage, le\xb7la stagiaire est tenu\xb7e de restituer tout mat\xe9riel et document en sa possession appartenant \xe0 l'organisme de formation, sauf 
          les documents p\xe9dagogiques distribu\xe9s en cours de formation ou pr\xe9sents sur son extranet.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          La documentation p\xe9dagogique remise lors des sessions de formation est prot\xe9g\xe9e au titre des droits d'auteur et ne peut \xeatre r\xe9utilis\xe9e que pour 
          un strict usage personnel.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
          Il est formellement interdit pour le.la stagiaire, sauf d\xe9rogation expresse, d'enregistrer ou de filmer les sessions de formation.
        </p>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">Article 7 : Vol ou d\xe9gradation des biens personnels des stagiaires</h3>
        <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
          L'organisme de formation d\xe9cline toute responsabilit\xe9 en cas de perte, vol ou d\xe9t\xe9rioration des objets personnels de toute nature d\xe9pos\xe9s par 
          les stagiaires dans les locaux de formation.
        </p>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">Article 8 - Sanctions</h3>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Tout agissement consid\xe9r\xe9 comme fautif pourra, en fonction de sa gravit\xe9, faire l'objet de l'une ou l'autre des sanctions ci-apr\xe8s, sans 
          n\xe9cessairement suivre l'ordre de ce classement :
        </p>
        <ul style="margin: 10px 0 10px 20px; font-size: 10pt; line-height: 1.6;">
          <li>rappel \xe0 l'ordre ;</li>
          <li>avertissement \xe9crit ;</li>
          <li>bl\xe2me ;</li>
          <li>exclusion temporaire de la formation ;</li>
          <li>exclusion d\xe9finitive de la formation.</li>
        </ul>
        <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
          L'organisme de formation informe de la sanction prise le cas \xe9ch\xe9ant : l'employeur du\xb7de la stagiaire ou l'administration de l'agent stagiaire ; 
          et/ou le financeur du stage.
        </p>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">Article 9 - Proc\xe9dure disciplinaire</h3>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          En application de l'article R.6352-4 du Code du Travail, \xab aucune sanction ne peut \xeatre prononc\xe9e \xe0 l'encontre du stagiaire sans que celui-ci ait 
          \xe9t\xe9 inform\xe9 au pr\xe9alable des griefs retenus contre lui \xbb.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Lorsque l'organisme de formation envisage une prise de sanction, il convoque le la stagiaire par lettre recommand\xe9e avec accus\xe9 de r\xe9ception ou 
          remise \xe0 l'int\xe9ress\xe9ÃÅ contre d\xe9charge en lui indiquant l'objet de la convocation, la date, l'heure et le lieu de l'entretien, sauf si la sanction 
          envisag\xe9e n'a pas d'incidence sur la pr\xe9sence du de la stagiaire pour la suite de la formation.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Au cours de l'entretien, le.la stagiaire a la possibilit\xe9 de se faire assister par une personne de son choix, stagiaire ou salari\xe9 de l'organisme de 
          formation. La convocation mentionn\xe9e \xe0 l'article pr\xe9c\xe8dent fait \xe9tat de cette facult\xe9. Lors de l'entretien, le motif de la sanction envisag\xe9e est 
          indiqu\xe9 au \xe0 la stagiaire : celui.celle-ci a alors la possibilit\xe9 de donner toute explication ou justification des faits qui lui sont reproch\xe9s.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Lorsqu'une mesure conservatoire d'exclusion temporaire \xe0 effet imm\xe9diat est consid\xe9r\xe9e comme indispensable par l'organisme de formation, 
          aucune sanction d\xe9finitive relative \xe0 l'agissement fautif \xe0 l'origine de cette exclusion ne peut \xeatre prise sans que le la stagiaire n'ait \xe9t\xe9 au 
          pr\xe9alable inform\xe9 des griefs retenus contre lui elle et, \xe9ventuellement, qu'il elle ait \xe9t\xe9 convoqu\xe9(e) \xe0 un entretien et ait eu la possibilit\xe9ÃÅ de 
          s'expliquer devant un Commission de discipline.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          La sanction ne peut intervenir moins d'un jour franc ni plus de 15 jours apr\xe8s l'entretien o\xf9, le cas \xe9ch\xe9ant, apr\xe8s avis de la Commission de 
          discipline.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
          Elle fait l'objet d'une notification \xe9crite et motiv\xe9e au \xe0 la stagiaire sous forme lettre recommand\xe9e, ou d'une lettre remise contre d\xe9charge.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
          L'organisme de formation informe concomitamment l'employeur, et \xe9ventuellement l'organisme paritaire prenant \xe0 sa charge les frais de 
          formation, de la sanction prise.
        </p>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">Article 10 : Repr\xe9sentation des stagiaires</h3>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Dans les stages d'une dur\xe9e sup\xe9rieure \xe0 500 heures, il est proc\xe9d\xe9 simultan\xe9ment \xe0 l'\xe9lection d'un d\xe9l\xe9gu\xe9 titulaire et d'un d\xe9l\xe9gu\xe9 suppl\xe9ant 
          conform\xe9ment aux dispositions des articles R.6352-9 et suivants du Code du Travail.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Tous les stagiaires sont \xe9lecteurs et \xe9ligibles, sauf les d\xe9tenus admis \xe0 participer \xe0 une action de formation professionnelle.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          L'organisme de formation organise le scrutin qui a lieu pendant les heures de formation, au plus t\xf4t 20 heures, au plus tard 40 heures apr\xe8s le 
          d\xe9but du stage. En cas d'impossibilit\xe9ÃÅ de d\xe9signer les repr\xe9sentants des stagiaires, l'organisme de formation dresse un PV de carence qu'il 
          transmet au pr\xe9fet de r\xe9gion territorialement comp\xe9tent.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Les d\xe9l\xe9gu\xe9s sont \xe9lus pour la dur\xe9e de la formation. Leurs fonctions prennent fin lorsqu'ils cessent, pour quelque cause que ce soit, de participer 
          \xe0 la formation.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;">
          Si le d\xe9l\xe9gu\xe9 titulaire et le d\xe9l\xe9gu\xe9 suppl\xe9ant ont cess\xe9 leurs fonctions avant la fin de la session de formation, il est proc\xe9d\xe9 \xe0 une nouvelle 
          \xe9lection dans les conditions pr\xe9vues aux articles R.6352-9 \xe0 R.6352-12.
        </p>
        <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
          Les repr\xe9sentants des stagiaires font toute suggestion pour am\xe9liorer le d\xe9roulement des stages et les conditions de vie des stagiaires dans 
          l'organisme de formation. Ils pr\xe9sentent toutes les r\xe9clamations individuelles ou collectives relatives \xe0 ces mati\xe8res, aux conditions d'hygi\xe8ne et 
          de s\xe9curit\xe9 ÃÅ et \xe0 l'application du r\xe8glement int\xe9rieur.
        </p>

        <h3 style="font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;">Article 11 : Publicit\xe9</h3>
        <p style="text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;">
          Le pr\xe9sent r\xe8glement est affich\xe9 dans les locaux et sur le site internet de l'organisme de formation. En outre, un exemplaire est remis \xe0 chaque 
          stagiaire.
        </p>

        <p style="margin-top: 30px; font-size: 10pt;">Fait \xe0 {ecole_ville}</p>
        <p style="margin: 5px 0 0 0; font-size: 10pt;">Le {date_jour}</p>
      </div>
    `,footerContent:A},facture:{type:"facture",name:"Facture",headerContent:v,bodyContent:`
      <!-- En-t\xeate Facture Ultra Premium Compact -->
      <div style="margin-bottom: 5px;">
        <table cellpadding="0" cellspacing="0" style="width: 100%; border: 0;">
          <tr>
            <td style="width: 60%; vertical-align: top; border: 0;">
              <div style="background: linear-gradient(135deg, #1E3A5F 0%, #2563EB 100%); color: white; padding: 6px 12px; border-radius: 3px; display: inline-block;">
                <p style="margin: 0; font-size: 16pt; font-weight: 800; letter-spacing: 0.3px; font-family: 'Times New Roman', Times, serif;">FACTURE</p>
              </div>
              <p style="margin: 3px 0 0 0; font-size: 10pt; font-weight: 700; color: #1E3A5F; font-family: 'Times New Roman', Times, serif;">N\xb0 {numero_facture}</p>
            </td>
            <td style="width: 40%; vertical-align: top; border: 0; text-align: right;">
              <table cellpadding="0" cellspacing="0" style="margin-left: auto; border: 0;">
                <tr>
                  <td style="padding: 1px 5px 1px 0; font-size: 6.5pt; color: #64748B; border: 0; text-align: right;">Date d'\xe9mission</td>
                  <td style="padding: 1px 0; font-size: 7.5pt; font-weight: 600; color: #1E293B; border: 0;">{date_emission}</td>
                </tr>
                <tr>
                  <td style="padding: 1px 5px 1px 0; font-size: 6.5pt; color: #64748B; border: 0; text-align: right;">\xc9ch\xe9ance</td>
                  <td style="padding: 1px 0; font-size: 7.5pt; font-weight: 600; color: #DC2626; border: 0;">{date_echeance}</td>
                </tr>
              </table>
            </td>
          </tr>
        </table>
      </div>

      <!-- S\xe9parateur \xe9l\xe9gant -->
      <div style="height: 1px; background: linear-gradient(90deg, #2563EB 0%, #60A5FA 50%, transparent 100%); margin: 4px 0;"></div>

      <!-- Informations Client Ultra Compact -->
      <table cellpadding="0" cellspacing="0" style="width: 100%; margin-bottom: 5px; border: 0;">
        <tr>
          <td style="width: 55%; vertical-align: top; padding-right: 8px; border: 0;">
            <div style="background: #F8FAFC; border-left: 2px solid #2563EB; padding: 4px 8px; border-radius: 0 2px 2px 0;">
              <p style="margin: 0 0 2px 0; font-size: 6pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.3px; color: #64748B;">Factur\xe9 \xe0</p>
              <p style="margin: 0 0 1px 0; font-size: 9pt; font-weight: 700; color: #0F172A;">{eleve_prenom} {eleve_nom}</p>
              <p style="margin: 0 0 1px 0; font-size: 7pt; color: #475569; line-height: 1.15;">{eleve_adresse}</p>
              <p style="margin: 0 0 1px 0; font-size: 7pt; color: #475569; line-height: 1.15;">{eleve_code_postal} {eleve_ville}</p>
              <p style="margin: 0; font-size: 6.5pt; color: #475569; line-height: 1.15;">{eleve_email} | {eleve_telephone}</p>
            </div>
          </td>
          <td style="width: 45%; vertical-align: top; border: 0;">
            <div style="background: #EFF6FF; border: 1px solid #BFDBFE; padding: 4px 8px; border-radius: 2px;">
              <p style="margin: 0 0 2px 0; font-size: 6pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.3px; color: #1D4ED8;">R\xe9f\xe9rence client</p>
              <p style="margin: 0 0 1px 0; font-size: 8.5pt; font-weight: 700; color: #1E40AF;">N\xb0 {eleve_numero}</p>
              <p style="margin: 0; font-size: 7pt; color: #3B82F6; line-height: 1.15;">{formation_nom}</p>
            </div>
          </td>
        </tr>
      </table>

      <!-- Tableau des prestations Ultra Compact -->
      <table cellpadding="0" cellspacing="0" style="width: 100%; margin-bottom: 5px; border-collapse: collapse; font-size: 7.5pt;">
        <thead>
          <tr>
            <th style="padding: 5px 6px; text-align: left; background: linear-gradient(135deg, #1E3A5F 0%, #1E40AF 100%); color: white; font-weight: 600; font-size: 6.5pt; text-transform: uppercase; letter-spacing: 0.2px;">Description</th>
            <th style="padding: 5px 4px; text-align: center; background: linear-gradient(135deg, #1E3A5F 0%, #1E40AF 100%); color: white; font-weight: 600; font-size: 6.5pt; text-transform: uppercase; width: 35px;">Qt\xe9</th>
            <th style="padding: 5px 4px; text-align: right; background: linear-gradient(135deg, #1E3A5F 0%, #1E40AF 100%); color: white; font-weight: 600; font-size: 6.5pt; text-transform: uppercase; width: 65px;">P.U. HT</th>
            <th style="padding: 5px 6px; text-align: right; background: linear-gradient(135deg, #1E3A5F 0%, #1E40AF 100%); color: white; font-weight: 600; font-size: 6.5pt; text-transform: uppercase; width: 65px;">Total HT</th>
          </tr>
        </thead>
        <tbody>
          <tr style="background: #FFFFFF;">
            <td style="padding: 6px; border-bottom: 1px solid #E2E8F0; border-left: 1px solid #E2E8F0;">
              <p style="margin: 0 0 1px 0; font-weight: 600; font-size: 8pt; color: #0F172A;">{formation_nom}</p>
              <p style="margin: 0; font-size: 6.5pt; color: #64748B; line-height: 1.15;">{session_debut} ‚Üí {session_fin} | {formation_duree}</p>
            </td>
            <td style="padding: 6px 4px; text-align: center; border-bottom: 1px solid #E2E8F0; font-weight: 500; color: #334155; font-size: 7.5pt;">1</td>
            <td style="padding: 6px 4px; text-align: right; border-bottom: 1px solid #E2E8F0; font-weight: 500; color: #334155; font-size: 7.5pt;">{montant_ht} ‚Ç¨</td>
            <td style="padding: 6px; text-align: right; border-bottom: 1px solid #E2E8F0; border-right: 1px solid #E2E8F0; font-weight: 700; color: #0F172A; font-size: 7.5pt;">{montant_ht} ‚Ç¨</td>
          </tr>
        </tbody>
      </table>

      <!-- Bloc Totaux Ultra Compact -->
      <table cellpadding="0" cellspacing="0" style="width: 100%; margin-bottom: 5px; border: 0;">
        <tr>
          <td style="width: 50%; vertical-align: top; padding-right: 8px; border: 0;">
            <!-- Montant en lettres -->
            <div style="background: #F0FDF4; border: 1px solid #86EFAC; padding: 4px 8px; border-radius: 2px;">
              <p style="margin: 0 0 1px 0; font-size: 6pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.2px; color: #166534;">Arr\xeat\xe9 \xe0 la somme de</p>
              <p style="margin: 0; font-size: 7.5pt; font-style: italic; color: #15803D; line-height: 1.15;">{montant_lettres}</p>
            </div>
          </td>
          <td style="width: 50%; vertical-align: top; border: 0;">
            <table cellpadding="0" cellspacing="0" style="width: 100%; border-collapse: collapse;">
              <tr>
                <td style="padding: 3px 6px; text-align: right; background: #F8FAFC; font-size: 7pt; color: #64748B; border: 1px solid #E2E8F0;">Sous-total HT</td>
                <td style="padding: 3px 6px; text-align: right; background: #F8FAFC; font-size: 7.5pt; font-weight: 600; color: #334155; border: 1px solid #E2E8F0; width: 70px;">{montant_ht} ‚Ç¨</td>
              </tr>
              <tr>
                <td style="padding: 3px 6px; text-align: right; background: #F8FAFC; font-size: 7pt; color: #64748B; border: 1px solid #E2E8F0;">TVA ({taux_tva}%)</td>
                <td style="padding: 3px 6px; text-align: right; background: #F8FAFC; font-size: 7.5pt; font-weight: 500; color: #334155; border: 1px solid #E2E8F0;">{tva} ‚Ç¨</td>
              </tr>
              <tr>
                <td style="padding: 5px; text-align: right; background: linear-gradient(135deg, #1E3A5F 0%, #1E40AF 100%); color: white; font-size: 8pt; font-weight: 700; border-radius: 0 0 0 2px;">TOTAL TTC</td>
                <td style="padding: 5px; text-align: right; background: linear-gradient(135deg, #1E3A5F 0%, #1E40AF 100%); color: white; font-size: 9.5pt; font-weight: 800; border-radius: 0 0 2px 0;">{montant_ttc} ‚Ç¨</td>
              </tr>
            </table>
          </td>
        </tr>
      </table>

      <!-- Informations de paiement Ultra Compact -->
      <table cellpadding="0" cellspacing="0" style="width: 100%; margin-bottom: 4px; border: 0;">
        <tr>
          <td style="width: 50%; vertical-align: top; padding-right: 4px; border: 0;">
            <div style="background: #FEF3C7; border-left: 2px solid #F59E0B; padding: 4px 8px; border-radius: 0 2px 2px 0;">
              <p style="margin: 0 0 2px 0; font-size: 6.5pt; font-weight: 700; color: #92400E;">üí≥ PAIEMENT</p>
              <p style="margin: 0 0 1px 0; font-size: 6.5pt; color: #78350F; line-height: 1.1;"><strong>Mode:</strong> {mode_paiement}</p>
              <p style="margin: 0; font-size: 6.5pt; color: #78350F; line-height: 1.1;"><strong>IBAN:</strong> {iban}</p>
            </div>
          </td>
          <td style="width: 50%; vertical-align: top; padding-left: 4px; border: 0;">
            <div style="background: #FEF2F2; border-left: 2px solid #EF4444; padding: 4px 8px; border-radius: 0 2px 2px 0;">
              <p style="margin: 0 0 2px 0; font-size: 6.5pt; font-weight: 700; color: #991B1B;">‚ö†Ô∏è RETARD</p>
              <p style="margin: 0; font-size: 6pt; color: #7F1D1D; line-height: 1.1;">Taux \xd7 3 + 40‚Ç¨ (L441-10)</p>
            </div>
          </td>
        </tr>
      </table>

      <!-- Mentions l\xe9gales ultra compactes -->
      <div style="background: #F1F5F9; padding: 3px 8px; border-radius: 2px; margin-top: 3px;">
        <p style="margin: 0; font-size: 6pt; color: #64748B; text-align: center; line-height: 1.2;">
          TVA non applicable (art. 293B CGI) ‚Ä¢ SIRET: {ecole_siret} ‚Ä¢ D\xe9claration: {ecole_numero_declaration}
        </p>
      </div>
    `,footerContent:A},devis:{type:"devis",name:"Devis",headerContent:v,bodyContent:`
      <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 25px;">
        <div style="flex: 1;">
          <h1 style="font-size: 20pt; font-weight: bold; margin: 0; color: #1A1A1A;">DEVIS</h1>
          <p style="font-size: 12pt; margin: 8px 0 0 0; color: #666;">N\xb0 {numero_devis}</p>
        </div>
        <div style="text-align: right;">
          <p style="font-size: 10pt; margin: 0;"><strong>Date d'\xe9mission :</strong> {date_emission}</p>
          <p style="font-size: 10pt; margin: 5px 0;"><strong>Valable jusqu'au :</strong> {validite_devis}</p>
        </div>
      </div>

      <div style="border-top: 1px solid #E5E7EB; margin: 20px 0;"></div>

      <div style="display: flex; justify-content: space-between; margin-bottom: 25px;">
        <div style="width: 48%; padding: 15px; background-color: #F9FAFB; border-left: 3px solid #1A1A1A;">
          <p style="font-weight: bold; margin: 0 0 10px 0; font-size: 10pt; text-transform: uppercase; color: #666;">Devis pour :</p>
          <p style="margin: 0; font-size: 11pt; font-weight: bold;">{eleve_nom} {eleve_prenom}</p>
          <p style="margin: 5px 0; font-size: 10pt; color: #666;">{eleve_adresse}</p>
          <p style="margin: 3px 0; font-size: 10pt; color: #666;">T\xe9l : {eleve_telephone}</p>
          <p style="margin: 3px 0; font-size: 10pt; color: #666;">Email : {eleve_email}</p>
        </div>
      </div>

      <div style="padding: 15px; background-color: #F0F9FF; border-left: 3px solid #0EA5E9; margin-bottom: 20px;">
        <p style="margin: 0; font-size: 11pt; font-weight: 600;">
          Objet : Devis pour la formation "{formation_nom}"
        </p>
        <p style="margin: 8px 0 0 0; font-size: 10pt; color: #333;">{formation_description}</p>
      </div>

      <table style="width: 100%; border-collapse: collapse; margin: 25px 0; font-size: 10pt;">
        <thead>
          <tr style="background-color: #1A1A1A; color: white;">
            <th style="padding: 10px 12px; text-align: left; font-weight: bold;">Description de la formation</th>
            <th style="padding: 10px 12px; text-align: center; font-weight: bold; width: 80px;">Dur\xe9e</th>
            <th style="padding: 10px 12px; text-align: right; font-weight: bold; width: 100px;">Prix HT</th>
            <th style="padding: 10px 12px; text-align: right; font-weight: bold; width: 100px;">Montant HT</th>
          </tr>
        </thead>
        <tbody>
          <tr style="border-bottom: 1px solid #E5E7EB;">
            <td style="padding: 12px;">
              <p style="margin: 0; font-weight: 600;">{formation_nom}</p>
              <p style="margin: 4px 0 0 0; font-size: 9pt; color: #666;">P\xe9riode : {session_debut} au {session_fin}</p>
              <p style="margin: 2px 0 0 0; font-size: 9pt; color: #666;">Lieu : {session_lieu}</p>
            </td>
            <td style="padding: 12px; text-align: center; font-weight: 500;">{formation_duree}</td>
            <td style="padding: 12px; text-align: right; font-weight: 500;">{montant_ht} ‚Ç¨</td>
            <td style="padding: 12px; text-align: right; font-weight: 600;">{montant_ht} ‚Ç¨</td>
          </tr>
        </tbody>
      </table>

      <div style="display: flex; justify-content: flex-end; margin-bottom: 25px;">
        <table style="width: 280px; border-collapse: collapse; font-size: 10pt;">
          <tr style="border-bottom: 1px solid #E5E7EB;">
            <td style="padding: 8px 12px; text-align: right; background-color: #F9FAFB;">Sous-total HT :</td>
            <td style="padding: 8px 12px; text-align: right; background-color: #F9FAFB; font-weight: 600;">{montant_ht} ‚Ç¨</td>
          </tr>
          <tr style="border-bottom: 1px solid #E5E7EB;">
            <td style="padding: 8px 12px; text-align: right; background-color: #F9FAFB;">TVA ({taux_tva}%) :</td>
            <td style="padding: 8px 12px; text-align: right; background-color: #F9FAFB;">{tva} ‚Ç¨</td>
          </tr>
          <tr style="background-color: #1A1A1A; color: white;">
            <td style="padding: 12px; text-align: right; font-weight: bold; font-size: 12pt;">TOTAL TTC :</td>
            <td style="padding: 12px; text-align: right; font-weight: bold; font-size: 12pt;">{montant_ttc} ‚Ç¨</td>
          </tr>
        </table>
      </div>

      <div style="padding: 15px; background-color: #FEF3C7; border-left: 3px solid #F59E0B; margin-bottom: 20px;">
        <p style="margin: 0 0 10px 0; font-size: 10pt; font-weight: 600; color: #92400E;">
          Conditions et validit\xe9 du devis
        </p>
        <ul style="margin: 0 0 0 20px; font-size: 10pt; line-height: 1.6; color: #78350F;">
          <li>Ce devis est valable jusqu'au <strong>{validite_devis}</strong></li>
          <li>Modalit\xe9s de paiement : <strong>{mode_paiement}</strong></li>
          <li>La r\xe9servation est d\xe9finitive apr\xe8s acceptation \xe9crite du pr\xe9sent devis</li>
          <li>En cas d'acceptation, un acompte de 30% peut \xeatre demand\xe9</li>
        </ul>
      </div>

      <div style="padding: 15px; background-color: #F0FDF4; border-left: 3px solid #10B981;">
        <p style="margin: 0; font-size: 10pt; line-height: 1.6; color: #166534;">
          <strong>Pour accepter ce devis :</strong><br/>
          Veuillez retourner ce document sign\xe9 par courrier, email ({ecole_email}) ou directement \xe0 notre secr\xe9tariat 
          avant le {validite_devis}.
        </p>
      </div>

      ${z("L'Organisme de Formation","Le Client (Bon pour accord)")}
    `,footerContent:A},convocation:{type:"convocation",name:"Convocation",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 25px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;">
          CONVOCATION
        </h1>
      </div>

      <div style="margin-bottom: 25px;">
        <p style="font-size: 10pt; margin: 0 0 15px 0;">Madame, Monsieur,</p>
        <p style="font-size: 10pt; margin: 0 0 10px 0; text-align: justify; line-height: 1.6;">
          Nous avons l'honneur de vous convier \xe0 :
        </p>
      </div>

      <div style="padding: 20px; background-color: #F9FAFB; border-left: 3px solid #1A1A1A; margin-bottom: 25px;">
        <p style="margin: 0 0 10px 0; font-size: 10pt;"><strong>Objet :</strong> {convocation_objet}</p>
        <p style="margin: 0 0 10px 0; font-size: 10pt;"><strong>Date :</strong> {convocation_date}</p>
        <p style="margin: 0 0 10px 0; font-size: 10pt;"><strong>Heure :</strong> {convocation_heure}</p>
        <p style="margin: 0 0 10px 0; font-size: 10pt;"><strong>Lieu :</strong> {convocation_lieu}</p>
        <p style="margin: 0 0 10px 0; font-size: 10pt;"><strong>Adresse :</strong> {convocation_adresse}</p>
        <p style="margin: 0; font-size: 10pt;"><strong>Dur\xe9e pr\xe9vue :</strong> {convocation_duree}</p>
      </div>

      <div style="margin-bottom: 25px;">
        <p style="margin: 0 0 8px 0; font-size: 10pt;"><strong>Participant(s) :</strong></p>
        <p style="margin: 0; font-size: 10pt;">{eleve_nom} {eleve_prenom}</p>
        <p style="margin: 5px 0 0 0; font-size: 10pt;">Num\xe9ro d'\xe9l\xe8ve : {eleve_numero}</p>
        <p style="margin: 5px 0 0 0; font-size: 10pt;">Formation : {formation_nom}</p>
      </div>

      <div style="margin-bottom: 25px;">
        <p style="margin: 0 0 8px 0; font-size: 10pt;"><strong>Ordre du jour :</strong></p>
        <div style="margin-left: 15px; font-size: 10pt;">
          {convocation_contenu}
        </div>
      </div>

      <div style="padding: 15px; background-color: #FEF3C7; border-left: 3px solid #F59E0B; margin-bottom: 25px;">
        <p style="margin: 0; font-size: 10pt; font-weight: 600; color: #92400E;">Note importante :</p>
        <p style="margin: 5px 0 0 0; font-size: 10pt; color: #78350F;">
          Veuillez confirmer votre pr\xe9sence avant le {date_confirmation} en r\xe9pondant \xe0 ce message ou en contactant 
          le {ecole_telephone}.
        </p>
      </div>

      <p style="margin: 25px 0 10px 0; font-size: 10pt;">Nous restons \xe0 votre disposition pour tout compl\xe9ment d'information.</p>
      <p style="margin: 10px 0 20px 0; font-size: 10pt;">Cordialement,</p>
      
      <div style="margin-top: 30px;">
        <p style="margin: 0; font-size: 10pt; font-weight: bold;">{ecole_representant}</p>
        <p style="margin: 3px 0; font-size: 10pt;">{ecole_nom}</p>
      </div>

      <p style="margin-top: 25px; font-size: 9pt; color: #666;">
        Fait \xe0 {ecole_ville}, le {date_jour}
      </p>
    `,footerContent:A},contrat:{type:"contrat",name:"Contrat de scolarit√©",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 25px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;">
          CONTRAT DE SCOLARIT\xc9
        </h1>
        <p style="font-size: 11pt; color: #666; margin: 0;">Ann\xe9e scolaire {annee_scolaire}</p>
      </div>

      
    <div style="margin-bottom: 25px;">
      <p style="font-weight: bold; margin: 0 0 12px 0; font-size: 11pt;">Entre l'organisme de formation : {ecole_nom}</p>
      <p style="margin: 0 0 3px 0; font-size: 10pt;">immatricul\xe9e au RCS de sous le num\xe9ro {ecole_siret}</p>
      <p style="margin: 0 0 10px 0; font-size: 10pt;">Dont le si\xe8ge social est situ\xe9 {ecole_adresse} {ecole_code_postal} {ecole_ville}.</p>
      
      <p style="margin: 12px 0 0 0; font-size: 10pt;">
        Repr\xe9sent\xe9e aux fins des pr\xe9sentes par {ecole_representant} en sa qualit\xe9 de repr\xe9sentant, d\xfbment habilit\xe9(e).
      </p>
      <p style="margin: 5px 0 0 0; font-size: 10pt;">
        D\xe9claration d'activit\xe9 n\xb0{ecole_numero_declaration} aupr\xe8s de la pr\xe9fecture de la r\xe9gion .
      </p>
      
      <p style="margin: 15px 0 5px 0; font-weight: bold; font-style: italic; font-size: 10pt;">
        Ci-apr\xe8s d\xe9nomm\xe9e \xab l'Organisme de Formation \xbb
      </p>
      
      <p style="margin: 20px 0 10px 0; font-weight: bold; font-size: 11pt;">D'une part</p>
      
      <p style="margin: 20px 0 10px 0; font-weight: bold; font-size: 11pt;">Et {eleve_prenom} {eleve_nom}</p>
      
      <p style="margin: 15px 0 5px 0; font-weight: bold; font-style: italic; font-size: 10pt;">
        Ci-apr\xe8s d\xe9nomm\xe9e \xab le B\xe9n\xe9ficiaire \xbb
      </p>
      
      <p style="margin: 20px 0 10px 0; font-weight: bold; font-size: 11pt;">D'autre part</p>
      
      <p style="margin: 20px 0 15px 0; font-style: italic; font-size: 10pt;">
        Ci-apr\xe8s individuellement ou collectivement d\xe9sign\xe9(s) la ou les \xab Partie(s) \xbb
      </p>
    </div>
  

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 1 - Inscription et scolarit\xe9</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt;">
        L'\xe9l\xe8ve <strong>{eleve_nom} {eleve_prenom}</strong> est inscrit(e) pour l'ann\xe9e scolaire <strong>{annee_scolaire}</strong> 
        dans la classe <strong>{eleve_classe}</strong> de l'\xe9tablissement <strong>{ecole_nom}</strong>.
      </p>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin-top: 10px;">
        La scolarit\xe9 d\xe9bute le {session_debut} et se termine le {session_fin}. 
        Les cours sont dispens\xe9s selon le calendrier scolaire et les horaires d\xe9finis par l'\xe9tablissement.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 2 - Frais de scolarit\xe9</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt;">
        Les frais de scolarit\xe9 pour l'ann\xe9e scolaire <strong>{annee_scolaire}</strong> s'\xe9l\xe8vent \xe0 
        <strong>{montant_ttc} ‚Ç¨</strong> (en toutes lettres : {montant_lettres}).
      </p>
      <p style="margin: 15px 0 5px 0; font-size: 10pt;"><strong>Modalit\xe9s de paiement :</strong></p>
      <p style="font-size: 10pt; margin: 0;">{mode_paiement}</p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 3 - Obligations de l'\xe9l\xe8ve</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt;">L'\xe9l\xe8ve s'engage \xe0 :</p>
      <ul style="margin: 10px 0 10px 20px; font-size: 10pt; line-height: 1.6;">
        <li>Suivre assid\xfbment tous les cours et activit\xe9s p\xe9dagogiques</li>
        <li>Respecter le r\xe8glement int\xe9rieur de l'\xe9tablissement</li>
        <li>Acquitter les frais de scolarit\xe9 dans les d\xe9lais convenus</li>
        <li>Participer activement aux \xe9valuations</li>
      </ul>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 4 - Engagements de l'\xe9tablissement</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt;">L'\xe9tablissement s'engage \xe0 :</p>
      <ul style="margin: 10px 0 10px 20px; font-size: 10pt; line-height: 1.6;">
        <li>Dispenser un enseignement de qualit\xe9 conforme aux programmes</li>
        <li>Fournir les moyens p\xe9dagogiques n\xe9cessaires</li>
        <li>Assurer le suivi p\xe9dagogique et l'\xe9valuation des acquis</li>
        <li>D\xe9livrer les documents administratifs n\xe9cessaires</li>
      </ul>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 5 - R\xe9siliation</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt;">
        Le pr\xe9sent contrat peut \xeatre r\xe9sili\xe9 par l'une ou l'autre des parties, sous r\xe9serve d'un pr\xe9avis d'un mois. 
        En cas de r\xe9siliation par l'\xe9l\xe8ve ou sa famille, les frais de scolarit\xe9 dus pour la p\xe9riode d\xe9j\xe0 \xe9coul\xe9e 
        restent acquis \xe0 l'\xe9tablissement.
      </p>

      ${z("L'√âtablissement","L'√âl√®ve / Repr√©sentant l√©gal")}
    `,footerContent:A},attestation_reussite:{type:"attestation_reussite",name:"Attestation de r√©ussite",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 30px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;">
          ATTESTATION DE R\xc9USSITE
        </h1>
      </div>

      <div style="margin-bottom: 25px;">
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;">
          Le directeur de <strong>{ecole_nom}</strong>, \xe9tablissement situ\xe9 \xe0 <strong>{ecole_adresse}</strong>,
        </p>
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;">
          <strong>ATTESTE</strong> que <strong>{eleve_nom} {eleve_prenom}</strong>, n\xe9(e) le 
          <strong>{eleve_date_naissance}</strong>, num\xe9ro d'\xe9l\xe8ve <strong>{eleve_numero}</strong>,
        </p>
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;">
          a suivi avec <strong>assiduit\xe9</strong> et a <strong>r\xe9ussi</strong> la formation intitul\xe9e 
          <strong>"{formation_nom}"</strong>
        </p>
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0;">
          qui s'est d\xe9roul\xe9e du <strong>{session_debut}</strong> au <strong>{session_fin}</strong> 
          (dur\xe9e : {formation_duree}).
        </p>
      </div>

      <div style="padding: 15px; background-color: #F0F9FF; border-left: 3px solid #0EA5E9; margin-bottom: 25px;">
        <p style="margin: 0; font-size: 10pt; font-weight: bold;">R\xe9sultats :</p>
        <p style="margin: 8px 0 0 0; font-size: 10pt;">Moyenne g\xe9n\xe9rale : <strong>{moyenne}/20</strong></p>
        <p style="margin: 5px 0 0 0; font-size: 10pt;">Mention : <strong>{mention}</strong></p>
        <p style="margin: 5px 0 0 0; font-size: 10pt;">Classement : <strong>{classement}</strong></p>
      </div>

      <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 30px 0;">
        La pr\xe9sente attestation est d\xe9livr\xe9e \xe0 l'int\xe9ress\xe9(e) pour servir et valoir ce que de droit.
      </p>

      <div style="margin-top: 50px; text-align: right;">
        <p style="margin: 0; font-size: 10pt;">Fait \xe0 {ecole_ville}, le {date_jour}</p>
        <div style="margin-top: 40px;">
          <p style="margin: 0; font-weight: bold; font-size: 10pt;">{ecole_representant}</p>
          <p style="margin: 3px 0 0 0; font-size: 10pt;">Directeur</p>
          <div style="border-top: 1px solid #1A1A1A; margin: 30px 0 0 auto; width: 180px; padding-top: 8px; text-align: center;">
            <p style="font-size: 9pt; color: #666; margin: 0;">Signature et cachet</p>
          </div>
        </div>
      </div>
    `,footerContent:A},certificat_scolarite:{type:"certificat_scolarite",name:"Certificat de scolarit√©",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 30px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;">
          CERTIFICAT DE SCOLARIT\xc9
        </h1>
        <p style="font-size: 11pt; color: #666; margin: 0;">Ann\xe9e scolaire {annee_scolaire}</p>
      </div>

      <div style="margin-bottom: 25px;">
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;">
          Le directeur de <strong>{ecole_nom}</strong>, \xe9tablissement situ\xe9 \xe0 <strong>{ecole_adresse}</strong>,
        </p>
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;">
          <strong>CERTIFIE</strong> que <strong>{eleve_nom} {eleve_prenom}</strong>, n\xe9(e) le 
          <strong>{eleve_date_naissance}</strong>, num\xe9ro d'\xe9l\xe8ve <strong>{eleve_numero}</strong>,
        </p>
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;">
          est r\xe9guli\xe8rement inscrit(e) dans cet \xe9tablissement pour l'ann\xe9e scolaire <strong>{annee_scolaire}</strong>,
        </p>
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0;">
          en classe de <strong>{eleve_classe}</strong>.
        </p>
      </div>

      <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 40px 0;">
        Le pr\xe9sent certificat est d\xe9livr\xe9 \xe0 l'int\xe9ress\xe9(e) pour servir et valoir ce que de droit.
      </p>

      <div style="margin-top: 50px; text-align: right;">
        <p style="margin: 0; font-size: 10pt;">Fait \xe0 {ecole_ville}, le {date_jour}</p>
        <div style="margin-top: 40px;">
          <p style="margin: 0; font-weight: bold; font-size: 10pt;">{ecole_representant}</p>
          <p style="margin: 3px 0 0 0; font-size: 10pt;">Directeur</p>
          <div style="border-top: 1px solid #1A1A1A; margin: 30px 0 0 auto; width: 180px; padding-top: 8px; text-align: center;">
            <p style="font-size: 9pt; color: #666; margin: 0;">Signature et cachet</p>
          </div>
        </div>
      </div>
    `,footerContent:A},releve_notes:{type:"releve_notes",name:"Relev√© de notes",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 25px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;">
          RELEV\xc9 DE NOTES
        </h1>
        <p style="font-size: 11pt; color: #666; margin: 0;">Ann\xe9e scolaire {annee_scolaire} - {trimestre}</p>
      </div>

      <div style="padding: 15px; background-color: #F9FAFB; border-left: 3px solid #1A1A1A; margin-bottom: 25px;">
        <table style="width: 100%; border-collapse: collapse; font-size: 10pt;">
          <tr><td style="padding: 4px 0; width: 150px; font-weight: 600;">Nom :</td><td style="padding: 4px 0; font-weight: bold;">{eleve_nom}</td></tr>
          <tr><td style="padding: 4px 0; font-weight: 600;">Pr\xe9nom :</td><td style="padding: 4px 0; font-weight: bold;">{eleve_prenom}</td></tr>
          <tr><td style="padding: 4px 0; font-weight: 600;">Num\xe9ro d'\xe9l\xe8ve :</td><td style="padding: 4px 0;">{eleve_numero}</td></tr>
          <tr><td style="padding: 4px 0; font-weight: 600;">Classe :</td><td style="padding: 4px 0;">{eleve_classe}</td></tr>
        </table>
      </div>

      <table style="width: 100%; border-collapse: collapse; margin: 25px 0; font-size: 10pt;">
        <thead>
          <tr style="background-color: #1A1A1A; color: white;">
            <th style="padding: 10px 12px; text-align: left; font-weight: bold;">Mati\xe8re</th>
            <th style="padding: 10px 12px; text-align: center; font-weight: bold; width: 70px;">Coeff.</th>
            <th style="padding: 10px 12px; text-align: center; font-weight: bold; width: 80px;">Note /20</th>
            <th style="padding: 10px 12px; text-align: left; font-weight: bold;">Appr\xe9ciation</th>
          </tr>
        </thead>
        <tbody>
          <tr style="border-bottom: 1px solid #E5E7EB; background-color: #FAFAFA;">
            <td style="padding: 10px 12px; font-weight: 500;">{matiere_1}</td>
            <td style="padding: 10px 12px; text-align: center;">{coef_1}</td>
            <td style="padding: 10px 12px; text-align: center; font-weight: bold;">{note_1}</td>
            <td style="padding: 10px 12px; font-size: 9pt; color: #666;">{appreciation_1}</td>
          </tr>
          <tr style="border-bottom: 1px solid #E5E7EB;">
            <td style="padding: 10px 12px; font-weight: 500;">{matiere_2}</td>
            <td style="padding: 10px 12px; text-align: center;">{coef_2}</td>
            <td style="padding: 10px 12px; text-align: center; font-weight: bold;">{note_2}</td>
            <td style="padding: 10px 12px; font-size: 9pt; color: #666;">{appreciation_2}</td>
          </tr>
          <tr style="border-bottom: 1px solid #E5E7EB; background-color: #FAFAFA;">
            <td style="padding: 10px 12px; font-weight: 500;">{matiere_3}</td>
            <td style="padding: 10px 12px; text-align: center;">{coef_3}</td>
            <td style="padding: 10px 12px; text-align: center; font-weight: bold;">{note_3}</td>
            <td style="padding: 10px 12px; font-size: 9pt; color: #666;">{appreciation_3}</td>
          </tr>
        </tbody>
      </table>

      <div style="display: flex; justify-content: space-between; padding: 15px; background-color: #F0F9FF; border-left: 3px solid #0EA5E9; margin-bottom: 25px;">
        <div style="flex: 1;">
          <p style="margin: 0 0 8px 0; font-size: 11pt;">
            <strong>Moyenne g\xe9n\xe9rale :</strong> <span style="font-size: 14pt; font-weight: bold;">{moyenne}/20</span>
          </p>
          <p style="margin: 0 0 5px 0; font-size: 10pt; color: #666;">Moyenne de la classe : {moyenne_classe}/20</p>
          <p style="margin: 0; font-size: 10pt; color: #666;">Classement : {classement} sur {effectif_classe} \xe9l\xe8ves</p>
        </div>
        <div style="text-align: right; padding-left: 20px;">
          <div style="padding: 10px 15px; background-color: #FEF3C7; border-radius: 4px; display: inline-block;">
            <p style="margin: 0; font-size: 9pt; font-weight: 600; color: #92400E; text-transform: uppercase;">Mention</p>
            <p style="margin: 4px 0 0 0; font-size: 12pt; font-weight: bold; color: #78350F;">{mention}</p>
          </div>
        </div>
      </div>

      <div style="padding: 15px; background-color: #F9FAFB; border-left: 3px solid #1A1A1A; margin-bottom: 25px;">
        <p style="font-weight: bold; margin: 0 0 10px 0; font-size: 10pt;">Appr\xe9ciation g\xe9n\xe9rale :</p>
        <p style="text-align: justify; line-height: 1.6; font-size: 10pt; color: #333; margin: 0;">
          {appreciations}
        </p>
      </div>

      <div style="margin-top: 40px; text-align: right;">
        <p style="margin: 0; font-size: 10pt;">Fait \xe0 {ecole_ville}, le {date_jour}</p>
        <div style="margin-top: 30px;">
          <p style="margin: 0; font-weight: bold; font-size: 10pt;">{ecole_representant}</p>
          <p style="margin: 3px 0 0 0; font-size: 10pt;">Directeur</p>
        </div>
      </div>
    `,footerContent:A},attestation_entree:{type:"attestation_entree",name:"Attestation d'entr√©e en formation",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 30px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;">
          ATTESTATION D'ENTR\xc9E EN FORMATION
        </h1>
      </div>

      <div style="margin-bottom: 25px;">
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;">
          Le directeur de <strong>{ecole_nom}</strong>, \xe9tablissement situ\xe9 \xe0 <strong>{ecole_adresse}</strong>,
        </p>
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;">
          <strong>ATTESTE</strong> que <strong>{eleve_nom} {eleve_prenom}</strong>, n\xe9(e) le 
          <strong>{eleve_date_naissance}</strong>, num\xe9ro d'\xe9l\xe8ve <strong>{eleve_numero}</strong>,
        </p>
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;">
          a \xe9t\xe9 admis(e) et s'est inscrit(e) dans la formation intitul\xe9e <strong>"{formation_nom}"</strong>
        </p>
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0;">
          qui d\xe9butera le <strong>{session_debut}</strong> et se terminera le <strong>{session_fin}</strong> 
          (dur\xe9e : {formation_duree}).
        </p>
      </div>

      <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 40px 0;">
        La pr\xe9sente attestation est d\xe9livr\xe9e \xe0 l'int\xe9ress\xe9(e) pour servir et valoir ce que de droit, 
        notamment pour l'\xe9tablissement des droits sociaux et administratifs.
      </p>

      <div style="margin-top: 50px; text-align: right;">
        <p style="margin: 0; font-size: 10pt;">Fait \xe0 {ecole_ville}, le {date_jour}</p>
        <div style="margin-top: 40px;">
          <p style="margin: 0; font-weight: bold; font-size: 10pt;">{ecole_representant}</p>
          <p style="margin: 3px 0 0 0; font-size: 10pt;">Directeur</p>
          <div style="border-top: 1px solid #1A1A1A; margin: 30px 0 0 auto; width: 180px; padding-top: 8px; text-align: center;">
            <p style="font-size: 9pt; color: #666; margin: 0;">Signature et cachet</p>
          </div>
        </div>
      </div>
    `,footerContent:A},reglement_interieur:{type:"reglement_interieur",name:"R√®glement int√©rieur",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 25px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;">
          R\xc8GLEMENT INT\xc9RIEUR
        </h1>
        <p style="font-size: 11pt; color: #666; margin: 0;">Ann\xe9e scolaire {annee_scolaire}</p>
      </div>

      <div style="margin-bottom: 25px;">
        <h2 style="font-size: 12pt; font-weight: bold; margin: 0 0 12px 0; color: #1A1A1A;">PR\xc9AMBULE</h2>
        <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
          Le pr\xe9sent r\xe8glement int\xe9rieur a pour objet de fixer les r\xe8gles de vie collective applicables 
          \xe0 tous les membres de la communaut\xe9 \xe9ducative de <strong>{ecole_nom}</strong>. Il s'applique 
          \xe0 l'ensemble des personnes pr\xe9sentes dans l'\xe9tablissement.
        </p>
      </div>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 1 : Principes g\xe9n\xe9raux</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        L'\xe9tablissement <strong>{ecole_nom}</strong> a pour mission de dispenser un enseignement de qualit\xe9 
        dans le respect des valeurs de la R\xe9publique : libert\xe9, \xe9galit\xe9, fraternit\xe9, la\xefcit\xe9.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 2 : Horaires</h2>
      <ul style="margin: 10px 0 10px 20px; font-size: 10pt; line-height: 1.6;">
        <li>Horaires d'ouverture : {horaires_ouverture}</li>
        <li>Horaires des cours : {horaires_cours}</li>
        <li>Les \xe9l\xe8ves doivent arriver \xe0 l'heure et assister \xe0 tous les cours</li>
        <li>Tout retard ou absence doit \xeatre justifi\xe9</li>
      </ul>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 3 : Assiduit\xe9</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        L'assiduit\xe9 est obligatoire pour tous les cours et activit\xe9s p\xe9dagogiques. 
        Les absences doivent \xeatre signal\xe9es et justifi\xe9es dans les meilleurs d\xe9lais.
        En cas d'absences r\xe9p\xe9t\xe9es et non justifi\xe9es, l'\xe9tablissement se r\xe9serve le droit de prendre 
        les mesures appropri\xe9es.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 4 : Comportement</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        Les \xe9l\xe8ves doivent adopter un comportement respectueux envers tous les membres de la communaut\xe9 
        \xe9ducative et se conformer aux r\xe8gles de politesse et de civilit\xe9.
        Tout acte de violence, de harc\xe8lement ou de discrimination est strictement interdit et peut 
        donner lieu \xe0 des sanctions disciplinaires.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 5 : Sanctions disciplinaires</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        En cas de manquement au r\xe8glement int\xe9rieur, des sanctions peuvent \xeatre prononc\xe9es selon 
        la gravit\xe9 des faits : avertissement, exclusion temporaire ou d\xe9finitive.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 6 : Hygi\xe8ne et s\xe9curit\xe9</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        Les consignes de s\xe9curit\xe9 affich\xe9es dans l'\xe9tablissement doivent \xeatre respect\xe9es.
        L'usage du tabac, de l'alcool et de toute substance illicite est strictement interdit.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 7 : Publicit\xe9</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        Le pr\xe9sent r\xe8glement est affich\xe9 dans les locaux et sur le site internet de l'organisme de formation. En outre, un exemplaire est remis \xe0 chaque 
        stagiaire.
      </p>

      <div style="margin-top: 40px;">
        <p style="margin: 0; font-size: 10pt;">Fait \xe0 {ecole_ville}</p>
        <p style="margin: 5px 0 0 0; font-size: 10pt;">Le {date_jour}</p>
      </div>
    `,footerContent:A},cgv:{type:"cgv",name:"Conditions G√©n√©rales de Vente",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 25px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;">
          CONDITIONS G\xc9N\xc9RALES DE VENTE
        </h1>
        <p style="font-size: 11pt; color: #666; margin: 0;">{ecole_nom}</p>
      </div>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 1 - Objet</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        Les pr\xe9sentes Conditions G\xe9n\xe9rales de Vente (CGV) r\xe9gissent les relations contractuelles entre 
        <strong>{ecole_nom}</strong> et ses clients dans le cadre de la vente de formations et de services \xe9ducatifs.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 2 - Commandes</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        Toute commande de formation implique l'acceptation sans r\xe9serve des pr\xe9sentes CGV. 
        La commande devient ferme et d\xe9finitive apr\xe8s acceptation de l'\xe9tablissement.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 3 - Prix</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        Les prix des formations sont indiqu\xe9s en euros TTC. Ils sont fermes et non r\xe9visables pendant 
        la dur\xe9e de validit\xe9 indiqu\xe9e sur le devis.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 4 - Modalit\xe9s de paiement</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        Le paiement s'effectue selon les modalit\xe9s d\xe9finies dans le contrat ou le devis accept\xe9. 
        En cas de retard de paiement, des p\xe9nalit\xe9s de retard au taux de 3 fois le taux l\xe9gal 
        peuvent \xeatre appliqu\xe9es.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 5 - Droit de r\xe9tractation</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        Conform\xe9ment \xe0 la l\xe9gislation en vigueur, le client dispose d'un d\xe9lai de 14 jours calendaires 
        pour exercer son droit de r\xe9tractation \xe0 compter de l'acceptation de la commande.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 6 - Annulation</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        En cas d'annulation par le client, des frais d'annulation peuvent \xeatre appliqu\xe9s selon 
        les conditions pr\xe9vues dans le contrat. L'\xe9tablissement se r\xe9serve le droit d'annuler 
        une formation en cas d'insuffisance d'inscriptions.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 7 - Responsabilit\xe9</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        L'\xe9tablissement s'engage \xe0 dispenser les formations dans les conditions de qualit\xe9 
        pr\xe9vues. La responsabilit\xe9 de l'\xe9tablissement est limit\xe9e aux dommages directs et pr\xe9visibles.
      </p>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Article 8 - Litiges</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        En cas de litige, les parties conviennent de rechercher une solution amiable avant toute 
        action judiciaire. \xc0 d\xe9faut, les tribunaux de {ecole_ville} seront seuls comp\xe9tents.
      </p>

      <div style="margin-top: 40px; text-align: right;">
        <p style="margin: 0; font-size: 10pt;">Fait \xe0 {ecole_ville}, le {date_jour}</p>
        <div style="margin-top: 30px;">
          <p style="margin: 0; font-weight: bold; font-size: 10pt;">{ecole_representant}</p>
          <p style="margin: 3px 0 0 0; font-size: 10pt;">Directeur</p>
        </div>
      </div>
    `,footerContent:A},programme:{type:"programme",name:"Programme de formation",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 25px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;">
          PROGRAMME DE FORMATION
        </h1>
        <p style="font-size: 14pt; font-weight: bold; margin: 10px 0 0 0; color: #333;">
          {programme_nom}
        </p>
        <p style="font-size: 10pt; color: #666; margin: 5px 0 0 0;">
          Code : {programme_code} | Dur\xe9e totale : {programme_duree_totale}
        </p>
      </div>

      <div style="padding: 15px; background-color: #F9FAFB; border-left: 3px solid #1A1A1A; margin-bottom: 20px;">
        <p style="margin: 0 0 8px 0; font-size: 11pt; font-weight: bold;">üìã Description du programme :</p>
        <p style="margin: 0; text-align: justify; line-height: 1.6; font-size: 10pt;">
          {programme_description}
        </p>
      </div>

      <div style="padding: 15px; background-color: #F0F9FF; border-left: 3px solid #0EA5E9; margin-bottom: 20px;">
        <p style="margin: 0 0 8px 0; font-size: 11pt; font-weight: bold;">üéØ Objectifs du programme :</p>
        <p style="margin: 0; text-align: justify; line-height: 1.6; font-size: 10pt;">
          {programme_objectifs}
        </p>
      </div>

      <div style="padding: 15px; background-color: #FEF3C7; border-left: 3px solid #F59E0B; margin-bottom: 20px;">
        <p style="margin: 0 0 8px 0; font-size: 11pt; font-weight: bold;">üë• Public concern\xe9 :</p>
        <p style="margin: 0; line-height: 1.6; font-size: 10pt;">
          {programme_public_concerne}
        </p>
      </div>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">Pr\xe9requis</h2>
      <ul style="margin: 10px 0 20px 20px; font-size: 10pt; line-height: 1.6;">
        <li>{prerequis_1}</li>
        <li>{prerequis_2}</li>
        <li>{prerequis_3}</li>
      </ul>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">CONTENU P\xc9DAGOGIQUE</h2>

      <div style="margin-bottom: 20px; padding: 15px; background-color: #FAFAFA; border-radius: 4px;">
        <h3 style="font-size: 11pt; font-weight: bold; margin: 0 0 10px 0;">Module 1 : {module_1_titre}</h3>
        <p style="margin: 0 0 10px 0; font-size: 10pt;"><strong>Dur\xe9e :</strong> {module_1_duree}</p>
        <ul style="margin: 0 0 0 20px; font-size: 10pt; line-height: 1.6;">
          <li>{module_1_contenu_1}</li>
          <li>{module_1_contenu_2}</li>
          <li>{module_1_contenu_3}</li>
        </ul>
      </div>

      <div style="margin-bottom: 20px; padding: 15px; background-color: #FAFAFA; border-radius: 4px;">
        <h3 style="font-size: 11pt; font-weight: bold; margin: 0 0 10px 0;">Module 2 : {module_2_titre}</h3>
        <p style="margin: 0 0 10px 0; font-size: 10pt;"><strong>Dur\xe9e :</strong> {module_2_duree}</p>
        <ul style="margin: 0 0 0 20px; font-size: 10pt; line-height: 1.6;">
          <li>{module_2_contenu_1}</li>
          <li>{module_2_contenu_2}</li>
          <li>{module_2_contenu_3}</li>
        </ul>
      </div>

      <div style="margin-bottom: 20px; padding: 15px; background-color: #FAFAFA; border-radius: 4px;">
        <h3 style="font-size: 11pt; font-weight: bold; margin: 0 0 10px 0;">Module 3 : {module_3_titre}</h3>
        <p style="margin: 0 0 10px 0; font-size: 10pt;"><strong>Dur\xe9e :</strong> {module_3_duree}</p>
        <ul style="margin: 0 0 0 20px; font-size: 10pt; line-height: 1.6;">
          <li>{module_3_contenu_1}</li>
          <li>{module_3_contenu_2}</li>
          <li>{module_3_contenu_3}</li>
        </ul>
      </div>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">M\xc9THODES P\xc9DAGOGIQUES</h2>
      <ul style="margin: 10px 0 20px 20px; font-size: 10pt; line-height: 1.6;">
        <li>Cours th\xe9oriques et pratiques</li>
        <li>Travaux dirig\xe9s et \xe9tudes de cas</li>
        <li>Projets et mises en situation</li>
        <li>\xc9valuations continues</li>
      </ul>

      <h2 style="font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;">MODALIT\xc9S D'\xc9VALUATION</h2>
      <p style="text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;">
        L'\xe9valuation se fait par contr\xf4le continu, travaux pratiques et examen final. 
        Une attestation de r\xe9ussite est d\xe9livr\xe9e aux participants ayant obtenu une moyenne 
        minimale de 10/20.
      </p>

      <div style="padding: 15px; background-color: #F0F9FF; border-left: 3px solid #0EA5E9; margin: 25px 0;">
        <p style="margin: 0 0 8px 0; font-size: 10pt;"><strong>Dates de formation :</strong></p>
        <p style="margin: 0 0 8px 0; font-size: 10pt;">Du {session_debut} au {session_fin}</p>
        <p style="margin: 0 0 8px 0; font-size: 10pt;"><strong>Lieu :</strong> {session_lieu}</p>
        <p style="margin: 0; font-size: 10pt;"><strong>Horaires :</strong> {session_horaires}</p>
      </div>

      <div style="margin-top: 30px; text-align: right;">
        <p style="margin: 0; font-size: 10pt;">Fait \xe0 {ecole_ville}, le {date_jour}</p>
        <div style="margin-top: 20px;">
          <p style="margin: 0; font-weight: bold; font-size: 10pt;">{ecole_representant}</p>
          <p style="margin: 3px 0 0 0; font-size: 10pt;">Directeur</p>
        </div>
      </div>
    `,footerContent:A},attestation_assiduite:{type:"attestation_assiduite",name:"Attestation d'assiduit√©",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 30px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;">
          ATTESTATION D'ASSIDUIT\xc9
        </h1>
      </div>

      <div style="margin-bottom: 25px;">
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;">
          Le directeur de <strong>{ecole_nom}</strong>, \xe9tablissement situ\xe9 \xe0 <strong>{ecole_adresse}</strong>,
        </p>
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;">
          <strong>ATTESTE</strong> que <strong>{eleve_nom} {eleve_prenom}</strong>, n\xe9(e) le 
          <strong>{eleve_date_naissance}</strong>, num\xe9ro d'\xe9l\xe8ve <strong>{eleve_numero}</strong>,
        </p>
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;">
          a suivi avec <strong>assiduit\xe9</strong> la formation intitul\xe9e <strong>"{formation_nom}"</strong>
        </p>
        <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0;">
          qui s'est d\xe9roul\xe9e du <strong>{session_debut}</strong> au <strong>{session_fin}</strong> 
          (dur\xe9e totale : {formation_duree}).
        </p>
      </div>

      <div style="padding: 15px; background-color: #F0F9FF; border-left: 3px solid #0EA5E9; margin-bottom: 25px;">
        <p style="margin: 0; font-size: 10pt; font-weight: bold;">Taux de pr\xe9sence :</p>
        <p style="margin: 8px 0 0 0; font-size: 10pt;">Heures suivies : <strong>{heures_suivies}</strong> sur <strong>{heures_totales}</strong></p>
        <p style="margin: 5px 0 0 0; font-size: 10pt;">Taux d'assiduit\xe9 : <strong>{taux_assiduite}%</strong></p>
      </div>

      <p style="text-align: justify; line-height: 1.8; font-size: 10pt; margin: 40px 0;">
        La pr\xe9sente attestation est d\xe9livr\xe9e \xe0 l'int\xe9ress\xe9(e) pour servir et valoir ce que de droit, 
        notamment pour l'\xe9tablissement des droits sociaux, administratifs et pour justifier de sa 
        pr\xe9sence en formation.
      </p>

      <div style="margin-top: 50px; text-align: right;">
        <p style="margin: 0; font-size: 10pt;">Fait \xe0 {ecole_ville}, le {date_jour}</p>
        <div style="margin-top: 40px;">
          <p style="margin: 0; font-weight: bold; font-size: 10pt;">{ecole_representant}</p>
          <p style="margin: 3px 0 0 0; font-size: 10pt;">Directeur</p>
          <div style="border-top: 1px solid #1A1A1A; margin: 30px 0 0 auto; width: 180px; padding-top: 8px; text-align: center;">
            <p style="font-size: 9pt; color: #666; margin: 0;">Signature et cachet</p>
          </div>
        </div>
      </div>
    `,footerContent:A},certificat_realisation:{type:"certificat_realisation",name:"Certificat de r√©alisation",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 30px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;">
          CERTIFICAT DE R\xc9ALISATION
        </h1>
      </div>
      
      <div style="margin-bottom: 30px;">
        <p style="text-align: justify; font-size: 11pt; line-height: 1.6;">
          L'\xe9tablissement <strong>{ecole_nom}</strong> certifie que 
          <strong>{eleve_prenom} {eleve_nom}</strong> a r\xe9alis\xe9 avec succ\xe8s la formation 
          <strong>"{formation_nom}"</strong>.
        </p>
      </div>
      
      <div style="margin-top: 50px; text-align: center;">
        <p style="margin-bottom: 30px;">{ecole_ville}, le {date_jour}</p>
        <p><strong>Le Directeur</strong></p>
        <p style="margin-top: 40px;">________________________</p>
        <p>{ecole_directeur}</p>
      </div>
    `,footerContent:A},livret_accueil:{type:"livret_accueil",name:"Livret d'accueil",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 30px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;">
          LIVRET D'ACCUEIL
        </h1>
      </div>
      
      <div style="margin-bottom: 30px;">
        <h2 style="font-size: 14pt; font-weight: bold; margin-bottom: 15px;">BIENVENUE</h2>
        <p style="text-align: justify; font-size: 11pt; line-height: 1.6;">
          Bienvenue \xe0 <strong>{ecole_nom}</strong>.
        </p>
        <p style="text-align: justify; font-size: 11pt; line-height: 1.6; margin-top: 10px;">
          Ce livret vous pr\xe9sente les informations essentielles de notre \xe9tablissement.
        </p>
      </div>
      
      <div style="margin-bottom: 30px;">
        <h2 style="font-size: 14pt; font-weight: bold; margin-bottom: 15px;">PR\xc9SENTATION</h2>
        <p style="font-size: 11pt; line-height: 1.6;"><strong>\xc9tablissement :</strong> {ecole_nom}</p>
        <p style="font-size: 11pt; line-height: 1.6;"><strong>Adresse :</strong> {ecole_adresse}, {ecole_ville}</p>
        <p style="font-size: 11pt; line-height: 1.6;"><strong>Contact :</strong> {ecole_telephone} | {ecole_email}</p>
      </div>
    `,footerContent:A},emargement:{type:"emargement",name:"Feuille d'√©margement",headerContent:v,bodyContent:`
      <div style="text-align: center; margin-bottom: 30px;">
        <h1 style="font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;">
          FEUILLE D'\xc9MARGEMENT
        </h1>
      </div>
      
      <div style="margin-bottom: 30px;">
        <p style="font-size: 11pt; line-height: 1.6;"><strong>Formation :</strong> {formation_nom}</p>
        <p style="font-size: 11pt; line-height: 1.6;"><strong>Session :</strong> {session_nom}</p>
        <p style="font-size: 11pt; line-height: 1.6;"><strong>Date :</strong> {session_debut}</p>
        <p style="font-size: 11pt; line-height: 1.6;"><strong>Lieu :</strong> {session_lieu}</p>
      </div>
      
      <table style="width: 100%; border-collapse: collapse; margin-top: 30px;">
        <thead>
          <tr style="background-color: #f3f4f6;">
            <th style="padding: 10px; border: 1px solid #ddd; text-align: left; font-size: 11pt;">Nom et Pr\xe9nom</th>
            <th style="padding: 10px; border: 1px solid #ddd; text-align: center; font-size: 11pt;">Signature</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding: 10px; border: 1px solid #ddd; font-size: 11pt;">{eleve_prenom} {eleve_nom}</td>
            <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">________________</td>
          </tr>
        </tbody>
      </table>
    `,footerContent:A}};async function w(e,t){console.log("[AutoDocx] üöÄ G√©n√©ration automatique du DOCX depuis le template HTML");let i=_[e.type],n="",o="",s="";e.header&&"object"==typeof e.header&&(n=e.header.content||""),!n&&i&&(n=i.headerContent||""),e.content&&"object"==typeof e.content&&(o=e.content.html||""),o||"string"!=typeof e.content||(o=e.content),!o&&i&&(o=i.bodyContent||""),e.footer&&"object"==typeof e.footer&&(s=e.footer.content||""),!s&&i&&(s=i.footerContent||""),console.log("[AutoDocx] üìù Header HTML length:",n.length),console.log("[AutoDocx] üìù Body HTML length:",o.length),console.log("[AutoDocx] üìù Footer HTML length:",s.length),console.log("[AutoDocx] üìä Variables re√ßues:",Object.keys(t).length,"variables"),console.log("[AutoDocx] üñºÔ∏è Variables logo:",{ecole_logo:t.ecole_logo?"URL pr√©sente":"Non d√©fini",organization_logo:t.organization_logo?"URL pr√©sente":"Non d√©fini"});let r=F(n,t),l=F(o,t),a=F(s,t),p=r.includes("<img");if(console.log("[AutoDocx] üìù Header apr√®s remplacement - contient <img>:",p),p){let e=r.match(/<img[^>]*src="([^"]{0,50})/i);console.log("[AutoDocx] üìù Source image (premiers 50 chars):",e?e[1]:"Non trouv√©")}let d=e.font_size||10,x=await T(r,"header",t,d),g=await T(l,"body",t,d),c=await T(a,"footer",t,d);console.log("[AutoDocx] üìä Header elements:",x.length),console.log("[AutoDocx] üìä Body elements:",g.length),console.log("[AutoDocx] üìä Footer elements:",c.length);let u=new b.Header({children:x.length>0?x:[new b.Paragraph({children:[]})]}),m=new b.Footer({children:c.length>0?c:[new b.Paragraph({children:[]})]}),f=e.margins||{top:20,right:15,bottom:20,left:15},h=new b.Document({sections:[{properties:{page:{size:{width:11906,height:16838},margin:{top:(0,b.convertMillimetersToTwip)(f.top),right:(0,b.convertMillimetersToTwip)(f.right),bottom:(0,b.convertMillimetersToTwip)(f.bottom),left:(0,b.convertMillimetersToTwip)(f.left)}}},headers:{default:u},footers:{default:m},children:g}]}),y=await b.Packer.toBuffer(h);return console.log("[AutoDocx] ‚úÖ Document g√©n√©r√© avec succ√®s, taille:",y.length,"bytes"),Buffer.from(y)}let E=["ecole_logo","organization_logo","organisation_logo","logo","company_logo","school_logo"];function F(e,t){if(!e)return"";let i=e;for(let e of E){let n=t[e];if(n&&"string"==typeof n&&n.startsWith("http")){let t=RegExp(`\\{${e}\\}`,"g"),o=`<img src="${n}" alt="Logo" style="max-height: 55px; max-width: 140px; object-fit: contain;" />`;i=i.replace(t,o),console.log(`[AutoDocx] üñºÔ∏è Variable {${e}} convertie en balise <img>`)}}for(let[e,n]of Object.entries(t))if(null!=n){if(E.includes(e))continue;let t=RegExp(`\\{${e}\\}`,"g");i=i.replace(t,String(n))}let n=i.match(/\{[a-zA-Z_][a-zA-Z0-9_]*\}/g);if(n&&n.length>0){let e=[...new Set(n)];for(let t of(console.log("[AutoDocx] ‚ö†Ô∏è Variables non remplac√©es:",e.slice(0,10).join(", "),e.length>10?`... et ${e.length-10} autres`:""),e))i=i.replace(RegExp(t.replace(/[{}]/g,"\\$&"),"g"),"");console.log("[AutoDocx] üßπ Variables non remplac√©es supprim√©es du document")}return i}async function T(e,t,i,n){let o,s=[];if(!e||""===e.trim())return s;let r=e.replace(/<!--[\s\S]*?-->/g,"").trim(),l=await C(r,n),a=0,p=/<table[^>]*>[\s\S]*?<\/table>/gi;for(;null!==(o=p.exec(r));){let e=o[0],l=o.index;if(l>a){let e=r.substring(a,l),i=await C(e,n);s.push(...i);let o=j(e,n,t);s.push(...o)}console.log("[AutoDocx] üîç Table trouv√©e, longueur:",e.length);let p=await D(e,i,n);if(p)s.push(p),console.log("[AutoDocx] ‚úÖ Table convertie avec succ√®s");else{console.log("[AutoDocx] ‚ö†Ô∏è Table non convertie, conversion en texte");let i=j(e,n,t);s.push(...i)}a=l+e.length}if(a<r.length){let e=r.substring(a),i=await C(e,n);s.push(...i);let o=j(e,n,t);s.push(...o)}if(0===s.length&&r.trim()){s.push(...l);let e=j(r,n,t);s.push(...e)}return s}async function C(e,t){let i,n=[],o=/<img[^>]*src="([^"]*)"[^>]*>/gi;for(;null!==(i=o.exec(e));){let t=e.substring(0,i.index);if((t.match(/<table/gi)||[]).length>(t.match(/<\/table>/gi)||[]).length)continue;let o=i[1];if(o&&!o.startsWith("{"))try{let e=await I(o);if(e){let t=i[0].match(/style="([^"]*)"/i),s=t?t[1]:"",r=N(s),l=b.AlignmentType.LEFT;"center"===r.textAlign||"auto"===r.margin||"auto"===r.marginLeft?l=b.AlignmentType.CENTER:"right"===r.textAlign&&(l=b.AlignmentType.RIGHT);let a=100,p=50;if(r.width){let e=parseFloat(r.width);isNaN(e)||(a=e)}if(r.height||r.maxHeight){let e=r.height||r.maxHeight,t=parseFloat(e);isNaN(t)||(p=t)}console.log("[AutoDocx] üñºÔ∏è Image standalone:",o.substring(0,40)+"..."),n.push(new b.Paragraph({children:[new b.ImageRun({data:e,transformation:{width:a,height:p}})],alignment:l}))}}catch(e){console.warn("[AutoDocx] ‚ö†Ô∏è Erreur image standalone:",e)}}return n}function j(e,t,i){let n,o=[];if(!e)return o;let s=/<(h[1-6]|p|div|li|span)[^>]*>([\s\S]*?)<\/\1>/gi,r=[],l=0;for(;null!==(n=s.exec(e));){if(n.index>l){let t=q(e.substring(l,n.index)).trim();t&&r.push({tag:"text",content:t,style:""})}let t=n[1].toLowerCase(),i=n[0],o=n[2],s=i.match(/style="([^"]*)"/i),a=s?s[1]:"",p=q(o).trim();p&&r.push({tag:t,content:p,style:a}),l=n.index+i.length}if(l<e.length){let t=q(e.substring(l)).trim();t&&r.push({tag:"text",content:t,style:""})}if(0===r.length){let t=q(e).trim();t&&r.push({tag:"text",content:t,style:""})}for(let e of r){let n=function(e,t,i){let{tag:n,content:o,style:s}=e;if(!o.trim())return null;let r=N(s),l=t;if(r.fontSize){let e=parseFloat(r.fontSize);isNaN(e)||(l=e)}n.startsWith("h")&&(l=t*(2.5-.2*parseInt(n[1]))),("header"===i||"footer"===i)&&(l=Math.min(l,8));let a=b.AlignmentType.LEFT;"center"===r.textAlign?a=b.AlignmentType.CENTER:"right"===r.textAlign?a=b.AlignmentType.RIGHT:"justify"===r.textAlign&&(a=b.AlignmentType.JUSTIFIED);let p={text:o,size:Math.round(2*l),font:r.fontFamily||"Times New Roman",bold:n.startsWith("h")||"bold"===r.fontWeight||"700"===r.fontWeight,italics:"italic"===r.fontStyle,color:L(r.color)},d={children:[new b.TextRun(p)],alignment:a,spacing:{after:n.startsWith("h")?200:100,line:276}},x=d;return"h1"===n?x={...d,heading:b.HeadingLevel.HEADING_1}:"h2"===n?x={...d,heading:b.HeadingLevel.HEADING_2}:"h3"===n&&(x={...d,heading:b.HeadingLevel.HEADING_3}),new b.Paragraph(x)}(e,t,i);n&&o.push(n)}return o}async function D(e,t,i){try{console.log("[AutoDocx] üìä Parsing table HTML...");let t=e.match(/<table[^>]*style="([^"]*)"/i),n=t?t[1]:"",o=N(n),s="collapse"===o.borderCollapse,r="0"===o.border||"none"===o.border||"0px"===o.border||e.includes("border: 0")||e.includes("border:0"),l=[...e.matchAll(/<tr[^>]*>([\s\S]*?)<\/tr>/gi)];if(console.log("[AutoDocx] üìä Lignes trouv√©es:",l.length,"| border-collapse:",s),0===l.length)return console.log("[AutoDocx] ‚ö†Ô∏è Aucune ligne trouv√©e dans la table"),null;let a=[];for(let e=0;e<l.length;e++){let t=l[e],n=t[0],o=t[1],p=n.match(/<tr[^>]*style="([^"]*)"/i),d=p?p[1]:"",x=N(d),g=/<(td|th)[^>]*>([\s\S]*?)<\/\1>/gi,c=[...o.matchAll(g)];if(console.log("[AutoDocx] üìä Ligne",e+1,"- Cellules trouv√©es:",c.length),0===c.length)continue;let u=[];for(let e of c){let t,n,o=e[1],l=e[2],a=e[0].match(/style="([^"]*)"/i),p=a?a[1]:"",d=N(p),g="th"===o.toLowerCase(),c=/<table/i.test(l),m=l;c&&(m=l.replace(/<table[^>]*>/gi,"").replace(/<\/table>/gi,"").replace(/<thead[^>]*>/gi,"").replace(/<\/thead>/gi,"").replace(/<tbody[^>]*>/gi,"").replace(/<\/tbody>/gi,"").replace(/<tr[^>]*>/gi,"").replace(/<\/tr>/gi,"\n").replace(/<t[dh][^>]*>/gi,"").replace(/<\/t[dh]>/gi," | "));let f=m.match(/<img[^>]*src="([^"]*)"[^>]*>/i),h=null!==f,y=[];if(h&&f){let e=f[1];if(e&&!e.startsWith("{"))try{let t=await I(e);if(t){let i=b.AlignmentType.LEFT;"right"===d.textAlign?i=b.AlignmentType.RIGHT:"center"===d.textAlign&&(i=b.AlignmentType.CENTER);let n=m.match(/<img[^>]*style="([^"]*)"[^>]*>/i),o=n?n[1]:"",s=N(o),r=100,l=50;if(s.width){let e=parseFloat(s.width);isNaN(e)||(r=e)}if(s.height||s.maxHeight){let e=s.height||s.maxHeight,t=parseFloat(e);isNaN(t)||(l=t)}console.log("[AutoDocx] üñºÔ∏è Image d√©tect√©e:",e.substring(0,50)+"...","Dimensions:",r,"x",l),y.push(new b.Paragraph({children:[new b.ImageRun({data:t,transformation:{width:r,height:l}})],alignment:i}))}}catch(e){console.warn("[AutoDocx] ‚ö†Ô∏è Impossible de charger l'image:",e)}}let v=m.replace(/<img[^>]*>/gi,"").replace(/<br\s*\/?>/gi,"\n").replace(/<\/p>/gi,"\n").replace(/<\/div>/gi,"\n").replace(/<\/li>/gi,"\n").replace(/<\/h[1-6]>/gi,"\n").replace(/<hr[^>]*>/gi,"\n---\n").replace(/<[^>]+>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&euro;/gi,"‚Ç¨").replace(/&copy;/gi,"¬©").replace(/&reg;/gi,"¬Æ").replace(/&trade;/gi,"‚Ñ¢").replace(/\n\s*\n/g,"\n").trim();if(v){let e=v.split("\n").filter(e=>e.trim()),t=i;if(d.fontSize){let e=parseFloat(d.fontSize);isNaN(e)||(t=e)}let n=L(d.color),o=/<(strong|b)[\s>]/i.test(m),s=/<(em|i)[\s>]/i.test(m);for(let i of e){let e=b.AlignmentType.LEFT;"right"===d.textAlign?e=b.AlignmentType.RIGHT:"center"===d.textAlign&&(e=b.AlignmentType.CENTER),y.push(new b.Paragraph({children:[new b.TextRun({text:i.trim(),size:Math.round(2*t),bold:g||"bold"===d.fontWeight||"700"===d.fontWeight||o,italics:"italic"===d.fontStyle||s,font:d.fontFamily?.replace(/['"]/g,"")||"Times New Roman",color:n})],alignment:e}))}}if(0===y.length&&y.push(new b.Paragraph({children:[]})),d.width){let e=parseFloat(d.width);isNaN(e)||(t={size:d.width.includes("%")?e:Math.round(20*e),type:d.width.includes("%")?b.WidthType.PERCENTAGE:b.WidthType.DXA})}let A=b.VerticalAlign.TOP;"middle"===d.verticalAlign||"center"===d.verticalAlign?A=b.VerticalAlign.CENTER:"bottom"===d.verticalAlign&&(A=b.VerticalAlign.BOTTOM);let z=d.border&&"0"!==d.border&&"none"!==d.border||d.borderTop||d.borderBottom||d.borderLeft||d.borderRight,_=!r&&(z||s)?b.BorderStyle.SINGLE:b.BorderStyle.NIL,w="E2E8F0";if(d.border){let e=d.border.match(/#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/i);e&&(w=e[1].toUpperCase(),3===w.length&&(w=w.split("").map(e=>e+e).join("")))}else if(d.borderBottom){let e=d.borderBottom.match(/#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/i);e&&(w=e[1].toUpperCase(),3===w.length&&(w=w.split("").map(e=>e+e).join("")))}let E=d.backgroundColor||d.background||x.backgroundColor||x.background;if(E&&E.includes("linear-gradient")){let e=E.match(/#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/gi);e&&e.length>0&&(E=e[0],console.log("[AutoDocx] üé® Gradient converti en couleur solide:",E))}if(E&&"transparent"!==E&&!E.includes("gradient")){let e=L(E);e&&(n={type:b.ShadingType.SOLID,color:e,fill:e})}let F={children:y,verticalAlign:A,borders:{top:{style:_,size:1,color:w},bottom:{style:_,size:1,color:w},left:{style:_,size:1,color:w},right:{style:_,size:1,color:w}},margins:{top:80,bottom:80,left:80,right:80}},T=F;t&&(T={...F,width:t}),n&&(T={...T,shading:n}),u.push(new b.TableCell(T))}u.length>0&&a.push(new b.TableRow({children:u}))}if(console.log("[AutoDocx] üìä Lignes cr√©√©es:",a.length),0===a.length)return console.log("[AutoDocx] ‚ö†Ô∏è Aucune ligne cr√©√©e pour la table"),null;let p=100;if(r){if(o.width){let e=o.width.toString();if(e.includes("%")){let t=parseFloat(e);isNaN(t)||(p=Math.min(t,100))}}}else p=100;let d=o.border&&"0"!==o.border&&"none"!==o.border,x=r?b.BorderStyle.NIL:d&&!s?b.BorderStyle.SINGLE:b.BorderStyle.NIL,g="E2E8F0";if(o.borderColor){let e=L(o.borderColor);e&&(g=e)}else if(o.border){let e=o.border.match(/#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/i);e&&(g=e[1].toUpperCase(),3===g.length&&(g=g.split("").map(e=>e+e).join("")))}console.log("[AutoDocx] üìä Table styles:",{isLayoutTable:r,borderCollapse:s,hasTableBorder:d,borderColor:g});let c={rows:a,width:{size:p,type:b.WidthType.PERCENTAGE},layout:b.TableLayoutType.FIXED,borders:{top:{style:x,size:1,color:g},bottom:{style:x,size:1,color:g},left:{style:x,size:1,color:g},right:{style:x,size:1,color:g},insideHorizontal:{style:x,size:1,color:g},insideVertical:{style:x,size:1,color:g}}};return console.log("[AutoDocx] ‚úÖ Table cr√©√©e avec",a.length,"lignes, largeur:",p+"%"),new b.Table(c)}catch(e){return console.error("[AutoDocx] ‚ùå Erreur lors du parsing de la table:",e),null}}let R={white:"FFFFFF",black:"000000",red:"FF0000",green:"00FF00",blue:"0000FF",yellow:"FFFF00",orange:"FFA500",purple:"800080",pink:"FFC0CB",gray:"808080",grey:"808080",lightgray:"D3D3D3",lightgrey:"D3D3D3",darkgray:"A9A9A9",darkgrey:"A9A9A9",silver:"C0C0C0",navy:"000080",teal:"008080",aqua:"00FFFF",cyan:"00FFFF",magenta:"FF00FF",maroon:"800000",olive:"808000",lime:"00FF00",transparent:"FFFFFF"};function L(e){if(!e)return;let t=e.trim().toLowerCase();if(t.startsWith("#")){let e=t.slice(1);return 3===e.length?e.split("").map(e=>e+e).join("").toUpperCase():e.toUpperCase()}if(R[t])return R[t];let i=t.match(/rgba?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/);if(i)return(parseInt(i[1]).toString(16).padStart(2,"0")+parseInt(i[2]).toString(16).padStart(2,"0")+parseInt(i[3]).toString(16).padStart(2,"0")).toUpperCase();console.warn("[AutoDocx] ‚ö†Ô∏è Couleur non reconnue:",e)}function N(e){let t={};if(!e)return t;for(let i of e.split(";")){let[e,n]=i.split(":").map(e=>e.trim());e&&n&&(t[e.replace(/-([a-z])/g,(e,t)=>t.toUpperCase())]=n)}return t}function q(e){return e.replace(/<br\s*\/?>/gi,"\n").replace(/<\/p>/gi,"\n").replace(/<\/div>/gi,"\n").replace(/<\/h[1-6]>/gi,"\n").replace(/<\/li>/gi,"\n").replace(/<\/tr>/gi,"\n").replace(/<\/td>/gi," ").replace(/<\/th>/gi," ").replace(/<[^>]+>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/\s+/g," ").trim()}async function I(e){try{if(!e||e.startsWith("{"))return console.log("[AutoDocx] ‚ö†Ô∏è URL image invalide ou variable non remplac√©e:",e?.substring(0,30)),null;if(e.startsWith("data:")){console.log("[AutoDocx] üì• D√©codage image base64...");let t=e.split(",")[1],i=Buffer.from(t,"base64");return console.log("[AutoDocx] ‚úÖ Image base64 d√©cod√©e, taille:",i.length,"bytes"),i}console.log("[AutoDocx] üì• T√©l√©chargement image depuis:",e.substring(0,60)+"...");let t=await fetch(e);if(!t.ok)throw Error(`HTTP ${t.status}`);let i=await t.arrayBuffer(),n=Buffer.from(i);return console.log("[AutoDocx] ‚úÖ Image t√©l√©charg√©e, taille:",n.length,"bytes"),n}catch(e){return console.error("[AutoDocx] ‚ùå Erreur t√©l√©chargement image:",e),null}}async function S(t,i){if(t.docx_template_url){console.log("[AutoDocx] üìÑ Template DOCX natif trouv√©, utilisation de docxtemplater");let{generateDocxFromTemplate:n}=await e.A(670405);return n(t.docx_template_url,i)}return console.log("[AutoDocx] üîÑ G√©n√©ration automatique depuis le template HTML"),w(t,i)}var O=e.i(89660);async function B(e){console.log("[Generate DOCX] üöÄ D√©but de la requ√™te - G√©n√©ration automatique");try{let{templateId:t,variables:i,filename:n="document.docx"}=await e.json();if(!i)return y.NextResponse.json({error:"Variables manquantes"},{status:400});if(!t)return y.NextResponse.json({error:"templateId requis"},{status:400});console.log("[Generate DOCX] üìã R√©cup√©ration du template:",t);let o=await (0,O.createClient)(),{data:s,error:r}=await o.from("document_templates").select("*").eq("id",t).single();if(r||!s)return console.error("[Generate DOCX] ‚ùå Template non trouv√©:",r),y.NextResponse.json({error:`Template non trouv\xe9: ${t}`},{status:404});console.log("[Generate DOCX] ‚úÖ Template trouv√©:",s.name),console.log("[Generate DOCX] üìù Type:",s.type),console.log("[Generate DOCX] üîó DOCX natif URL:",s.docx_template_url||"Non d√©fini (g√©n√©ration auto)");let l=await S(s,i);return console.log("[Generate DOCX] ‚úÖ Document g√©n√©r√© avec succ√®s, taille:",l.length,"bytes"),new y.NextResponse(l,{headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.wordprocessingml.document","Content-Disposition":`attachment; filename="${n}"`,"Content-Length":l.length.toString()}})}catch(e){return console.error("[Generate DOCX] ‚ùå Erreur globale:",e),y.NextResponse.json({error:"Erreur lors de la g√©n√©ration du document Word",details:e instanceof Error?e.message:String(e)},{status:500})}}e.s(["POST",()=>B,"maxDuration",0,60,"runtime",0,"nodejs"],949755);var P=e.i(949755);let k=new t.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/documents/generate-docx/route",pathname:"/api/documents/generate-docx",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/documents/generate-docx/route.ts",nextConfigOutput:"",userland:P}),{workAsyncStorage:M,workUnitAsyncStorage:H,serverHooks:U}=k;function G(){return(0,n.patchFetch)({workAsyncStorage:M,workUnitAsyncStorage:H})}async function V(e,t,n){k.isDev&&(0,o.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let y="/api/documents/generate-docx/route";y=y.replace(/\/index$/,"")||"/";let b=await k.prepare(e,t,{srcPage:y,multiZoneDraftMode:!1});if(!b)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:v,params:A,nextConfig:z,parsedUrl:_,isDraftMode:w,prerenderManifest:E,routerServerContext:F,isOnDemandRevalidate:T,revalidateOnlyGenerated:C,resolvedPathname:j,clientReferenceManifest:D,serverActionsManifest:R}=b,L=(0,l.normalizeAppPath)(y),N=!!(E.dynamicRoutes[L]||E.routes[j]),q=async()=>((null==F?void 0:F.render404)?await F.render404(e,t,_,!1):t.end("This page could not be found"),null);if(N&&!w){let e=!!E.routes[j],t=E.dynamicRoutes[L];if(t&&!1===t.fallback&&!e){if(z.experimental.adapterPath)return await q();throw new f.NoFallbackError}}let I=null;!N||k.isDev||w||(I="/index"===(I=j)?"/":I);let S=!0===k.isDev||!N,O=N&&!S;R&&D&&(0,r.setManifestsSingleton)({page:y,clientReferenceManifest:D,serverActionsManifest:R});let B=e.method||"GET",P=(0,s.getTracer)(),M=P.getActiveScopeSpan(),H={params:A,prerenderManifest:E,renderOpts:{experimental:{authInterrupts:!!z.experimental.authInterrupts},cacheComponents:!!z.cacheComponents,supportsDynamicResponse:S,incrementalCache:(0,o.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:z.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,i,n,o)=>k.onRequestError(e,t,n,o,F)},sharedContext:{buildId:v}},U=new a.NodeNextRequest(e),G=new a.NodeNextResponse(t),V=p.NextRequestAdapter.fromNodeNextRequest(U,(0,p.signalFromNodeResponse)(t));try{let r=async e=>k.handle(V,H).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let i=P.getRootSpanAttributes();if(!i)return;if(i.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${i.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=i.get("next.route");if(n){let t=`${B} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${B} ${y}`)}),l=!!(0,o.getRequestMeta)(e,"minimalMode"),a=async o=>{var s,a;let p=async({previousCacheEntry:i})=>{try{if(!l&&T&&C&&!i)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await r(o);e.fetchMetrics=H.renderOpts.fetchMetrics;let a=H.renderOpts.pendingWaitUntil;a&&n.waitUntil&&(n.waitUntil(a),a=void 0);let p=H.renderOpts.collectedTags;if(!N)return await (0,g.sendResponse)(U,G,s,H.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,c.toNodeOutgoingHttpHeaders)(s.headers);p&&(t[m.NEXT_CACHE_TAGS_HEADER]=p),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let i=void 0!==H.renderOpts.collectedRevalidate&&!(H.renderOpts.collectedRevalidate>=m.INFINITE_CACHE)&&H.renderOpts.collectedRevalidate,n=void 0===H.renderOpts.collectedExpire||H.renderOpts.collectedExpire>=m.INFINITE_CACHE?void 0:H.renderOpts.collectedExpire;return{value:{kind:h.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:i,expire:n}}}}catch(t){throw(null==i?void 0:i.isStale)&&await k.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,x.getRevalidateReason)({isStaticGeneration:O,isOnDemandRevalidate:T})},!1,F),t}},d=await k.handleResponse({req:e,nextConfig:z,cacheKey:I,routeKind:i.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:E,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:C,responseGenerator:p,waitUntil:n.waitUntil,isMinimalMode:l});if(!N)return null;if((null==d||null==(s=d.value)?void 0:s.kind)!==h.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(a=d.value)?void 0:a.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",T?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),w&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let f=(0,c.fromNodeOutgoingHttpHeaders)(d.value.headers);return l&&N||f.delete(m.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||f.get("Cache-Control")||f.set("Cache-Control",(0,u.getCacheControlHeader)(d.cacheControl)),await (0,g.sendResponse)(U,G,new Response(d.value.body,{headers:f,status:d.value.status||200})),null};M?await a(M):await P.withPropagatedContext(e.headers,()=>P.trace(d.BaseServerSpan.handleRequest,{spanName:`${B} ${y}`,kind:s.SpanKind.SERVER,attributes:{"http.method":B,"http.target":e.url}},a))}catch(t){if(t instanceof f.NoFallbackError||await k.onRequestError(e,t,{routerKind:"App Router",routePath:L,routeType:"route",revalidateReason:(0,x.getRevalidateReason)({isStaticGeneration:O,isOnDemandRevalidate:T})},!1,F),N)throw t;return await (0,g.sendResponse)(U,G,new Response(null,{status:500})),null}}e.s(["handler",()=>V,"patchFetch",()=>G,"routeModule",()=>k,"serverHooks",()=>U,"workAsyncStorage",()=>M,"workUnitAsyncStorage",()=>H],126151)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_748596c8.js.map