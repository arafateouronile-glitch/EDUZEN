{"version":3,"sources":["../../../app/api/documents/generate-docx/route.ts","../../../lib/services/auto-docx-generator.service.ts","../../../node_modules/next/dist/esm/build/templates/app-route.js","../../../lib/utils/document-template-defaults.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\nimport { generateWordDocument } from '@/lib/services/auto-docx-generator.service'\nimport type { DocumentVariables, DocumentTemplate } from '@/lib/types/document-templates'\nimport { createClient } from '@/lib/supabase/server'\n\n// Configuration de la route API\nexport const runtime = 'nodejs'\nexport const maxDuration = 60 // 60 secondes maximum\n\n/**\n * API Route pour g√©n√©rer un document Word automatiquement\n * \n * Cette route g√©n√®re un document Word directement depuis le template HTML,\n * SANS avoir besoin d'uploader un fichier .docx manuellement.\n * \n * Si un template DOCX natif existe (docx_template_url), il sera utilis√©.\n * Sinon, le syst√®me convertit automatiquement le HTML en DOCX.\n * \n * POST /api/documents/generate-docx\n * Body: {\n *   templateId: string,          // ID du template dans la base de donn√©es\n *   variables: DocumentVariables,\n *   filename?: string            // Nom du fichier de sortie\n * }\n */\nexport async function POST(request: NextRequest) {\n  console.log('[Generate DOCX] üöÄ D√©but de la requ√™te - G√©n√©ration automatique')\n  \n  try {\n    const body = await request.json()\n    const { templateId, variables, filename = 'document.docx' } = body as {\n      templateId?: string\n      variables: DocumentVariables\n      filename?: string\n    }\n\n    if (!variables) {\n      return NextResponse.json(\n        { error: 'Variables manquantes' },\n        { status: 400 }\n      )\n    }\n\n    if (!templateId) {\n      return NextResponse.json(\n        { error: 'templateId requis' },\n        { status: 400 }\n      )\n    }\n\n    // R√©cup√©rer le template depuis la base de donn√©es\n    console.log('[Generate DOCX] üìã R√©cup√©ration du template:', templateId)\n    const supabase = await createClient()\n    \n    const { data: template, error: templateError } = await supabase\n      .from('document_templates')\n      .select('*')\n      .eq('id', templateId)\n      .single()\n    \n    if (templateError || !template) {\n      console.error('[Generate DOCX] ‚ùå Template non trouv√©:', templateError)\n      return NextResponse.json(\n        { error: `Template non trouv√©: ${templateId}` },\n        { status: 404 }\n      )\n    }\n\n    console.log('[Generate DOCX] ‚úÖ Template trouv√©:', template.name)\n    console.log('[Generate DOCX] üìù Type:', template.type)\n    console.log('[Generate DOCX] üîó DOCX natif URL:', template.docx_template_url || 'Non d√©fini (g√©n√©ration auto)')\n\n    // G√©n√©rer le document Word\n    // La fonction generateWordDocument choisit automatiquement :\n    // - Si docx_template_url existe : utilise docxtemplater\n    // - Sinon : g√©n√®re automatiquement depuis le HTML\n    const outputBuffer = await generateWordDocument(\n      template as unknown as DocumentTemplate,\n      variables\n    )\n\n    console.log('[Generate DOCX] ‚úÖ Document g√©n√©r√© avec succ√®s, taille:', outputBuffer.length, 'bytes')\n\n    // Retourner le document\n    return new NextResponse(outputBuffer as any, {\n      headers: {\n        'Content-Type': 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n        'Content-Disposition': `attachment; filename=\"${filename}\"`,\n        'Content-Length': outputBuffer.length.toString(),\n      },\n    })\n  } catch (error) {\n    console.error('[Generate DOCX] ‚ùå Erreur globale:', error)\n    return NextResponse.json(\n      { \n        error: 'Erreur lors de la g√©n√©ration du document Word',\n        details: error instanceof Error ? error.message : String(error)\n      },\n      { status: 500 }\n    )\n  }\n}\n","/**\n * Service de g√©n√©ration automatique de templates DOCX √† partir des templates HTML\n * \n * Ce service convertit les templates HTML (header, body, footer) en documents DOCX\n * qui peuvent ensuite √™tre trait√©s par docxtemplater pour la g√©n√©ration finale.\n * \n * Avantages :\n * - Pas besoin d'uploader manuellement des templates DOCX\n * - Utilise les m√™mes templates HTML que pour les PDFs\n * - Variables {variable} pr√©serv√©es pour docxtemplater\n */\n\nimport {\n  Document,\n  Packer,\n  Paragraph,\n  TextRun,\n  HeadingLevel,\n  Header,\n  Footer,\n  Table,\n  TableRow,\n  TableCell,\n  WidthType,\n  AlignmentType,\n  BorderStyle,\n  convertMillimetersToTwip,\n  ImageRun,\n  TableLayoutType,\n  VerticalAlign,\n  ShadingType,\n  ITableCellOptions,\n  ITableRowOptions,\n  ITableOptions,\n  IParagraphOptions,\n  IRunOptions,\n} from 'docx'\nimport type { DocumentTemplate, DocumentVariables } from '@/lib/types/document-templates'\nimport { documentTemplateDefaults } from '@/lib/utils/document-template-defaults'\n\n// Constantes pour les dimensions\nconst A4_WIDTH_TWIPS = 11906 // 210mm en twips\nconst A4_HEIGHT_TWIPS = 16838 // 297mm en twips\nconst MM_TO_TWIPS = 56.6929\n\n/**\n * G√©n√®re un document Word directement √† partir d'un template HTML\n * Sans avoir besoin d'un fichier .docx pr√©-upload√©\n */\nexport async function generateDocxFromHtmlTemplate(\n  template: DocumentTemplate,\n  variables: DocumentVariables\n): Promise<Buffer> {\n  console.log('[AutoDocx] üöÄ G√©n√©ration automatique du DOCX depuis le template HTML')\n  \n  // R√©cup√©rer le template par d√©faut si n√©cessaire\n  const defaultTemplate = documentTemplateDefaults[template.type]\n  \n  // R√©cup√©rer les contenus HTML\n  let headerHtml = ''\n  let bodyHtml = ''\n  let footerHtml = ''\n  \n  // Header\n  if (template.header && typeof template.header === 'object') {\n    headerHtml = (template.header as any).content || ''\n  }\n  if (!headerHtml && defaultTemplate) {\n    headerHtml = defaultTemplate.headerContent || ''\n  }\n  \n  // Body\n  if (template.content && typeof template.content === 'object') {\n    bodyHtml = (template.content as any).html || ''\n  }\n  if (!bodyHtml && typeof template.content === 'string') {\n    bodyHtml = template.content\n  }\n  if (!bodyHtml && defaultTemplate) {\n    bodyHtml = defaultTemplate.bodyContent || ''\n  }\n  \n  // Footer\n  if (template.footer && typeof template.footer === 'object') {\n    footerHtml = (template.footer as any).content || ''\n  }\n  if (!footerHtml && defaultTemplate) {\n    footerHtml = defaultTemplate.footerContent || ''\n  }\n  \n  console.log('[AutoDocx] üìù Header HTML length:', headerHtml.length)\n  console.log('[AutoDocx] üìù Body HTML length:', bodyHtml.length)\n  console.log('[AutoDocx] üìù Footer HTML length:', footerHtml.length)\n  \n  // Afficher les variables de logo disponibles\n  const varKeys = Object.keys(variables)\n  console.log('[AutoDocx] üìä Variables re√ßues:', varKeys.length, 'variables')\n  const varsAsAny = variables as any\n  console.log('[AutoDocx] üñºÔ∏è Variables logo:', {\n    ecole_logo: varsAsAny.ecole_logo ? 'URL pr√©sente' : 'Non d√©fini',\n    organization_logo: varsAsAny.organization_logo ? 'URL pr√©sente' : 'Non d√©fini',\n  })\n  \n  // Remplacer les variables dans le HTML AVANT la conversion\n  const processedHeader = replaceVariables(headerHtml, variables)\n  const processedBody = replaceVariables(bodyHtml, variables)\n  const processedFooter = replaceVariables(footerHtml, variables)\n  \n  // Log apr√®s remplacement pour v√©rifier les images\n  const hasImgInHeader = processedHeader.includes('<img')\n  console.log('[AutoDocx] üìù Header apr√®s remplacement - contient <img>:', hasImgInHeader)\n  if (hasImgInHeader) {\n    const imgMatch = processedHeader.match(/<img[^>]*src=\"([^\"]{0,50})/i)\n    console.log('[AutoDocx] üìù Source image (premiers 50 chars):', imgMatch ? imgMatch[1] : 'Non trouv√©')\n  }\n  \n  // Taille de police par d√©faut\n  const defaultFontSize = template.font_size || 10\n  \n  // Convertir chaque section HTML en √©l√©ments DOCX\n  const headerChildren = await htmlToDocxElements(processedHeader, 'header', variables, defaultFontSize)\n  const bodyChildren = await htmlToDocxElements(processedBody, 'body', variables, defaultFontSize)\n  const footerChildren = await htmlToDocxElements(processedFooter, 'footer', variables, defaultFontSize)\n  \n  console.log('[AutoDocx] üìä Header elements:', headerChildren.length)\n  console.log('[AutoDocx] üìä Body elements:', bodyChildren.length)\n  console.log('[AutoDocx] üìä Footer elements:', footerChildren.length)\n  \n  // Cr√©er le header Word\n  const docxHeader = new Header({\n    children: headerChildren.length > 0 ? headerChildren : [new Paragraph({ children: [] })],\n  })\n  \n  // Cr√©er le footer Word\n  const docxFooter = new Footer({\n    children: footerChildren.length > 0 ? footerChildren : [new Paragraph({ children: [] })],\n  })\n  \n  // Marges du document\n  const margins = template.margins || { top: 20, right: 15, bottom: 20, left: 15 }\n  \n  // Cr√©er le document - Header et footer sur TOUTES les pages\n  const doc = new Document({\n    sections: [{\n      properties: {\n        page: {\n          size: {\n            width: A4_WIDTH_TWIPS,\n            height: A4_HEIGHT_TWIPS,\n          },\n          margin: {\n            top: convertMillimetersToTwip(margins.top),\n            right: convertMillimetersToTwip(margins.right),\n            bottom: convertMillimetersToTwip(margins.bottom),\n            left: convertMillimetersToTwip(margins.left),\n          },\n        },\n      },\n      headers: {\n        default: docxHeader, // Header sur TOUTES les pages\n      },\n      footers: {\n        default: docxFooter, // Footer sur TOUTES les pages\n      },\n      children: bodyChildren,\n    }],\n  })\n  \n  // G√©n√©rer le buffer\n  const buffer = await Packer.toBuffer(doc)\n  console.log('[AutoDocx] ‚úÖ Document g√©n√©r√© avec succ√®s, taille:', buffer.length, 'bytes')\n  \n  return Buffer.from(buffer)\n}\n\n/**\n * Variables de logo connues qui doivent √™tre converties en balises <img>\n */\nconst LOGO_VARIABLES = [\n  'ecole_logo',\n  'organization_logo',\n  'organisation_logo',\n  'logo',\n  'company_logo',\n  'school_logo',\n]\n\n/**\n * Remplace les variables {variable} par leurs valeurs\n * Convertit automatiquement les variables de logo en balises <img>\n */\nfunction replaceVariables(html: string, variables: DocumentVariables): string {\n  if (!html) return ''\n  \n  let result = html\n  \n  // D'abord, convertir les variables de logo en balises <img>\n  const varsAsAny = variables as any\n  for (const logoVar of LOGO_VARIABLES) {\n    const logoValue = varsAsAny[logoVar]\n    if (logoValue && typeof logoValue === 'string' && logoValue.startsWith('http')) {\n      // Remplacer {logo_var} par une balise <img>\n      const logoRegex = new RegExp(`\\\\{${logoVar}\\\\}`, 'g')\n      const imgTag = `<img src=\"${logoValue}\" alt=\"Logo\" style=\"max-height: 55px; max-width: 140px; object-fit: contain;\" />`\n      result = result.replace(logoRegex, imgTag)\n      console.log(`[AutoDocx] üñºÔ∏è Variable {${logoVar}} convertie en balise <img>`)\n    }\n  }\n  \n  // Ensuite, remplacer toutes les autres variables {variable}\n  let replacedCount = 0\n  for (const [key, value] of Object.entries(variables)) {\n    if (value !== undefined && value !== null) {\n      // Ne pas retraiter les logos d√©j√† convertis\n      if (LOGO_VARIABLES.includes(key)) continue\n      \n      const regex = new RegExp(`\\\\{${key}\\\\}`, 'g')\n      const before = result\n      result = result.replace(regex, String(value))\n      if (before !== result) {\n        replacedCount++\n      }\n    }\n  }\n  \n  // D√©tecter les variables non remplac√©es\n  const unreplacedVars = result.match(/\\{[a-zA-Z_][a-zA-Z0-9_]*\\}/g)\n  if (unreplacedVars && unreplacedVars.length > 0) {\n    const uniqueVars = [...new Set(unreplacedVars)]\n    console.log('[AutoDocx] ‚ö†Ô∏è Variables non remplac√©es:', uniqueVars.slice(0, 10).join(', '), \n      uniqueVars.length > 10 ? `... et ${uniqueVars.length - 10} autres` : '')\n    \n    // Remplacer les variables non trouv√©es par une cha√Æne vide (comme le PDF)\n    // Cela √©vite que les balises {variable} apparaissent dans le document final\n    for (const varName of uniqueVars) {\n      result = result.replace(new RegExp(varName.replace(/[{}]/g, '\\\\$&'), 'g'), '')\n    }\n    console.log('[AutoDocx] üßπ Variables non remplac√©es supprim√©es du document')\n  }\n  \n  return result\n}\n\n/**\n * Convertit du HTML en √©l√©ments DOCX (paragraphes et tables)\n */\nasync function htmlToDocxElements(\n  html: string,\n  context: 'header' | 'body' | 'footer',\n  variables: DocumentVariables,\n  defaultFontSize: number\n): Promise<(Paragraph | Table)[]> {\n  const elements: (Paragraph | Table)[] = []\n  \n  if (!html || html.trim() === '') {\n    return elements\n  }\n  \n  // Nettoyer le HTML\n  let cleanHtml = html\n    .replace(/<!--[\\s\\S]*?-->/g, '') // Supprimer les commentaires\n    .trim()\n  \n  // Trouver et traiter les images standalone (hors tables)\n  const standaloneImages = await extractAndProcessStandaloneImages(cleanHtml, defaultFontSize)\n  \n  // Trouver et traiter les tables\n  let currentIndex = 0\n  const tableRegex = /<table[^>]*>[\\s\\S]*?<\\/table>/gi\n  let match\n  \n  // Cr√©er une copie pour it√©rer\n  const htmlCopy = cleanHtml\n  \n  while ((match = tableRegex.exec(htmlCopy)) !== null) {\n    const tableHtml = match[0]\n    const tableStartIndex = match.index\n    \n    // Traiter le texte AVANT cette table\n    if (tableStartIndex > currentIndex) {\n      const beforeText = htmlCopy.substring(currentIndex, tableStartIndex)\n      // V√©rifier s'il y a des images standalone dans cette section\n      const sectionImages = await extractAndProcessStandaloneImages(beforeText, defaultFontSize)\n      elements.push(...sectionImages)\n      \n      const textElements = parseHtmlToTextElements(beforeText, defaultFontSize, context)\n      elements.push(...textElements)\n    }\n    \n    // Convertir la table\n    console.log('[AutoDocx] üîç Table trouv√©e, longueur:', tableHtml.length)\n    const table = await parseHtmlTable(tableHtml, variables, defaultFontSize)\n    if (table) {\n      elements.push(table)\n      console.log('[AutoDocx] ‚úÖ Table convertie avec succ√®s')\n    } else {\n      console.log('[AutoDocx] ‚ö†Ô∏è Table non convertie, conversion en texte')\n      // Si la table n'a pas pu √™tre convertie, extraire le texte\n      const tableTextElements = parseHtmlToTextElements(tableHtml, defaultFontSize, context)\n      elements.push(...tableTextElements)\n    }\n    \n    currentIndex = tableStartIndex + tableHtml.length\n  }\n  \n  // Traiter le texte restant apr√®s la derni√®re table\n  if (currentIndex < htmlCopy.length) {\n    const afterText = htmlCopy.substring(currentIndex)\n    // V√©rifier s'il y a des images standalone dans cette section\n    const sectionImages = await extractAndProcessStandaloneImages(afterText, defaultFontSize)\n    elements.push(...sectionImages)\n    \n    const textElements = parseHtmlToTextElements(afterText, defaultFontSize, context)\n    elements.push(...textElements)\n  }\n  \n  // Si aucune table n'a √©t√© trouv√©e, traiter tout comme texte\n  if (elements.length === 0 && cleanHtml.trim()) {\n    elements.push(...standaloneImages)\n    const textElements = parseHtmlToTextElements(cleanHtml, defaultFontSize, context)\n    elements.push(...textElements)\n  }\n  \n  return elements\n}\n\n/**\n * Extrait et traite les images standalone (hors tables)\n */\nasync function extractAndProcessStandaloneImages(\n  html: string,\n  defaultFontSize: number\n): Promise<Paragraph[]> {\n  const paragraphs: Paragraph[] = []\n  \n  // Chercher les images qui ne sont PAS dans des tables\n  const imgRegex = /<img[^>]*src=\"([^\"]*)\"[^>]*>/gi\n  let imgMatch\n  \n  while ((imgMatch = imgRegex.exec(html)) !== null) {\n    // V√©rifier si l'image est dans une table (on ne la traite pas ici si c'est le cas)\n    const beforeImg = html.substring(0, imgMatch.index)\n    const tableOpenCount = (beforeImg.match(/<table/gi) || []).length\n    const tableCloseCount = (beforeImg.match(/<\\/table>/gi) || []).length\n    \n    // Si on est dans une table, on passe\n    if (tableOpenCount > tableCloseCount) {\n      continue\n    }\n    \n    const imgSrc = imgMatch[1]\n    if (imgSrc && !imgSrc.startsWith('{')) {\n      try {\n        const logoBuffer = await downloadImage(imgSrc)\n        if (logoBuffer) {\n          // Extraire le style de l'image\n          const fullImgTag = imgMatch[0]\n          const styleMatch = fullImgTag.match(/style=\"([^\"]*)\"/i)\n          const imgStyle = styleMatch ? styleMatch[1] : ''\n          const styles = parseInlineStyles(imgStyle)\n          \n          // D√©terminer l'alignement\n          let alignment: typeof AlignmentType.LEFT | typeof AlignmentType.CENTER | typeof AlignmentType.RIGHT = AlignmentType.LEFT\n          if (styles.textAlign === 'center' || styles.margin === 'auto' || styles.marginLeft === 'auto') {\n            alignment = AlignmentType.CENTER as typeof AlignmentType.LEFT\n          } else if (styles.textAlign === 'right') {\n            alignment = AlignmentType.RIGHT as typeof AlignmentType.LEFT\n          }\n          \n          // Dimensions\n          let imgWidth = 100\n          let imgHeight = 50\n          \n          if (styles.width) {\n            const parsedWidth = parseFloat(styles.width)\n            if (!isNaN(parsedWidth)) imgWidth = parsedWidth\n          }\n          if (styles.height || styles.maxHeight) {\n            const heightStr = styles.height || styles.maxHeight\n            const parsedHeight = parseFloat(heightStr)\n            if (!isNaN(parsedHeight)) imgHeight = parsedHeight\n          }\n          \n          console.log('[AutoDocx] üñºÔ∏è Image standalone:', imgSrc.substring(0, 40) + '...')\n          \n          paragraphs.push(new Paragraph({\n            children: [\n              new ImageRun({\n                data: logoBuffer,\n                transformation: { width: imgWidth, height: imgHeight },\n              } as any),\n            ],\n            alignment,\n          }))\n        }\n      } catch (error) {\n        console.warn('[AutoDocx] ‚ö†Ô∏è Erreur image standalone:', error)\n      }\n    }\n  }\n  \n  return paragraphs\n}\n\n/**\n * Parse le HTML en √©l√©ments de texte (paragraphes) avec d√©tection des styles\n */\nfunction parseHtmlToTextElements(\n  html: string, \n  defaultFontSize: number,\n  context: 'header' | 'body' | 'footer'\n): Paragraph[] {\n  const paragraphs: Paragraph[] = []\n  \n  if (!html) return paragraphs\n  \n  // D√©tecter les diff√©rents blocs (h1, h2, p, div, li, etc.)\n  const blockRegex = /<(h[1-6]|p|div|li|span)[^>]*>([\\s\\S]*?)<\\/\\1>/gi\n  const blocks: { tag: string; content: string; style: string }[] = []\n  \n  let match\n  let lastIndex = 0\n  \n  while ((match = blockRegex.exec(html)) !== null) {\n    // Texte avant ce bloc\n    if (match.index > lastIndex) {\n      const beforeText = html.substring(lastIndex, match.index)\n      const cleanText = stripHtmlTags(beforeText).trim()\n      if (cleanText) {\n        blocks.push({ tag: 'text', content: cleanText, style: '' })\n      }\n    }\n    \n    const tag = match[1].toLowerCase()\n    const fullMatch = match[0]\n    const innerContent = match[2]\n    \n    // Extraire le style\n    const styleMatch = fullMatch.match(/style=\"([^\"]*)\"/i)\n    const style = styleMatch ? styleMatch[1] : ''\n    \n    const cleanContent = stripHtmlTags(innerContent).trim()\n    if (cleanContent) {\n      blocks.push({ tag, content: cleanContent, style })\n    }\n    \n    lastIndex = match.index + fullMatch.length\n  }\n  \n  // Texte restant apr√®s le dernier bloc\n  if (lastIndex < html.length) {\n    const afterText = html.substring(lastIndex)\n    const cleanText = stripHtmlTags(afterText).trim()\n    if (cleanText) {\n      blocks.push({ tag: 'text', content: cleanText, style: '' })\n    }\n  }\n  \n  // Si aucun bloc n'a √©t√© trouv√©, traiter tout le HTML comme texte simple\n  if (blocks.length === 0) {\n    const cleanText = stripHtmlTags(html).trim()\n    if (cleanText) {\n      blocks.push({ tag: 'text', content: cleanText, style: '' })\n    }\n  }\n  \n  // Convertir chaque bloc en paragraphe\n  for (const block of blocks) {\n    const paragraph = createParagraphFromBlock(block, defaultFontSize, context)\n    if (paragraph) {\n      paragraphs.push(paragraph)\n    }\n  }\n  \n  return paragraphs\n}\n\n/**\n * Cr√©e un paragraphe DOCX √† partir d'un bloc HTML\n */\nfunction createParagraphFromBlock(\n  block: { tag: string; content: string; style: string },\n  defaultFontSize: number,\n  context: 'header' | 'body' | 'footer'\n): Paragraph | null {\n  const { tag, content, style } = block\n  \n  if (!content.trim()) return null\n  \n  // Parser les styles CSS\n  const styles = parseInlineStyles(style)\n  \n  // D√©terminer la taille de police\n  let fontSize = defaultFontSize\n  if (styles.fontSize) {\n    const parsed = parseFloat(styles.fontSize)\n    if (!isNaN(parsed)) {\n      fontSize = parsed\n    }\n  }\n  \n  // Ajuster pour les titres\n  if (tag.startsWith('h')) {\n    const level = parseInt(tag[1])\n    fontSize = defaultFontSize * (2.5 - level * 0.2)\n  }\n  \n  // Taille r√©duite pour header/footer\n  if (context === 'header' || context === 'footer') {\n    fontSize = Math.min(fontSize, 8)\n  }\n  \n  // D√©terminer l'alignement\n  let alignment: typeof AlignmentType.LEFT | typeof AlignmentType.CENTER | typeof AlignmentType.RIGHT | typeof AlignmentType.JUSTIFIED = AlignmentType.LEFT\n  if (styles.textAlign === 'center') alignment = AlignmentType.CENTER as typeof AlignmentType.LEFT\n  else if (styles.textAlign === 'right') alignment = AlignmentType.RIGHT as typeof AlignmentType.LEFT\n  else if (styles.textAlign === 'justify') alignment = AlignmentType.JUSTIFIED as typeof AlignmentType.LEFT\n  \n  // Cr√©er le TextRun\n  const textRunOptions: IRunOptions = {\n    text: content,\n    size: Math.round(fontSize * 2), // Points * 2 pour half-points\n    font: styles.fontFamily || 'Times New Roman',\n    bold: tag.startsWith('h') || styles.fontWeight === 'bold' || styles.fontWeight === '700',\n    italics: styles.fontStyle === 'italic',\n    color: cssColorToHex(styles.color),\n  }\n  \n  // Cr√©er le paragraphe\n  const paragraphOptions: IParagraphOptions = {\n    children: [new TextRun(textRunOptions)],\n    alignment,\n    spacing: {\n      after: tag.startsWith('h') ? 200 : 100,\n      line: 276, // 1.15 line spacing\n    },\n  }\n  \n  // Ajouter un style de titre si n√©cessaire\n  let finalParagraphOptions = paragraphOptions\n  if (tag === 'h1') {\n    finalParagraphOptions = { ...paragraphOptions, heading: HeadingLevel.HEADING_1 }\n  } else if (tag === 'h2') {\n    finalParagraphOptions = { ...paragraphOptions, heading: HeadingLevel.HEADING_2 }\n  } else if (tag === 'h3') {\n    finalParagraphOptions = { ...paragraphOptions, heading: HeadingLevel.HEADING_3 }\n  }\n  \n  return new Paragraph(finalParagraphOptions)\n}\n\n/**\n * Parse une table HTML en Table DOCX\n */\nasync function parseHtmlTable(\n  tableHtml: string,\n  variables: DocumentVariables,\n  defaultFontSize: number\n): Promise<Table | null> {\n  try {\n    console.log('[AutoDocx] üìä Parsing table HTML...')\n    \n    // V√©rifier si la table a border-collapse: collapse ou des bordures explicites\n    const tableStyleMatch = tableHtml.match(/<table[^>]*style=\"([^\"]*)\"/i)\n    const tableStyle = tableStyleMatch ? tableStyleMatch[1] : ''\n    const tableStyles = parseInlineStyles(tableStyle)\n    const hasBorderCollapse = tableStyles.borderCollapse === 'collapse'\n    \n    // D√©tecter si c'est une table de mise en page (sans bordures)\n    const isLayoutTable = tableStyles.border === '0' || \n                          tableStyles.border === 'none' || \n                          tableStyles.border === '0px' ||\n                          tableHtml.includes('border: 0') ||\n                          tableHtml.includes('border:0')\n    \n    // Extraire toutes les lignes (tr)\n    const rowRegex = /<tr[^>]*>([\\s\\S]*?)<\\/tr>/gi\n    const rowMatches = [...tableHtml.matchAll(rowRegex)]\n    \n    console.log('[AutoDocx] üìä Lignes trouv√©es:', rowMatches.length, '| border-collapse:', hasBorderCollapse)\n    \n    if (rowMatches.length === 0) {\n      console.log('[AutoDocx] ‚ö†Ô∏è Aucune ligne trouv√©e dans la table')\n      return null\n    }\n    \n    const tableRows: TableRow[] = []\n    \n    for (let rowIndex = 0; rowIndex < rowMatches.length; rowIndex++) {\n      const rowMatch = rowMatches[rowIndex]\n      const rowHtml = rowMatch[0]\n      const rowContent = rowMatch[1]\n      \n      // Extraire le style de la ligne\n      const rowStyleMatch = rowHtml.match(/<tr[^>]*style=\"([^\"]*)\"/i)\n      const rowStyle = rowStyleMatch ? rowStyleMatch[1] : ''\n      const rowStyles = parseInlineStyles(rowStyle)\n      \n      // Extraire les cellules (td ou th)\n      const cellRegex = /<(td|th)[^>]*>([\\s\\S]*?)<\\/\\1>/gi\n      const cellMatches = [...rowContent.matchAll(cellRegex)]\n      \n      console.log('[AutoDocx] üìä Ligne', rowIndex + 1, '- Cellules trouv√©es:', cellMatches.length)\n      \n      if (cellMatches.length === 0) continue\n      \n      const tableCells: TableCell[] = []\n      \n      for (const cellMatch of cellMatches) {\n        const cellTag = cellMatch[1] // td ou th\n        const cellContent = cellMatch[2]\n        const fullCellHtml = cellMatch[0]\n        \n        // Extraire le style de la cellule\n        const styleMatch = fullCellHtml.match(/style=\"([^\"]*)\"/i)\n        const cellStyle = styleMatch ? styleMatch[1] : ''\n        const styles = parseInlineStyles(cellStyle)\n        \n        // V√©rifier si c'est un header (th)\n        const isHeader = cellTag.toLowerCase() === 'th'\n        \n        // V√©rifier si la cellule contient une table imbriqu√©e - l'aplatir en texte structur√©\n        const hasNestedTable = /<table/i.test(cellContent)\n        let processedCellContent = cellContent\n        \n        if (hasNestedTable) {\n          // Extraire le contenu des cellules de la table imbriqu√©e comme texte structur√©\n          processedCellContent = cellContent\n            .replace(/<table[^>]*>/gi, '')\n            .replace(/<\\/table>/gi, '')\n            .replace(/<thead[^>]*>/gi, '')\n            .replace(/<\\/thead>/gi, '')\n            .replace(/<tbody[^>]*>/gi, '')\n            .replace(/<\\/tbody>/gi, '')\n            .replace(/<tr[^>]*>/gi, '')\n            .replace(/<\\/tr>/gi, '\\n')\n            .replace(/<t[dh][^>]*>/gi, '')\n            .replace(/<\\/t[dh]>/gi, ' | ')\n        }\n        \n        // V√©rifier si la cellule contient une image/logo\n        const imgMatch = processedCellContent.match(/<img[^>]*src=\"([^\"]*)\"[^>]*>/i)\n        const hasImage = imgMatch !== null\n        \n        const cellChildren: Paragraph[] = []\n        \n        // G√©rer l'image si pr√©sente\n        if (hasImage && imgMatch) {\n          const imgSrc = imgMatch[1]\n          if (imgSrc && !imgSrc.startsWith('{')) {\n            try {\n              const logoBuffer = await downloadImage(imgSrc)\n              if (logoBuffer) {\n                // D√©terminer l'alignement de l'image\n                let imgAlignment: typeof AlignmentType.LEFT | typeof AlignmentType.CENTER | typeof AlignmentType.RIGHT = AlignmentType.LEFT\n                if (styles.textAlign === 'right') imgAlignment = AlignmentType.RIGHT as typeof AlignmentType.LEFT\n                else if (styles.textAlign === 'center') imgAlignment = AlignmentType.CENTER as typeof AlignmentType.LEFT\n                \n                // Extraire les dimensions de l'image depuis le HTML\n                const imgStyleMatch = processedCellContent.match(/<img[^>]*style=\"([^\"]*)\"[^>]*>/i)\n                const imgStyle = imgStyleMatch ? imgStyleMatch[1] : ''\n                const imgStyles = parseInlineStyles(imgStyle)\n                \n                // Dimensions par d√©faut ou depuis le style\n                let imgWidth = 100 // Largeur par d√©faut\n                let imgHeight = 50 // Hauteur par d√©faut\n                \n                if (imgStyles.width) {\n                  const parsedWidth = parseFloat(imgStyles.width)\n                  if (!isNaN(parsedWidth)) imgWidth = parsedWidth\n                }\n                if (imgStyles.height || imgStyles.maxHeight) {\n                  const heightStr = imgStyles.height || imgStyles.maxHeight\n                  const parsedHeight = parseFloat(heightStr)\n                  if (!isNaN(parsedHeight)) imgHeight = parsedHeight\n                }\n                \n                console.log('[AutoDocx] üñºÔ∏è Image d√©tect√©e:', imgSrc.substring(0, 50) + '...', 'Dimensions:', imgWidth, 'x', imgHeight)\n                \n                cellChildren.push(new Paragraph({\n                  children: [\n                    new ImageRun({\n                      data: logoBuffer,\n                      transformation: {\n                        width: imgWidth,\n                        height: imgHeight,\n                      },\n                    } as any),\n                  ],\n                  alignment: imgAlignment,\n                }))\n              }\n            } catch (error) {\n              console.warn('[AutoDocx] ‚ö†Ô∏è Impossible de charger l\\'image:', error)\n            }\n          }\n        }\n        \n        // Extraire et ajouter le texte de la cellule (sans les tags d'image)\n        let textContent = processedCellContent\n          .replace(/<img[^>]*>/gi, '')\n          .replace(/<br\\s*\\/?>/gi, '\\n')\n          .replace(/<\\/p>/gi, '\\n')\n          .replace(/<\\/div>/gi, '\\n')\n          .replace(/<\\/li>/gi, '\\n')\n          .replace(/<\\/h[1-6]>/gi, '\\n')\n          .replace(/<hr[^>]*>/gi, '\\n---\\n')\n          .replace(/<[^>]+>/g, '')\n          .replace(/&nbsp;/g, ' ')\n          .replace(/&amp;/g, '&')\n          .replace(/&lt;/g, '<')\n          .replace(/&gt;/g, '>')\n          .replace(/&quot;/g, '\"')\n          .replace(/&#39;/g, \"'\")\n          .replace(/&euro;/gi, '‚Ç¨')\n          .replace(/&copy;/gi, '¬©')\n          .replace(/&reg;/gi, '¬Æ')\n          .replace(/&trade;/gi, '‚Ñ¢')\n          .replace(/\\n\\s*\\n/g, '\\n') // Supprimer les lignes vides multiples\n          .trim()\n        \n        if (textContent) {\n          // Diviser par lignes\n          const lines = textContent.split('\\n').filter(l => l.trim())\n          \n          // Extraire la taille de police si d√©finie dans le style\n          let cellFontSize = defaultFontSize\n          if (styles.fontSize) {\n            const parsedSize = parseFloat(styles.fontSize)\n            if (!isNaN(parsedSize)) cellFontSize = parsedSize\n          }\n          \n          // D√©terminer la couleur du texte\n          const textColor = cssColorToHex(styles.color)\n          \n          // D√©tecter si le contenu original contient des balises bold/italic\n          const hasBoldTag = /<(strong|b)[\\s>]/i.test(processedCellContent)\n          const hasItalicTag = /<(em|i)[\\s>]/i.test(processedCellContent)\n          \n          for (const line of lines) {\n            // D√©terminer l'alignement du texte\n            let textAlignment: typeof AlignmentType.LEFT | typeof AlignmentType.CENTER | typeof AlignmentType.RIGHT = AlignmentType.LEFT\n            if (styles.textAlign === 'right') textAlignment = AlignmentType.RIGHT as typeof AlignmentType.LEFT\n            else if (styles.textAlign === 'center') textAlignment = AlignmentType.CENTER as typeof AlignmentType.LEFT\n            \n            cellChildren.push(new Paragraph({\n              children: [\n                new TextRun({\n                  text: line.trim(),\n                  size: Math.round(cellFontSize * 2),\n                  bold: isHeader || styles.fontWeight === 'bold' || styles.fontWeight === '700' || hasBoldTag,\n                  italics: styles.fontStyle === 'italic' || hasItalicTag,\n                  font: styles.fontFamily?.replace(/['\"]/g, '') || 'Times New Roman',\n                  color: textColor,\n                }),\n              ],\n              alignment: textAlignment,\n            }))\n          }\n        }\n        \n        // Si pas de contenu, ajouter un paragraphe vide\n        if (cellChildren.length === 0) {\n          cellChildren.push(new Paragraph({ children: [] }))\n        }\n        \n        // D√©terminer la largeur de la cellule\n        let cellWidth: { size: number; type: typeof WidthType[keyof typeof WidthType] } | undefined\n        if (styles.width) {\n          const widthValue = parseFloat(styles.width)\n          if (!isNaN(widthValue)) {\n            cellWidth = {\n              size: styles.width.includes('%') ? widthValue : Math.round(widthValue * 20),\n              type: styles.width.includes('%') ? WidthType.PERCENTAGE : WidthType.DXA,\n            }\n          }\n        }\n        \n        // D√©terminer l'alignement vertical\n        let verticalAlignment: typeof VerticalAlign.TOP | typeof VerticalAlign.CENTER | typeof VerticalAlign.BOTTOM = VerticalAlign.TOP\n        if (styles.verticalAlign === 'middle' || styles.verticalAlign === 'center') {\n          verticalAlignment = VerticalAlign.CENTER as typeof VerticalAlign.TOP\n        } else if (styles.verticalAlign === 'bottom') {\n          verticalAlignment = VerticalAlign.BOTTOM as typeof VerticalAlign.TOP\n        }\n        \n        // D√©terminer les bordures (v√©rifier border global, bordures individuelles, ou border-collapse de la table)\n        const hasCellBorder = (styles.border && styles.border !== '0' && styles.border !== 'none') ||\n          styles.borderTop || styles.borderBottom || styles.borderLeft || styles.borderRight\n        // Si c'est une table de mise en page (border: 0), pas de bordures\n        // Si la table a border-collapse, appliquer des bordures aux cellules\n        const hasBorder = isLayoutTable ? false : (hasCellBorder || hasBorderCollapse)\n        const borderStyle = hasBorder ? BorderStyle.SINGLE : BorderStyle.NIL\n        \n        // Extraire la couleur de bordure si d√©finie\n        let borderColor = 'E2E8F0' // Couleur par d√©faut (gris clair)\n        if (styles.border) {\n          const borderColorMatch = styles.border.match(/#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/i)\n          if (borderColorMatch) {\n            borderColor = borderColorMatch[1].toUpperCase()\n            if (borderColor.length === 3) {\n              borderColor = borderColor.split('').map(c => c + c).join('')\n            }\n          }\n        } else if (styles.borderBottom) {\n          // Aussi v√©rifier borderBottom pour les lignes de s√©paration\n          const borderColorMatch = styles.borderBottom.match(/#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/i)\n          if (borderColorMatch) {\n            borderColor = borderColorMatch[1].toUpperCase()\n            if (borderColor.length === 3) {\n              borderColor = borderColor.split('').map(c => c + c).join('')\n            }\n          }\n        }\n        \n        // D√©terminer la couleur de fond (cellule ou ligne)\n        let shading = undefined\n        let bgColor = styles.backgroundColor || styles.background || rowStyles.backgroundColor || rowStyles.background\n        \n        // G√©rer les gradients CSS - extraire la premi√®re couleur\n        if (bgColor && bgColor.includes('linear-gradient')) {\n          const gradientColors = bgColor.match(/#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/gi)\n          if (gradientColors && gradientColors.length > 0) {\n            bgColor = gradientColors[0] // Utiliser la premi√®re couleur du gradient\n            console.log('[AutoDocx] üé® Gradient converti en couleur solide:', bgColor)\n          }\n        }\n        \n        if (bgColor && bgColor !== 'transparent' && !bgColor.includes('gradient')) {\n          const bgHex = cssColorToHex(bgColor)\n          if (bgHex) {\n            shading = {\n              type: ShadingType.SOLID,\n              color: bgHex,\n              fill: bgHex,\n            }\n          }\n        }\n        \n        // Cr√©er la cellule\n        const cellOptions: ITableCellOptions = {\n          children: cellChildren,\n          verticalAlign: verticalAlignment,\n          borders: {\n            top: { style: borderStyle, size: 1, color: borderColor },\n            bottom: { style: borderStyle, size: 1, color: borderColor },\n            left: { style: borderStyle, size: 1, color: borderColor },\n            right: { style: borderStyle, size: 1, color: borderColor },\n          },\n          margins: {\n            top: 80,\n            bottom: 80,\n            left: 80,\n            right: 80,\n          },\n        }\n        \n        let finalCellOptions = cellOptions\n        if (cellWidth) {\n          finalCellOptions = { ...cellOptions, width: cellWidth }\n        }\n        \n        if (shading) {\n          finalCellOptions = { ...finalCellOptions, shading }\n        }\n        \n        tableCells.push(new TableCell(finalCellOptions))\n      }\n      \n      if (tableCells.length > 0) {\n        tableRows.push(new TableRow({\n          children: tableCells,\n        }))\n      }\n    }\n    \n    console.log('[AutoDocx] üìä Lignes cr√©√©es:', tableRows.length)\n    \n    if (tableRows.length === 0) {\n      console.log('[AutoDocx] ‚ö†Ô∏è Aucune ligne cr√©√©e pour la table')\n      return null\n    }\n    \n    // Extraire la largeur de la table\n    // Pour les tables de donn√©es (avec bordures), on force 100% de largeur pour un meilleur rendu Word\n    // Pour les tables de mise en page, on respecte la largeur d√©finie\n    let tableWidth = 100\n    \n    // Si c'est une table de donn√©es (pas de mise en page), toujours utiliser 100%\n    // Les largeurs en pixels sont mal rendues dans Word\n    if (!isLayoutTable) {\n      tableWidth = 100\n    } else if (tableStyles.width) {\n      const widthStr = tableStyles.width.toString()\n      // Ne prendre en compte que les pourcentages (ignorer les px, em, etc.)\n      if (widthStr.includes('%')) {\n        const parsedWidth = parseFloat(widthStr)\n        if (!isNaN(parsedWidth)) tableWidth = Math.min(parsedWidth, 100)\n      }\n      // Sinon, garder 100% pour les tables de mise en page aussi\n    }\n    \n    // D√©terminer les bordures de la table\n    // Si borderCollapse est 'collapse', les cellules ont des bordures individuelles\n    // Si border est d√©fini sur la table, utiliser des bordures globales\n    const hasTableBorder = tableStyles.border && tableStyles.border !== '0' && tableStyles.border !== 'none'\n    \n    // Pour les tables de mise en page (border: 0), pas de bordures du tout\n    // Pour border-collapse, on utilise NIL au niveau table car les bordures sont sur les cellules\n    // Pour border sur la table, on utilise SINGLE\n    const tableBorderStyle = isLayoutTable ? BorderStyle.NIL : \n                             (hasTableBorder && !hasBorderCollapse ? BorderStyle.SINGLE : BorderStyle.NIL)\n    \n    // Extraire la couleur de bordure si d√©finie\n    let tableBorderColor = 'E2E8F0' // Couleur par d√©faut plus claire\n    if (tableStyles.borderColor) {\n      const parsedColor = cssColorToHex(tableStyles.borderColor)\n      if (parsedColor) tableBorderColor = parsedColor\n    } else if (tableStyles.border) {\n      const tableBorderColorMatch = tableStyles.border.match(/#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/i)\n      if (tableBorderColorMatch) {\n        tableBorderColor = tableBorderColorMatch[1].toUpperCase()\n        if (tableBorderColor.length === 3) {\n          tableBorderColor = tableBorderColor.split('').map(c => c + c).join('')\n        }\n      }\n    }\n    \n    // Log pour debug\n    console.log('[AutoDocx] üìä Table styles:', {\n      isLayoutTable,\n      borderCollapse: hasBorderCollapse,\n      hasTableBorder: hasTableBorder,\n      borderColor: tableBorderColor\n    })\n    \n    // Cr√©er la table\n    const tableOptions: ITableOptions = {\n      rows: tableRows,\n      width: {\n        size: tableWidth,\n        type: WidthType.PERCENTAGE,\n      },\n      layout: TableLayoutType.FIXED,\n      borders: {\n        top: { style: tableBorderStyle, size: 1, color: tableBorderColor },\n        bottom: { style: tableBorderStyle, size: 1, color: tableBorderColor },\n        left: { style: tableBorderStyle, size: 1, color: tableBorderColor },\n        right: { style: tableBorderStyle, size: 1, color: tableBorderColor },\n        insideHorizontal: { style: tableBorderStyle, size: 1, color: tableBorderColor },\n        insideVertical: { style: tableBorderStyle, size: 1, color: tableBorderColor },\n      },\n    }\n    \n    console.log('[AutoDocx] ‚úÖ Table cr√©√©e avec', tableRows.length, 'lignes, largeur:', tableWidth + '%')\n    return new Table(tableOptions)\n    \n  } catch (error) {\n    console.error('[AutoDocx] ‚ùå Erreur lors du parsing de la table:', error)\n    return null\n  }\n}\n\n/**\n * Mappe les noms de couleurs CSS vers leurs valeurs hexad√©cimales\n */\nconst CSS_COLOR_NAMES: Record<string, string> = {\n  white: 'FFFFFF',\n  black: '000000',\n  red: 'FF0000',\n  green: '00FF00',\n  blue: '0000FF',\n  yellow: 'FFFF00',\n  orange: 'FFA500',\n  purple: '800080',\n  pink: 'FFC0CB',\n  gray: '808080',\n  grey: '808080',\n  lightgray: 'D3D3D3',\n  lightgrey: 'D3D3D3',\n  darkgray: 'A9A9A9',\n  darkgrey: 'A9A9A9',\n  silver: 'C0C0C0',\n  navy: '000080',\n  teal: '008080',\n  aqua: '00FFFF',\n  cyan: '00FFFF',\n  magenta: 'FF00FF',\n  maroon: '800000',\n  olive: '808000',\n  lime: '00FF00',\n  transparent: 'FFFFFF',\n}\n\n/**\n * Convertit une couleur CSS en valeur hexad√©cimale (sans #)\n */\nfunction cssColorToHex(color: string | undefined): string | undefined {\n  if (!color) return undefined\n  \n  const cleanColor = color.trim().toLowerCase()\n  \n  // Si c'est d√©j√† un hex\n  if (cleanColor.startsWith('#')) {\n    const hex = cleanColor.slice(1)\n    // Convertir #RGB en #RRGGBB\n    if (hex.length === 3) {\n      return hex.split('').map(c => c + c).join('').toUpperCase()\n    }\n    return hex.toUpperCase()\n  }\n  \n  // Si c'est un nom de couleur CSS\n  if (CSS_COLOR_NAMES[cleanColor]) {\n    return CSS_COLOR_NAMES[cleanColor]\n  }\n  \n  // Si c'est rgb() ou rgba()\n  const rgbMatch = cleanColor.match(/rgba?\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)/)\n  if (rgbMatch) {\n    const r = parseInt(rgbMatch[1]).toString(16).padStart(2, '0')\n    const g = parseInt(rgbMatch[2]).toString(16).padStart(2, '0')\n    const b = parseInt(rgbMatch[3]).toString(16).padStart(2, '0')\n    return (r + g + b).toUpperCase()\n  }\n  \n  // Si rien ne correspond, retourner undefined\n  console.warn('[AutoDocx] ‚ö†Ô∏è Couleur non reconnue:', color)\n  return undefined\n}\n\n/**\n * Parse les styles CSS inline\n */\nfunction parseInlineStyles(style: string): Record<string, string> {\n  const styles: Record<string, string> = {}\n  \n  if (!style) return styles\n  \n  const declarations = style.split(';')\n  for (const declaration of declarations) {\n    const [property, value] = declaration.split(':').map(s => s.trim())\n    if (property && value) {\n      // Convertir les propri√©t√©s CSS en camelCase\n      const camelProperty = property.replace(/-([a-z])/g, (_, letter) => letter.toUpperCase())\n      styles[camelProperty] = value\n    }\n  }\n  \n  return styles\n}\n\n/**\n * Supprime tous les tags HTML et retourne le texte brut\n */\nfunction stripHtmlTags(html: string): string {\n  return html\n    .replace(/<br\\s*\\/?>/gi, '\\n')\n    .replace(/<\\/p>/gi, '\\n')\n    .replace(/<\\/div>/gi, '\\n')\n    .replace(/<\\/h[1-6]>/gi, '\\n')\n    .replace(/<\\/li>/gi, '\\n')\n    .replace(/<\\/tr>/gi, '\\n')\n    .replace(/<\\/td>/gi, ' ')\n    .replace(/<\\/th>/gi, ' ')\n    .replace(/<[^>]+>/g, '')\n    .replace(/&nbsp;/g, ' ')\n    .replace(/&amp;/g, '&')\n    .replace(/&lt;/g, '<')\n    .replace(/&gt;/g, '>')\n    .replace(/&quot;/g, '\"')\n    .replace(/&#39;/g, \"'\")\n    .replace(/\\s+/g, ' ')\n    .trim()\n}\n\n/**\n * T√©l√©charge une image et retourne son buffer\n */\nasync function downloadImage(url: string): Promise<Buffer | null> {\n  try {\n    if (!url || url.startsWith('{')) {\n      console.log('[AutoDocx] ‚ö†Ô∏è URL image invalide ou variable non remplac√©e:', url?.substring(0, 30))\n      return null\n    }\n    \n    // Si c'est une data URL, la d√©coder\n    if (url.startsWith('data:')) {\n      console.log('[AutoDocx] üì• D√©codage image base64...')\n      const base64 = url.split(',')[1]\n      const buffer = Buffer.from(base64, 'base64')\n      console.log('[AutoDocx] ‚úÖ Image base64 d√©cod√©e, taille:', buffer.length, 'bytes')\n      return buffer\n    }\n    \n    // T√©l√©charger l'image\n    console.log('[AutoDocx] üì• T√©l√©chargement image depuis:', url.substring(0, 60) + '...')\n    const response = await fetch(url)\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}`)\n    }\n    \n    const arrayBuffer = await response.arrayBuffer()\n    const buffer = Buffer.from(arrayBuffer)\n    console.log('[AutoDocx] ‚úÖ Image t√©l√©charg√©e, taille:', buffer.length, 'bytes')\n    return buffer\n  } catch (error) {\n    console.error('[AutoDocx] ‚ùå Erreur t√©l√©chargement image:', error)\n    return null\n  }\n}\n\n/**\n * G√©n√®re un document Word complet depuis un template et des variables\n * C'est la fonction principale √† utiliser pour la g√©n√©ration automatique\n */\nexport async function generateWordDocument(\n  template: DocumentTemplate,\n  variables: DocumentVariables\n): Promise<Buffer> {\n  // Si un template DOCX natif existe, l'utiliser avec docxtemplater\n  if (template.docx_template_url) {\n    console.log('[AutoDocx] üìÑ Template DOCX natif trouv√©, utilisation de docxtemplater')\n    const { generateDocxFromTemplate } = await import('./docx-generator.service')\n    return generateDocxFromTemplate(template.docx_template_url, variables)\n  }\n  \n  // Sinon, g√©n√©rer automatiquement depuis le HTML\n  console.log('[AutoDocx] üîÑ G√©n√©ration automatique depuis le template HTML')\n  return generateDocxFromHtmlTemplate(template, variables)\n}\n","import { AppRouteRouteModule } from \"next/dist/esm/server/route-modules/app-route/module.compiled\";\nimport { RouteKind } from \"next/dist/esm/server/route-kind\";\nimport { patchFetch as _patchFetch } from \"next/dist/esm/server/lib/patch-fetch\";\nimport { addRequestMeta, getRequestMeta } from \"next/dist/esm/server/request-meta\";\nimport { getTracer, SpanKind } from \"next/dist/esm/server/lib/trace/tracer\";\nimport { setManifestsSingleton } from \"next/dist/esm/server/app-render/manifests-singleton\";\nimport { normalizeAppPath } from \"next/dist/esm/shared/lib/router/utils/app-paths\";\nimport { NodeNextRequest, NodeNextResponse } from \"next/dist/esm/server/base-http/node\";\nimport { NextRequestAdapter, signalFromNodeResponse } from \"next/dist/esm/server/web/spec-extension/adapters/next-request\";\nimport { BaseServerSpan } from \"next/dist/esm/server/lib/trace/constants\";\nimport { getRevalidateReason } from \"next/dist/esm/server/instrumentation/utils\";\nimport { sendResponse } from \"next/dist/esm/server/send-response\";\nimport { fromNodeOutgoingHttpHeaders, toNodeOutgoingHttpHeaders } from \"next/dist/esm/server/web/utils\";\nimport { getCacheControlHeader } from \"next/dist/esm/server/lib/cache-control\";\nimport { INFINITE_CACHE, NEXT_CACHE_TAGS_HEADER } from \"next/dist/esm/lib/constants\";\nimport { NoFallbackError } from \"next/dist/esm/shared/lib/no-fallback-error.external\";\nimport { CachedRouteKind } from \"next/dist/esm/server/response-cache\";\nimport * as userland from \"INNER_APP_ROUTE\";\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new AppRouteRouteModule({\n    definition: {\n        kind: RouteKind.APP_ROUTE,\n        page: \"/api/documents/generate-docx/route\",\n        pathname: \"/api/documents/generate-docx\",\n        filename: \"route\",\n        bundlePath: \"\"\n    },\n    distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n    relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n    resolvedPagePath: \"[project]/app/api/documents/generate-docx/route.ts\",\n    nextConfigOutput,\n    userland\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return _patchFetch({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\nexport { routeModule, workAsyncStorage, workUnitAsyncStorage, serverHooks, patchFetch,  };\nexport async function handler(req, res, ctx) {\n    if (routeModule.isDev) {\n        addRequestMeta(req, 'devRequestTimingInternalsEnd', process.hrtime.bigint());\n    }\n    let srcPage = \"/api/documents/generate-docx/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (process.env.TURBOPACK) {\n        srcPage = srcPage.replace(/\\/index$/, '') || '/';\n    } else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = process.env.__NEXT_MULTI_ZONE_DRAFT_MODE;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, parsedUrl, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname, clientReferenceManifest, serverActionsManifest } = prepareResult;\n    const normalizedSrcPage = normalizeAppPath(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    const render404 = async ()=>{\n        // TODO: should route-module itself handle rendering the 404\n        if (routerServerContext == null ? void 0 : routerServerContext.render404) {\n            await routerServerContext.render404(req, res, parsedUrl, false);\n        } else {\n            res.end('This page could not be found');\n        }\n        return null;\n    };\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                if (nextConfig.experimental.adapterPath) {\n                    return await render404();\n                }\n                throw new NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isStaticGeneration = isIsr && !supportsDynamicResponse;\n    // Before rendering (which initializes component tree modules), we have to\n    // set the reference manifests to our global store so Server Action's\n    // encryption util can access to them at the top level of the page module.\n    if (serverActionsManifest && clientReferenceManifest) {\n        setManifestsSingleton({\n            page: srcPage,\n            clientReferenceManifest,\n            serverActionsManifest\n        });\n    }\n    const method = req.method || 'GET';\n    const tracer = getTracer();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            cacheComponents: Boolean(nextConfig.cacheComponents),\n            supportsDynamicResponse,\n            incrementalCache: getRequestMeta(req, 'incrementalCache'),\n            cacheLifeProfiles: nextConfig.cacheLife,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext, silenceLog)=>routeModule.onRequestError(req, error, errorContext, silenceLog, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new NodeNextRequest(req);\n    const nodeNextRes = new NodeNextResponse(res);\n    const nextReq = NextRequestAdapter.fromNodeNextRequest(nodeNextReq, signalFromNodeResponse(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${srcPage}`);\n                }\n            });\n        };\n        const isMinimalMode = Boolean(process.env.MINIMAL_MODE || getRequestMeta(req, 'minimalMode'));\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!isMinimalMode && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = toNodeOutgoingHttpHeaders(response.headers);\n                        if (cacheTags) {\n                            headers[NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await sendResponse(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        const silenceLog = false;\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: getRevalidateReason({\n                                isStaticGeneration,\n                                isOnDemandRevalidate\n                            })\n                        }, silenceLog, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil,\n                isMinimalMode\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!isMinimalMode) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = fromNodeOutgoingHttpHeaders(cacheEntry.value.headers);\n            if (!(isMinimalMode && isIsr)) {\n                headers.delete(NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', getCacheControlHeader(cacheEntry.cacheControl));\n            }\n            await sendResponse(nodeNextReq, nodeNextRes, // @ts-expect-error - Argument of type 'Buffer<ArrayBufferLike>' is not assignable to parameter of type 'BodyInit | null | undefined'.\n            new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${srcPage}`,\n                    kind: SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        if (!(err instanceof NoFallbackError)) {\n            const silenceLog = false;\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: getRevalidateReason({\n                    isStaticGeneration,\n                    isOnDemandRevalidate\n                })\n            }, silenceLog, routerServerContext);\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await sendResponse(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n","/**\n * Templates par d√©faut pour chaque type de document\n * Style Premium inspir√© de INSSI FORMATION\n * \n * Caract√©ristiques du style :\n * - En-t√™te professionnel avec logo √† droite et infos √† gauche\n * - Pied de page avec SIRET, d√©claration d'activit√© et pagination\n * - Mise en page coh√©rente sur tous les types de documents\n */\n\nimport type { DocumentType } from '@/lib/types/document-templates'\n\nexport interface DocumentTemplateDefault {\n  type: DocumentType\n  name: string\n  headerContent: string\n  bodyContent: string\n  footerContent: string\n}\n\n/**\n * Header Premium - Structure standardis√©e\n * Tableau de 2 colonnes et 1 ligne avec contours invisibles\n * Le tableau prend toute la largeur de l'en-t√™te (100%)\n * Colonne gauche : Informations de l'organisme de formation\n * Colonne droite : Logo\n * Toutes les √©critures en Times New Roman, taille 8pt\n */\nconst premiumHeader = `\n  <div style=\"width: 100%; padding: 10px 0 10px 0; margin-bottom: 12px; font-family: 'Times New Roman', Times, serif;\">\n    <table cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%; border: 0; table-layout: fixed;\">\n      <tr>\n        <td style=\"width: 70%; vertical-align: top; padding-right: 15px; border: 0; text-align: left;\">\n          <p style=\"font-weight: bold; font-size: 7.5pt; font-family: 'Times New Roman', Times, serif; margin: 0 0 3px 0; color: #1A1A1A; line-height: 1.2;\">\n            {ecole_nom}\n          </p>\n          <p style=\"font-size: 7.5pt; font-family: 'Times New Roman', Times, serif; color: #666; margin: 1px 0; line-height: 1.3;\">\n            {ecole_adresse}\n          </p>\n          <p style=\"font-size: 7.5pt; font-family: 'Times New Roman', Times, serif; color: #666; margin: 1px 0; line-height: 1.3;\">\n            {ecole_code_postal} {ecole_ville}\n          </p>\n          <p style=\"font-size: 7.5pt; font-family: 'Times New Roman', Times, serif; color: #666; margin: 1px 0; line-height: 1.3;\">\n            Email : {ecole_email}\n          </p>\n          <p style=\"font-size: 7.5pt; font-family: 'Times New Roman', Times, serif; color: #666; margin: 1px 0; line-height: 1.3;\">\n            Tel : {ecole_telephone}\n          </p>\n        </td>\n        <td style=\"width: 30%; vertical-align: top; border: 0; text-align: right;\">\n          {ecole_logo}\n        </td>\n      </tr>\n    </table>\n  </div>\n`\n\n/**\n * Footer Premium - Style INSSI FORMATION\n * SIRET, d√©claration d'activit√©, mention l√©gale et pagination\n */\nconst premiumFooter = `\n  <div style=\"padding: 8px 0 6px 0; margin-top: 10px; background-color: #FAFAFA; font-family: 'Times New Roman', Times, serif;\">\n    <p style=\"font-size: 7pt; font-family: 'Times New Roman', Times, serif; color: #1A1A1A; margin: 0; text-align: center; font-weight: 500; line-height: 1.3;\">\n      {ecole_nom} | {ecole_adresse} {ecole_ville} {ecole_code_postal} | Num√©ro SIRET: {ecole_siret}\n    </p>\n    <p style=\"font-size: 7pt; font-family: 'Times New Roman', Times, serif; color: #666; margin: 2px 0 0 0; text-align: center; line-height: 1.2;\">\n      Num√©ro de d√©claration d'activit√©: {ecole_numero_declaration} <em>(aupr√®s du pr√©fet de r√©gion de: {ecole_region})</em>\n    </p>\n    <p style=\"font-size: 7pt; font-family: 'Times New Roman', Times, serif; color: #888; font-style: italic; margin: 2px 0 0 0; text-align: center; line-height: 1.2;\">\n      Cet enregistrement ne vaut pas l'agr√©ment de l'√âtat.\n    </p>\n  </div>\n`\n\n/**\n * S√©parateur horizontal simple\n */\nconst separator = '<div style=\"border-top: 1px solid #E5E7EB; margin: 20px 0;\"></div>'\n\n/**\n * G√©n√®re la section \"Entre les soussign√©s\" pour les contrats\n */\nfunction generatePartiesSection(): string {\n  return `\n    <div style=\"margin-bottom: 25px;\">\n      <p style=\"font-weight: bold; margin: 0 0 12px 0; font-size: 11pt;\">Entre l'organisme de formation : {ecole_nom}</p>\n      <p style=\"margin: 0 0 3px 0; font-size: 10pt;\">immatricul√©e au RCS de sous le num√©ro {ecole_siret}</p>\n      <p style=\"margin: 0 0 10px 0; font-size: 10pt;\">Dont le si√®ge social est situ√© {ecole_adresse} {ecole_code_postal} {ecole_ville}.</p>\n      \n      <p style=\"margin: 12px 0 0 0; font-size: 10pt;\">\n        Repr√©sent√©e aux fins des pr√©sentes par {ecole_representant} en sa qualit√© de repr√©sentant, d√ªment habilit√©(e).\n      </p>\n      <p style=\"margin: 5px 0 0 0; font-size: 10pt;\">\n        D√©claration d'activit√© n¬∞{ecole_numero_declaration} aupr√®s de la pr√©fecture de la r√©gion .\n      </p>\n      \n      <p style=\"margin: 15px 0 5px 0; font-weight: bold; font-style: italic; font-size: 10pt;\">\n        Ci-apr√®s d√©nomm√©e ¬´ l'Organisme de Formation ¬ª\n      </p>\n      \n      <p style=\"margin: 20px 0 10px 0; font-weight: bold; font-size: 11pt;\">D'une part</p>\n      \n      <p style=\"margin: 20px 0 10px 0; font-weight: bold; font-size: 11pt;\">Et {eleve_prenom} {eleve_nom}</p>\n      \n      <p style=\"margin: 15px 0 5px 0; font-weight: bold; font-style: italic; font-size: 10pt;\">\n        Ci-apr√®s d√©nomm√©e ¬´ le B√©n√©ficiaire ¬ª\n      </p>\n      \n      <p style=\"margin: 20px 0 10px 0; font-weight: bold; font-size: 11pt;\">D'autre part</p>\n      \n      <p style=\"margin: 20px 0 15px 0; font-style: italic; font-size: 10pt;\">\n        Ci-apr√®s individuellement ou collectivement d√©sign√©(s) la ou les ¬´ Partie(s) ¬ª\n      </p>\n    </div>\n  `\n}\n\n/**\n * G√©n√®re une section de signatures\n */\nfunction generateSignatureSection(leftTitle: string, rightTitle: string): string {\n  return `\n    <div style=\"margin-top: 40px;\">\n      <p style=\"text-align: center; margin-bottom: 25px; font-size: 10pt;\">\n        Fait √† {ecole_ville}, le {date_jour}\n      </p>\n      \n      <div style=\"display: flex; justify-content: space-between;\">\n        <div style=\"width: 45%; text-align: center;\">\n          <p style=\"font-weight: bold; margin-bottom: 50px; font-size: 10pt;\">${leftTitle}</p>\n          <p style=\"margin-bottom: 8px; font-size: 10pt;\">{ecole_nom}</p>\n          <div style=\"border-top: 1px solid #1A1A1A; margin: 0 auto; width: 80%; padding-top: 8px;\">\n            <p style=\"font-size: 9pt; color: #666;\">Signature</p>\n          </div>\n        </div>\n        <div style=\"width: 45%; text-align: center;\">\n          <p style=\"font-weight: bold; margin-bottom: 50px; font-size: 10pt;\">${rightTitle}</p>\n          <p style=\"margin-bottom: 8px; font-size: 10pt;\">{eleve_nom} {eleve_prenom}</p>\n          <div style=\"border-top: 1px solid #1A1A1A; margin: 0 auto; width: 80%; padding-top: 8px;\">\n            <p style=\"font-size: 9pt; color: #666;\">Signature</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  `\n}\n\n/**\n * Templates par d√©faut pour tous les types de documents\n */\nexport const documentTemplateDefaults: Record<DocumentType, DocumentTemplateDefault> = {\n  // ==========================================\n  // CONTRAT DE FORMATION PROFESSIONNELLE\n  // ==========================================\n  convention: {\n    type: 'convention',\n    name: 'Contrat de formation professionnelle',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 25px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;\">\n          Contrat de formation professionnelle\n        </h1>\n        <p style=\"font-size: 9pt; color: #666; margin: 0; font-style: italic;\">\n          (Article L. 6353-1 du Code du Travail D√©cret N¬∞ 2018-1341 du 28 d√©cembre 2018)\n        </p>\n      </div>\n\n      <div style=\"margin-bottom: 25px;\">\n        <p style=\"font-weight: bold; margin: 0 0 12px 0; font-size: 11pt;\">Entre l'organisme de formation : {ecole_nom}</p>\n        <p style=\"margin: 0 0 3px 0; font-size: 10pt;\">immatricul√©e au RCS de sous le num√©ro {ecole_siret}</p>\n        <p style=\"margin: 0 0 10px 0; font-size: 10pt;\">Dont le si√®ge social est situ√© {ecole_adresse} {ecole_code_postal} {ecole_ville}.</p>\n        \n        <p style=\"margin: 12px 0 0 0; font-size: 10pt;\">\n          Repr√©sent√©e aux fins des pr√©sentes par {ecole_representant} en sa qualit√© de repr√©sentant, d√ªment habilit√©(e).\n        </p>\n        <p style=\"margin: 5px 0 0 0; font-size: 10pt;\">\n          D√©claration d'activit√© n¬∞{ecole_numero_declaration} aupr√®s de la pr√©fecture de la r√©gion {ecole_region}.\n        </p>\n        \n        <p style=\"margin: 15px 0 5px 0; font-weight: bold; font-style: italic; font-size: 10pt;\">\n          Ci-apr√®s d√©nomm√©e ¬´ l'Organisme de Formation ¬ª\n        </p>\n        \n        <p style=\"margin: 20px 0 10px 0; font-weight: bold; font-size: 11pt;\">D'une part</p>\n        \n        <p style=\"margin: 20px 0 10px 0; font-weight: bold; font-size: 11pt;\">Et {eleve_prenom} {eleve_nom}</p>\n        \n        <p style=\"margin: 15px 0 5px 0; font-weight: bold; font-style: italic; font-size: 10pt;\">\n          Ci-apr√®s d√©nomm√©e ¬´ le B√©n√©ficiaire ¬ª\n        </p>\n        \n        <p style=\"margin: 20px 0 10px 0; font-weight: bold; font-size: 11pt;\">D'autre part</p>\n        \n        <p style=\"margin: 20px 0 15px 0; font-style: italic; font-size: 10pt;\">\n          Ci-apr√®s individuellement ou collectivement d√©sign√©(s) la ou les ¬´ Partie(s) ¬ª\n        </p>\n      </div>\n\n      <p style=\"text-align: justify; line-height: 1.6; margin: 20px 0; font-size: 10pt;\">\n        Il est conclu un contrat de formation professionnelle conform√©ment aux dispositions des articles L. 6311-1 √† L. 6363-2 du Code du Travail, et \n        √©galement en application des dispositions du Livre III de la 6√®me partie et des cat√©gories pr√©vues √† l'article L6313.1 du Code du Travail relatif √† la \n        formation professionnelle continue tout au long de la vie\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">1. Objet du contrat</h2>\n      <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n        Aux termes du pr√©sent contrat, l'Organisme de Formation s'engage √† organiser l'action de formation suivante :\n      </p>\n      <p style=\"font-weight: bold; font-size: 11pt; margin: 10px 0;\">{formation_nom} DU {session_debut} au {session_fin}</p>\n      \n      <p style=\"margin: 10px 0 5px 0; font-size: 10pt;\">\n        Cat√©gorie de l'action de formation (art. L6313-1 du code du travail) :<br/>\n        <strong>Action de formation</strong>\n      </p>\n      \n      <p style=\"margin: 15px 0 8px 0; font-size: 10pt;\">\n        Dipl√¥me vis√© : <strong>Certification (dont CQP) ou habilitation enregistr√©e au R√©pertoire National des Certifications Professionnelles (RNCP)</strong>\n      </p>\n      \n      <p style=\"margin: 15px 0 5px 0; font-size: 10pt;\">Objectifs : {formation_objectifs}</p>\n      <p style=\"margin: 5px 0; font-size: 10pt;\">Contenu de l'action de formation et moyens pr√©vus : Annexe 1</p>\n      <p style=\"margin: 5px 0; font-size: 10pt;\">Dur√©e : <strong>{formation_duree}</strong></p>\n      <p style=\"margin: 5px 0; font-size: 10pt;\">Lieu de la formation : <strong>{session_lieu}</strong></p>\n      <p style=\"margin: 5px 0; font-size: 10pt;\">Effectifs form√©s : <strong>{session_effectif}</strong></p>\n\n      <table style=\"width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 10pt;\">\n        <thead>\n          <tr style=\"background-color: #F3F4F6;\">\n            <th style=\"padding: 8px; text-align: left; border: 1px solid #E5E7EB; font-weight: bold;\">Date</th>\n            <th style=\"padding: 8px; text-align: center; border: 1px solid #E5E7EB; font-weight: bold;\">Heure</th>\n            <th style=\"padding: 8px; text-align: right; border: 1px solid #E5E7EB; font-weight: bold;\">Lieu</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td style=\"padding: 8px; border: 1px solid #E5E7EB;\">du {session_debut} au {session_fin}</td>\n            <td style=\"padding: 8px; text-align: center; border: 1px solid #E5E7EB;\">en pr√©sentiel</td>\n            <td style=\"padding: 8px; text-align: right; border: 1px solid #E5E7EB;\">en pr√©sentiel</td>\n          </tr>\n        </tbody>\n      </table>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">2. Effectif form√©</h2>\n      \n      <p style=\"font-size: 10pt; margin: 0 0 10px 0;\"><strong>Public vis√© au sens de l'article L 6313-3 du Code du Travail :</strong></p>\n      <ul style=\"margin: 10px 0 10px 20px; font-size: 10pt; line-height: 1.6;\">\n        <li>les actions de formation ont pour objet de permettre √† toute personne sans qualification professionnelle ou sans contrat de travail d'acc√©der dans les meilleures conditions √† un emploi</li>\n        <li>favoriser l'adaptation des travailleurs √† leur poste de travail, √† l'√©volution des emplois ainsi que leur maintien dans l'emploi et de participer au d√©veloppement des comp√©tences en lien ou non avec leur poste de travail. Elles peuvent permettre √† des travailleurs d'acqu√©rir une qualification plus √©lev√©e</li>\n        <li>r√©duire, pour les travailleurs dont l'emploi est menac√©, les risques r√©sultant d'une qualification inadapt√©e √† l'√©volution des techniques et des structures des entreprises, en les pr√©parant √† une mutation d'activit√© soit dans le cadre, soit en dehors de leur entreprise. Elles peuvent permettre √† des salari√©s dont le contrat de travail est rompu d'acc√©der √† des emplois exigeant une qualification diff√©rente, ou √† des non-salari√©s d'acc√©der √† de nouvelles activit√©s professionnelles</li>\n        <li>favoriser la mobilit√© professionnelle.</li>\n      </ul>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">3. Prix de la formation</h2>\n      <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n        En contrepartie de cette action de formation, le b√©n√©ficiaire (ou le financeur dans le cadre d'une subrogation de paiement) s'acquittera des co√ªts \n        suivants qui couvrent l'int√©gralit√© des frais engag√©s par l'organisme de formation pour cette session :\n      </p>\n      \n      <table style=\"width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 10pt;\">\n        <thead>\n          <tr style=\"background-color: #F3F4F6;\">\n            <th style=\"padding: 8px; text-align: left; border: 1px solid #E5E7EB; font-weight: bold;\">Description</th>\n            <th style=\"padding: 8px; text-align: right; border: 1px solid #E5E7EB; font-weight: bold;\">Prix</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td style=\"padding: 8px; border: 1px solid #E5E7EB;\">Formation</td>\n            <td style=\"padding: 8px; text-align: right; border: 1px solid #E5E7EB;\">{montant_ttc}‚Ç¨</td>\n          </tr>\n        </tbody>\n      </table>\n      \n      <p style=\"margin: 10px 0 5px 0; font-size: 10pt;\">L'organisme de formation atteste √™tre exon√©r√© de TVA.</p>\n      <p style=\"margin: 5px 0; font-size: 10pt; font-weight: bold;\">TOTAL NET DE TAXES : {montant_ttc}‚Ç¨</p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">4. Modalit√©s de d√©roulement (pr√©sentiel, √† distance, mixte, en situation de travail) et de suivi</h2>\n      <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n        La Formation s'effectue Formation pr√©sentielle.\n      </p>\n      <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n        Des feuilles de pr√©sence seront sign√©es par les Stagiaires et le(s) formateur(s) par demi-journ√©e de formation, l'objectif √©tant de justifier la \n        r√©alisation de la Formation.\n      </p>\n      <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n        L'appr√©ciation des r√©sultats se fera √† travers la mise en ≈ìuvre QCM et/ou grilles d'√©valuation et/ou travaux pratiques et/ou fiches d'√©valuation \n        et/ou mises en situation et/ou autre.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">5. Moyens de sanction (dipl√¥me, titre professionnel, certification, attestation de fin de formation ou autres)</h2>\n      <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n        √Ä l'issue de la Formation, l'Organisme de Formation d√©livre au Stagiaire le {diplome_ou_certification} en cas de r√©ussite.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">6. D√©dit ou abandon</h2>\n      <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n        En cas de d√©dit par le B√©n√©ficiaire √† moins de 7 jours francs avant le d√©but de l'action mentionn√©e √† l'article 1, ou d'abandon en cours de \n        Formation par un ou plusieurs Stagiaire(s), l'Organisme de Formation (i) remboursera sur le co√ªt total, les sommes qu'il n'aura pas r√©ellement \n        d√©pens√©es ou engag√©es pour la r√©alisation de ladite action et/ou (ii) proposera une nouvelle date de Formation.\n      </p>\n      <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n        Le cas √©ch√©ant, le B√©n√©ficiaire s'engage au versement d'un montant de 20 % du co√ªt total de la Formation √† titre de d√©dommagement, cette \n        somme ne pouvant faire l'objet d'un financement par fonds publics ou paritaires.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">7. Modalit√©s de r√®glement</h2>\n      <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n        Le paiement sera d√ª en totalit√© √† r√©ception d'une facture √©mise par l'Organisme de Formation √† destination du B√©n√©ficiaire.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">8. Propri√©t√© intellectuelle</h2>\n      <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n        Les supports de formation, quelle qu'en soit la forme, et les contenus de toute nature (textes, images, visuels, musiques, logos, marques, base de \n        donn√©es, etc.) exploit√©s par l'Organisme de Formation dans le cadre de l'action de formation sont prot√©g√©s par tous droits de propri√©t√© \n        intellectuelle ou droits des producteurs de bases de donn√©es en vigueur. Tous d√©sassemblages, d√©compilations, d√©cryptages, extractions, \n        r√©utilisations, copies et plus g√©n√©ralement, tous actes de reproduction, repr√©sentation, diffusion et utilisation de l'un quelconque de ces \n        √©l√©ments, en tout ou partie, sans l'autorisation de l'Organisme de Formation sont strictement interdits et pourront faire l'objet de poursuites \n        judiciaires.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">9. Donn√©es √† caract√®re personnel</h2>\n      <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n        L'Organisme de Formation pratique une politique de protection des donn√©es personnelles dont les caract√©ristiques sont explicit√©es dans la \n        politique de confidentialit√©.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">10. Diff√©rents √©ventuels</h2>\n      <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n        Si une contestation ou un diff√©rend ne peuvent √™tre r√©gl√©s √† l'amiable, le Tribunal de {ecole_ville} sera seul comp√©tent pour r√©gler le litige.\n      </p>\n\n      <p style=\"text-align: center; margin: 30px 0 20px 0; font-size: 10pt;\">\n        Document r√©alis√© en 2 exemplaires √† {ecole_ville}, le {date_jour}.\n      </p>\n\n      <div style=\"margin-top: 40px;\">\n        <p style=\"text-align: center; margin-bottom: 25px; font-size: 10pt;\">\n          Pour l'organisme de formation,\n        </p>\n        \n        <div style=\"display: flex; justify-content: space-between;\">\n          <div style=\"width: 45%; text-align: center;\">\n            <p style=\"font-weight: bold; margin-bottom: 50px; font-size: 10pt;\">Pour l'Organisme de Formation</p>\n            <p style=\"margin-bottom: 8px; font-size: 10pt;\">{ecole_nom}</p>\n            <div style=\"border-top: 1px solid #1A1A1A; margin: 0 auto; width: 80%; padding-top: 8px;\">\n              <p style=\"font-size: 9pt; color: #666;\">Signature</p>\n            </div>\n          </div>\n          <div style=\"width: 45%; text-align: center;\">\n            <p style=\"font-weight: bold; margin-bottom: 50px; font-size: 10pt;\">Pour le B√©n√©ficiaire</p>\n            <p style=\"margin-bottom: 8px; font-size: 10pt;\">{eleve_nom} {eleve_prenom}</p>\n            <div style=\"border-top: 1px solid #1A1A1A; margin: 0 auto; width: 80%; padding-top: 8px;\">\n              <p style=\"font-size: 9pt; color: #666;\">Signature</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div style=\"page-break-before: always; margin-top: 40px;\">\n        <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Annexe 1 : Programme de formation</h2>\n        <p style=\"font-size: 10pt; margin: 0 0 10px 0;\"><strong>Nom de la session :</strong> {formation_nom} DU {session_debut} au {session_fin}</p>\n        \n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">DUR√âE ET LIEU DE FORMATION</h3>\n        <ul style=\"margin: 10px 0 20px 20px; font-size: 10pt; line-height: 1.6;\">\n          <li>Dur√©e en heures : {formation_duree}</li>\n          <li>Lieu : {session_lieu}</li>\n        </ul>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">PUBLIC CONCERN√â</h3>\n        <p style=\"font-size: 10pt; margin: 0 0 20px 0;\">{formation_public_concerne}</p>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">PR√âREQUIS</h3>\n        <div style=\"font-size: 10pt; margin: 0 0 20px 0;\">\n          {formation_prerequis}\n        </div>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">QUALIT√â ET INDICATEURS DE R√âSULTATS</h3>\n        <p style=\"font-size: 10pt; margin: 0 0 20px 0;\">{formation_qualite_et_resultats}</p>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">ACCESSIBILIT√â</h3>\n        <p style=\"font-size: 10pt; margin: 0 0 20px 0;\">Formation accessible aux personnes en situation de handicap. Pour toutes demandes d'adaptation, veuillez contacter notre r√©f√©rent handicap.</p>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">OBJECTIFS</h3>\n        <div style=\"font-size: 10pt; margin: 0 0 20px 0;\">\n          {formation_objectifs}\n        </div>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">CONTENU DE LA FORMATION</h3>\n        <div style=\"font-size: 10pt; margin: 0 0 20px 0;\">\n          {formation_contenu}\n        </div>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">ORGANISATION DE LA FORMATION</h3>\n        <ul style=\"margin: 10px 0 20px 20px; font-size: 10pt; line-height: 1.6;\">\n          <li><strong>√âquipe p√©dagogique :</strong> {formation_equipe_pedagogique}</li>\n          <li><strong>Ressources p√©dagogiques et techniques pr√©vues :</strong> {formation_ressources}</li>\n          <li>accueil des Stagiaires dans une salle d√©di√©e √† la formation,</li>\n          <li>fourniture des supports de formation : {formation_supports}</li>\n        </ul>\n      </div>\n\n      <div style=\"page-break-before: always; margin-top: 40px;\">\n        <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Annexe 2 : R√®glement Int√©rieur</h2>\n        \n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">Article 1 - Objet et champ d'application</h3>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 15px 0; font-size: 10pt;\">\n          Conform√©ment aux dispositions des articles L.6352-3, L.6352-4 et R.6352-1 √† R.6352-15 du Code du Travail, le pr√©sent r√®glement a pour objet de \n          d√©terminer les principales mesures applicables en mati√®re de sant√©, de s√©curit√© et de discipline aux stagiaires de l'organisme de formation, \n          d√©nomm√© ci-apr√®s.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 15px 0; font-size: 10pt;\">\n          Tout stagiaire doit respecter les termes du pr√©sent r√®glement durant toute la dur√©e de l'action de formation.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n          Toutefois, lorsque la formation se d√©roule dans une entreprise d√©j√† dot√©e d'un r√®glement int√©rieur, les mesures de sant√© et de s√©curit√© \n          applicables aux stagiaires sont celles de ce r√®glement.\n        </p>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">Article 2 - Hygi√®ne et s√©curit√©</h3>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Chaque stagiaire doit veiller au respect des consignes g√©n√©rales et particuli√®res en mati√®re d'hygi√®ne et de s√©curit√©, sous peine de sanctions \n          disciplinaires.\n        </p>\n        <p style=\"font-size: 10pt; margin: 10px 0 5px 0; font-weight: bold;\">Propret√© des locaux</p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Les stagiaires doivent maintenir en ordre et en √©tat de propret√© constante les locaux o√π se d√©roule la formation. √Ä ce titre, il leur est interdit de \n          manger dans les salles de cours.\n        </p>\n        <p style=\"font-size: 10pt; margin: 10px 0 5px 0; font-weight: bold;\">Alcool et produits stup√©fiants</p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          L'introduction et la consommation de produits stup√©fiants ou de boissons alcoolis√©es est strictement interdite.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Il est √©galement interdit de p√©n√©trer ou de demeurer dans l'√©tablissement en √©tat d'ivresse ou sous l'emprise de produits stup√©fiants.\n        </p>\n        <p style=\"font-size: 10pt; margin: 10px 0 5px 0; font-weight: bold;\">Consignes de s√©curit√© ‚Äì Incendie</p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Les consignes d'incendie et notamment un plan de localisation des extincteurs et des issues de secours sont affich√©s dans les locaux de formation \n          de mani√®re √† √™tre connus des stagiaires.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Les stagiaires sont tenu¬∑e¬∑s d'ex√©cuter sans d√©lai l'ordre d'√©vacuation donn√© par l'animateur de la formation ou par un salari√© de l'entreprise o√π \n          se d√©roule la formation.\n        </p>\n        <p style=\"font-size: 10pt; margin: 10px 0 5px 0; font-weight: bold;\">Accident - d√©claration</p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Tout accident ou incident survenu √† l'occasion ou en cours de formation doit √™tre imm√©diatement d√©clar√© par le¬∑la stagiaire accident√©¬∑e ou les \n          personnes t√©moins de l'accident, √† l'organisme de formation.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Conform√©ment √† l'article R. 6342-3 du Code du Travail, l'accident survenu au¬∑√† la stagiaire pendant qu'il¬∑elle se trouve sur le lieu de formation ou \n          pendant qu'il¬∑elle s'y rend ou en revient, fait l'objet d'une d√©claration par l'organisme de formation aupr√®s de la caisse de s√©curit√© sociale.\n        </p>\n        <p style=\"font-size: 10pt; margin: 10px 0 5px 0; font-weight: bold;\">Interdiction de fumer ou de vapoter</p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n          Il est interdit de fumer ou de vapoter (utilisation d'une cigarette √©lectronique) dans les locaux de formation.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n          Les stagiaires sont toutefois autoris√©¬∑e¬∑s pendant leur temps de pause √† aller fumer ou vapoter √† l'ext√©rieur de l'√©tablissement.\n        </p>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">Article 3 ‚Äì Horaires, absences et retards</h3>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Les horaires de la formation seront communiqu√©s aux stagiaires au pr√©alable. Les stagiaires sont tenu¬∑e¬∑s de respecter ces horaires.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Sauf autorisation express, les stagiaires ne peuvent pas s'absenter pendant les heures de formation. L'√©margement devra √™tre fait au d√©but ou √† \n          la fin de chaque atelier selon la pratique de l'organisme de formation.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          En cas d'absence ou retard, les stagiaires en informent dans les plus brefs d√©lais l'organisme de formation et s'en justifier.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          L'employeur du stagiaire est inform√© des absences dans les meilleurs d√©lais qui suivent la connaissance par l'organisme de formation.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n          De plus, pour les stagiaires dont le co√ªt de la formation est pris en charge par un financeur externe (OPCO, P√¥le Emploi, Caisse des D√©p√¥ts), les \n          absences non justifi√©es entra√Ænent une retenue sur la prise en charge du co√ªt de la formation, proportionnelle √† la dur√©e de l'absence.\n        </p>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">Article 4 - Comportement</h3>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Il est demand√© √† tout stagiaire d'avoir un comportement garantissant le respect des r√®gles √©l√©mentaires de savoir vivre, de savoir √™tre en \n          collectivit√© et le bon d√©roulement des formations.\n        </p>\n        <p style=\"font-size: 10pt; margin: 10px 0 5px 0; font-weight: bold;\">√Ä titre d'exemple, il est formellement interdit aux stagiaires :</p>\n        <ul style=\"margin: 10px 0 10px 20px; font-size: 10pt; line-height: 1.6;\">\n          <li>De modifier, d'utiliser √† une fin tierce ou de diffuser les supports de formation sans l'autorisation express de l'organisme de formation ;</li>\n          <li>De modifier les r√©glages des param√®tres de l'ordinateur ;</li>\n          <li>D'utiliser leurs t√©l√©phones portables durant les sessions √† des fins autres que celles de la formation.</li>\n        </ul>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">Article 5 : Acc√®s aux locaux</h3>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Les stagiaires ont acc√®s aux locaux o√π se d√©roule la formation exclusivement pour suivre le stage auquel ils¬∑elles sont inscrit¬∑e¬∑s. Ils¬∑elles ne \n          peuvent y entrer ou y demeurer √† d'autres fins, sauf autorisation.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n          Il leur est interdit d'√™tre accompagn√©¬∑e¬∑s de personnes non inscrites au stage.\n        </p>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">Article 6 - Utilisation du mat√©riel</h3>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Tout¬∑e stagiaire est tenu¬∑e de conserver en bon √©tat le mat√©riel et la documentation mis √† la disposition par l'organisme de formation.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          L'utilisation du mat√©riel √† d'autres fins, notamment personnelles est interdite, sauf pour le mat√©riel mis √† disposition √† cet effet.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Il est formellement interdit de diffuser les codes personnels n√©cessaires pour se connecter √† l'espace extranet.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          A la fin du stage, le¬∑la stagiaire est tenu¬∑e de restituer tout mat√©riel et document en sa possession appartenant √† l'organisme de formation, sauf \n          les documents p√©dagogiques distribu√©s en cours de formation ou pr√©sents sur son extranet.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          La documentation p√©dagogique remise lors des sessions de formation est prot√©g√©e au titre des droits d'auteur et ne peut √™tre r√©utilis√©e que pour \n          un strict usage personnel.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n          Il est formellement interdit pour le.la stagiaire, sauf d√©rogation expresse, d'enregistrer ou de filmer les sessions de formation.\n        </p>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">Article 7 : Vol ou d√©gradation des biens personnels des stagiaires</h3>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n          L'organisme de formation d√©cline toute responsabilit√© en cas de perte, vol ou d√©t√©rioration des objets personnels de toute nature d√©pos√©s par \n          les stagiaires dans les locaux de formation.\n        </p>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">Article 8 - Sanctions</h3>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Tout agissement consid√©r√© comme fautif pourra, en fonction de sa gravit√©, faire l'objet de l'une ou l'autre des sanctions ci-apr√®s, sans \n          n√©cessairement suivre l'ordre de ce classement :\n        </p>\n        <ul style=\"margin: 10px 0 10px 20px; font-size: 10pt; line-height: 1.6;\">\n          <li>rappel √† l'ordre ;</li>\n          <li>avertissement √©crit ;</li>\n          <li>bl√¢me ;</li>\n          <li>exclusion temporaire de la formation ;</li>\n          <li>exclusion d√©finitive de la formation.</li>\n        </ul>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n          L'organisme de formation informe de la sanction prise le cas √©ch√©ant : l'employeur du¬∑de la stagiaire ou l'administration de l'agent stagiaire ; \n          et/ou le financeur du stage.\n        </p>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">Article 9 - Proc√©dure disciplinaire</h3>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          En application de l'article R.6352-4 du Code du Travail, ¬´ aucune sanction ne peut √™tre prononc√©e √† l'encontre du stagiaire sans que celui-ci ait \n          √©t√© inform√© au pr√©alable des griefs retenus contre lui ¬ª.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Lorsque l'organisme de formation envisage une prise de sanction, il convoque le la stagiaire par lettre recommand√©e avec accus√© de r√©ception ou \n          remise √† l'int√©ress√©ÃÅ contre d√©charge en lui indiquant l'objet de la convocation, la date, l'heure et le lieu de l'entretien, sauf si la sanction \n          envisag√©e n'a pas d'incidence sur la pr√©sence du de la stagiaire pour la suite de la formation.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Au cours de l'entretien, le.la stagiaire a la possibilit√© de se faire assister par une personne de son choix, stagiaire ou salari√© de l'organisme de \n          formation. La convocation mentionn√©e √† l'article pr√©c√®dent fait √©tat de cette facult√©. Lors de l'entretien, le motif de la sanction envisag√©e est \n          indiqu√© au √† la stagiaire : celui.celle-ci a alors la possibilit√© de donner toute explication ou justification des faits qui lui sont reproch√©s.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Lorsqu'une mesure conservatoire d'exclusion temporaire √† effet imm√©diat est consid√©r√©e comme indispensable par l'organisme de formation, \n          aucune sanction d√©finitive relative √† l'agissement fautif √† l'origine de cette exclusion ne peut √™tre prise sans que le la stagiaire n'ait √©t√© au \n          pr√©alable inform√© des griefs retenus contre lui elle et, √©ventuellement, qu'il elle ait √©t√© convoqu√©(e) √† un entretien et ait eu la possibilit√©ÃÅ de \n          s'expliquer devant un Commission de discipline.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          La sanction ne peut intervenir moins d'un jour franc ni plus de 15 jours apr√®s l'entretien o√π, le cas √©ch√©ant, apr√®s avis de la Commission de \n          discipline.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n          Elle fait l'objet d'une notification √©crite et motiv√©e au √† la stagiaire sous forme lettre recommand√©e, ou d'une lettre remise contre d√©charge.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n          L'organisme de formation informe concomitamment l'employeur, et √©ventuellement l'organisme paritaire prenant √† sa charge les frais de \n          formation, de la sanction prise.\n        </p>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">Article 10 : Repr√©sentation des stagiaires</h3>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Dans les stages d'une dur√©e sup√©rieure √† 500 heures, il est proc√©d√© simultan√©ment √† l'√©lection d'un d√©l√©gu√© titulaire et d'un d√©l√©gu√© suppl√©ant \n          conform√©ment aux dispositions des articles R.6352-9 et suivants du Code du Travail.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Tous les stagiaires sont √©lecteurs et √©ligibles, sauf les d√©tenus admis √† participer √† une action de formation professionnelle.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          L'organisme de formation organise le scrutin qui a lieu pendant les heures de formation, au plus t√¥t 20 heures, au plus tard 40 heures apr√®s le \n          d√©but du stage. En cas d'impossibilit√©ÃÅ de d√©signer les repr√©sentants des stagiaires, l'organisme de formation dresse un PV de carence qu'il \n          transmet au pr√©fet de r√©gion territorialement comp√©tent.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Les d√©l√©gu√©s sont √©lus pour la dur√©e de la formation. Leurs fonctions prennent fin lorsqu'ils cessent, pour quelque cause que ce soit, de participer \n          √† la formation.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0 0 10px 0; font-size: 10pt;\">\n          Si le d√©l√©gu√© titulaire et le d√©l√©gu√© suppl√©ant ont cess√© leurs fonctions avant la fin de la session de formation, il est proc√©d√© √† une nouvelle \n          √©lection dans les conditions pr√©vues aux articles R.6352-9 √† R.6352-12.\n        </p>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n          Les repr√©sentants des stagiaires font toute suggestion pour am√©liorer le d√©roulement des stages et les conditions de vie des stagiaires dans \n          l'organisme de formation. Ils pr√©sentent toutes les r√©clamations individuelles ou collectives relatives √† ces mati√®res, aux conditions d'hygi√®ne et \n          de s√©curit√© ÃÅ et √† l'application du r√®glement int√©rieur.\n        </p>\n\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 20px 0 10px 0; color: #1A1A1A;\">Article 11 : Publicit√©</h3>\n        <p style=\"text-align: justify; line-height: 1.6; margin: 0; font-size: 10pt;\">\n          Le pr√©sent r√®glement est affich√© dans les locaux et sur le site internet de l'organisme de formation. En outre, un exemplaire est remis √† chaque \n          stagiaire.\n        </p>\n\n        <p style=\"margin-top: 30px; font-size: 10pt;\">Fait √† {ecole_ville}</p>\n        <p style=\"margin: 5px 0 0 0; font-size: 10pt;\">Le {date_jour}</p>\n      </div>\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // FACTURE - ULTRA PREMIUM (1 page compacte)\n  // ==========================================\n  facture: {\n    type: 'facture',\n    name: 'Facture',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <!-- En-t√™te Facture Ultra Premium Compact -->\n      <div style=\"margin-bottom: 5px;\">\n        <table cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%; border: 0;\">\n          <tr>\n            <td style=\"width: 60%; vertical-align: top; border: 0;\">\n              <div style=\"background: linear-gradient(135deg, #1E3A5F 0%, #2563EB 100%); color: white; padding: 6px 12px; border-radius: 3px; display: inline-block;\">\n                <p style=\"margin: 0; font-size: 16pt; font-weight: 800; letter-spacing: 0.3px; font-family: 'Times New Roman', Times, serif;\">FACTURE</p>\n              </div>\n              <p style=\"margin: 3px 0 0 0; font-size: 10pt; font-weight: 700; color: #1E3A5F; font-family: 'Times New Roman', Times, serif;\">N¬∞ {numero_facture}</p>\n            </td>\n            <td style=\"width: 40%; vertical-align: top; border: 0; text-align: right;\">\n              <table cellpadding=\"0\" cellspacing=\"0\" style=\"margin-left: auto; border: 0;\">\n                <tr>\n                  <td style=\"padding: 1px 5px 1px 0; font-size: 6.5pt; color: #64748B; border: 0; text-align: right;\">Date d'√©mission</td>\n                  <td style=\"padding: 1px 0; font-size: 7.5pt; font-weight: 600; color: #1E293B; border: 0;\">{date_emission}</td>\n                </tr>\n                <tr>\n                  <td style=\"padding: 1px 5px 1px 0; font-size: 6.5pt; color: #64748B; border: 0; text-align: right;\">√âch√©ance</td>\n                  <td style=\"padding: 1px 0; font-size: 7.5pt; font-weight: 600; color: #DC2626; border: 0;\">{date_echeance}</td>\n                </tr>\n              </table>\n            </td>\n          </tr>\n        </table>\n      </div>\n\n      <!-- S√©parateur √©l√©gant -->\n      <div style=\"height: 1px; background: linear-gradient(90deg, #2563EB 0%, #60A5FA 50%, transparent 100%); margin: 4px 0;\"></div>\n\n      <!-- Informations Client Ultra Compact -->\n      <table cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%; margin-bottom: 5px; border: 0;\">\n        <tr>\n          <td style=\"width: 55%; vertical-align: top; padding-right: 8px; border: 0;\">\n            <div style=\"background: #F8FAFC; border-left: 2px solid #2563EB; padding: 4px 8px; border-radius: 0 2px 2px 0;\">\n              <p style=\"margin: 0 0 2px 0; font-size: 6pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.3px; color: #64748B;\">Factur√© √†</p>\n              <p style=\"margin: 0 0 1px 0; font-size: 9pt; font-weight: 700; color: #0F172A;\">{eleve_prenom} {eleve_nom}</p>\n              <p style=\"margin: 0 0 1px 0; font-size: 7pt; color: #475569; line-height: 1.15;\">{eleve_adresse}</p>\n              <p style=\"margin: 0 0 1px 0; font-size: 7pt; color: #475569; line-height: 1.15;\">{eleve_code_postal} {eleve_ville}</p>\n              <p style=\"margin: 0; font-size: 6.5pt; color: #475569; line-height: 1.15;\">{eleve_email} | {eleve_telephone}</p>\n            </div>\n          </td>\n          <td style=\"width: 45%; vertical-align: top; border: 0;\">\n            <div style=\"background: #EFF6FF; border: 1px solid #BFDBFE; padding: 4px 8px; border-radius: 2px;\">\n              <p style=\"margin: 0 0 2px 0; font-size: 6pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.3px; color: #1D4ED8;\">R√©f√©rence client</p>\n              <p style=\"margin: 0 0 1px 0; font-size: 8.5pt; font-weight: 700; color: #1E40AF;\">N¬∞ {eleve_numero}</p>\n              <p style=\"margin: 0; font-size: 7pt; color: #3B82F6; line-height: 1.15;\">{formation_nom}</p>\n            </div>\n          </td>\n        </tr>\n      </table>\n\n      <!-- Tableau des prestations Ultra Compact -->\n      <table cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%; margin-bottom: 5px; border-collapse: collapse; font-size: 7.5pt;\">\n        <thead>\n          <tr>\n            <th style=\"padding: 5px 6px; text-align: left; background: linear-gradient(135deg, #1E3A5F 0%, #1E40AF 100%); color: white; font-weight: 600; font-size: 6.5pt; text-transform: uppercase; letter-spacing: 0.2px;\">Description</th>\n            <th style=\"padding: 5px 4px; text-align: center; background: linear-gradient(135deg, #1E3A5F 0%, #1E40AF 100%); color: white; font-weight: 600; font-size: 6.5pt; text-transform: uppercase; width: 35px;\">Qt√©</th>\n            <th style=\"padding: 5px 4px; text-align: right; background: linear-gradient(135deg, #1E3A5F 0%, #1E40AF 100%); color: white; font-weight: 600; font-size: 6.5pt; text-transform: uppercase; width: 65px;\">P.U. HT</th>\n            <th style=\"padding: 5px 6px; text-align: right; background: linear-gradient(135deg, #1E3A5F 0%, #1E40AF 100%); color: white; font-weight: 600; font-size: 6.5pt; text-transform: uppercase; width: 65px;\">Total HT</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr style=\"background: #FFFFFF;\">\n            <td style=\"padding: 6px; border-bottom: 1px solid #E2E8F0; border-left: 1px solid #E2E8F0;\">\n              <p style=\"margin: 0 0 1px 0; font-weight: 600; font-size: 8pt; color: #0F172A;\">{formation_nom}</p>\n              <p style=\"margin: 0; font-size: 6.5pt; color: #64748B; line-height: 1.15;\">{session_debut} ‚Üí {session_fin} | {formation_duree}</p>\n            </td>\n            <td style=\"padding: 6px 4px; text-align: center; border-bottom: 1px solid #E2E8F0; font-weight: 500; color: #334155; font-size: 7.5pt;\">1</td>\n            <td style=\"padding: 6px 4px; text-align: right; border-bottom: 1px solid #E2E8F0; font-weight: 500; color: #334155; font-size: 7.5pt;\">{montant_ht} ‚Ç¨</td>\n            <td style=\"padding: 6px; text-align: right; border-bottom: 1px solid #E2E8F0; border-right: 1px solid #E2E8F0; font-weight: 700; color: #0F172A; font-size: 7.5pt;\">{montant_ht} ‚Ç¨</td>\n          </tr>\n        </tbody>\n      </table>\n\n      <!-- Bloc Totaux Ultra Compact -->\n      <table cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%; margin-bottom: 5px; border: 0;\">\n        <tr>\n          <td style=\"width: 50%; vertical-align: top; padding-right: 8px; border: 0;\">\n            <!-- Montant en lettres -->\n            <div style=\"background: #F0FDF4; border: 1px solid #86EFAC; padding: 4px 8px; border-radius: 2px;\">\n              <p style=\"margin: 0 0 1px 0; font-size: 6pt; font-weight: 700; text-transform: uppercase; letter-spacing: 0.2px; color: #166534;\">Arr√™t√© √† la somme de</p>\n              <p style=\"margin: 0; font-size: 7.5pt; font-style: italic; color: #15803D; line-height: 1.15;\">{montant_lettres}</p>\n            </div>\n          </td>\n          <td style=\"width: 50%; vertical-align: top; border: 0;\">\n            <table cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%; border-collapse: collapse;\">\n              <tr>\n                <td style=\"padding: 3px 6px; text-align: right; background: #F8FAFC; font-size: 7pt; color: #64748B; border: 1px solid #E2E8F0;\">Sous-total HT</td>\n                <td style=\"padding: 3px 6px; text-align: right; background: #F8FAFC; font-size: 7.5pt; font-weight: 600; color: #334155; border: 1px solid #E2E8F0; width: 70px;\">{montant_ht} ‚Ç¨</td>\n              </tr>\n              <tr>\n                <td style=\"padding: 3px 6px; text-align: right; background: #F8FAFC; font-size: 7pt; color: #64748B; border: 1px solid #E2E8F0;\">TVA ({taux_tva}%)</td>\n                <td style=\"padding: 3px 6px; text-align: right; background: #F8FAFC; font-size: 7.5pt; font-weight: 500; color: #334155; border: 1px solid #E2E8F0;\">{tva} ‚Ç¨</td>\n              </tr>\n              <tr>\n                <td style=\"padding: 5px; text-align: right; background: linear-gradient(135deg, #1E3A5F 0%, #1E40AF 100%); color: white; font-size: 8pt; font-weight: 700; border-radius: 0 0 0 2px;\">TOTAL TTC</td>\n                <td style=\"padding: 5px; text-align: right; background: linear-gradient(135deg, #1E3A5F 0%, #1E40AF 100%); color: white; font-size: 9.5pt; font-weight: 800; border-radius: 0 0 2px 0;\">{montant_ttc} ‚Ç¨</td>\n              </tr>\n            </table>\n          </td>\n        </tr>\n      </table>\n\n      <!-- Informations de paiement Ultra Compact -->\n      <table cellpadding=\"0\" cellspacing=\"0\" style=\"width: 100%; margin-bottom: 4px; border: 0;\">\n        <tr>\n          <td style=\"width: 50%; vertical-align: top; padding-right: 4px; border: 0;\">\n            <div style=\"background: #FEF3C7; border-left: 2px solid #F59E0B; padding: 4px 8px; border-radius: 0 2px 2px 0;\">\n              <p style=\"margin: 0 0 2px 0; font-size: 6.5pt; font-weight: 700; color: #92400E;\">üí≥ PAIEMENT</p>\n              <p style=\"margin: 0 0 1px 0; font-size: 6.5pt; color: #78350F; line-height: 1.1;\"><strong>Mode:</strong> {mode_paiement}</p>\n              <p style=\"margin: 0; font-size: 6.5pt; color: #78350F; line-height: 1.1;\"><strong>IBAN:</strong> {iban}</p>\n            </div>\n          </td>\n          <td style=\"width: 50%; vertical-align: top; padding-left: 4px; border: 0;\">\n            <div style=\"background: #FEF2F2; border-left: 2px solid #EF4444; padding: 4px 8px; border-radius: 0 2px 2px 0;\">\n              <p style=\"margin: 0 0 2px 0; font-size: 6.5pt; font-weight: 700; color: #991B1B;\">‚ö†Ô∏è RETARD</p>\n              <p style=\"margin: 0; font-size: 6pt; color: #7F1D1D; line-height: 1.1;\">Taux √ó 3 + 40‚Ç¨ (L441-10)</p>\n            </div>\n          </td>\n        </tr>\n      </table>\n\n      <!-- Mentions l√©gales ultra compactes -->\n      <div style=\"background: #F1F5F9; padding: 3px 8px; border-radius: 2px; margin-top: 3px;\">\n        <p style=\"margin: 0; font-size: 6pt; color: #64748B; text-align: center; line-height: 1.2;\">\n          TVA non applicable (art. 293B CGI) ‚Ä¢ SIRET: {ecole_siret} ‚Ä¢ D√©claration: {ecole_numero_declaration}\n        </p>\n      </div>\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // DEVIS\n  // ==========================================\n  devis: {\n    type: 'devis',\n    name: 'Devis',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 25px;\">\n        <div style=\"flex: 1;\">\n          <h1 style=\"font-size: 20pt; font-weight: bold; margin: 0; color: #1A1A1A;\">DEVIS</h1>\n          <p style=\"font-size: 12pt; margin: 8px 0 0 0; color: #666;\">N¬∞ {numero_devis}</p>\n        </div>\n        <div style=\"text-align: right;\">\n          <p style=\"font-size: 10pt; margin: 0;\"><strong>Date d'√©mission :</strong> {date_emission}</p>\n          <p style=\"font-size: 10pt; margin: 5px 0;\"><strong>Valable jusqu'au :</strong> {validite_devis}</p>\n        </div>\n      </div>\n\n      ${separator}\n\n      <div style=\"display: flex; justify-content: space-between; margin-bottom: 25px;\">\n        <div style=\"width: 48%; padding: 15px; background-color: #F9FAFB; border-left: 3px solid #1A1A1A;\">\n          <p style=\"font-weight: bold; margin: 0 0 10px 0; font-size: 10pt; text-transform: uppercase; color: #666;\">Devis pour :</p>\n          <p style=\"margin: 0; font-size: 11pt; font-weight: bold;\">{eleve_nom} {eleve_prenom}</p>\n          <p style=\"margin: 5px 0; font-size: 10pt; color: #666;\">{eleve_adresse}</p>\n          <p style=\"margin: 3px 0; font-size: 10pt; color: #666;\">T√©l : {eleve_telephone}</p>\n          <p style=\"margin: 3px 0; font-size: 10pt; color: #666;\">Email : {eleve_email}</p>\n        </div>\n      </div>\n\n      <div style=\"padding: 15px; background-color: #F0F9FF; border-left: 3px solid #0EA5E9; margin-bottom: 20px;\">\n        <p style=\"margin: 0; font-size: 11pt; font-weight: 600;\">\n          Objet : Devis pour la formation \"{formation_nom}\"\n        </p>\n        <p style=\"margin: 8px 0 0 0; font-size: 10pt; color: #333;\">{formation_description}</p>\n      </div>\n\n      <table style=\"width: 100%; border-collapse: collapse; margin: 25px 0; font-size: 10pt;\">\n        <thead>\n          <tr style=\"background-color: #1A1A1A; color: white;\">\n            <th style=\"padding: 10px 12px; text-align: left; font-weight: bold;\">Description de la formation</th>\n            <th style=\"padding: 10px 12px; text-align: center; font-weight: bold; width: 80px;\">Dur√©e</th>\n            <th style=\"padding: 10px 12px; text-align: right; font-weight: bold; width: 100px;\">Prix HT</th>\n            <th style=\"padding: 10px 12px; text-align: right; font-weight: bold; width: 100px;\">Montant HT</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr style=\"border-bottom: 1px solid #E5E7EB;\">\n            <td style=\"padding: 12px;\">\n              <p style=\"margin: 0; font-weight: 600;\">{formation_nom}</p>\n              <p style=\"margin: 4px 0 0 0; font-size: 9pt; color: #666;\">P√©riode : {session_debut} au {session_fin}</p>\n              <p style=\"margin: 2px 0 0 0; font-size: 9pt; color: #666;\">Lieu : {session_lieu}</p>\n            </td>\n            <td style=\"padding: 12px; text-align: center; font-weight: 500;\">{formation_duree}</td>\n            <td style=\"padding: 12px; text-align: right; font-weight: 500;\">{montant_ht} ‚Ç¨</td>\n            <td style=\"padding: 12px; text-align: right; font-weight: 600;\">{montant_ht} ‚Ç¨</td>\n          </tr>\n        </tbody>\n      </table>\n\n      <div style=\"display: flex; justify-content: flex-end; margin-bottom: 25px;\">\n        <table style=\"width: 280px; border-collapse: collapse; font-size: 10pt;\">\n          <tr style=\"border-bottom: 1px solid #E5E7EB;\">\n            <td style=\"padding: 8px 12px; text-align: right; background-color: #F9FAFB;\">Sous-total HT :</td>\n            <td style=\"padding: 8px 12px; text-align: right; background-color: #F9FAFB; font-weight: 600;\">{montant_ht} ‚Ç¨</td>\n          </tr>\n          <tr style=\"border-bottom: 1px solid #E5E7EB;\">\n            <td style=\"padding: 8px 12px; text-align: right; background-color: #F9FAFB;\">TVA ({taux_tva}%) :</td>\n            <td style=\"padding: 8px 12px; text-align: right; background-color: #F9FAFB;\">{tva} ‚Ç¨</td>\n          </tr>\n          <tr style=\"background-color: #1A1A1A; color: white;\">\n            <td style=\"padding: 12px; text-align: right; font-weight: bold; font-size: 12pt;\">TOTAL TTC :</td>\n            <td style=\"padding: 12px; text-align: right; font-weight: bold; font-size: 12pt;\">{montant_ttc} ‚Ç¨</td>\n          </tr>\n        </table>\n      </div>\n\n      <div style=\"padding: 15px; background-color: #FEF3C7; border-left: 3px solid #F59E0B; margin-bottom: 20px;\">\n        <p style=\"margin: 0 0 10px 0; font-size: 10pt; font-weight: 600; color: #92400E;\">\n          Conditions et validit√© du devis\n        </p>\n        <ul style=\"margin: 0 0 0 20px; font-size: 10pt; line-height: 1.6; color: #78350F;\">\n          <li>Ce devis est valable jusqu'au <strong>{validite_devis}</strong></li>\n          <li>Modalit√©s de paiement : <strong>{mode_paiement}</strong></li>\n          <li>La r√©servation est d√©finitive apr√®s acceptation √©crite du pr√©sent devis</li>\n          <li>En cas d'acceptation, un acompte de 30% peut √™tre demand√©</li>\n        </ul>\n      </div>\n\n      <div style=\"padding: 15px; background-color: #F0FDF4; border-left: 3px solid #10B981;\">\n        <p style=\"margin: 0; font-size: 10pt; line-height: 1.6; color: #166534;\">\n          <strong>Pour accepter ce devis :</strong><br/>\n          Veuillez retourner ce document sign√© par courrier, email ({ecole_email}) ou directement √† notre secr√©tariat \n          avant le {validite_devis}.\n        </p>\n      </div>\n\n      ${generateSignatureSection('L\\'Organisme de Formation', 'Le Client (Bon pour accord)')}\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // CONVOCATION\n  // ==========================================\n  convocation: {\n    type: 'convocation',\n    name: 'Convocation',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 25px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;\">\n          CONVOCATION\n        </h1>\n      </div>\n\n      <div style=\"margin-bottom: 25px;\">\n        <p style=\"font-size: 10pt; margin: 0 0 15px 0;\">Madame, Monsieur,</p>\n        <p style=\"font-size: 10pt; margin: 0 0 10px 0; text-align: justify; line-height: 1.6;\">\n          Nous avons l'honneur de vous convier √† :\n        </p>\n      </div>\n\n      <div style=\"padding: 20px; background-color: #F9FAFB; border-left: 3px solid #1A1A1A; margin-bottom: 25px;\">\n        <p style=\"margin: 0 0 10px 0; font-size: 10pt;\"><strong>Objet :</strong> {convocation_objet}</p>\n        <p style=\"margin: 0 0 10px 0; font-size: 10pt;\"><strong>Date :</strong> {convocation_date}</p>\n        <p style=\"margin: 0 0 10px 0; font-size: 10pt;\"><strong>Heure :</strong> {convocation_heure}</p>\n        <p style=\"margin: 0 0 10px 0; font-size: 10pt;\"><strong>Lieu :</strong> {convocation_lieu}</p>\n        <p style=\"margin: 0 0 10px 0; font-size: 10pt;\"><strong>Adresse :</strong> {convocation_adresse}</p>\n        <p style=\"margin: 0; font-size: 10pt;\"><strong>Dur√©e pr√©vue :</strong> {convocation_duree}</p>\n      </div>\n\n      <div style=\"margin-bottom: 25px;\">\n        <p style=\"margin: 0 0 8px 0; font-size: 10pt;\"><strong>Participant(s) :</strong></p>\n        <p style=\"margin: 0; font-size: 10pt;\">{eleve_nom} {eleve_prenom}</p>\n        <p style=\"margin: 5px 0 0 0; font-size: 10pt;\">Num√©ro d'√©l√®ve : {eleve_numero}</p>\n        <p style=\"margin: 5px 0 0 0; font-size: 10pt;\">Formation : {formation_nom}</p>\n      </div>\n\n      <div style=\"margin-bottom: 25px;\">\n        <p style=\"margin: 0 0 8px 0; font-size: 10pt;\"><strong>Ordre du jour :</strong></p>\n        <div style=\"margin-left: 15px; font-size: 10pt;\">\n          {convocation_contenu}\n        </div>\n      </div>\n\n      <div style=\"padding: 15px; background-color: #FEF3C7; border-left: 3px solid #F59E0B; margin-bottom: 25px;\">\n        <p style=\"margin: 0; font-size: 10pt; font-weight: 600; color: #92400E;\">Note importante :</p>\n        <p style=\"margin: 5px 0 0 0; font-size: 10pt; color: #78350F;\">\n          Veuillez confirmer votre pr√©sence avant le {date_confirmation} en r√©pondant √† ce message ou en contactant \n          le {ecole_telephone}.\n        </p>\n      </div>\n\n      <p style=\"margin: 25px 0 10px 0; font-size: 10pt;\">Nous restons √† votre disposition pour tout compl√©ment d'information.</p>\n      <p style=\"margin: 10px 0 20px 0; font-size: 10pt;\">Cordialement,</p>\n      \n      <div style=\"margin-top: 30px;\">\n        <p style=\"margin: 0; font-size: 10pt; font-weight: bold;\">{ecole_representant}</p>\n        <p style=\"margin: 3px 0; font-size: 10pt;\">{ecole_nom}</p>\n      </div>\n\n      <p style=\"margin-top: 25px; font-size: 9pt; color: #666;\">\n        Fait √† {ecole_ville}, le {date_jour}\n      </p>\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // CONTRAT DE SCOLARIT√â\n  // ==========================================\n  contrat: {\n    type: 'contrat',\n    name: 'Contrat de scolarit√©',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 25px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;\">\n          CONTRAT DE SCOLARIT√â\n        </h1>\n        <p style=\"font-size: 11pt; color: #666; margin: 0;\">Ann√©e scolaire {annee_scolaire}</p>\n      </div>\n\n      ${generatePartiesSection()}\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 1 - Inscription et scolarit√©</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt;\">\n        L'√©l√®ve <strong>{eleve_nom} {eleve_prenom}</strong> est inscrit(e) pour l'ann√©e scolaire <strong>{annee_scolaire}</strong> \n        dans la classe <strong>{eleve_classe}</strong> de l'√©tablissement <strong>{ecole_nom}</strong>.\n      </p>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin-top: 10px;\">\n        La scolarit√© d√©bute le {session_debut} et se termine le {session_fin}. \n        Les cours sont dispens√©s selon le calendrier scolaire et les horaires d√©finis par l'√©tablissement.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 2 - Frais de scolarit√©</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt;\">\n        Les frais de scolarit√© pour l'ann√©e scolaire <strong>{annee_scolaire}</strong> s'√©l√®vent √† \n        <strong>{montant_ttc} ‚Ç¨</strong> (en toutes lettres : {montant_lettres}).\n      </p>\n      <p style=\"margin: 15px 0 5px 0; font-size: 10pt;\"><strong>Modalit√©s de paiement :</strong></p>\n      <p style=\"font-size: 10pt; margin: 0;\">{mode_paiement}</p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 3 - Obligations de l'√©l√®ve</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt;\">L'√©l√®ve s'engage √† :</p>\n      <ul style=\"margin: 10px 0 10px 20px; font-size: 10pt; line-height: 1.6;\">\n        <li>Suivre assid√ªment tous les cours et activit√©s p√©dagogiques</li>\n        <li>Respecter le r√®glement int√©rieur de l'√©tablissement</li>\n        <li>Acquitter les frais de scolarit√© dans les d√©lais convenus</li>\n        <li>Participer activement aux √©valuations</li>\n      </ul>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 4 - Engagements de l'√©tablissement</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt;\">L'√©tablissement s'engage √† :</p>\n      <ul style=\"margin: 10px 0 10px 20px; font-size: 10pt; line-height: 1.6;\">\n        <li>Dispenser un enseignement de qualit√© conforme aux programmes</li>\n        <li>Fournir les moyens p√©dagogiques n√©cessaires</li>\n        <li>Assurer le suivi p√©dagogique et l'√©valuation des acquis</li>\n        <li>D√©livrer les documents administratifs n√©cessaires</li>\n      </ul>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 5 - R√©siliation</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt;\">\n        Le pr√©sent contrat peut √™tre r√©sili√© par l'une ou l'autre des parties, sous r√©serve d'un pr√©avis d'un mois. \n        En cas de r√©siliation par l'√©l√®ve ou sa famille, les frais de scolarit√© dus pour la p√©riode d√©j√† √©coul√©e \n        restent acquis √† l'√©tablissement.\n      </p>\n\n      ${generateSignatureSection('L\\'√âtablissement', 'L\\'√âl√®ve / Repr√©sentant l√©gal')}\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // ATTESTATION DE R√âUSSITE\n  // ==========================================\n  attestation_reussite: {\n    type: 'attestation_reussite',\n    name: 'Attestation de r√©ussite',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 30px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;\">\n          ATTESTATION DE R√âUSSITE\n        </h1>\n      </div>\n\n      <div style=\"margin-bottom: 25px;\">\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;\">\n          Le directeur de <strong>{ecole_nom}</strong>, √©tablissement situ√© √† <strong>{ecole_adresse}</strong>,\n        </p>\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;\">\n          <strong>ATTESTE</strong> que <strong>{eleve_nom} {eleve_prenom}</strong>, n√©(e) le \n          <strong>{eleve_date_naissance}</strong>, num√©ro d'√©l√®ve <strong>{eleve_numero}</strong>,\n        </p>\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;\">\n          a suivi avec <strong>assiduit√©</strong> et a <strong>r√©ussi</strong> la formation intitul√©e \n          <strong>\"{formation_nom}\"</strong>\n        </p>\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0;\">\n          qui s'est d√©roul√©e du <strong>{session_debut}</strong> au <strong>{session_fin}</strong> \n          (dur√©e : {formation_duree}).\n        </p>\n      </div>\n\n      <div style=\"padding: 15px; background-color: #F0F9FF; border-left: 3px solid #0EA5E9; margin-bottom: 25px;\">\n        <p style=\"margin: 0; font-size: 10pt; font-weight: bold;\">R√©sultats :</p>\n        <p style=\"margin: 8px 0 0 0; font-size: 10pt;\">Moyenne g√©n√©rale : <strong>{moyenne}/20</strong></p>\n        <p style=\"margin: 5px 0 0 0; font-size: 10pt;\">Mention : <strong>{mention}</strong></p>\n        <p style=\"margin: 5px 0 0 0; font-size: 10pt;\">Classement : <strong>{classement}</strong></p>\n      </div>\n\n      <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 30px 0;\">\n        La pr√©sente attestation est d√©livr√©e √† l'int√©ress√©(e) pour servir et valoir ce que de droit.\n      </p>\n\n      <div style=\"margin-top: 50px; text-align: right;\">\n        <p style=\"margin: 0; font-size: 10pt;\">Fait √† {ecole_ville}, le {date_jour}</p>\n        <div style=\"margin-top: 40px;\">\n          <p style=\"margin: 0; font-weight: bold; font-size: 10pt;\">{ecole_representant}</p>\n          <p style=\"margin: 3px 0 0 0; font-size: 10pt;\">Directeur</p>\n          <div style=\"border-top: 1px solid #1A1A1A; margin: 30px 0 0 auto; width: 180px; padding-top: 8px; text-align: center;\">\n            <p style=\"font-size: 9pt; color: #666; margin: 0;\">Signature et cachet</p>\n          </div>\n        </div>\n      </div>\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // CERTIFICAT DE SCOLARIT√â\n  // ==========================================\n  certificat_scolarite: {\n    type: 'certificat_scolarite',\n    name: 'Certificat de scolarit√©',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 30px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;\">\n          CERTIFICAT DE SCOLARIT√â\n        </h1>\n        <p style=\"font-size: 11pt; color: #666; margin: 0;\">Ann√©e scolaire {annee_scolaire}</p>\n      </div>\n\n      <div style=\"margin-bottom: 25px;\">\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;\">\n          Le directeur de <strong>{ecole_nom}</strong>, √©tablissement situ√© √† <strong>{ecole_adresse}</strong>,\n        </p>\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;\">\n          <strong>CERTIFIE</strong> que <strong>{eleve_nom} {eleve_prenom}</strong>, n√©(e) le \n          <strong>{eleve_date_naissance}</strong>, num√©ro d'√©l√®ve <strong>{eleve_numero}</strong>,\n        </p>\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;\">\n          est r√©guli√®rement inscrit(e) dans cet √©tablissement pour l'ann√©e scolaire <strong>{annee_scolaire}</strong>,\n        </p>\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0;\">\n          en classe de <strong>{eleve_classe}</strong>.\n        </p>\n      </div>\n\n      <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 40px 0;\">\n        Le pr√©sent certificat est d√©livr√© √† l'int√©ress√©(e) pour servir et valoir ce que de droit.\n      </p>\n\n      <div style=\"margin-top: 50px; text-align: right;\">\n        <p style=\"margin: 0; font-size: 10pt;\">Fait √† {ecole_ville}, le {date_jour}</p>\n        <div style=\"margin-top: 40px;\">\n          <p style=\"margin: 0; font-weight: bold; font-size: 10pt;\">{ecole_representant}</p>\n          <p style=\"margin: 3px 0 0 0; font-size: 10pt;\">Directeur</p>\n          <div style=\"border-top: 1px solid #1A1A1A; margin: 30px 0 0 auto; width: 180px; padding-top: 8px; text-align: center;\">\n            <p style=\"font-size: 9pt; color: #666; margin: 0;\">Signature et cachet</p>\n          </div>\n        </div>\n      </div>\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // RELEV√â DE NOTES\n  // ==========================================\n  releve_notes: {\n    type: 'releve_notes',\n    name: 'Relev√© de notes',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 25px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;\">\n          RELEV√â DE NOTES\n        </h1>\n        <p style=\"font-size: 11pt; color: #666; margin: 0;\">Ann√©e scolaire {annee_scolaire} - {trimestre}</p>\n      </div>\n\n      <div style=\"padding: 15px; background-color: #F9FAFB; border-left: 3px solid #1A1A1A; margin-bottom: 25px;\">\n        <table style=\"width: 100%; border-collapse: collapse; font-size: 10pt;\">\n          <tr><td style=\"padding: 4px 0; width: 150px; font-weight: 600;\">Nom :</td><td style=\"padding: 4px 0; font-weight: bold;\">{eleve_nom}</td></tr>\n          <tr><td style=\"padding: 4px 0; font-weight: 600;\">Pr√©nom :</td><td style=\"padding: 4px 0; font-weight: bold;\">{eleve_prenom}</td></tr>\n          <tr><td style=\"padding: 4px 0; font-weight: 600;\">Num√©ro d'√©l√®ve :</td><td style=\"padding: 4px 0;\">{eleve_numero}</td></tr>\n          <tr><td style=\"padding: 4px 0; font-weight: 600;\">Classe :</td><td style=\"padding: 4px 0;\">{eleve_classe}</td></tr>\n        </table>\n      </div>\n\n      <table style=\"width: 100%; border-collapse: collapse; margin: 25px 0; font-size: 10pt;\">\n        <thead>\n          <tr style=\"background-color: #1A1A1A; color: white;\">\n            <th style=\"padding: 10px 12px; text-align: left; font-weight: bold;\">Mati√®re</th>\n            <th style=\"padding: 10px 12px; text-align: center; font-weight: bold; width: 70px;\">Coeff.</th>\n            <th style=\"padding: 10px 12px; text-align: center; font-weight: bold; width: 80px;\">Note /20</th>\n            <th style=\"padding: 10px 12px; text-align: left; font-weight: bold;\">Appr√©ciation</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr style=\"border-bottom: 1px solid #E5E7EB; background-color: #FAFAFA;\">\n            <td style=\"padding: 10px 12px; font-weight: 500;\">{matiere_1}</td>\n            <td style=\"padding: 10px 12px; text-align: center;\">{coef_1}</td>\n            <td style=\"padding: 10px 12px; text-align: center; font-weight: bold;\">{note_1}</td>\n            <td style=\"padding: 10px 12px; font-size: 9pt; color: #666;\">{appreciation_1}</td>\n          </tr>\n          <tr style=\"border-bottom: 1px solid #E5E7EB;\">\n            <td style=\"padding: 10px 12px; font-weight: 500;\">{matiere_2}</td>\n            <td style=\"padding: 10px 12px; text-align: center;\">{coef_2}</td>\n            <td style=\"padding: 10px 12px; text-align: center; font-weight: bold;\">{note_2}</td>\n            <td style=\"padding: 10px 12px; font-size: 9pt; color: #666;\">{appreciation_2}</td>\n          </tr>\n          <tr style=\"border-bottom: 1px solid #E5E7EB; background-color: #FAFAFA;\">\n            <td style=\"padding: 10px 12px; font-weight: 500;\">{matiere_3}</td>\n            <td style=\"padding: 10px 12px; text-align: center;\">{coef_3}</td>\n            <td style=\"padding: 10px 12px; text-align: center; font-weight: bold;\">{note_3}</td>\n            <td style=\"padding: 10px 12px; font-size: 9pt; color: #666;\">{appreciation_3}</td>\n          </tr>\n        </tbody>\n      </table>\n\n      <div style=\"display: flex; justify-content: space-between; padding: 15px; background-color: #F0F9FF; border-left: 3px solid #0EA5E9; margin-bottom: 25px;\">\n        <div style=\"flex: 1;\">\n          <p style=\"margin: 0 0 8px 0; font-size: 11pt;\">\n            <strong>Moyenne g√©n√©rale :</strong> <span style=\"font-size: 14pt; font-weight: bold;\">{moyenne}/20</span>\n          </p>\n          <p style=\"margin: 0 0 5px 0; font-size: 10pt; color: #666;\">Moyenne de la classe : {moyenne_classe}/20</p>\n          <p style=\"margin: 0; font-size: 10pt; color: #666;\">Classement : {classement} sur {effectif_classe} √©l√®ves</p>\n        </div>\n        <div style=\"text-align: right; padding-left: 20px;\">\n          <div style=\"padding: 10px 15px; background-color: #FEF3C7; border-radius: 4px; display: inline-block;\">\n            <p style=\"margin: 0; font-size: 9pt; font-weight: 600; color: #92400E; text-transform: uppercase;\">Mention</p>\n            <p style=\"margin: 4px 0 0 0; font-size: 12pt; font-weight: bold; color: #78350F;\">{mention}</p>\n          </div>\n        </div>\n      </div>\n\n      <div style=\"padding: 15px; background-color: #F9FAFB; border-left: 3px solid #1A1A1A; margin-bottom: 25px;\">\n        <p style=\"font-weight: bold; margin: 0 0 10px 0; font-size: 10pt;\">Appr√©ciation g√©n√©rale :</p>\n        <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; color: #333; margin: 0;\">\n          {appreciations}\n        </p>\n      </div>\n\n      <div style=\"margin-top: 40px; text-align: right;\">\n        <p style=\"margin: 0; font-size: 10pt;\">Fait √† {ecole_ville}, le {date_jour}</p>\n        <div style=\"margin-top: 30px;\">\n          <p style=\"margin: 0; font-weight: bold; font-size: 10pt;\">{ecole_representant}</p>\n          <p style=\"margin: 3px 0 0 0; font-size: 10pt;\">Directeur</p>\n        </div>\n      </div>\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // ATTESTATION D'ENTR√âE EN FORMATION\n  // ==========================================\n  attestation_entree: {\n    type: 'attestation_entree',\n    name: 'Attestation d\\'entr√©e en formation',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 30px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;\">\n          ATTESTATION D'ENTR√âE EN FORMATION\n        </h1>\n      </div>\n\n      <div style=\"margin-bottom: 25px;\">\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;\">\n          Le directeur de <strong>{ecole_nom}</strong>, √©tablissement situ√© √† <strong>{ecole_adresse}</strong>,\n        </p>\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;\">\n          <strong>ATTESTE</strong> que <strong>{eleve_nom} {eleve_prenom}</strong>, n√©(e) le \n          <strong>{eleve_date_naissance}</strong>, num√©ro d'√©l√®ve <strong>{eleve_numero}</strong>,\n        </p>\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;\">\n          a √©t√© admis(e) et s'est inscrit(e) dans la formation intitul√©e <strong>\"{formation_nom}\"</strong>\n        </p>\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0;\">\n          qui d√©butera le <strong>{session_debut}</strong> et se terminera le <strong>{session_fin}</strong> \n          (dur√©e : {formation_duree}).\n        </p>\n      </div>\n\n      <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 40px 0;\">\n        La pr√©sente attestation est d√©livr√©e √† l'int√©ress√©(e) pour servir et valoir ce que de droit, \n        notamment pour l'√©tablissement des droits sociaux et administratifs.\n      </p>\n\n      <div style=\"margin-top: 50px; text-align: right;\">\n        <p style=\"margin: 0; font-size: 10pt;\">Fait √† {ecole_ville}, le {date_jour}</p>\n        <div style=\"margin-top: 40px;\">\n          <p style=\"margin: 0; font-weight: bold; font-size: 10pt;\">{ecole_representant}</p>\n          <p style=\"margin: 3px 0 0 0; font-size: 10pt;\">Directeur</p>\n          <div style=\"border-top: 1px solid #1A1A1A; margin: 30px 0 0 auto; width: 180px; padding-top: 8px; text-align: center;\">\n            <p style=\"font-size: 9pt; color: #666; margin: 0;\">Signature et cachet</p>\n          </div>\n        </div>\n      </div>\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // R√àGLEMENT INT√âRIEUR\n  // ==========================================\n  reglement_interieur: {\n    type: 'reglement_interieur',\n    name: 'R√®glement int√©rieur',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 25px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;\">\n          R√àGLEMENT INT√âRIEUR\n        </h1>\n        <p style=\"font-size: 11pt; color: #666; margin: 0;\">Ann√©e scolaire {annee_scolaire}</p>\n      </div>\n\n      <div style=\"margin-bottom: 25px;\">\n        <h2 style=\"font-size: 12pt; font-weight: bold; margin: 0 0 12px 0; color: #1A1A1A;\">PR√âAMBULE</h2>\n        <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n          Le pr√©sent r√®glement int√©rieur a pour objet de fixer les r√®gles de vie collective applicables \n          √† tous les membres de la communaut√© √©ducative de <strong>{ecole_nom}</strong>. Il s'applique \n          √† l'ensemble des personnes pr√©sentes dans l'√©tablissement.\n        </p>\n      </div>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 1 : Principes g√©n√©raux</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        L'√©tablissement <strong>{ecole_nom}</strong> a pour mission de dispenser un enseignement de qualit√© \n        dans le respect des valeurs de la R√©publique : libert√©, √©galit√©, fraternit√©, la√Øcit√©.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 2 : Horaires</h2>\n      <ul style=\"margin: 10px 0 10px 20px; font-size: 10pt; line-height: 1.6;\">\n        <li>Horaires d'ouverture : {horaires_ouverture}</li>\n        <li>Horaires des cours : {horaires_cours}</li>\n        <li>Les √©l√®ves doivent arriver √† l'heure et assister √† tous les cours</li>\n        <li>Tout retard ou absence doit √™tre justifi√©</li>\n      </ul>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 3 : Assiduit√©</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        L'assiduit√© est obligatoire pour tous les cours et activit√©s p√©dagogiques. \n        Les absences doivent √™tre signal√©es et justifi√©es dans les meilleurs d√©lais.\n        En cas d'absences r√©p√©t√©es et non justifi√©es, l'√©tablissement se r√©serve le droit de prendre \n        les mesures appropri√©es.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 4 : Comportement</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        Les √©l√®ves doivent adopter un comportement respectueux envers tous les membres de la communaut√© \n        √©ducative et se conformer aux r√®gles de politesse et de civilit√©.\n        Tout acte de violence, de harc√®lement ou de discrimination est strictement interdit et peut \n        donner lieu √† des sanctions disciplinaires.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 5 : Sanctions disciplinaires</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        En cas de manquement au r√®glement int√©rieur, des sanctions peuvent √™tre prononc√©es selon \n        la gravit√© des faits : avertissement, exclusion temporaire ou d√©finitive.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 6 : Hygi√®ne et s√©curit√©</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        Les consignes de s√©curit√© affich√©es dans l'√©tablissement doivent √™tre respect√©es.\n        L'usage du tabac, de l'alcool et de toute substance illicite est strictement interdit.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 7 : Publicit√©</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        Le pr√©sent r√®glement est affich√© dans les locaux et sur le site internet de l'organisme de formation. En outre, un exemplaire est remis √† chaque \n        stagiaire.\n      </p>\n\n      <div style=\"margin-top: 40px;\">\n        <p style=\"margin: 0; font-size: 10pt;\">Fait √† {ecole_ville}</p>\n        <p style=\"margin: 5px 0 0 0; font-size: 10pt;\">Le {date_jour}</p>\n      </div>\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // CONDITIONS G√âN√âRALES DE VENTE\n  // ==========================================\n  cgv: {\n    type: 'cgv',\n    name: 'Conditions G√©n√©rales de Vente',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 25px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;\">\n          CONDITIONS G√âN√âRALES DE VENTE\n        </h1>\n        <p style=\"font-size: 11pt; color: #666; margin: 0;\">{ecole_nom}</p>\n      </div>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 1 - Objet</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        Les pr√©sentes Conditions G√©n√©rales de Vente (CGV) r√©gissent les relations contractuelles entre \n        <strong>{ecole_nom}</strong> et ses clients dans le cadre de la vente de formations et de services √©ducatifs.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 2 - Commandes</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        Toute commande de formation implique l'acceptation sans r√©serve des pr√©sentes CGV. \n        La commande devient ferme et d√©finitive apr√®s acceptation de l'√©tablissement.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 3 - Prix</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        Les prix des formations sont indiqu√©s en euros TTC. Ils sont fermes et non r√©visables pendant \n        la dur√©e de validit√© indiqu√©e sur le devis.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 4 - Modalit√©s de paiement</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        Le paiement s'effectue selon les modalit√©s d√©finies dans le contrat ou le devis accept√©. \n        En cas de retard de paiement, des p√©nalit√©s de retard au taux de 3 fois le taux l√©gal \n        peuvent √™tre appliqu√©es.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 5 - Droit de r√©tractation</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        Conform√©ment √† la l√©gislation en vigueur, le client dispose d'un d√©lai de 14 jours calendaires \n        pour exercer son droit de r√©tractation √† compter de l'acceptation de la commande.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 6 - Annulation</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        En cas d'annulation par le client, des frais d'annulation peuvent √™tre appliqu√©s selon \n        les conditions pr√©vues dans le contrat. L'√©tablissement se r√©serve le droit d'annuler \n        une formation en cas d'insuffisance d'inscriptions.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 7 - Responsabilit√©</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        L'√©tablissement s'engage √† dispenser les formations dans les conditions de qualit√© \n        pr√©vues. La responsabilit√© de l'√©tablissement est limit√©e aux dommages directs et pr√©visibles.\n      </p>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Article 8 - Litiges</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        En cas de litige, les parties conviennent de rechercher une solution amiable avant toute \n        action judiciaire. √Ä d√©faut, les tribunaux de {ecole_ville} seront seuls comp√©tents.\n      </p>\n\n      <div style=\"margin-top: 40px; text-align: right;\">\n        <p style=\"margin: 0; font-size: 10pt;\">Fait √† {ecole_ville}, le {date_jour}</p>\n        <div style=\"margin-top: 30px;\">\n          <p style=\"margin: 0; font-weight: bold; font-size: 10pt;\">{ecole_representant}</p>\n          <p style=\"margin: 3px 0 0 0; font-size: 10pt;\">Directeur</p>\n        </div>\n      </div>\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // PROGRAMME DE FORMATION\n  // ==========================================\n  programme: {\n    type: 'programme',\n    name: 'Programme de formation',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 25px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0 0 8px 0; color: #1A1A1A;\">\n          PROGRAMME DE FORMATION\n        </h1>\n        <p style=\"font-size: 14pt; font-weight: bold; margin: 10px 0 0 0; color: #333;\">\n          {programme_nom}\n        </p>\n        <p style=\"font-size: 10pt; color: #666; margin: 5px 0 0 0;\">\n          Code : {programme_code} | Dur√©e totale : {programme_duree_totale}\n        </p>\n      </div>\n\n      <div style=\"padding: 15px; background-color: #F9FAFB; border-left: 3px solid #1A1A1A; margin-bottom: 20px;\">\n        <p style=\"margin: 0 0 8px 0; font-size: 11pt; font-weight: bold;\">üìã Description du programme :</p>\n        <p style=\"margin: 0; text-align: justify; line-height: 1.6; font-size: 10pt;\">\n          {programme_description}\n        </p>\n      </div>\n\n      <div style=\"padding: 15px; background-color: #F0F9FF; border-left: 3px solid #0EA5E9; margin-bottom: 20px;\">\n        <p style=\"margin: 0 0 8px 0; font-size: 11pt; font-weight: bold;\">üéØ Objectifs du programme :</p>\n        <p style=\"margin: 0; text-align: justify; line-height: 1.6; font-size: 10pt;\">\n          {programme_objectifs}\n        </p>\n      </div>\n\n      <div style=\"padding: 15px; background-color: #FEF3C7; border-left: 3px solid #F59E0B; margin-bottom: 20px;\">\n        <p style=\"margin: 0 0 8px 0; font-size: 11pt; font-weight: bold;\">üë• Public concern√© :</p>\n        <p style=\"margin: 0; line-height: 1.6; font-size: 10pt;\">\n          {programme_public_concerne}\n        </p>\n      </div>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">Pr√©requis</h2>\n      <ul style=\"margin: 10px 0 20px 20px; font-size: 10pt; line-height: 1.6;\">\n        <li>{prerequis_1}</li>\n        <li>{prerequis_2}</li>\n        <li>{prerequis_3}</li>\n      </ul>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">CONTENU P√âDAGOGIQUE</h2>\n\n      <div style=\"margin-bottom: 20px; padding: 15px; background-color: #FAFAFA; border-radius: 4px;\">\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 0 0 10px 0;\">Module 1 : {module_1_titre}</h3>\n        <p style=\"margin: 0 0 10px 0; font-size: 10pt;\"><strong>Dur√©e :</strong> {module_1_duree}</p>\n        <ul style=\"margin: 0 0 0 20px; font-size: 10pt; line-height: 1.6;\">\n          <li>{module_1_contenu_1}</li>\n          <li>{module_1_contenu_2}</li>\n          <li>{module_1_contenu_3}</li>\n        </ul>\n      </div>\n\n      <div style=\"margin-bottom: 20px; padding: 15px; background-color: #FAFAFA; border-radius: 4px;\">\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 0 0 10px 0;\">Module 2 : {module_2_titre}</h3>\n        <p style=\"margin: 0 0 10px 0; font-size: 10pt;\"><strong>Dur√©e :</strong> {module_2_duree}</p>\n        <ul style=\"margin: 0 0 0 20px; font-size: 10pt; line-height: 1.6;\">\n          <li>{module_2_contenu_1}</li>\n          <li>{module_2_contenu_2}</li>\n          <li>{module_2_contenu_3}</li>\n        </ul>\n      </div>\n\n      <div style=\"margin-bottom: 20px; padding: 15px; background-color: #FAFAFA; border-radius: 4px;\">\n        <h3 style=\"font-size: 11pt; font-weight: bold; margin: 0 0 10px 0;\">Module 3 : {module_3_titre}</h3>\n        <p style=\"margin: 0 0 10px 0; font-size: 10pt;\"><strong>Dur√©e :</strong> {module_3_duree}</p>\n        <ul style=\"margin: 0 0 0 20px; font-size: 10pt; line-height: 1.6;\">\n          <li>{module_3_contenu_1}</li>\n          <li>{module_3_contenu_2}</li>\n          <li>{module_3_contenu_3}</li>\n        </ul>\n      </div>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">M√âTHODES P√âDAGOGIQUES</h2>\n      <ul style=\"margin: 10px 0 20px 20px; font-size: 10pt; line-height: 1.6;\">\n        <li>Cours th√©oriques et pratiques</li>\n        <li>Travaux dirig√©s et √©tudes de cas</li>\n        <li>Projets et mises en situation</li>\n        <li>√âvaluations continues</li>\n      </ul>\n\n      <h2 style=\"font-size: 12pt; font-weight: bold; margin: 25px 0 12px 0; color: #1A1A1A;\">MODALIT√âS D'√âVALUATION</h2>\n      <p style=\"text-align: justify; line-height: 1.6; font-size: 10pt; margin: 0;\">\n        L'√©valuation se fait par contr√¥le continu, travaux pratiques et examen final. \n        Une attestation de r√©ussite est d√©livr√©e aux participants ayant obtenu une moyenne \n        minimale de 10/20.\n      </p>\n\n      <div style=\"padding: 15px; background-color: #F0F9FF; border-left: 3px solid #0EA5E9; margin: 25px 0;\">\n        <p style=\"margin: 0 0 8px 0; font-size: 10pt;\"><strong>Dates de formation :</strong></p>\n        <p style=\"margin: 0 0 8px 0; font-size: 10pt;\">Du {session_debut} au {session_fin}</p>\n        <p style=\"margin: 0 0 8px 0; font-size: 10pt;\"><strong>Lieu :</strong> {session_lieu}</p>\n        <p style=\"margin: 0; font-size: 10pt;\"><strong>Horaires :</strong> {session_horaires}</p>\n      </div>\n\n      <div style=\"margin-top: 30px; text-align: right;\">\n        <p style=\"margin: 0; font-size: 10pt;\">Fait √† {ecole_ville}, le {date_jour}</p>\n        <div style=\"margin-top: 20px;\">\n          <p style=\"margin: 0; font-weight: bold; font-size: 10pt;\">{ecole_representant}</p>\n          <p style=\"margin: 3px 0 0 0; font-size: 10pt;\">Directeur</p>\n        </div>\n      </div>\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // ATTESTATION D'ASSIDUIT√â\n  // ==========================================\n  attestation_assiduite: {\n    type: 'attestation_assiduite',\n    name: 'Attestation d\\'assiduit√©',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 30px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;\">\n          ATTESTATION D'ASSIDUIT√â\n        </h1>\n      </div>\n\n      <div style=\"margin-bottom: 25px;\">\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;\">\n          Le directeur de <strong>{ecole_nom}</strong>, √©tablissement situ√© √† <strong>{ecole_adresse}</strong>,\n        </p>\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;\">\n          <strong>ATTESTE</strong> que <strong>{eleve_nom} {eleve_prenom}</strong>, n√©(e) le \n          <strong>{eleve_date_naissance}</strong>, num√©ro d'√©l√®ve <strong>{eleve_numero}</strong>,\n        </p>\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0 0 15px 0;\">\n          a suivi avec <strong>assiduit√©</strong> la formation intitul√©e <strong>\"{formation_nom}\"</strong>\n        </p>\n        <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 0;\">\n          qui s'est d√©roul√©e du <strong>{session_debut}</strong> au <strong>{session_fin}</strong> \n          (dur√©e totale : {formation_duree}).\n        </p>\n      </div>\n\n      <div style=\"padding: 15px; background-color: #F0F9FF; border-left: 3px solid #0EA5E9; margin-bottom: 25px;\">\n        <p style=\"margin: 0; font-size: 10pt; font-weight: bold;\">Taux de pr√©sence :</p>\n        <p style=\"margin: 8px 0 0 0; font-size: 10pt;\">Heures suivies : <strong>{heures_suivies}</strong> sur <strong>{heures_totales}</strong></p>\n        <p style=\"margin: 5px 0 0 0; font-size: 10pt;\">Taux d'assiduit√© : <strong>{taux_assiduite}%</strong></p>\n      </div>\n\n      <p style=\"text-align: justify; line-height: 1.8; font-size: 10pt; margin: 40px 0;\">\n        La pr√©sente attestation est d√©livr√©e √† l'int√©ress√©(e) pour servir et valoir ce que de droit, \n        notamment pour l'√©tablissement des droits sociaux, administratifs et pour justifier de sa \n        pr√©sence en formation.\n      </p>\n\n      <div style=\"margin-top: 50px; text-align: right;\">\n        <p style=\"margin: 0; font-size: 10pt;\">Fait √† {ecole_ville}, le {date_jour}</p>\n        <div style=\"margin-top: 40px;\">\n          <p style=\"margin: 0; font-weight: bold; font-size: 10pt;\">{ecole_representant}</p>\n          <p style=\"margin: 3px 0 0 0; font-size: 10pt;\">Directeur</p>\n          <div style=\"border-top: 1px solid #1A1A1A; margin: 30px 0 0 auto; width: 180px; padding-top: 8px; text-align: center;\">\n            <p style=\"font-size: 9pt; color: #666; margin: 0;\">Signature et cachet</p>\n          </div>\n        </div>\n      </div>\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // CERTIFICAT DE R√âALISATION\n  // ==========================================\n  certificat_realisation: {\n    type: 'certificat_realisation',\n    name: 'Certificat de r√©alisation',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 30px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;\">\n          CERTIFICAT DE R√âALISATION\n        </h1>\n      </div>\n      \n      <div style=\"margin-bottom: 30px;\">\n        <p style=\"text-align: justify; font-size: 11pt; line-height: 1.6;\">\n          L'√©tablissement <strong>{ecole_nom}</strong> certifie que \n          <strong>{eleve_prenom} {eleve_nom}</strong> a r√©alis√© avec succ√®s la formation \n          <strong>\"{formation_nom}\"</strong>.\n        </p>\n      </div>\n      \n      <div style=\"margin-top: 50px; text-align: center;\">\n        <p style=\"margin-bottom: 30px;\">{ecole_ville}, le {date_jour}</p>\n        <p><strong>Le Directeur</strong></p>\n        <p style=\"margin-top: 40px;\">________________________</p>\n        <p>{ecole_directeur}</p>\n      </div>\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // LIVRET D'ACCUEIL\n  // ==========================================\n  livret_accueil: {\n    type: 'livret_accueil',\n    name: 'Livret d\\'accueil',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 30px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;\">\n          LIVRET D'ACCUEIL\n        </h1>\n      </div>\n      \n      <div style=\"margin-bottom: 30px;\">\n        <h2 style=\"font-size: 14pt; font-weight: bold; margin-bottom: 15px;\">BIENVENUE</h2>\n        <p style=\"text-align: justify; font-size: 11pt; line-height: 1.6;\">\n          Bienvenue √† <strong>{ecole_nom}</strong>.\n        </p>\n        <p style=\"text-align: justify; font-size: 11pt; line-height: 1.6; margin-top: 10px;\">\n          Ce livret vous pr√©sente les informations essentielles de notre √©tablissement.\n        </p>\n      </div>\n      \n      <div style=\"margin-bottom: 30px;\">\n        <h2 style=\"font-size: 14pt; font-weight: bold; margin-bottom: 15px;\">PR√âSENTATION</h2>\n        <p style=\"font-size: 11pt; line-height: 1.6;\"><strong>√âtablissement :</strong> {ecole_nom}</p>\n        <p style=\"font-size: 11pt; line-height: 1.6;\"><strong>Adresse :</strong> {ecole_adresse}, {ecole_ville}</p>\n        <p style=\"font-size: 11pt; line-height: 1.6;\"><strong>Contact :</strong> {ecole_telephone} | {ecole_email}</p>\n      </div>\n    `,\n    footerContent: premiumFooter,\n  },\n\n  // ==========================================\n  // FEUILLE D'√âMARGEMENT\n  // ==========================================\n  emargement: {\n    type: 'emargement',\n    name: 'Feuille d\\'√©margement',\n    headerContent: premiumHeader,\n    bodyContent: `\n      <div style=\"text-align: center; margin-bottom: 30px;\">\n        <h1 style=\"font-size: 16pt; font-weight: bold; margin: 0; color: #1A1A1A;\">\n          FEUILLE D'√âMARGEMENT\n        </h1>\n      </div>\n      \n      <div style=\"margin-bottom: 30px;\">\n        <p style=\"font-size: 11pt; line-height: 1.6;\"><strong>Formation :</strong> {formation_nom}</p>\n        <p style=\"font-size: 11pt; line-height: 1.6;\"><strong>Session :</strong> {session_nom}</p>\n        <p style=\"font-size: 11pt; line-height: 1.6;\"><strong>Date :</strong> {session_debut}</p>\n        <p style=\"font-size: 11pt; line-height: 1.6;\"><strong>Lieu :</strong> {session_lieu}</p>\n      </div>\n      \n      <table style=\"width: 100%; border-collapse: collapse; margin-top: 30px;\">\n        <thead>\n          <tr style=\"background-color: #f3f4f6;\">\n            <th style=\"padding: 10px; border: 1px solid #ddd; text-align: left; font-size: 11pt;\">Nom et Pr√©nom</th>\n            <th style=\"padding: 10px; border: 1px solid #ddd; text-align: center; font-size: 11pt;\">Signature</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td style=\"padding: 10px; border: 1px solid #ddd; font-size: 11pt;\">{eleve_prenom} {eleve_nom}</td>\n            <td style=\"padding: 10px; border: 1px solid #ddd; text-align: center;\">________________</td>\n          </tr>\n        </tbody>\n      </table>\n    `,\n    footerContent: premiumFooter,\n  },\n}\n\n/**\n * R√©cup√®re le template par d√©faut pour un type de document\n */\nexport function getDefaultTemplateContent(type: DocumentType): DocumentTemplateDefault {\n  return documentTemplateDefaults[type]\n}\n\n/**\n * G√©n√®re le contenu HTML complet pour un document avec le style premium\n */\nexport function generateDocumentHTML(\n  type: DocumentType,\n  headerContent: string,\n  bodyContent: string,\n  footerContent: string\n): string {\n  return `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <meta charset=\"UTF-8\">\n      <style>\n        @page {\n          size: A4;\n          margin: 15mm;\n        }\n        \n        * {\n          box-sizing: border-box;\n        }\n        \n        body {\n          font-family: 'Helvetica Neue', Arial, sans-serif;\n          font-size: 11pt;\n          line-height: 1.5;\n          color: #1A1A1A;\n          margin: 0;\n          padding: 0;\n        }\n        \n        .document-container {\n          max-width: 210mm;\n          margin: 0 auto;\n          padding: 0;\n          background: white;\n        }\n        \n        h1, h2, h3 {\n          color: #1A1A1A;\n          margin: 0;\n        }\n        \n        p {\n          margin: 0;\n        }\n        \n        table {\n          border-collapse: collapse;\n        }\n        \n        @media print {\n          body {\n            -webkit-print-color-adjust: exact;\n            print-color-adjust: exact;\n          }\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"document-container\">\n        <!-- Header -->\n        ${headerContent}\n        \n        <!-- Body -->\n        <div class=\"document-body\">\n          ${bodyContent}\n        </div>\n        \n        <!-- Footer -->\n        ${footerContent}\n      </div>\n    </body>\n    </html>\n  `\n}\n\n/**\n * Exporte le header premium pour r√©utilisation\n */\nexport function getPremiumHeader(): string {\n  return premiumHeader\n}\n\n/**\n * Exporte le footer premium pour r√©utilisation\n */\nexport function getPremiumFooter(): string {\n  return premiumFooter\n}\n"],"names":[],"mappings":"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","ignoreList":[2]}