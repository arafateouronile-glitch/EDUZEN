module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},442315,(e,t,r)=>{"use strict";t.exports=e.r(918622)},981838,e=>{"use strict";let t=new class{isDevelopment=!1;isProduction=!0;sentryEnabled=!0;initSentry(){this.sentryEnabled}constructor(){this.sentryEnabled&&this.initSentry()}error(t,r,s){let n={message:t,error:r instanceof Error?{name:r.name,message:r.message,stack:r.stack}:r,context:s,timestamp:new Date().toISOString(),level:"error"};this.isProduction&&this.sentryEnabled,this.isProduction&&t.includes("[CRITICAL]")&&e.A(789044).then(({alertService:e})=>{let a=r instanceof Error?r:Error(t);e.sendCriticalError(a,{context:s,timestamp:n.timestamp}).catch(e=>{this.isDevelopment&&console.error("Failed to send critical alert:",e)})}).catch(()=>{}),(this.isDevelopment||!this.isProduction)&&console.error("âŒ [ERROR]",t,{error:r,context:s,timestamp:n.timestamp})}warn(e,t){let r={message:e,context:t,timestamp:new Date().toISOString(),level:"warn"};this.isDevelopment&&console.warn("âš ï¸ [WARN]",e,{context:t,timestamp:r.timestamp})}info(e,t){let r={message:e,context:t,timestamp:new Date().toISOString(),level:"info"};this.isDevelopment&&console.info("â„¹ï¸ [INFO]",e,{context:t,timestamp:r.timestamp})}debug(e,t){this.isDevelopment&&console.debug("ðŸ› [DEBUG]",e,{context:t,timestamp:new Date().toISOString()})}apiError(e,t,r){this.error(`API Error: ${e}`,t,{...r,endpoint:e})}mutationError(e,t,r){this.error(`Mutation Error: ${e}`,t,{...r,mutationName:e})}queryError(e,t,r){this.error(`Query Error: ${e}`,t,{...r,queryKey:e})}};function r(e){if(!e)return"[NO_EMAIL]";let[t,r]=e.split("@");return r?`${t.substring(0,2)}***@${r}`:"[INVALID_EMAIL]"}function s(e){return e?e.substring(0,8)+"...":"[NO_ID]"}function n(e){return e?{message:e.message,code:e.code,name:e.name,...{}}:{}}e.s(["logger",0,t,"maskEmail",()=>r,"maskId",()=>s,"sanitizeError",()=>n])},997953,(e,t,r)=>{"use strict";t.exports=e.r(442315).vendored["react-rsc"].ReactServerDOMTurbopackServer},458515,e=>{"use strict";e.s(["createClient",()=>t]);let t=(0,e.i(997953).registerClientReference)(function(){throw Error("Attempted to call createClient() from the server but createClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/lib/supabase/client.ts <module evaluation>","createClient")},565963,e=>{"use strict";e.s(["createClient",()=>t]);let t=(0,e.i(997953).registerClientReference)(function(){throw Error("Attempted to call createClient() from the server but createClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/lib/supabase/client.ts","createClient")},703755,e=>{"use strict";e.i(458515);var t=e.i(565963);e.n(t)},500874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},338992,e=>{"use strict";let t=new class{async blobToBase64(e){return new Promise((t,r)=>{let s=new FileReader;s.onloadend=()=>{t(s.result.split(",")[1])},s.onerror=r,s.readAsDataURL(e)})}async sendEmail(e){try{let t=e.attachments?await Promise.all(e.attachments.map(async e=>{let t;if(e.content instanceof Blob)t=await this.blobToBase64(e.content);else if(e.content instanceof ArrayBuffer){let r=new Blob([e.content],{type:e.contentType});t=await this.blobToBase64(r)}else t=e.content;return{filename:e.filename,content:t,contentType:e.contentType}})):void 0,r=await fetch("/api/email/send",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({to:e.to,subject:e.subject,html:e.html,text:e.text,attachments:t,cc:e.cc,bcc:e.bcc,replyTo:e.replyTo})});if(!r.ok){let e=await r.json();throw Error(e.message||"Erreur lors de l'envoi de l'email")}let s=await r.json();return{success:!0,message:s.message||"Email envoyÃ© avec succÃ¨s"}}catch(e){throw Error(e instanceof Error?e.message:"Erreur lors de l'envoi de l'email")}}async sendDocument(e,t,r,s,n,a){return this.sendEmail({to:e,subject:t,html:n,text:a,attachments:[{filename:s,content:r,contentType:"application/pdf"}]})}async sendMultipleDocuments(e,t,r,s,n){return this.sendEmail({to:e,subject:t,html:s,text:n,attachments:r.map(e=>({filename:e.filename,content:e.blob,contentType:"application/pdf"}))})}};e.s(["emailService",0,t])},10061,e=>e.a(async(t,r)=>{try{let t=await e.y("puppeteer-582bc9288a971b4a");e.n(t),r()}catch(e){r(e)}},!0),480963,e=>{"use strict";var t=e.i(703755);let r=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async create(e){let{data:t,error:r}=await this.supabase.from("scheduled_generations").insert({template_id:e.template_id,organization_id:e.organization_id,schedule_type:e.schedule_type,schedule_config:e.schedule_config,filter_criteria:e.filter_criteria||{},format:e.format,send_email:e.send_email||!1,email_recipients:e.email_recipients||[],enabled:e.enabled,variables:e.variables||{}}).select().single();if(r)throw r;return t}async getAll(e){let{data:t,error:r}=await this.supabase.from("scheduled_generations").select("*").eq("organization_id",e).order("created_at",{ascending:!1});if(r)throw r;return t||[]}async getById(e){let{data:t,error:r}=await this.supabase.from("scheduled_generations").select("*").eq("id",e).single();if(r){if("PGRST116"===r.code)return null;throw r}return t}async update(e,t){let{data:r,error:s}=await this.supabase.from("scheduled_generations").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw s;return r}async setEnabled(e,t){return this.update(e,{enabled:t})}async delete(e){let{error:t}=await this.supabase.from("scheduled_generations").delete().eq("id",e);if(t)throw t}async getDueGenerations(){let e=new Date,t=e.getHours(),r=e.getMinutes(),s=e.getDay(),n=e.getDate(),{data:a,error:i}=await this.supabase.from("scheduled_generations").select("*").eq("enabled",!0);if(i)throw i;return(a||[]).filter(e=>{let a=e.schedule_config;if("daily"===e.schedule_type){let[e,s]=(a.time||"00:00").split(":").map(Number);return t===e&&r===s}if("weekly"===e.schedule_type){let[e,n]=(a.time||"00:00").split(":").map(Number);return s===(a.day_of_week??0)&&t===e&&r===n}if("monthly"===e.schedule_type){let[e,s]=(a.time||"00:00").split(":").map(Number);return n===(a.day_of_month??1)&&t===e&&r===s}return!1})}async markAsExecuted(e,t){let{error:r}=await this.supabase.from("scheduled_generations").update({last_executed_at:new Date().toISOString(),last_execution_result:t,execution_count:(await this.getById(e))?.execution_count||1}).eq("id",e);if(r)throw r}};e.s(["scheduledGenerationService",0,r])},789044,e=>{e.v(t=>Promise.all(["server/chunks/lib_services_alert_service_ts_a3118548._.js"].map(t=>e.l(t))).then(()=>t(737492)))},74166,e=>{e.v(t=>Promise.all(["server/chunks/_db7d6d15._.js"].map(t=>e.l(t))).then(()=>t(89660)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__0123720f._.js.map