module.exports=[866392,a=>{"use strict";var b=a.i(187924),c=a.i(433217),d=a.i(370025),e=a.i(937927),f=a.i(572131),g=a.i(323625),h=a.i(727163),i=a.i(219897),j=a.i(340695),k=a.i(205522),l=a.i(917171),m=a.i(546893),n=a.i(864037);a.i(460355);var o=a.i(346271),p=a.i(546842),q=a.i(992258),r=a.i(941675),s=a.i(170106);let t=(0,s.default)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);var u=a.i(114548),v=a.i(633508);let w=(0,s.default)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var x=a.i(603314),y=a.i(523312),z=a.i(943108),A=a.i(93518),B=a.i(953722),C=a.i(641710),D=a.i(497895);function E(){let{student:a,studentId:s}=(0,g.useLearnerContext)(),E=(0,f.useMemo)(()=>s?(0,h.createLearnerClient)(s):null,[s]),F=(0,e.useQueryClient)(),{addToast:G}=(0,n.useToast)(),[H,I]=(0,f.useState)(!1),J=!a,[K,L]=(0,f.useState)({first_name:"",last_name:"",email:"",phone:"",address:"",city:"",postal_code:"",country:"",date_of_birth:"",bio:""});(0,f.useState)(()=>{a&&L({first_name:a.first_name||"",last_name:a.last_name||"",email:a.email||"",phone:a.phone||"",address:a.address||"",city:a.city||"",postal_code:a.postal_code||"",country:a.country||"",date_of_birth:a.date_of_birth||"",bio:a.bio||""})});let{data:M}=(0,c.useQuery)({queryKey:["learner-profile-stats",a?.id],queryFn:async()=>{if(!a?.id)return null;if(!E)return{enrollments:0,courses:0,certificates:0};let[b,c,d]=await Promise.all([E.from("enrollments").select("id, status").eq("student_id",a.id),Promise.resolve({data:[],error:null}),E.from("course_certificates").select("id").eq("student_id",a.id)]);return{totalSessions:b.data?.length||0,completedSessions:b.data?.filter(a=>"completed"===a.status).length||0,totalCourses:c.data?.length||0,completedCourses:c.data?.filter(a=>"completed"===a.status).length||0,certificates:d.data?.length||0}},enabled:!!a?.id}),N=(0,d.useMutation)({mutationFn:async b=>{if(!a?.id)throw Error("Student not found");if(!E)throw Error("Supabase client not available");let{error:c}=await E.from("students").update({first_name:b.first_name,last_name:b.last_name,phone:b.phone,address:b.address,city:b.city,postal_code:b.postal_code,country:b.country,date_of_birth:b.date_of_birth||null,bio:b.bio}).eq("id",a.id);if(c)throw c},onSuccess:()=>{F.invalidateQueries({queryKey:["learner-profile"]}),I(!1),G({type:"success",title:"Profil mis à jour",description:"Vos informations ont été enregistrées."})},onError:a=>{G({type:"error",title:"Erreur",description:"Impossible de mettre à jour le profil."})}}),O=a=>{a.preventDefault(),N.mutate(K)},P={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};return J?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"h-48 bg-gray-100 rounded-2xl animate-pulse"}),(0,b.jsx)("div",{className:"h-96 bg-gray-100 rounded-2xl animate-pulse"})]}):(0,b.jsxs)(o.motion.div,{className:"space-y-6 pb-24 lg:pb-8",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"visible",children:[(0,b.jsx)(o.motion.div,{variants:P,children:(0,b.jsx)(i.GlassCard,{variant:"premium",className:"p-6 md:p-8 bg-gradient-to-r from-brand-blue/5 via-indigo-50/50 to-purple-50/30",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"w-24 h-24 md:w-32 md:h-32 rounded-full bg-gradient-to-br from-brand-blue to-indigo-600 flex items-center justify-center text-white text-3xl md:text-4xl font-bold shadow-xl",children:a?.photo_url?(0,b.jsx)("img",{src:a.photo_url,alt:"Photo",className:"w-full h-full rounded-full object-cover"}):(0,b.jsxs)(b.Fragment,{children:[a?.first_name?.[0],a?.last_name?.[0]]})}),(0,b.jsx)("button",{className:"absolute bottom-0 right-0 p-2 bg-white rounded-full shadow-lg hover:bg-gray-50 transition-colors",children:(0,b.jsx)(w,{className:"h-4 w-4 text-gray-600"})})]}),(0,b.jsxs)("div",{className:"text-center md:text-left flex-1",children:[(0,b.jsxs)("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:[a?.first_name," ",a?.last_name]}),(0,b.jsxs)("p",{className:"text-gray-500 mt-1",children:["N° ",a?.student_number]}),a?.email&&(0,b.jsxs)("p",{className:"text-gray-500 text-sm mt-2 flex items-center justify-center md:justify-start gap-2",children:[(0,b.jsx)(q.Mail,{className:"h-4 w-4"}),a.email]})]}),(0,b.jsx)("div",{children:H?(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(j.Button,{variant:"outline",onClick:()=>I(!1),children:[(0,b.jsx)(v.X,{className:"h-4 w-4 mr-2"}),"Annuler"]}),(0,b.jsxs)(j.Button,{onClick:O,disabled:N.isPending,children:[(0,b.jsx)(u.Save,{className:"h-4 w-4 mr-2"}),N.isPending?"Enregistrement...":"Enregistrer"]})]}):(0,b.jsxs)(j.Button,{onClick:()=>{L({first_name:a?.first_name||"",last_name:a?.last_name||"",email:a?.email||"",phone:a?.phone||"",address:a?.address||"",city:a?.city||"",postal_code:a?.postal_code||"",country:a?.country||"",date_of_birth:a?.date_of_birth||"",bio:a.bio||""}),I(!0)},children:[(0,b.jsx)(t,{className:"h-4 w-4 mr-2"}),"Modifier"]})})]})})}),(0,b.jsxs)(o.motion.div,{variants:P,className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,b.jsxs)(i.GlassCard,{className:"p-4 text-center",children:[(0,b.jsx)(B.BookOpen,{className:"h-6 w-6 text-brand-blue mx-auto mb-2"}),(0,b.jsx)("div",{className:"text-xl font-bold text-gray-900",children:M?.totalSessions||0}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Sessions"})]}),(0,b.jsxs)(i.GlassCard,{className:"p-4 text-center",children:[(0,b.jsx)(B.BookOpen,{className:"h-6 w-6 text-purple-600 mx-auto mb-2"}),(0,b.jsx)("div",{className:"text-xl font-bold text-gray-900",children:M?.totalCourses||0}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Cours"})]}),(0,b.jsxs)(i.GlassCard,{className:"p-4 text-center",children:[(0,b.jsx)(A.Award,{className:"h-6 w-6 text-amber-600 mx-auto mb-2"}),(0,b.jsx)("div",{className:"text-xl font-bold text-gray-900",children:M?.certificates||0}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Certificats"})]}),(0,b.jsxs)(i.GlassCard,{className:"p-4 text-center",children:[(0,b.jsx)(C.Clock,{className:"h-6 w-6 text-green-600 mx-auto mb-2"}),(0,b.jsx)("div",{className:"text-xl font-bold text-gray-900",children:M?.completedSessions||0}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Terminées"})]}),(0,b.jsxs)(i.GlassCard,{className:"p-4 text-center",children:[(0,b.jsx)(r.Calendar,{className:"h-6 w-6 text-blue-600 mx-auto mb-2"}),(0,b.jsx)("div",{className:"text-xl font-bold text-gray-900",children:a?.created_at?(0,D.formatDate)(a.created_at).split("/")[2]:"-"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Membre depuis"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsx)(o.motion.div,{variants:P,className:"lg:col-span-2",children:(0,b.jsxs)(i.GlassCard,{className:"p-6",children:[(0,b.jsxs)("h2",{className:"text-lg font-bold text-gray-900 mb-6 flex items-center gap-2",children:[(0,b.jsx)(p.User,{className:"h-5 w-5 text-brand-blue"}),"Informations personnelles"]}),(0,b.jsxs)("form",{onSubmit:O,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Prénom"}),(0,b.jsx)(k.Input,{value:H?K.first_name:a?.first_name||"",onChange:a=>L({...K,first_name:a.target.value}),disabled:!H,className:"mt-1"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Nom"}),(0,b.jsx)(k.Input,{value:H?K.last_name:a?.last_name||"",onChange:a=>L({...K,last_name:a.target.value}),disabled:!H,className:"mt-1"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Email"}),(0,b.jsx)(k.Input,{type:"email",value:a?.email||"",disabled:!0,className:"mt-1 bg-gray-50"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"L'email ne peut pas être modifié"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Téléphone"}),(0,b.jsx)(k.Input,{value:H?K.phone:a?.phone||"",onChange:a=>L({...K,phone:a.target.value}),disabled:!H,className:"mt-1"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Date de naissance"}),(0,b.jsx)(k.Input,{type:"date",value:H?K.date_of_birth:a?.date_of_birth||"",onChange:a=>L({...K,date_of_birth:a.target.value}),disabled:!H,className:"mt-1"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Adresse"}),(0,b.jsx)(k.Input,{value:H?K.address:a?.address||"",onChange:a=>L({...K,address:a.target.value}),disabled:!H,className:"mt-1"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Ville"}),(0,b.jsx)(k.Input,{value:H?K.city:a?.city||"",onChange:a=>L({...K,city:a.target.value}),disabled:!H,className:"mt-1"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Code postal"}),(0,b.jsx)(k.Input,{value:H?K.postal_code:a?.postal_code||"",onChange:a=>L({...K,postal_code:a.target.value}),disabled:!H,className:"mt-1"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Pays"}),(0,b.jsx)(k.Input,{value:H?K.country:a?.country||"",onChange:a=>L({...K,country:a.target.value}),disabled:!H,className:"mt-1"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Bio / À propos"}),(0,b.jsx)(m.Textarea,{value:H?K.bio:a?.bio||"",onChange:a=>L({...K,bio:a.target.value}),disabled:!H,className:"mt-1",rows:4,placeholder:"Parlez-nous de vous..."})]})]})]})}),(0,b.jsxs)(o.motion.div,{variants:P,className:"space-y-4",children:[(0,b.jsxs)(i.GlassCard,{className:"p-6",children:[(0,b.jsxs)("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(x.Shield,{className:"h-5 w-5 text-brand-blue"}),"Sécurité"]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)(j.Button,{variant:"outline",className:"w-full justify-start",children:[(0,b.jsx)(z.Lock,{className:"h-4 w-4 mr-2"}),"Changer le mot de passe"]}),(0,b.jsxs)(j.Button,{variant:"outline",className:"w-full justify-start",children:[(0,b.jsx)(x.Shield,{className:"h-4 w-4 mr-2"}),"Authentification 2FA"]})]})]}),(0,b.jsxs)(i.GlassCard,{className:"p-6",children:[(0,b.jsxs)("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[(0,b.jsx)(y.Bell,{className:"h-5 w-5 text-brand-blue"}),"Notifications"]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Emails de rappel"}),(0,b.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Notifications push"}),(0,b.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-gray-600",children:"Résumé hebdomadaire"}),(0,b.jsx)("input",{type:"checkbox",className:"rounded"})]})]})]})]})]})]})}a.s(["default",()=>E],866392)}];

//# sourceMappingURL=app_%28learner%29_learner_profile_page_tsx_838395cd._.js.map