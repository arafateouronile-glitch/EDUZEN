module.exports=[464514,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(433217),e=a.i(370025),f=a.i(937927),g=a.i(913216),h=a.i(824115),i=a.i(703130),j=a.i(340695),k=a.i(205522),l=a.i(917171),m=a.i(546893),n=a.i(254161),o=a.i(965733),p=a.i(887682),q=a.i(580208),r=a.i(915618),s=a.i(587532),t=a.i(724669),u=a.i(111269),v=a.i(641710),w=a.i(54018),x=a.i(177156),y=a.i(238246);function z(){let{user:a}=(0,g.useAuth)(),z=(0,f.useQueryClient)(),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)("all"),[E,F]=(0,c.useState)("all"),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)({risk_id:"",title:"",description:"",category:"security",likelihood:"possible",impact:"moderate",treatment_status:"open",treatment_plan:""}),{data:K}=(0,d.useQuery)({queryKey:["risk-assessments",a?.organization_id,C,E],queryFn:()=>h.complianceService.getRisks(a?.organization_id||"",{riskLevel:"all"===C?void 0:C,treatmentStatus:"all"===E?void 0:E}),enabled:!!a?.organization_id}),L=K?.filter(a=>!A||!!a.title.toLowerCase().includes(A.toLowerCase())||!!a.risk_id.toLowerCase().includes(A.toLowerCase())),M=(0,e.useMutation)({mutationFn:()=>h.complianceService.createRisk({...I,organization_id:a?.organization_id||""}),onSuccess:()=>{z.invalidateQueries({queryKey:["risk-assessments"]}),H(!1),J({risk_id:"",title:"",description:"",category:"security",likelihood:"possible",impact:"moderate",treatment_status:"open",treatment_plan:""})}}),N={low:"bg-gray-100 text-gray-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"},O={open:"bg-red-100 text-red-800",mitigated:"bg-green-100 text-green-800",accepted:"bg-blue-100 text-blue-800",transferred:"bg-purple-100 text-purple-800",avoided:"bg-gray-100 text-gray-800"};return(0,b.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,b.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,b.jsx)(q.AlertTriangle,{className:"h-8 w-8"}),"Évaluations de risques"]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Identification, évaluation et traitement des risques de sécurité"})]}),(0,b.jsxs)(o.Dialog,{open:G,onOpenChange:H,children:[(0,b.jsx)(o.DialogTrigger,{asChild:!0,children:(0,b.jsxs)(j.Button,{children:[(0,b.jsx)(r.Plus,{className:"h-4 w-4 mr-2"}),"Nouveau risque"]})}),(0,b.jsxs)(o.DialogContent,{className:"max-w-2xl",children:[(0,b.jsxs)(o.DialogHeader,{children:[(0,b.jsx)(o.DialogTitle,{children:"Créer une nouvelle évaluation de risque"}),(0,b.jsx)(o.DialogDescription,{children:"Identifiez et évaluez un nouveau risque pour votre organisation"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"ID du risque"}),(0,b.jsx)(k.Input,{value:I.risk_id,onChange:a=>J({...I,risk_id:a.target.value}),placeholder:"Ex: RISK-001"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Catégorie"}),(0,b.jsxs)(p.Select,{value:I.category,onValueChange:a=>J({...I,category:a}),children:[(0,b.jsx)(p.SelectTrigger,{children:(0,b.jsx)(p.SelectValue,{})}),(0,b.jsxs)(p.SelectContent,{children:[(0,b.jsx)(p.SelectItem,{value:"security",children:"Sécurité"}),(0,b.jsx)(p.SelectItem,{value:"operational",children:"Opérationnel"}),(0,b.jsx)(p.SelectItem,{value:"financial",children:"Financier"}),(0,b.jsx)(p.SelectItem,{value:"compliance",children:"Conformité"}),(0,b.jsx)(p.SelectItem,{value:"reputation",children:"Réputation"})]})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Titre"}),(0,b.jsx)(k.Input,{value:I.title,onChange:a=>J({...I,title:a.target.value}),placeholder:"Titre du risque"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Description"}),(0,b.jsx)(m.Textarea,{value:I.description,onChange:a=>J({...I,description:a.target.value}),placeholder:"Description du risque",rows:3})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Probabilité"}),(0,b.jsxs)(p.Select,{value:I.likelihood,onValueChange:a=>J({...I,likelihood:a}),children:[(0,b.jsx)(p.SelectTrigger,{children:(0,b.jsx)(p.SelectValue,{})}),(0,b.jsxs)(p.SelectContent,{children:[(0,b.jsx)(p.SelectItem,{value:"rare",children:"Rare"}),(0,b.jsx)(p.SelectItem,{value:"unlikely",children:"Peu probable"}),(0,b.jsx)(p.SelectItem,{value:"possible",children:"Possible"}),(0,b.jsx)(p.SelectItem,{value:"likely",children:"Probable"}),(0,b.jsx)(p.SelectItem,{value:"almost_certain",children:"Presque certain"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Impact"}),(0,b.jsxs)(p.Select,{value:I.impact,onValueChange:a=>J({...I,impact:a}),children:[(0,b.jsx)(p.SelectTrigger,{children:(0,b.jsx)(p.SelectValue,{})}),(0,b.jsxs)(p.SelectContent,{children:[(0,b.jsx)(p.SelectItem,{value:"negligible",children:"Négligeable"}),(0,b.jsx)(p.SelectItem,{value:"minor",children:"Mineur"}),(0,b.jsx)(p.SelectItem,{value:"moderate",children:"Modéré"}),(0,b.jsx)(p.SelectItem,{value:"major",children:"Majeur"}),(0,b.jsx)(p.SelectItem,{value:"catastrophic",children:"Catastrophique"})]})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{children:"Plan de traitement"}),(0,b.jsx)(m.Textarea,{value:I.treatment_plan,onChange:a=>J({...I,treatment_plan:a.target.value}),placeholder:"Plan de traitement du risque",rows:3})]}),(0,b.jsx)(j.Button,{onClick:()=>M.mutate(),disabled:!I.risk_id||!I.title,className:"w-full",children:"Créer le risque"})]})]})]})]}),(0,b.jsxs)("div",{className:"mb-6 flex gap-4",children:[(0,b.jsxs)("div",{className:"flex-1 relative",children:[(0,b.jsx)(s.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,b.jsx)(k.Input,{placeholder:"Rechercher un risque...",value:A,onChange:a=>B(a.target.value),className:"pl-10"})]}),(0,b.jsxs)(p.Select,{value:C,onValueChange:D,children:[(0,b.jsx)(p.SelectTrigger,{className:"w-40",children:(0,b.jsx)(p.SelectValue,{})}),(0,b.jsxs)(p.SelectContent,{children:[(0,b.jsx)(p.SelectItem,{value:"all",children:"Tous les niveaux"}),(0,b.jsx)(p.SelectItem,{value:"critical",children:"Critique"}),(0,b.jsx)(p.SelectItem,{value:"high",children:"Élevé"}),(0,b.jsx)(p.SelectItem,{value:"medium",children:"Moyen"}),(0,b.jsx)(p.SelectItem,{value:"low",children:"Faible"})]})]}),(0,b.jsxs)(p.Select,{value:E,onValueChange:F,children:[(0,b.jsx)(p.SelectTrigger,{className:"w-48",children:(0,b.jsx)(p.SelectValue,{})}),(0,b.jsxs)(p.SelectContent,{children:[(0,b.jsx)(p.SelectItem,{value:"all",children:"Tous les statuts"}),(0,b.jsx)(p.SelectItem,{value:"open",children:"Ouvert"}),(0,b.jsx)(p.SelectItem,{value:"mitigated",children:"Atténué"}),(0,b.jsx)(p.SelectItem,{value:"accepted",children:"Accepté"}),(0,b.jsx)(p.SelectItem,{value:"transferred",children:"Transféré"}),(0,b.jsx)(p.SelectItem,{value:"avoided",children:"Évité"})]})]})]}),L&&L.length>0?(0,b.jsx)("div",{className:"grid grid-cols-1 gap-4",children:L.map(a=>(0,b.jsxs)(i.Card,{className:"critical"===a.risk_level?"border-red-200":"",children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsx)("div",{className:"flex items-start justify-between",children:(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(i.CardTitle,{className:"text-lg",children:a.title}),(0,b.jsx)(n.Badge,{variant:"outline",children:a.risk_id}),(0,b.jsxs)(n.Badge,{className:N[a.risk_level]||"bg-gray-100 text-gray-800",children:[(0,b.jsx)(t.TrendingUp,{className:"h-3 w-3 mr-1"}),"critical"===a.risk_level?"Critique":"high"===a.risk_level?"Élevé":"medium"===a.risk_level?"Moyen":"Faible"]})]}),a.description&&(0,b.jsx)(i.CardDescription,{className:"mt-2",children:a.description})]})})}),(0,b.jsx)(i.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Probabilité: "}),(0,b.jsx)(n.Badge,{variant:"outline",children:a.likelihood})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Impact: "}),(0,b.jsx)(n.Badge,{variant:"outline",children:a.impact})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Statut: "}),(0,b.jsxs)(n.Badge,{className:O[a.treatment_status]||"bg-gray-100 text-gray-800",children:["open"===a.treatment_status?(0,b.jsx)(w.XCircle,{className:"h-3 w-3 mr-1"}):"mitigated"===a.treatment_status?(0,b.jsx)(u.CheckCircle2,{className:"h-3 w-3 mr-1"}):(0,b.jsx)(v.Clock,{className:"h-3 w-3 mr-1"}),"open"===a.treatment_status?"Ouvert":"mitigated"===a.treatment_status?"Atténué":"accepted"===a.treatment_status?"Accepté":"transferred"===a.treatment_status?"Transféré":"Évité"]})]}),a.category&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Catégorie: "}),(0,b.jsx)(n.Badge,{variant:"outline",children:a.category})]})]}),a.treatment_plan&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:"Plan de traitement: "}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:a.treatment_plan})]}),a.owner&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Propriétaire: "}),(0,b.jsx)("span",{className:"text-sm",children:a.owner.full_name||a.owner.email})]}),(0,b.jsx)("div",{className:"flex items-center gap-2 pt-2",children:(0,b.jsx)(y.default,{href:`/dashboard/compliance/risks/${a.id}`,children:(0,b.jsxs)(j.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(x.Eye,{className:"h-4 w-4 mr-2"}),"Voir les détails"]})})})]})})]},a.id))}):(0,b.jsx)(i.Card,{children:(0,b.jsxs)(i.CardContent,{className:"pt-6 text-center text-muted-foreground",children:["Aucun risque trouvé. ",A&&"Essayez une autre recherche."]})})]})}a.s(["default",()=>z])}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_compliance_risks_page_tsx_3260448c._.js.map