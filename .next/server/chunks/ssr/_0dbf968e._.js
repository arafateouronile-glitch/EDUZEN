module.exports=[104720,a=>{"use strict";let b=(0,a.i(170106).default)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);a.s(["FileText",()=>b],104720)},941675,a=>{"use strict";let b=(0,a.i(170106).default)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);a.s(["Calendar",()=>b],941675)},913216,a=>{"use strict";var b=a.i(433217),c=a.i(370025),d=a.i(937927),e=a.i(50944),f=a.i(269240),g=a.i(572131),h=a.i(325383);function i(){let a=(0,f.createClient)(),i=(0,e.useRouter)(),j=(0,d.useQueryClient)(),{data:k,isLoading:l}=(0,b.useQuery)({queryKey:["session"],queryFn:async()=>{try{let b=new Promise((a,b)=>{setTimeout(()=>b(Error("Session timeout")),3e3)}),c=a.auth.getSession().then(({data:{session:a},error:b})=>b?(h.logger.error("Session error",b),null):a);return await Promise.race([c,b])}catch(a){return null}},retry:!1,refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:3e5}),{data:m,isLoading:n}=(0,b.useQuery)({queryKey:["user",k?.user?.id],queryFn:async()=>{if(!k?.user?.id)return null;try{let b=new Promise((a,b)=>{setTimeout(()=>b(Error("User fetch timeout")),3e3)}),c=a.from("users").select("id, organization_id, email, full_name, phone, avatar_url, role, permissions, is_active, last_login_at, created_at, updated_at").eq("id",k.user.id).maybeSingle().then(async({data:b,error:c})=>{if(c)return"PGRST116"===c.code||c.message?.includes("No rows"),null;if(!b&&k?.user?.id){h.logger.info("User not found in public.users, attempting to sync from auth.users...");try{let{data:b,error:c}=await a.rpc("sync_user_from_auth",{user_id:k.user.id});if(c)h.logger.error("Error syncing user:",c);else if(b?.success){h.logger.info("User synced successfully, refetching...",{syncResult:b}),await new Promise(a=>setTimeout(a,100));let{data:c,error:d}=await a.from("users").select("id, organization_id, email, full_name, phone, avatar_url, role, permissions, is_active, last_login_at, created_at, updated_at").eq("id",k.user.id).maybeSingle();if(d)h.logger.error("Error refetching synced user:",d),j.invalidateQueries({queryKey:["user",k.user.id]});else{if(c)return h.logger.info("Synced user retrieved successfully:",{id:c.id,email:c.email,hasOrg:!!c.organization_id}),c;h.logger.warn("User sync succeeded but refetch returned null - invalidating cache and retrying..."),j.invalidateQueries({queryKey:["user",k.user.id]})}}}catch(a){h.logger.error("Exception during user sync:",a)}return null}return b?(b.organization_id||h.logger.warn("User exists but has no organization_id"),b):null});return await Promise.race([c,b])}catch(a){return null}},enabled:!!k?.user?.id&&!l,retry:!1,refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:3e5}),o=(0,c.useMutation)({mutationFn:async({email:b,password:c})=>{let{data:d,error:e}=await a.auth.signInWithPassword({email:b,password:c});if(e)throw e;return d},onSuccess:async()=>{j.invalidateQueries({queryKey:["session"]}),j.invalidateQueries({queryKey:["user"]}),await new Promise(a=>setTimeout(a,300)),i.push("/dashboard")}}),p=(0,c.useMutation)({mutationFn:async({email:b,password:c,fullName:d,organizationName:e})=>{let{data:f,error:g}=await a.auth.signUp({email:b,password:c});if(g){if(h.logger.error("Auth signup error",Error(g.message),{status:g.status}),429===g.status||g.message?.includes("2 seconds"))throw Error("Trop de tentatives. Veuillez attendre quelques secondes avant de réessayer.");throw Error(g.message||"Erreur lors de la création du compte")}if(!f.user)throw Error("Erreur lors de la création du compte");let i=f.session;if(!i){await new Promise(a=>setTimeout(a,1e3));let{data:{session:b}}=await a.auth.getSession();i=b}if(!i&&f.user){let{data:{session:b}}=await a.auth.refreshSession();i=b}if(!i){await new Promise(a=>setTimeout(a,2e3));let{data:{session:b}}=await a.auth.getSession();b&&(i=b)}if(!i&&!f.user)throw Error("Erreur : la session n'a pas pu être établie. Vérifiez votre email pour confirmer votre compte si nécessaire.");let k=i?.user?.id||f.user.id,l=e.toUpperCase().replace(/\s+/g,"").slice(0,6),m=null;if(!k)throw Error("Erreur : impossible d'obtenir l'ID utilisateur");try{let{data:b,error:c}=await a.rpc("create_organization_for_user",{org_name:e,org_code:l,org_type:"primary",org_country:"SN",org_currency:"XOF",org_language:"fr",org_timezone:"Africa/Dakar",user_id:k});if(c){if("P0001"===c.code&&c.message?.includes("User must be authenticated")){let b=await a.rpc("create_organization_for_user",{org_name:e,org_code:l,org_type:"primary",org_country:"SN",org_currency:"XOF",org_language:"fr",org_timezone:"Africa/Dakar"});b.error?b.error:b.data&&(m=b.data)}}else b&&(m=b)}catch(a){}let n=null;if(m)n={id:m,name:e,code:l};else{let{data:b,error:c}=await a.from("organizations").insert({name:e,code:l,type:"primary",country:"SN",currency:"XOF",language:"fr",timezone:"Africa/Dakar",subscription_tier:"free",subscription_status:"active",settings:{}}).select("id, name, code").single();if(c){if(console.error("Organization creation error:",c),console.error("Error details:",{code:c.code,message:c.message,details:c.details,hint:c.hint}),"42501"===c.code)throw Error("Erreur de sécurité (RLS) : Impossible de créer l'organisation. Les politiques RLS bloquent la création. INSTRUCTIONS : 1. Exécutez le script supabase/create_organization_function.sql dans Supabase SQL Editor 2. OU exécutez le script supabase/fix_rls_urgent.sql pour corriger les politiques RLS 3. Attendez quelques secondes puis réessayez");throw Error(`Impossible de cr\xe9er l'organisation : ${c.message}`)}n=b,m=b?.id}if(!m)throw Error("Erreur : l'organisation n'a pas été créée correctement");let o=m||n?.id;if(!o)throw Error("Erreur : impossible d'obtenir l'ID de l'organisation");let p=null,q=null;try{let{data:c,error:e}=await a.rpc("create_user_for_organization",{user_id:k,user_email:b,user_full_name:d,organization_id:o});if(e){if(q=e,"42883"===e.code){let{data:c,error:e}=await a.from("users").insert({id:k,organization_id:o,email:b,full_name:d,role:"admin",is_active:!0}).select("id, organization_id, email, full_name, role").single();e?q=e:p=c}}else c&&(p={id:c,organization_id:o,email:b,full_name:d,role:"admin"})}catch(a){q=a}if(q){if("42501"===q.code)throw Error("Erreur RLS lors de la création de l'utilisateur. Exécutez le script supabase/create_user_function.sql dans Supabase SQL Editor, ou utilisez supabase/fix_existing_user.sql pour créer l'utilisateur manuellement.");throw q}if(!p)throw Error("Erreur : l'utilisateur n'a pas été créé");if(!p?.organization_id)throw Error("Erreur : l'utilisateur n'a pas d'organization_id");if(j.invalidateQueries({queryKey:["user",k]}),j.invalidateQueries({queryKey:["session"]}),!i){await new Promise(a=>setTimeout(a,1e3));let{data:{session:b}}=await a.auth.getSession();if(b)return{...f,session:b}}return f},onSuccess:async a=>{await new Promise(a=>setTimeout(a,1500));let b=(0,f.createClient)(),{data:{session:c}}=await b.auth.getSession();j.invalidateQueries({queryKey:["session"]}),a.user&&j.invalidateQueries({queryKey:["user",a.user.id]}),c?i.push("/dashboard"):i.push("/auth/login?message=confirm-email")}}),q=(0,c.useMutation)({mutationFn:async()=>{let{error:b}=await a.auth.signOut();if(b)throw b},onSuccess:()=>{j.clear(),i.push("/")}});return(0,g.useEffect)(()=>{let{data:{subscription:b}}=a.auth.onAuthStateChange((a,b)=>{j.setQueryData(["session"],b),b||j.clear()});return()=>b.unsubscribe()},[a,j]),{session:k,user:m,isLoading:l||n,isAuthenticated:!!k,login:o.mutate,register:p.mutate,logout:q.mutate,isLoggingIn:o.isPending,isRegistering:p.isPending,isLoggingOut:q.isPending,loginError:o.error,registerError:p.error}}a.s(["useAuth",()=>i])},205522,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);a.i(460355);var e=a.i(346271),f=a.i(262036),g=a.i(290821),h=a.i(111269);let i=0,j=c.forwardRef(({className:a,label:j,error:k,helperText:l,variant:m="default",leftIcon:n,rightIcon:o,id:p,...q},r)=>{let[s,t]=c.useState(!1),[u,v]=c.useState(!!q.value||!!q.defaultValue),w=c.useId?.()||null,x=p||w||`input-${++i}`;c.useEffect(()=>{void 0!==q.value&&v(!!q.value)},[q.value]);let y=(0,d.cn)("flex w-full rounded-lg font-medium transition-all duration-300","placeholder:text-muted-foreground/60","focus:outline-none focus:ring-2 focus:ring-primary/20","disabled:cursor-not-allowed disabled:opacity-50",{"border-2 border-input bg-background px-4 py-3":"default"===m,"focus:border-primary focus:bg-white":"default"===m&&!k,"border-destructive focus:border-destructive focus:ring-destructive/20":k,"border-2 border-input bg-transparent px-4 py-3":"outlined"===m,"focus:border-primary focus:shadow-md focus:shadow-primary/10":"outlined"===m&&!k,"border-0 border-b-2 border-input bg-muted/50 px-4 py-3 rounded-b-none":"filled"===m,"focus:bg-muted focus:border-primary":"filled"===m&&!k,"focus:border-destructive bg-destructive/5":"filled"===m&&k},n&&"pl-11",o&&"pr-11",k&&"pr-11",a);return(0,b.jsxs)("div",{className:"w-full space-y-1.5",children:[j&&(0,b.jsxs)(e.motion.label,{htmlFor:x,initial:!1,animate:{color:k?"#EF4444":s?"rgb(37, 99, 235)":"rgb(107, 114, 128)"},className:(0,d.cn)("block text-sm font-medium transition-colors duration-200",k&&"text-destructive"),children:[j,q.required&&(0,b.jsx)("span",{className:"text-destructive ml-1",children:"*"})]}),(0,b.jsxs)("div",{className:"relative",children:[n&&(0,b.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground pointer-events-none",children:n}),(0,b.jsx)(e.motion.input,{ref:r,id:x,...q,onChange:a=>{v(!!a.target.value),q.onChange?.(a)},onFocus:a=>{t(!0),q.onFocus?.(a)},onBlur:a=>{t(!1),q.onBlur?.(a)},className:y,animate:{scale:s?1.01:1,borderColor:k?"#EF4444":s?"rgb(37, 99, 235)":"rgb(226, 232, 240)"},transition:{duration:.2}}),(0,b.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",children:k?(0,b.jsx)(e.motion.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:(0,b.jsx)(g.AlertCircle,{className:"h-5 w-5 text-destructive"})}):o?(0,b.jsx)("div",{className:"text-muted-foreground",children:o}):u&&!k&&"filled"===m?(0,b.jsx)(e.motion.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:(0,b.jsx)(h.CheckCircle2,{className:"h-5 w-5 text-success"})}):null})]}),(0,b.jsx)(f.AnimatePresence,{mode:"wait",children:(k||l)&&(0,b.jsx)(e.motion.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},transition:{duration:.2},className:(0,d.cn)("text-xs transition-colors duration-200",k?"text-destructive":"text-muted-foreground"),children:k||l})})]})});j.displayName="Input",a.s(["Input",()=>j])},587532,a=>{"use strict";let b=(0,a.i(170106).default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);a.s(["Search",()=>b],587532)},93518,a=>{"use strict";let b=(0,a.i(170106).default)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);a.s(["Award",()=>b],93518)},546842,a=>{"use strict";let b=(0,a.i(170106).default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);a.s(["User",()=>b],546842)},469769,a=>{"use strict";let b=(0,a.i(170106).default)("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]);a.s(["GraduationCap",()=>b],469769)},321161,a=>{"use strict";let b=(0,a.i(170106).default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Settings",()=>b],321161)},911156,a=>{"use strict";let b=(0,a.i(170106).default)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);a.s(["CreditCard",()=>b],911156)},727163,a=>{"use strict";var b=a.i(183160);let c=new Map;function d(a){let d=a||"anonymous",e=c.get(d);if(e)return e;let f={};a&&(f["x-learner-student-id"]=a);let g=(0,b.createClient)("https://ocdlaouymksskmmhmzdr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9jZGxhb3V5bWtzc2ttbWhtemRyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMwNjEzOTksImV4cCI6MjA3ODYzNzM5OX0.5--WO4j5r1eC6_NqfFbWnyKVDeQqDk5RkhqL91T4wjE",{global:{headers:f},auth:{persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1,storage:{getItem:a=>null,setItem:(a,b)=>{},removeItem:a=>{}},storageKey:`sb-learner-auth-token-${d}`}});return c.set(d,g),g}a.s(["createLearnerClient",()=>d])},323625,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(433217),e=a.i(727163),f=a.i(50944),g=a.i(325383);let h=(0,c.createContext)(null);function i({children:a}){let i=function(){(0,f.useRouter)();let a=(0,f.useParams)(),b="".startsWith("/learner/access/"),h=b?a?.id:void 0,[i,j]=(0,c.useState)(()=>h);(0,c.useEffect)(()=>{h&&b&&h!==i&&(g.logger.info("[useLearner] Updating student ID from URL",{oldId:i,newId:h,path:""}),localStorage.setItem("learner_student_id",h),j(h))},[h,i,b,""]);let{data:k,isLoading:l,error:m}=(0,d.useQuery)({queryKey:["learner-student",i],queryFn:async()=>{if(!i)return null;try{g.logger.info("[useLearner] Starting to fetch student",{studentId:i});let a=(0,e.createLearnerClient)(i);g.logger.info("[useLearner] Trying direct query",{studentId:i});let{data:b,error:c}=await a.from("students").select("*").eq("id",i).maybeSingle();if(b&&!c)return g.logger.info("[useLearner] Student found via direct query",{studentId:i,studentName:`${b.first_name} ${b.last_name}`}),b;g.logger.warn("[useLearner] Student not found via direct query, trying RPC function",{studentId:i,error:c?.message,errorCode:c?.code,hasData:!!b});try{if(g.logger.info("[useLearner] Calling RPC function",{studentId:i,studentIdType:typeof i,studentIdLength:i?.length,isValidUUID:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(i||"")}),!i||!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(i))return g.logger.error("[useLearner] Invalid studentId format for RPC",{studentId:i}),null;let b=null,c=null,{data:d,error:e}=await a.rpc("get_learner_student",{p_student_id:i}),f={studentId:i,hasData:!!d,hasError:!!e,rpcErrorCode:e?.code,rpcErrorMessage:e?.message,rpcDataType:typeof d,rpcDataIsArray:Array.isArray(d),rpcDataIsNull:null===d,rpcDataIsUndefined:void 0===d,rpcDataStringified:d?JSON.stringify(d).substring(0,200):"null",rpcDataValue:d};if(g.logger.info("[useLearner] RPC response (direct)",f),e?c=e:(b=d,Array.isArray(d)&&(b=d.length>0?d[0]:null,g.logger.info("[useLearner] RPC returned array (unexpected), taking first element",{arrayLength:d.length,firstElement:b}))),c)return g.logger.error("[useLearner] Error fetching student via RPC",c,{studentId:i,rpcErrorCode:c.code,rpcErrorMessage:c.message,rpcErrorDetails:c.details,rpcErrorHint:c.hint}),null;if(null==b)return g.logger.warn("[useLearner] Student not found via RPC (null response)",{studentId:i,rpcData:b,rpcDataType:typeof b,note:"L'étudiant n'existe peut-être pas dans la base de données avec cet ID"}),null;if("object"==typeof b&&0===Object.keys(b).length)return g.logger.warn("[useLearner] Student not found via RPC (empty object)",{studentId:i,rpcData:b}),null;let h=b;return g.logger.info("[useLearner] Student found via RPC function",{studentId:i,studentName:h?.first_name&&h?.last_name?`${h.first_name} ${h.last_name}`:"Unknown",studentIdFromData:h?.id,hasEmail:!!h?.email}),h}catch(a){return g.logger.error("[useLearner] Exception calling RPC function",a,{studentId:i,errorMessage:a instanceof Error?a.message:String(a),errorStack:a instanceof Error?a.stack:void 0}),null}}catch(a){return g.logger.error("[useLearner] Exception fetching student",a,{studentId:i}),null}},enabled:!!i,retry:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,staleTime:3e5}),n=!!k&&!!i;return{student:k,studentId:i,isLoading:l,hasStudent:n,error:m,organizationId:k?.organization_id||null}}();return(0,b.jsx)(h.Provider,{value:i,children:a})}function j(){let a=(0,c.useContext)(h);if(!a)throw Error("useLearnerContext must be used within LearnerProvider");return a}a.s(["LearnerProvider",()=>i,"useLearnerContext",()=>j],323625)},71277,a=>{"use strict";let b=(0,a.i(170106).default)("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);a.s(["PlayCircle",()=>b],71277)},563588,a=>{"use strict";let b=(0,a.i(170106).default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);a.s(["MessageSquare",()=>b],563588)},523312,a=>{"use strict";let b=(0,a.i(170106).default)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);a.s(["Bell",()=>b],523312)},776803,a=>{"use strict";let b=(0,a.i(170106).default)("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);a.s(["ClipboardCheck",()=>b],776803)},972692,a=>{"use strict";let b=(0,a.i(170106).default)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);a.s(["Menu",()=>b],972692)},630617,a=>{"use strict";let b=(0,a.i(170106).default)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);a.s(["LayoutDashboard",()=>b],630617)},220005,a=>{"use strict";let b=(0,a.i(170106).default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);a.s(["LogOut",()=>b],220005)},633591,a=>{"use strict";let b=(0,a.i(170106).default)("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);a.s(["WifiOff",()=>b],633591)},803594,a=>{"use strict";var b=a.i(572131),c=a.i(269240),d=a.i(325383);let e="eduzen_offline_",f=6048e5;function g(){let[a,g]=(0,b.useState)({isOnline:"undefined"==typeof navigator||navigator.onLine,isOfflineReady:!1,pendingSyncs:0});(0,b.useEffect)(()=>{let a=()=>{g(a=>({...a,isOnline:!0})),n()},b=()=>{g(a=>({...a,isOnline:!1}))};return window.addEventListener("online",a),window.addEventListener("offline",b),h(),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",b)}},[]);let h=(0,b.useCallback)(()=>{try{let a=Object.keys(localStorage).filter(a=>a.startsWith(e));g(b=>({...b,isOfflineReady:a.length>0}))}catch(a){d.logger.warn("LocalStorage non disponible")}},[]),i=(0,b.useCallback)((a,b,c=f)=>{try{let d={key:a,data:b,timestamp:Date.now(),expiresAt:Date.now()+c};return localStorage.setItem(`${e}${a}`,JSON.stringify(d)),h(),!0}catch(a){return d.logger.error("Erreur lors du cache des données",a),!1}},[h]),j=(0,b.useCallback)(a=>{try{let b=localStorage.getItem(`${e}${a}`);if(!b)return null;let c=JSON.parse(b);if(Date.now()>c.expiresAt)return localStorage.removeItem(`${e}${a}`),null;return c.data}catch(a){return d.logger.error("Erreur lors de la récupération du cache",a),null}},[]),k=(0,b.useCallback)(a=>{try{localStorage.removeItem(`${e}${a}`),h()}catch(a){d.logger.error("Erreur lors de la suppression du cache",a)}},[h]),l=(0,b.useCallback)(()=>{try{Object.keys(localStorage).filter(a=>a.startsWith(e)).forEach(a=>localStorage.removeItem(a)),g(a=>({...a,isOfflineReady:!1}))}catch(a){d.logger.error("Erreur lors du vidage du cache",a)}},[]),m=(0,b.useCallback)(a=>{try{let b=JSON.parse(localStorage.getItem(`${e}pending_sync`)||"[]");b.push({...a,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,createdAt:new Date().toISOString()}),localStorage.setItem(`${e}pending_sync`,JSON.stringify(b)),g(a=>({...a,pendingSyncs:b.length}))}catch(a){d.logger.error("Erreur lors de la mise en file d'attente",a)}},[]),n=(0,b.useCallback)(async()=>{if(a.isOnline)try{let a=JSON.parse(localStorage.getItem(`${e}pending_sync`)||"[]");if(0===a.length)return;let b=(0,c.createClient)(),f=[];for(let c of a)try{switch(c.method){case"insert":await b.from(c.table).insert(c.data);break;case"update":await b.from(c.table).update(c.data).eq("id",c.data.id);break;case"delete":await b.from(c.table).delete().eq("id",c.data.id)}}catch(a){d.logger.error(`Erreur sync action ${c.type}`,a),f.push(c)}localStorage.setItem(`${e}pending_sync`,JSON.stringify(f)),g(a=>({...a,pendingSyncs:f.length})),0===f.length?d.logger.info("Synchronisation terminée avec succès"):d.logger.warn(`${f.length} actions n'ont pas pu \xeatre synchronis\xe9es`)}catch(a){d.logger.error("Erreur lors de la synchronisation",a)}},[a.isOnline]);return{...a,cacheData:i,getCachedData:j,clearCachedData:k,clearAllCache:l,queueForSync:m,syncPendingData:n}}a.s(["useOffline",()=>g])}];

//# sourceMappingURL=_0dbf968e._.js.map