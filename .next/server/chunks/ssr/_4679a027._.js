module.exports=[400210,a=>{"use strict";let b=(0,a.i(170106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],400210)},641710,a=>{"use strict";let b=(0,a.i(170106).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],641710)},495756,a=>{"use strict";let b=(0,a.i(170106).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],495756)},177156,a=>{"use strict";let b=(0,a.i(170106).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>b],177156)},976472,a=>{"use strict";let b=(0,a.i(170106).default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);a.s(["Heart",()=>b],976472)},122903,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getFAQCategories(a){let{data:b,error:c}=await this.supabase.from("faq_categories").select("*").eq("organization_id",a).eq("is_active",!0).order("order_index",{ascending:!0});if(c)throw c;return b}async createFAQCategory(a){let{data:b,error:c}=await this.supabase.from("faq_categories").insert(a).select().single();if(c)throw c;return b}async updateFAQCategory(a,b){let{data:c,error:d}=await this.supabase.from("faq_categories").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteFAQCategory(a){let{error:b}=await this.supabase.from("faq_categories").delete().eq("id",a);if(b)throw b}async getFAQItems(a,b){let c=this.supabase.from("faq_items").select("*, category:faq_categories(*)").eq("organization_id",a).eq("is_active",!0);b?.categoryId&&(c=c.eq("category_id",b.categoryId)),b?.search&&(c=c.or(`question.ilike.%${b.search}%,answer.ilike.%${b.search}%`)),b?.featured&&(c=c.eq("is_featured",!0));let{data:d,error:e}=await c.order("order_index",{ascending:!0}).order("view_count",{ascending:!1});if(e)throw e;return d}async getFAQItemById(a){let{data:b,error:c}=await this.supabase.from("faq_items").select("*, category:faq_categories(*)").eq("id",a).single();if(c)throw c;return b&&await this.supabase.rpc("increment_faq_view_count",{faq_uuid:b.id}),b}async createFAQItem(a){let{data:b,error:c}=await this.supabase.from("faq_items").insert(a).select().single();if(c)throw c;return b}async updateFAQItem(a,b){let{data:c,error:d}=await this.supabase.from("faq_items").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteFAQItem(a){let{error:b}=await this.supabase.from("faq_items").delete().eq("id",a);if(b)throw b}async createFAQFeedback(a,b,c,d){let{data:e,error:f}=await this.supabase.from("faq_feedback").insert({faq_id:a,user_id:b,is_helpful:c,comment:d}).select().single();if(f)throw f;return e}async getGuides(a,b){let c=this.supabase.from("guides").select("*, author:users(id, full_name, email)").eq("organization_id",a).eq("is_active",!0);b?.category&&(c=c.eq("category",b.category)),b?.difficulty&&(c=c.eq("difficulty",b.difficulty)),b?.search&&(c=c.or(`title.ilike.%${b.search}%,description.ilike.%${b.search}%,content.ilike.%${b.search}%`)),b?.featured&&(c=c.eq("is_featured",!0));let{data:d,error:e}=await c.order("published_at",{ascending:!1}).order("view_count",{ascending:!1});if(e)throw e;return d}async getGuideBySlug(a,b){let{data:c,error:d}=await this.supabase.from("guides").select("*, author:users(id, full_name, email), steps:guide_steps(*)").eq("slug",a).eq("organization_id",b).eq("is_active",!0).single();if(d)throw d;return c&&await this.supabase.rpc("increment_guide_view_count",{guide_uuid:c.id}),c}async createGuide(a){let{data:b,error:c}=await this.supabase.from("guides").insert(a).select().single();if(c)throw c;return b}async updateGuide(a,b){let{data:c,error:d}=await this.supabase.from("guides").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteGuide(a){let{error:b}=await this.supabase.from("guides").delete().eq("id",a);if(b)throw b}async getGuideSteps(a){let{data:b,error:c}=await this.supabase.from("guide_steps").select("*").eq("guide_id",a).order("step_number",{ascending:!0});if(c)throw c;return b}async createGuideStep(a){let{data:b,error:c}=await this.supabase.from("guide_steps").insert(a).select().single();if(c)throw c;return b}async updateGuideStep(a,b){let{data:c,error:d}=await this.supabase.from("guide_steps").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteGuideStep(a){let{error:b}=await this.supabase.from("guide_steps").delete().eq("id",a);if(b)throw b}async addGuideToFavorites(a,b){let{data:c,error:d}=await this.supabase.from("guide_favorites").insert({user_id:a,guide_id:b}).select().single();if(d)throw d;return c}async removeGuideFromFavorites(a,b){let{error:c}=await this.supabase.from("guide_favorites").delete().eq("user_id",a).eq("guide_id",b);if(c)throw c}async isGuideFavorite(a,b){let{data:c,error:d}=await this.supabase.from("guide_favorites").select("id").eq("user_id",a).eq("guide_id",b).maybeSingle();if(d)throw d;return!!c}async getUserFavoriteGuides(a){let{data:b,error:c}=await this.supabase.from("guide_favorites").select("*, guide:guides(*, author:users(id, full_name))").eq("user_id",a).order("created_at",{ascending:!1});if(c)throw c;return b}async getGuideProgress(a,b){let{data:c,error:d}=await this.supabase.from("guide_progress").select("*").eq("user_id",a).eq("guide_id",b).maybeSingle();if(d)throw d;return c}async updateGuideProgress(a,b,c,d){let e=await this.getGuideProgress(a,b),f=await this.getGuideSteps(b),g=d.length===f.length;if(e){let{data:a,error:b}=await this.supabase.from("guide_progress").update({current_step:c,completed_steps:d,is_completed:g,completed_at:g?new Date().toISOString():null}).eq("id",e.id).select().single();if(b)throw b;return a}{let{data:e,error:f}=await this.supabase.from("guide_progress").insert({user_id:a,guide_id:b,current_step:c,completed_steps:d,is_completed:g,completed_at:g?new Date().toISOString():null}).select().single();if(f)throw f;return e}}async markStepAsCompleted(a,b,c){let d=await this.getGuideProgress(a,b),e=d?.completed_steps||[];return e.includes(c)||e.push(c),this.updateGuideProgress(a,b,c,e)}};a.s(["knowledgeBaseService",0,c])},617618,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(433217),f=a.i(370025),g=a.i(937927),h=a.i(913216),i=a.i(122903),j=a.i(703130),k=a.i(340695),l=a.i(400210),m=a.i(495756),n=a.i(65151),o=a.i(976472),p=a.i(641710),q=a.i(953722),r=a.i(177156),s=a.i(238246),t=a.i(762180),u=a.i(497895);function v(){let a=(0,d.useParams)();(0,d.useRouter)();let v=a.slug,{user:w}=(0,h.useAuth)(),x=(0,g.useQueryClient)(),[y,z]=(0,c.useState)(1),{data:A}=(0,e.useQuery)({queryKey:["guide",v,w?.organization_id],queryFn:()=>i.knowledgeBaseService.getGuideBySlug(v,w?.organization_id||""),enabled:!!v&&!!w?.organization_id}),{data:B}=(0,e.useQuery)({queryKey:["guide-progress",w?.id,A?.id],queryFn:()=>i.knowledgeBaseService.getGuideProgress(w?.id||"",A?.id||""),enabled:!!w?.id&&!!A?.id}),{data:C}=(0,e.useQuery)({queryKey:["guide-favorite",w?.id,A?.id],queryFn:()=>i.knowledgeBaseService.isGuideFavorite(w?.id||"",A?.id||""),enabled:!!w?.id&&!!A?.id}),D=(0,f.useMutation)({mutationFn:async a=>{if(w?.id&&A?.id)return i.knowledgeBaseService.markStepAsCompleted(w.id,A.id,a)},onSuccess:()=>{x.invalidateQueries({queryKey:["guide-progress"]})}}),E=(0,f.useMutation)({mutationFn:async()=>{w?.id&&A?.id&&(C?await i.knowledgeBaseService.removeGuideFromFavorites(w.id,A.id):await i.knowledgeBaseService.addGuideToFavorites(w.id,A.id))},onSuccess:()=>{x.invalidateQueries({queryKey:["guide-favorite"]})}});if((0,c.useEffect)(()=>{B&&B.current_step?z(B.current_step):A?.steps&&A.steps.length>0&&z(1)},[B,A]),!A)return(0,b.jsx)("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:(0,b.jsx)("div",{className:"text-center py-12",children:"Chargement..."})});let F=B?.completed_steps||[];return(0,b.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-5xl",children:[(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)(s.default,{href:"/dashboard/knowledge-base",children:(0,b.jsxs)(k.Button,{variant:"ghost",size:"sm",className:"mb-4",children:[(0,b.jsx)(l.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Retour à la base de connaissances"]})})}),(0,b.jsx)(j.Card,{className:"mb-6",children:(0,b.jsx)(j.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)(q.BookOpen,{className:"h-6 w-6 text-primary"}),(0,b.jsx)(j.CardTitle,{className:"text-3xl",children:A.title})]}),A.description&&(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:A.description}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,b.jsx)("span",{className:`px-2 py-1 rounded ${(a=>{if(!a)return"bg-gray-100 text-gray-800";switch(a){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(A.difficulty)}`,children:(a=>{if(!a)return"Non spécifié";switch(a){case"beginner":return"Débutant";case"intermediate":return"Intermédiaire";case"advanced":return"Avancé";default:return a}})(A.difficulty)}),A.estimated_time_minutes&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(p.Clock,{className:"h-4 w-4"}),(0,b.jsxs)("span",{children:[A.estimated_time_minutes," minutes"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(r.Eye,{className:"h-4 w-4"}),(0,b.jsxs)("span",{children:[A.view_count," vues"]})]}),A.author&&(0,b.jsxs)("span",{children:["Par ",A.author.full_name||A.author.email]}),A.published_at&&(0,b.jsxs)("span",{children:["Publié le ",(0,u.formatDate)(A.published_at)]})]})]}),(0,b.jsxs)(k.Button,{variant:"outline",size:"sm",onClick:()=>E.mutate(),disabled:E.isPending,children:[(0,b.jsx)(o.Heart,{className:`h-4 w-4 mr-2 ${C?"fill-red-500 text-red-500":""}`}),C?"Retirer des favoris":"Ajouter aux favoris"]})]})})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-3",children:[(0,b.jsx)(j.Card,{className:"mb-6",children:(0,b.jsx)(j.CardContent,{className:"pt-6",children:(0,b.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,b.jsx)(t.default,{children:A.content})})})}),A.steps&&A.steps.length>0&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Étapes"}),A.steps.map((a,c)=>{let d=a.step_number,e=F.includes(d),f=d===y;return(0,b.jsxs)(j.Card,{className:f?"border-primary border-2":"",children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:e?(0,b.jsx)(m.CheckCircle,{className:"h-6 w-6 text-green-600"}):(0,b.jsx)(n.Circle,{className:"h-6 w-6 text-muted-foreground"})}),(0,b.jsxs)(j.CardTitle,{className:"text-xl",children:["Étape ",d,": ",a.title]})]}),!e&&(0,b.jsx)(k.Button,{size:"sm",onClick:()=>{D.mutate(d),A?.steps&&d<A.steps.length&&z(d+1)},disabled:D.isPending,children:"Marquer comme complété"})]})}),(0,b.jsxs)(j.CardContent,{children:[a.image_url&&(0,b.jsx)("img",{src:a.image_url,alt:a.title,className:"mb-4 rounded-lg w-full"}),(0,b.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,b.jsx)(t.default,{children:a.content})}),a.video_url&&(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)("a",{href:a.video_url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Voir la vidéo →"})})]})]},a.id)})]}),B&&(0,b.jsxs)(j.Card,{className:"mt-6",children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"Votre progression"})}),(0,b.jsx)(j.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Étapes complétées"}),(0,b.jsxs)("span",{className:"font-semibold",children:[F.length," / ",A.steps?.length||0]})]}),(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all",style:{width:`${A.steps?F.length/A.steps.length*100:0}%`}})}),B.is_completed&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-green-600 mt-2",children:[(0,b.jsx)(m.CheckCircle,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"Guide complété !"})]})]})})]})]}),(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsxs)(j.Card,{className:"sticky top-4",children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{className:"text-lg",children:"Navigation"})}),(0,b.jsx)(j.CardContent,{children:A.steps&&A.steps.length>0&&(0,b.jsx)("div",{className:"space-y-2",children:A.steps.map(a=>{let c=a.step_number,d=F.includes(c),e=c===y;return(0,b.jsxs)("button",{onClick:()=>z(c),className:`w-full text-left p-2 rounded-lg transition-colors ${e?"bg-primary text-white":d?"bg-green-50 text-green-800 hover:bg-green-100":"bg-gray-50 hover:bg-gray-100"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[d?(0,b.jsx)(m.CheckCircle,{className:"h-4 w-4 flex-shrink-0"}):(0,b.jsx)(n.Circle,{className:"h-4 w-4 flex-shrink-0"}),(0,b.jsxs)("span",{className:"text-sm font-medium",children:["Étape ",c]})]}),(0,b.jsx)("p",{className:"text-xs mt-1 line-clamp-2",children:a.title})]},a.id)})})})]})})]})]})}a.s(["default",()=>v])}];

//# sourceMappingURL=_4679a027._.js.map