{"version":3,"sources":["../../../../app/%28dashboard%29/dashboard/sessions/%5Bid%5D/sections/gestion-finances.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { useAuth } from '@/lib/hooks/use-auth'\nimport { createClient } from '@/lib/supabase/client'\nimport { invoiceService } from '@/lib/services/invoice.service'\nimport { paymentService } from '@/lib/services/payment.service'\nimport { documentTemplateService } from '@/lib/services/document-template.service'\nimport { sessionChargesService, type SessionChargeWithCategory } from '@/lib/services/session-charges.service'\nimport { generateHTML } from '@/lib/utils/document-generation/html-generator'\nimport { extractDocumentVariables } from '@/lib/utils/document-generation/variable-extractor'\nimport { generatePDFFromHTML } from '@/lib/utils/pdf-generator'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { formatCurrency, formatDate } from '@/lib/utils'\nimport { useToast } from '@/components/ui/toast'\nimport Link from 'next/link'\nimport { \n  Download, FileText, Plus, Receipt, DollarSign, \n  FileCheck, FileX, Eye, CreditCard, ChevronDown, ChevronUp,\n  Trash2, Edit, TrendingDown\n} from 'lucide-react'\nimport type { EnrollmentWithRelations, StudentWithRelations, InvoiceWithRelations } from '@/lib/types/query-types'\nimport type { TableRow } from '@/lib/types/supabase-helpers'\nimport type { SessionWithRelations } from '@/lib/types/query-types'\n\ntype Payment = TableRow<'payments'>\n\ninterface GestionFinancesProps {\n  enrollments?: EnrollmentWithRelations[]\n  payments?: Payment[]\n  sessionId?: string\n  sessionData?: SessionWithRelations\n  organization?: TableRow<'organizations'>\n}\n\nexport function GestionFinances({\n  enrollments = [],\n  payments = [],\n  sessionId,\n  sessionData,\n  organization,\n}: GestionFinancesProps) {\n  const { user } = useAuth()\n  const supabase = createClient()\n  const queryClient = useQueryClient()\n  const { addToast } = useToast()\n  \n  const [selectedEnrollmentId, setSelectedEnrollmentId] = useState<string | null>(null)\n  const [showPaymentForm, setShowPaymentForm] = useState(false)\n  const [showInvoiceForm, setShowInvoiceForm] = useState(false)\n  const [showQuoteForm, setShowQuoteForm] = useState(false)\n  const [selectedInvoiceId, setSelectedInvoiceId] = useState<string | null>(null)\n  const [isDownloading, setIsDownloading] = useState<string | null>(null)\n  const [isGenerating, setIsGenerating] = useState<string | null>(null)\n  const [showCharges, setShowCharges] = useState(false)\n  const [showChargeForm, setShowChargeForm] = useState(false)\n  const [editingCharge, setEditingCharge] = useState<SessionChargeWithCategory | null>(null)\n\n  // Récupérer les factures et devis pour tous les étudiants de la session\n  const studentIds = enrollments.map((e) => e.student_id).filter(Boolean)\n  const { data: invoices } = useQuery({\n    queryKey: ['session-invoices', sessionId, studentIds],\n    queryFn: async () => {\n      if (!user?.organization_id || studentIds.length === 0) return []\n      const allInvoices: any[] = []\n      for (const studentId of studentIds) {\n        if (!studentId) continue\n        const studentInvoices = await invoiceService.getAll(user.organization_id, {\n          studentId,\n        })\n        allInvoices.push(...studentInvoices)\n      }\n      return allInvoices\n    },\n    enabled: !!user?.organization_id && studentIds.length > 0,\n  })\n\n  // Récupérer l'organisation\n  const { data: organizationData } = useQuery({\n    queryKey: ['organization', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return null\n      const { data, error } = await supabase\n        .from('organizations')\n        .select('*')\n        .eq('id', user.organization_id)\n        .single()\n      if (error) throw error\n      return data\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  const org = organization || organizationData\n\n  // Récupérer l'année académique\n  const { data: academicYear } = useQuery({\n    queryKey: ['academic-year', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return null\n      const { data, error } = await supabase\n        .from('academic_years')\n        .select('*')\n        .eq('organization_id', user.organization_id)\n        .eq('is_current', true)\n        .maybeSingle()\n      if (error) {\n        console.warn('Erreur lors de la récupération de l\\'année académique:', error)\n        return null\n      }\n      return data || null\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  // Récupérer les templates\n  const { data: invoiceTemplate } = useQuery({\n    queryKey: ['invoice-template', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return null\n      const templates = await documentTemplateService.getTemplatesByType('facture', user.organization_id)\n      return templates.length > 0 ? templates[0] : null\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  const { data: quoteTemplate } = useQuery({\n    queryKey: ['quote-template', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return null\n      const templates = await documentTemplateService.getTemplatesByType('devis', user.organization_id)\n      return templates.length > 0 ? templates[0] : null\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  // Récupérer les charges de la session\n  const { data: charges, refetch: refetchCharges } = useQuery({\n    queryKey: ['session-charges', sessionId],\n    queryFn: async () => {\n      if (!sessionId) return []\n      return sessionChargesService.getBySession(sessionId)\n    },\n    enabled: !!sessionId,\n  })\n\n  // Récupérer le résumé des charges\n  const { data: chargesSummary } = useQuery({\n    queryKey: ['session-charges-summary', sessionId],\n    queryFn: async () => {\n      if (!sessionId) return null\n      return sessionChargesService.getSessionSummary(sessionId)\n    },\n    enabled: !!sessionId,\n  })\n\n  // Récupérer les catégories de charges\n  const { data: chargeCategories } = useQuery({\n    queryKey: ['charge-categories', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return []\n      // Initialiser les catégories par défaut si nécessaire\n      const categories = await sessionChargesService.getCategories(user.organization_id)\n      if (categories.length === 0) {\n        await sessionChargesService.initDefaultCategories(user.organization_id)\n        return sessionChargesService.getCategories(user.organization_id)\n      }\n      return categories\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  // Formulaire de charge\n  const [chargeForm, setChargeForm] = useState({\n    description: '',\n    amount: '',\n    currency: 'EUR',\n    charge_date: new Date().toISOString().split('T')[0],\n    category_id: '',\n    payment_method: '',\n    payment_status: 'pending' as 'pending' | 'paid' | 'cancelled',\n    vendor: '',\n    vendor_invoice_number: '',\n    vendor_invoice_date: '',\n    notes: '',\n  })\n\n  // Formulaire de paiement\n  const [paymentForm, setPaymentForm] = useState({\n    amount: '',\n    currency: 'EUR',\n    payment_method: 'cash' as 'cash' | 'card' | 'bank_transfer' | 'sepa',\n    transaction_id: '',\n    notes: '',\n  })\n\n  // Formulaire de facture/devis\n  const [invoiceForm, setInvoiceForm] = useState({\n    amount: '',\n    tax_amount: '0',\n    currency: 'EUR',\n    issue_date: new Date().toISOString().split('T')[0],\n    due_date: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n    notes: '',\n  })\n  // Fonction pour télécharger une facture ou un devis\n  const handleDownloadDocument = async (invoice: any, type: 'invoice' | 'quote') => {\n    if (!org || !invoice) {\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: 'Données manquantes pour la génération du document.',\n      })\n      return\n    }\n\n    const template = type === 'invoice' ? invoiceTemplate : quoteTemplate\n    if (!template) {\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: `Aucun modèle de ${type === 'invoice' ? 'facture' : 'devis'} trouvé.`,\n      })\n      return\n    }\n\n    setIsDownloading(invoice.id)\n\n    try {\n      const student = invoice.students as StudentWithRelations | undefined\n      const invoiceData = invoice as InvoiceWithRelations\n\n      const variables = extractDocumentVariables({\n        student,\n        organization: org as any,\n        session: sessionData,\n        invoice: invoiceData,\n        academicYear,\n        language: 'fr',\n        issueDate: invoice.issue_date,\n      })\n\n      const result = await generateHTML(template, variables, undefined, user?.organization_id || undefined)\n      const filename = `${type === 'invoice' ? 'facture' : 'devis'}_${invoice.invoice_number}.pdf`\n\n      const tempDiv = document.createElement('div')\n      tempDiv.style.position = 'absolute'\n      tempDiv.style.left = '-9999px'\n      tempDiv.style.top = '0'\n      tempDiv.style.width = '794px'\n      tempDiv.style.minHeight = '1123px'\n      tempDiv.style.backgroundColor = '#ffffff'\n      tempDiv.style.overflow = 'visible'\n      tempDiv.style.fontFamily = 'Arial, sans-serif'\n      document.body.appendChild(tempDiv)\n\n      const parser = new DOMParser()\n      const doc = parser.parseFromString(result.html, 'text/html')\n      const bodyContent = doc.body.innerHTML\n      tempDiv.innerHTML = bodyContent\n\n      let element = tempDiv.querySelector('.document-container') || tempDiv.querySelector('[id$=\"-document\"]') || tempDiv.firstElementChild\n      if (!element || !(element instanceof HTMLElement)) {\n        element = tempDiv\n      }\n\n      const elementId = `temp-pdf-${type}-${invoice.id}-${Date.now()}`\n      if (element instanceof HTMLElement) {\n        element.id = elementId\n        if (!element.style.width) element.style.width = '794px'\n        if (!element.style.minHeight) element.style.minHeight = '1123px'\n        element.style.backgroundColor = '#ffffff'\n      }\n\n      await new Promise((resolve) => setTimeout(resolve, 1000))\n\n      if (element instanceof HTMLElement) {\n        const rect = element.getBoundingClientRect()\n        if (rect.width === 0 || rect.height === 0) {\n          element = tempDiv\n          tempDiv.id = elementId\n          tempDiv.style.width = '794px'\n          tempDiv.style.minHeight = '1123px'\n        }\n      }\n\n      await generatePDFFromHTML(elementId, filename)\n\n      addToast({\n        type: 'success',\n        title: 'Document téléchargé',\n        description: `Le ${type === 'invoice' ? 'facture' : 'devis'} a été généré et téléchargé avec succès.`,\n      })\n    } catch (error) {\n      console.error('Erreur lors de la génération du document:', error)\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: 'Une erreur est survenue lors de la génération du document.',\n      })\n    } finally {\n      setIsDownloading(null)\n      const tempDivs = document.querySelectorAll(`[id^=\"temp-pdf-${type}-\"]`)\n      tempDivs.forEach((div) => {\n        if (div.parentNode === document.body) {\n          document.body.removeChild(div)\n        }\n      })\n    }\n  }\n\n  // Mutation pour créer une facture\n  const createInvoiceMutation = useMutation({\n    mutationFn: async () => {\n      if (!user?.organization_id) throw new Error('Données manquantes')\n      if (!selectedEnrollmentId) {\n        throw new Error('Veuillez sélectionner un étudiant depuis la liste ci-dessus.')\n      }\n      const enrollment = enrollments.find((e) => e.id === selectedEnrollmentId)\n      if (!enrollment || !enrollment.students) throw new Error('Inscription non trouvée')\n\n      const amount = parseFloat(invoiceForm.amount) || 0\n      const taxAmount = parseFloat(invoiceForm.tax_amount) || 0\n      const totalAmount = amount + taxAmount\n\n      return invoiceService.create({\n        organization_id: user.organization_id,\n        student_id: enrollment.student_id,\n        invoice_number: '',\n        type: 'tuition',\n        document_type: 'invoice',\n        issue_date: invoiceForm.issue_date,\n        due_date: invoiceForm.due_date,\n        amount,\n        tax_amount: taxAmount,\n        total_amount: totalAmount,\n        currency: invoiceForm.currency,\n        status: 'sent',\n        notes: invoiceForm.notes,\n      })\n    },\n    onSuccess: () => {\n      addToast({\n        type: 'success',\n        title: 'Facture créée',\n        description: 'La facture a été créée avec succès.',\n      })\n      setShowInvoiceForm(false)\n      setInvoiceForm({\n        amount: '',\n        tax_amount: '0',\n        currency: 'EUR',\n        issue_date: new Date().toISOString().split('T')[0],\n        due_date: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n        notes: '',\n      })\n      queryClient.invalidateQueries({ queryKey: ['session-invoices', sessionId] })\n    },\n    onError: (error: any) => {\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: error?.message || 'Erreur lors de la création de la facture.',\n      })\n    },\n  })\n\n  // Mutation pour créer un devis\n  const createQuoteMutation = useMutation({\n    mutationFn: async () => {\n      if (!user?.organization_id) throw new Error('Données manquantes')\n      if (!selectedEnrollmentId) {\n        throw new Error('Veuillez sélectionner un étudiant depuis la liste ci-dessus.')\n      }\n      const enrollment = enrollments.find((e) => e.id === selectedEnrollmentId)\n      if (!enrollment || !enrollment.students) throw new Error('Inscription non trouvée')\n\n      const amount = parseFloat(invoiceForm.amount) || 0\n      const taxAmount = parseFloat(invoiceForm.tax_amount) || 0\n      const totalAmount = amount + taxAmount\n\n      return invoiceService.create({\n        organization_id: user.organization_id,\n        student_id: enrollment.student_id,\n        invoice_number: '',\n        type: 'tuition',\n        document_type: 'quote',\n        issue_date: invoiceForm.issue_date,\n        due_date: invoiceForm.due_date,\n        amount,\n        tax_amount: taxAmount,\n        total_amount: totalAmount,\n        currency: invoiceForm.currency,\n        status: 'draft',\n        notes: invoiceForm.notes,\n      })\n    },\n    onSuccess: () => {\n      addToast({\n        type: 'success',\n        title: 'Devis créé',\n        description: 'Le devis a été créé avec succès.',\n      })\n      setShowQuoteForm(false)\n      setInvoiceForm({\n        amount: '',\n        tax_amount: '0',\n        currency: 'EUR',\n        issue_date: new Date().toISOString().split('T')[0],\n        due_date: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n        notes: '',\n      })\n      queryClient.invalidateQueries({ queryKey: ['session-invoices', sessionId] })\n    },\n    onError: (error: any) => {\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: error?.message || 'Erreur lors de la création du devis.',\n      })\n    },\n  })\n\n  // Mutation pour enregistrer un paiement\n  const createPaymentMutation = useMutation({\n    mutationFn: async () => {\n      if (!selectedEnrollmentId || !user?.organization_id) throw new Error('Données manquantes')\n      const enrollment = enrollments.find((e) => e.id === selectedEnrollmentId)\n      if (!enrollment || !enrollment.students) throw new Error('Inscription non trouvée')\n\n      const amountNumber = parseFloat(paymentForm.amount)\n      if (isNaN(amountNumber) || amountNumber <= 0) {\n        throw new Error('Montant de paiement invalide')\n      }\n\n      // Trouver la facture associée si possible\n      const relatedInvoice = invoices?.find(\n        (inv: any) => inv.student_id === enrollment.student_id && inv.document_type === 'invoice'\n      )\n\n      return paymentService.create({\n        organization_id: user.organization_id,\n        invoice_id: relatedInvoice?.id || null,\n        student_id: enrollment.student_id,\n        amount: amountNumber,\n        currency: paymentForm.currency,\n        payment_method: paymentForm.payment_method,\n        payment_provider: paymentForm.payment_method === 'card' || paymentForm.payment_method === 'sepa' ? 'stripe' : null,\n        transaction_id: paymentForm.transaction_id || null,\n        status: paymentForm.payment_method === 'cash' ? 'completed' : 'pending',\n        paid_at: paymentForm.payment_method === 'cash' ? new Date().toISOString() : null,\n        metadata: {\n          notes: paymentForm.notes,\n        },\n      })\n    },\n    onSuccess: () => {\n      addToast({\n        type: 'success',\n        title: 'Paiement enregistré',\n        description: 'Le paiement a été enregistré avec succès.',\n      })\n      setShowPaymentForm(false)\n      setPaymentForm({\n        amount: '',\n        currency: 'EUR',\n        payment_method: 'cash',\n        transaction_id: '',\n        notes: '',\n      })\n      queryClient.invalidateQueries({ queryKey: ['payments'] })\n    },\n    onError: (error: any) => {\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: error?.message || 'Erreur lors de l\\'enregistrement du paiement.',\n      })\n    },\n  })\n\n  const totalRevenue = enrollments.reduce((sum, e) => sum + Number(e.total_amount || 0), 0)\n  const totalPaid = enrollments.reduce((sum, e) => sum + Number(e.paid_amount || 0), 0)\n  const totalRemaining = enrollments.reduce((sum, e) => {\n    const total = Number(e.total_amount || 0)\n    const paid = Number(e.paid_amount || 0)\n    return sum + (total - paid)\n  }, 0)\n  const paymentsViaPayments = payments.reduce((sum, p) => sum + Number(p.amount || 0), 0)\n  const enrollmentsWithBalance = enrollments.filter((e) => {\n    const total = Number(e.total_amount || 0)\n    const paid = Number(e.paid_amount || 0)\n    return total - paid > 0\n  })\n\n  // Obtenir les factures et devis pour un étudiant\n  const getInvoicesForStudent = (studentId: string) => {\n    return invoices?.filter((inv: any) => inv.student_id === studentId) || []\n  }\n\n  // Mutation pour créer une charge\n  const createChargeMutation = useMutation({\n    mutationFn: async () => {\n      if (!user?.organization_id || !sessionId) throw new Error('Données manquantes')\n      if (!chargeForm.description || !chargeForm.amount) {\n        throw new Error('La description et le montant sont requis')\n      }\n\n      return sessionChargesService.create(\n        user.organization_id,\n        sessionId,\n        {\n          description: chargeForm.description,\n          amount: parseFloat(chargeForm.amount),\n          currency: chargeForm.currency,\n          charge_date: chargeForm.charge_date,\n          category_id: chargeForm.category_id || null,\n          payment_method: chargeForm.payment_method || null,\n          payment_status: chargeForm.payment_status,\n          paid_at: chargeForm.payment_status === 'paid' ? new Date().toISOString() : null,\n          vendor: chargeForm.vendor || null,\n          vendor_invoice_number: chargeForm.vendor_invoice_number || null,\n          vendor_invoice_date: chargeForm.vendor_invoice_date || null,\n          notes: chargeForm.notes || null,\n        }\n      )\n    },\n    onSuccess: () => {\n      addToast({\n        type: 'success',\n        title: 'Charge créée',\n        description: 'La charge a été créée avec succès.',\n      })\n      setShowChargeForm(false)\n      setChargeForm({\n        description: '',\n        amount: '',\n        currency: 'EUR',\n        charge_date: new Date().toISOString().split('T')[0],\n        category_id: '',\n        payment_method: '',\n        payment_status: 'pending',\n        vendor: '',\n        vendor_invoice_number: '',\n        vendor_invoice_date: '',\n        notes: '',\n      })\n      refetchCharges()\n      queryClient.invalidateQueries({ queryKey: ['session-charges-summary', sessionId] })\n    },\n    onError: (error: any) => {\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: error?.message || 'Erreur lors de la création de la charge.',\n      })\n    },\n  })\n\n  // Mutation pour mettre à jour une charge\n  const updateChargeMutation = useMutation({\n    mutationFn: async () => {\n      if (!editingCharge) throw new Error('Aucune charge sélectionnée')\n      if (!chargeForm.description || !chargeForm.amount) {\n        throw new Error('La description et le montant sont requis')\n      }\n\n      return sessionChargesService.update(editingCharge.id, {\n        description: chargeForm.description,\n        amount: parseFloat(chargeForm.amount),\n        currency: chargeForm.currency,\n        charge_date: chargeForm.charge_date,\n        category_id: chargeForm.category_id || null,\n        payment_method: chargeForm.payment_method || null,\n        payment_status: chargeForm.payment_status,\n        paid_at: chargeForm.payment_status === 'paid' ? (editingCharge.paid_at || new Date().toISOString()) : null,\n        vendor: chargeForm.vendor || null,\n        vendor_invoice_number: chargeForm.vendor_invoice_number || null,\n        vendor_invoice_date: chargeForm.vendor_invoice_date || null,\n        notes: chargeForm.notes || null,\n      })\n    },\n    onSuccess: () => {\n      addToast({\n        type: 'success',\n        title: 'Charge mise à jour',\n        description: 'La charge a été mise à jour avec succès.',\n      })\n      setShowChargeForm(false)\n      setEditingCharge(null)\n      setChargeForm({\n        description: '',\n        amount: '',\n        currency: 'EUR',\n        charge_date: new Date().toISOString().split('T')[0],\n        category_id: '',\n        payment_method: '',\n        payment_status: 'pending',\n        vendor: '',\n        vendor_invoice_number: '',\n        vendor_invoice_date: '',\n        notes: '',\n      })\n      refetchCharges()\n      queryClient.invalidateQueries({ queryKey: ['session-charges-summary', sessionId] })\n    },\n    onError: (error: any) => {\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: error?.message || 'Erreur lors de la mise à jour de la charge.',\n      })\n    },\n  })\n\n  // Mutation pour supprimer une charge\n  const deleteChargeMutation = useMutation({\n    mutationFn: async (chargeId: string) => {\n      await sessionChargesService.delete(chargeId)\n    },\n    onSuccess: () => {\n      addToast({\n        type: 'success',\n        title: 'Charge supprimée',\n        description: 'La charge a été supprimée avec succès.',\n      })\n      refetchCharges()\n      queryClient.invalidateQueries({ queryKey: ['session-charges-summary', sessionId] })\n    },\n    onError: (error: any) => {\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: error?.message || 'Erreur lors de la suppression de la charge.',\n      })\n    },\n  })\n\n  const handleEditCharge = (charge: SessionChargeWithCategory) => {\n    setEditingCharge(charge)\n    setChargeForm({\n      description: charge.description,\n      amount: String(charge.amount),\n      currency: charge.currency,\n      charge_date: charge.charge_date,\n      category_id: charge.category_id || '',\n      payment_method: charge.payment_method || '',\n      payment_status: charge.payment_status as 'pending' | 'paid' | 'cancelled',\n      vendor: charge.vendor || '',\n      vendor_invoice_number: charge.vendor_invoice_number || '',\n      vendor_invoice_date: charge.vendor_invoice_date || '',\n      notes: charge.notes || '',\n    })\n    setShowChargeForm(true)\n  }\n\n  const handleNewCharge = () => {\n    setEditingCharge(null)\n    setChargeForm({\n      description: '',\n      amount: '',\n      currency: 'EUR',\n      charge_date: new Date().toISOString().split('T')[0],\n      category_id: '',\n      payment_method: '',\n      payment_status: 'pending',\n      vendor: '',\n      vendor_invoice_number: '',\n      vendor_invoice_date: '',\n      notes: '',\n    })\n    setShowChargeForm(true)\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Statistiques financières */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"text-base font-medium\">Revenu total</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-brand-blue\">\n              {formatCurrency(totalRevenue, 'EUR')}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {enrollments.length} inscription{enrollments.length > 1 ? 's' : ''}\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"text-base font-medium\">Montant payé</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-blue-600\">\n              {formatCurrency(totalPaid, 'EUR')}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {formatCurrency(paymentsViaPayments, 'EUR')} via paiements\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"text-base font-medium\">Reste à payer</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-orange-600\">\n              {formatCurrency(totalRemaining, 'EUR')}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {enrollmentsWithBalance.length} inscription{enrollmentsWithBalance.length > 1 ? 's' : ''} avec solde\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"text-base font-medium\">Charges totales</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-red-600\">\n              {formatCurrency(chargesSummary?.total_amount || 0, 'EUR')}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {chargesSummary?.charge_count || 0} charge{(chargesSummary?.charge_count || 0) > 1 ? 's' : ''}\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Section Charges */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <CardTitle>Charges de la session</CardTitle>\n              {chargesSummary && chargesSummary.charge_count > 0 && (\n                <span className=\"text-sm text-muted-foreground\">\n                  ({formatCurrency(chargesSummary.total_amount, 'EUR')})\n                </span>\n              )}\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handleNewCharge}\n              >\n                <Plus className=\"mr-2 h-4 w-4\" />\n                Nouvelle charge\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={() => setShowCharges(!showCharges)}\n              >\n                {showCharges ? <ChevronUp className=\"h-4 w-4\" /> : <ChevronDown className=\"h-4 w-4\" />}\n              </Button>\n            </div>\n          </div>\n        </CardHeader>\n        {showCharges && (\n          <CardContent>\n            {charges && charges.length > 0 ? (\n              <div className=\"space-y-3\">\n                {charges.map((charge) => (\n                  <div key={charge.id} className=\"border rounded-lg p-4 hover:bg-gray-50\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2 mb-2\">\n                          <h4 className=\"font-medium\">{charge.description}</h4>\n                          {charge.charge_categories && (\n                            <span className=\"text-xs px-2 py-1 bg-blue-50 text-blue-700 rounded\">\n                              {charge.charge_categories.name}\n                            </span>\n                          )}\n                        </div>\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm text-muted-foreground\">\n                          <div>\n                            <span className=\"font-medium\">Montant:</span>{' '}\n                            <span className=\"text-red-600 font-bold\">\n                              {formatCurrency(Number(charge.amount), charge.currency)}\n                            </span>\n                          </div>\n                          <div>\n                            <span className=\"font-medium\">Date:</span>{' '}\n                            {new Date(charge.charge_date).toLocaleDateString('fr-FR')}\n                          </div>\n                          {charge.vendor && (\n                            <div>\n                              <span className=\"font-medium\">Fournisseur:</span> {charge.vendor}\n                            </div>\n                          )}\n                          <div>\n                            <span className={`px-2 py-1 rounded text-xs ${\n                              charge.payment_status === 'paid' ? 'bg-green-100 text-green-700' :\n                              charge.payment_status === 'pending' ? 'bg-yellow-100 text-yellow-700' :\n                              'bg-red-100 text-red-700'\n                            }`}>\n                              {charge.payment_status === 'paid' ? 'Payé' :\n                               charge.payment_status === 'pending' ? 'En attente' : 'Annulé'}\n                            </span>\n                          </div>\n                        </div>\n                        {charge.notes && (\n                          <p className=\"text-sm text-muted-foreground mt-2\">{charge.notes}</p>\n                        )}\n                      </div>\n                      <div className=\"flex items-center gap-2 ml-4\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => handleEditCharge(charge)}\n                        >\n                          <Edit className=\"h-4 w-4\" />\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          onClick={() => {\n                            if (confirm('Êtes-vous sûr de vouloir supprimer cette charge ?')) {\n                              deleteChargeMutation.mutate(charge.id)\n                            }\n                          }}\n                        >\n                          <Trash2 className=\"h-4 w-4 text-destructive\" />\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n                {chargesSummary && (\n                  <div className=\"mt-4 pt-4 border-t grid grid-cols-3 gap-4\">\n                    <div className=\"text-center\">\n                      <p className=\"text-sm text-muted-foreground\">Total</p>\n                      <p className=\"text-lg font-bold text-red-600\">\n                        {formatCurrency(chargesSummary.total_amount, 'EUR')}\n                      </p>\n                    </div>\n                    <div className=\"text-center\">\n                      <p className=\"text-sm text-muted-foreground\">Payé</p>\n                      <p className=\"text-lg font-bold text-green-600\">\n                        {formatCurrency(chargesSummary.paid_amount, 'EUR')}\n                      </p>\n                    </div>\n                    <div className=\"text-center\">\n                      <p className=\"text-sm text-muted-foreground\">En attente</p>\n                      <p className=\"text-lg font-bold text-yellow-600\">\n                        {formatCurrency(chargesSummary.pending_amount, 'EUR')}\n                      </p>\n                    </div>\n                  </div>\n                )}\n              </div>\n            ) : (\n              <div className=\"text-center py-8 text-muted-foreground\">\n                <TrendingDown className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                <p>Aucune charge enregistrée pour cette session.</p>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"mt-4\"\n                  onClick={handleNewCharge}\n                >\n                  <Plus className=\"mr-2 h-4 w-4\" />\n                  Ajouter une charge\n                </Button>\n              </div>\n            )}\n          </CardContent>\n        )}\n      </Card>\n\n      {/* Répartition par statut de paiement */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Répartition par statut de paiement</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n            <div className=\"text-center p-4 bg-blue-50 rounded-lg\">\n              <p className=\"text-2xl font-bold text-blue-600\">\n                {enrollments.filter((e) => e.payment_status === 'pending').length}\n              </p>\n              <p className=\"text-sm text-muted-foreground mt-1\">En attente</p>\n            </div>\n            <div className=\"text-center p-4 bg-brand-cyan-ghost rounded-lg\">\n              <p className=\"text-2xl font-bold text-brand-cyan\">\n                {enrollments.filter((e) => e.payment_status === 'partial').length}\n              </p>\n              <p className=\"text-sm text-muted-foreground mt-1\">Partiel</p>\n            </div>\n            <div className=\"text-center p-4 bg-brand-blue-ghost rounded-lg\">\n              <p className=\"text-2xl font-bold text-brand-blue\">\n                {enrollments.filter((e) => e.payment_status === 'paid').length}\n              </p>\n              <p className=\"text-sm text-muted-foreground mt-1\">Payé</p>\n            </div>\n            <div className=\"text-center p-4 bg-red-50 rounded-lg\">\n              <p className=\"text-2xl font-bold text-red-600\">\n                {enrollments.filter((e) => e.payment_status === 'overdue').length}\n              </p>\n              <p className=\"text-sm text-muted-foreground mt-1\">En retard</p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Liste des inscriptions avec détails financiers */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <CardTitle>Détails des inscriptions</CardTitle>\n            <div className=\"flex gap-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => {\n                  setSelectedEnrollmentId(null)\n                  setShowQuoteForm(true)\n                  setShowInvoiceForm(false)\n                }}\n              >\n                <Plus className=\"mr-2 h-4 w-4\" />\n                Nouveau devis\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => {\n                  setSelectedEnrollmentId(null)\n                  setShowInvoiceForm(true)\n                  setShowQuoteForm(false)\n                }}\n              >\n                <Plus className=\"mr-2 h-4 w-4\" />\n                Nouvelle facture\n              </Button>\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-3\">\n            {enrollments.length === 0 ? (\n              <p className=\"text-sm text-muted-foreground text-center py-8\">\n                Aucune inscription pour le moment\n              </p>\n            ) : (\n              enrollments.map((enrollment) => {\n                const student = enrollment.students\n                if (!student) return null\n\n                const total = Number(enrollment.total_amount || 0)\n                const paid = Number(enrollment.paid_amount || 0)\n                const remaining = total - paid\n                const studentInvoices = enrollment.student_id ? getInvoicesForStudent(enrollment.student_id) : []\n                const studentInvoicesList = studentInvoices.filter((inv: any) => inv.document_type === 'invoice')\n                const studentQuotesList = studentInvoices.filter((inv: any) => inv.document_type === 'quote')\n\n                return (\n                  <div key={enrollment.id} className=\"border rounded-lg p-4 hover:bg-gray-50 space-y-3\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex-1\">\n                        <p className=\"font-medium\">{student.first_name} {student.last_name}</p>\n                        <p className=\"text-sm text-muted-foreground\">{student.student_number}</p>\n                      </div>\n                      <div className=\"text-right space-y-1\">\n                        <p className=\"text-sm\">\n                          Total: <span className=\"font-medium\">{formatCurrency(total, 'EUR')}</span>\n                        </p>\n                        <p className=\"text-sm\">\n                          Payé: <span className=\"font-medium text-blue-600\">{formatCurrency(paid, 'EUR')}</span>\n                        </p>\n                        {remaining > 0 && (\n                          <p className=\"text-sm\">\n                            Reste: <span className=\"font-medium text-orange-600\">{formatCurrency(remaining, 'EUR')}</span>\n                          </p>\n                        )}\n                        <span className={`text-xs px-2 py-1 rounded inline-block mt-2 ${\n                          enrollment.payment_status === 'paid' ? 'bg-brand-blue-ghost text-brand-blue' :\n                          enrollment.payment_status === 'partial' ? 'bg-brand-cyan-ghost text-brand-cyan' :\n                          enrollment.payment_status === 'overdue' ? 'bg-red-100 text-red-800' :\n                          'bg-gray-100 text-gray-800'\n                        }`}>\n                          {enrollment.payment_status === 'paid' ? 'Payé' :\n                           enrollment.payment_status === 'partial' ? 'Partiel' :\n                           enrollment.payment_status === 'overdue' ? 'En retard' : 'En attente'}\n                        </span>\n                      </div>\n                    </div>\n\n                    {/* Actions rapides */}\n                    <div className=\"flex flex-wrap gap-2 pt-2 border-t\">\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => {\n                          setSelectedEnrollmentId(enrollment.id)\n                          setInvoiceForm({\n                            ...invoiceForm,\n                            amount: enrollment.total_amount ? String(enrollment.total_amount) : '',\n                          })\n                          setShowQuoteForm(true)\n                          setShowInvoiceForm(false)\n                        }}\n                      >\n                        <FileText className=\"mr-2 h-3 w-3\" />\n                        Créer devis\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => {\n                          setSelectedEnrollmentId(enrollment.id)\n                          setInvoiceForm({\n                            ...invoiceForm,\n                            amount: enrollment.total_amount ? String(enrollment.total_amount) : '',\n                          })\n                          setShowInvoiceForm(true)\n                          setShowQuoteForm(false)\n                        }}\n                      >\n                        <Receipt className=\"mr-2 h-3 w-3\" />\n                        Créer facture\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => {\n                          setSelectedEnrollmentId(enrollment.id)\n                          setShowPaymentForm(true)\n                        }}\n                      >\n                        <DollarSign className=\"mr-2 h-3 w-3\" />\n                        Saisir paiement\n                      </Button>\n                    </div>\n\n                    {/* Liste des factures et devis */}\n                    {(studentInvoicesList.length > 0 || studentQuotesList.length > 0) && (\n                      <div className=\"pt-2 border-t space-y-2\">\n                        {studentQuotesList.length > 0 && (\n                          <div>\n                            <p className=\"text-xs font-medium text-muted-foreground mb-1\">Devis :</p>\n                            <div className=\"flex flex-wrap gap-2\">\n                              {studentQuotesList.map((quote: any) => (\n                                <div key={quote.id} className=\"flex items-center gap-2 text-xs\">\n                                  <span className=\"text-muted-foreground\">{quote.invoice_number}</span>\n                                  <Button\n                                    variant=\"ghost\"\n                                    size=\"sm\"\n                                    className=\"h-6 px-2\"\n                                    onClick={() => handleDownloadDocument(quote, 'quote')}\n                                    disabled={isDownloading === quote.id}\n                                  >\n                                    {isDownloading === quote.id ? (\n                                      '...'\n                                    ) : (\n                                      <Download className=\"h-3 w-3\" />\n                                    )}\n                                  </Button>\n                                </div>\n                              ))}\n                            </div>\n                          </div>\n                        )}\n                        {studentInvoicesList.length > 0 && (\n                          <div>\n                            <p className=\"text-xs font-medium text-muted-foreground mb-1\">Factures :</p>\n                            <div className=\"flex flex-wrap gap-2\">\n                              {studentInvoicesList.map((invoice: any) => (\n                                <div key={invoice.id} className=\"flex items-center gap-2 text-xs\">\n                                  <span className=\"text-muted-foreground\">{invoice.invoice_number}</span>\n                                  <Button\n                                    variant=\"ghost\"\n                                    size=\"sm\"\n                                    className=\"h-6 px-2\"\n                                    onClick={() => handleDownloadDocument(invoice, 'invoice')}\n                                    disabled={isDownloading === invoice.id}\n                                  >\n                                    {isDownloading === invoice.id ? (\n                                      '...'\n                                    ) : (\n                                      <Download className=\"h-3 w-3\" />\n                                    )}\n                                  </Button>\n                                  <Link href={`/dashboard/payments/${invoice.id}`}>\n                                    <Button variant=\"ghost\" size=\"sm\" className=\"h-6 px-2\">\n                                      <Eye className=\"h-3 w-3\" />\n                                    </Button>\n                                  </Link>\n                                </div>\n                              ))}\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                )\n              })\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Paiements récents */}\n      {payments.length > 0 && (\n        <Card>\n          <CardHeader>\n            <CardTitle>Paiements récents</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {payments.slice(0, 10).map((payment) => {\n                const student = (payment as any).students\n                return (\n                  <div key={payment.id} className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50\">\n                    <div className=\"flex-1\">\n                      <p className=\"font-medium\">\n                        {student ? `${student.first_name} ${student.last_name}` : 'Apprenant'}\n                      </p>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {payment.paid_at && new Date(payment.paid_at).toLocaleDateString('fr-FR')}\n                        {payment.payment_method && ` • ${payment.payment_method}`}\n                      </p>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"font-bold text-lg text-brand-blue\">\n                        {formatCurrency(Number(payment.amount || 0), payment.currency || 'EUR')}\n                      </p>\n                      <p className={`text-xs px-2 py-1 rounded inline-block mt-1 ${\n                        payment.status === 'completed' ? 'bg-brand-blue-ghost text-brand-blue' :\n                        payment.status === 'pending' ? 'bg-brand-cyan-ghost text-brand-cyan' :\n                        'bg-red-100 text-red-800'\n                      }`}>\n                        {payment.status === 'completed' ? 'Complété' :\n                         payment.status === 'pending' ? 'En attente' : 'Échoué'}\n                      </p>\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Formulaire de paiement */}\n      {showPaymentForm && selectedEnrollmentId && (\n        <Card>\n          <CardHeader>\n            <CardTitle>Enregistrer un paiement</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <form\n              onSubmit={(e) => {\n                e.preventDefault()\n                createPaymentMutation.mutate()\n              }}\n              className=\"space-y-4\"\n            >\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">Montant *</label>\n                <input\n                  type=\"number\"\n                  required\n                  step=\"0.01\"\n                  min=\"0.01\"\n                  value={paymentForm.amount}\n                  onChange={(e) => setPaymentForm({ ...paymentForm, amount: e.target.value })}\n                  className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  placeholder=\"0.00\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">Méthode de paiement *</label>\n                <select\n                  required\n                  value={paymentForm.payment_method}\n                  onChange={(e) =>\n                    setPaymentForm({\n                      ...paymentForm,\n                      payment_method: e.target.value as 'cash' | 'card' | 'bank_transfer' | 'sepa',\n                    })\n                  }\n                  className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                >\n                  <option value=\"cash\">Espèces</option>\n                  <option value=\"card\">Carte bancaire</option>\n                  <option value=\"bank_transfer\">Virement bancaire</option>\n                  <option value=\"sepa\">Virement SEPA</option>\n                </select>\n              </div>\n\n              {paymentForm.payment_method !== 'cash' && (\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">ID de transaction</label>\n                  <input\n                    type=\"text\"\n                    value={paymentForm.transaction_id}\n                    onChange={(e) =>\n                      setPaymentForm({ ...paymentForm, transaction_id: e.target.value })\n                    }\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                    placeholder=\"ID de la transaction\"\n                  />\n                </div>\n              )}\n\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">Notes</label>\n                <textarea\n                  value={paymentForm.notes}\n                  onChange={(e) => setPaymentForm({ ...paymentForm, notes: e.target.value })}\n                  rows={2}\n                  className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  placeholder=\"Notes supplémentaires...\"\n                />\n              </div>\n\n              <div className=\"flex space-x-2\">\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  className=\"flex-1\"\n                  onClick={() => {\n                    setShowPaymentForm(false)\n                    setSelectedEnrollmentId(null)\n                  }}\n                >\n                  Annuler\n                </Button>\n                <Button type=\"submit\" className=\"flex-1\" disabled={createPaymentMutation.isPending}>\n                  {createPaymentMutation.isPending ? 'Enregistrement...' : 'Enregistrer'}\n                </Button>\n              </div>\n            </form>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Formulaire de facture */}\n      {showInvoiceForm && (\n        <Card>\n          <CardHeader>\n            <CardTitle>Créer une facture</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {!selectedEnrollmentId && (\n              <div className=\"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg\">\n                <p className=\"text-sm text-yellow-800\">\n                  ⚠️ Veuillez sélectionner un étudiant depuis la liste ci-dessus avant de créer la facture.\n                </p>\n              </div>\n            )}\n            {selectedEnrollmentId && (\n              <div className=\"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\n                <p className=\"text-sm text-blue-800\">\n                  Étudiant sélectionné : {enrollments.find((e) => e.id === selectedEnrollmentId)?.students?.first_name} {enrollments.find((e) => e.id === selectedEnrollmentId)?.students?.last_name}\n                </p>\n              </div>\n            )}\n            <form\n              onSubmit={(e) => {\n                e.preventDefault()\n                createInvoiceMutation.mutate()\n              }}\n              className=\"space-y-4\"\n            >\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">Montant HT *</label>\n                <input\n                  type=\"number\"\n                  required\n                  step=\"0.01\"\n                  min=\"0.01\"\n                  value={invoiceForm.amount}\n                  onChange={(e) => setInvoiceForm({ ...invoiceForm, amount: e.target.value })}\n                  className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  placeholder=\"0.00\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">TVA</label>\n                <input\n                  type=\"number\"\n                  step=\"0.01\"\n                  min=\"0\"\n                  value={invoiceForm.tax_amount}\n                  onChange={(e) => setInvoiceForm({ ...invoiceForm, tax_amount: e.target.value })}\n                  className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  placeholder=\"0.00\"\n                />\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">Date d'émission *</label>\n                  <input\n                    type=\"date\"\n                    required\n                    value={invoiceForm.issue_date}\n                    onChange={(e) => setInvoiceForm({ ...invoiceForm, issue_date: e.target.value })}\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">Date d'échéance *</label>\n                  <input\n                    type=\"date\"\n                    required\n                    value={invoiceForm.due_date}\n                    onChange={(e) => setInvoiceForm({ ...invoiceForm, due_date: e.target.value })}\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  />\n                </div>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">Notes</label>\n                <textarea\n                  value={invoiceForm.notes}\n                  onChange={(e) => setInvoiceForm({ ...invoiceForm, notes: e.target.value })}\n                  rows={2}\n                  className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  placeholder=\"Notes supplémentaires...\"\n                />\n              </div>\n\n              <div className=\"flex space-x-2\">\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  className=\"flex-1\"\n                  onClick={() => {\n                    setShowInvoiceForm(false)\n                    setSelectedEnrollmentId(null)\n                  }}\n                >\n                  Annuler\n                </Button>\n                <Button \n                  type=\"submit\" \n                  className=\"flex-1\" \n                  disabled={createInvoiceMutation.isPending || !selectedEnrollmentId}\n                >\n                  {createInvoiceMutation.isPending ? 'Création...' : 'Créer la facture'}\n                </Button>\n              </div>\n            </form>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Formulaire de devis */}\n      {showQuoteForm && (\n        <Card>\n          <CardHeader>\n            <CardTitle>Créer un devis</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {!selectedEnrollmentId && (\n              <div className=\"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg\">\n                <p className=\"text-sm text-yellow-800\">\n                  ⚠️ Veuillez sélectionner un étudiant depuis la liste ci-dessus avant de créer le devis.\n                </p>\n              </div>\n            )}\n            {selectedEnrollmentId && (\n              <div className=\"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg\">\n                <p className=\"text-sm text-blue-800\">\n                  Étudiant sélectionné : {enrollments.find((e) => e.id === selectedEnrollmentId)?.students?.first_name} {enrollments.find((e) => e.id === selectedEnrollmentId)?.students?.last_name}\n                </p>\n              </div>\n            )}\n            <form\n              onSubmit={(e) => {\n                e.preventDefault()\n                createQuoteMutation.mutate()\n              }}\n              className=\"space-y-4\"\n            >\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">Montant HT *</label>\n                <input\n                  type=\"number\"\n                  required\n                  step=\"0.01\"\n                  min=\"0.01\"\n                  value={invoiceForm.amount}\n                  onChange={(e) => setInvoiceForm({ ...invoiceForm, amount: e.target.value })}\n                  className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  placeholder=\"0.00\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">TVA</label>\n                <input\n                  type=\"number\"\n                  step=\"0.01\"\n                  min=\"0\"\n                  value={invoiceForm.tax_amount}\n                  onChange={(e) => setInvoiceForm({ ...invoiceForm, tax_amount: e.target.value })}\n                  className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  placeholder=\"0.00\"\n                />\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">Date d'émission *</label>\n                  <input\n                    type=\"date\"\n                    required\n                    value={invoiceForm.issue_date}\n                    onChange={(e) => setInvoiceForm({ ...invoiceForm, issue_date: e.target.value })}\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">Date d'échéance *</label>\n                  <input\n                    type=\"date\"\n                    required\n                    value={invoiceForm.due_date}\n                    onChange={(e) => setInvoiceForm({ ...invoiceForm, due_date: e.target.value })}\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  />\n                </div>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">Notes</label>\n                <textarea\n                  value={invoiceForm.notes}\n                  onChange={(e) => setInvoiceForm({ ...invoiceForm, notes: e.target.value })}\n                  rows={2}\n                  className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  placeholder=\"Notes supplémentaires...\"\n                />\n              </div>\n\n              <div className=\"flex space-x-2\">\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  className=\"flex-1\"\n                  onClick={() => {\n                    setShowQuoteForm(false)\n                    setSelectedEnrollmentId(null)\n                  }}\n                >\n                  Annuler\n                </Button>\n                <Button \n                  type=\"submit\" \n                  className=\"flex-1\" \n                  disabled={createQuoteMutation.isPending || !selectedEnrollmentId}\n                >\n                  {createQuoteMutation.isPending ? 'Création...' : 'Créer le devis'}\n                </Button>\n              </div>\n            </form>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Formulaire de charge */}\n      {showChargeForm && (\n        <Card>\n          <CardHeader>\n            <CardTitle>{editingCharge ? 'Modifier la charge' : 'Nouvelle charge'}</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <form\n              onSubmit={(e) => {\n                e.preventDefault()\n                if (editingCharge) {\n                  updateChargeMutation.mutate()\n                } else {\n                  createChargeMutation.mutate()\n                }\n              }}\n              className=\"space-y-4\"\n            >\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">Description *</label>\n                <input\n                  type=\"text\"\n                  required\n                  value={chargeForm.description}\n                  onChange={(e) => setChargeForm({ ...chargeForm, description: e.target.value })}\n                  className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  placeholder=\"Ex: Location de salle pour la formation\"\n                />\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">Montant *</label>\n                  <input\n                    type=\"number\"\n                    required\n                    step=\"0.01\"\n                    min=\"0.01\"\n                    value={chargeForm.amount}\n                    onChange={(e) => setChargeForm({ ...chargeForm, amount: e.target.value })}\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                    placeholder=\"0.00\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">Devise</label>\n                  <select\n                    value={chargeForm.currency}\n                    onChange={(e) => setChargeForm({ ...chargeForm, currency: e.target.value })}\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  >\n                    <option value=\"EUR\">EUR</option>\n                    <option value=\"USD\">USD</option>\n                    <option value=\"XOF\">XOF</option>\n                  </select>\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">Date *</label>\n                  <input\n                    type=\"date\"\n                    required\n                    value={chargeForm.charge_date}\n                    onChange={(e) => setChargeForm({ ...chargeForm, charge_date: e.target.value })}\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">Catégorie</label>\n                  <select\n                    value={chargeForm.category_id}\n                    onChange={(e) => setChargeForm({ ...chargeForm, category_id: e.target.value })}\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  >\n                    <option value=\"\">Sélectionner une catégorie</option>\n                    {chargeCategories?.map((cat) => (\n                      <option key={cat.id} value={cat.id}>\n                        {cat.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">Méthode de paiement</label>\n                  <select\n                    value={chargeForm.payment_method}\n                    onChange={(e) => setChargeForm({ ...chargeForm, payment_method: e.target.value })}\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  >\n                    <option value=\"\">Non spécifié</option>\n                    <option value=\"cash\">Espèces</option>\n                    <option value=\"bank_transfer\">Virement bancaire</option>\n                    <option value=\"card\">Carte bancaire</option>\n                    <option value=\"mobile_money\">Mobile Money</option>\n                    <option value=\"check\">Chèque</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">Statut de paiement</label>\n                  <select\n                    value={chargeForm.payment_status}\n                    onChange={(e) => setChargeForm({ ...chargeForm, payment_status: e.target.value as 'pending' | 'paid' | 'cancelled' })}\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  >\n                    <option value=\"pending\">En attente</option>\n                    <option value=\"paid\">Payé</option>\n                    <option value=\"cancelled\">Annulé</option>\n                  </select>\n                </div>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">Fournisseur</label>\n                <input\n                  type=\"text\"\n                  value={chargeForm.vendor}\n                  onChange={(e) => setChargeForm({ ...chargeForm, vendor: e.target.value })}\n                  className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  placeholder=\"Nom du fournisseur/prestataire\"\n                />\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">N° facture fournisseur</label>\n                  <input\n                    type=\"text\"\n                    value={chargeForm.vendor_invoice_number}\n                    onChange={(e) => setChargeForm({ ...chargeForm, vendor_invoice_number: e.target.value })}\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                    placeholder=\"N° de facture\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium mb-2\">Date facture fournisseur</label>\n                  <input\n                    type=\"date\"\n                    value={chargeForm.vendor_invoice_date}\n                    onChange={(e) => setChargeForm({ ...chargeForm, vendor_invoice_date: e.target.value })}\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  />\n                </div>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium mb-2\">Notes</label>\n                <textarea\n                  value={chargeForm.notes}\n                  onChange={(e) => setChargeForm({ ...chargeForm, notes: e.target.value })}\n                  rows={3}\n                  className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                  placeholder=\"Notes supplémentaires...\"\n                />\n              </div>\n\n              <div className=\"flex space-x-2\">\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  className=\"flex-1\"\n                  onClick={() => {\n                    setShowChargeForm(false)\n                    setEditingCharge(null)\n                  }}\n                >\n                  Annuler\n                </Button>\n                <Button\n                  type=\"submit\"\n                  className=\"flex-1\"\n                  disabled={createChargeMutation.isPending || updateChargeMutation.isPending}\n                >\n                  {createChargeMutation.isPending || updateChargeMutation.isPending\n                    ? 'Enregistrement...'\n                    : editingCharge\n                    ? 'Mettre à jour'\n                    : 'Créer la charge'}\n                </Button>\n              </div>\n            </form>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"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"}