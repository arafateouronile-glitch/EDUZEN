module.exports=[21329,a=>{"use strict";var b=a.i(187924),c=a.i(433217),d=a.i(269240),e=a.i(703130),f=a.i(254161),g=a.i(111269),h=a.i(54018),i=a.i(290821),j=a.i(641710),k=a.i(220494);let l=(0,a.i(170106).default)("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);var m=a.i(290669),n=a.i(660246),o=a.i(104720),p=a.i(790166),q=a.i(497895),r=a.i(950463);a.i(460355);var s=a.i(346271),t=a.i(697976),u=a.i(572131);function v(){let a=(0,d.createClient)(),[v,w]=(0,u.useState)({});(0,u.useEffect)(()=>{let a={};for(let[b,c]of Object.entries(t.performanceMonitor.getMetricsByGroup())){let c=t.performanceMonitor.getStats(b);c&&(a[b]=c)}w(a);let b=setInterval(()=>{let a={};for(let[b,c]of Object.entries(t.performanceMonitor.getMetricsByGroup())){let c=t.performanceMonitor.getStats(b);c&&(a[b]=c)}w(a)},3e4);return()=>clearInterval(b)},[]);let{data:x,isLoading:y}=(0,c.useQuery)({queryKey:["health-db"],queryFn:async()=>{let b=Date.now();try{let{data:c,error:d}=await a.from("organizations").select("id").limit(1),e=Date.now()-b;return{status:d?"error":"healthy",responseTime:e,error:d?.message,timestamp:new Date().toISOString()}}catch(a){return{status:"error",responseTime:Date.now()-b,error:a instanceof Error?a.message:"Unknown error",timestamp:new Date().toISOString()}}},refetchInterval:3e4}),{data:z,isLoading:A}=(0,c.useQuery)({queryKey:["health-stats"],queryFn:async()=>{let[b,c,d,e,f]=await Promise.all([a.from("organizations").select("id",{count:"exact",head:!0}),a.from("users").select("id",{count:"exact",head:!0}),a.from("students").select("id",{count:"exact",head:!0}),a.from("documents").select("id",{count:"exact",head:!0}),a.from("payments").select("id",{count:"exact",head:!0}).eq("status","completed")]);return{organizations:b.count||0,users:c.count||0,students:d.count||0,documents:e.count||0,completedPayments:f.count||0,timestamp:new Date().toISOString()}},refetchInterval:6e4}),{data:B,isLoading:C}=(0,c.useQuery)({queryKey:["health-performance"],queryFn:async()=>{let b=[{name:"Organizations",query:a.from("organizations").select("id").limit(10)},{name:"Users",query:a.from("users").select("id").limit(10)},{name:"Students",query:a.from("students").select("id").limit(10)},{name:"Sessions",query:a.from("sessions").select("id").limit(10)}];return await Promise.all(b.map(async({name:a,query:b})=>{let c=Date.now();try{let{error:d}=await b,e=Date.now()-c;return{name:a,status:d?"error":"success",responseTime:e,error:d?.message}}catch(b){return{name:a,status:"error",responseTime:Date.now()-c,error:b instanceof Error?b.message:"Unknown error"}}}))},refetchInterval:12e4}),D=a=>{switch(a){case"healthy":case"success":return(0,b.jsx)(g.CheckCircle2,{className:"h-5 w-5 text-emerald-500"});case"error":return(0,b.jsx)(h.XCircle,{className:"h-5 w-5 text-red-500"});default:return(0,b.jsx)(i.AlertCircle,{className:"h-5 w-5 text-yellow-500"})}},E=a=>{switch(a){case"healthy":case"success":return(0,b.jsx)(f.Badge,{className:"bg-emerald-100 text-emerald-700",children:"Healthy"});case"error":return(0,b.jsx)(f.Badge,{className:"bg-red-100 text-red-700",children:"Error"});default:return(0,b.jsx)(f.Badge,{className:"bg-yellow-100 text-yellow-700",children:"Warning"})}};return(0,b.jsxs)("div",{className:"space-y-6 p-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Dashboard de Santé"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-2",children:"Surveillance de l'état de l'application et des performances"})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Database,{className:"h-5 w-5"}),"Connexion Base de Données"]}),(0,b.jsx)(e.CardDescription,{children:"État de la connexion à Supabase"})]}),(0,b.jsx)(e.CardContent,{children:y?(0,b.jsx)(r.Skeleton,{className:"h-20 w-full"}):x?(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[D(x.status),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:"Base de données"}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Temps de réponse: ",x.responseTime,"ms"]}),x.error&&(0,b.jsx)("div",{className:"text-sm text-red-600 mt-1",children:x.error})]})]}),E(x.status)]}):null})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Activity,{className:"h-5 w-5"}),"Statistiques Générales"]}),(0,b.jsx)(e.CardDescription,{children:"Données agrégées de l'application"})]}),(0,b.jsx)(e.CardContent,{children:A?(0,b.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(r.Skeleton,{className:"h-20 w-full"},c))}):z?(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,b.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-4 rounded-lg bg-blue-50 border border-blue-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(l,{className:"h-4 w-4 text-blue-600"}),(0,b.jsx)("p",{className:"text-sm text-blue-600 font-medium",children:"Organisations"})]}),(0,b.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:z.organizations})]}),(0,b.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"p-4 rounded-lg bg-purple-50 border border-purple-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(n.Users,{className:"h-4 w-4 text-purple-600"}),(0,b.jsx)("p",{className:"text-sm text-purple-600 font-medium",children:"Utilisateurs"})]}),(0,b.jsx)("p",{className:"text-2xl font-bold text-purple-900",children:z.users})]}),(0,b.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"p-4 rounded-lg bg-green-50 border border-green-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(n.Users,{className:"h-4 w-4 text-green-600"}),(0,b.jsx)("p",{className:"text-sm text-green-600 font-medium",children:"Étudiants"})]}),(0,b.jsx)("p",{className:"text-2xl font-bold text-green-900",children:z.students})]}),(0,b.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"p-4 rounded-lg bg-orange-50 border border-orange-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(o.FileText,{className:"h-4 w-4 text-orange-600"}),(0,b.jsx)("p",{className:"text-sm text-orange-600 font-medium",children:"Documents"})]}),(0,b.jsx)("p",{className:"text-2xl font-bold text-orange-900",children:z.documents})]}),(0,b.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"p-4 rounded-lg bg-emerald-50 border border-emerald-100",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)(p.DollarSign,{className:"h-4 w-4 text-emerald-600"}),(0,b.jsx)("p",{className:"text-sm text-emerald-600 font-medium",children:"Paiements"})]}),(0,b.jsx)("p",{className:"text-2xl font-bold text-emerald-900",children:z.completedPayments})]})]}):null})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(j.Clock,{className:"h-5 w-5"}),"Performances des Requêtes"]}),(0,b.jsx)(e.CardDescription,{children:"Temps de réponse par table"})]}),(0,b.jsx)(e.CardContent,{children:C?(0,b.jsx)(r.Skeleton,{className:"h-40 w-full"}):B?(0,b.jsx)("div",{className:"space-y-3",children:B.map((a,c)=>(0,b.jsxs)(s.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*c},className:"flex items-center justify-between p-4 rounded-lg border",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[D(a.status),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.name}),a.error&&(0,b.jsx)("p",{className:"text-sm text-red-600",children:a.error})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Temps de réponse"}),(0,b.jsxs)("p",{className:`font-bold ${a.responseTime>1e3?"text-red-600":a.responseTime>500?"text-yellow-600":"text-emerald-600"}`,children:[a.responseTime,"ms"]})]}),E(a.status)]})]},a.name))}):null})]}),Object.keys(v).length>0&&(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Activity,{className:"h-5 w-5"}),"Métriques de Performance"]}),(0,b.jsx)(e.CardDescription,{children:"Statistiques des temps d'exécution"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:Object.entries(v).map(([a,c])=>(0,b.jsxs)(s.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-4 rounded-lg border bg-gray-50",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)("p",{className:"font-medium",children:a}),(0,b.jsxs)(f.Badge,{className:"bg-blue-100 text-blue-700",children:[c.count," mesures"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Moyenne"}),(0,b.jsxs)("p",{className:"font-bold text-blue-600",children:[Math.round(c.avg),"ms"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Médiane"}),(0,b.jsxs)("p",{className:"font-bold",children:[Math.round(c.median),"ms"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"P95"}),(0,b.jsxs)("p",{className:"font-bold text-yellow-600",children:[Math.round(c.p95),"ms"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"P99"}),(0,b.jsxs)("p",{className:"font-bold text-red-600",children:[Math.round(c.p99),"ms"]})]})]})]},a))})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Informations Système"}),(0,b.jsx)(e.CardDescription,{children:"Détails de l'environnement et configuration"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Environnement"}),(0,b.jsx)("p",{className:"font-medium",children:(0,b.jsx)(f.Badge,{className:"bg-green-100 text-green-700",children:"production"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Dernière mise à jour"}),(0,b.jsx)("p",{className:"font-medium",children:z?.timestamp?(0,q.formatDate)(z.timestamp):"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Sentry"}),(0,b.jsx)("p",{className:"font-medium",children:(0,b.jsx)(f.Badge,{className:"bg-green-100 text-green-700",children:"Activé"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Analytics"}),(0,b.jsx)("p",{className:"font-medium",children:process.env.NEXT_PUBLIC_PLAUSIBLE_DOMAIN||process.env.NEXT_PUBLIC_GA_ID?(0,b.jsx)(f.Badge,{className:"bg-green-100 text-green-700",children:"Activé"}):(0,b.jsx)(f.Badge,{className:"bg-gray-100 text-gray-700",children:"Désactivé"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Version"}),(0,b.jsx)("p",{className:"font-medium",children:"1.0.0"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Base de données"}),(0,b.jsx)("p",{className:"font-medium",children:x?.status==="healthy"?(0,b.jsx)(f.Badge,{className:"bg-green-100 text-green-700",children:"Connectée"}):(0,b.jsx)(f.Badge,{className:"bg-red-100 text-red-700",children:"Erreur"})})]})]})})]})]})}a.s(["default",()=>v],21329)}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_admin_health_page_tsx_4e16353f._.js.map