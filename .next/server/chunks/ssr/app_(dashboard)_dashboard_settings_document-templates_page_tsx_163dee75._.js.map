{"version":3,"sources":["../../../../app/%28dashboard%29/dashboard/settings/document-templates/page.tsx","../../../../app/%28dashboard%29/dashboard/settings/document-templates/components/duplicate-dialog.tsx","../../../../app/%28dashboard%29/dashboard/settings/document-templates/components/rename-dialog.tsx","../../../../app/%28dashboard%29/dashboard/settings/document-templates/components/delete-dialog.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useMemo } from 'react'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { useAuth } from '@/lib/hooks/use-auth'\nimport { documentTemplateService } from '@/lib/services/document-template.service'\nimport type { DocumentType, DocumentTemplate } from '@/lib/types/document-templates'\nimport { DuplicateDialog } from './components/duplicate-dialog'\nimport { RenameDialog } from './components/rename-dialog'\nimport { DeleteDialog } from './components/delete-dialog'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport {\n  FileText,\n  Receipt,\n  FileCheck,\n  Calendar,\n  ClipboardList,\n  Award,\n  GraduationCap,\n  BookOpen,\n  UserCheck,\n  Shield,\n  Scale,\n  Book,\n  CheckCircle,\n  Search,\n  Filter,\n  MoreVertical,\n  Edit,\n  Copy,\n  Eye,\n  Settings,\n  CheckCircle2,\n  XCircle,\n  BarChart3,\n  Trash2,\n  Star,\n  Pencil,\n  Plus,\n} from 'lucide-react'\nimport Link from 'next/link'\nimport { formatDate } from '@/lib/utils'\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu'\nimport { Badge } from '@/components/ui/badge'\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from '@/components/ui/accordion'\n\n// Configuration des 13 types de documents\nconst DOCUMENT_TYPES: Array<{\n  type: DocumentType\n  name: string\n  description: string\n  icon: React.ElementType\n  color: string\n}> = [\n  {\n    type: 'convention',\n    name: 'Convention de formation',\n    description: 'Contrat entre l\\'établissement et l\\'apprenant',\n    icon: FileText,\n    color: '#335ACF',\n  },\n  {\n    type: 'facture',\n    name: 'Facture',\n    description: 'Document comptable de facturation',\n    icon: Receipt,\n    color: '#335ACF',\n  },\n  {\n    type: 'devis',\n    name: 'Devis',\n    description: 'Estimation de prix avant formation',\n    icon: FileCheck,\n    color: '#34B9EE',\n  },\n  {\n    type: 'convocation',\n    name: 'Convocation',\n    description: 'Invitation à une session ou examen',\n    icon: Calendar,\n    color: '#335ACF',\n  },\n  {\n    type: 'contrat',\n    name: 'Contrat de scolarité',\n    description: 'Accord de scolarisation officiel',\n    icon: ClipboardList,\n    color: '#335ACF',\n  },\n  {\n    type: 'attestation_reussite',\n    name: 'Attestation de réussite',\n    description: 'Certificat de réussite à une formation',\n    icon: Award,\n    color: '#335ACF',\n  },\n  {\n    type: 'certificat_scolarite',\n    name: 'Certificat de scolarité',\n    description: 'Justificatif d\\'inscription dans l\\'établissement',\n    icon: GraduationCap,\n    color: '#335ACF',\n  },\n  {\n    type: 'releve_notes',\n    name: 'Relevé de notes',\n    description: 'Bulletin de notes et appréciations',\n    icon: BookOpen,\n    color: '#34B9EE',\n  },\n  {\n    type: 'attestation_entree',\n    name: 'Attestation d\\'entrée en formation',\n    description: 'Certificat d\\'inscription à une formation',\n    icon: UserCheck,\n    color: '#335ACF',\n  },\n  {\n    type: 'reglement_interieur',\n    name: 'Règlement intérieur',\n    description: 'Règles et procédures de l\\'établissement',\n    icon: Shield,\n    color: '#335ACF',\n  },\n  {\n    type: 'cgv',\n    name: 'Conditions Générales de Vente',\n    description: 'CGV et conditions d\\'utilisation',\n    icon: Scale,\n    color: '#34B9EE',\n  },\n  {\n    type: 'programme',\n    name: 'Programme de formation',\n    description: 'Détails du contenu pédagogique',\n    icon: Book,\n    color: '#335ACF',\n  },\n  {\n    type: 'certificat_realisation',\n    name: 'Certificat de réalisation',\n    description: 'Certificat de réalisation de formation (OF obligatoire)',\n    icon: CheckCircle,\n    color: '#335ACF',\n  },\n  {\n    type: 'livret_accueil',\n    name: 'Livret d\\'accueil',\n    description: 'Livret d\\'accueil stagiaire (OF obligatoire)',\n    icon: BookOpen,\n    color: '#335ACF',\n  },\n  {\n    type: 'emargement',\n    name: 'Feuille d\\'émargement',\n    description: 'Feuille d\\'émargement formation (OF obligatoire)',\n    icon: CheckCircle2,\n    color: '#335ACF',\n  },\n  {\n    type: 'attestation_assiduite',\n    name: 'Attestation d\\'assiduité',\n    description: 'Justificatif de présence aux cours',\n    icon: CheckCircle,\n    color: '#335ACF',\n  },\n]\n\nexport default function DocumentTemplatesPage() {\n  const { user } = useAuth()\n  const queryClient = useQueryClient()\n  const [search, setSearch] = useState('')\n  const [statusFilter, setStatusFilter] = useState<'all' | 'configured' | 'not_configured'>('all')\n  const [duplicateDialogOpen, setDuplicateDialogOpen] = useState(false)\n  const [renameDialogOpen, setRenameDialogOpen] = useState(false)\n  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false)\n  const [selectedTemplate, setSelectedTemplate] = useState<DocumentTemplate | null>(null)\n\n  // Récupérer tous les templates\n  const { data: templates, isLoading } = useQuery({\n    queryKey: ['document-templates', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return []\n      return documentTemplateService.getAllTemplates(user.organization_id, { isActive: true })\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  // Grouper les templates par type (tous les templates, pas seulement un par type)\n  const templatesByType = useMemo(() => {\n    if (!templates) return {} as Record<DocumentType, DocumentTemplate[]>\n    \n    return templates.reduce((acc, template) => {\n      if (!acc[template.type]) {\n        acc[template.type] = []\n      }\n      acc[template.type].push(template)\n      return acc\n    }, {} as Record<DocumentType, DocumentTemplate[]>)\n  }, [templates])\n\n  // Trier les templates dans chaque type : défaut en premier, puis par date de création\n  const sortedTemplatesByType = useMemo(() => {\n    const sorted: Record<DocumentType, DocumentTemplate[]> = {} as Record<DocumentType, DocumentTemplate[]>\n    \n    Object.entries(templatesByType).forEach(([type, templatesList]) => {\n      sorted[type as DocumentType] = [...(templatesList as DocumentTemplate[])].sort((a, b) => {\n        // Modèle par défaut en premier\n        if (a.is_default && !b.is_default) return -1\n        if (!a.is_default && b.is_default) return 1\n        // Sinon par date de création (plus récent en premier)\n        return new Date(b.created_at).getTime() - new Date(a.created_at).getTime()\n      })\n    })\n    \n    return sorted\n  }, [templatesByType])\n\n  // Mutation pour définir comme défaut\n  const setAsDefaultMutation = useMutation({\n    mutationFn: async (template: DocumentTemplate) => {\n      if (!user?.organization_id) throw new Error('Organisation non trouvée')\n      return documentTemplateService.setAsDefault(template.id, user.organization_id)\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['document-templates', user?.organization_id] })\n      queryClient.invalidateQueries({ queryKey: ['document-templates-by-type', user?.organization_id] })\n    },\n    onError: (error) => {\n      console.error('Erreur lors de la définition du modèle par défaut:', error)\n      alert('Erreur lors de la définition du modèle par défaut')\n    },\n  })\n\n  // Filtrer les types selon la recherche et le statut\n  const filteredTypes = DOCUMENT_TYPES.filter((docType) => {\n    const matchesSearch =\n      docType.name.toLowerCase().includes(search.toLowerCase()) ||\n      docType.description.toLowerCase().includes(search.toLowerCase())\n\n    const typeTemplates = sortedTemplatesByType[docType.type] || []\n    const isConfigured = typeTemplates.length > 0\n\n    if (statusFilter === 'configured' && !isConfigured) return false\n    if (statusFilter === 'not_configured' && isConfigured) return false\n\n    return matchesSearch\n  })\n\n  const handleDuplicate = (template: DocumentTemplate) => {\n    setSelectedTemplate(template)\n    setDuplicateDialogOpen(true)\n  }\n\n  const handleRename = (template: DocumentTemplate) => {\n    setSelectedTemplate(template)\n    setRenameDialogOpen(true)\n  }\n\n  const handleDelete = (template: DocumentTemplate) => {\n    setSelectedTemplate(template)\n    setDeleteDialogOpen(true)\n  }\n\n  const handleSetAsDefault = (template: DocumentTemplate) => {\n    setAsDefaultMutation.mutate(template)\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-text-primary\">Modèles de Documents</h1>\n            <p className=\"text-text-tertiary mt-1\">Gérez vos modèles de documents administratifs</p>\n          </div>\n        </div>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n          {Array.from({ length: 6 }).map((_, i) => (\n            <Card key={i} className=\"animate-pulse\">\n              <CardContent className=\"p-6\">\n                <div className=\"h-4 bg-gray-200 rounded w-3/4 mb-4\" />\n                <div className=\"h-3 bg-gray-200 rounded w-full mb-2\" />\n                <div className=\"h-3 bg-gray-200 rounded w-2/3\" />\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold text-text-primary flex items-center gap-2\">\n            <Settings className=\"h-8 w-8 text-brand-blue\" />\n            Modèles de Documents\n          </h1>\n          <p className=\"text-text-tertiary mt-1\">Gérez vos modèles de documents avec header et footer personnalisables</p>\n        </div>\n      </div>\n\n      {/* Analytics Link */}\n      <Card>\n        <CardContent className=\"p-4\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h3 className=\"font-semibold\">Analytics & Reporting</h3>\n              <p className=\"text-sm text-gray-600\">Consultez les métriques d'utilisation de vos templates</p>\n            </div>\n            <Link href=\"/dashboard/settings/document-templates/analytics\">\n              <Button variant=\"outline\">\n                <BarChart3 className=\"h-4 w-4 mr-2\" />\n                Voir les analytics\n              </Button>\n            </Link>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Filters */}\n      <Card>\n        <CardContent className=\"p-4\">\n          <div className=\"flex flex-col md:flex-row gap-4\">\n            <div className=\"flex-1 relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary h-4 w-4\" />\n              <Input\n                placeholder=\"Rechercher un modèle...\"\n                value={search}\n                onChange={(e) => setSearch(e.target.value)}\n                className=\"pl-10\"\n              />\n            </div>\n            <div className=\"flex gap-2\">\n              <Button\n                variant={statusFilter === 'all' ? 'default' : 'outline'}\n                onClick={() => setStatusFilter('all')}\n              >\n                <Filter className=\"h-4 w-4 mr-2\" />\n                Tous\n              </Button>\n              <Button\n                variant={statusFilter === 'configured' ? 'default' : 'outline'}\n                onClick={() => setStatusFilter('configured')}\n              >\n                <CheckCircle2 className=\"h-4 w-4 mr-2\" />\n                Configurés\n              </Button>\n              <Button\n                variant={statusFilter === 'not_configured' ? 'default' : 'outline'}\n                onClick={() => setStatusFilter('not_configured')}\n              >\n                <XCircle className=\"h-4 w-4 mr-2\" />\n                Non configurés\n              </Button>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Templates avec Accordéons */}\n      <Card>\n        <CardContent className=\"p-0\">\n          <Accordion type=\"multiple\" defaultValue={[]}>\n            {filteredTypes.map((docType) => {\n              const typeTemplates = sortedTemplatesByType[docType.type] || []\n              const Icon = docType.icon\n              const isConfigured = typeTemplates.length > 0\n              const defaultTemplate = typeTemplates.find(t => t.is_default)\n\n              return (\n                <AccordionItem key={docType.type} value={docType.type}>\n                  <AccordionTrigger className=\"px-6 hover:no-underline\">\n                    <div className=\"flex items-center justify-between w-full pr-4\">\n                      <div className=\"flex items-center gap-4\">\n                        <div\n                          className=\"p-2 rounded-lg\"\n                          style={{ backgroundColor: `${docType.color}15` }}\n                        >\n                          <Icon className=\"h-5 w-5\" style={{ color: docType.color }} />\n                        </div>\n                        <div className=\"text-left\">\n                          <div className=\"font-semibold text-lg\">{docType.name}</div>\n                          <div className=\"text-sm text-text-tertiary\">{docType.description}</div>\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-3\">\n                        <Badge\n                          variant={isConfigured ? 'success' : 'secondary'}\n                        >\n                          {isConfigured ? (\n                            <>\n                              <CheckCircle2 className=\"h-3 w-3 mr-1\" />\n                              {typeTemplates.length} modèle{typeTemplates.length > 1 ? 's' : ''}\n                            </>\n                          ) : (\n                            <>\n                              <XCircle className=\"h-3 w-3 mr-1\" />\n                              Aucun modèle\n                            </>\n                          )}\n                        </Badge>\n                      </div>\n                    </div>\n                  </AccordionTrigger>\n                  <AccordionContent>\n                    <div className=\"px-6 pb-4 space-y-3\">\n                      {typeTemplates.length === 0 ? (\n                        <div className=\"py-8 text-center\">\n                          <p className=\"text-text-tertiary mb-4\">Aucun modèle configuré pour ce type de document</p>\n                          <Link href={`/dashboard/settings/document-templates/${docType.type}/edit`}>\n                            <Button>\n                              <Plus className=\"h-4 w-4 mr-2\" />\n                              Créer un modèle\n                            </Button>\n                          </Link>\n                        </div>\n                      ) : (\n                        <>\n                          {typeTemplates.map((template) => (\n                            <Card key={template.id} className=\"border-l-4\" style={{ borderLeftColor: docType.color }}>\n                              <CardContent className=\"p-4\">\n                                <div className=\"flex items-start justify-between\">\n                                  <div className=\"flex-1\">\n                                    <div className=\"flex items-center gap-2 mb-2\">\n                                      <h4 className=\"font-semibold\">{template.name}</h4>\n                                      {template.is_default && (\n                                        <Badge variant=\"default\" className=\"text-xs\">\n                                          <Star className=\"h-3 w-3 mr-1 fill-current\" />\n                                          Par défaut\n                                        </Badge>\n                                      )}\n                                    </div>\n                                    <div className=\"text-sm text-text-tertiary space-y-1\">\n                                      <div>\n                                        <span className=\"font-medium\">Modifié:</span>{' '}\n                                        {formatDate(template.updated_at)}\n                                      </div>\n                                      <div>\n                                        <span className=\"font-medium\">Créé:</span>{' '}\n                                        {formatDate(template.created_at)}\n                                      </div>\n                                    </div>\n                                  </div>\n                                  <div className=\"flex items-center gap-2\">\n                                    <Link href={`/dashboard/settings/document-templates/${docType.type}/edit?template_id=${template.id}`} className=\"no-underline\">\n                                      <Button variant=\"default\" size=\"sm\">\n                                        <Edit className=\"h-4 w-4 mr-2\" />\n                                        Modifier\n                                      </Button>\n                                    </Link>\n                                    <Link href={`/dashboard/settings/document-templates/${docType.type}/preview?template_id=${template.id}`} className=\"no-underline\">\n                                      <Button variant=\"outline\" size=\"sm\">\n                                        <Eye className=\"h-4 w-4 mr-2\" />\n                                        Aperçu\n                                      </Button>\n                                    </Link>\n                                    <DropdownMenu>\n                                      <DropdownMenuTrigger asChild>\n                                        <Button variant=\"outline\" size=\"sm\">\n                                          <MoreVertical className=\"h-4 w-4\" />\n                                        </Button>\n                                      </DropdownMenuTrigger>\n                                      <DropdownMenuContent align=\"end\">\n                                        <DropdownMenuLabel>Actions</DropdownMenuLabel>\n                                        <DropdownMenuSeparator />\n                                        <DropdownMenuItem onClick={() => handleRename(template)}>\n                                          <Pencil className=\"h-4 w-4 mr-2\" />\n                                          Renommer\n                                        </DropdownMenuItem>\n                                        <DropdownMenuItem onClick={() => handleDuplicate(template)}>\n                                          <Copy className=\"h-4 w-4 mr-2\" />\n                                          Dupliquer\n                                        </DropdownMenuItem>\n                                        {!template.is_default && (\n                                          <DropdownMenuItem \n                                            onClick={() => handleSetAsDefault(template)}\n                                            disabled={setAsDefaultMutation.isPending}\n                                          >\n                                            <Star className=\"h-4 w-4 mr-2\" />\n                                            Définir par défaut\n                                          </DropdownMenuItem>\n                                        )}\n                                        <DropdownMenuItem>\n                                          <Link \n                                            href={`/dashboard/settings/document-templates/${docType.type}/analytics?template_id=${template.id}`}\n                                            className=\"flex items-center\"\n                                          >\n                                            <BarChart3 className=\"h-4 w-4 mr-2\" />\n                                            Analytics\n                                          </Link>\n                                        </DropdownMenuItem>\n                                        <DropdownMenuSeparator />\n                                        <DropdownMenuItem \n                                          onClick={() => handleDelete(template)}\n                                          className=\"text-red-600\"\n                                        >\n                                          <Trash2 className=\"h-4 w-4 mr-2\" />\n                                          Supprimer\n                                        </DropdownMenuItem>\n                                      </DropdownMenuContent>\n                                    </DropdownMenu>\n                                  </div>\n                                </div>\n                              </CardContent>\n                            </Card>\n                          ))}\n                          <div className=\"pt-2\">\n                            <Link href={`/dashboard/settings/document-templates/${docType.type}/edit`}>\n                              <Button variant=\"outline\" className=\"w-full\">\n                                <Plus className=\"h-4 w-4 mr-2\" />\n                                Créer un nouveau modèle\n                              </Button>\n                            </Link>\n                          </div>\n                        </>\n                      )}\n                    </div>\n                  </AccordionContent>\n                </AccordionItem>\n              )\n            })}\n          </Accordion>\n        </CardContent>\n      </Card>\n\n      {filteredTypes.length === 0 && (\n        <Card>\n          <CardContent className=\"p-12 text-center\">\n            <FileText className=\"h-12 w-12 text-text-tertiary mx-auto mb-4\" />\n            <h3 className=\"text-lg font-semibold text-text-primary mb-2\">\n              Aucun modèle trouvé\n            </h3>\n            <p className=\"text-text-tertiary\">\n              Essayez de modifier vos critères de recherche ou de filtre\n            </p>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Dialogs */}\n      {selectedTemplate && (\n        <>\n          <DuplicateDialog\n            template={selectedTemplate}\n            open={duplicateDialogOpen}\n            onOpenChange={setDuplicateDialogOpen}\n          />\n          <RenameDialog\n            template={selectedTemplate}\n            open={renameDialogOpen}\n            onOpenChange={setRenameDialogOpen}\n          />\n          <DeleteDialog\n            template={selectedTemplate}\n            open={deleteDialogOpen}\n            onOpenChange={setDeleteDialogOpen}\n          />\n        </>\n      )}\n    </div>\n  )\n}\n\n","'use client'\n\nimport { useState } from 'react'\nimport { useMutation, useQueryClient } from '@tanstack/react-query'\nimport { documentTemplateService } from '@/lib/services/document-template.service'\nimport { useAuth } from '@/lib/hooks/use-auth'\nimport type { DocumentTemplate } from '@/lib/types/document-templates'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Copy } from 'lucide-react'\n\ninterface DuplicateDialogProps {\n  template: DocumentTemplate\n  open: boolean\n  onOpenChange: (open: boolean) => void\n}\n\nexport function DuplicateDialog({ template, open, onOpenChange }: DuplicateDialogProps) {\n  const { user } = useAuth()\n  const queryClient = useQueryClient()\n  const [newName, setNewName] = useState(`${template.name} (copie)`)\n  const [isDuplicating, setIsDuplicating] = useState(false)\n\n  const duplicateMutation = useMutation({\n    mutationFn: async (name: string) => {\n      if (!user?.organization_id) throw new Error('Organisation non trouvée')\n      return documentTemplateService.duplicateTemplate(template.id, name)\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['document-templates', user?.organization_id] })\n      queryClient.invalidateQueries({ queryKey: ['document-templates-by-type', user?.organization_id] })\n      onOpenChange(false)\n      setNewName(`${template.name} (copie)`)\n    },\n    onError: (error) => {\n      console.error('Erreur lors de la duplication:', error)\n      alert('Erreur lors de la duplication du modèle')\n    },\n  })\n\n  const handleDuplicate = async () => {\n    if (!newName.trim()) {\n      alert('Veuillez entrer un nom pour le modèle dupliqué')\n      return\n    }\n\n    setIsDuplicating(true)\n    try {\n      await duplicateMutation.mutateAsync(newName.trim())\n    } finally {\n      setIsDuplicating(false)\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Copy className=\"h-5 w-5\" />\n            Dupliquer le modèle\n          </DialogTitle>\n          <DialogDescription>\n            Créez une copie du modèle \"{template.name}\" que vous pourrez modifier indépendamment.\n          </DialogDescription>\n        </DialogHeader>\n        <div className=\"space-y-4 py-4\">\n          <div>\n            <Label htmlFor=\"template-name\">Nom du nouveau modèle</Label>\n            <Input\n              id=\"template-name\"\n              value={newName}\n              onChange={(e) => setNewName(e.target.value)}\n              placeholder=\"Nom du modèle\"\n              className=\"mt-2\"\n              onKeyDown={(e) => {\n                if (e.key === 'Enter') {\n                  handleDuplicate()\n                }\n              }}\n            />\n          </div>\n          <div className=\"text-sm text-gray-500\">\n            <p className=\"font-medium mb-1\">Informations du modèle original :</p>\n            <ul className=\"list-disc list-inside space-y-1\">\n              <li>Type : {template.type}</li>\n              <li>Modifié le : {new Date(template.updated_at).toLocaleDateString('fr-FR')}</li>\n              {template.is_default && <li className=\"text-primary font-medium\">Modèle par défaut</li>}\n            </ul>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)} disabled={isDuplicating}>\n            Annuler\n          </Button>\n          <Button onClick={handleDuplicate} disabled={isDuplicating || !newName.trim()}>\n            {isDuplicating ? 'Duplication...' : 'Dupliquer'}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n","'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useMutation, useQueryClient } from '@tanstack/react-query'\nimport { documentTemplateService } from '@/lib/services/document-template.service'\nimport { useAuth } from '@/lib/hooks/use-auth'\nimport type { DocumentTemplate } from '@/lib/types/document-templates'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Edit } from 'lucide-react'\n\ninterface RenameDialogProps {\n  template: DocumentTemplate\n  open: boolean\n  onOpenChange: (open: boolean) => void\n}\n\nexport function RenameDialog({ template, open, onOpenChange }: RenameDialogProps) {\n  const { user } = useAuth()\n  const queryClient = useQueryClient()\n  const [newName, setNewName] = useState(template.name)\n\n  // Réinitialiser le nom quand le dialog s'ouvre ou que le template change\n  useEffect(() => {\n    if (open) {\n      setNewName(template.name)\n    }\n  }, [open, template.name])\n\n  const renameMutation = useMutation({\n    mutationFn: async (name: string) => {\n      if (!user?.organization_id) throw new Error('Organisation non trouvée')\n      return documentTemplateService.updateTemplate({\n        id: template.id,\n        name: name,\n      })\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['document-templates', user?.organization_id] })\n      queryClient.invalidateQueries({ queryKey: ['document-templates-by-type', user?.organization_id] })\n      onOpenChange(false)\n    },\n    onError: (error) => {\n      console.error('Erreur lors du renommage:', error)\n      alert('Erreur lors du renommage du modèle')\n    },\n  })\n\n  const handleRename = async () => {\n    if (!newName.trim()) {\n      alert('Veuillez entrer un nom pour le modèle')\n      return\n    }\n\n    if (newName.trim() === template.name) {\n      onOpenChange(false)\n      return\n    }\n\n    try {\n      await renameMutation.mutateAsync(newName.trim())\n    } catch (error) {\n      // L'erreur est déjà gérée dans onError\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Edit className=\"h-5 w-5\" />\n            Renommer le modèle\n          </DialogTitle>\n          <DialogDescription>\n            Modifiez le nom du modèle \"{template.name}\".\n          </DialogDescription>\n        </DialogHeader>\n        <div className=\"space-y-4 py-4\">\n          <div>\n            <Label htmlFor=\"template-name\">Nouveau nom du modèle</Label>\n            <Input\n              id=\"template-name\"\n              value={newName}\n              onChange={(e) => setNewName(e.target.value)}\n              placeholder=\"Nom du modèle\"\n              className=\"mt-2\"\n              onKeyDown={(e) => {\n                if (e.key === 'Enter') {\n                  handleRename()\n                }\n              }}\n              autoFocus\n            />\n          </div>\n        </div>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)} disabled={renameMutation.isPending}>\n            Annuler\n          </Button>\n          <Button onClick={handleRename} disabled={renameMutation.isPending || !newName.trim()}>\n            {renameMutation.isPending ? 'Renommage...' : 'Renommer'}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n\n\n","'use client'\n\nimport { useMutation, useQueryClient } from '@tanstack/react-query'\nimport { documentTemplateService } from '@/lib/services/document-template.service'\nimport { useAuth } from '@/lib/hooks/use-auth'\nimport type { DocumentTemplate } from '@/lib/types/document-templates'\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport { Trash2 } from 'lucide-react'\n\ninterface DeleteDialogProps {\n  template: DocumentTemplate\n  open: boolean\n  onOpenChange: (open: boolean) => void\n}\n\nexport function DeleteDialog({ template, open, onOpenChange }: DeleteDialogProps) {\n  const { user } = useAuth()\n  const queryClient = useQueryClient()\n\n  const deleteMutation = useMutation({\n    mutationFn: async () => {\n      return documentTemplateService.deleteTemplate(template.id)\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['document-templates', user?.organization_id] })\n      queryClient.invalidateQueries({ queryKey: ['document-templates-by-type', user?.organization_id] })\n      onOpenChange(false)\n    },\n    onError: (error) => {\n      console.error('Erreur lors de la suppression:', error)\n      alert('Erreur lors de la suppression du modèle')\n    },\n  })\n\n  const handleDelete = async () => {\n    try {\n      await deleteMutation.mutateAsync()\n    } catch (error) {\n      // L'erreur est déjà gérée dans onError\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2 text-red-600\">\n            <Trash2 className=\"h-5 w-5\" />\n            Supprimer le modèle\n          </DialogTitle>\n          <DialogDescription>\n            Êtes-vous sûr de vouloir supprimer le modèle \"{template.name}\" ?\n            Cette action est irréversible.\n            {template.is_default && (\n              <span className=\"block mt-2 text-amber-600 font-medium\">\n                ⚠️ Ce modèle est actuellement défini comme modèle par défaut. \n                La suppression supprimera cette configuration.\n              </span>\n            )}\n          </DialogDescription>\n        </DialogHeader>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)} disabled={deleteMutation.isPending}>\n            Annuler\n          </Button>\n          <Button \n            variant=\"destructive\" \n            onClick={handleDelete} \n            disabled={deleteMutation.isPending}\n          >\n            {deleteMutation.isPending ? 'Suppression...' : 'Supprimer'}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n\n\n"],"names":[],"mappings":"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"}