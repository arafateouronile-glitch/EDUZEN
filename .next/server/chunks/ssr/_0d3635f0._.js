module.exports=[915618,a=>{"use strict";let b=(0,a.i(170106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],915618)},641710,a=>{"use strict";let b=(0,a.i(170106).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],641710)},177156,a=>{"use strict";let b=(0,a.i(170106).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>b],177156)},54018,a=>{"use strict";let b=(0,a.i(170106).default)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],54018)},724669,a=>{"use strict";let b=(0,a.i(170106).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);a.s(["TrendingUp",()=>b],724669)},887682,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);a.i(460355);var e=a.i(346271),f=a.i(262036),g=a.i(405784),h=a.i(290821);c.forwardRef(({className:a,label:i,error:j,helperText:k,variant:l="default",leftIcon:m,id:n,options:o,placeholder:p,value:q,...r},s)=>{let[t,u]=c.useState(!1),[v,w]=c.useState(!1),x=n||`select-${Math.random().toString(36).substr(2,9)}`,y=(0,d.cn)("flex w-full rounded-lg font-medium transition-all duration-300","appearance-none cursor-pointer","focus:outline-none focus:ring-2 focus:ring-primary/20","disabled:cursor-not-allowed disabled:opacity-50",{"border-2 border-input bg-background px-4 py-3 pr-11":"default"===l,"focus:border-primary focus:bg-white":"default"===l&&!j,"border-destructive focus:border-destructive focus:ring-destructive/20":j,"border-2 border-input bg-transparent px-4 py-3 pr-11":"outlined"===l,"focus:border-primary focus:shadow-md focus:shadow-primary/10":"outlined"===l&&!j,"border-0 border-b-2 border-input bg-muted/50 px-4 py-3 pr-11 rounded-b-none":"filled"===l,"focus:bg-muted focus:border-primary":"filled"===l&&!j,"focus:border-destructive bg-destructive/5":"filled"===l&&j},m&&"pl-11",a);return(0,b.jsxs)("div",{className:"w-full space-y-1.5",children:[i&&(0,b.jsxs)(e.motion.label,{htmlFor:x,initial:!1,animate:{color:j?"#EF4444":t?"rgb(37, 99, 235)":"rgb(107, 114, 128)"},className:(0,d.cn)("block text-sm font-medium transition-colors duration-200",j&&"text-destructive"),children:[i,r.required&&(0,b.jsx)("span",{className:"text-destructive ml-1",children:"*"})]}),(0,b.jsxs)("div",{className:"relative",children:[m&&(0,b.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground pointer-events-none z-10",children:m}),(0,b.jsxs)(e.motion.select,{ref:s,id:x,value:q,...r,onFocus:a=>{u(!0),r.onFocus?.(a)},onBlur:a=>{u(!1),w(!1),r.onBlur?.(a)},onMouseDown:()=>w(!v),className:y,animate:{scale:t?1.01:1,borderColor:j?"#EF4444":t?"rgb(37, 99, 235)":"rgb(226, 232, 240)"},transition:{duration:.2},children:[p&&(0,b.jsx)("option",{value:"",disabled:!0,children:p}),(o||[]).map(a=>(0,b.jsx)("option",{value:a.value,disabled:a.disabled,children:a.label},a.value))]}),(0,b.jsx)(e.motion.div,{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",animate:{rotate:180*!!v},transition:{duration:.2},children:(0,b.jsx)(g.ChevronDown,{className:"h-5 w-5"})}),j&&(0,b.jsx)(e.motion.div,{className:"absolute right-11 top-1/2 -translate-y-1/2 pointer-events-none",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:(0,b.jsx)(h.AlertCircle,{className:"h-5 w-5 text-destructive"})})]}),(0,b.jsx)(f.AnimatePresence,{mode:"wait",children:(j||k)&&(0,b.jsx)(e.motion.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},transition:{duration:.2},className:(0,d.cn)("text-xs transition-colors duration-200",j?"text-destructive":"text-muted-foreground"),children:j||k})})]})}).displayName="SelectNative";let i=c.createContext({}),j=c.forwardRef(({value:a,onValueChange:d,children:e},f)=>{let[g,h]=c.useState(!1);return(0,b.jsx)(i.Provider,{value:{value:a,onValueChange:d,open:g,setOpen:h},children:(0,b.jsx)("div",{className:"relative",ref:f,children:e})})});j.displayName="SelectRoot";let k=c.forwardRef(({children:a,className:e,...f},h)=>{let{open:j,setOpen:k}=c.useContext(i);return(0,b.jsxs)("button",{ref:h,type:"button",className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),onClick:()=>k?.(!j),...f,children:[a,(0,b.jsx)(g.ChevronDown,{className:(0,d.cn)("h-4 w-4 opacity-50 transition-transform",j&&"rotate-180")})]})});k.displayName="SelectTrigger";let l=c.forwardRef(({placeholder:a},d)=>{let{value:e}=c.useContext(i);return(0,b.jsx)("span",{ref:d,children:e||a})});l.displayName="SelectValue";let m=c.forwardRef(({children:a},d)=>{let e=c.useContext(i);return e?.open&&a?(0,b.jsx)("div",{ref:d,className:"absolute top-full left-0 z-50 mt-1 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md",children:(0,b.jsx)("div",{className:"p-1",children:a})}):null});m.displayName="SelectContent";let n=c.forwardRef(({value:a,children:e,className:f,...g},h)=>{let{value:j,onValueChange:k,setOpen:l}=c.useContext(i),m=j===a;return(0,b.jsx)("div",{ref:h,role:"option","aria-selected":m,className:(0,d.cn)("relative flex w-full cursor-pointer select-none items-center rounded-sm py-1.5 px-2 text-sm outline-none hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground",m&&"bg-accent text-accent-foreground",f),onClick:()=>{k?.(a),l?.(!1)},...g,children:e})});n.displayName="SelectItem",a.s(["Select",0,j,"SelectContent",0,m,"SelectItem",0,n,"SelectRoot",0,j,"SelectTrigger",0,k,"SelectValue",0,l])},824115,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getPolicies(a,b){let c=this.supabase.from("security_policies").select("*, approved_by_user:users!security_policies_approved_by_fkey(id, full_name, email)").or(`organization_id.eq.${a},organization_id.is.null`);b?.status&&(c=c.eq("status",b.status)),b?.category&&(c=c.eq("category",b.category));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e)throw e;return d}async createPolicy(a){let{data:b,error:c}=await this.supabase.from("security_policies").insert(a).select().single();if(c)throw c;return b}async updatePolicy(a,b){let{data:c,error:d}=await this.supabase.from("security_policies").update(b).eq("id",a).select().single();if(d)throw d;return c}async approvePolicy(a,b){return this.updatePolicy(a,{approval_status:"approved",approved_by:b,approved_at:new Date().toISOString(),status:"active"})}async getControls(a,b){let c=this.supabase.from("security_controls").select("*").eq("organization_id",a);b?.framework&&(c=c.eq("framework",b.framework)),b?.status&&(c=c.eq("implementation_status",b.status));let{data:d,error:e}=await c.order("control_id",{ascending:!0});if(e)throw e;return d}async createControl(a){let{data:b,error:c}=await this.supabase.from("security_controls").insert(a).select().single();if(c)throw c;return b}async updateControl(a,b){let{data:c,error:d}=await this.supabase.from("security_controls").update(b).eq("id",a).select().single();if(d)throw d;return c}async getControlComplianceStats(a,b){let c=await this.getControls(a,{framework:b}),d={total:c.length,implemented:c.filter(a=>"implemented"===a.implementation_status).length,partial:c.filter(a=>"partial"===a.implementation_status).length,not_implemented:c.filter(a=>"not_implemented"===a.implementation_status).length,compliant:c.filter(a=>"compliant"===a.compliance_status).length,partially_compliant:c.filter(a=>"partially_compliant"===a.compliance_status).length,non_compliant:c.filter(a=>"non_compliant"===a.compliance_status).length,compliance_percentage:0};return d.total>0&&(d.compliance_percentage=d.compliant/d.total*100),d}async getEvidence(a){let{data:b,error:c}=await this.supabase.from("compliance_evidence").select("*, collected_by_user:users!compliance_evidence_collected_by_fkey(id, full_name, email), verified_by_user:users!compliance_evidence_verified_by_fkey(id, full_name, email)").eq("control_id",a).order("collected_at",{ascending:!1});if(c)throw c;return b}async createEvidence(a){let{data:b,error:c}=await this.supabase.from("compliance_evidence").insert(a).select().single();if(c)throw c;return b}async verifyEvidence(a,b){let{data:c,error:d}=await this.supabase.from("compliance_evidence").update({verified_by:b,verified_at:new Date().toISOString()}).eq("id",a).select().single();if(d)throw d;return c}async getRisks(a,b){let c=this.supabase.from("risk_assessments").select("*, owner:users(id, full_name, email)").eq("organization_id",a);b?.treatmentStatus&&(c=c.eq("treatment_status",b.treatmentStatus)),b?.riskLevel&&(c=c.eq("risk_level",b.riskLevel));let{data:d,error:e}=await c.order("risk_level",{ascending:!1});if(e){if("PGRST200"===e.code||404===e.status||400===e.status||e.message?.includes("does not exist"))return[];throw e}return d||[]}async createRisk(a){let{data:b,error:c}=await this.supabase.from("risk_assessments").insert(a).select().single();if(c)throw c;return b}async updateRisk(a,b){let{data:c,error:d}=await this.supabase.from("risk_assessments").update(b).eq("id",a).select().single();if(d)throw d;return c}async getCriticalRisks(a){return this.getRisks(a,{riskLevel:"critical",treatmentStatus:"open"})}async getIncidents(a,b){let c=this.supabase.from("security_incidents").select("*, reported_by_user:users(id, full_name, email), assigned_to_user:users(id, full_name, email)").eq("organization_id",a);b?.status&&(c=c.eq("status",b.status)),b?.severity&&(c=c.eq("severity",b.severity));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e){if("PGRST200"===e.code||404===e.status||400===e.status||e.message?.includes("does not exist"))return[];throw e}return d||[]}async createIncident(a){let b=`INC-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,{data:c,error:d}=await this.supabase.from("security_incidents").insert({...a,incident_id:b}).select().single();if(d)throw d;return c}async updateIncident(a,b){let{data:c,error:d}=await this.supabase.from("security_incidents").update(b).eq("id",a).select().single();if(d)throw d;return c}async resolveIncident(a,b,c){return this.updateIncident(a,{status:"resolved",resolution:b,root_cause:c,resolved_at:new Date().toISOString()})}async getAudits(a,b){let c=this.supabase.from("security_audits").select("*").eq("organization_id",a);b?.status&&(c=c.eq("status",b.status)),b?.framework&&(c=c.eq("framework",b.framework));let{data:d,error:e}=await c.order("start_date",{ascending:!1});if(e)throw e;return d}async createAudit(a){let b=`AUDIT-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,{data:c,error:d}=await this.supabase.from("security_audits").insert({...a,audit_id:b}).select().single();if(d)throw d;return c}async getAuditFindings(a){let{data:b,error:c}=await this.supabase.from("audit_findings").select("*, assigned_to_user:users!audit_findings_assigned_to_fkey(id, full_name, email), control:security_controls(*)").eq("audit_id",a).order("severity",{ascending:!1});if(c)throw c;return b}async createAuditFinding(a){let{data:b,error:c}=await this.supabase.from("audit_findings").insert(a).select().single();if(c)throw c;return b}async getTrainings(a){let{data:b,error:c}=await this.supabase.from("security_training").select("*").eq("organization_id",a).eq("is_active",!0).order("created_at",{ascending:!1});if(c)throw c;return b}async getTrainingRecords(a){let{data:b,error:c}=await this.supabase.from("security_training_records").select("*, training:security_training(*)").eq("user_id",a).order("created_at",{ascending:!1});if(c)throw c;return b}async createTrainingRecord(a){let{data:b,error:c}=await this.supabase.from("security_training_records").insert(a).select().single();if(c)throw c;return b}async completeTraining(a,b){let{data:c,error:d}=await this.supabase.from("security_training_records").update({status:"completed",completion_percentage:100,score:b,completed_at:new Date().toISOString()}).eq("id",a).select().single();if(d)throw d;return c}async logAccess(a){let{data:b,error:c}=await this.supabase.from("access_logs").insert(a).select().single();if(c)throw c;return b}async getAccessLogs(a,b){let c=this.supabase.from("access_logs").select("*, user:users(id, full_name, email)").eq("organization_id",a);b?.userId&&(c=c.eq("user_id",b.userId)),b?.action&&(c=c.eq("action",b.action)),b?.startDate&&(c=c.gte("created_at",b.startDate.toISOString())),b?.endDate&&(c=c.lte("created_at",b.endDate.toISOString()));let{data:d,error:e}=await c.order("created_at",{ascending:!1}).limit(1e3);if(e)throw e;return d}async generateComplianceReport(a,b){await this.getControls(a,{framework:b});let c=await this.getRisks(a),d=await this.getIncidents(a),e=await this.getAudits(a,{framework:b}),f=await this.getControlComplianceStats(a,b),g=c.filter(a=>"critical"===a.risk_level&&"open"===a.treatment_status),h=d.filter(a=>"resolved"!==a.status&&"closed"!==a.status),i=e.filter(a=>{let b=new Date(a.start_date),c=new Date;return c.setMonth(c.getMonth()-6),b>=c});return{framework:b||"all",generated_at:new Date().toISOString(),controls:{total:f.total,compliance_percentage:f.compliance_percentage,implemented:f.implemented,partial:f.partial,not_implemented:f.not_implemented,compliant:f.compliant,partially_compliant:f.partially_compliant,non_compliant:f.non_compliant},risks:{total:c.length,critical:g.length,high:c.filter(a=>"high"===a.risk_level&&"open"===a.treatment_status).length,medium:c.filter(a=>"medium"===a.risk_level&&"open"===a.treatment_status).length,low:c.filter(a=>"low"===a.risk_level&&"open"===a.treatment_status).length,mitigated:c.filter(a=>"mitigated"===a.treatment_status).length},incidents:{total:d.length,open:h.length,critical:d.filter(a=>"critical"===a.severity&&"resolved"!==a.status).length,data_breaches:d.filter(a=>a.data_breach).length},audits:{total:e.length,recent:i.length,average_score:e.length>0?e.reduce((a,b)=>a+(b.overall_score||0),0)/e.length:0,average_compliance:e.length>0?e.reduce((a,b)=>a+(b.compliance_percentage||0),0)/e.length:0},recommendations:this.generateRecommendations(f,g,h)}}generateRecommendations(a,b,c){let d=[];return a.compliance_percentage<80&&d.push(`Le pourcentage de conformit\xe9 est de ${a.compliance_percentage.toFixed(1)}%. Il est recommand\xe9 d'am\xe9liorer l'impl\xe9mentation des contr\xf4les.`),b.length>0&&d.push(`${b.length} risque(s) critique(s) ouvert(s) n\xe9cessitent une attention imm\xe9diate.`),c.filter(a=>"critical"===a.severity).length>0&&d.push("Des incidents critiques sont en cours. Une intervention immédiate est requise."),a.not_implemented>0&&d.push(`${a.not_implemented} contr\xf4le(s) ne sont pas encore impl\xe9ment\xe9s.`),0===d.length&&d.push("Aucune recommandation urgente. La conformité est bonne."),d}};a.s(["complianceService",0,c])}];

//# sourceMappingURL=_0d3635f0._.js.map