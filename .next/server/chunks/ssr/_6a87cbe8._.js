module.exports=[915618,a=>{"use strict";let b=(0,a.i(170106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],915618)},641710,a=>{"use strict";let b=(0,a.i(170106).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],641710)},724669,a=>{"use strict";let b=(0,a.i(170106).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);a.s(["TrendingUp",()=>b],724669)},621958,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);let e=c.createContext(void 0);function f({value:a,defaultValue:f,onValueChange:g,children:h,className:i}){let j=void 0!==a,[k,l]=c.useState(f??"");c.useEffect(()=>{j||void 0===f||l(f)},[f]);let m=j?a:k,n=c.useCallback(a=>{j||l(a),g?.(a)},[j,g]);return(0,b.jsx)(e.Provider,{value:{value:m,onValueChange:n},children:(0,b.jsx)("div",{className:(0,d.cn)("w-full",i),children:h})})}function g(){let a=c.useContext(e);if(!a)throw Error("Tabs components must be used within a Tabs component");return a}function h({children:a,className:c}){return(0,b.jsx)("div",{className:(0,d.cn)("inline-flex h-10 items-center justify-center rounded-lg bg-bg-gray-100 p-1 text-text-tertiary",c),children:a})}function i({value:a,children:c,className:e}){let{value:f,onValueChange:h}=g(),i=f===a;return(0,b.jsx)("button",{type:"button",onClick:()=>h(a),className:(0,d.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-outline-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",i?"bg-white text-text-primary shadow-sm":"text-text-tertiary hover:text-text-primary",e),children:c})}function j({value:a,children:c,className:e}){let{value:f}=g();return f!==a?null:(0,b.jsx)("div",{className:(0,d.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),children:c})}a.s(["Tabs",()=>f,"TabsContent",()=>j,"TabsList",()=>h,"TabsTrigger",()=>i])},100336,a=>{"use strict";let b=(0,a.i(170106).default)("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);a.s(["Euro",()=>b],100336)},112882,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getConfiguration(a){let{data:b,error:c}=await this.supabase.from("cpf_configurations").select("*").eq("organization_id",a).single();if(c){if("PGRST116"===c.code)return null;throw c}return b}async upsertConfiguration(a){let{data:b,error:c}=await this.supabase.from("cpf_configurations").upsert(a,{onConflict:"organization_id"}).select().single();if(c)throw c;return b}async getLearnerRights(a,b){let{data:c,error:d}=await this.supabase.from("cpf_learner_rights").select("*").eq("organization_id",a).eq("learner_id",b).single();if(d){if("PGRST116"===d.code)return null;throw d}return c}async syncLearnerRights(a,b){let c=await this.getConfiguration(a);if(!c||!c.is_active)throw Error("Configuration CPF non active");let d={organization_id:a,learner_id:b,total_credits:500,available_credits:450,used_credits:50,last_sync_date:new Date().toISOString(),sync_status:"synced"},{data:e,error:f}=await this.supabase.from("cpf_learner_rights").upsert(d,{onConflict:"organization_id,learner_id"}).select().single();if(f)throw f;return e}async getEligibleTrainings(a){let{data:b,error:c}=await this.supabase.from("cpf_eligible_trainings").select("*").eq("organization_id",a).eq("eligibility_status","eligible").order("cpf_training_title",{ascending:!0});if(c){if("PGRST116"===c.code||"42P01"===c.code||"PGRST301"===c.code||404===c.status||"404"===c.code||c.message?.includes("relation")||c.message?.includes("relationship")||c.message?.includes("does not exist")||c.message?.includes("schema cache"))return console.warn("Table cpf_eligible_trainings does not exist yet or invalid query:",c?.message),[];throw c}return b||[]}async createEligibleTraining(a){let{data:b,error:c}=await this.supabase.from("cpf_eligible_trainings").insert(a).select().single();if(c)throw c;return b}async getEnrollments(a,b){let c=this.supabase.from("cpf_enrollments").select("*").eq("organization_id",a);b?.learnerId&&(c=c.eq("learner_id",b.learnerId)),b?.trainingId&&(c=c.eq("training_id",b.trainingId)),b?.status&&(c=c.eq("status",b.status));let{data:d,error:e}=await c.order("enrollment_date",{ascending:!1});if(e){if("PGRST116"===e.code||"42P01"===e.code||"PGRST301"===e.code||404===e.status||"404"===e.code||e.message?.includes("relation")||e.message?.includes("relationship")||e.message?.includes("does not exist")||e.message?.includes("schema cache"))return console.warn("Table cpf_enrollments does not exist yet or invalid query:",e?.message),[];throw e}return d||[]}async createEnrollment(a){let b=await this.getLearnerRights(a.organization_id,a.learner_id);if(!b||b.available_credits<(a.cpf_funding_amount||0))throw Error("Crédits CPF insuffisants");let{data:c,error:d}=await this.supabase.from("cpf_enrollments").insert(a).select().single();if(d)throw d;return await this.supabase.from("cpf_learner_rights").update({available_credits:b.available_credits-(a.cpf_funding_amount||0),used_credits:b.used_credits+(a.cpf_funding_amount||0),updated_at:new Date().toISOString()}).eq("id",b.id),c}async generateAttestation(a){let b=`CPF-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,{data:c,error:d}=await this.supabase.from("cpf_attestations").insert({...a,attestation_number:b,issue_date:new Date().toISOString().split("T")[0],status:"issued"}).select().single();if(d)throw d;return c}async getAttestations(a){let{data:b,error:c}=await this.supabase.from("cpf_attestations").select("*").eq("enrollment_id",a).order("issue_date",{ascending:!1});if(c)throw c;return b||[]}async syncCatalogFromXML(a,b,c){let d=await this.getConfiguration(a);if(!d||!d.is_active)throw Error("Configuration CPF non active");let e=new FormData;if(b instanceof File)e.append("file",b);else throw Error("Le fichier XML doit être un objet File");let f=await fetch("/api/cpf/catalog-sync",{method:"POST",body:e});if(!f.ok)throw Error((await f.json().catch(()=>({error:"Erreur inconnue"}))).error||`Erreur HTTP: ${f.status}`);let g=await f.json();return{syncId:g.syncId,result:g}}async syncCatalogFromAPI(a,b){let c=await this.getConfiguration(a);if(!c||!c.is_active)throw Error("Configuration CPF non active");if(!c.api_key||!c.api_secret)throw Error("Clés API CPF non configurées");let{data:d,error:e}=await this.supabase.from("cpf_catalog_sync").insert({organization_id:a,sync_type:b?.syncType||"full",sync_method:"api",sync_status:"in_progress",created_by:b?.createdBy}).select().single();if(e)throw e;try{return await this.supabase.from("cpf_catalog_sync").update({sync_status:"completed",completed_at:new Date().toISOString(),records_total:0,records_created:0,records_updated:0}).eq("id",d.id),{syncId:d.id,result:{success:!0,message:"Synchronisation démarrée (à implémenter)"}}}catch(a){throw await this.supabase.from("cpf_catalog_sync").update({sync_status:"failed",completed_at:new Date().toISOString(),error_message:a.message,error_details:{error:a.toString()}}).eq("id",d.id),a}}async getCatalogSyncHistory(a,b){let c=this.supabase.from("cpf_catalog_sync").select("*").eq("organization_id",a).order("created_at",{ascending:!1});b?.status&&(c=c.eq("sync_status",b.status)),b?.syncMethod&&(c=c.eq("sync_method",b.syncMethod)),b?.limit&&(c=c.limit(b.limit));let{data:d,error:e}=await c;if(e)throw e;return d||[]}async getCatalogSyncById(a){let{data:b,error:c}=await this.supabase.from("cpf_catalog_sync").select("*").eq("id",a).single();if(c)throw c;return b}};a.s(["cpfService",0,c])}];

//# sourceMappingURL=_6a87cbe8._.js.map