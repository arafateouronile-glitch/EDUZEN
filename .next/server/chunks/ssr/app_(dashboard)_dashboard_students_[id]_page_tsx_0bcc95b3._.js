module.exports=[317261,a=>{"use strict";var b=a.i(187924),c=a.i(433217),d=a.i(50944),e=a.i(269240),f=a.i(542502),g=a.i(908403),h=a.i(307676),i=a.i(340695),j=a.i(703130),k=a.i(807706),l=a.i(400210),m=a.i(683245),n=a.i(992258),o=a.i(963519),p=a.i(124987),q=a.i(941675),r=a.i(660246),s=a.i(104720),t=a.i(790166),u=a.i(179257),v=a.i(533441),w=a.i(238246),x=a.i(497895),y=a.i(572131),z=a.i(864037);function A(){let a=(0,d.useParams)();(0,d.useRouter)();let A=a.id,B=(0,e.createClient)(),{addToast:C}=(0,z.useToast)(),[D,E]=(0,y.useState)(!1),{data:F,isLoading:G}=(0,c.useQuery)({queryKey:["student",A],queryFn:()=>f.studentService.getById(A)}),{data:H}=(0,c.useQuery)({queryKey:["student-guardians",A],queryFn:async()=>{let{data:a,error:b}=await B.from("student_guardians").select("*, guardians(*)").eq("student_id",A);if(b)throw b;return a?.map(a=>a.guardians).filter(Boolean)||[]},enabled:!!A}),{data:I}=(0,c.useQuery)({queryKey:["session",F?.class_id],queryFn:async()=>{if(!F?.class_id)return null;let{data:a,error:b}=await B.from("sessions").select("*, formations(*, programs(*))").eq("id",F.class_id).single();if(b)throw b;return a},enabled:!!F?.class_id}),{data:J}=(0,c.useQuery)({queryKey:["student-invoices",A],queryFn:async()=>F?.organization_id?g.invoiceService.getAll(F.organization_id,{studentId:A}):[],enabled:!!F?.organization_id&&!!A}),{data:K}=(0,c.useQuery)({queryKey:["student-payments",A],queryFn:async()=>F?.organization_id?h.paymentService.getAll(F.organization_id,{studentId:A}):[],enabled:!!F?.organization_id&&!!A});return G?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("div",{className:"text-muted-foreground",children:"Chargement..."})})}):F?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)(w.default,{href:"/dashboard/students",children:(0,b.jsx)(i.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(l.ArrowLeft,{className:"h-4 w-4"})})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:[F.first_name," ",F.last_name]}),(0,b.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:F.student_number})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Button,{variant:"outline",onClick:()=>{let a=`${window.location.origin}/learner/access/${A}`;navigator.clipboard.writeText(a).then(()=>{E(!0),C({title:"Lien copié",description:"Le lien d'accès a été copié dans le presse-papiers",type:"success"}),setTimeout(()=>E(!1),2e3)}).catch(()=>{C({title:"Erreur",description:"Impossible de copier le lien",type:"error"})})},children:D?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.Check,{className:"mr-2 h-4 w-4"}),"Lien copié"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.Link,{className:"mr-2 h-4 w-4"}),"Copier le lien d'accès"]})}),(0,b.jsx)(w.default,{href:`/dashboard/students/${A}/edit`,children:(0,b.jsxs)(i.Button,{children:[(0,b.jsx)(m.Edit,{className:"mr-2 h-4 w-4"}),"Modifier"]})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"Informations personnelles"})}),(0,b.jsxs)(j.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[F.photo_url?(0,b.jsx)(k.Avatar,{src:F.photo_url,alt:`${F.first_name} ${F.last_name}`,fallback:`${F.first_name||""} ${F.last_name||""}`,userId:F.id,size:"xl",variant:"auto",className:"shadow-xl"}):(0,b.jsx)(k.Avatar,{fallback:`${F.first_name||""} ${F.last_name||""}`,userId:F.id,size:"xl",variant:"auto",className:"shadow-xl"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Statut"}),(0,b.jsx)("p",{className:"font-medium",children:(0,b.jsx)("span",{className:`px-2 py-1 rounded text-xs ${"active"===F.status?"bg-brand-blue-ghost text-brand-blue":"inactive"===F.status?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:"active"===F.status?"Actif":"inactive"===F.status?"Inactif":F.status})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[F.date_of_birth&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center",children:[(0,b.jsx)(q.Calendar,{className:"mr-2 h-4 w-4"}),"Date de naissance"]}),(0,b.jsx)("p",{className:"font-medium",children:(0,x.formatDate)(F.date_of_birth)})]}),F.gender&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Genre"}),(0,b.jsx)("p",{className:"font-medium",children:"male"===F.gender?"Masculin":"female"===F.gender?"Féminin":F.gender})]})]}),F.email&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center",children:[(0,b.jsx)(n.Mail,{className:"mr-2 h-4 w-4"}),"Email"]}),(0,b.jsx)("p",{className:"font-medium",children:F.email})]}),F.phone&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center",children:[(0,b.jsx)(o.Phone,{className:"mr-2 h-4 w-4"}),"Téléphone"]}),(0,b.jsx)("p",{className:"font-medium",children:F.phone})]}),F.address&&(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center",children:[(0,b.jsx)(p.MapPin,{className:"mr-2 h-4 w-4"}),"Adresse"]}),(0,b.jsxs)("p",{className:"font-medium",children:[F.address,F.city&&`, ${F.city}`]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center",children:[(0,b.jsx)(q.Calendar,{className:"mr-2 h-4 w-4"}),"Date d'inscription"]}),(0,b.jsx)("p",{className:"font-medium",children:(0,x.formatDate)(F.enrollment_date||"")})]})]})]}),(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"Informations académiques"})}),(0,b.jsx)(j.CardContent,{children:I?(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground flex items-center",children:[(0,b.jsx)(r.Users,{className:"mr-2 h-4 w-4"}),"Session"]}),(0,b.jsxs)("p",{className:"font-medium text-lg",children:[I.name," - ",I.formations?.name||"",I.formations?.programs&&` (${I.formations.programs.name})`]})]}):(0,b.jsx)("p",{className:"text-muted-foreground",children:"Aucune session assignée"})})]}),(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)(j.CardTitle,{className:"flex items-center",children:[(0,b.jsx)(s.FileText,{className:"mr-2 h-5 w-5"}),"Devis et Factures"]}),(0,b.jsx)(w.default,{href:"/dashboard/payments/new",children:(0,b.jsx)(i.Button,{size:"sm",variant:"outline",children:"Nouveau devis / facture"})})]}),(0,b.jsx)(j.CardContent,{children:J&&J.length>0?(0,b.jsxs)("div",{className:"space-y-3",children:[J.slice(0,5).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("h4",{className:"font-semibold",children:a.invoice_number}),(0,b.jsx)("span",{className:`px-2 py-0.5 rounded text-xs ${"quote"===a.document_type?"bg-blue-100 text-blue-800":"bg-brand-blue-ghost text-brand-blue"}`,children:"quote"===a.document_type?"Devis":"Facture"}),(0,b.jsx)("span",{className:`px-2 py-0.5 rounded text-xs ${"paid"===a.status?"bg-brand-blue-ghost text-brand-blue":"sent"===a.status?"bg-brand-blue-pale text-brand-blue":"partial"===a.status?"bg-brand-cyan-ghost text-brand-cyan":"overdue"===a.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:"paid"===a.status?"Payée":"sent"===a.status?"Envoyée":"partial"===a.status?"Partielle":"overdue"===a.status?"En retard":"draft"===a.status?"Brouillon":a.status})]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["Émission: ",(0,x.formatDate)(a.issue_date)," - Échéance: ",(0,x.formatDate)(a.due_date)]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"font-semibold",children:(0,x.formatCurrency)(Number(a.total_amount),a.currency)}),(0,b.jsx)(w.default,{href:`/dashboard/payments/${a.id}`,children:(0,b.jsx)(i.Button,{variant:"ghost",size:"sm",className:"mt-2",children:"Voir détails"})})]})]},a.id)),J.length>5&&(0,b.jsx)(w.default,{href:"/dashboard/payments",children:(0,b.jsxs)(i.Button,{variant:"outline",className:"w-full mt-2",children:["Voir tous les devis et factures (",J.length,")"]})})]}):(0,b.jsx)("p",{className:"text-muted-foreground",children:"Aucun devis ou facture"})})]}),(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsxs)(j.CardTitle,{className:"flex items-center",children:[(0,b.jsx)(t.DollarSign,{className:"mr-2 h-5 w-5"}),"Paiements"]}),(0,b.jsx)(w.default,{href:"/dashboard/payments/new",children:(0,b.jsx)(i.Button,{size:"sm",variant:"outline",children:"Nouveau paiement"})})]}),(0,b.jsx)(j.CardContent,{children:K&&K.length>0?(0,b.jsxs)("div",{className:"space-y-3",children:[K.slice(0,5).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold",children:(0,x.formatCurrency)(Number(a.amount),a.currency)}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["cash"===a.payment_method?"Espèces":"mobile_money"===a.payment_method?`Mobile Money (${a.payment_provider||"N/A"})`:"card"===a.payment_method?"Carte":"bank_transfer"===a.payment_method?"Virement":a.payment_method," - ",a.paid_at?(0,x.formatDate)(a.paid_at):"N/A"]}),a.invoices&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Facture: ",a.invoices.invoice_number||"N/A"]})]}),(0,b.jsx)("span",{className:`px-2 py-1 rounded text-xs ${"completed"===a.status?"bg-success-bg text-success-primary":"pending"===a.status?"bg-warning-bg text-warning-primary":"bg-gray-100 text-gray-800"}`,children:"completed"===a.status?"Complété":"pending"===a.status?"En attente":a.status})]},a.id)),K.length>5&&(0,b.jsx)(w.default,{href:"/dashboard/payments",children:(0,b.jsxs)(i.Button,{variant:"outline",className:"w-full mt-2",children:["Voir tous les paiements (",K.length,")"]})})]}):(0,b.jsx)("p",{className:"text-muted-foreground",children:"Aucun paiement enregistré"})})]})]}),(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"Tuteurs / Parents"})}),(0,b.jsx)(j.CardContent,{children:H&&H.length>0?(0,b.jsx)("div",{className:"space-y-4",children:H.map(a=>(0,b.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,b.jsxs)("p",{className:"font-semibold",children:[a.first_name," ",a.last_name]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground capitalize",children:a.relationship}),a.phone_primary&&(0,b.jsxs)("p",{className:"text-sm mt-2 flex items-center",children:[(0,b.jsx)(o.Phone,{className:"mr-2 h-4 w-4"}),a.phone_primary]}),a.email&&(0,b.jsxs)("p",{className:"text-sm mt-1 flex items-center",children:[(0,b.jsx)(n.Mail,{className:"mr-2 h-4 w-4"}),a.email]})]},a.id))}):(0,b.jsx)("p",{className:"text-muted-foreground",children:"Aucun tuteur enregistré"})})]})})]})]}):(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-muted-foreground",children:"Élève non trouvé"}),(0,b.jsx)(w.default,{href:"/dashboard/students",children:(0,b.jsx)(i.Button,{className:"mt-4",children:"Retour à la liste"})})]})})}a.s(["default",()=>A])}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_students_%5Bid%5D_page_tsx_0bcc95b3._.js.map