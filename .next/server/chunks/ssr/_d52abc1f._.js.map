{"version":3,"sources":["../../../../node_modules/lucide-react/src/icons/plus.ts","../../../../node_modules/lucide-react/src/icons/arrow-left.ts","../../../../node_modules/lucide-react/src/icons/save.ts","../../../../lib/services/accessibility.service.ts","../../../../node_modules/lucide-react/src/icons/package.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Plus\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNSAxMmgxNCIgLz4KICA8cGF0aCBkPSJNMTIgNXYxNCIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/plus\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Plus = createLucideIcon('Plus', [\n  ['path', { d: 'M5 12h14', key: '1ays0h' }],\n  ['path', { d: 'M12 5v14', key: 's699le' }],\n]);\n\nexport default Plus;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ArrowLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTIgMTktNy03IDctNyIgLz4KICA8cGF0aCBkPSJNMTkgMTJINSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeft = createLucideIcon('ArrowLeft', [\n  ['path', { d: 'm12 19-7-7 7-7', key: '1l729n' }],\n  ['path', { d: 'M19 12H5', key: 'x3x0zl' }],\n]);\n\nexport default ArrowLeft;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Save\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTkgMjFINWEyIDIgMCAwIDEtMi0yVjVhMiAyIDAgMCAxIDItMmgxMWw1IDV2MTFhMiAyIDAgMCAxLTIgMnoiIC8+CiAgPHBvbHlsaW5lIHBvaW50cz0iMTcgMjEgMTcgMTMgNyAxMyA3IDIxIiAvPgogIDxwb2x5bGluZSBwb2ludHM9IjcgMyA3IDggMTUgOCIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/save\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Save = createLucideIcon('Save', [\n  ['path', { d: 'M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z', key: '1owoqh' }],\n  ['polyline', { points: '17 21 17 13 7 13 7 21', key: '1md35c' }],\n  ['polyline', { points: '7 3 7 8 15 8', key: '8nz8an' }],\n]);\n\nexport default Save;\n","/**\n * Service Accessibilité Handicap\n *\n * Gestion complète de l'accessibilité et du handicap pour les organismes de formation.\n * Conforme aux exigences Qualiopi (critère 8) et à la réglementation française.\n *\n * Fonctionnalités :\n * - Configuration organisation (référent handicap, partenaires)\n * - Gestion besoins spécifiques des stagiaires\n * - Aménagements pédagogiques et techniques\n * - Inventaire équipements adaptés\n * - Documents justificatifs (MDPH, RQTH, etc.)\n * - Rapports de conformité\n */\n\nimport { createClient } from '@/lib/supabase/client'\nimport type { SupabaseClient } from '@supabase/supabase-js'\n\n// =====================================================\n// INTERFACES\n// =====================================================\n\nexport interface AccessibilityConfiguration {\n  id: string\n  organization_id: string\n  referent_user_id: string | null\n  referent_training_date: string | null\n  referent_training_certificate: string | null\n  accessibility_policy: string | null\n  physical_accessibility_statement: string | null\n  digital_accessibility_statement: string | null\n  partner_agefiph: boolean\n  partner_cap_emploi: boolean\n  partner_fiphfp: boolean\n  partner_other: Array<{ name: string; contact: string }>\n  created_at: string\n  updated_at: string\n}\n\nexport interface DisabilityType {\n  id: string\n  code: string\n  name_fr: string\n  name_en: string\n  description: string | null\n  icon: string | null\n  color: string | null\n  created_at: string\n}\n\nexport interface StudentNeed {\n  id: string\n  organization_id: string\n  student_id: string\n  has_disability: boolean\n  disability_type_ids: string[]\n  disability_description: string | null\n  has_mdph_recognition: boolean\n  mdph_number: string | null\n  mdph_expiry_date: string | null\n  needs_physical_accommodations: boolean\n  physical_accommodations_detail: string | null\n  needs_pedagogical_accommodations: boolean\n  pedagogical_accommodations_detail: string | null\n  needs_exam_accommodations: boolean\n  exam_accommodations_detail: string | null\n  needs_technical_aids: boolean\n  technical_aids_detail: string | null\n  external_referent_name: string | null\n  external_referent_contact: string | null\n  consent_share_info: boolean\n  declaration_date: string\n  status: 'pending' | 'reviewed' | 'implemented'\n  reviewed_by_user_id: string | null\n  reviewed_at: string | null\n  notes: string | null\n  created_at: string\n  updated_at: string\n}\n\nexport interface Accommodation {\n  id: string\n  organization_id: string\n  student_id: string\n  student_need_id: string | null\n  accommodation_type: 'physical' | 'pedagogical' | 'exam' | 'technical' | 'schedule'\n  category: string | null\n  title: string\n  description: string | null\n  start_date: string | null\n  end_date: string | null\n  status: 'active' | 'inactive' | 'expired'\n  assigned_to_user_id: string | null\n  completion_rate: number\n  metadata: Record<string, unknown>\n  created_at: string\n  updated_at: string\n}\n\nexport interface Equipment {\n  id: string\n  organization_id: string\n  name: string\n  category: 'mobility' | 'visual' | 'auditory' | 'ergonomic' | 'software' | 'other' | null\n  description: string | null\n  location: string | null\n  site_id: string | null\n  quantity_total: number\n  quantity_available: number\n  status: 'available' | 'in_use' | 'maintenance' | 'retired'\n  purchase_date: string | null\n  warranty_expiry_date: string | null\n  maintenance_schedule: 'none' | 'monthly' | 'quarterly' | 'biannual' | 'annual' | null\n  last_maintenance_date: string | null\n  next_maintenance_date: string | null\n  responsible_user_id: string | null\n  notes: string | null\n  metadata: Record<string, unknown>\n  created_at: string\n  updated_at: string\n}\n\nexport interface EquipmentAssignment {\n  id: string\n  organization_id: string\n  equipment_id: string\n  student_id: string\n  accommodation_id: string | null\n  assigned_date: string\n  return_date: string | null\n  actual_return_date: string | null\n  status: 'assigned' | 'returned' | 'lost' | 'damaged'\n  condition_on_assignment: 'excellent' | 'good' | 'fair' | 'poor' | null\n  condition_on_return: 'excellent' | 'good' | 'fair' | 'poor' | 'damaged' | 'lost' | null\n  notes: string | null\n  created_at: string\n  updated_at: string\n}\n\nexport interface AccessibilityDocument {\n  id: string\n  organization_id: string\n  student_id: string\n  student_need_id: string | null\n  document_type: 'mdph_certificate' | 'medical_certificate' | 'rqth' | 'disability_card' | 'other' | null\n  title: string\n  file_path: string\n  file_name: string\n  file_size: number | null\n  mime_type: string | null\n  issue_date: string | null\n  expiry_date: string | null\n  issuer: string | null\n  reference_number: string | null\n  is_confidential: boolean\n  uploaded_by_user_id: string | null\n  verified: boolean\n  verified_by_user_id: string | null\n  verified_at: string | null\n  notes: string | null\n  created_at: string\n  updated_at: string\n}\n\nexport interface ComplianceReport {\n  id: string\n  organization_id: string\n  report_type: 'annual' | 'audit' | 'qualiopi' | 'internal'\n  title: string\n  period_start: string\n  period_end: string\n  total_students: number\n  students_with_disabilities: number\n  accommodations_requested: number\n  accommodations_implemented: number\n  equipment_used: number\n  referent_training_up_to_date: boolean\n  physical_accessibility_compliant: boolean\n  digital_accessibility_compliant: boolean\n  partner_collaborations: number\n  compliance_rate: number\n  findings: Array<{ category: string; description: string; severity: string }>\n  recommendations: Array<{ title: string; description: string; priority: string }>\n  generated_by_user_id: string | null\n  created_at: string\n}\n\nexport interface AccessibilityStats {\n  total_students_with_needs: number\n  active_accommodations: number\n  available_equipment: number\n  compliance_rate: number\n  students_by_disability_type: Array<{ type: string; count: number }>\n  accommodations_by_type: Array<{ type: string; count: number }>\n  pending_reviews: number\n}\n\n// Filtres\nexport interface StudentNeedFilters {\n  status?: 'pending' | 'reviewed' | 'implemented'\n  has_disability?: boolean\n  search?: string\n}\n\nexport interface AccommodationFilters {\n  student_id?: string\n  status?: 'active' | 'inactive' | 'expired'\n  type?: 'physical' | 'pedagogical' | 'exam' | 'technical' | 'schedule'\n  search?: string\n}\n\nexport interface EquipmentFilters {\n  status?: 'available' | 'in_use' | 'maintenance' | 'retired'\n  category?: 'mobility' | 'visual' | 'auditory' | 'ergonomic' | 'software' | 'other'\n  search?: string\n}\n\n// =====================================================\n// SERVICE\n// =====================================================\n\nexport class AccessibilityService {\n  private supabase: SupabaseClient<any>\n\n\n  constructor(supabaseClient?: SupabaseClient<any>) {\n\n    this.supabase = supabaseClient || createClient()\n\n  }\n\n  // ===================================================\n  // CONFIGURATION\n  // ===================================================\n\n  /**\n   * Récupérer la configuration accessibilité de l'organisation\n   */\n  async getConfiguration(organizationId: string): Promise<AccessibilityConfiguration | null> {\n    try {\n      const { data, error } = await this.supabase\n        .from('accessibility_configurations')\n        .select('*')\n        .eq('organization_id', organizationId)\n        .maybeSingle()\n\n      if (error) {\n        if (\n          error.code === 'PGRST116' ||\n          error.code === '42P01' ||\n          error.code === 'PGRST301' ||\n          (error as any).status === 404 ||\n          error.message?.includes('relation') ||\n          error.message?.includes('does not exist')\n        ) {\n          console.warn('Table accessibility_configurations does not exist yet:', error?.message)\n          return null\n        }\n        throw error\n      }\n\n      return data\n    } catch (err: unknown) {\n      if ((err as any)?.status === 404 || (err as any)?.message?.toLowerCase().includes('not found')) {\n        return null\n      }\n      throw err\n    }\n  }\n\n  /**\n   * Créer ou mettre à jour la configuration accessibilité\n   */\n  async updateConfiguration(\n    organizationId: string,\n    data: Partial<AccessibilityConfiguration>\n  ): Promise<AccessibilityConfiguration> {\n    // Vérifier si une config existe déjà\n    const existing = await this.getConfiguration(organizationId)\n\n    // Nettoyer les données pour la DB (supprimer id, timestamps)\n    const cleanData = { ...data }\n    delete (cleanData as any).id\n    delete (cleanData as any).created_at\n    delete (cleanData as any).updated_at\n    delete (cleanData as any).organization_id\n\n    // Fonction utilitaire pour valider un UUID\n    const isValidUUID = (str: string | null | undefined): boolean => {\n      if (!str || str === '') return false\n      const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i\n      return uuidRegex.test(str)\n    }\n\n    // Convertir les UUID invalides en null pour referent_user_id\n    if (cleanData.referent_user_id !== null && cleanData.referent_user_id !== undefined) {\n      if (cleanData.referent_user_id === '' || !isValidUUID(cleanData.referent_user_id)) {\n        cleanData.referent_user_id = null\n      }\n    }\n\n    // Convertir les chaînes vides en null pour les champs de type DATE\n    if (cleanData.referent_training_date === '' || cleanData.referent_training_date === null) {\n      cleanData.referent_training_date = null\n    }\n    // Convertir les chaînes vides en null pour les autres champs optionnels\n    if ((cleanData as any).referent_training_certificate === '') {\n      (cleanData as any).referent_training_certificate = null\n    }\n    if ((cleanData as any).accessibility_policy === '') {\n      (cleanData as any).accessibility_policy = null\n    }\n    if ((cleanData as any).physical_accessibility_statement === '') {\n      (cleanData as any).physical_accessibility_statement = null\n    }\n    if ((cleanData as any).digital_accessibility_statement === '') {\n      (cleanData as any).digital_accessibility_statement = null\n    }\n\n    if (existing) {\n      // Mise à jour\n      const { data: updated, error } = await this.supabase\n        .from('accessibility_configurations')\n        .update(cleanData)\n        .eq('organization_id', organizationId)\n        .select()\n        .single()\n\n      if (error) {\n        console.error('[AccessibilityService] Erreur lors de la mise à jour de la configuration:', {\n          error,\n          code: error.code,\n          message: error.message,\n          details: error.details,\n          hint: error.hint,\n          cleanData,\n          organizationId,\n        })\n        throw error\n      }\n      return updated\n    } else {\n      // Création - assurer les valeurs par défaut\n      const insertData = {\n        organization_id: organizationId,\n        partner_agefiph: false,\n        partner_cap_emploi: false,\n        partner_fiphfp: false,\n        partner_other: [],\n        ...cleanData,\n      }\n\n      const { data: created, error } = await this.supabase\n        .from('accessibility_configurations')\n        .insert(insertData)\n        .select()\n        .single()\n\n      if (error) {\n        console.error('[AccessibilityService] Erreur lors de la création de la configuration:', {\n          error,\n          code: error.code,\n          message: error.message,\n          details: error.details,\n          hint: error.hint,\n          insertData,\n        })\n        throw error\n      }\n      return created\n    }\n  }\n\n  /**\n   * Définir le référent handicap\n   */\n  async setReferent(\n    organizationId: string,\n    userId: string,\n    trainingDate?: string,\n    certificate?: string\n  ): Promise<void> {\n    await this.updateConfiguration(organizationId, {\n      referent_user_id: userId,\n      referent_training_date: trainingDate || null,\n      referent_training_certificate: certificate || null,\n    })\n  }\n\n  // ===================================================\n  // TYPES DE HANDICAP\n  // ===================================================\n\n  /**\n   * Récupérer tous les types de handicap (référentiel)\n   */\n  async getDisabilityTypes(): Promise<DisabilityType[]> {\n    try {\n      const { data, error } = await this.supabase\n        .from('accessibility_disability_types')\n        .select('*')\n        .order('name_fr', { ascending: true })\n\n      if (error) {\n        if (\n          error.code === 'PGRST116' ||\n          error.code === '42P01' ||\n          (error as any).status === 404 ||\n          error.message?.includes('relation') ||\n          error.message?.includes('does not exist')\n        ) {\n          console.warn('Table accessibility_disability_types does not exist yet')\n          return []\n        }\n        throw error\n      }\n\n      return data || []\n    } catch (err: unknown) {\n      if ((err as any)?.status === 404) {\n        return []\n      }\n      throw err\n    }\n  }\n\n  // ===================================================\n  // BESOINS STAGIAIRES\n  // ===================================================\n\n  /**\n   * Récupérer les besoins spécifiques des stagiaires\n   */\n  async getStudentNeeds(organizationId: string, filters?: StudentNeedFilters): Promise<StudentNeed[]> {\n    try {\n      let query = this.supabase\n        .from('accessibility_student_needs')\n        .select('*')\n        .eq('organization_id', organizationId)\n\n      // Filtres\n      if (filters?.status) {\n        query = query.eq('status', filters.status)\n      }\n      if (filters?.has_disability !== undefined) {\n        query = query.eq('has_disability', filters.has_disability)\n      }\n\n      const { data, error } = await query.order('created_at', { ascending: false })\n\n      if (error) {\n        if (\n          error.code === 'PGRST116' ||\n          error.code === '42P01' ||\n          (error as any).status === 404 ||\n          error.message?.includes('relation') ||\n          error.message?.includes('does not exist')\n        ) {\n          console.warn('Table accessibility_student_needs does not exist yet')\n          return []\n        }\n        throw error\n      }\n\n      return data || []\n    } catch (err: unknown) {\n      if ((err as any)?.status === 404) {\n        return []\n      }\n      throw err\n    }\n  }\n\n  /**\n   * Récupérer les besoins d'un stagiaire spécifique\n   */\n  async getStudentNeedByStudentId(studentId: string): Promise<StudentNeed | null> {\n    try {\n      const { data, error } = await this.supabase\n        .from('accessibility_student_needs')\n        .select('*')\n        .eq('student_id', studentId)\n        .maybeSingle()\n\n      if (error) {\n        if (\n          error.code === 'PGRST116' ||\n          error.code === '42P01' ||\n          (error as any).status === 404 ||\n          error.message?.includes('relation') ||\n          error.message?.includes('does not exist')\n        ) {\n          return null\n        }\n        throw error\n      }\n\n      return data\n    } catch (err: unknown) {\n      if ((err as any)?.status === 404) {\n        return null\n      }\n      throw err\n    }\n  }\n\n  /**\n   * Créer une déclaration de besoins\n   */\n  async createStudentNeed(data: Partial<StudentNeed>): Promise<StudentNeed> {\n    const { data: created, error } = await this.supabase\n      .from('accessibility_student_needs')\n      .insert(data)\n      .select()\n      .single()\n\n    if (error) throw error\n    return created\n  }\n\n  /**\n   * Mettre à jour une déclaration de besoins\n   */\n  async updateStudentNeed(needId: string, data: Partial<StudentNeed>): Promise<StudentNeed> {\n    const { data: updated, error } = await this.supabase\n      .from('accessibility_student_needs')\n      .update(data)\n      .eq('id', needId)\n      .select()\n      .single()\n\n    if (error) throw error\n    return updated\n  }\n\n  /**\n   * Marquer une déclaration comme revue\n   */\n  async reviewStudentNeed(needId: string, reviewerId: string, notes?: string): Promise<StudentNeed> {\n    return this.updateStudentNeed(needId, {\n      status: 'reviewed',\n      reviewed_by_user_id: reviewerId,\n      reviewed_at: new Date().toISOString(),\n      notes: notes || null,\n    })\n  }\n\n  // ===================================================\n  // AMÉNAGEMENTS\n  // ===================================================\n\n  /**\n   * Récupérer les aménagements\n   */\n  async getAccommodations(organizationId: string, filters?: AccommodationFilters): Promise<Accommodation[]> {\n    try {\n      let query = this.supabase\n        .from('accessibility_accommodations')\n        .select('*')\n        .eq('organization_id', organizationId)\n\n      // Filtres\n      if (filters?.student_id) {\n        query = query.eq('student_id', filters.student_id)\n      }\n      if (filters?.status) {\n        query = query.eq('status', filters.status)\n      }\n      if (filters?.type) {\n        query = query.eq('accommodation_type', filters.type)\n      }\n\n      const { data, error } = await query.order('created_at', { ascending: false })\n\n      if (error) {\n        if (\n          error.code === 'PGRST116' ||\n          error.code === '42P01' ||\n          (error as any).status === 404 ||\n          error.message?.includes('relation') ||\n          error.message?.includes('does not exist')\n        ) {\n          console.warn('Table accessibility_accommodations does not exist yet')\n          return []\n        }\n        throw error\n      }\n\n      return data || []\n    } catch (err: unknown) {\n      if ((err as any)?.status === 404) {\n        return []\n      }\n      throw err\n    }\n  }\n\n  /**\n   * Récupérer les aménagements d'un stagiaire\n   */\n  async getStudentAccommodations(studentId: string): Promise<Accommodation[]> {\n    return this.getAccommodations('', { student_id: studentId })\n  }\n\n  /**\n   * Créer un aménagement\n   */\n  async createAccommodation(data: Partial<Accommodation>): Promise<Accommodation> {\n    const { data: created, error } = await this.supabase\n      .from('accessibility_accommodations')\n      .insert(data)\n      .select()\n      .single()\n\n    if (error) throw error\n    return created\n  }\n\n  /**\n   * Mettre à jour un aménagement\n   */\n  async updateAccommodation(accommodationId: string, data: Partial<Accommodation>): Promise<Accommodation> {\n    const { data: updated, error } = await this.supabase\n      .from('accessibility_accommodations')\n      .update(data)\n      .eq('id', accommodationId)\n      .select()\n      .single()\n\n    if (error) throw error\n    return updated\n  }\n\n  /**\n   * Archiver un aménagement (passer en inactif)\n   */\n  async archiveAccommodation(accommodationId: string): Promise<void> {\n    await this.updateAccommodation(accommodationId, { status: 'inactive' })\n  }\n\n  // ===================================================\n  // ÉQUIPEMENTS\n  // ===================================================\n\n  /**\n   * Récupérer les équipements\n   */\n  async getEquipment(organizationId: string, filters?: EquipmentFilters): Promise<Equipment[]> {\n    try {\n      let query = this.supabase\n        .from('accessibility_equipment')\n        .select('*')\n        .eq('organization_id', organizationId)\n\n      // Filtres\n      if (filters?.status) {\n        query = query.eq('status', filters.status)\n      }\n      if (filters?.category) {\n        query = query.eq('category', filters.category)\n      }\n\n      const { data, error } = await query.order('name', { ascending: true })\n\n      if (error) {\n        if (\n          error.code === 'PGRST116' ||\n          error.code === '42P01' ||\n          (error as any).status === 404 ||\n          error.message?.includes('relation') ||\n          error.message?.includes('does not exist')\n        ) {\n          console.warn('Table accessibility_equipment does not exist yet')\n          return []\n        }\n        throw error\n      }\n\n      return data || []\n    } catch (err: unknown) {\n      if ((err as any)?.status === 404) {\n        return []\n      }\n      throw err\n    }\n  }\n\n  /**\n   * Créer un équipement\n   */\n  async createEquipment(data: Partial<Equipment>): Promise<Equipment> {\n    const { data: created, error } = await this.supabase\n      .from('accessibility_equipment')\n      .insert(data)\n      .select()\n      .single()\n\n    if (error) throw error\n    return created\n  }\n\n  /**\n   * Mettre à jour un équipement\n   */\n  async updateEquipment(equipmentId: string, data: Partial<Equipment>): Promise<Equipment> {\n    const { data: updated, error } = await this.supabase\n      .from('accessibility_equipment')\n      .update(data)\n      .eq('id', equipmentId)\n      .select()\n      .single()\n\n    if (error) throw error\n    return updated\n  }\n\n  /**\n   * Attribuer un équipement à un stagiaire\n   */\n  async assignEquipment(\n    equipmentId: string,\n    studentId: string,\n    assignmentData: Partial<EquipmentAssignment>\n  ): Promise<EquipmentAssignment> {\n    // Récupérer l'équipement\n    const { data: equipment, error: eqError } = await this.supabase\n      .from('accessibility_equipment')\n      .select('*')\n      .eq('id', equipmentId)\n      .single()\n\n    if (eqError) throw eqError\n\n    // Vérifier disponibilité\n    if (equipment.quantity_available <= 0) {\n      throw new Error('Équipement non disponible')\n    }\n\n    // Créer l'attribution\n    const { data: assignment, error: assignError } = await this.supabase\n      .from('accessibility_equipment_assignments')\n      .insert({\n        equipment_id: equipmentId,\n        student_id: studentId,\n        organization_id: equipment.organization_id,\n        ...assignmentData,\n      })\n      .select()\n      .single()\n\n    if (assignError) throw assignError\n\n    // Décrémenter la quantité disponible\n    await this.updateEquipment(equipmentId, {\n      quantity_available: equipment.quantity_available - 1,\n      status: equipment.quantity_available - 1 === 0 ? 'in_use' : equipment.status,\n    })\n\n    return assignment\n  }\n\n  /**\n   * Retourner un équipement\n   */\n  async returnEquipment(assignmentId: string, condition: EquipmentAssignment['condition_on_return']): Promise<void> {\n    // Récupérer l'attribution\n    const { data: assignment, error: assignError } = await this.supabase\n      .from('accessibility_equipment_assignments')\n      .select('*, accessibility_equipment(*)')\n      .eq('id', assignmentId)\n      .single()\n\n    if (assignError) throw assignError\n\n    // Mettre à jour l'attribution\n    await this.supabase\n      .from('accessibility_equipment_assignments')\n      .update({\n        status: 'returned',\n        actual_return_date: new Date().toISOString().split('T')[0],\n        condition_on_return: condition,\n      })\n      .eq('id', assignmentId)\n\n    // Incrémenter la quantité disponible (sauf si perdu ou endommagé)\n    if (condition !== 'lost' && condition !== 'damaged') {\n      const equipment = (assignment as any).accessibility_equipment\n      await this.updateEquipment(assignment.equipment_id, {\n        quantity_available: equipment.quantity_available + 1,\n        status: 'available',\n      })\n    }\n  }\n\n  /**\n   * Récupérer les attributions d'un équipement\n   */\n  async getEquipmentAssignments(equipmentId: string): Promise<EquipmentAssignment[]> {\n    try {\n      const { data, error } = await this.supabase\n        .from('accessibility_equipment_assignments')\n        .select('*')\n        .eq('equipment_id', equipmentId)\n        .order('assigned_date', { ascending: false })\n\n      if (error) {\n        if (\n          error.code === 'PGRST116' ||\n          error.code === '42P01' ||\n          (error as any).status === 404 ||\n          error.message?.includes('relation') ||\n          error.message?.includes('does not exist')\n        ) {\n          console.warn('Table accessibility_equipment_assignments does not exist yet')\n          return []\n        }\n        throw error\n      }\n\n      return data || []\n    } catch (err: unknown) {\n      if ((err as any)?.status === 404) {\n        return []\n      }\n      throw err\n    }\n  }\n\n  // ===================================================\n  // DOCUMENTS\n  // ===================================================\n\n  /**\n   * Récupérer les documents\n   */\n  async getDocuments(organizationId: string, studentId?: string): Promise<AccessibilityDocument[]> {\n    try {\n      let query = this.supabase\n        .from('accessibility_documents')\n        .select('*')\n        .eq('organization_id', organizationId)\n\n      if (studentId) {\n        query = query.eq('student_id', studentId)\n      }\n\n      const { data, error } = await query.order('created_at', { ascending: false })\n\n      if (error) {\n        if (\n          error.code === 'PGRST116' ||\n          error.code === '42P01' ||\n          (error as any).status === 404 ||\n          error.message?.includes('relation') ||\n          error.message?.includes('does not exist')\n        ) {\n          console.warn('Table accessibility_documents does not exist yet')\n          return []\n        }\n        throw error\n      }\n\n      return data || []\n    } catch (err: unknown) {\n      if ((err as any)?.status === 404) {\n        return []\n      }\n      throw err\n    }\n  }\n\n  /**\n   * Upload un document (métadonnées uniquement, le fichier doit être uploadé via Storage)\n   */\n  async uploadDocument(metadata: Partial<AccessibilityDocument>): Promise<AccessibilityDocument> {\n    const { data, error } = await this.supabase\n      .from('accessibility_documents')\n      .insert(metadata)\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Supprimer un document\n   */\n  async deleteDocument(documentId: string): Promise<void> {\n    // TODO: Supprimer aussi le fichier du Storage\n    const { error } = await this.supabase\n      .from('accessibility_documents')\n      .delete()\n      .eq('id', documentId)\n\n    if (error) throw error\n  }\n\n  /**\n   * Vérifier un document\n   */\n  async verifyDocument(documentId: string, verifierId: string): Promise<void> {\n    await this.supabase\n      .from('accessibility_documents')\n      .update({\n        verified: true,\n        verified_by_user_id: verifierId,\n        verified_at: new Date().toISOString(),\n      })\n      .eq('id', documentId)\n  }\n\n  // ===================================================\n  // STATISTIQUES ET RAPPORTS\n  // ===================================================\n\n  /**\n   * Récupérer les statistiques accessibilité\n   */\n  async getStats(organizationId: string): Promise<AccessibilityStats> {\n    const [needs, accommodations, equipment, complianceRate] = await Promise.all([\n      this.getStudentNeeds(organizationId, { has_disability: true }),\n      this.getAccommodations(organizationId, { status: 'active' }),\n      this.getEquipment(organizationId, { status: 'available' }),\n      this.calculateComplianceRate(organizationId),\n    ])\n\n    // Statistiques par type de handicap\n    const disabilityTypeCounts = new Map<string, number>()\n    needs.forEach((need) => {\n      need.disability_type_ids.forEach((typeId) => {\n        disabilityTypeCounts.set(typeId, (disabilityTypeCounts.get(typeId) || 0) + 1)\n      })\n    })\n\n    // Statistiques par type d'aménagement\n    const accommodationTypeCounts = new Map<string, number>()\n    accommodations.forEach((acc) => {\n      accommodationTypeCounts.set(acc.accommodation_type, (accommodationTypeCounts.get(acc.accommodation_type) || 0) + 1)\n    })\n\n    return {\n      total_students_with_needs: needs.length,\n      active_accommodations: accommodations.length,\n      available_equipment: equipment.reduce((sum, eq) => sum + eq.quantity_available, 0),\n      compliance_rate: complianceRate,\n      students_by_disability_type: Array.from(disabilityTypeCounts.entries()).map(([type, count]) => ({\n        type,\n        count,\n      })),\n      accommodations_by_type: Array.from(accommodationTypeCounts.entries()).map(([type, count]) => ({\n        type,\n        count,\n      })),\n      pending_reviews: needs.filter((n) => n.status === 'pending').length,\n    }\n  }\n\n  /**\n   * Calculer le taux de conformité\n   */\n  async calculateComplianceRate(organizationId: string): Promise<number> {\n    try {\n      const { data, error } = await this.supabase.rpc('calculate_accessibility_compliance_rate', {\n        org_id: organizationId,\n      })\n\n      if (error) {\n        const is404Error =\n          error.code === 'PGRST116' ||\n          error.code === '42883' ||\n          (error as any).status === 404 ||\n          error.message?.toLowerCase().includes('function') ||\n          error.message?.toLowerCase().includes('does not exist')\n\n        if (is404Error) {\n          if (process.env.NODE_ENV === 'development') {\n            console.warn('Function calculate_accessibility_compliance_rate does not exist yet')\n          }\n          return 0\n        }\n        throw error\n      }\n\n      return data || 0\n    } catch (err: unknown) {\n      if ((err as any)?.status === 404 || (err as any)?.message?.toLowerCase().includes('not found')) {\n        return 0\n      }\n      throw err\n    }\n  }\n\n  /**\n   * Générer un rapport de conformité\n   */\n  async generateComplianceReport(\n    organizationId: string,\n    periodStart: string,\n    periodEnd: string,\n    generatedBy: string\n  ): Promise<ComplianceReport> {\n    const stats = await this.getStats(organizationId)\n    const config = await this.getConfiguration(organizationId)\n\n    const reportData: Partial<ComplianceReport> = {\n      organization_id: organizationId,\n      report_type: 'annual',\n      title: `Rapport de conformité accessibilité ${new Date().getFullYear()}`,\n      period_start: periodStart,\n      period_end: periodEnd,\n      total_students: 0, // TODO: Récupérer depuis students\n      students_with_disabilities: stats.total_students_with_needs,\n      accommodations_requested: stats.total_students_with_needs,\n      accommodations_implemented: stats.active_accommodations,\n      equipment_used: 0, // TODO: Calculer équipements utilisés\n      referent_training_up_to_date: !!config?.referent_training_date,\n      physical_accessibility_compliant: !!config?.physical_accessibility_statement,\n      digital_accessibility_compliant: !!config?.digital_accessibility_statement,\n      partner_collaborations:\n        (config?.partner_agefiph ? 1 : 0) +\n        (config?.partner_cap_emploi ? 1 : 0) +\n        (config?.partner_fiphfp ? 1 : 0),\n      compliance_rate: stats.compliance_rate,\n      findings: [],\n      recommendations: [],\n      generated_by_user_id: generatedBy,\n    }\n\n    const { data, error } = await this.supabase\n      .from('accessibility_compliance_reports')\n      .insert(reportData)\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n}\n\n// Export singleton\nexport const accessibilityService = new AccessibilityService()\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Package\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtNy41IDQuMjcgOSA1LjE1IiAvPgogIDxwYXRoIGQ9Ik0yMSA4YTIgMiAwIDAgMC0xLTEuNzNsLTctNGEyIDIgMCAwIDAtMiAwbC03IDRBMiAyIDAgMCAwIDMgOHY4YTIgMiAwIDAgMCAxIDEuNzNsNyA0YTIgMiAwIDAgMCAyIDBsNy00QTIgMiAwIDAgMCAyMSAxNloiIC8+CiAgPHBhdGggZD0ibTMuMyA3IDguNyA1IDguNy01IiAvPgogIDxwYXRoIGQ9Ik0xMiAyMlYxMiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/package\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Package = createLucideIcon('Package', [\n  ['path', { d: 'm7.5 4.27 9 5.15', key: '1c824w' }],\n  [\n    'path',\n    {\n      d: 'M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z',\n      key: 'hh9hay',\n    },\n  ],\n  ['path', { d: 'm3.3 7 8.7 5 8.7-5', key: 'g66t2b' }],\n  ['path', { d: 'M12 22V12', key: 'd0xqtd' }],\n]);\n\nexport default Package;\n"],"names":[],"mappings":"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","ignoreList":[0,1,2,4]}