module.exports=[400210,a=>{"use strict";let b=(0,a.i(170106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],400210)},641710,a=>{"use strict";let b=(0,a.i(170106).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],641710)},400187,a=>{"use strict";var b=a.i(298621);let c=a=>"boolean"==typeof a?`${a}`:0===a?"0":a,d=b.clsx;a.s(["cva",0,(a,b)=>e=>{var f;if((null==b?void 0:b.variants)==null)return d(a,null==e?void 0:e.class,null==e?void 0:e.className);let{variants:g,defaultVariants:h}=b,i=Object.keys(g).map(a=>{let b=null==e?void 0:e[a],d=null==h?void 0:h[a];if(null===b)return null;let f=c(b)||c(d);return g[a][f]}),j=e&&Object.entries(e).reduce((a,b)=>{let[c,d]=b;return void 0===d||(a[c]=d),a},{});return d(a,i,null==b||null==(f=b.compoundVariants)?void 0:f.reduce((a,b)=>{let{class:c,className:d,...e}=b;return Object.entries(e).every(a=>{let[b,c]=a;return Array.isArray(c)?c.includes({...h,...j}[b]):({...h,...j})[b]===c})?[...a,c,d]:a},[]),null==e?void 0:e.class,null==e?void 0:e.className)}])},254161,a=>{"use strict";var b=a.i(187924),c=a.i(400187),d=a.i(497895);let e=(0,c.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground border-border hover:bg-accent hover:text-accent-foreground",success:"border-transparent bg-success-primary text-white shadow hover:bg-brand-blue-dark",warning:"border-transparent bg-warning-primary text-white shadow hover:bg-brand-cyan-dark",premium:"border-transparent bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 text-white shadow-lg shadow-purple-500/50 hover:shadow-xl hover:shadow-purple-500/60",glass:"border-white/20 bg-white/10 backdrop-blur-md text-foreground shadow-lg"},size:{default:"px-2.5 py-0.5 text-xs",sm:"px-2 py-0.5 text-xs",lg:"px-3 py-1 text-sm"}},defaultVariants:{variant:"default",size:"default"}});function f({className:a,variant:c,size:f,dot:g,pulse:h,children:i,...j}){return(0,b.jsxs)("div",{className:(0,d.cn)(e({variant:c,size:f}),a),...j,children:[g&&(0,b.jsx)("span",{className:(0,d.cn)("mr-1.5 h-1.5 w-1.5 rounded-full","success"===c&&"bg-white/80","warning"===c&&"bg-white/80","default"===c&&"bg-white/80",h&&"animate-pulse")}),i]})}a.s(["Badge",()=>f])},284505,a=>{"use strict";let b=(0,a.i(170106).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);a.s(["Download",()=>b],284505)},821374,a=>{"use strict";let b=(0,a.i(170106).default)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);a.s(["Star",()=>b],821374)},771931,a=>{"use strict";let b=(0,a.i(170106).default)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);a.s(["Printer",()=>b],771931)},246769,a=>{"use strict";var b=a.i(187924),c=a.i(50944),d=a.i(433217),e=a.i(913216),f=a.i(269240),g=a.i(703130),h=a.i(340695),i=a.i(254161),j=a.i(400210),k=a.i(284505),l=a.i(953722),m=a.i(941675),n=a.i(111269),o=a.i(641710),p=a.i(821374),q=a.i(104720),r=a.i(771931),s=a.i(238246),t=a.i(497895);a.i(460355);var u=a.i(346271);function v(){let a=(0,c.useParams)(),{user:v}=(0,e.useAuth)(),w=(0,f.createClient)(),x=a.id,{data:y,isLoading:z}=(0,d.useQuery)({queryKey:["view-portfolio",x],queryFn:async()=>{let{data:a,error:b}=await w.from("learning_portfolios").select(`
          *,
          template:learning_portfolio_templates(*),
          student:students(id, first_name, last_name, email, phone, photo_url),
          session:sessions(id, name, start_date, end_date, formations(id, name))
        `).eq("id",x).eq("is_visible_to_student",!0).single();if(b)throw b;return a},enabled:!!x}),{data:A}=(0,d.useQuery)({queryKey:["view-portfolio-entries",x],queryFn:async()=>{let{data:a,error:b}=await w.from("learning_portfolio_entries").select("*").eq("portfolio_id",x);return b?[]:a||[]},enabled:!!x}),B={};A?.forEach(a=>{B[`${a.section_id}.${a.field_id}`]=a});let C=(a,b)=>{let c=`${a}.${b}`,d=y?.content;return B[c]?.value||d?.[c]},D=(a,b)=>{let c=`${a}.${b}`;return B[c]?.teacher_comment};if(z)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-blue"})});if(!y)return(0,b.jsx)("div",{className:"container mx-auto py-8 px-4",children:(0,b.jsx)(g.Card,{children:(0,b.jsxs)(g.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(q.FileText,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Livret non trouvé"}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:"Ce livret n'existe pas ou n'est pas accessible."}),(0,b.jsx)(s.default,{href:"/portal/portfolios",children:(0,b.jsx)(h.Button,{children:"Retour à mes livrets"})})]})})});let E=y.template,F=y.student;return(0,b.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-4xl print:max-w-none print:py-0",children:[(0,b.jsx)(u.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-6 print:hidden",children:(0,b.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,b.jsx)(s.default,{href:"/portal/portfolios",children:(0,b.jsx)(h.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(j.ArrowLeft,{className:"h-5 w-5"})})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:E?.name||"Livret d'apprentissage"}),y.session?.formations&&(0,b.jsx)("p",{className:"text-gray-600",children:y.session.formations.name})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(h.Button,{variant:"outline",onClick:()=>window.print(),children:[(0,b.jsx)(r.Printer,{className:"h-4 w-4 mr-2"}),"Imprimer"]}),y.pdf_url&&(0,b.jsx)("a",{href:y.pdf_url,target:"_blank",rel:"noopener noreferrer",children:(0,b.jsxs)(h.Button,{children:[(0,b.jsx)(k.Download,{className:"h-4 w-4 mr-2"}),"Télécharger PDF"]})})]})]})}),(0,b.jsx)(g.Card,{className:"mb-6 print:border-0 print:shadow-none",style:{borderTopWidth:4,borderTopColor:E?.primary_color||"#335ACF"},children:(0,b.jsx)(g.CardContent,{className:"py-6",children:(0,b.jsxs)("div",{className:"flex items-center gap-6",children:[(0,b.jsx)("div",{className:"w-20 h-20 rounded-xl flex items-center justify-center text-white text-2xl font-bold flex-shrink-0",style:{backgroundColor:E?.primary_color||"#335ACF"},children:F?.photo_url?(0,b.jsx)("img",{src:F.photo_url,alt:"",className:"w-20 h-20 rounded-xl object-cover"}):`${F?.first_name?.[0]}${F?.last_name?.[0]}`}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("h2",{className:"text-xl font-bold text-gray-900",children:[F?.first_name," ",F?.last_name]}),(0,b.jsx)("p",{className:"text-gray-600",children:F?.email}),y.session&&(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(l.BookOpen,{className:"h-4 w-4"}),y.session.name]}),(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(m.Calendar,{className:"h-4 w-4"}),(0,t.formatDate)(y.session.start_date)," - ",(0,t.formatDate)(y.session.end_date)]})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)(i.Badge,{className:(0,t.cn)("mb-2","validated"===y.status?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"),children:"validated"===y.status?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.CheckCircle2,{className:"h-3 w-3 mr-1"})," Validé"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Clock,{className:"h-3 w-3 mr-1"})," En cours"]})}),(0,b.jsxs)("div",{className:"text-3xl font-bold",style:{color:E?.primary_color||void 0},children:[Math.round(y.progress_percentage||0),"%"]}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Progression"})]})]})})}),(0,b.jsx)("div",{className:"space-y-6",children:E?.template_structure?.map((a,c)=>(0,b.jsx)(u.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*c},className:"print:break-inside-avoid",children:(0,b.jsxs)(g.Card,{className:"print:border print:shadow-none",children:[(0,b.jsxs)(g.CardHeader,{className:"print:py-3",style:{borderBottomWidth:2,borderBottomColor:E?.primary_color||void 0},children:[(0,b.jsxs)(g.CardTitle,{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-medium print:border print:border-gray-300 print:bg-white print:text-gray-700",style:{backgroundColor:E?.primary_color||void 0},children:c+1}),a.title]}),a.description&&(0,b.jsx)(g.CardDescription,{children:a.description})]}),(0,b.jsx)(g.CardContent,{className:"pt-6 print:pt-4",children:(0,b.jsx)("div",{className:"space-y-6 print:space-y-4",children:a.fields?.map(c=>{C(a.id,c.id);let d=D(a.id,c.id);return(0,b.jsxs)("div",{className:"print:break-inside-avoid",children:[(0,b.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-gray-700 block mb-1",children:c.label}),(0,b.jsx)("div",{className:"text-gray-900",children:((a,c)=>{let d=C(c,a.id);if(D(c,a.id),null==d||""===d)return(0,b.jsx)("span",{className:"text-gray-400 italic",children:"Non renseigné"});switch(a.type){case"checkbox":return d?(0,b.jsxs)("span",{className:"text-green-600 flex items-center gap-1",children:[(0,b.jsx)(n.CheckCircle2,{className:"h-4 w-4"})," Oui"]}):(0,b.jsx)("span",{className:"text-gray-500",children:"Non"});case"rating":let e=a.max||5;return(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[Array.from({length:e},(a,c)=>(0,b.jsx)(p.Star,{className:(0,t.cn)("h-5 w-5",c<d?"text-yellow-500 fill-current":"text-gray-300")},c)),(0,b.jsxs)("span",{className:"ml-2 text-gray-600",children:[d,"/",e]})]});case"competency":let f=(a.competencyLevels||["Non acquis","En cours","Acquis","Maîtrisé"]).indexOf(d);return(0,b.jsx)(i.Badge,{className:(0,t.cn)("text-sm",["bg-red-100 text-red-700","bg-yellow-100 text-yellow-700","bg-blue-100 text-blue-700","bg-green-100 text-green-700"][f]||"bg-gray-100 text-gray-700"),children:d});case"date":return(0,b.jsx)("span",{children:(0,t.formatDate)(d)});case"select":return(0,b.jsx)("span",{className:"font-medium",children:d});default:return(0,b.jsx)("span",{className:"whitespace-pre-wrap",children:d})}})(c,a.id)})]})}),d&&(0,b.jsxs)("div",{className:"mt-2 p-2 bg-gray-50 rounded text-sm text-gray-600 italic",children:[(0,b.jsx)("span",{className:"font-medium",children:"Commentaire :"})," ",d]})]},c.id)})})})]})},a.id))}),y.validated_at&&(0,b.jsx)(g.Card,{className:"mt-6 bg-green-50 border-green-200 print:bg-white",children:(0,b.jsx)(g.CardContent,{className:"py-4",children:(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(n.CheckCircle2,{className:"h-6 w-6 text-green-600"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-green-900",children:"Livret validé"}),(0,b.jsxs)("p",{className:"text-sm text-green-700",children:["Ce livret a été validé le ",(0,t.formatDate)(y.validated_at)]})]})]})})})}),(0,b.jsx)("div",{className:"hidden print:block mt-8 pt-4 border-t text-center text-sm text-gray-500",children:(0,b.jsxs)("p",{children:["Document généré le ",new Date().toLocaleDateString("fr-FR")," - ",E?.name]})})]})}a.s(["default",()=>v])}];

//# sourceMappingURL=_09018c0b._.js.map