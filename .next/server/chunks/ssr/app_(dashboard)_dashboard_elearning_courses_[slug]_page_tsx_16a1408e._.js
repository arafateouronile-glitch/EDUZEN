module.exports=[860503,a=>{"use strict";var b=a.i(187924),c=a.i(50944),d=a.i(433217),e=a.i(370025),f=a.i(937927),g=a.i(913216),h=a.i(266275),i=a.i(703130),j=a.i(340695),k=a.i(400210),l=a.i(325015),m=a.i(495756),n=a.i(821374),o=a.i(660246),p=a.i(641710),q=a.i(953722),r=a.i(93518),s=a.i(238246),t=a.i(497895),u=a.i(762180);function v(){let a=(0,c.useParams)(),v=(0,c.useRouter)(),w=a.slug,{user:x}=(0,g.useAuth)(),y=(0,f.useQueryClient)(),{data:z}=(0,d.useQuery)({queryKey:["course",w,x?.organization_id],queryFn:async()=>await h.elearningService.getCourseBySlug(w,x?.organization_id||""),enabled:!!w&&!!x?.organization_id}),{data:A}=(0,d.useQuery)({queryKey:["course-enrollment",z?.id,x?.id],queryFn:async()=>z?.id&&x?.id?(await h.elearningService.getStudentEnrollments(x.id)).find(a=>a.course_id===z.id):null,enabled:!!z?.id&&!!x?.id}),{data:B}=(0,d.useQuery)({queryKey:["course-rating-stats",z?.id],queryFn:async()=>await h.elearningService.getCourseRatingStats(z?.id||""),enabled:!!z?.id}),C=(0,e.useMutation)({mutationFn:async()=>{if(!z?.id||!x?.id)throw Error("Données manquantes");return h.elearningService.enrollInCourse(z.id,x.id)},onSuccess:()=>{y.invalidateQueries({queryKey:["course-enrollment"]}),y.invalidateQueries({queryKey:["my-enrollments"]}),v.push(`/dashboard/elearning/courses/${w}/learn`)}});if(!z)return(0,b.jsx)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:(0,b.jsx)("div",{className:"text-center py-12",children:"Chargement..."})});let D={};return z.lessons?.forEach(a=>{let b=a.section_id||"no-section";D[b]||(D[b]=[]),D[b].push(a)}),(0,b.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)(s.default,{href:"/dashboard/elearning",children:(0,b.jsxs)(j.Button,{variant:"ghost",size:"sm",className:"mb-4",children:[(0,b.jsx)(k.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Retour aux cours"]})})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2",children:[(0,b.jsxs)(i.Card,{className:"mb-6",children:[z.cover_image_url&&(0,b.jsx)("div",{className:"h-64 w-full overflow-hidden rounded-t-lg",children:(0,b.jsx)("img",{src:z.cover_image_url,alt:z.title,className:"w-full h-full object-cover"})}),(0,b.jsx)(i.CardHeader,{children:(0,b.jsx)("div",{className:"flex items-start justify-between",children:(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(i.CardTitle,{className:"text-3xl mb-2",children:z.title}),z.description&&(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:z.description}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,b.jsx)("span",{className:`px-2 py-1 rounded ${(a=>{switch(a){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(z.difficulty_level)}`,children:(a=>{switch(a){case"beginner":return"Débutant";case"intermediate":return"Intermédiaire";case"advanced":return"Avancé";default:return a}})(z.difficulty_level)}),z.estimated_duration_hours&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(p.Clock,{className:"h-4 w-4"}),(0,b.jsxs)("span",{children:[z.estimated_duration_hours," heures"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(o.Users,{className:"h-4 w-4"}),(0,b.jsxs)("span",{children:[z.total_students||0," étudiants"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(q.BookOpen,{className:"h-4 w-4"}),(0,b.jsxs)("span",{children:[z.total_lessons||0," leçons"]})]})]})]})})}),(0,b.jsx)(i.CardContent,{children:(0,b.jsx)("div",{className:"prose prose-sm max-w-none",children:z.description&&(0,b.jsx)(u.default,{children:z.description})})})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsx)(i.CardTitle,{children:"Contenu du cours"})}),(0,b.jsx)(i.CardContent,{children:z.sections&&z.sections.length>0?(0,b.jsx)("div",{className:"space-y-6",children:z.sections.map(a=>{let c=D[a.id]||[];return(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-lg mb-3",children:a.title}),a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:a.description}),(0,b.jsx)("div",{className:"space-y-2",children:c.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:["video"===a.lesson_type?(0,b.jsx)(l.Play,{className:"h-5 w-5 text-primary"}):(0,b.jsx)(q.BookOpen,{className:"h-5 w-5 text-primary"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h4",{className:"font-medium",children:a.title}),a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-1",children:a.description}),a.video_duration_minutes&&(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[a.video_duration_minutes," min"]})]})]}),a.is_preview&&(0,b.jsx)("span",{className:"text-xs px-2 py-1 rounded bg-blue-100 text-blue-800",children:"Aperçu"}),A&&(0,b.jsx)(s.default,{href:`/dashboard/elearning/courses/${w}/lessons/${a.slug}`,children:(0,b.jsxs)(j.Button,{size:"sm",variant:"outline",children:[A.completed_lessons?.includes(parseInt(a.id))?(0,b.jsx)(m.CheckCircle,{className:"h-4 w-4 mr-2 text-green-600"}):(0,b.jsx)(l.Play,{className:"h-4 w-4 mr-2"}),A.completed_lessons?.includes(parseInt(a.id))?"Revoir":"Commencer"]})})]},a.id))})]},a.id)})}):z.lessons&&z.lessons.length>0?(0,b.jsx)("div",{className:"space-y-2",children:z.lessons.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:["video"===a.lesson_type?(0,b.jsx)(l.Play,{className:"h-5 w-5 text-primary"}):(0,b.jsx)(q.BookOpen,{className:"h-5 w-5 text-primary"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h4",{className:"font-medium",children:a.title}),a.video_duration_minutes&&(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[a.video_duration_minutes," min"]})]})]}),A&&(0,b.jsx)(s.default,{href:`/dashboard/elearning/courses/${w}/lessons/${a.slug}`,children:(0,b.jsxs)(j.Button,{size:"sm",variant:"outline",children:[(0,b.jsx)(l.Play,{className:"h-4 w-4 mr-2"}),"Commencer"]})})]},a.id))}):(0,b.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Aucune leçon disponible"})})]}),z.reviews&&z.reviews.length>0&&(0,b.jsxs)(i.Card,{className:"mt-6",children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsx)(i.CardTitle,{children:"Avis des étudiants"})}),(0,b.jsx)(i.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:z.reviews.slice(0,5).map(a=>(0,b.jsxs)("div",{className:"border-b pb-4 last:border-0 last:pb-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("div",{className:"flex items-center",children:[1,2,3,4,5].map(c=>(0,b.jsx)(n.Star,{className:`h-4 w-4 ${c<=(a.rating||0)?"text-yellow-500 fill-yellow-500":"text-gray-300"}`},c))}),(0,b.jsx)("span",{className:"text-sm font-medium",children:a.student?.full_name||a.student?.email||"Utilisateur"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:(0,t.formatDate)(a.created_at)})]}),a.review_text&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.review_text})]},a.id))})})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsx)(i.CardTitle,{children:"Actions"})}),(0,b.jsx)(i.CardContent,{children:A?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:"Progression"}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:[Math.round(A.progress_percentage||0),"%"]})]}),(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all",style:{width:`${A.progress_percentage||0}%`}})})]}),(0,b.jsx)(s.default,{href:`/dashboard/elearning/courses/${w}/learn`,children:(0,b.jsxs)(j.Button,{className:"w-full",children:[(0,b.jsx)(l.Play,{className:"h-4 w-4 mr-2"}),"Continuer le cours"]})}),"completed"===A.enrollment_status&&(0,b.jsxs)(j.Button,{variant:"outline",className:"w-full",children:[(0,b.jsx)(r.Award,{className:"h-4 w-4 mr-2"}),"Télécharger le certificat"]})]}):(0,b.jsx)(j.Button,{className:"w-full",onClick:()=>C.mutate(),disabled:C.isPending,children:C.isPending?"Inscription...":"S'inscrire au cours"})})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsx)(i.CardTitle,{children:"Informations"})}),(0,b.jsxs)(i.CardContent,{className:"space-y-3 text-sm",children:[z.instructor&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Instructeur:"}),(0,b.jsx)("p",{className:"font-medium",children:z.instructor.full_name||z.instructor.email})]}),z.published_at&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Publié le:"}),(0,b.jsx)("p",{className:"font-medium",children:(0,t.formatDate)(z.published_at)})]}),B&&B.total>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Note moyenne:"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Star,{className:"h-4 w-4 text-yellow-500 fill-yellow-500"}),(0,b.jsxs)("span",{className:"font-medium",children:[B.average.toFixed(1)," / 5"]}),(0,b.jsxs)("span",{className:"text-muted-foreground",children:["(",B.total," avis)"]})]})]})]})]})]})]})]})}a.s(["default",()=>v])}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_elearning_courses_%5Bslug%5D_page_tsx_16a1408e._.js.map