module.exports=[400210,a=>{"use strict";let b=(0,a.i(170106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],400210)},219897,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);a.i(460355);var e=a.i(346271);let f=c.forwardRef(({className:a,variant:c="default",hoverable:f=!1,glow:g=!1,glowColor:h="rgba(51, 90, 207, 0.3)",...i},j)=>(0,b.jsxs)(e.motion.div,{ref:j,className:(0,d.cn)("relative rounded-2xl border backdrop-blur-xl transition-all duration-300",{"bg-white/70 dark:bg-gray-900/70 border-white/20 dark:border-gray-700/30 shadow-lg":"default"===c,"bg-white/80 dark:bg-gray-900/80 border-white/30 dark:border-gray-700/40 shadow-xl":"premium"===c,"bg-white/50 dark:bg-gray-900/50 border-white/10 dark:border-gray-700/20 shadow-md":"subtle"===c,"cursor-pointer":f,"hover:shadow-2xl hover:scale-[1.02]":f,"hover:bg-white/90 dark:hover:bg-gray-900/90":f},a),whileHover:f?{scale:1.02,y:-2}:void 0,transition:{type:"spring",stiffness:300,damping:30},...i,children:[g&&(0,b.jsx)(e.motion.div,{className:"absolute inset-0 rounded-2xl opacity-0 blur-xl",style:{background:`radial-gradient(circle, ${h} 0%, transparent 70%)`},animate:{opacity:[0,.5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"}}),(0,b.jsx)("div",{className:"relative z-10",children:i.children})]}));f.displayName="GlassCard",a.s(["GlassCard",()=>f])},495756,a=>{"use strict";let b=(0,a.i(170106).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],495756)},114548,a=>{"use strict";let b=(0,a.i(170106).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);a.s(["Save",()=>b],114548)},790166,a=>{"use strict";let b=(0,a.i(170106).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);a.s(["DollarSign",()=>b],790166)},426099,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getAllPrograms(a,b){let c=this.supabase.from("programs").select("*").eq("organization_id",a);b?.isActive!==void 0&&(c=c.eq("is_active",b.isActive)),b?.search&&(c=c.or(`name.ilike.%${b.search}%,code.ilike.%${b.search}%,description.ilike.%${b.search}%`));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e)throw e;return d}async getProgramById(a){let{data:b,error:c}=await this.supabase.from("programs").select(`
        *,
        formations(*)
      `).eq("id",a).single();if(c)throw c;return b}async createProgram(a){let{data:b,error:c}=await this.supabase.from("programs").insert(a).select().single();if(c)throw c;return b}async updateProgram(a,b){let{data:c,error:d}=await this.supabase.from("programs").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteProgram(a){return this.updateProgram(a,{is_active:!1})}async getFormationsByProgram(a){let{data:b,error:c}=await this.supabase.from("formations").select("*").eq("program_id",a).order("created_at",{ascending:!1});if(c)throw c;return b}async getGlobalStats(a){let{data:b,error:c}=await this.supabase.from("programs").select("id, is_active, created_at").eq("organization_id",a);if(c)throw c;let d=b||[],e=d.length,f=d.filter(a=>a.is_active).length,g=d.filter(a=>!a.is_active).length,h=0,i=d.map(a=>a.id);if(i.length>0){let{count:a,error:b}=await this.supabase.from("formations").select("*",{count:"exact",head:!0}).in("program_id",i);if(b)throw b;h=a||0}let j=0;if(i.length>0){let{data:a,error:b}=await this.supabase.from("formations").select("id").in("program_id",i);if(b)throw b;let c=a?.map(a=>a.id)||[];if(c.length>0){let{count:a,error:b}=await this.supabase.from("sessions").select("*",{count:"exact",head:!0}).in("formation_id",c);if(b)throw b;j=a||0}}let k=0;if(i.length>0){let{data:a,error:b}=await this.supabase.from("formations").select("id").in("program_id",i);if(b)throw b;let c=a?.map(a=>a.id)||[];if(c.length>0){let{data:a,error:b}=await this.supabase.from("sessions").select("id").in("formation_id",c);if(b)throw b;let d=a?.map(a=>a.id)||[];if(d.length>0){let{count:a,error:b}=await this.supabase.from("enrollments").select("*",{count:"exact",head:!0}).in("session_id",d);if(b)throw b;k=a||0}}}let l=[{name:"Actifs",value:f,color:"#335ACF"},{name:"Inactifs",value:g,color:"#6B7280"}].filter(a=>a.value>0),m={};return d.forEach(a=>{if(a.created_at){let b=new Date(a.created_at),c=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}`;m[c]=(m[c]||0)+1}}),{total:e,active:f,inactive:g,totalFormations:h,totalSessions:j,totalEnrollments:k,statusData:l,monthlyData:Object.entries(m).sort(([a],[b])=>a.localeCompare(b)).slice(-6).map(([a,b])=>({month:new Date(a+"-01").toLocaleDateString("fr-FR",{month:"short",year:"numeric"}),programmes:b}))}}};a.s(["programService",0,c])},705151,a=>{"use strict";let b=(0,a.i(170106).default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);a.s(["Copy",()=>b],705151)},437536,a=>{"use strict";var b=a.i(88780);let c=b.z.object({first_name:b.z.string().min(1,"Le prénom est requis").max(100,"Le prénom est trop long"),last_name:b.z.string().min(1,"Le nom est requis").max(100,"Le nom est trop long"),date_of_birth:b.z.string().optional().or(b.z.literal("")),gender:b.z.enum(["male","female","other"]).optional().or(b.z.literal("")),email:b.z.string().email("Email invalide").optional().or(b.z.literal("")),phone:b.z.string().optional().or(b.z.literal("")),address:b.z.string().optional().or(b.z.literal("")),city:b.z.string().optional().or(b.z.literal("")),class_id:b.z.string().optional().or(b.z.literal("")),enrollment_date:b.z.string().min(1,"La date d'inscription est requise"),guardian_first_name:b.z.string().min(1,"Le prénom du tuteur est requis"),guardian_last_name:b.z.string().min(1,"Le nom du tuteur est requis"),guardian_relationship:b.z.enum(["parent","guardian","other"]).default("parent"),guardian_phone_primary:b.z.string().min(1,"Le téléphone principal du tuteur est requis"),guardian_phone_secondary:b.z.string().optional().or(b.z.literal("")),guardian_email:b.z.string().email("Email invalide").optional().or(b.z.literal("")),guardian_address:b.z.string().optional().or(b.z.literal(""))});b.z.object({first_name:b.z.string().min(1,"Le prénom est requis").max(100,"Le prénom est trop long"),last_name:b.z.string().min(1,"Le nom est requis").max(100,"Le nom est trop long"),date_of_birth:b.z.string().optional().or(b.z.literal("")),gender:b.z.enum(["male","female","other"]).optional().or(b.z.literal("")),email:b.z.string().email("Email invalide").optional().or(b.z.literal("")),phone:b.z.string().optional().or(b.z.literal("")),address:b.z.string().optional().or(b.z.literal("")),city:b.z.string().optional().or(b.z.literal("")),class_id:b.z.string().optional().or(b.z.literal("")),enrollment_date:b.z.string().min(1,"La date d'inscription est requise"),status:b.z.enum(["active","inactive","graduated"]).default("active")});let d=b.z.object({code:b.z.string().min(1,"Le code est requis").max(50,"Le code est trop long"),name:b.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),subtitle:b.z.string().optional().or(b.z.literal("")),description:b.z.string().optional().or(b.z.literal("")),category:b.z.string().optional().or(b.z.literal("")),program_version:b.z.string().optional().or(b.z.literal("")),version_date:b.z.string().optional().or(b.z.literal("")),duration_hours:b.z.string().optional().or(b.z.literal("")),duration_days:b.z.string().optional().or(b.z.literal("")),photo_url:b.z.string().url("URL invalide").optional().or(b.z.literal("")),price:b.z.string().optional().or(b.z.literal("")),price_enterprise:b.z.string().optional().or(b.z.literal("")),price_individual:b.z.string().optional().or(b.z.literal("")),price_freelance:b.z.string().optional().or(b.z.literal("")),currency:b.z.string().default("XOF"),payment_plan:b.z.enum(["full","installment","free"]).default("full"),published_online:b.z.boolean().default(!1),is_public:b.z.boolean().default(!1),eligible_cpf:b.z.boolean().default(!1),cpf_code:b.z.string().optional().or(b.z.literal("")),modalities:b.z.string().optional().or(b.z.literal("")),training_action_type:b.z.string().optional().or(b.z.literal("")),pedagogical_objectives:b.z.string().optional().or(b.z.literal("")),learner_profile:b.z.string().optional().or(b.z.literal("")),training_content:b.z.string().optional().or(b.z.literal("")),execution_follow_up:b.z.string().optional().or(b.z.literal("")),certification_modalities:b.z.string().optional().or(b.z.literal("")),quality:b.z.string().optional().or(b.z.literal("")),accounting_product_config:b.z.string().optional().or(b.z.literal("")),edof_export_fields:b.z.string().optional().or(b.z.literal("")),competence_domains:b.z.string().optional().or(b.z.literal("")),prerequisites:b.z.string().optional().or(b.z.literal("")),capacity_max:b.z.string().optional().or(b.z.literal("")),age_min:b.z.string().optional().or(b.z.literal("")),age_max:b.z.string().optional().or(b.z.literal("")),certification_issued:b.z.boolean().default(!1),is_active:b.z.boolean().default(!0)}),e=b.z.object({program_id:b.z.string().min(1,"Le programme est requis"),code:b.z.string().min(1,"Le code est requis").max(50,"Le code est trop long"),name:b.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),subtitle:b.z.string().optional().or(b.z.literal("")),photo_url:b.z.string().url("URL invalide").optional().or(b.z.literal("")),category:b.z.string().optional().or(b.z.literal("")),description:b.z.string().optional().or(b.z.literal("")),program_version:b.z.string().optional().or(b.z.literal("")),version_date:b.z.string().optional().or(b.z.literal("")),duration_hours:b.z.string().optional().or(b.z.literal("")),duration_days:b.z.string().optional().or(b.z.literal("")),duration_unit:b.z.enum(["hours","days"]).default("hours"),price:b.z.string().optional().or(b.z.literal("")),currency:b.z.string().default("XOF"),payment_plan:b.z.enum(["full","installment","free"]).default("full"),published_online:b.z.boolean().default(!1),eligible_cpf:b.z.boolean().default(!1),cpf_code:b.z.string().optional().or(b.z.literal("")),modalities:b.z.string().optional().or(b.z.literal("")),training_action_type:b.z.string().optional().or(b.z.literal("")),pedagogical_objectives:b.z.string().optional().or(b.z.literal("")),learner_profile:b.z.string().optional().or(b.z.literal("")),training_content:b.z.string().optional().or(b.z.literal("")),execution_follow_up:b.z.string().optional().or(b.z.literal("")),certification_modalities:b.z.string().optional().or(b.z.literal("")),quality:b.z.string().optional().or(b.z.literal("")),accounting_product_config:b.z.string().optional().or(b.z.literal("")),edof_export_fields:b.z.string().optional().or(b.z.literal("")),competence_domains:b.z.string().optional().or(b.z.literal("")),prerequisites:b.z.string().optional().or(b.z.literal("")),capacity_max:b.z.string().optional().or(b.z.literal("")),age_min:b.z.string().optional().or(b.z.literal("")),age_max:b.z.string().optional().or(b.z.literal("")),certification_issued:b.z.boolean().default(!1),is_active:b.z.boolean().default(!0)}),f=b.z.object({formation_id:b.z.string().min(1,"La formation est requise"),name:b.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),code:b.z.string().optional().or(b.z.literal("")),start_date:b.z.string().min(1,"La date de début est requise"),end_date:b.z.string().min(1,"La date de fin est requise"),start_time:b.z.string().optional().or(b.z.literal("")),end_time:b.z.string().optional().or(b.z.literal("")),location:b.z.string().optional().or(b.z.literal("")),capacity_max:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseInt(a);return!isNaN(b)&&b>0},"La capacité maximale doit être un nombre entier positif"),currency:b.z.string().default("XOF"),status:b.z.enum(["planned","ongoing","completed","cancelled"]).default("planned"),teacher_id:b.z.string().optional().or(b.z.literal("")),manager1_id:b.z.string().optional().or(b.z.literal("")),manager2_id:b.z.string().optional().or(b.z.literal("")),inter_entreprise:b.z.boolean().default(!0),sous_traitance:b.z.boolean().default(!1),timezone:b.z.string().default("Europe/Paris"),program_ids:b.z.array(b.z.string()).default([])}).refine(a=>!a.start_date||!a.end_date||new Date(a.end_date)>=new Date(a.start_date),{message:"La date de fin doit être postérieure à la date de début",path:["end_date"]}),g=b.z.object({student_id:b.z.string().min(1,"L'étudiant est requis"),session_id:b.z.string().optional().or(b.z.literal("")),subject:b.z.string().min(1,"Le sujet est requis").max(200,"Le sujet est trop long"),assessment_type:b.z.enum(["pre_formation","hot","cold","manager","instructor","funder","quiz","exam","project","other"]).default("quiz"),score:b.z.string().min(1,"La note est requise").refine(a=>{let b=parseFloat(a);return!isNaN(b)&&b>=0},"La note doit être un nombre valide"),max_score:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>0},"La note maximale doit être un nombre valide supérieur à 0"),notes:b.z.string().optional().or(b.z.literal("")),graded_at:b.z.string().min(1,"La date d'évaluation est requise"),coefficient:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>0},"Le coefficient doit être un nombre valide supérieur à 0"),is_makeup:b.z.boolean().optional().default(!1),original_grade_id:b.z.string().optional().or(b.z.literal("")),appreciation:b.z.string().optional().or(b.z.literal("")),term_period:b.z.enum(["Q1","Q2","Q3","Q4","S1","S2","T1","T2","T3"]).optional().or(b.z.literal("")),academic_year_id:b.z.string().optional().or(b.z.literal(""))}).refine(a=>!a.max_score||!a.score||parseFloat(a.score)<=parseFloat(a.max_score),{message:"La note ne peut pas être supérieure à la note maximale",path:["score"]}),h=b.z.object({student_id:b.z.string().min(1,"L'étudiant est requis"),document_type:b.z.enum(["quote","invoice"]).default("invoice"),invoice_number:b.z.string().optional().or(b.z.literal("")),type:b.z.enum(["tuition","registration","other"]).default("tuition"),issue_date:b.z.string().min(1,"La date d'émission est requise"),due_date:b.z.string().min(1,"La date d'échéance est requise"),amount:b.z.string().min(1,"Le montant est requis").refine(a=>{let b=parseFloat(a);return!isNaN(b)&&b>=0},"Le montant doit être un nombre valide supérieur ou égal à 0"),tax_amount:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>=0},"Le montant de la taxe doit être un nombre valide supérieur ou égal à 0"),currency:b.z.string().default("XOF"),status:b.z.enum(["draft","sent","partial","paid","overdue","cancelled"]).default("draft"),notes:b.z.string().optional().or(b.z.literal("")),enrollment_id:b.z.string().optional().or(b.z.literal(""))}).refine(a=>!a.issue_date||!a.due_date||new Date(a.due_date)>=new Date(a.issue_date),{message:"La date d'échéance doit être postérieure à la date d'émission",path:["due_date"]});b.z.object({invoice_id:b.z.string().min(1,"La facture est requise"),student_id:b.z.string().min(1,"L'étudiant est requis"),amount:b.z.string().min(1,"Le montant est requis").refine(a=>{let b=parseFloat(a);return!isNaN(b)&&b>0},"Le montant doit être un nombre valide supérieur à 0"),currency:b.z.string().default("XOF"),payment_method:b.z.enum(["cash","mobile_money","card","bank_transfer"]).default("cash"),payment_provider:b.z.enum(["mtn","orange","airtel","wave"]).optional().or(b.z.literal("")),transaction_id:b.z.string().optional().or(b.z.literal("")),paid_at:b.z.string().optional().or(b.z.literal("")),notes:b.z.string().optional().or(b.z.literal(""))});let i=b.z.object({student_id:b.z.string().min(1,"L'étudiant est requis"),session_id:b.z.string().min(1,"La session est requise"),enrollment_date:b.z.string().min(1,"La date d'inscription est requise"),status:b.z.enum(["pending","confirmed","completed","cancelled","failed"]).default("confirmed"),payment_status:b.z.enum(["pending","partial","paid","overdue"]).default("pending"),total_amount:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>=0},"Le montant total doit être un nombre valide supérieur ou égal à 0"),paid_amount:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>=0},"Le montant payé doit être un nombre valide supérieur ou égal à 0")}).refine(a=>{if(a.total_amount&&a.paid_amount){let b=parseFloat(a.total_amount),c=parseFloat(a.paid_amount);if(!isNaN(b)&&!isNaN(c)&&c>b)return!1}return!0},{message:"Le montant payé ne peut pas dépasser le montant total",path:["paid_amount"]});a.s(["enrollmentSchema",0,i,"evaluationSchema",0,g,"formationSchema",0,e,"invoiceSchema",0,h,"programSchema",0,d,"sessionSchema",0,f,"studentSchema",0,c])},555074,a=>{"use strict";var b=a.i(269240);let c=async(a,b)=>(console.warn("videoconferenceService.createMeetingForSession not implemented"),null),d=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getAllSessions(a,b){let c=this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",a);b?.formationId&&(c=c.eq("formation_id",b.formationId)),b?.status&&(c=c.eq("status",b.status)),b?.startDate&&(c=c.gte("start_date",b.startDate)),b?.endDate&&(c=c.lte("end_date",b.endDate)),b?.search&&(c=c.ilike("name",`%${b.search}%`));let{data:d,error:e}=await c.order("start_date",{ascending:!0});if(e)throw e;return d}async getSessionById(a){let{data:b,error:c}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("id",a).single();if(c)throw c;let{data:d,error:e}=await this.supabase.from("session_programs").select(`
        program_id,
        programs(*)
      `).eq("session_id",a);if(e)throw e;return{...b,session_programs:d?.map(a=>a.programs).filter(Boolean)||[]}}async createSession(a,b,c){if(a.formation_id){let{data:b,error:c}=await this.supabase.from("formations").select("id, organization_id").eq("id",a.formation_id).single();if(c)throw console.error("Erreur lors de la vérification de la formation:",c),Error(`Formation non trouv\xe9e: ${c.message}`);if(!b)throw Error("Formation non trouvée");console.log("Formation trouvée:",b)}let{data:d,error:e}=await this.supabase.from("sessions").insert(a).select().single();if(e)throw console.error("Erreur RLS lors de la création de la session:",{code:e.code,message:e.message,details:e.details,hint:e.hint,formation_id:a.formation_id}),e;if(b&&b.length>0&&d){let{data:a}=await this.supabase.from("formations").select("organization_id").eq("id",d.formation_id).single();if(a){let c=b.map(b=>({session_id:d.id,program_id:b,organization_id:a.organization_id})),{error:e}=await this.supabase.from("session_programs").insert(c);e&&console.error("Erreur lors de la création des associations session-programme:",e),a.organization_id&&await this.syncWithCalendars(d.id,a.organization_id,"create").catch(a=>{console.error("Erreur lors de la synchronisation calendrier:",a)}),a.organization_id&&await this.createVideoconferenceMeeting(d.id,a.organization_id).catch(a=>{console.error("Erreur lors de la création de la réunion visioconférence:",a)})}}return console.log("Session créée avec succès:",d),d}async updateSessionPrograms(a,b,c){let{error:d}=await this.supabase.from("session_programs").delete().eq("session_id",a);if(d)throw d;if(b.length>0){let d=b.map(b=>({session_id:a,program_id:b,organization_id:c})),{error:e}=await this.supabase.from("session_programs").insert(d);if(e)throw e}return!0}async getSessionPrograms(a){let{data:b,error:c}=await this.supabase.from("session_programs").select(`
        program_id,
        programs(*)
      `).eq("session_id",a);if(c)throw c;return b?.map(a=>a.programs).filter(Boolean)||[]}async updateSession(a,b){let{data:c}=await this.supabase.from("sessions").select("formation_id, formations(organization_id)").eq("id",a).single(),{data:d,error:e}=await this.supabase.from("sessions").update(b).eq("id",a).select().single();if(e)throw e;let f=c?.formations;return c&&f?.organization_id&&await this.syncWithCalendars(a,f.organization_id,"update").catch(a=>{console.error("Erreur lors de la synchronisation calendrier:",a)}),d}async deleteSession(a){let{data:b}=await this.supabase.from("sessions").select("formation_id, formations(organization_id)").eq("id",a).single(),c=b?.formations;b&&c?.organization_id&&await this.syncWithCalendars(a,c.organization_id,"delete").catch(a=>{console.error("Erreur lors de la suppression de l'événement calendrier:",a)});let{error:d}=await this.supabase.from("sessions").delete().eq("id",a);if(d)throw d}async createVideoconferenceMeeting(a,b){let{data:d}=await this.supabase.from("videoconference_integrations").select("*").eq("organization_id",b).eq("is_active",!0).eq("auto_create_meetings",!0);if(d&&0!==d.length)for(let e of d)try{await c(a,{organizationId:b,provider:e.provider})}catch(a){console.error(`Erreur lors de la cr\xe9ation de r\xe9union avec ${e.provider}:`,a)}}async syncWithCalendars(a,b,c){let{data:d}=await this.supabase.from("calendar_integrations").select("*").eq("organization_id",b).eq("is_active",!0).eq("sync_sessions",!0).eq("create_events_for_sessions",!0);if(d&&0!==d.length)for(let a of d)try{console.warn(`Calendar sync for ${c} not implemented yet for provider ${a.provider}`)}catch(b){console.error(`Erreur lors de la synchronisation avec ${a.provider}:`,b)}}async getUpcomingSessions(a,b=10){let c=new Date().toISOString().split("T")[0],{data:d,error:e}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",a).gte("start_date",c).eq("status","planned").order("start_date",{ascending:!0}).limit(b);if(e)throw e;return d}async getOngoingSessions(a){let b=new Date().toISOString().split("T")[0],{data:c,error:d}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",a).lte("start_date",b).gte("end_date",b).eq("status","ongoing").order("start_date",{ascending:!0});if(d)throw d;return c}async addSessionToFormations(a,b,c){let d=b.map((b,d)=>({session_id:a,formation_id:b,organization_id:c,order_index:d})),{data:e,error:f}=await this.supabase.from("formation_sessions").insert(d).select();if(f)throw f;return e}async removeSessionFromFormation(a,b){let{error:c}=await this.supabase.from("formation_sessions").delete().eq("session_id",a).eq("formation_id",b);if(c)throw c;return!0}async updateSessionFormations(a,b,c){let{error:d}=await this.supabase.from("formation_sessions").delete().eq("session_id",a);if(d)throw d;return b.length>0?this.addSessionToFormations(a,b,c):[]}async getSessionFormations(a){let{data:b,error:c}=await this.supabase.from("formation_sessions").select(`
        formation_id,
        order_index,
        formations(*)
      `).eq("session_id",a).order("order_index",{ascending:!0});if(c)throw c;return b?.map(a=>a.formations).filter(Boolean)||[]}async getFormationSessions(a){let{data:b,error:c}=await this.supabase.from("formation_sessions").select(`
        session_id,
        order_index,
        sessions(*)
      `).eq("formation_id",a).order("order_index",{ascending:!0});if(c)throw c;return b?.map(a=>a.sessions).filter(Boolean)||[]}async createIndependentSession(a,b,c){let{data:d,error:e}=await this.supabase.from("sessions").insert({...a,formation_id:null}).select().single();if(e)throw e;return b&&b.length>0&&d&&await this.updateSessionPrograms(d.id,b,a.organization_id),c&&c.length>0&&d&&await this.addSessionToFormations(d.id,c,a.organization_id),d}};a.s(["sessionService",0,d],555074)},337130,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getAllFormations(a,b){let c=this.supabase.from("formations").select(`
        *,
        programs(*)
      `).eq("organization_id",a);b?.programId&&(c=c.eq("program_id",b.programId)),b?.isActive!==void 0&&(c=c.eq("is_active",b.isActive)),b?.search&&(c=c.or(`name.ilike.%${b.search}%,code.ilike.%${b.search}%,description.ilike.%${b.search}%`));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e)throw e;return d}async getFormationById(a){let{data:b,error:c}=await this.supabase.from("formations").select(`
        *,
        programs(*),
        sessions(*)
      `).eq("id",a).single();if(c)throw c;return b}async createFormation(a){let{data:b,error:c}=await this.supabase.from("formations").insert(a).select().single();if(c)throw c;return b}async updateFormation(a,b){let{data:c,error:d}=await this.supabase.from("formations").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteFormation(a){return this.updateFormation(a,{is_active:!1})}async getSessionsByFormation(a){let{data:b,error:c}=await this.supabase.from("sessions").select("*").eq("formation_id",a).order("start_date",{ascending:!0});if(c)throw c;return b}async getAllSessionsForFormation(a){let{data:b,error:c}=await this.supabase.from("formation_sessions").select(`
        session_id,
        order_index,
        sessions(*)
      `).eq("formation_id",a).order("order_index",{ascending:!0});if(c)throw c;let{data:d,error:e}=await this.supabase.from("sessions").select("*").eq("formation_id",a).order("start_date",{ascending:!0});if(e)throw e;let f=b?.map(a=>a.sessions).filter(Boolean)||[],g=[...f],h=new Set(f.map(a=>a.id));for(let a of d||[])h.has(a.id)||g.push(a);return g}async addSessionsToFormation(a,b,c){let d=b.map((b,d)=>({formation_id:a,session_id:b,organization_id:c,order_index:d})),{data:e,error:f}=await this.supabase.from("formation_sessions").insert(d).select();if(f)throw f;return e}async removeSessionFromFormation(a,b){let{error:c}=await this.supabase.from("formation_sessions").delete().eq("formation_id",a).eq("session_id",b);if(c)throw c;return!0}async updateFormationSessions(a,b,c){let{error:d}=await this.supabase.from("formation_sessions").delete().eq("formation_id",a);if(d)throw d;return b.length>0?this.addSessionsToFormation(a,b,c):[]}async getFormationWithAllSessions(a){let b=await this.getFormationById(a);if(!b)return null;let c=await this.getAllSessionsForFormation(a);return{...b,all_sessions:c}}};a.s(["formationService",0,c])},501027,a=>{"use strict";let b=(0,a.i(170106).default)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);a.s(["Zap",()=>b],501027)},770536,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getBySessionId(a){let{data:b,error:c}=await this.supabase.from("session_slots").select("*").eq("session_id",a).order("date",{ascending:!0}).order("start_time",{ascending:!0});if(c)throw c;return b||[]}async getById(a){let{data:b,error:c}=await this.supabase.from("session_slots").select("*").eq("id",a).single();if(c)throw c;return b}async create(a){let{data:b,error:c}=await this.supabase.from("session_slots").insert(a).select().single();if(c)throw c;return b}async update(a,b){let{data:c,error:d}=await this.supabase.from("session_slots").update(b).eq("id",a).select().single();if(d)throw d;return c}async delete(a){let{error:b}=await this.supabase.from("session_slots").delete().eq("id",a);if(b)throw b}async generateSlots(a){let{sessionId:b,startDate:c,endDate:d,timeSlotType:e,morningStart:f,morningEnd:g,afternoonStart:h,afternoonEnd:i,location:j,teacherId:k,capacityMax:l}=a,m=f||"09:00",n=g||"12:00",o=h||"14:00",p=i||"17:00",q=[],r=new Date(c),s=new Date(d),t=new Date(r);for(;t<=s;){let a=t.getDay();0!==a&&6!==a&&q.push(t.toISOString().split("T")[0]),t.setDate(t.getDate()+1)}let u=[];for(let a of q)("morning"===e||"both"===e)&&u.push({session_id:b,date:a,time_slot:"morning",start_time:m,end_time:n,location:j||null,teacher_id:k||null,capacity_max:l||null}),("afternoon"===e||"both"===e)&&u.push({session_id:b,date:a,time_slot:"afternoon",start_time:o,end_time:p,location:j||null,teacher_id:k||null,capacity_max:l||null}),"full_day"===e&&u.push({session_id:b,date:a,time_slot:"full_day",start_time:m,end_time:p,location:j||null,teacher_id:k||null,capacity_max:l||null});let{error:v}=await this.supabase.from("session_slots").delete().eq("session_id",b);if(v)throw v;if(u.length>0){let{data:a,error:b}=await this.supabase.from("session_slots").insert(u).select();if(b)throw b;return a}return[]}async deleteBySessionId(a){let{error:b}=await this.supabase.from("session_slots").delete().eq("session_id",a);if(b)throw b}};a.s(["sessionSlotService",0,c])},574664,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getAll(a,b){let c=this.supabase.from("grades").select(`
        *,
        students(id, first_name, last_name, student_number),
        sessions(id, name, formations(name, programs(name))),
        users(id, full_name)
      `).eq("organization_id",a).order("graded_at",{ascending:!1});b?.sessionId&&(c=c.eq("session_id",b.sessionId)),b?.studentId&&(c=c.eq("student_id",b.studentId)),b?.subject&&(c=c.ilike("subject",`%${b.subject}%`)),b?.assessmentType&&(c=c.eq("assessment_type",b.assessmentType)),b?.startDate&&(c=c.gte("graded_at",b.startDate)),b?.endDate&&(c=c.lte("graded_at",b.endDate)),b?.termPeriod&&(c=c.eq("term_period",b.termPeriod)),b?.academicYearId&&(c=c.eq("academic_year_id",b.academicYearId)),b?.isMakeup!==void 0&&(c=c.eq("is_makeup",b.isMakeup));let{data:d,error:e}=await c;if(e&&("PGRST116"===e.code||e.message?.includes("relationship")||e.message?.includes("Could not find")||400===e.status)){let c=this.supabase.from("grades").select("*").eq("organization_id",a).order("graded_at",{ascending:!1});b?.sessionId&&(c=c.eq("session_id",b.sessionId)),b?.studentId&&(c=c.eq("student_id",b.studentId)),b?.subject&&(c=c.ilike("subject",`%${b.subject}%`)),b?.assessmentType&&(c=c.eq("assessment_type",b.assessmentType)),b?.startDate&&(c=c.gte("graded_at",b.startDate)),b?.endDate&&(c=c.lte("graded_at",b.endDate)),b?.termPeriod&&(c=c.eq("term_period",b.termPeriod)),b?.academicYearId&&(c=c.eq("academic_year_id",b.academicYearId)),b?.isMakeup!==void 0&&(c=c.eq("is_makeup",b.isMakeup));let{data:d,error:e}=await c;if(e)throw e;return d||[]}if(e)throw e;return d||[]}async getById(a){try{let{data:b,error:c}=await this.supabase.from("grades").select(`
          *,
          students(id, first_name, last_name, student_number),
          sessions(id, name, formations(name, programs(name))),
          users(id, full_name)
        `).eq("id",a).single();if(c){if("PGRST116"===c.code||c.message?.includes("relationship")||c.message?.includes("Could not find")||400===c.status){let{data:b,error:c}=await this.supabase.from("grades").select("*").eq("id",a).single();if(c)throw c;return b}throw c}return b}catch(a){throw a}}async create(a,b){let c=b.assessment_type,d={...b,organization_id:a,assessment_type:c,coefficient:b.coefficient??1,is_makeup:b.is_makeup??!1,graded_at:b.graded_at||new Date().toISOString()};delete d.percentage,Object.keys(d).forEach(a=>{void 0===d[a]&&(d[a]=null)});let e=["pre_formation","hot","cold","manager","instructor","funder","quiz","exam","project","other"];d.assessment_type&&!e.includes(d.assessment_type)&&(console.error("❌ [EVALUATION SERVICE] assessment_type invalide:",{received:d.assessment_type,validTypes:e}),d.assessment_type="other");let{data:f,error:g}=await this.supabase.from("grades").insert(d).select("id, subject, score, max_score, percentage, organization_id, session_id, student_id, teacher_id, assessment_type, notes, graded_at, created_at").single();if(g)throw console.error("Erreur insertion évaluation:",g),g;return f}async createMakeup(a,b,c){let d={...c,organization_id:a,coefficient:c.coefficient??1,is_makeup:!0,original_grade_id:b,graded_at:c.graded_at||new Date().toISOString()};delete d.percentage,Object.keys(d).forEach(a=>{void 0===d[a]&&(d[a]=null)});let{data:e,error:f}=await this.supabase.from("grades").insert(d).select("id, subject, score, max_score, percentage, organization_id, session_id, student_id, teacher_id, assessment_type, notes, graded_at, created_at").single();if(f)throw f;return e}async calculateWeightedAverage(a,b,c,d,e){let f=await this.getAll(a,{studentId:b,sessionId:c,termPeriod:d,academicYearId:e,isMakeup:!1});if(0===f.length)return null;let g=0,h=0;return(f.forEach(a=>{let b=a.coefficient||1,c=a.max_score||1,d=a.score;c>0&&null!=d&&(g+=d/c*20*b,h+=b)}),0===h)?null:Math.round(g/h*100)/100}async update(a,b){let c={...b,updated_at:new Date().toISOString()};delete c.percentage,Object.keys(c).forEach(a=>{void 0===c[a]&&delete c[a]});let{data:d,error:e}=await this.supabase.from("grades").update(c).eq("id",a).select("id, subject, score, max_score, percentage, organization_id, session_id, student_id, teacher_id, assessment_type, notes, graded_at, created_at, updated_at").single();if(e)throw e;return d}async delete(a){let{error:b}=await this.supabase.from("grades").delete().eq("id",a);if(b)throw b}async getStats(a,b){let c=await this.getAll(a,b),d={total:c.length,byType:{},averageScore:0,averagePercentage:0,bySubject:{}};if(0===c.length)return d;let e=0,f=0,g=0,h=0;return c.forEach(a=>{let b=a.assessment_type||"other";d.byType[b]=(d.byType[b]||0)+1;let c=a.subject;d.bySubject[c]||(d.bySubject[c]={count:0,average:0}),d.bySubject[c].count++,null!==a.score&&void 0!==a.score&&(e+=a.score),a.max_score&&(f+=a.max_score),null!==a.percentage&&void 0!==a.percentage&&(g+=a.percentage,h++)}),d.averageScore=f>0?e/c.length:0,d.averagePercentage=h>0?g/h:0,Object.keys(d.bySubject).forEach(a=>{let b=c.filter(b=>b.subject===a),e=b.reduce((a,b)=>a+(b.score||0),0);d.bySubject[a].average=e/b.length}),d}async createBulk(a,b){let c=b.map(b=>{let c={...b,organization_id:a,graded_at:b.graded_at||new Date().toISOString()};return delete c.percentage,Object.keys(c).forEach(a=>{void 0===c[a]&&(c[a]=null)}),c}),{data:d,error:e}=await this.supabase.from("grades").insert(c).select("*");if(e)throw e;if(!d||0===d.length)return[];try{let a=d.map(a=>a.id),{data:b,error:c}=await this.supabase.from("grades").select(`
          *,
          students(id, first_name, last_name, student_number),
          sessions(id, name),
          users(id, full_name)
        `).in("id",a);if(c)return d;return b||[]}catch{return d}}};a.s(["evaluationService",0,c])},323181,a=>{a.v(b=>Promise.all(["server/chunks/ssr/b33f8_(dashboard)_dashboard_sessions_[id]_sections_config-initialisation_tsx_58ed5c1c._.js"].map(b=>a.l(b))).then(()=>b(686556)))},719708,a=>{a.v(b=>Promise.all(["server/chunks/ssr/_bcb4fe7e._.js"].map(b=>a.l(b))).then(()=>b(556710)))},421867,a=>{a.v(b=>Promise.all(["server/chunks/ssr/app_(dashboard)_dashboard_sessions_[id]_sections_config-programme_tsx_d24b4721._.js"].map(b=>a.l(b))).then(()=>b(369157)))},138224,a=>{a.v(b=>Promise.all(["server/chunks/ssr/b33f8_(dashboard)_dashboard_sessions_[id]_sections_config-intervenants_tsx_7a63d0df._.js"].map(b=>a.l(b))).then(()=>b(209818)))},25389,a=>{a.v(b=>Promise.all(["server/chunks/ssr/_f73423ca._.js","server/chunks/ssr/app_(dashboard)_dashboard_sessions_[id]_sections_config-apprenants_tsx_fae5701b._.js"].map(b=>a.l(b))).then(()=>b(2534)))},116744,a=>{a.v(b=>Promise.all(["server/chunks/ssr/[root-of-the-server]__14e866ab._.js","server/chunks/ssr/_615fde3a._.js","server/chunks/ssr/[root-of-the-server]__20455782._.js","server/chunks/ssr/[root-of-the-server]__e7f3af61._.js","server/chunks/ssr/b33f8_(dashboard)_dashboard_sessions_[id]_hooks_use-document-generation_ts_5493718e._.js","server/chunks/ssr/node_modules_4fe0f0cc._.js"].map(b=>a.l(b))).then(()=>b(139966)))},533586,a=>{a.v(b=>Promise.all(["server/chunks/ssr/[root-of-the-server]__2bee6773._.js","server/chunks/ssr/_615fde3a._.js","server/chunks/ssr/[root-of-the-server]__20455782._.js","server/chunks/ssr/[root-of-the-server]__e7f3af61._.js","server/chunks/ssr/node_modules_4fe0f0cc._.js","server/chunks/ssr/b33f8_(dashboard)_dashboard_sessions_[id]_hooks_use-document-generation_ts_5493718e._.js"].map(b=>a.l(b))).then(()=>b(130755)))},580966,a=>{a.v(b=>Promise.all(["server/chunks/ssr/_edfb9b5c._.js"].map(b=>a.l(b))).then(()=>b(903001)))},852322,a=>{a.v(b=>Promise.all(["server/chunks/ssr/[root-of-the-server]__aa2dab29._.js","server/chunks/ssr/[root-of-the-server]__367b7c5a._.js","server/chunks/ssr/lib_7ae18ac0._.js","server/chunks/ssr/_5c6ec8d9._.js","server/chunks/ssr/[root-of-the-server]__e7f3af61._.js","server/chunks/ssr/app_(dashboard)_dashboard_sessions_[id]_sections_gestion-finances_tsx_b96e7105._.js","server/chunks/ssr/_615fde3a._.js","server/chunks/ssr/node_modules_4fe0f0cc._.js"].map(b=>a.l(b))).then(()=>b(101732)))},801877,a=>{a.v(b=>Promise.all(["server/chunks/ssr/[root-of-the-server]__3b8984be._.js","server/chunks/ssr/_615fde3a._.js","server/chunks/ssr/[root-of-the-server]__20455782._.js","server/chunks/ssr/[root-of-the-server]__e7f3af61._.js","server/chunks/ssr/node_modules_4fe0f0cc._.js","server/chunks/ssr/b33f8_(dashboard)_dashboard_sessions_[id]_hooks_use-document-generation_ts_5493718e._.js"].map(b=>a.l(b))).then(()=>b(735055)))},980508,a=>{a.v(b=>Promise.all(["server/chunks/ssr/_86b8c24f._.js"].map(b=>a.l(b))).then(()=>b(355709)))},109426,a=>{a.v(b=>Promise.all(["server/chunks/ssr/[root-of-the-server]__20455782._.js","server/chunks/ssr/b33f8_(dashboard)_dashboard_sessions_[id]_hooks_use-document-generation_ts_5493718e._.js","server/chunks/ssr/[root-of-the-server]__731bd6b7._.js","server/chunks/ssr/node_modules_4fe0f0cc._.js","server/chunks/ssr/[root-of-the-server]__e7f3af61._.js","server/chunks/ssr/app_(dashboard)_dashboard_sessions_[id]_sections_espace-apprenant_tsx_2a25f1ed._.js","server/chunks/ssr/_615fde3a._.js"].map(b=>a.l(b))).then(()=>b(385239)))},358959,a=>{a.v(b=>Promise.all(["server/chunks/ssr/[root-of-the-server]__20455782._.js","server/chunks/ssr/components_attendance_index_ts_6ea7a1a9._.js","server/chunks/ssr/_615fde3a._.js","server/chunks/ssr/b33f8_(dashboard)_dashboard_sessions_[id]_hooks_use-document-generation_ts_5493718e._.js","server/chunks/ssr/app_(dashboard)_dashboard_sessions_[id]_sections_suivi_tsx_a671acc5._.js","server/chunks/ssr/node_modules_a37906f3._.js","server/chunks/ssr/node_modules_bf42a7f9._.js","server/chunks/ssr/[root-of-the-server]__e7f3af61._.js","server/chunks/ssr/node_modules_4fe0f0cc._.js","server/chunks/ssr/node_modules_recharts_es6_cartesian_XAxis_8d432c24.js","server/chunks/ssr/[root-of-the-server]__d01b4ebb._.js"].map(b=>a.l(b))).then(()=>b(721111)))}];

//# sourceMappingURL=_0dd232a5._.js.map