module.exports=[224361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},814747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},915618,a=>{"use strict";let b=(0,a.i(170106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],915618)},641710,a=>{"use strict";let b=(0,a.i(170106).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],641710)},219897,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);a.i(460355);var e=a.i(346271);let f=c.forwardRef(({className:a,variant:c="default",hoverable:f=!1,glow:g=!1,glowColor:h="rgba(51, 90, 207, 0.3)",...i},j)=>(0,b.jsxs)(e.motion.div,{ref:j,className:(0,d.cn)("relative rounded-2xl border backdrop-blur-xl transition-all duration-300",{"bg-white/70 dark:bg-gray-900/70 border-white/20 dark:border-gray-700/30 shadow-lg":"default"===c,"bg-white/80 dark:bg-gray-900/80 border-white/30 dark:border-gray-700/40 shadow-xl":"premium"===c,"bg-white/50 dark:bg-gray-900/50 border-white/10 dark:border-gray-700/20 shadow-md":"subtle"===c,"cursor-pointer":f,"hover:shadow-2xl hover:scale-[1.02]":f,"hover:bg-white/90 dark:hover:bg-gray-900/90":f},a),whileHover:f?{scale:1.02,y:-2}:void 0,transition:{type:"spring",stiffness:300,damping:30},...i,children:[g&&(0,b.jsx)(e.motion.div,{className:"absolute inset-0 rounded-2xl opacity-0 blur-xl",style:{background:`radial-gradient(circle, ${h} 0%, transparent 70%)`},animate:{opacity:[0,.5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"}}),(0,b.jsx)("div",{className:"relative z-10",children:i.children})]}));f.displayName="GlassCard",a.s(["GlassCard",()=>f])},495756,a=>{"use strict";let b=(0,a.i(170106).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],495756)},54018,a=>{"use strict";let b=(0,a.i(170106).default)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],54018)},724669,a=>{"use strict";let b=(0,a.i(170106).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);a.s(["TrendingUp",()=>b],724669)},821374,a=>{"use strict";let b=(0,a.i(170106).default)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);a.s(["Star",()=>b],821374)},683245,a=>{"use strict";let b=(0,a.i(170106).default)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);a.s(["Edit",()=>b],683245)},427699,(a,b,c)=>{b.exports=a.x("events",()=>require("events"))},254799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},522734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},500874,(a,b,c)=>{b.exports=a.x("buffer",()=>require("buffer"))},688947,(a,b,c)=>{b.exports=a.x("stream",()=>require("stream"))},449719,(a,b,c)=>{b.exports=a.x("assert",()=>require("assert"))},406461,(a,b,c)=>{b.exports=a.x("zlib",()=>require("zlib"))},806368,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);a.i(460355);var e=a.i(346271);let f=c.forwardRef(({className:a,columns:c=4,gap:e="md",children:f,...g},h)=>(0,b.jsx)("div",{ref:h,className:(0,d.cn)("grid",{1:"grid-cols-1",2:"grid-cols-1 md:grid-cols-2",3:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3",4:"grid-cols-1 md:grid-cols-2 lg:grid-cols-4"}[c],{sm:"gap-4",md:"gap-6",lg:"gap-8"}[e],a),...g,children:f}));f.displayName="BentoGrid";let g=c.forwardRef(({className:a,span:c=1,rowSpan:f=1,children:g,...h},i)=>(0,b.jsx)(e.motion.div,{ref:i,className:(0,d.cn)({1:"col-span-1",2:"col-span-1 md:col-span-2",3:"col-span-1 md:col-span-2 lg:col-span-3",4:"col-span-1 md:col-span-2 lg:col-span-4"}[c],{1:"row-span-1",2:"row-span-1 md:row-span-2",3:"row-span-1 md:row-span-3"}[f],a),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:[.16,1,.3,1]},...h,children:g}));g.displayName="BentoCard",a.s(["BentoCard",()=>g,"BentoGrid",()=>f])},437536,a=>{"use strict";var b=a.i(88780);let c=b.z.object({first_name:b.z.string().min(1,"Le prénom est requis").max(100,"Le prénom est trop long"),last_name:b.z.string().min(1,"Le nom est requis").max(100,"Le nom est trop long"),date_of_birth:b.z.string().optional().or(b.z.literal("")),gender:b.z.enum(["male","female","other"]).optional().or(b.z.literal("")),email:b.z.string().email("Email invalide").optional().or(b.z.literal("")),phone:b.z.string().optional().or(b.z.literal("")),address:b.z.string().optional().or(b.z.literal("")),city:b.z.string().optional().or(b.z.literal("")),class_id:b.z.string().optional().or(b.z.literal("")),enrollment_date:b.z.string().min(1,"La date d'inscription est requise"),guardian_first_name:b.z.string().min(1,"Le prénom du tuteur est requis"),guardian_last_name:b.z.string().min(1,"Le nom du tuteur est requis"),guardian_relationship:b.z.enum(["parent","guardian","other"]).default("parent"),guardian_phone_primary:b.z.string().min(1,"Le téléphone principal du tuteur est requis"),guardian_phone_secondary:b.z.string().optional().or(b.z.literal("")),guardian_email:b.z.string().email("Email invalide").optional().or(b.z.literal("")),guardian_address:b.z.string().optional().or(b.z.literal(""))});b.z.object({first_name:b.z.string().min(1,"Le prénom est requis").max(100,"Le prénom est trop long"),last_name:b.z.string().min(1,"Le nom est requis").max(100,"Le nom est trop long"),date_of_birth:b.z.string().optional().or(b.z.literal("")),gender:b.z.enum(["male","female","other"]).optional().or(b.z.literal("")),email:b.z.string().email("Email invalide").optional().or(b.z.literal("")),phone:b.z.string().optional().or(b.z.literal("")),address:b.z.string().optional().or(b.z.literal("")),city:b.z.string().optional().or(b.z.literal("")),class_id:b.z.string().optional().or(b.z.literal("")),enrollment_date:b.z.string().min(1,"La date d'inscription est requise"),status:b.z.enum(["active","inactive","graduated"]).default("active")});let d=b.z.object({code:b.z.string().min(1,"Le code est requis").max(50,"Le code est trop long"),name:b.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),subtitle:b.z.string().optional().or(b.z.literal("")),description:b.z.string().optional().or(b.z.literal("")),category:b.z.string().optional().or(b.z.literal("")),program_version:b.z.string().optional().or(b.z.literal("")),version_date:b.z.string().optional().or(b.z.literal("")),duration_hours:b.z.string().optional().or(b.z.literal("")),duration_days:b.z.string().optional().or(b.z.literal("")),photo_url:b.z.string().url("URL invalide").optional().or(b.z.literal("")),price:b.z.string().optional().or(b.z.literal("")),price_enterprise:b.z.string().optional().or(b.z.literal("")),price_individual:b.z.string().optional().or(b.z.literal("")),price_freelance:b.z.string().optional().or(b.z.literal("")),currency:b.z.string().default("XOF"),payment_plan:b.z.enum(["full","installment","free"]).default("full"),published_online:b.z.boolean().default(!1),is_public:b.z.boolean().default(!1),eligible_cpf:b.z.boolean().default(!1),cpf_code:b.z.string().optional().or(b.z.literal("")),modalities:b.z.string().optional().or(b.z.literal("")),training_action_type:b.z.string().optional().or(b.z.literal("")),pedagogical_objectives:b.z.string().optional().or(b.z.literal("")),learner_profile:b.z.string().optional().or(b.z.literal("")),training_content:b.z.string().optional().or(b.z.literal("")),execution_follow_up:b.z.string().optional().or(b.z.literal("")),certification_modalities:b.z.string().optional().or(b.z.literal("")),quality:b.z.string().optional().or(b.z.literal("")),accounting_product_config:b.z.string().optional().or(b.z.literal("")),edof_export_fields:b.z.string().optional().or(b.z.literal("")),competence_domains:b.z.string().optional().or(b.z.literal("")),prerequisites:b.z.string().optional().or(b.z.literal("")),capacity_max:b.z.string().optional().or(b.z.literal("")),age_min:b.z.string().optional().or(b.z.literal("")),age_max:b.z.string().optional().or(b.z.literal("")),certification_issued:b.z.boolean().default(!1),is_active:b.z.boolean().default(!0)}),e=b.z.object({program_id:b.z.string().min(1,"Le programme est requis"),code:b.z.string().min(1,"Le code est requis").max(50,"Le code est trop long"),name:b.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),subtitle:b.z.string().optional().or(b.z.literal("")),photo_url:b.z.string().url("URL invalide").optional().or(b.z.literal("")),category:b.z.string().optional().or(b.z.literal("")),description:b.z.string().optional().or(b.z.literal("")),program_version:b.z.string().optional().or(b.z.literal("")),version_date:b.z.string().optional().or(b.z.literal("")),duration_hours:b.z.string().optional().or(b.z.literal("")),duration_days:b.z.string().optional().or(b.z.literal("")),duration_unit:b.z.enum(["hours","days"]).default("hours"),price:b.z.string().optional().or(b.z.literal("")),currency:b.z.string().default("XOF"),payment_plan:b.z.enum(["full","installment","free"]).default("full"),published_online:b.z.boolean().default(!1),eligible_cpf:b.z.boolean().default(!1),cpf_code:b.z.string().optional().or(b.z.literal("")),modalities:b.z.string().optional().or(b.z.literal("")),training_action_type:b.z.string().optional().or(b.z.literal("")),pedagogical_objectives:b.z.string().optional().or(b.z.literal("")),learner_profile:b.z.string().optional().or(b.z.literal("")),training_content:b.z.string().optional().or(b.z.literal("")),execution_follow_up:b.z.string().optional().or(b.z.literal("")),certification_modalities:b.z.string().optional().or(b.z.literal("")),quality:b.z.string().optional().or(b.z.literal("")),accounting_product_config:b.z.string().optional().or(b.z.literal("")),edof_export_fields:b.z.string().optional().or(b.z.literal("")),competence_domains:b.z.string().optional().or(b.z.literal("")),prerequisites:b.z.string().optional().or(b.z.literal("")),capacity_max:b.z.string().optional().or(b.z.literal("")),age_min:b.z.string().optional().or(b.z.literal("")),age_max:b.z.string().optional().or(b.z.literal("")),certification_issued:b.z.boolean().default(!1),is_active:b.z.boolean().default(!0)}),f=b.z.object({formation_id:b.z.string().min(1,"La formation est requise"),name:b.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),code:b.z.string().optional().or(b.z.literal("")),start_date:b.z.string().min(1,"La date de début est requise"),end_date:b.z.string().min(1,"La date de fin est requise"),start_time:b.z.string().optional().or(b.z.literal("")),end_time:b.z.string().optional().or(b.z.literal("")),location:b.z.string().optional().or(b.z.literal("")),capacity_max:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseInt(a);return!isNaN(b)&&b>0},"La capacité maximale doit être un nombre entier positif"),currency:b.z.string().default("XOF"),status:b.z.enum(["planned","ongoing","completed","cancelled"]).default("planned"),teacher_id:b.z.string().optional().or(b.z.literal("")),manager1_id:b.z.string().optional().or(b.z.literal("")),manager2_id:b.z.string().optional().or(b.z.literal("")),inter_entreprise:b.z.boolean().default(!0),sous_traitance:b.z.boolean().default(!1),timezone:b.z.string().default("Europe/Paris"),program_ids:b.z.array(b.z.string()).default([])}).refine(a=>!a.start_date||!a.end_date||new Date(a.end_date)>=new Date(a.start_date),{message:"La date de fin doit être postérieure à la date de début",path:["end_date"]}),g=b.z.object({student_id:b.z.string().min(1,"L'étudiant est requis"),session_id:b.z.string().optional().or(b.z.literal("")),subject:b.z.string().min(1,"Le sujet est requis").max(200,"Le sujet est trop long"),assessment_type:b.z.enum(["pre_formation","hot","cold","manager","instructor","funder","quiz","exam","project","other"]).default("quiz"),score:b.z.string().min(1,"La note est requise").refine(a=>{let b=parseFloat(a);return!isNaN(b)&&b>=0},"La note doit être un nombre valide"),max_score:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>0},"La note maximale doit être un nombre valide supérieur à 0"),notes:b.z.string().optional().or(b.z.literal("")),graded_at:b.z.string().min(1,"La date d'évaluation est requise"),coefficient:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>0},"Le coefficient doit être un nombre valide supérieur à 0"),is_makeup:b.z.boolean().optional().default(!1),original_grade_id:b.z.string().optional().or(b.z.literal("")),appreciation:b.z.string().optional().or(b.z.literal("")),term_period:b.z.enum(["Q1","Q2","Q3","Q4","S1","S2","T1","T2","T3"]).optional().or(b.z.literal("")),academic_year_id:b.z.string().optional().or(b.z.literal(""))}).refine(a=>!a.max_score||!a.score||parseFloat(a.score)<=parseFloat(a.max_score),{message:"La note ne peut pas être supérieure à la note maximale",path:["score"]}),h=b.z.object({student_id:b.z.string().min(1,"L'étudiant est requis"),document_type:b.z.enum(["quote","invoice"]).default("invoice"),invoice_number:b.z.string().optional().or(b.z.literal("")),type:b.z.enum(["tuition","registration","other"]).default("tuition"),issue_date:b.z.string().min(1,"La date d'émission est requise"),due_date:b.z.string().min(1,"La date d'échéance est requise"),amount:b.z.string().min(1,"Le montant est requis").refine(a=>{let b=parseFloat(a);return!isNaN(b)&&b>=0},"Le montant doit être un nombre valide supérieur ou égal à 0"),tax_amount:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>=0},"Le montant de la taxe doit être un nombre valide supérieur ou égal à 0"),currency:b.z.string().default("XOF"),status:b.z.enum(["draft","sent","partial","paid","overdue","cancelled"]).default("draft"),notes:b.z.string().optional().or(b.z.literal("")),enrollment_id:b.z.string().optional().or(b.z.literal(""))}).refine(a=>!a.issue_date||!a.due_date||new Date(a.due_date)>=new Date(a.issue_date),{message:"La date d'échéance doit être postérieure à la date d'émission",path:["due_date"]});b.z.object({invoice_id:b.z.string().min(1,"La facture est requise"),student_id:b.z.string().min(1,"L'étudiant est requis"),amount:b.z.string().min(1,"Le montant est requis").refine(a=>{let b=parseFloat(a);return!isNaN(b)&&b>0},"Le montant doit être un nombre valide supérieur à 0"),currency:b.z.string().default("XOF"),payment_method:b.z.enum(["cash","mobile_money","card","bank_transfer"]).default("cash"),payment_provider:b.z.enum(["mtn","orange","airtel","wave"]).optional().or(b.z.literal("")),transaction_id:b.z.string().optional().or(b.z.literal("")),paid_at:b.z.string().optional().or(b.z.literal("")),notes:b.z.string().optional().or(b.z.literal(""))});let i=b.z.object({student_id:b.z.string().min(1,"L'étudiant est requis"),session_id:b.z.string().min(1,"La session est requise"),enrollment_date:b.z.string().min(1,"La date d'inscription est requise"),status:b.z.enum(["pending","confirmed","completed","cancelled","failed"]).default("confirmed"),payment_status:b.z.enum(["pending","partial","paid","overdue"]).default("pending"),total_amount:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>=0},"Le montant total doit être un nombre valide supérieur ou égal à 0"),paid_amount:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>=0},"Le montant payé doit être un nombre valide supérieur ou égal à 0")}).refine(a=>{if(a.total_amount&&a.paid_amount){let b=parseFloat(a.total_amount),c=parseFloat(a.paid_amount);if(!isNaN(b)&&!isNaN(c)&&c>b)return!1}return!0},{message:"Le montant payé ne peut pas dépasser le montant total",path:["paid_amount"]});a.s(["enrollmentSchema",0,i,"evaluationSchema",0,g,"formationSchema",0,e,"invoiceSchema",0,h,"programSchema",0,d,"sessionSchema",0,f,"studentSchema",0,c])},581464,a=>{"use strict";let b=(0,a.i(170106).default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);a.s(["Filter",()=>b],581464)},574664,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getAll(a,b){let c=this.supabase.from("grades").select(`
        *,
        students(id, first_name, last_name, student_number),
        sessions(id, name, formations(name, programs(name))),
        users(id, full_name)
      `).eq("organization_id",a).order("graded_at",{ascending:!1});b?.sessionId&&(c=c.eq("session_id",b.sessionId)),b?.studentId&&(c=c.eq("student_id",b.studentId)),b?.subject&&(c=c.ilike("subject",`%${b.subject}%`)),b?.assessmentType&&(c=c.eq("assessment_type",b.assessmentType)),b?.startDate&&(c=c.gte("graded_at",b.startDate)),b?.endDate&&(c=c.lte("graded_at",b.endDate)),b?.termPeriod&&(c=c.eq("term_period",b.termPeriod)),b?.academicYearId&&(c=c.eq("academic_year_id",b.academicYearId)),b?.isMakeup!==void 0&&(c=c.eq("is_makeup",b.isMakeup));let{data:d,error:e}=await c;if(e&&("PGRST116"===e.code||e.message?.includes("relationship")||e.message?.includes("Could not find")||400===e.status)){let c=this.supabase.from("grades").select("*").eq("organization_id",a).order("graded_at",{ascending:!1});b?.sessionId&&(c=c.eq("session_id",b.sessionId)),b?.studentId&&(c=c.eq("student_id",b.studentId)),b?.subject&&(c=c.ilike("subject",`%${b.subject}%`)),b?.assessmentType&&(c=c.eq("assessment_type",b.assessmentType)),b?.startDate&&(c=c.gte("graded_at",b.startDate)),b?.endDate&&(c=c.lte("graded_at",b.endDate)),b?.termPeriod&&(c=c.eq("term_period",b.termPeriod)),b?.academicYearId&&(c=c.eq("academic_year_id",b.academicYearId)),b?.isMakeup!==void 0&&(c=c.eq("is_makeup",b.isMakeup));let{data:d,error:e}=await c;if(e)throw e;return d||[]}if(e)throw e;return d||[]}async getById(a){try{let{data:b,error:c}=await this.supabase.from("grades").select(`
          *,
          students(id, first_name, last_name, student_number),
          sessions(id, name, formations(name, programs(name))),
          users(id, full_name)
        `).eq("id",a).single();if(c){if("PGRST116"===c.code||c.message?.includes("relationship")||c.message?.includes("Could not find")||400===c.status){let{data:b,error:c}=await this.supabase.from("grades").select("*").eq("id",a).single();if(c)throw c;return b}throw c}return b}catch(a){throw a}}async create(a,b){let c=b.assessment_type,d={...b,organization_id:a,assessment_type:c,coefficient:b.coefficient??1,is_makeup:b.is_makeup??!1,graded_at:b.graded_at||new Date().toISOString()};delete d.percentage,Object.keys(d).forEach(a=>{void 0===d[a]&&(d[a]=null)});let e=["pre_formation","hot","cold","manager","instructor","funder","quiz","exam","project","other"];d.assessment_type&&!e.includes(d.assessment_type)&&(console.error("❌ [EVALUATION SERVICE] assessment_type invalide:",{received:d.assessment_type,validTypes:e}),d.assessment_type="other");let{data:f,error:g}=await this.supabase.from("grades").insert(d).select("id, subject, score, max_score, percentage, organization_id, session_id, student_id, teacher_id, assessment_type, notes, graded_at, created_at").single();if(g)throw console.error("Erreur insertion évaluation:",g),g;return f}async createMakeup(a,b,c){let d={...c,organization_id:a,coefficient:c.coefficient??1,is_makeup:!0,original_grade_id:b,graded_at:c.graded_at||new Date().toISOString()};delete d.percentage,Object.keys(d).forEach(a=>{void 0===d[a]&&(d[a]=null)});let{data:e,error:f}=await this.supabase.from("grades").insert(d).select("id, subject, score, max_score, percentage, organization_id, session_id, student_id, teacher_id, assessment_type, notes, graded_at, created_at").single();if(f)throw f;return e}async calculateWeightedAverage(a,b,c,d,e){let f=await this.getAll(a,{studentId:b,sessionId:c,termPeriod:d,academicYearId:e,isMakeup:!1});if(0===f.length)return null;let g=0,h=0;return(f.forEach(a=>{let b=a.coefficient||1,c=a.max_score||1,d=a.score;c>0&&null!=d&&(g+=d/c*20*b,h+=b)}),0===h)?null:Math.round(g/h*100)/100}async update(a,b){let c={...b,updated_at:new Date().toISOString()};delete c.percentage,Object.keys(c).forEach(a=>{void 0===c[a]&&delete c[a]});let{data:d,error:e}=await this.supabase.from("grades").update(c).eq("id",a).select("id, subject, score, max_score, percentage, organization_id, session_id, student_id, teacher_id, assessment_type, notes, graded_at, created_at, updated_at").single();if(e)throw e;return d}async delete(a){let{error:b}=await this.supabase.from("grades").delete().eq("id",a);if(b)throw b}async getStats(a,b){let c=await this.getAll(a,b),d={total:c.length,byType:{},averageScore:0,averagePercentage:0,bySubject:{}};if(0===c.length)return d;let e=0,f=0,g=0,h=0;return c.forEach(a=>{let b=a.assessment_type||"other";d.byType[b]=(d.byType[b]||0)+1;let c=a.subject;d.bySubject[c]||(d.bySubject[c]={count:0,average:0}),d.bySubject[c].count++,null!==a.score&&void 0!==a.score&&(e+=a.score),a.max_score&&(f+=a.max_score),null!==a.percentage&&void 0!==a.percentage&&(g+=a.percentage,h++)}),d.averageScore=f>0?e/c.length:0,d.averagePercentage=h>0?g/h:0,Object.keys(d.bySubject).forEach(a=>{let b=c.filter(b=>b.subject===a),e=b.reduce((a,b)=>a+(b.score||0),0);d.bySubject[a].average=e/b.length}),d}async createBulk(a,b){let c=b.map(b=>{let c={...b,organization_id:a,graded_at:b.graded_at||new Date().toISOString()};return delete c.percentage,Object.keys(c).forEach(a=>{void 0===c[a]&&(c[a]=null)}),c}),{data:d,error:e}=await this.supabase.from("grades").insert(c).select("*");if(e)throw e;if(!d||0===d.length)return[];try{let a=d.map(a=>a.id),{data:b,error:c}=await this.supabase.from("grades").select(`
          *,
          students(id, first_name, last_name, student_number),
          sessions(id, name),
          users(id, full_name)
        `).in("id",a);if(c)return d;return b||[]}catch{return d}}};a.s(["evaluationService",0,c])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__30e886a6._.js.map