module.exports=[421607,a=>{"use strict";var b=a.i(187924),c=a.i(323625),d=a.i(50944),e=a.i(572131),f=a.i(238246),g=a.i(497895),h=a.i(913216);a.i(460355);var i=a.i(346271),j=a.i(262036),k=a.i(630617),l=a.i(469769),m=a.i(941675),n=a.i(104720),o=a.i(776803),p=a.i(93518),q=a.i(911156),r=a.i(563588),s=a.i(546842),t=a.i(321161),u=a.i(220005),v=a.i(633508),w=a.i(71277);let x=[{name:"Tableau de bord",href:"/learner",icon:k.LayoutDashboard,description:"Vue d'ensemble"},{name:"Mes formations",href:"/learner/formations",icon:l.GraduationCap,description:"Parcours et sessions"},{name:"E-Learning",href:"/learner/elearning",icon:w.PlayCircle,description:"Cours en ligne"},{name:"Planning",href:"/learner/planning",icon:m.Calendar,description:"Emploi du temps"},{name:"Documents",href:"/learner/documents",icon:n.FileText,description:"Convocations, attestations"},{name:"Évaluations",href:"/learner/evaluations",icon:o.ClipboardCheck,description:"Quiz et questionnaires"},{name:"Certificats",href:"/learner/certificates",icon:p.Award,description:"Diplômes obtenus"},{name:"Paiements",href:"/learner/payments",icon:q.CreditCard,description:"Factures et règlements"},{name:"Messages",href:"/learner/messages",icon:r.MessageSquare,description:"Communication"}],y=[{name:"Mon profil",href:"/learner/profile",icon:s.User},{name:"Paramètres",href:"/learner/settings",icon:t.Settings}];function z({isOpen:a,onClose:c}){let e=(0,d.usePathname)(),{user:k,logout:m}=(0,h.useAuth)(),n=(0,b.jsxs)("div",{className:"flex flex-col h-full",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between h-16 px-6 border-b border-gray-100",children:[(0,b.jsxs)(f.default,{href:"/learner",className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-brand-blue to-indigo-600 flex items-center justify-center",children:(0,b.jsx)(l.GraduationCap,{className:"h-6 w-6 text-white"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"EDUZEN"}),(0,b.jsx)("p",{className:"text-[10px] text-gray-500 uppercase tracking-wider",children:"Espace Apprenant"})]})]}),(0,b.jsx)("button",{onClick:c,className:"lg:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors",children:(0,b.jsx)(v.X,{className:"h-5 w-5 text-gray-500"})})]}),(0,b.jsx)("div",{className:"px-4 py-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-xl bg-gradient-to-r from-brand-blue/5 to-indigo-50 border border-brand-blue/10",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-brand-blue/10 flex items-center justify-center",children:(0,b.jsxs)("span",{className:"text-brand-blue font-semibold",children:[k?.first_name?.[0],k?.last_name?.[0]]})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("p",{className:"text-sm font-semibold text-gray-900 truncate",children:[k?.first_name," ",k?.last_name]}),(0,b.jsx)("p",{className:"text-xs text-gray-500 truncate",children:k?.email})]})]})}),(0,b.jsxs)("nav",{className:"flex-1 px-3 py-2 space-y-1 overflow-y-auto",children:[(0,b.jsx)("div",{className:"px-3 py-2 text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Navigation"}),x.map(a=>{let d=e===a.href||"/learner"!==a.href&&e?.startsWith(a.href);return(0,b.jsxs)(f.default,{href:a.href,onClick:c,className:(0,g.cn)("group flex items-center gap-3 px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200",d?"bg-brand-blue text-white shadow-lg shadow-brand-blue/25":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[(0,b.jsx)(a.icon,{className:(0,g.cn)("h-5 w-5 flex-shrink-0 transition-colors",d?"text-white":"text-gray-400 group-hover:text-brand-blue")}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("span",{children:a.name}),!d&&(0,b.jsx)("p",{className:"text-[10px] text-gray-400 group-hover:text-gray-500 mt-0.5",children:a.description})]})]},a.name)}),(0,b.jsx)("div",{className:"px-3 py-2 mt-4 text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Compte"}),y.map(a=>{let d=e===a.href;return(0,b.jsxs)(f.default,{href:a.href,onClick:c,className:(0,g.cn)("group flex items-center gap-3 px-3 py-2.5 text-sm font-medium rounded-xl transition-all duration-200",d?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:[(0,b.jsx)(a.icon,{className:"h-5 w-5 flex-shrink-0 text-gray-400"}),a.name]},a.name)})]}),(0,b.jsx)("div",{className:"p-4 border-t border-gray-100",children:(0,b.jsxs)("button",{onClick:()=>m(),className:"w-full flex items-center gap-3 px-3 py-2.5 text-sm font-medium text-red-600 rounded-xl hover:bg-red-50 transition-all duration-200",children:[(0,b.jsx)(u.LogOut,{className:"h-5 w-5"}),"Déconnexion"]})})]});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"hidden lg:fixed lg:inset-y-0 lg:z-50 lg:flex lg:w-72 lg:flex-col",children:(0,b.jsx)("div",{className:"flex flex-col flex-grow bg-white/80 backdrop-blur-xl border-r border-gray-200/50 shadow-xl",children:n})}),(0,b.jsx)(j.AnimatePresence,{children:a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"lg:hidden fixed inset-0 z-50 bg-gray-900/50 backdrop-blur-sm",onClick:c}),(0,b.jsx)(i.motion.div,{initial:{x:-288},animate:{x:0},exit:{x:-288},transition:{type:"spring",damping:25,stiffness:200},className:"lg:hidden fixed inset-y-0 left-0 z-50 w-72 bg-white shadow-2xl",children:n})]})})]})}var A=a.i(433217),B=a.i(269240),C=a.i(523312),D=a.i(972692),E=a.i(587532),F=a.i(340695),G=a.i(205522);function H({onMenuClick:a}){let{user:c}=(0,h.useAuth)(),d=(0,B.createClient)(),[f,g]=(0,e.useState)(""),{data:i}=(0,A.useQuery)({queryKey:["learner-notifications-count",c?.id],queryFn:async()=>{if(!c?.id)return 0;let{count:a}=await d.from("notifications").select("*",{count:"exact",head:!0}).eq("user_id",c.id).eq("read",!1);return a||0},enabled:!!c?.id,staleTime:3e4});return(0,b.jsx)("header",{className:"sticky top-0 z-40 bg-white/80 backdrop-blur-xl border-b border-gray-200/50",children:(0,b.jsxs)("div",{className:"flex items-center justify-between h-16 px-4 sm:px-6 lg:px-8",children:[(0,b.jsx)("button",{onClick:a,className:"lg:hidden p-2 -ml-2 rounded-lg hover:bg-gray-100 transition-colors",children:(0,b.jsx)(D.Menu,{className:"h-6 w-6 text-gray-600"})}),(0,b.jsx)("div",{className:"hidden md:flex flex-1 max-w-md",children:(0,b.jsxs)("div",{className:"relative w-full",children:[(0,b.jsx)(E.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,b.jsx)(G.Input,{type:"search",placeholder:"Rechercher une formation, un cours...",value:f,onChange:a=>g(a.target.value),className:"pl-10 bg-gray-50/50 border-gray-200 focus:bg-white"})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(F.Button,{variant:"ghost",size:"icon",className:"md:hidden",children:(0,b.jsx)(E.Search,{className:"h-5 w-5"})}),(0,b.jsxs)(F.Button,{variant:"ghost",size:"icon",className:"relative",children:[(0,b.jsx)(C.Bell,{className:"h-5 w-5"}),i&&i>0&&(0,b.jsx)("span",{className:"absolute -top-1 -right-1 h-5 w-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:i>9?"9+":i})]}),(0,b.jsxs)("div",{className:"hidden sm:flex items-center gap-3 pl-3 border-l border-gray-200",children:[(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("p",{className:"text-sm font-semibold text-gray-900",children:[c?.first_name," ",c?.last_name]}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:"Apprenant"})]}),(0,b.jsxs)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-brand-blue to-indigo-600 flex items-center justify-center text-white font-semibold",children:[c?.first_name?.[0],c?.last_name?.[0]]})]})]})]})})}let I=[{name:"Accueil",href:"/learner",icon:k.LayoutDashboard},{name:"Formations",href:"/learner/formations",icon:l.GraduationCap},{name:"E-Learning",href:"/learner/elearning",icon:w.PlayCircle},{name:"Documents",href:"/learner/documents",icon:n.FileText},{name:"Profil",href:"/learner/profile",icon:s.User}];function J(){let a=(0,d.usePathname)();return(0,b.jsx)("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-gray-200 pb-safe",children:(0,b.jsx)("nav",{className:"flex items-center justify-around h-16",children:I.map(c=>{let d=a===c.href||"/learner"!==c.href&&a?.startsWith(c.href);return(0,b.jsxs)(f.default,{href:c.href,className:(0,g.cn)("flex flex-col items-center justify-center flex-1 h-full transition-colors",d?"text-brand-blue":"text-gray-500"),children:[(0,b.jsx)(c.icon,{className:(0,g.cn)("h-5 w-5 mb-1",d&&"text-brand-blue")}),(0,b.jsx)("span",{className:(0,g.cn)("text-[10px] font-medium",d&&"font-semibold"),children:c.name})]},c.name)})})})}var K=a.i(803594);let L=(0,a.i(170106).default)("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);var M=a.i(633591),N=a.i(669520);function O(){let{isOnline:a,isOfflineReady:c,pendingSyncs:d,syncPendingData:e}=(0,K.useOffline)();return(0,b.jsxs)(j.AnimatePresence,{children:[!a&&(0,b.jsx)(i.motion.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"fixed top-0 left-0 right-0 z-50 bg-amber-500 text-white px-4 py-2 shadow-lg",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(M.WifiOff,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"font-medium",children:"Mode hors ligne"}),c&&(0,b.jsx)("span",{className:"text-sm opacity-80",children:"• Données en cache disponibles"})]}),d>0&&(0,b.jsxs)("span",{className:"text-sm bg-white/20 px-2 py-1 rounded",children:[d," modification",d>1?"s":""," en attente"]})]})}),a&&d>0&&(0,b.jsx)(i.motion.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"fixed top-0 left-0 right-0 z-50 bg-brand-blue text-white px-4 py-2 shadow-lg",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(L,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"font-medium",children:"Connexion rétablie"}),(0,b.jsxs)("span",{className:"text-sm opacity-80",children:["• ",d," modification",d>1?"s":""," à synchroniser"]})]}),(0,b.jsxs)(F.Button,{size:"sm",variant:"secondary",onClick:e,className:"bg-white/20 hover:bg-white/30 text-white",children:[(0,b.jsx)(N.RefreshCw,{className:"h-4 w-4 mr-2"}),"Synchroniser"]})]})})]})}var P=a.i(526017);function Q({children:a}){let{student:f,isLoading:g,hasStudent:h,studentId:i}=(0,c.useLearnerContext)(),j=(0,d.useRouter)(),[k,l]=(0,e.useState)(!1),[m,n]=(0,e.useState)(!1);return((0,e.useEffect)(()=>{n(!0)},[]),(0,e.useEffect)(()=>{},[]),(0,e.useEffect)(()=>{m&&f?.id},[f?.id,m]),(0,e.useEffect)(()=>{if(m&&!g&&!h&&!i){let a=localStorage.getItem("learner_student_id");a&&j.push(`/learner/access/${a}`)}},[h,g,i,j,m]),!m||g)?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(P.Loader2,{className:"h-12 w-12 animate-spin text-brand-blue mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600 font-medium",children:"Chargement de votre espace..."})]})}):i||g?!i||g||f?i&&!f&&g?(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(P.Loader2,{className:"h-12 w-12 animate-spin text-brand-blue mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600 font-medium",children:"Chargement de votre espace..."})]})}):(0,b.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-indigo-50/50",children:[(0,b.jsx)(O,{}),(0,b.jsx)(z,{isOpen:k,onClose:()=>l(!1)}),(0,b.jsxs)("div",{className:"lg:pl-72",children:[(0,b.jsx)(H,{onMenuClick:()=>l(!0)}),(0,b.jsx)("main",{className:"py-6 px-4 sm:px-6 lg:px-8",children:a})]}),(0,b.jsx)(J,{})]}):(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(P.Loader2,{className:"h-12 w-12 animate-spin text-brand-blue mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600 font-medium",children:"Accès apprenant introuvable ou indisponible"}),(0,b.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,b.jsx)("p",{className:"text-gray-500 text-sm max-w-sm",children:'Soit le lien n\'est plus valide, soit la base n\'autorise pas encore la lecture de l\'apprenant. Cliquez sur "Réessayer" après avoir appliqué la migration RLS, ou "Recommencer".'}),(0,b.jsx)(F.Button,{className:"w-full",onClick:()=>{try{window.location.reload()}catch(a){}},children:"Réessayer"}),(0,b.jsx)(F.Button,{variant:"outline",className:"w-full",onClick:()=>{try{localStorage.removeItem("learner_student_id")}catch(a){}},children:"Recommencer"})]})]})}):(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(P.Loader2,{className:"h-12 w-12 animate-spin text-brand-blue mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600 font-medium",children:"Redirection..."})]})})}function R({children:a}){return(0,b.jsx)(c.LearnerProvider,{children:(0,b.jsx)(Q,{children:a})})}a.s(["default",()=>R],421607)}];

//# sourceMappingURL=app_%28learner%29_learner_layout_tsx_9e2571cf._.js.map