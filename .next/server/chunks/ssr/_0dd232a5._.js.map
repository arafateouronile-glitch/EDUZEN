{"version":3,"sources":["../../../../node_modules/lucide-react/src/icons/arrow-left.ts","../../../../components/ui/glass-card.tsx","../../../../node_modules/lucide-react/src/icons/check-circle.ts","../../../../node_modules/lucide-react/src/icons/save.ts","../../../../node_modules/lucide-react/src/icons/dollar-sign.ts","../../../../lib/services/program.service.ts","../../../../node_modules/lucide-react/src/icons/copy.ts","../../../../lib/validations/schemas.ts","../../../../lib/services/session.service.ts","../../../../lib/services/videoconference.service.ts","../../../../lib/services/formation.service.ts","../../../../node_modules/lucide-react/src/icons/zap.ts","../../../../lib/services/session-slot.service.ts","../../../../lib/services/evaluation.service.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ArrowLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTIgMTktNy03IDctNyIgLz4KICA8cGF0aCBkPSJNMTkgMTJINSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeft = createLucideIcon('ArrowLeft', [\n  ['path', { d: 'm12 19-7-7 7-7', key: '1l729n' }],\n  ['path', { d: 'M19 12H5', key: 'x3x0zl' }],\n]);\n\nexport default ArrowLeft;\n","'use client'\n\nimport * as React from 'react'\nimport { cn } from '@/lib/utils'\nimport { motion } from '@/components/ui/motion'\n\nexport interface GlassCardProps extends React.HTMLAttributes<HTMLDivElement> {\n  variant?: 'default' | 'premium' | 'subtle'\n  hoverable?: boolean\n  glow?: boolean\n  glowColor?: string\n}\n\nconst GlassCard = React.forwardRef<HTMLDivElement, GlassCardProps>(\n  ({ className, variant = 'default', hoverable = false, glow = false, glowColor = 'rgba(51, 90, 207, 0.3)', ...props }, ref) => {\n    return (\n      <motion.div\n        ref={ref}\n        className={cn(\n          'relative rounded-2xl border backdrop-blur-xl transition-all duration-300',\n          {\n            // Default variant\n            'bg-white/70 dark:bg-gray-900/70 border-white/20 dark:border-gray-700/30 shadow-lg': variant === 'default',\n            \n            // Premium variant with stronger glass effect\n            'bg-white/80 dark:bg-gray-900/80 border-white/30 dark:border-gray-700/40 shadow-xl': variant === 'premium',\n            \n            // Subtle variant\n            'bg-white/50 dark:bg-gray-900/50 border-white/10 dark:border-gray-700/20 shadow-md': variant === 'subtle',\n            \n            // Hoverable effects\n            'cursor-pointer': hoverable,\n            'hover:shadow-2xl hover:scale-[1.02]': hoverable,\n            'hover:bg-white/90 dark:hover:bg-gray-900/90': hoverable,\n          },\n          className\n        )}\n        whileHover={hoverable ? { scale: 1.02, y: -2 } : undefined}\n        transition={{ type: 'spring', stiffness: 300, damping: 30 }}\n        {...props}\n      >\n        {/* Glow effect */}\n        {glow && (\n          <motion.div\n            className=\"absolute inset-0 rounded-2xl opacity-0 blur-xl\"\n            style={{\n              background: `radial-gradient(circle, ${glowColor} 0%, transparent 70%)`,\n            }}\n            animate={{\n              opacity: [0, 0.5, 0],\n            }}\n            transition={{\n              duration: 3,\n              repeat: Infinity,\n              ease: 'easeInOut',\n            }}\n          />\n        )}\n        \n        {/* Content */}\n        <div className=\"relative z-10\">\n          {props.children}\n        </div>\n      </motion.div>\n    )\n  }\n)\nGlassCard.displayName = 'GlassCard'\n\nexport { GlassCard }\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name CheckCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjIgMTEuMDhWMTJhMTAgMTAgMCAxIDEtNS45My05LjE0IiAvPgogIDxwYXRoIGQ9Im05IDExIDMgM0wyMiA0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/check-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst CheckCircle = createLucideIcon('CheckCircle', [\n  ['path', { d: 'M22 11.08V12a10 10 0 1 1-5.93-9.14', key: 'g774vq' }],\n  ['path', { d: 'm9 11 3 3L22 4', key: '1pflzl' }],\n]);\n\nexport default CheckCircle;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Save\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTkgMjFINWEyIDIgMCAwIDEtMi0yVjVhMiAyIDAgMCAxIDItMmgxMWw1IDV2MTFhMiAyIDAgMCAxLTIgMnoiIC8+CiAgPHBvbHlsaW5lIHBvaW50cz0iMTcgMjEgMTcgMTMgNyAxMyA3IDIxIiAvPgogIDxwb2x5bGluZSBwb2ludHM9IjcgMyA3IDggMTUgOCIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/save\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Save = createLucideIcon('Save', [\n  ['path', { d: 'M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z', key: '1owoqh' }],\n  ['polyline', { points: '17 21 17 13 7 13 7 21', key: '1md35c' }],\n  ['polyline', { points: '7 3 7 8 15 8', key: '8nz8an' }],\n]);\n\nexport default Save;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name DollarSign\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8bGluZSB4MT0iMTIiIHgyPSIxMiIgeTE9IjIiIHkyPSIyMiIgLz4KICA8cGF0aCBkPSJNMTcgNUg5LjVhMy41IDMuNSAwIDAgMCAwIDdoNWEzLjUgMy41IDAgMCAxIDAgN0g2IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/dollar-sign\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst DollarSign = createLucideIcon('DollarSign', [\n  ['line', { x1: '12', x2: '12', y1: '2', y2: '22', key: '7eqyqh' }],\n  ['path', { d: 'M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6', key: '1b0p4s' }],\n]);\n\nexport default DollarSign;\n","import { createClient } from '@/lib/supabase/client'\nimport type { SupabaseClient } from '@supabase/supabase-js'\nimport { Database } from '@/types/database.types'\nimport type { TableRow, TableInsert, TableUpdate, FlexibleInsert, FlexibleUpdate } from '@/lib/types/supabase-helpers'\n\n// Types pour les vrais programmes (niveau 1)\ntype Program = TableRow<'programs'>\ntype ProgramInsert = TableInsert<'programs'>\ntype ProgramUpdate = TableUpdate<'programs'>\n\n/**\n * Service pour gérer les PROGRAMMES\n * Un programme contient plusieurs formations\n * Exemple : \"Programme de formation continue\" > \"Formation Excel\" > \"Session Hiver 2024\"\n */\nexport class ProgramService {\n  private supabase: SupabaseClient<Database>\n\n\n  constructor(supabaseClient?: SupabaseClient<Database>) {\n\n    this.supabase = supabaseClient || createClient()\n\n  }\n\n  /**\n   * Récupère tous les programmes d'une organisation\n   */\n  async getAllPrograms(organizationId: string, filters?: {\n    isActive?: boolean\n    search?: string\n  }) {\n    let query = this.supabase\n      .from('programs')\n      .select('*')\n      .eq('organization_id', organizationId)\n\n    if (filters?.isActive !== undefined) {\n      query = query.eq('is_active', filters.isActive)\n    }\n\n    if (filters?.search) {\n      query = query.or(`name.ilike.%${filters.search}%,code.ilike.%${filters.search}%,description.ilike.%${filters.search}%`)\n    }\n\n    const { data, error } = await query.order('created_at', { ascending: false })\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Récupère un programme par son ID avec ses formations\n   */\n  async getProgramById(id: string) {\n    const { data, error } = await this.supabase\n      .from('programs')\n      .select(`\n        *,\n        formations(*)\n      `)\n      .eq('id', id)\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Crée un nouveau programme\n   */\n  async createProgram(program: FlexibleInsert<'programs'>) {\n    const { data, error } = await this.supabase\n      .from('programs')\n      .insert(program as ProgramInsert)\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Met à jour un programme\n   */\n  async updateProgram(id: string, updates: FlexibleUpdate<'programs'>) {\n    const { data, error } = await this.supabase\n      .from('programs')\n      .update(updates as ProgramUpdate)\n      .eq('id', id)\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Supprime un programme (soft delete)\n   */\n  async deleteProgram(id: string) {\n    return this.updateProgram(id, { is_active: false })\n  }\n\n  /**\n   * Récupère toutes les formations d'un programme\n   */\n  async getFormationsByProgram(programId: string) {\n    const { data, error } = await this.supabase\n      .from('formations')\n      .select('*')\n      .eq('program_id', programId)\n      .order('created_at', { ascending: false })\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Récupère les statistiques globales des programmes pour une organisation\n   */\n  async getGlobalStats(organizationId: string) {\n    const { data: allPrograms, error } = await this.supabase\n      .from('programs')\n      .select('id, is_active, created_at')\n      .eq('organization_id', organizationId)\n\n    if (error) throw error\n\n    const programsArray = (allPrograms as Program[]) || []\n    const total = programsArray.length\n    const active = programsArray.filter((p) => p.is_active).length\n    const inactive = programsArray.filter((p) => !p.is_active).length\n\n    // Compter les formations\n    let totalFormations = 0\n    const programIds = programsArray.map((p) => p.id)\n    if (programIds.length > 0) {\n      const { count, error: formationsError } = await this.supabase\n        .from('formations')\n        .select('*', { count: 'exact', head: true })\n        .in('program_id', programIds)\n      if (formationsError) throw formationsError\n      totalFormations = count || 0\n    }\n\n    // Compter les sessions via les formations\n    let totalSessions = 0\n    if (programIds.length > 0) {\n      const { data: formations, error: formationsError } = await this.supabase\n        .from('formations')\n        .select('id')\n        .in('program_id', programIds)\n      if (formationsError) throw formationsError\n      const formationIds = (formations as Array<{ id: string }>)?.map((f) => f.id) || []\n      if (formationIds.length > 0) {\n        const { count, error: sessionsError } = await this.supabase\n          .from('sessions')\n          .select('*', { count: 'exact', head: true })\n          .in('formation_id', formationIds)\n        if (sessionsError) throw sessionsError\n        totalSessions = count || 0\n      }\n    }\n\n    // Compter les inscriptions\n    let totalEnrollments = 0\n    if (programIds.length > 0) {\n      const { data: formations, error: formationsError2 } = await this.supabase\n        .from('formations')\n        .select('id')\n        .in('program_id', programIds)\n      if (formationsError2) throw formationsError2\n      const formationIds = (formations as Array<{ id: string }>)?.map((f) => f.id) || []\n      if (formationIds.length > 0) {\n        const { data: sessions, error: sessionsError2 } = await this.supabase\n          .from('sessions')\n          .select('id')\n          .in('formation_id', formationIds)\n        if (sessionsError2) throw sessionsError2\n        const sessionIds = (sessions as Array<{ id: string }>)?.map((s) => s.id) || []\n        if (sessionIds.length > 0) {\n          const { count, error: enrollmentsError } = await this.supabase\n            .from('enrollments')\n            .select('*', { count: 'exact', head: true })\n            .in('session_id', sessionIds)\n          if (enrollmentsError) throw enrollmentsError\n          totalEnrollments = count || 0\n        }\n      }\n    }\n\n    // Grouper par statut pour le graphique\n    const statusData = [\n      { name: 'Actifs', value: active, color: '#335ACF' },\n      { name: 'Inactifs', value: inactive, color: '#6B7280' },\n    ].filter(item => item.value > 0)\n\n    // Grouper par mois pour le graphique d'évolution\n    const byMonth: Record<string, number> = {}\n    programsArray.forEach((p) => {\n      if (p.created_at) {\n        const date = new Date(p.created_at)\n        const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`\n        byMonth[monthKey] = (byMonth[monthKey] || 0) + 1\n      }\n    })\n\n    const monthlyData = Object.entries(byMonth)\n      .sort(([a], [b]) => a.localeCompare(b))\n      .slice(-6) // Derniers 6 mois\n      .map(([month, count]) => ({\n        month: new Date(month + '-01').toLocaleDateString('fr-FR', { month: 'short', year: 'numeric' }),\n        programmes: count,\n      }))\n\n    return {\n      total,\n      active,\n      inactive,\n      totalFormations,\n      totalSessions,\n      totalEnrollments,\n      statusData,\n      monthlyData,\n    }\n  }\n}\n\nexport const programService = new ProgramService()\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Copy\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cmVjdCB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHg9IjgiIHk9IjgiIHJ4PSIyIiByeT0iMiIgLz4KICA8cGF0aCBkPSJNNCAxNmMtMS4xIDAtMi0uOS0yLTJWNGMwLTEuMS45LTIgMi0yaDEwYzEuMSAwIDIgLjkgMiAyIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/copy\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Copy = createLucideIcon('Copy', [\n  ['rect', { width: '14', height: '14', x: '8', y: '8', rx: '2', ry: '2', key: '17jyea' }],\n  ['path', { d: 'M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2', key: 'zix9uf' }],\n]);\n\nexport default Copy;\n","import { z } from 'zod'\n\n// Schéma pour la création d'un étudiant\nexport const studentSchema = z.object({\n  first_name: z.string().min(1, 'Le prénom est requis').max(100, 'Le prénom est trop long'),\n  last_name: z.string().min(1, 'Le nom est requis').max(100, 'Le nom est trop long'),\n  date_of_birth: z.string().optional().or(z.literal('')),\n  gender: z.enum(['male', 'female', 'other']).optional().or(z.literal('')),\n  email: z.string().email('Email invalide').optional().or(z.literal('')),\n  phone: z.string().optional().or(z.literal('')),\n  address: z.string().optional().or(z.literal('')),\n  city: z.string().optional().or(z.literal('')),\n  class_id: z.string().optional().or(z.literal('')),\n  enrollment_date: z.string().min(1, 'La date d\\'inscription est requise'),\n  // Tuteur\n  guardian_first_name: z.string().min(1, 'Le prénom du tuteur est requis'),\n  guardian_last_name: z.string().min(1, 'Le nom du tuteur est requis'),\n  guardian_relationship: z.enum(['parent', 'guardian', 'other']).default('parent'),\n  guardian_phone_primary: z.string().min(1, 'Le téléphone principal du tuteur est requis'),\n  guardian_phone_secondary: z.string().optional().or(z.literal('')),\n  guardian_email: z.string().email('Email invalide').optional().or(z.literal('')),\n  guardian_address: z.string().optional().or(z.literal('')),\n})\n\n// Schéma pour la mise à jour d'un étudiant\nexport const studentUpdateSchema = z.object({\n  first_name: z.string().min(1, 'Le prénom est requis').max(100, 'Le prénom est trop long'),\n  last_name: z.string().min(1, 'Le nom est requis').max(100, 'Le nom est trop long'),\n  date_of_birth: z.string().optional().or(z.literal('')),\n  gender: z.enum(['male', 'female', 'other']).optional().or(z.literal('')),\n  email: z.string().email('Email invalide').optional().or(z.literal('')),\n  phone: z.string().optional().or(z.literal('')),\n  address: z.string().optional().or(z.literal('')),\n  city: z.string().optional().or(z.literal('')),\n  class_id: z.string().optional().or(z.literal('')),\n  enrollment_date: z.string().min(1, 'La date d\\'inscription est requise'),\n  status: z.enum(['active', 'inactive', 'graduated']).default('active'),\n})\n\n// Schéma pour la création d'un programme\nexport const programSchema = z.object({\n  code: z.string().min(1, 'Le code est requis').max(50, 'Le code est trop long'),\n  name: z.string().min(1, 'Le nom est requis').max(200, 'Le nom est trop long'),\n  subtitle: z.string().optional().or(z.literal('')),\n  description: z.string().optional().or(z.literal('')),\n  category: z.string().optional().or(z.literal('')),\n  program_version: z.string().optional().or(z.literal('')),\n  version_date: z.string().optional().or(z.literal('')),\n  duration_hours: z.string().optional().or(z.literal('')),\n  duration_days: z.string().optional().or(z.literal('')),\n  photo_url: z.string().url('URL invalide').optional().or(z.literal('')),\n  price: z.string().optional().or(z.literal('')), // Prix générique ou entreprise\n  price_enterprise: z.string().optional().or(z.literal('')),\n  price_individual: z.string().optional().or(z.literal('')),\n  price_freelance: z.string().optional().or(z.literal('')),\n  currency: z.string().default('XOF'),\n  payment_plan: z.enum(['full', 'installment', 'free']).default('full'),\n  published_online: z.boolean().default(false),\n  is_public: z.boolean().default(false),\n  eligible_cpf: z.boolean().default(false),\n  cpf_code: z.string().optional().or(z.literal('')),\n  modalities: z.string().optional().or(z.literal('')),\n  training_action_type: z.string().optional().or(z.literal('')),\n  pedagogical_objectives: z.string().optional().or(z.literal('')),\n  learner_profile: z.string().optional().or(z.literal('')),\n  training_content: z.string().optional().or(z.literal('')),\n  execution_follow_up: z.string().optional().or(z.literal('')),\n  certification_modalities: z.string().optional().or(z.literal('')),\n  quality: z.string().optional().or(z.literal('')),\n  accounting_product_config: z.string().optional().or(z.literal('')),\n  edof_export_fields: z.string().optional().or(z.literal('')),\n  competence_domains: z.string().optional().or(z.literal('')),\n  prerequisites: z.string().optional().or(z.literal('')),\n  capacity_max: z.string().optional().or(z.literal('')),\n  age_min: z.string().optional().or(z.literal('')),\n  age_max: z.string().optional().or(z.literal('')),\n  certification_issued: z.boolean().default(false),\n  is_active: z.boolean().default(true),\n})\n\n// Schéma pour la création d'une formation\nexport const formationSchema = z.object({\n  program_id: z.string().min(1, 'Le programme est requis'),\n  code: z.string().min(1, 'Le code est requis').max(50, 'Le code est trop long'),\n  name: z.string().min(1, 'Le nom est requis').max(200, 'Le nom est trop long'),\n  subtitle: z.string().optional().or(z.literal('')),\n  photo_url: z.string().url('URL invalide').optional().or(z.literal('')),\n  category: z.string().optional().or(z.literal('')),\n  description: z.string().optional().or(z.literal('')),\n  program_version: z.string().optional().or(z.literal('')),\n  version_date: z.string().optional().or(z.literal('')),\n  duration_hours: z.string().optional().or(z.literal('')),\n  duration_days: z.string().optional().or(z.literal('')),\n  duration_unit: z.enum(['hours', 'days']).default('hours'),\n  price: z.string().optional().or(z.literal('')),\n  currency: z.string().default('XOF'),\n  payment_plan: z.enum(['full', 'installment', 'free']).default('full'),\n  published_online: z.boolean().default(false),\n  eligible_cpf: z.boolean().default(false),\n  cpf_code: z.string().optional().or(z.literal('')),\n  modalities: z.string().optional().or(z.literal('')),\n  training_action_type: z.string().optional().or(z.literal('')),\n  pedagogical_objectives: z.string().optional().or(z.literal('')),\n  learner_profile: z.string().optional().or(z.literal('')),\n  training_content: z.string().optional().or(z.literal('')),\n  execution_follow_up: z.string().optional().or(z.literal('')),\n  certification_modalities: z.string().optional().or(z.literal('')),\n  quality: z.string().optional().or(z.literal('')),\n  accounting_product_config: z.string().optional().or(z.literal('')),\n  edof_export_fields: z.string().optional().or(z.literal('')),\n  competence_domains: z.string().optional().or(z.literal('')),\n  prerequisites: z.string().optional().or(z.literal('')),\n  capacity_max: z.string().optional().or(z.literal('')),\n  age_min: z.string().optional().or(z.literal('')),\n  age_max: z.string().optional().or(z.literal('')),\n  certification_issued: z.boolean().default(false),\n  is_active: z.boolean().default(true),\n})\n\n// Schéma pour la création d'une session\nexport const sessionSchema = z.object({\n  formation_id: z.string().min(1, 'La formation est requise'),\n  name: z.string().min(1, 'Le nom est requis').max(200, 'Le nom est trop long'),\n  code: z.string().optional().or(z.literal('')),\n  start_date: z.string().min(1, 'La date de début est requise'),\n  end_date: z.string().min(1, 'La date de fin est requise'),\n  start_time: z.string().optional().or(z.literal('')),\n  end_time: z.string().optional().or(z.literal('')),\n  location: z.string().optional().or(z.literal('')),\n  capacity_max: z.string().optional().or(z.literal('')).refine((val) => {\n    if (!val) return true\n    const num = parseInt(val)\n    return !isNaN(num) && num > 0\n  }, 'La capacité maximale doit être un nombre entier positif'),\n  currency: z.string().default('XOF'),\n  status: z.enum(['planned', 'ongoing', 'completed', 'cancelled']).default('planned'),\n  teacher_id: z.string().optional().or(z.literal('')),\n  manager1_id: z.string().optional().or(z.literal('')),\n  manager2_id: z.string().optional().or(z.literal('')),\n  inter_entreprise: z.boolean().default(true),\n  sous_traitance: z.boolean().default(false),\n  timezone: z.string().default('Europe/Paris'),\n  program_ids: z.array(z.string()).default([]),\n}).refine((data) => {\n  if (data.start_date && data.end_date) {\n    return new Date(data.end_date) >= new Date(data.start_date)\n  }\n  return true\n}, {\n  message: 'La date de fin doit être postérieure à la date de début',\n  path: ['end_date'],\n})\n\n// Schéma pour la création d'une évaluation\nexport const evaluationSchema = z.object({\n  student_id: z.string().min(1, 'L\\'étudiant est requis'),\n  session_id: z.string().optional().or(z.literal('')),\n  subject: z.string().min(1, 'Le sujet est requis').max(200, 'Le sujet est trop long'),\n  assessment_type: z.enum([\n    'pre_formation',\n    'hot',\n    'cold',\n    'manager',\n    'instructor',\n    'funder',\n    'quiz',\n    'exam',\n    'project',\n    'other',\n  ]).default('quiz'),\n  score: z.string().min(1, 'La note est requise').refine((val) => {\n    const num = parseFloat(val)\n    return !isNaN(num) && num >= 0\n  }, 'La note doit être un nombre valide'),\n  max_score: z.string().optional().or(z.literal('')).refine((val) => {\n    if (!val) return true\n    const num = parseFloat(val)\n    return !isNaN(num) && num > 0\n  }, 'La note maximale doit être un nombre valide supérieur à 0'),\n  notes: z.string().optional().or(z.literal('')),\n  graded_at: z.string().min(1, 'La date d\\'évaluation est requise'),\n  coefficient: z.string().optional().or(z.literal('')).refine((val) => {\n    if (!val) return true\n    const num = parseFloat(val)\n    return !isNaN(num) && num > 0\n  }, 'Le coefficient doit être un nombre valide supérieur à 0'),\n  is_makeup: z.boolean().optional().default(false),\n  original_grade_id: z.string().optional().or(z.literal('')),\n  appreciation: z.string().optional().or(z.literal('')),\n  term_period: z.enum(['Q1', 'Q2', 'Q3', 'Q4', 'S1', 'S2', 'T1', 'T2', 'T3']).optional().or(z.literal('')),\n  academic_year_id: z.string().optional().or(z.literal('')),\n}).refine((data) => {\n  if (data.max_score && data.score) {\n    const score = parseFloat(data.score)\n    const maxScore = parseFloat(data.max_score)\n    return score <= maxScore\n  }\n  return true\n}, {\n  message: 'La note ne peut pas être supérieure à la note maximale',\n  path: ['score'],\n})\n\n// Schéma pour la création d'une facture ou devis\nexport const invoiceSchema = z.object({\n  student_id: z.string().min(1, 'L\\'étudiant est requis'),\n  document_type: z.enum(['quote', 'invoice']).default('invoice'),\n  invoice_number: z.string().optional().or(z.literal('')), // Peut être généré automatiquement\n  type: z.enum(['tuition', 'registration', 'other']).default('tuition'),\n  issue_date: z.string().min(1, 'La date d\\'émission est requise'),\n  due_date: z.string().min(1, 'La date d\\'échéance est requise'),\n  amount: z.string().min(1, 'Le montant est requis').refine((val) => {\n    const num = parseFloat(val)\n    return !isNaN(num) && num >= 0\n  }, 'Le montant doit être un nombre valide supérieur ou égal à 0'),\n  tax_amount: z.string().optional().or(z.literal('')).refine((val) => {\n    if (!val) return true\n    const num = parseFloat(val)\n    return !isNaN(num) && num >= 0\n  }, 'Le montant de la taxe doit être un nombre valide supérieur ou égal à 0'),\n  currency: z.string().default('XOF'),\n  status: z.enum(['draft', 'sent', 'partial', 'paid', 'overdue', 'cancelled']).default('draft'),\n  notes: z.string().optional().or(z.literal('')),\n  enrollment_id: z.string().optional().or(z.literal('')),\n}).refine((data) => {\n  if (data.issue_date && data.due_date) {\n    return new Date(data.due_date) >= new Date(data.issue_date)\n  }\n  return true\n}, {\n  message: 'La date d\\'échéance doit être postérieure à la date d\\'émission',\n  path: ['due_date'],\n})\n\n// Schéma pour la création d'un paiement\nexport const paymentSchema = z.object({\n  invoice_id: z.string().min(1, 'La facture est requise'),\n  student_id: z.string().min(1, 'L\\'étudiant est requis'),\n  amount: z.string().min(1, 'Le montant est requis').refine((val) => {\n    const num = parseFloat(val)\n    return !isNaN(num) && num > 0\n  }, 'Le montant doit être un nombre valide supérieur à 0'),\n  currency: z.string().default('XOF'),\n  payment_method: z.enum(['cash', 'mobile_money', 'card', 'bank_transfer']).default('cash'),\n  payment_provider: z.enum(['mtn', 'orange', 'airtel', 'wave']).optional().or(z.literal('')),\n  transaction_id: z.string().optional().or(z.literal('')),\n  paid_at: z.string().optional().or(z.literal('')),\n  notes: z.string().optional().or(z.literal('')),\n})\n\n// Schéma pour l'inscription\nexport const enrollmentSchema = z.object({\n  student_id: z.string().min(1, 'L\\'étudiant est requis'),\n  session_id: z.string().min(1, 'La session est requise'),\n  enrollment_date: z.string().min(1, 'La date d\\'inscription est requise'),\n  status: z.enum(['pending', 'confirmed', 'completed', 'cancelled', 'failed']).default('confirmed'),\n  payment_status: z.enum(['pending', 'partial', 'paid', 'overdue']).default('pending'),\n  total_amount: z.string().optional().or(z.literal('')).refine((val) => {\n    if (!val) return true\n    const num = parseFloat(val)\n    return !isNaN(num) && num >= 0\n  }, 'Le montant total doit être un nombre valide supérieur ou égal à 0'),\n  paid_amount: z.string().optional().or(z.literal('')).refine((val) => {\n    if (!val) return true\n    const num = parseFloat(val)\n    return !isNaN(num) && num >= 0\n  }, 'Le montant payé doit être un nombre valide supérieur ou égal à 0'),\n}).refine((data) => {\n  // Vérifier que le montant payé ne dépasse pas le montant total\n  if (data.total_amount && data.paid_amount) {\n    const total = parseFloat(data.total_amount)\n    const paid = parseFloat(data.paid_amount)\n    if (!isNaN(total) && !isNaN(paid) && paid > total) {\n      return false\n    }\n  }\n  return true\n}, {\n  message: 'Le montant payé ne peut pas dépasser le montant total',\n  path: ['paid_amount'],\n})\n\n// Type helper pour extraire le type d'un schéma\nexport type StudentFormData = z.infer<typeof studentSchema>\nexport type StudentUpdateFormData = z.infer<typeof studentUpdateSchema>\nexport type ProgramFormData = z.infer<typeof programSchema>\nexport type FormationFormData = z.infer<typeof formationSchema>\nexport type SessionFormData = z.infer<typeof sessionSchema>\nexport type EvaluationFormData = z.infer<typeof evaluationSchema>\nexport type InvoiceFormData = z.infer<typeof invoiceSchema>\nexport type PaymentFormData = z.infer<typeof paymentSchema>\nexport type EnrollmentFormData = z.infer<typeof enrollmentSchema>\n\n\n\n\n\n\n\n\n\n\n\n\n","import { createClient } from '@/lib/supabase/client'\nimport type { SupabaseClient } from '@supabase/supabase-js'\nimport { calendarService } from './calendar.service'\nimport { videoconferenceService } from './videoconference.service'\nimport type { TableRow, TableInsert, TableUpdate, FlexibleInsert, FlexibleUpdate } from '@/lib/types/supabase-helpers'\n\n// Types pour les sessions (niveau 3)\ntype Session = TableRow<'sessions'>\ntype SessionInsert = TableInsert<'sessions'>\ntype SessionUpdate = TableUpdate<'sessions'>\n\n/**\n * Service pour gérer les SESSIONS\n * Une session appartient à une formation\n * Exemple : \"Session Hiver 2024\" (de la formation \"Excel avancé\")\n */\nexport class SessionService {\n  private supabase: SupabaseClient<any>\n\n\n  constructor(supabaseClient?: SupabaseClient<any>) {\n\n    this.supabase = supabaseClient || createClient()\n\n  }\n\n  /**\n   * Récupère toutes les sessions d'une organisation\n   */\n  async getAllSessions(organizationId: string, filters?: {\n    formationId?: string\n    status?: Session['status']\n    startDate?: string\n    endDate?: string\n    search?: string\n  }) {\n    let query = this.supabase\n      .from('sessions')\n      .select(`\n        *,\n        formations!inner(\n          *,\n          programs(*)\n        )\n      `)\n      .eq('formations.organization_id', organizationId)\n\n    if (filters?.formationId) {\n      query = query.eq('formation_id', filters.formationId)\n    }\n\n    if (filters?.status) {\n      query = query.eq('status', filters.status)\n    }\n\n    if (filters?.startDate) {\n      query = query.gte('start_date', filters.startDate)\n    }\n\n    if (filters?.endDate) {\n      query = query.lte('end_date', filters.endDate)\n    }\n\n    if (filters?.search) {\n      query = query.ilike('name', `%${filters.search}%`)\n    }\n\n    const { data, error } = await query.order('start_date', { ascending: true })\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Récupère une session par son ID avec sa formation, son programme (via formation) et tous ses programmes associés\n   */\n  async getSessionById(id: string) {\n    // Récupérer la session avec sa formation et son programme (relation indirecte)\n    const { data: session, error: sessionError } = await this.supabase\n      .from('sessions')\n      .select(`\n        *,\n        formations!inner(\n          *,\n          programs(*)\n        )\n      `)\n      .eq('id', id)\n      .single()\n\n    if (sessionError) throw sessionError\n\n    // Récupérer tous les programmes associés directement à cette session (relation many-to-many)\n    const { data: sessionPrograms, error: programsError } = await this.supabase\n      .from('session_programs')\n      .select(`\n        program_id,\n        programs(*)\n      `)\n      .eq('session_id', id)\n\n    if (programsError) throw programsError\n\n    // Ajouter les programmes associés à la session\n    return {\n      ...session,\n      session_programs: sessionPrograms?.map((sp: { programs: unknown }) => sp.programs).filter(Boolean) || [],\n    }\n  }\n\n  /**\n   * Crée une nouvelle session avec optionnellement plusieurs programmes associés\n   */\n  async createSession(session: FlexibleInsert<'sessions'>, programIds?: string[], organizationId?: string) {\n    // Vérifier d'abord que la formation existe et appartient à l'organisation de l'utilisateur\n    if (session.formation_id) {\n      const { data: formation, error: formationError } = await this.supabase\n        .from('formations')\n        .select('id, organization_id')\n        .eq('id', session.formation_id)\n        .single()\n\n      if (formationError) {\n        console.error('Erreur lors de la vérification de la formation:', formationError)\n        throw new Error(`Formation non trouvée: ${formationError.message}`)\n      }\n\n      if (!formation) {\n        throw new Error('Formation non trouvée')\n      }\n\n      console.log('Formation trouvée:', formation)\n    }\n\n    // Créer la session\n    const { data, error } = await this.supabase\n      .from('sessions')\n      .insert(session as SessionInsert)\n      .select()\n      .single()\n\n    if (error) {\n      console.error('Erreur RLS lors de la création de la session:', {\n        code: error.code,\n        message: error.message,\n        details: error.details,\n        hint: error.hint,\n        formation_id: session.formation_id,\n      })\n      throw error\n    }\n\n    // Si des programmes sont fournis, créer les associations\n    if (programIds && programIds.length > 0 && data) {\n      // Récupérer l'organization_id de la formation\n      const { data: formation } = await this.supabase\n        .from('formations')\n        .select('organization_id')\n        .eq('id', data.formation_id)\n        .single()\n\n      if (formation) {\n        const sessionPrograms = programIds.map((programId) => ({\n          session_id: data.id,\n          program_id: programId,\n          organization_id: formation.organization_id,\n        }))\n\n        const { error: linkError } = await this.supabase\n          .from('session_programs')\n          .insert(sessionPrograms)\n\n        if (linkError) {\n          console.error('Erreur lors de la création des associations session-programme:', linkError)\n          // Ne pas échouer complètement, mais logger l'erreur\n        }\n\n        // Synchroniser avec les calendriers si activé\n        if (formation.organization_id) {\n          await this.syncWithCalendars(data.id, formation.organization_id, 'create').catch((error) => {\n            console.error('Erreur lors de la synchronisation calendrier:', error)\n            // Ne pas échouer la création de session si la synchronisation échoue\n          })\n        }\n\n        // Créer une réunion visioconférence si activé\n        if (formation.organization_id) {\n          await this.createVideoconferenceMeeting(data.id, formation.organization_id).catch((error) => {\n            console.error('Erreur lors de la création de la réunion visioconférence:', error)\n            // Ne pas échouer la création de session si la création de réunion échoue\n          })\n        }\n      }\n    }\n\n    console.log('Session créée avec succès:', data)\n    return data\n  }\n\n  /**\n   * Met à jour les programmes associés à une session\n   */\n  async updateSessionPrograms(sessionId: string, programIds: string[], organizationId: string) {\n    // Supprimer toutes les associations existantes\n    const { error: deleteError } = await this.supabase\n      .from('session_programs')\n      .delete()\n      .eq('session_id', sessionId)\n\n    if (deleteError) throw deleteError\n\n    // Créer les nouvelles associations\n    if (programIds.length > 0) {\n      const sessionPrograms = programIds.map((programId) => ({\n        session_id: sessionId,\n        program_id: programId,\n        organization_id: organizationId,\n      }))\n\n      const { error: insertError } = await this.supabase\n        .from('session_programs')\n        .insert(sessionPrograms)\n\n      if (insertError) throw insertError\n    }\n\n    return true\n  }\n\n  /**\n   * Récupère tous les programmes associés à une session\n   */\n  async getSessionPrograms(sessionId: string) {\n    const { data, error } = await this.supabase\n      .from('session_programs')\n      .select(`\n        program_id,\n        programs(*)\n      `)\n      .eq('session_id', sessionId)\n\n    if (error) throw error\n    return data?.map((sp: { programs: unknown }) => sp.programs).filter(Boolean) || []\n  }\n\n  /**\n   * Met à jour une session\n   */\n  async updateSession(id: string, updates: FlexibleUpdate<'sessions'>) {\n    // Récupérer l'organization_id avant la mise à jour\n    const { data: existingSession } = await this.supabase\n      .from('sessions')\n      .select('formation_id, formations(organization_id)')\n      .eq('id', id)\n      .single()\n\n    const { data, error } = await this.supabase\n      .from('sessions')\n      .update(updates as SessionUpdate)\n      .eq('id', id)\n      .select()\n      .single()\n\n    if (error) throw error\n\n    // Synchroniser avec les calendriers si activé\n    const formation = existingSession?.formations as { organization_id?: string } | null\n    if (existingSession && formation?.organization_id) {\n      await this.syncWithCalendars(id, formation.organization_id, 'update').catch((error) => {\n        console.error('Erreur lors de la synchronisation calendrier:', error)\n      })\n    }\n\n    return data\n  }\n\n  /**\n   * Supprime une session\n   */\n  async deleteSession(id: string) {\n    // Récupérer l'organization_id avant la suppression\n    const { data: existingSession } = await this.supabase\n      .from('sessions')\n      .select('formation_id, formations(organization_id)')\n      .eq('id', id)\n      .single()\n\n    // Supprimer les événements calendrier si activé\n    const formation = existingSession?.formations as { organization_id?: string } | null\n    if (existingSession && formation?.organization_id) {\n      await this.syncWithCalendars(id, formation.organization_id, 'delete').catch((error) => {\n        console.error('Erreur lors de la suppression de l\\'événement calendrier:', error)\n      })\n    }\n\n    const { error } = await this.supabase\n      .from('sessions')\n      .delete()\n      .eq('id', id)\n\n    if (error) throw error\n  }\n\n  /**\n   * Crée une réunion visioconférence pour une session\n   */\n  private async createVideoconferenceMeeting(\n    sessionId: string,\n    organizationId: string\n  ): Promise<void> {\n    // Récupérer les intégrations visioconférence actives\n    const { data: integrations } = await this.supabase\n      .from('videoconference_integrations')\n      .select('*')\n      .eq('organization_id', organizationId)\n      .eq('is_active', true)\n      .eq('auto_create_meetings', true)\n\n    if (!integrations || integrations.length === 0) {\n      return // Pas d'intégrations actives\n    }\n\n    // Créer une réunion avec chaque système actif\n    for (const integration of integrations) {\n      try {\n        await videoconferenceService.createMeetingForSession(\n          sessionId,\n          { organizationId, provider: integration.provider as string }\n        )\n      } catch (error) {\n        console.error(`Erreur lors de la création de réunion avec ${integration.provider}:`, error)\n        // Continuer avec les autres intégrations même si une échoue\n      }\n    }\n  }\n\n  /**\n   * Synchronise une session avec les calendriers configurés\n   */\n  private async syncWithCalendars(\n    sessionId: string,\n    organizationId: string,\n    action: 'create' | 'update' | 'delete'\n  ): Promise<void> {\n    // Récupérer les intégrations calendrier actives\n    const { data: integrations } = await this.supabase\n      .from('calendar_integrations')\n      .select('*')\n      .eq('organization_id', organizationId)\n      .eq('is_active', true)\n      .eq('sync_sessions', true)\n      .eq('create_events_for_sessions', true)\n\n    if (!integrations || integrations.length === 0) {\n      return // Pas d'intégrations actives\n    }\n\n    // Synchroniser avec chaque calendrier\n    for (const integration of integrations) {\n      try {\n        // TODO: Implémenter deleteSessionEvent et syncSession dans CalendarService\n        // if (action === 'delete') {\n        //   await calendarService.deleteSessionEvent(\n        //     organizationId,\n        //     integration.provider as string,\n        //     sessionId\n        //   )\n        // } else {\n        //   await calendarService.syncSession(\n        //     organizationId,\n        //     integration.provider as string,\n        //     sessionId\n        //   )\n        // }\n        console.warn(`Calendar sync for ${action} not implemented yet for provider ${integration.provider}`)\n      } catch (error) {\n        console.error(`Erreur lors de la synchronisation avec ${integration.provider}:`, error)\n        // Continuer avec les autres intégrations même si une échoue\n      }\n    }\n  }\n\n  /**\n   * Récupère les sessions à venir\n   */\n  async getUpcomingSessions(organizationId: string, limit: number = 10) {\n    const today = new Date().toISOString().split('T')[0]\n    \n    const { data, error } = await this.supabase\n      .from('sessions')\n      .select(`\n        *,\n        formations!inner(\n          *,\n          programs(*)\n        )\n      `)\n      .eq('formations.organization_id', organizationId)\n      .gte('start_date', today)\n      .eq('status', 'planned')\n      .order('start_date', { ascending: true })\n      .limit(limit)\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Récupère les sessions en cours\n   */\n  async getOngoingSessions(organizationId: string) {\n    const today = new Date().toISOString().split('T')[0]\n    \n    const { data, error } = await this.supabase\n      .from('sessions')\n      .select(`\n        *,\n        formations!inner(\n          *,\n          programs(*)\n        )\n      `)\n      .eq('formations.organization_id', organizationId)\n      .lte('start_date', today)\n      .gte('end_date', today)\n      .eq('status', 'ongoing')\n      .order('start_date', { ascending: true })\n\n    if (error) throw error\n    return data\n  }\n\n  // ========== GESTION DES RELATIONS N:N FORMATION-SESSION ==========\n\n  /**\n   * Associe une session à une ou plusieurs formations\n   */\n  async addSessionToFormations(sessionId: string, formationIds: string[], organizationId: string) {\n    const formationSessions = formationIds.map((formationId, index) => ({\n      session_id: sessionId,\n      formation_id: formationId,\n      organization_id: organizationId,\n      order_index: index,\n    }))\n\n    const { data, error } = await this.supabase\n      .from('formation_sessions')\n      .insert(formationSessions)\n      .select()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Retire une session d'une formation\n   */\n  async removeSessionFromFormation(sessionId: string, formationId: string) {\n    const { error } = await this.supabase\n      .from('formation_sessions')\n      .delete()\n      .eq('session_id', sessionId)\n      .eq('formation_id', formationId)\n\n    if (error) throw error\n    return true\n  }\n\n  /**\n   * Met à jour les formations associées à une session\n   */\n  async updateSessionFormations(sessionId: string, formationIds: string[], organizationId: string) {\n    // Supprimer toutes les associations existantes\n    const { error: deleteError } = await this.supabase\n      .from('formation_sessions')\n      .delete()\n      .eq('session_id', sessionId)\n\n    if (deleteError) throw deleteError\n\n    // Créer les nouvelles associations\n    if (formationIds.length > 0) {\n      return this.addSessionToFormations(sessionId, formationIds, organizationId)\n    }\n\n    return []\n  }\n\n  /**\n   * Récupère toutes les formations associées à une session\n   */\n  async getSessionFormations(sessionId: string) {\n    const { data, error } = await this.supabase\n      .from('formation_sessions')\n      .select(`\n        formation_id,\n        order_index,\n        formations(*)\n      `)\n      .eq('session_id', sessionId)\n      .order('order_index', { ascending: true })\n\n    if (error) throw error\n    return data?.map((fs: { formations: unknown }) => fs.formations).filter(Boolean) || []\n  }\n\n  /**\n   * Récupère toutes les sessions d'une formation (via la table de liaison N:N)\n   */\n  async getFormationSessions(formationId: string) {\n    const { data, error } = await this.supabase\n      .from('formation_sessions')\n      .select(`\n        session_id,\n        order_index,\n        sessions(*)\n      `)\n      .eq('formation_id', formationId)\n      .order('order_index', { ascending: true })\n\n    if (error) throw error\n    return data?.map((fs: { sessions: unknown }) => fs.sessions).filter(Boolean) || []\n  }\n\n  /**\n   * Crée une session indépendante (sans formation obligatoire)\n   */\n  async createIndependentSession(\n    session: Omit<FlexibleInsert<'sessions'>, 'formation_id'> & { organization_id: string },\n    programIds?: string[],\n    formationIds?: string[]\n  ) {\n    // Créer la session sans formation_id\n    const { data, error } = await this.supabase\n      .from('sessions')\n      .insert({\n        ...session,\n        formation_id: null, // Pas de formation directe\n      } as SessionInsert)\n      .select()\n      .single()\n\n    if (error) throw error\n\n    // Associer les programmes si fournis\n    if (programIds && programIds.length > 0 && data) {\n      await this.updateSessionPrograms(data.id, programIds, session.organization_id)\n    }\n\n    // Associer les formations si fournies\n    if (formationIds && formationIds.length > 0 && data) {\n      await this.addSessionToFormations(data.id, formationIds, session.organization_id)\n    }\n\n    return data\n  }\n}\n\nexport const sessionService = new SessionService()\n\n\n\n\n\n\n\n\n\n\n\n","/**\n * Service pour gérer les vidéoconférences\n * TODO: Implémenter le service de vidéoconférence\n */\n\nexport const videoconferenceService = {\n  /**\n   * Crée une réunion vidéo pour une session\n   */\n  async createMeetingForSession(sessionId: string, options?: any) {\n    // TODO: Implémenter la création de réunion vidéo\n    console.warn('videoconferenceService.createMeetingForSession not implemented')\n    return null\n  },\n}\n","import { createClient } from '@/lib/supabase/client'\nimport type { SupabaseClient } from '@supabase/supabase-js'\nimport { Database } from '@/types/database.types'\nimport type { TableRow, TableInsert, TableUpdate, FlexibleInsert, FlexibleUpdate } from '@/lib/types/supabase-helpers'\n\n// Types pour les formations (niveau 2)\ntype Formation = TableRow<'formations'>\ntype FormationInsert = TableInsert<'formations'>\ntype FormationUpdate = TableUpdate<'formations'>\n\n/**\n * Service pour gérer les FORMATIONS\n * Une formation appartient à un programme et contient plusieurs sessions\n * Exemple : \"Formation Excel avancé\" (dans le programme \"Formation continue\")\n */\nexport class FormationService {\n  private supabase: SupabaseClient<Database>\n\n\n  constructor(supabaseClient?: SupabaseClient<Database>) {\n\n    this.supabase = supabaseClient || createClient()\n\n  }\n\n  /**\n   * Récupère toutes les formations d'une organisation\n   */\n  async getAllFormations(organizationId: string, filters?: {\n    programId?: string\n    isActive?: boolean\n    search?: string\n  }) {\n    let query = this.supabase\n      .from('formations')\n      .select(`\n        *,\n        programs(*)\n      `)\n      .eq('organization_id', organizationId)\n\n    if (filters?.programId) {\n      query = query.eq('program_id', filters.programId)\n    }\n\n    if (filters?.isActive !== undefined) {\n      query = query.eq('is_active', filters.isActive)\n    }\n\n    if (filters?.search) {\n      query = query.or(`name.ilike.%${filters.search}%,code.ilike.%${filters.search}%,description.ilike.%${filters.search}%`)\n    }\n\n    const { data, error } = await query.order('created_at', { ascending: false })\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Récupère une formation par son ID avec son programme et ses sessions\n   */\n  async getFormationById(id: string) {\n    const { data, error } = await this.supabase\n      .from('formations')\n      .select(`\n        *,\n        programs(*),\n        sessions(*)\n      `)\n      .eq('id', id)\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Crée une nouvelle formation\n   */\n  async createFormation(formation: FlexibleInsert<'formations'>) {\n    const { data, error } = await this.supabase\n      .from('formations')\n      .insert(formation as FormationInsert)\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Met à jour une formation\n   */\n  async updateFormation(id: string, updates: FlexibleUpdate<'formations'>) {\n    const { data, error } = await this.supabase\n      .from('formations')\n      .update(updates as FormationUpdate)\n      .eq('id', id)\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Supprime une formation (soft delete)\n   */\n  async deleteFormation(id: string) {\n    return this.updateFormation(id, { is_active: false })\n  }\n\n  /**\n   * Récupère toutes les sessions d'une formation (relation directe legacy)\n   */\n  async getSessionsByFormation(formationId: string) {\n    const { data, error } = await this.supabase\n      .from('sessions')\n      .select('*')\n      .eq('formation_id', formationId)\n      .order('start_date', { ascending: true })\n\n    if (error) throw error\n    return data\n  }\n\n  // ========== GESTION DES RELATIONS N:N FORMATION-SESSION ==========\n\n  /**\n   * Récupère toutes les sessions d'une formation (via la table de liaison N:N)\n   * Inclut les sessions liées directement ET via formation_sessions\n   */\n  async getAllSessionsForFormation(formationId: string) {\n    // Sessions liées via formation_sessions (N:N)\n    const { data: linkedSessions, error: linkedError } = await this.supabase\n      .from('formation_sessions')\n      .select(`\n        session_id,\n        order_index,\n        sessions(*)\n      `)\n      .eq('formation_id', formationId)\n      .order('order_index', { ascending: true })\n\n    if (linkedError) throw linkedError\n\n    // Sessions liées directement (legacy)\n    const { data: directSessions, error: directError } = await this.supabase\n      .from('sessions')\n      .select('*')\n      .eq('formation_id', formationId)\n      .order('start_date', { ascending: true })\n\n    if (directError) throw directError\n\n    // Combiner les deux en évitant les doublons\n    const linkedSessionsData = (linkedSessions?.map((fs: { sessions: unknown }) => fs.sessions).filter(Boolean) || []) as Array<{ id: string }>\n    const directSessionsData = directSessions || []\n    \n    const allSessions = [...linkedSessionsData]\n    const linkedIds = new Set(linkedSessionsData.map((s: { id: string }) => s.id))\n    \n    for (const session of directSessionsData) {\n      if (!linkedIds.has(session.id)) {\n        allSessions.push(session)\n      }\n    }\n\n    return allSessions\n  }\n\n  /**\n   * Associe des sessions à une formation\n   */\n  async addSessionsToFormation(formationId: string, sessionIds: string[], organizationId: string) {\n    const formationSessions = sessionIds.map((sessionId, index) => ({\n      formation_id: formationId,\n      session_id: sessionId,\n      organization_id: organizationId,\n      order_index: index,\n    }))\n\n    const { data, error } = await this.supabase\n      .from('formation_sessions')\n      .insert(formationSessions)\n      .select()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Retire une session d'une formation\n   */\n  async removeSessionFromFormation(formationId: string, sessionId: string) {\n    const { error } = await this.supabase\n      .from('formation_sessions')\n      .delete()\n      .eq('formation_id', formationId)\n      .eq('session_id', sessionId)\n\n    if (error) throw error\n    return true\n  }\n\n  /**\n   * Met à jour les sessions associées à une formation\n   */\n  async updateFormationSessions(formationId: string, sessionIds: string[], organizationId: string) {\n    // Supprimer toutes les associations existantes\n    const { error: deleteError } = await this.supabase\n      .from('formation_sessions')\n      .delete()\n      .eq('formation_id', formationId)\n\n    if (deleteError) throw deleteError\n\n    // Créer les nouvelles associations\n    if (sessionIds.length > 0) {\n      return this.addSessionsToFormation(formationId, sessionIds, organizationId)\n    }\n\n    return []\n  }\n\n  /**\n   * Récupère une formation avec toutes ses sessions (N:N et directes)\n   */\n  async getFormationWithAllSessions(id: string) {\n    const formation = await this.getFormationById(id)\n    if (!formation) return null\n\n    const allSessions = await this.getAllSessionsForFormation(id)\n    \n    return {\n      ...formation,\n      all_sessions: allSessions,\n    }\n  }\n}\n\nexport const formationService = new FormationService()\n\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Zap\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cG9seWdvbiBwb2ludHM9IjEzIDIgMyAxNCAxMiAxNCAxMSAyMiAyMSAxMCAxMiAxMCAxMyAyIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/zap\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Zap = createLucideIcon('Zap', [\n  ['polygon', { points: '13 2 3 14 12 14 11 22 21 10 12 10 13 2', key: '45s27k' }],\n]);\n\nexport default Zap;\n","import { createClient } from '@/lib/supabase/client'\nimport type { SupabaseClient } from '@supabase/supabase-js'\nimport type { TableRow, TableInsert, TableUpdate, FlexibleInsert, FlexibleUpdate } from '@/lib/types/supabase-helpers'\n\ntype SessionSlot = TableRow<'session_slots'>\ntype SessionSlotInsert = TableInsert<'session_slots'>\ntype SessionSlotUpdate = TableUpdate<'session_slots'>\n\nexport interface GenerateSlotsParams {\n  sessionId: string\n  startDate: string\n  endDate: string\n  timeSlotType: 'morning' | 'afternoon' | 'both' | 'full_day'\n  morningStart?: string // Format HH:mm\n  morningEnd?: string\n  afternoonStart?: string\n  afternoonEnd?: string\n  location?: string\n  teacherId?: string\n  capacityMax?: number\n}\n\nexport class SessionSlotService {\n  private supabase: SupabaseClient<any>\n\n\n  constructor(supabaseClient?: SupabaseClient<any>) {\n\n    this.supabase = supabaseClient || createClient()\n\n  }\n\n  /**\n   * Récupère toutes les séances d'une session\n   */\n  async getBySessionId(sessionId: string) {\n    const { data, error } = await this.supabase\n      .from('session_slots')\n      .select('*')\n      .eq('session_id', sessionId)\n      .order('date', { ascending: true })\n      .order('start_time', { ascending: true })\n\n    if (error) throw error\n    return data || []\n  }\n\n  /**\n   * Récupère une séance par son ID\n   */\n  async getById(id: string) {\n    const { data, error } = await this.supabase\n      .from('session_slots')\n      .select('*')\n      .eq('id', id)\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Crée une nouvelle séance\n   */\n  async create(slot: FlexibleInsert<'session_slots'>) {\n    const { data, error } = await this.supabase\n      .from('session_slots')\n      .insert(slot as SessionSlotInsert)\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Met à jour une séance\n   */\n  async update(id: string, updates: FlexibleUpdate<'session_slots'>) {\n    const { data, error } = await this.supabase\n      .from('session_slots')\n      .update(updates as SessionSlotUpdate)\n      .eq('id', id)\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Supprime une séance\n   */\n  async delete(id: string) {\n    const { error } = await this.supabase\n      .from('session_slots')\n      .delete()\n      .eq('id', id)\n\n    if (error) throw error\n  }\n\n  /**\n   * Génère automatiquement les séances pour une session\n   */\n  async generateSlots(params: GenerateSlotsParams) {\n    const { sessionId, startDate, endDate, timeSlotType, morningStart, morningEnd, afternoonStart, afternoonEnd, location, teacherId, capacityMax } = params\n\n    // Valeurs par défaut pour les heures\n    const defaultMorningStart = morningStart || '09:00'\n    const defaultMorningEnd = morningEnd || '12:00'\n    const defaultAfternoonStart = afternoonStart || '14:00'\n    const defaultAfternoonEnd = afternoonEnd || '17:00'\n\n    // Générer toutes les dates entre startDate et endDate\n    const dates: string[] = []\n    const start = new Date(startDate)\n    const end = new Date(endDate)\n\n    // Exclure les weekends (samedi = 6, dimanche = 0)\n    let currentDate = new Date(start)\n    while (currentDate <= end) {\n      const dayOfWeek = currentDate.getDay()\n      if (dayOfWeek !== 0 && dayOfWeek !== 6) { // Exclure dimanche et samedi\n        dates.push(currentDate.toISOString().split('T')[0])\n      }\n      currentDate.setDate(currentDate.getDate() + 1)\n    }\n\n    // Générer les séances pour chaque date\n    const slots: FlexibleInsert<'session_slots'>[] = []\n\n    for (const date of dates) {\n      if (timeSlotType === 'morning' || timeSlotType === 'both') {\n        slots.push({\n          session_id: sessionId,\n          date,\n          time_slot: 'morning',\n          start_time: defaultMorningStart,\n          end_time: defaultMorningEnd,\n          location: location || null,\n          teacher_id: teacherId || null,\n          capacity_max: capacityMax || null,\n        })\n      }\n\n      if (timeSlotType === 'afternoon' || timeSlotType === 'both') {\n        slots.push({\n          session_id: sessionId,\n          date,\n          time_slot: 'afternoon',\n          start_time: defaultAfternoonStart,\n          end_time: defaultAfternoonEnd,\n          location: location || null,\n          teacher_id: teacherId || null,\n          capacity_max: capacityMax || null,\n        })\n      }\n\n      if (timeSlotType === 'full_day') {\n        slots.push({\n          session_id: sessionId,\n          date,\n          time_slot: 'full_day',\n          start_time: defaultMorningStart,\n          end_time: defaultAfternoonEnd,\n          location: location || null,\n          teacher_id: teacherId || null,\n          capacity_max: capacityMax || null,\n        })\n      }\n    }\n\n    // Supprimer les séances existantes pour cette session\n    const { error: deleteError } = await this.supabase\n      .from('session_slots')\n      .delete()\n      .eq('session_id', sessionId)\n\n    if (deleteError) throw deleteError\n\n    // Insérer les nouvelles séances\n    if (slots.length > 0) {\n      const { data, error } = await this.supabase\n        .from('session_slots')\n        .insert(slots as SessionSlotInsert[])\n        .select()\n\n      if (error) throw error\n      return data\n    }\n\n    return []\n  }\n\n  /**\n   * Supprime toutes les séances d'une session\n   */\n  async deleteBySessionId(sessionId: string) {\n    const { error } = await this.supabase\n      .from('session_slots')\n      .delete()\n      .eq('session_id', sessionId)\n\n    if (error) throw error\n  }\n}\n\nexport const sessionSlotService = new SessionSlotService()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","import { createClient } from '@/lib/supabase/client'\nimport type { SupabaseClient } from '@supabase/supabase-js'\nimport { Database } from '@/types/database.types'\nimport type { TableRow, TableInsert, TableUpdate } from '@/lib/types/supabase-helpers'\n\ntype Grade = TableRow<'grades'>\ntype GradeInsert = TableInsert<'grades'>\ntype GradeUpdate = TableUpdate<'grades'>\n\nexport interface EvaluationFilters {\n  sessionId?: string\n  studentId?: string\n  subject?: string\n  assessmentType?: string\n  startDate?: string\n  endDate?: string\n  termPeriod?: string\n  academicYearId?: string\n  isMakeup?: boolean\n}\n\nexport interface EvaluationStats {\n  total: number\n  byType: Record<string, number>\n  averageScore: number\n  averagePercentage: number\n  bySubject: Record<string, { count: number; average: number }>\n}\n\nclass EvaluationService {\n  private supabase: SupabaseClient<Database>\n\n\n  constructor(supabaseClient?: SupabaseClient<Database>) {\n\n    this.supabase = supabaseClient || createClient()\n\n  }\n\n  /**\n   * Récupère toutes les évaluations pour une organisation\n   */\n  async getAll(organizationId: string, filters?: EvaluationFilters) {\n    let query = this.supabase\n      .from('grades')\n      .select(`\n        *,\n        students(id, first_name, last_name, student_number),\n        sessions(id, name, formations(name, programs(name))),\n        users(id, full_name)\n      `)\n      .eq('organization_id', organizationId)\n      .order('graded_at', { ascending: false })\n\n    if (filters?.sessionId) {\n      query = query.eq('session_id', filters.sessionId)\n    }\n\n    if (filters?.studentId) {\n      query = query.eq('student_id', filters.studentId)\n    }\n\n    if (filters?.subject) {\n      query = query.ilike('subject', `%${filters.subject}%`)\n    }\n\n    if (filters?.assessmentType) {\n      query = query.eq('assessment_type', filters.assessmentType)\n    }\n\n    if (filters?.startDate) {\n      query = query.gte('graded_at', filters.startDate)\n    }\n\n    if (filters?.endDate) {\n      query = query.lte('graded_at', filters.endDate)\n    }\n\n    if (filters?.termPeriod) {\n      query = query.eq('term_period', filters.termPeriod)\n    }\n\n    if (filters?.academicYearId) {\n      query = query.eq('academic_year_id', filters.academicYearId)\n    }\n\n    if (filters?.isMakeup !== undefined) {\n      query = query.eq('is_makeup', filters.isMakeup)\n    }\n\n    const { data, error } = await query\n\n    // Si erreur de relation, essayer sans les jointures complexes\n    if (error && (error.code === 'PGRST116' || error.message?.includes('relationship') || error.message?.includes('Could not find') || (error as any).status === 400)) {\n      let simpleQuery = this.supabase\n        .from('grades')\n        .select('*')\n        .eq('organization_id', organizationId)\n        .order('graded_at', { ascending: false })\n\n      if (filters?.sessionId) {\n        simpleQuery = simpleQuery.eq('session_id', filters.sessionId)\n      }\n      if (filters?.studentId) {\n        simpleQuery = simpleQuery.eq('student_id', filters.studentId)\n      }\n      if (filters?.subject) {\n        simpleQuery = simpleQuery.ilike('subject', `%${filters.subject}%`)\n      }\n      if (filters?.assessmentType) {\n        simpleQuery = simpleQuery.eq('assessment_type', filters.assessmentType)\n      }\n      if (filters?.startDate) {\n        simpleQuery = simpleQuery.gte('graded_at', filters.startDate)\n      }\n      if (filters?.endDate) {\n        simpleQuery = simpleQuery.lte('graded_at', filters.endDate)\n      }\n      if (filters?.termPeriod) {\n        simpleQuery = simpleQuery.eq('term_period', filters.termPeriod)\n      }\n      if (filters?.academicYearId) {\n        simpleQuery = simpleQuery.eq('academic_year_id', filters.academicYearId)\n      }\n      if (filters?.isMakeup !== undefined) {\n        simpleQuery = simpleQuery.eq('is_makeup', filters.isMakeup)\n      }\n\n      const { data: simpleData, error: simpleError } = await simpleQuery\n      if (simpleError) throw simpleError\n      return simpleData || []\n    }\n\n    if (error) throw error\n    return data || []\n  }\n\n  /**\n   * Récupère une évaluation par son ID\n   */\n  async getById(id: string) {\n    try {\n      const { data, error } = await this.supabase\n        .from('grades')\n        .select(`\n          *,\n          students(id, first_name, last_name, student_number),\n          sessions(id, name, formations(name, programs(name))),\n          users(id, full_name)\n        `)\n        .eq('id', id)\n        .single()\n\n      if (error) {\n        // Si erreur de relation, essayer sans les jointures complexes\n        if (error.code === 'PGRST116' || error.message?.includes('relationship') || error.message?.includes('Could not find') || (error as any).status === 400) {\n          const { data: simpleData, error: simpleError } = await this.supabase\n            .from('grades')\n            .select('*')\n            .eq('id', id)\n            .single()\n          \n          if (simpleError) throw simpleError\n          return simpleData\n        }\n        throw error\n      }\n      return data\n    } catch (err) {\n      throw err\n    }\n  }\n\n  /**\n   * Crée une nouvelle évaluation\n   */\n  async create(organizationId: string, evaluation: Omit<GradeInsert, 'organization_id' | 'created_at' | 'updated_at' | 'percentage'> & { score?: number | null; max_score?: number | null }) {\n    // Préparer les données d'insertion\n    // NOTE: percentage est une colonne générée, on ne peut pas l'insérer manuellement\n    \n    // Préserver assessment_type explicitement avant le spread\n    const assessmentType = evaluation.assessment_type\n    \n    const insertData: any = {\n      ...evaluation,\n      organization_id: organizationId,\n      // Préserver assessment_type explicitement (au cas où le spread l'écraserait)\n      assessment_type: assessmentType,\n      // Ne pas inclure percentage - c'est une colonne générée calculée automatiquement\n      coefficient: evaluation.coefficient ?? 1.0,\n      is_makeup: evaluation.is_makeup ?? false,\n      graded_at: evaluation.graded_at || new Date().toISOString(),\n    }\n\n    // Retirer percentage si présent (colonne générée)\n    delete insertData.percentage\n\n    // Nettoyer les valeurs undefined pour éviter les erreurs\n    Object.keys(insertData).forEach(key => {\n      if (insertData[key] === undefined) {\n        insertData[key] = null\n      }\n    })\n\n    // Valider assessment_type avant insertion\n    const validAssessmentTypes = [\n      'pre_formation',\n      'hot',\n      'cold',\n      'manager',\n      'instructor',\n      'funder',\n      'quiz',\n      'exam',\n      'project',\n      'other',\n    ]\n    \n    if (insertData.assessment_type && !validAssessmentTypes.includes(insertData.assessment_type)) {\n      console.error('❌ [EVALUATION SERVICE] assessment_type invalide:', {\n        received: insertData.assessment_type,\n        validTypes: validAssessmentTypes,\n      })\n      // Forcer à 'other' si la valeur n'est pas valide\n      insertData.assessment_type = 'other'\n    }\n\n\n    // Insérer sans select pour éviter les erreurs 400\n    const { data: insertedData, error: insertError } = await this.supabase\n      .from('grades')\n      .insert(insertData)\n      .select('id, subject, score, max_score, percentage, organization_id, session_id, student_id, teacher_id, assessment_type, notes, graded_at, created_at')\n      .single()\n\n    if (insertError) {\n      console.error('Erreur insertion évaluation:', insertError)\n      throw insertError\n    }\n    \n    // Retourner les données insérées sans essayer de récupérer les relations\n    // Les relations seront récupérées lors du refetch de la liste\n    return insertedData\n  }\n\n  /**\n   * Crée une évaluation de rattrapage\n   */\n  async createMakeup(\n    organizationId: string,\n    originalGradeId: string,\n    evaluation: Omit<GradeInsert, 'organization_id' | 'created_at' | 'updated_at' | 'is_makeup' | 'original_grade_id' | 'percentage'>\n  ) {\n    // Préparer les données d'insertion\n    const insertData: any = {\n      ...evaluation,\n      organization_id: organizationId,\n      // Ne pas inclure percentage - c'est une colonne générée\n      coefficient: evaluation.coefficient ?? 1.0,\n      is_makeup: true,\n      original_grade_id: originalGradeId,\n      graded_at: evaluation.graded_at || new Date().toISOString(),\n    }\n\n    // Retirer percentage si présent\n    delete insertData.percentage\n\n    // Nettoyer les valeurs undefined\n    Object.keys(insertData).forEach(key => {\n      if (insertData[key] === undefined) {\n        insertData[key] = null\n      }\n    })\n\n    // Insérer sans select pour éviter les erreurs 400\n    const { data: insertedData, error: insertError } = await this.supabase\n      .from('grades')\n      .insert(insertData)\n      .select('id, subject, score, max_score, percentage, organization_id, session_id, student_id, teacher_id, assessment_type, notes, graded_at, created_at')\n      .single()\n\n    if (insertError) throw insertError\n    \n    return insertedData\n  }\n\n  /**\n   * Calcule la moyenne pondérée pour un étudiant\n   */\n  async calculateWeightedAverage(\n    organizationId: string,\n    studentId: string,\n    sessionId?: string,\n    termPeriod?: string,\n    academicYearId?: string\n  ): Promise<number | null> {\n    const filters: EvaluationFilters = {\n      studentId,\n      sessionId,\n      termPeriod,\n      academicYearId,\n      isMakeup: false, // Exclure les rattrapages pour la moyenne principale\n    }\n\n    const evaluations = await this.getAll(organizationId, filters)\n\n    if (evaluations.length === 0) return null\n\n    let weightedSum = 0\n    let totalCoefficient = 0\n\n    evaluations.forEach((evaluation) => {\n      const coefficient = (evaluation as Grade & { coefficient?: number }).coefficient || 1.0\n      const maxScore = evaluation.max_score || 1\n      const score = evaluation.score\n\n      if (maxScore > 0 && score !== null && score !== undefined) {\n        weightedSum += (score / maxScore) * 20 * coefficient // Convertir sur 20\n        totalCoefficient += coefficient\n      }\n    })\n\n    if (totalCoefficient === 0) return null\n\n    return Math.round((weightedSum / totalCoefficient) * 100) / 100\n  }\n\n  /**\n   * Met à jour une évaluation\n   */\n  async update(id: string, updates: Omit<GradeUpdate, 'percentage'>) {\n    // Préparer les données de mise à jour\n    const updateData: any = {\n      ...updates,\n      // Ne pas inclure percentage - c'est une colonne générée calculée automatiquement\n      updated_at: new Date().toISOString(),\n    }\n\n    // Retirer percentage si présent\n    delete updateData.percentage\n\n    // Nettoyer les valeurs undefined\n    Object.keys(updateData).forEach(key => {\n      if (updateData[key] === undefined) {\n        delete updateData[key]\n      }\n    })\n\n    // Mettre à jour sans jointure\n    const { data: updatedData, error: updateError } = await this.supabase\n      .from('grades')\n      .update(updateData)\n      .eq('id', id)\n      .select('id, subject, score, max_score, percentage, organization_id, session_id, student_id, teacher_id, assessment_type, notes, graded_at, created_at, updated_at')\n      .single()\n\n    if (updateError) throw updateError\n    \n    return updatedData\n  }\n\n  /**\n   * Supprime une évaluation\n   */\n  async delete(id: string) {\n    const { error } = await this.supabase\n      .from('grades')\n      .delete()\n      .eq('id', id)\n\n    if (error) throw error\n  }\n\n  /**\n   * Récupère les statistiques des évaluations\n   */\n  async getStats(organizationId: string, filters?: EvaluationFilters): Promise<EvaluationStats> {\n    const evaluations = await this.getAll(organizationId, filters)\n    \n    const stats: EvaluationStats = {\n      total: evaluations.length,\n      byType: {},\n      averageScore: 0,\n      averagePercentage: 0,\n      bySubject: {},\n    }\n\n    if (evaluations.length === 0) return stats\n\n    let totalScore = 0\n    let totalMaxScore = 0\n    let totalPercentage = 0\n    let validPercentageCount = 0\n\n    evaluations.forEach((evaluation) => {\n      // Par type\n      const type = evaluation.assessment_type || 'other'\n      stats.byType[type] = (stats.byType[type] || 0) + 1\n\n      // Par sujet\n      const subject = evaluation.subject\n      if (!stats.bySubject[subject]) {\n        stats.bySubject[subject] = { count: 0, average: 0 }\n      }\n      stats.bySubject[subject].count++\n\n      // Scores\n      if (evaluation.score !== null && evaluation.score !== undefined) {\n        totalScore += evaluation.score\n      }\n      if (evaluation.max_score) {\n        totalMaxScore += evaluation.max_score\n      }\n      if (evaluation.percentage !== null && evaluation.percentage !== undefined) {\n        totalPercentage += evaluation.percentage\n        validPercentageCount++\n      }\n    })\n\n    // Moyennes\n    stats.averageScore = totalMaxScore > 0 ? totalScore / evaluations.length : 0\n    stats.averagePercentage = validPercentageCount > 0 ? totalPercentage / validPercentageCount : 0\n\n    // Moyennes par sujet\n    Object.keys(stats.bySubject).forEach((subject) => {\n      const subjectEvals = evaluations.filter((e) => e.subject === subject)\n      const subjectTotal = subjectEvals.reduce((sum, e) => sum + (e.score || 0), 0)\n      stats.bySubject[subject].average = subjectTotal / subjectEvals.length\n    })\n\n    return stats\n  }\n\n  /**\n   * Crée plusieurs évaluations en masse\n   */\n  async createBulk(organizationId: string, evaluations: Omit<GradeInsert, 'organization_id' | 'created_at' | 'updated_at' | 'percentage'>[]) {\n    const evaluationsWithOrg = evaluations.map((evaluation) => {\n      const insertData: any = {\n        ...evaluation,\n        organization_id: organizationId,\n        // Ne pas inclure percentage - c'est une colonne générée\n        graded_at: evaluation.graded_at || new Date().toISOString(),\n      }\n\n      // Retirer percentage si présent\n      delete insertData.percentage\n\n      // Nettoyer les valeurs undefined\n      Object.keys(insertData).forEach(key => {\n        if (insertData[key] === undefined) {\n          insertData[key] = null\n        }\n      })\n\n      return insertData\n    })\n\n    // Insérer d'abord sans jointure\n    const { data: insertedData, error: insertError } = await this.supabase\n      .from('grades')\n      .insert(evaluationsWithOrg)\n      .select('*')\n\n    if (insertError) throw insertError\n    \n    if (!insertedData || insertedData.length === 0) return []\n    \n    // Essayer de récupérer avec les relations pour chaque note créée\n    try {\n      const ids = insertedData.map(item => item.id)\n      const { data, error } = await this.supabase\n        .from('grades')\n        .select(`\n          *,\n          students(id, first_name, last_name, student_number),\n          sessions(id, name),\n          users(id, full_name)\n        `)\n        .in('id', ids)\n      \n      if (error) return insertedData\n      return data || []\n    } catch {\n      return insertedData\n    }\n  }\n}\n\nexport const evaluationService = new EvaluationService()\n\n\n\n\n\n\n\n\n\n\n\n\n"],"names":[],"mappings":"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","ignoreList":[0,2,3,4,6,11]}