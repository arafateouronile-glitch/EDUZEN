{"version":3,"sources":["../../../../app/%28dashboard%29/dashboard/elearning/courses/%5Bslug%5D/lessons/new/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { useParams, useRouter } from 'next/navigation'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { useForm } from 'react-hook-form'\nimport { zodResolver } from '@hookform/resolvers/zod'\nimport { z } from 'zod'\nimport { useAuth } from '@/lib/hooks/use-auth'\nimport { elearningService } from '@/lib/services/elearning.service'\nimport { createClient } from '@/lib/supabase/client'\nimport { Button } from '@/components/ui/button'\nimport { GlassCard } from '@/components/ui/glass-card'\nimport {\n  ArrowLeft,\n  Save,\n  Plus,\n  Type,\n  Image,\n  Video,\n  FileText,\n  HelpCircle,\n  BarChart3,\n  X,\n  GripVertical,\n  Upload,\n  Loader2,\n} from 'lucide-react'\nimport Link from 'next/link'\nimport { useToast } from '@/components/ui/toast'\nimport { motion, AnimatePresence } from '@/components/ui/motion'\nimport { cn } from '@/lib/utils'\n\n// Schéma de validation\nconst lessonSchema = z.object({\n  title: z.string().min(3, 'Le titre doit contenir au moins 3 caractères'),\n  slug: z.string().min(3, 'Le slug doit contenir au moins 3 caractères').regex(/^[a-z0-9-]+$/, 'Le slug ne peut contenir que des lettres minuscules, chiffres et tirets'),\n  description: z.string().optional(),\n  section_id: z.string().optional(),\n  order_index: z.number().min(0).default(0),\n})\n\ntype LessonFormData = z.infer<typeof lessonSchema>\n\n// Types de blocs de contenu\ntype ContentBlockType = 'text' | 'media' | 'quiz' | 'poll'\n\ninterface ContentBlock {\n  id: string\n  type: ContentBlockType\n  data: {\n    // Pour text\n    content?: string\n    // Pour media\n    mediaType?: 'image' | 'video' | 'audio' | 'file'\n    mediaUrl?: string\n    caption?: string\n    // Pour quiz\n    question?: string\n    options?: { id: string; text: string; isCorrect: boolean }[]\n    explanation?: string\n    points?: number\n    // Pour poll\n    pollQuestion?: string\n    pollOptions?: { id: string; text: string }[]\n  }\n}\n\nexport default function NewLessonPage() {\n  const params = useParams()\n  const router = useRouter()\n  const courseSlug = params.slug as string\n  const { user } = useAuth()\n  const { addToast } = useToast()\n  const queryClient = useQueryClient()\n  const supabase = createClient()\n  const [contentBlocks, setContentBlocks] = useState<ContentBlock[]>([])\n  const [showBlockSelector, setShowBlockSelector] = useState(false)\n  const [uploadingImages, setUploadingImages] = useState<Record<string, boolean>>({})\n\n  // Récupérer le cours\n  const { data: course } = useQuery<{ id: string; [key: string]: any } | null>({\n    queryKey: ['course', courseSlug, user?.organization_id],\n    queryFn: async () => {\n      const result = await elearningService.getCourseBySlug(courseSlug, user?.organization_id || '')\n      return result as any\n    },\n    enabled: !!courseSlug && !!user?.organization_id,\n  })\n\n  // Récupérer les sections\n  const { data: sections } = useQuery<Array<{ id: string; title?: string; [key: string]: any }>>({\n    queryKey: ['course-sections', course?.id],\n    queryFn: async () => {\n      const result = await elearningService.getCourseSections((course as any)?.id || '')\n      return result as Array<{ id: string; title?: string; [key: string]: any }>\n    },\n    enabled: !!course?.id,\n  })\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n    watch,\n    setValue,\n  } = useForm<LessonFormData>({\n    resolver: zodResolver(lessonSchema),\n    mode: 'onChange',\n    defaultValues: {\n      order_index: 0,\n    },\n  })\n\n  // Générer le slug automatiquement\n  const title = watch('title')\n  const generateSlug = (text: string) => {\n    return text\n      .toLowerCase()\n      .normalize('NFD')\n      .replace(/[\\u0300-\\u036f]/g, '')\n      .replace(/[^a-z0-9]+/g, '-')\n      .replace(/^-+|-+$/g, '')\n  }\n\n  const handleTitleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const newTitle = e.target.value\n    setValue('title', newTitle)\n    if (newTitle) {\n      setValue('slug', generateSlug(newTitle))\n    }\n  }\n\n  // Ajouter un bloc de contenu\n  const addContentBlock = (type: ContentBlockType) => {\n    const newBlock: ContentBlock = {\n      id: Math.random().toString(36).substr(2, 9),\n      type,\n      data: {\n        content: type === 'text' ? '' : undefined,\n        mediaType: type === 'media' ? 'image' : undefined,\n        question: type === 'quiz' ? '' : undefined,\n        pollQuestion: type === 'poll' ? '' : undefined,\n        options: type === 'quiz' ? [{ id: '1', text: '', isCorrect: false }] : undefined,\n        pollOptions: type === 'poll' ? [{ id: '1', text: '' }] : undefined,\n        points: type === 'quiz' ? 1 : undefined,\n      },\n    }\n    setContentBlocks([...contentBlocks, newBlock])\n    setShowBlockSelector(false)\n  }\n\n  // Mettre à jour un bloc\n  const updateBlock = (id: string, data: Partial<ContentBlock['data']>) => {\n    setContentBlocks(\n      contentBlocks.map((block) =>\n        block.id === id ? { ...block, data: { ...block.data, ...data } } : block\n      )\n    )\n  }\n\n  // Supprimer un bloc\n  const removeBlock = (id: string) => {\n    setContentBlocks(contentBlocks.filter((block) => block.id !== id))\n  }\n\n  // Uploader une image\n  const handleImageUpload = async (blockId: string, file: File) => {\n    if (!user?.organization_id) {\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: 'Organisation manquante',\n      })\n      return\n    }\n\n    setUploadingImages((prev) => ({ ...prev, [blockId]: true }))\n\n    try {\n      const fileExt = file.name.split('.').pop()\n      const fileName = `${user.organization_id}/elearning/lessons/${Date.now()}-${Math.random().toString(36).substring(7)}.${fileExt}`\n      \n      const tryBuckets = ['elearning-media', 'course-media', 'course-thumbnails']\n      let uploadedBucket: string | null = null\n      let lastError: any = null\n\n      for (const bucket of tryBuckets) {\n        const { error } = await supabase.storage.from(bucket).upload(fileName, file, {\n          cacheControl: '3600',\n          upsert: false,\n        })\n        if (!error) {\n          uploadedBucket = bucket\n          lastError = null\n          break\n        }\n        lastError = error\n      }\n\n      if (!uploadedBucket) {\n        throw lastError || new Error(\"Échec de l'upload sur tous les buckets disponibles.\")\n      }\n\n      const { data: urlData } = supabase.storage.from(uploadedBucket).getPublicUrl(fileName)\n      updateBlock(blockId, { mediaUrl: urlData.publicUrl })\n\n      addToast({\n        type: 'success',\n        title: 'Image uploadée',\n        description: 'L\\'image a été uploadée avec succès.',\n      })\n    } catch (error: any) {\n      console.error('Erreur lors de l\\'upload:', error)\n      addToast({\n        type: 'error',\n        title: 'Erreur d\\'upload',\n        description: error?.message || 'Une erreur est survenue lors de l\\'upload de l\\'image.',\n      })\n    } finally {\n      setUploadingImages((prev) => ({ ...prev, [blockId]: false }))\n    }\n  }\n\n  // Ajouter une option à un quiz\n  const addQuizOption = (blockId: string) => {\n    const block = contentBlocks.find((b) => b.id === blockId)\n    if (block && block.type === 'quiz') {\n      const newOption = {\n        id: Math.random().toString(36).substr(2, 9),\n        text: '',\n        isCorrect: false,\n      }\n      updateBlock(blockId, {\n        options: [...(block.data.options || []), newOption],\n      })\n    }\n  }\n\n  // Ajouter une option à un sondage\n  const addPollOption = (blockId: string) => {\n    const block = contentBlocks.find((b) => b.id === blockId)\n    if (block && block.type === 'poll') {\n      const newOption = {\n        id: Math.random().toString(36).substr(2, 9),\n        text: '',\n      }\n      updateBlock(blockId, {\n        pollOptions: [...(block.data.pollOptions || []), newOption],\n      })\n    }\n  }\n\n  const createMutation = useMutation({\n    mutationFn: async (data: LessonFormData) => {\n      if (!course?.id) throw new Error('Course ID manquant')\n\n      // Convertir les blocs en JSON pour le stockage\n      const contentJson = JSON.stringify(contentBlocks)\n\n      return elearningService.createLesson({\n        course_id: course.id,\n        title: data.title,\n        slug: data.slug,\n        description: data.description || null,\n        section_id: data.section_id || null,\n        order_index: data.order_index,\n        lesson_type: 'text', // Par défaut, peut être changé selon le contenu\n        content: contentJson,\n        video_url: null,\n        video_duration_minutes: null,\n        is_preview: false,\n        attachments: null,\n      })\n    },\n    onSuccess: (lesson: any) => {\n      addToast({\n        type: 'success',\n        title: 'Leçon créée avec succès',\n        description: 'Votre leçon a été créée. Vous pouvez maintenant la modifier.',\n      })\n      queryClient.invalidateQueries({ queryKey: ['course', courseSlug] })\n      router.push(`/dashboard/elearning/courses/${courseSlug}/lessons/${(lesson as any).slug}/edit`)\n    },\n    onError: (error: Error) => {\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: error.message || 'Une erreur est survenue lors de la création de la leçon',\n      })\n    },\n  })\n\n  const onSubmit = (data: LessonFormData) => {\n    createMutation.mutate(data)\n  }\n\n  if (!course) {\n    return (\n      <div className=\"container mx-auto py-8 px-4 max-w-7xl\">\n        <div className=\"text-center py-12\">Chargement...</div>\n      </div>\n    )\n  }\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      className=\"space-y-8 pb-8 max-w-6xl mx-auto p-6\"\n    >\n      {/* Header */}\n      <div className=\"flex items-center gap-4\">\n        <Link href={`/dashboard/elearning/courses/${courseSlug}`}>\n          <Button variant=\"ghost\" size=\"icon\">\n            <ArrowLeft className=\"h-4 w-4\" />\n          </Button>\n        </Link>\n        <div>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Nouvelle leçon</h1>\n          <p className=\"text-gray-500 mt-1\">Ajoutez une nouvelle leçon à \"{course.title}\"</p>\n        </div>\n      </div>\n\n      <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\n        {/* Informations de base */}\n        <GlassCard variant=\"premium\" className=\"p-6\">\n          <h2 className=\"text-xl font-bold text-gray-900 mb-6\">Informations de base</h2>\n          \n          <div className=\"space-y-6\">\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Titre de la leçon *\n              </label>\n              <input\n                type=\"text\"\n                {...register('title')}\n                onChange={handleTitleChange}\n                className={cn(\n                  \"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all\",\n                  errors.title ? 'border-red-500' : 'border-gray-200'\n                )}\n                placeholder=\"Ex: Introduction à React\"\n              />\n              {errors.title && (\n                <p className=\"text-sm text-red-600 mt-1\">{errors.title.message}</p>\n              )}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Slug (URL) *\n              </label>\n              <input\n                type=\"text\"\n                {...register('slug')}\n                className={cn(\n                  \"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all bg-gray-50\",\n                  errors.slug ? 'border-red-500' : 'border-gray-200'\n                )}\n                placeholder=\"introduction-a-react\"\n              />\n              {errors.slug && (\n                <p className=\"text-sm text-red-600 mt-1\">{errors.slug.message}</p>\n              )}\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Description\n              </label>\n              <textarea\n                {...register('description')}\n                rows={3}\n                className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all resize-none\"\n                placeholder=\"Description courte de la leçon...\"\n              />\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Section (optionnel)\n                </label>\n                <select\n                  {...register('section_id')}\n                  className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all\"\n                >\n                  <option value=\"\">Aucune section</option>\n                  {sections?.map((section) => (\n                    <option key={section.id} value={section.id}>\n                      {section.title}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Ordre\n                </label>\n                <input\n                  type=\"number\"\n                  {...register('order_index', { valueAsNumber: true })}\n                  min=\"0\"\n                  className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all\"\n                />\n              </div>\n            </div>\n          </div>\n        </GlassCard>\n\n        {/* Contenu de la leçon */}\n        <GlassCard variant=\"premium\" className=\"p-6\">\n          <div className=\"flex items-center justify-between mb-6\">\n            <h2 className=\"text-xl font-bold text-gray-900\">Contenu de la leçon</h2>\n            <Button\n              type=\"button\"\n              onClick={() => setShowBlockSelector(!showBlockSelector)}\n              className=\"bg-brand-blue hover:bg-brand-blue/90 text-white\"\n            >\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Ajouter un élément\n            </Button>\n          </div>\n\n          {/* Sélecteur de type de bloc */}\n          <AnimatePresence>\n            {showBlockSelector && (\n              <motion.div\n                initial={{ opacity: 0, y: -10 }}\n                animate={{ opacity: 1, y: 0 }}\n                exit={{ opacity: 0, y: -10 }}\n                className=\"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200\"\n              >\n                <p className=\"text-sm font-medium text-gray-700 mb-3\">Choisir un type de contenu :</p>\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n                  <button\n                    type=\"button\"\n                    onClick={() => addContentBlock('text')}\n                    className=\"flex flex-col items-center gap-2 p-4 border border-gray-200 rounded-lg hover:border-brand-blue hover:bg-brand-blue-ghost transition-colors\"\n                  >\n                    <Type className=\"h-6 w-6 text-brand-blue\" />\n                    <span className=\"text-sm font-medium\">Texte</span>\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => addContentBlock('media')}\n                    className=\"flex flex-col items-center gap-2 p-4 border border-gray-200 rounded-lg hover:border-brand-blue hover:bg-brand-blue-ghost transition-colors\"\n                  >\n                    <Image className=\"h-6 w-6 text-brand-blue\" />\n                    <span className=\"text-sm font-medium\">Média</span>\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => addContentBlock('quiz')}\n                    className=\"flex flex-col items-center gap-2 p-4 border border-gray-200 rounded-lg hover:border-brand-blue hover:bg-brand-blue-ghost transition-colors\"\n                  >\n                    <HelpCircle className=\"h-6 w-6 text-brand-blue\" />\n                    <span className=\"text-sm font-medium\">Quiz</span>\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={() => addContentBlock('poll')}\n                    className=\"flex flex-col items-center gap-2 p-4 border border-gray-200 rounded-lg hover:border-brand-blue hover:bg-brand-blue-ghost transition-colors\"\n                  >\n                    <BarChart3 className=\"h-6 w-6 text-brand-blue\" />\n                    <span className=\"text-sm font-medium\">Sondage</span>\n                  </button>\n                </div>\n              </motion.div>\n            )}\n          </AnimatePresence>\n\n          {/* Liste des blocs */}\n          <div className=\"space-y-4\">\n            <AnimatePresence>\n              {contentBlocks.map((block, index) => (\n                <motion.div\n                  key={block.id}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  exit={{ opacity: 0, y: -20 }}\n                  className=\"border border-gray-200 rounded-lg p-4 bg-white\"\n                >\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <div className=\"flex items-center gap-2\">\n                      <GripVertical className=\"h-4 w-4 text-gray-400\" />\n                      <span className=\"text-sm font-medium text-gray-700\">\n                        {block.type === 'text' && 'Texte'}\n                        {block.type === 'media' && 'Média'}\n                        {block.type === 'quiz' && 'Quiz (évaluable)'}\n                        {block.type === 'poll' && 'Sondage (non évaluable)'}\n                      </span>\n                    </div>\n                    <button\n                      type=\"button\"\n                      onClick={() => removeBlock(block.id)}\n                      className=\"p-1 text-red-500 hover:bg-red-50 rounded transition-colors\"\n                    >\n                      <X className=\"h-4 w-4\" />\n                    </button>\n                  </div>\n\n                  {/* Rendu du bloc selon son type */}\n                  {block.type === 'text' && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                        Contenu\n                      </label>\n                      <textarea\n                        value={block.data.content || ''}\n                        onChange={(e) => updateBlock(block.id, { content: e.target.value })}\n                        rows={6}\n                        className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all resize-none\"\n                        placeholder=\"Saisissez votre texte ici (Markdown supporté)...\"\n                      />\n                    </div>\n                  )}\n\n                  {block.type === 'media' && (\n                    <div className=\"space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Type de média\n                        </label>\n                        <select\n                          value={block.data.mediaType || 'image'}\n                          onChange={(e) => updateBlock(block.id, { mediaType: e.target.value as any })}\n                          className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all\"\n                        >\n                          <option value=\"image\">Image</option>\n                          <option value=\"video\">Vidéo</option>\n                          <option value=\"audio\">Audio</option>\n                          <option value=\"file\">Fichier</option>\n                        </select>\n                      </div>\n                      \n                      {block.data.mediaType === 'image' && (\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                            Uploader une image\n                          </label>\n                          <div className=\"flex items-center gap-4\">\n                            <label className=\"flex-1 cursor-pointer\">\n                              <input\n                                type=\"file\"\n                                accept=\"image/*\"\n                                className=\"hidden\"\n                                onChange={(e) => {\n                                  const file = e.target.files?.[0]\n                                  if (file) {\n                                    handleImageUpload(block.id, file)\n                                  }\n                                }}\n                                disabled={uploadingImages[block.id]}\n                              />\n                              <div className={cn(\n                                \"flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed rounded-lg transition-colors\",\n                                uploadingImages[block.id]\n                                  ? \"border-gray-300 bg-gray-50\"\n                                  : \"border-brand-blue/30 hover:border-brand-blue hover:bg-brand-blue-ghost\"\n                              )}>\n                                {uploadingImages[block.id] ? (\n                                  <>\n                                    <Loader2 className=\"h-5 w-5 text-brand-blue animate-spin\" />\n                                    <span className=\"text-sm text-gray-600\">Upload en cours...</span>\n                                  </>\n                                ) : (\n                                  <>\n                                    <Upload className=\"h-5 w-5 text-brand-blue\" />\n                                    <span className=\"text-sm font-medium text-brand-blue\">Choisir un fichier</span>\n                                  </>\n                                )}\n                              </div>\n                            </label>\n                          </div>\n                          {block.data.mediaUrl && (\n                            <div className=\"mt-3\">\n                              <img\n                                src={block.data.mediaUrl}\n                                alt=\"Aperçu\"\n                                className=\"max-w-full h-auto max-h-64 rounded-lg border border-gray-200\"\n                              />\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          {block.data.mediaType === 'image' ? 'URL de l\\'image (ou laisser vide si uploadée ci-dessus)' : 'URL du média'}\n                        </label>\n                        <input\n                          type=\"url\"\n                          value={block.data.mediaUrl || ''}\n                          onChange={(e) => updateBlock(block.id, { mediaUrl: e.target.value })}\n                          className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all\"\n                          placeholder=\"https://...\"\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Légende (optionnel)\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={block.data.caption || ''}\n                          onChange={(e) => updateBlock(block.id, { caption: e.target.value })}\n                          className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all\"\n                          placeholder=\"Légende du média...\"\n                        />\n                      </div>\n                    </div>\n                  )}\n\n                  {block.type === 'quiz' && (\n                    <div className=\"space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Question *\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={block.data.question || ''}\n                          onChange={(e) => updateBlock(block.id, { question: e.target.value })}\n                          className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all\"\n                          placeholder=\"Quelle est la question ?\"\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Points\n                        </label>\n                        <input\n                          type=\"number\"\n                          value={block.data.points || 1}\n                          onChange={(e) => updateBlock(block.id, { points: parseInt(e.target.value) || 1 })}\n                          min=\"1\"\n                          className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all\"\n                        />\n                      </div>\n                      <div>\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <label className=\"block text-sm font-medium text-gray-700\">\n                            Options de réponse *\n                          </label>\n                          <button\n                            type=\"button\"\n                            onClick={() => addQuizOption(block.id)}\n                            className=\"text-sm text-brand-blue hover:underline\"\n                          >\n                            + Ajouter une option\n                          </button>\n                        </div>\n                        <div className=\"space-y-2\">\n                          {block.data.options?.map((option, optIndex) => (\n                            <div key={option.id} className=\"flex items-center gap-2\">\n                              <input\n                                type=\"checkbox\"\n                                checked={option.isCorrect}\n                                onChange={(e) => {\n                                  const newOptions = block.data.options?.map((opt) =>\n                                    opt.id === option.id ? { ...opt, isCorrect: e.target.checked } : opt\n                                  )\n                                  updateBlock(block.id, { options: newOptions })\n                                }}\n                                className=\"w-4 h-4 text-brand-blue border-gray-300 rounded focus:ring-brand-blue\"\n                              />\n                              <input\n                                type=\"text\"\n                                value={option.text}\n                                onChange={(e) => {\n                                  const newOptions = block.data.options?.map((opt) =>\n                                    opt.id === option.id ? { ...opt, text: e.target.value } : opt\n                                  )\n                                  updateBlock(block.id, { options: newOptions })\n                                }}\n                                className=\"flex-1 px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all\"\n                                placeholder={`Option ${optIndex + 1}`}\n                              />\n                              {block.data.options && block.data.options.length > 1 && (\n                                <button\n                                  type=\"button\"\n                                  onClick={() => {\n                                    const newOptions = block.data.options?.filter((opt) => opt.id !== option.id)\n                                    updateBlock(block.id, { options: newOptions })\n                                  }}\n                                  className=\"p-1 text-red-500 hover:bg-red-50 rounded transition-colors\"\n                                >\n                                  <X className=\"h-4 w-4\" />\n                                </button>\n                              )}\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Explication (optionnel)\n                        </label>\n                        <textarea\n                          value={block.data.explanation || ''}\n                          onChange={(e) => updateBlock(block.id, { explanation: e.target.value })}\n                          rows={2}\n                          className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all resize-none\"\n                          placeholder=\"Explication de la réponse correcte...\"\n                        />\n                      </div>\n                    </div>\n                  )}\n\n                  {block.type === 'poll' && (\n                    <div className=\"space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Question du sondage *\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={block.data.pollQuestion || ''}\n                          onChange={(e) => updateBlock(block.id, { pollQuestion: e.target.value })}\n                          className=\"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all\"\n                          placeholder=\"Quelle est votre question ?\"\n                        />\n                      </div>\n                      <div>\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <label className=\"block text-sm font-medium text-gray-700\">\n                            Options de réponse *\n                          </label>\n                          <button\n                            type=\"button\"\n                            onClick={() => addPollOption(block.id)}\n                            className=\"text-sm text-brand-blue hover:underline\"\n                          >\n                            + Ajouter une option\n                          </button>\n                        </div>\n                        <div className=\"space-y-2\">\n                          {block.data.pollOptions?.map((option, optIndex) => (\n                            <div key={option.id} className=\"flex items-center gap-2\">\n                              <input\n                                type=\"text\"\n                                value={option.text}\n                                onChange={(e) => {\n                                  const newOptions = block.data.pollOptions?.map((opt) =>\n                                    opt.id === option.id ? { ...opt, text: e.target.value } : opt\n                                  )\n                                  updateBlock(block.id, { pollOptions: newOptions })\n                                }}\n                                className=\"flex-1 px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all\"\n                                placeholder={`Option ${optIndex + 1}`}\n                              />\n                              {block.data.pollOptions && block.data.pollOptions.length > 1 && (\n                                <button\n                                  type=\"button\"\n                                  onClick={() => {\n                                    const newOptions = block.data.pollOptions?.filter((opt) => opt.id !== option.id)\n                                    updateBlock(block.id, { pollOptions: newOptions })\n                                  }}\n                                  className=\"p-1 text-red-500 hover:bg-red-50 rounded transition-colors\"\n                                >\n                                  <X className=\"h-4 w-4\" />\n                                </button>\n                              )}\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </motion.div>\n              ))}\n            </AnimatePresence>\n\n            {contentBlocks.length === 0 && (\n              <div className=\"text-center py-12 border-2 border-dashed border-gray-300 rounded-lg\">\n                <p className=\"text-gray-500 mb-4\">Aucun contenu ajouté</p>\n                <Button\n                  type=\"button\"\n                  onClick={() => setShowBlockSelector(true)}\n                  variant=\"outline\"\n                >\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  Ajouter votre premier élément\n                </Button>\n              </div>\n            )}\n          </div>\n        </GlassCard>\n\n        {/* Actions */}\n        <div className=\"flex justify-end gap-4\">\n          <Link href={`/dashboard/elearning/courses/${courseSlug}`}>\n            <Button variant=\"ghost\" type=\"button\">\n              Annuler\n            </Button>\n          </Link>\n          <Button\n            type=\"submit\"\n            disabled={createMutation.isPending}\n            className=\"bg-brand-blue hover:bg-brand-blue/90 text-white shadow-lg shadow-brand-blue/20\"\n          >\n            {createMutation.isPending ? (\n              <>Création...</>\n            ) : (\n              <>\n                <Save className=\"h-4 w-4 mr-2\" />\n                Créer la leçon\n              </>\n            )}\n          </Button>\n        </div>\n      </form>\n    </motion.div>\n  )\n}\n\n\n\n\n\n"],"names":[],"mappings":"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"}