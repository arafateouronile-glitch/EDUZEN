{"version":3,"sources":["../../../../app/%28dashboard%29/dashboard/gdpr/page.tsx","../../../../lib/services/gdpr.service.ts"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { useAuth } from '@/lib/hooks/use-auth'\nimport { gdprService, type GDPRDataSubjectRequest, type GDPRDataBreach, type GDPRProcessingRegistry } from '@/lib/services/gdpr.service'\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\nimport { useToast } from '@/components/ui/toast'\nimport { \n  Shield, \n  CheckCircle2, \n  Clock, \n  AlertCircle, \n  FileText,\n  RefreshCw,\n  Plus,\n  Download,\n  Trash2,\n  Eye,\n  Database,\n  Lock\n} from 'lucide-react'\nimport Link from 'next/link'\nimport { formatDate, formatDateTime } from '@/lib/utils'\n\nconst STATUS_COLORS = {\n  pending: 'bg-yellow-100 text-yellow-800',\n  in_progress: 'bg-blue-100 text-blue-800',\n  completed: 'bg-green-100 text-green-800',\n  rejected: 'bg-red-100 text-red-800',\n  cancelled: 'bg-gray-100 text-gray-800',\n  open: 'bg-red-100 text-red-800',\n  investigating: 'bg-yellow-100 text-yellow-800',\n  remediated: 'bg-green-100 text-green-800',\n  closed: 'bg-gray-100 text-gray-800',\n}\n\nconst SEVERITY_COLORS = {\n  low: 'bg-green-100 text-green-800',\n  medium: 'bg-yellow-100 text-yellow-800',\n  high: 'bg-orange-100 text-orange-800',\n  critical: 'bg-red-100 text-red-800',\n}\n\nexport default function GDPRPage() {\n  const { user } = useAuth()\n  const queryClient = useQueryClient()\n  const { addToast } = useToast()\n\n  // Récupérer les demandes de droits\n  const { data: dataRequests = [], isLoading: isLoadingRequests } = useQuery({\n    queryKey: ['gdpr-data-requests', user?.organization_id],\n    queryFn: () => gdprService.getDataSubjectRequests(user!.organization_id!),\n    enabled: !!user?.organization_id,\n  })\n\n  // Récupérer les violations\n  const { data: dataBreaches = [], isLoading: isLoadingBreaches } = useQuery({\n    queryKey: ['gdpr-data-breaches', user?.organization_id],\n    queryFn: () => gdprService.getDataBreaches(user!.organization_id!),\n    enabled: !!user?.organization_id,\n  })\n\n  // Récupérer le registre des traitements\n  const { data: processingRegistry = [], isLoading: isLoadingRegistry } = useQuery({\n    queryKey: ['gdpr-processing-registry', user?.organization_id],\n    queryFn: () => gdprService.getProcessingRegistry(user!.organization_id!),\n    enabled: !!user?.organization_id,\n  })\n\n  // Statistiques\n  const stats = {\n    totalRequests: dataRequests.length,\n    pendingRequests: dataRequests.filter((r) => r.request_status === 'pending' || r.request_status === 'in_progress').length,\n    totalBreaches: dataBreaches.length,\n    openBreaches: dataBreaches.filter((b) => b.status === 'open' || b.status === 'investigating').length,\n    totalProcessings: processingRegistry.length,\n  }\n\n  if (isLoadingRequests || isLoadingBreaches || isLoadingRegistry) {\n    return (\n      <div className=\"container mx-auto py-8 px-4\">\n        <div className=\"flex items-center justify-center h-64\">\n          <RefreshCw className=\"h-8 w-8 animate-spin text-brand-blue\" />\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"container mx-auto py-8 px-4 max-w-7xl\">\n      {/* Header */}\n      <div className=\"mb-8\">\n        <h1 className=\"text-3xl font-bold mb-2 flex items-center gap-2\">\n          <Shield className=\"h-8 w-8 text-brand-blue\" />\n          Conformité RGPD\n        </h1>\n        <p className=\"text-muted-foreground\">\n          Gérez la conformité RGPD : consentements, registre des traitements, demandes des personnes concernées\n        </p>\n      </div>\n\n      {/* Statistiques */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8\">\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-muted-foreground\">Demandes en attente</p>\n                <p className=\"text-2xl font-bold\">{stats.pendingRequests}</p>\n              </div>\n              <Clock className=\"h-8 w-8 text-yellow-500\" />\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-muted-foreground\">Violations ouvertes</p>\n                <p className=\"text-2xl font-bold\">{stats.openBreaches}</p>\n              </div>\n              <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-muted-foreground\">Traitements actifs</p>\n                <p className=\"text-2xl font-bold\">{stats.totalProcessings}</p>\n              </div>\n              <Database className=\"h-8 w-8 text-blue-500\" />\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm text-muted-foreground\">Total demandes</p>\n                <p className=\"text-2xl font-bold\">{stats.totalRequests}</p>\n              </div>\n              <FileText className=\"h-8 w-8 text-green-500\" />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Tabs */}\n      <Tabs defaultValue=\"requests\" className=\"space-y-6\">\n        <TabsList>\n          <TabsTrigger value=\"requests\">Demandes de droits</TabsTrigger>\n          <TabsTrigger value=\"breaches\">Violations de données</TabsTrigger>\n          <TabsTrigger value=\"registry\">Registre des traitements</TabsTrigger>\n          <TabsTrigger value=\"consents\">Consentements</TabsTrigger>\n        </TabsList>\n\n        {/* Demandes de droits */}\n        <TabsContent value=\"requests\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle>Demandes des personnes concernées</CardTitle>\n                  <CardDescription>\n                    Gestion des demandes d'accès, rectification, effacement et portabilité\n                  </CardDescription>\n                </div>\n                <Button asChild>\n                  <Link href=\"/dashboard/gdpr/requests/new\">\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Nouvelle demande\n                  </Link>\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              {dataRequests.length === 0 ? (\n                <div className=\"text-center py-12\">\n                  <FileText className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground mb-4\">\n                    Aucune demande de droits RGPD enregistrée\n                  </p>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {dataRequests.map((request) => (\n                    <Card key={request.id} className=\"hover:shadow-md transition-shadow\">\n                      <CardContent className=\"pt-6\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2 mb-2\">\n                              <h3 className=\"text-lg font-semibold\">\n                                {request.request_type.replace(/_/g, ' ').toUpperCase()}\n                              </h3>\n                              <Badge className={STATUS_COLORS[request.request_status]}>\n                                {request.request_status.replace(/_/g, ' ')}\n                              </Badge>\n                              {!request.identity_verified && (\n                                <Badge variant=\"outline\" className=\"bg-yellow-50\">\n                                  Vérification requise\n                                </Badge>\n                              )}\n                            </div>\n                            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm mb-3\">\n                              <div>\n                                <p className=\"text-muted-foreground\">Demandeur</p>\n                                <p className=\"font-medium\">{request.requested_by_name}</p>\n                                <p className=\"text-muted-foreground\">{request.requested_by_email}</p>\n                              </div>\n                              <div>\n                                <p className=\"text-muted-foreground\">Date de demande</p>\n                                <p className=\"font-medium\">{formatDateTime(request.request_date)}</p>\n                              </div>\n                              {request.completed_at && (\n                                <div>\n                                  <p className=\"text-muted-foreground\">Date de traitement</p>\n                                  <p className=\"font-medium\">{formatDateTime(request.completed_at)}</p>\n                                </div>\n                              )}\n                            </div>\n                            {request.description && (\n                              <p className=\"text-sm text-muted-foreground mb-2\">{request.description}</p>\n                            )}\n                          </div>\n                          <div className=\"flex gap-2\">\n                            <Button variant=\"outline\" size=\"sm\" asChild>\n                              <Link href={`/dashboard/gdpr/requests/${request.id}`}>\n                                <Eye className=\"h-4 w-4 mr-2\" />\n                                Voir\n                              </Link>\n                            </Button>\n                          </div>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Violations de données */}\n        <TabsContent value=\"breaches\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle>Violations de données</CardTitle>\n                  <CardDescription>\n                    Gestion des violations de données personnelles (Article 33-34 RGPD)\n                  </CardDescription>\n                </div>\n                <Button asChild>\n                  <Link href=\"/dashboard/gdpr/breaches/new\">\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Déclarer une violation\n                  </Link>\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              {dataBreaches.length === 0 ? (\n                <div className=\"text-center py-12\">\n                  <Lock className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground mb-4\">\n                    Aucune violation de données déclarée\n                  </p>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {dataBreaches.map((breach) => (\n                    <Card key={breach.id} className=\"hover:shadow-md transition-shadow\">\n                      <CardContent className=\"pt-6\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2 mb-2\">\n                              <h3 className=\"text-lg font-semibold\">\n                                Violation {breach.breach_type}\n                              </h3>\n                              <Badge className={SEVERITY_COLORS[breach.severity]}>\n                                {breach.severity}\n                              </Badge>\n                              <Badge className={STATUS_COLORS[breach.status]}>\n                                {breach.status}\n                              </Badge>\n                            </div>\n                            <p className=\"text-sm text-muted-foreground mb-3\">{breach.description}</p>\n                            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\n                              <div>\n                                <p className=\"text-muted-foreground\">Date de violation</p>\n                                <p className=\"font-medium\">{formatDate(breach.breach_date)}</p>\n                              </div>\n                              <div>\n                                <p className=\"text-muted-foreground\">Découverte</p>\n                                <p className=\"font-medium\">{formatDate(breach.discovery_date)}</p>\n                              </div>\n                              {breach.affected_data_subjects_count && (\n                                <div>\n                                  <p className=\"text-muted-foreground\">Personnes concernées</p>\n                                  <p className=\"font-medium\">{breach.affected_data_subjects_count}</p>\n                                </div>\n                              )}\n                              <div>\n                                <p className=\"text-muted-foreground\">CNIL notifiée</p>\n                                <p className=\"font-medium\">\n                                  {breach.cnil_notified ? (\n                                    <CheckCircle2 className=\"h-4 w-4 text-green-500 inline\" />\n                                  ) : (\n                                    <AlertCircle className=\"h-4 w-4 text-red-500 inline\" />\n                                  )}\n                                </p>\n                              </div>\n                            </div>\n                          </div>\n                          <Button variant=\"outline\" size=\"sm\" asChild>\n                            <Link href={`/dashboard/gdpr/breaches/${breach.id}`}>\n                              Voir les détails\n                            </Link>\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Registre des traitements */}\n        <TabsContent value=\"registry\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle>Registre des traitements</CardTitle>\n                  <CardDescription>\n                    Article 30 RGPD - Registre des activités de traitement\n                  </CardDescription>\n                </div>\n                <Button asChild>\n                  <Link href=\"/dashboard/gdpr/registry/new\">\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Ajouter un traitement\n                  </Link>\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              {processingRegistry.length === 0 ? (\n                <div className=\"text-center py-12\">\n                  <Database className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground mb-4\">\n                    Aucun traitement enregistré\n                  </p>\n                  <Button asChild>\n                    <Link href=\"/dashboard/gdpr/registry/new\">\n                      <Plus className=\"h-4 w-4 mr-2\" />\n                      Créer le premier traitement\n                    </Link>\n                  </Button>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {processingRegistry.map((processing) => (\n                    <Card key={processing.id} className=\"hover:shadow-md transition-shadow\">\n                      <CardContent className=\"pt-6\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <h3 className=\"text-lg font-semibold mb-2\">{processing.processing_name}</h3>\n                            <p className=\"text-sm text-muted-foreground mb-3\">{processing.processing_purpose}</p>\n                            <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm\">\n                              <div>\n                                <p className=\"text-muted-foreground\">Base légale</p>\n                                <p className=\"font-medium\">{processing.legal_basis.replace(/_/g, ' ')}</p>\n                              </div>\n                              <div>\n                                <p className=\"text-muted-foreground\">Catégories de données</p>\n                                <p className=\"font-medium\">{processing.data_categories.length}</p>\n                              </div>\n                              {processing.retention_period && (\n                                <div>\n                                  <p className=\"text-muted-foreground\">Conservation</p>\n                                  <p className=\"font-medium\">{processing.retention_period}</p>\n                                </div>\n                              )}\n                            </div>\n                          </div>\n                          <Button variant=\"outline\" size=\"sm\" asChild>\n                            <Link href={`/dashboard/gdpr/registry/${processing.id}`}>\n                              Voir les détails\n                            </Link>\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* Consentements */}\n        <TabsContent value=\"consents\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Gestion des consentements</CardTitle>\n              <CardDescription>\n                Consultez et gérez les consentements RGPD des utilisateurs\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-center py-12\">\n                <Shield className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\n                <p className=\"text-muted-foreground mb-4\">\n                  Fonctionnalité en cours de développement\n                </p>\n                <p className=\"text-sm text-muted-foreground\">\n                  La gestion détaillée des consentements sera disponible prochainement\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n\n      {/* Actions rapides */}\n      <div className=\"mt-8 flex gap-4\">\n        <Button variant=\"outline\" asChild>\n          <Link href=\"/dashboard/gdpr/reports\">\n            <FileText className=\"h-4 w-4 mr-2\" />\n            Rapports de conformité\n          </Link>\n        </Button>\n        <Button variant=\"outline\" asChild>\n          <Link href=\"/dashboard/gdpr/settings\">\n            <Shield className=\"h-4 w-4 mr-2\" />\n            Paramètres RGPD\n          </Link>\n        </Button>\n      </div>\n    </div>\n  )\n}\n\n","/**\n * Service RGPD - Gestion de la conformité RGPD\n * Droit à l'oubli, portabilité, consentements, registre des traitements\n */\n\nimport { createClient } from '@/lib/supabase/client'\nimport type { SupabaseClient } from '@supabase/supabase-js'\n\nexport interface GDPRConsent {\n  id: string\n  organization_id: string\n  user_id: string\n  consent_type: 'marketing' | 'analytics' | 'cookies' | 'data_sharing' | 'third_party' | 'other'\n  purpose: string\n  granted: boolean\n  granted_at?: string\n  withdrawn_at?: string\n  ip_address?: string\n  user_agent?: string\n  consent_method?: 'web_form' | 'email' | 'paper' | 'phone' | 'api' | 'other'\n  version?: string\n  metadata?: Record<string, unknown>\n  created_at: string\n  updated_at: string\n}\n\nexport interface GDPRProcessingRegistry {\n  id: string\n  organization_id: string\n  processing_name: string\n  processing_purpose: string\n  legal_basis: 'consent' | 'contract' | 'legal_obligation' | 'vital_interests' | 'public_task' | 'legitimate_interests'\n  data_categories: string[]\n  data_subjects: string[]\n  recipients?: string[]\n  transfers_outside_eu: boolean\n  transfers_countries?: string[]\n  retention_period?: string\n  security_measures?: string[]\n  data_protection_officer_id?: string\n  status: 'draft' | 'active' | 'archived' | 'deleted'\n  last_review_date?: string\n  next_review_date?: string\n  notes?: string\n  created_by: string\n  created_at: string\n  updated_at: string\n}\n\nexport interface GDPRDataSubjectRequest {\n  id: string\n  organization_id: string\n  user_id?: string\n  request_type: 'access' | 'rectification' | 'erasure' | 'portability' | 'restriction' | 'objection' | 'withdraw_consent'\n  request_status: 'pending' | 'in_progress' | 'completed' | 'rejected' | 'cancelled'\n  request_date: string\n  requested_by_name: string\n  requested_by_email: string\n  requested_by_phone?: string\n  identity_verification_method?: 'email' | 'id_card' | 'phone' | 'other'\n  identity_verified: boolean\n  identity_verified_at?: string\n  verified_by?: string\n  description?: string\n  response_data?: Record<string, unknown>\n  response_file_url?: string\n  completed_at?: string\n  completed_by?: string\n  rejection_reason?: string\n  notes?: string\n  created_at: string\n  updated_at: string\n}\n\nexport interface GDPRDataBreach {\n  id: string\n  organization_id: string\n  breach_type: 'confidentiality' | 'integrity' | 'availability'\n  breach_date: string\n  discovery_date: string\n  description: string\n  affected_data_categories?: string[]\n  affected_data_subjects_count?: number\n  severity: 'low' | 'medium' | 'high' | 'critical'\n  notification_required: boolean\n  cnil_notified: boolean\n  cnil_notification_date?: string\n  data_subjects_notified: boolean\n  data_subjects_notification_date?: string\n  measures_taken?: string[]\n  preventive_measures?: string[]\n  status: 'open' | 'investigating' | 'remediated' | 'closed'\n  closed_at?: string\n  closed_by?: string\n  reported_by: string\n  created_at: string\n  updated_at: string\n}\n\nexport class GDPRService {\n  private supabase: SupabaseClient<any>\n\n\n  constructor(supabaseClient?: SupabaseClient<any>) {\n\n    this.supabase = supabaseClient || createClient()\n\n  }\n\n  /**\n   * Récupérer les consentements d'un utilisateur\n   */\n  async getUserConsents(organizationId: string, userId: string): Promise<GDPRConsent[]> {\n    const { data, error } = await this.supabase\n      .from('gdpr_consents')\n      .select('*')\n      .eq('organization_id', organizationId)\n      .eq('user_id', userId)\n      .order('created_at', { ascending: false })\n\n    if (error) throw error\n    return data || []\n  }\n\n  /**\n   * Donner ou retirer un consentement\n   */\n  async updateConsent(consent: Partial<GDPRConsent>): Promise<GDPRConsent> {\n    const updateData: Record<string, unknown> = {\n      ...consent,\n      updated_at: new Date().toISOString(),\n    }\n\n    if (consent.granted) {\n      updateData.granted_at = new Date().toISOString()\n      updateData.withdrawn_at = null\n    } else {\n      updateData.withdrawn_at = new Date().toISOString()\n    }\n\n    const { data, error } = await this.supabase\n      .from('gdpr_consents')\n      .upsert(updateData, {\n        onConflict: 'organization_id,user_id,consent_type',\n      })\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Récupérer le registre des traitements\n   */\n  async getProcessingRegistry(organizationId: string): Promise<GDPRProcessingRegistry[]> {\n    const { data, error } = await this.supabase\n      .from('gdpr_processing_registry')\n      .select('*')\n      .eq('organization_id', organizationId)\n      .eq('status', 'active')\n      .order('processing_name', { ascending: true })\n\n    // Si la table n'existe pas, retourner un tableau vide\n    if (error) {\n      const errorObj = error as { code?: string; status?: number; message?: string }\n      if (errorObj.code === 'PGRST200' || errorObj.status === 404 || errorObj.message?.includes('does not exist')) {\n        return []\n      }\n      throw error\n    }\n    return data || []\n  }\n\n  /**\n   * Créer ou mettre à jour une entrée du registre\n   */\n  async upsertProcessingRegistry(entry: Partial<GDPRProcessingRegistry>): Promise<GDPRProcessingRegistry> {\n    const { data, error } = await this.supabase\n      .from('gdpr_processing_registry')\n      .upsert(entry, {\n        onConflict: 'id',\n      })\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Créer une demande de droits RGPD\n   */\n  async createDataSubjectRequest(request: Partial<GDPRDataSubjectRequest>): Promise<GDPRDataSubjectRequest> {\n    const { data, error } = await this.supabase\n      .from('gdpr_data_subject_requests')\n      .insert(request)\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Récupérer les demandes de droits RGPD\n   */\n  async getDataSubjectRequests(organizationId: string, filters?: {\n    userId?: string\n    requestType?: string\n    status?: string\n  }): Promise<GDPRDataSubjectRequest[]> {\n    let query = this.supabase\n      .from('gdpr_data_subject_requests')\n      .select('*')\n      .eq('organization_id', organizationId)\n\n    if (filters?.userId) {\n      query = query.eq('user_id', filters.userId)\n    }\n    if (filters?.requestType) {\n      query = query.eq('request_type', filters.requestType)\n    }\n    if (filters?.status) {\n      query = query.eq('request_status', filters.status)\n    }\n\n    const { data, error } = await query.order('request_date', { ascending: false })\n\n    // Si la table n'existe pas, retourner un tableau vide\n    if (error) {\n      const errorObj = error as { code?: string; status?: number; message?: string }\n      if (errorObj.code === 'PGRST200' || errorObj.status === 404 || errorObj.message?.includes('does not exist')) {\n        return []\n      }\n      throw error\n    }\n    return data || []\n  }\n\n  /**\n   * Exporter les données d'un utilisateur (portabilité)\n   */\n  async exportUserData(organizationId: string, userId: string): Promise<{\n    exportId: string\n    fileUrl: string\n  }> {\n    // Récupérer toutes les données de l'utilisateur\n    const userData = {\n      profile: await this.getUserProfile(userId),\n      enrollments: await this.getUserEnrollments(userId),\n      payments: await this.getUserPayments(organizationId, userId),\n      documents: await this.getUserDocuments(organizationId, userId),\n      consents: await this.getUserConsents(organizationId, userId),\n    }\n\n    // Créer un export\n    const { data: exportRecord, error } = await this.supabase\n      .from('gdpr_data_exports')\n      .insert({\n        organization_id: organizationId,\n        user_id: userId,\n        export_format: 'json',\n        file_url: '', // TODO: Générer le fichier et uploader\n        data_categories: Object.keys(userData),\n        created_by: (await this.supabase.auth.getUser()).data.user?.id || '',\n      })\n      .select()\n      .single()\n\n    if (error) throw error\n\n    // TODO: Générer le fichier JSON/ZIP et uploader\n    // Pour l'instant, on retourne juste l'ID\n\n    return {\n      exportId: exportRecord.id,\n      fileUrl: exportRecord.file_url || '',\n    }\n  }\n\n  /**\n   * Supprimer les données d'un utilisateur (droit à l'oubli)\n   */\n  async deleteUserData(\n    organizationId: string,\n    userId: string,\n    deletionType: 'full' | 'partial' | 'anonymization' = 'anonymization'\n  ): Promise<{\n    deletionId: string\n    status: string\n  }> {\n    // Créer un enregistrement de suppression\n    const { data: deletionRecord, error } = await this.supabase\n      .from('gdpr_data_deletions')\n      .insert({\n        organization_id: organizationId,\n        user_id: userId,\n        deletion_type: deletionType,\n        data_categories: ['all'], // TODO: Détailler les catégories\n        deletion_status: 'pending',\n        performed_by: (await this.supabase.auth.getUser()).data.user?.id || '',\n      })\n      .select()\n      .single()\n\n    if (error) throw error\n\n    // TODO: Implémenter la suppression/anonymisation réelle\n    // Pour l'instant, on retourne juste l'enregistrement\n\n    return {\n      deletionId: deletionRecord.id,\n      status: deletionRecord.deletion_status,\n    }\n  }\n\n  /**\n   * Récupérer les violations de données\n   */\n  async getDataBreaches(organizationId: string): Promise<GDPRDataBreach[]> {\n    const { data, error } = await this.supabase\n      .from('gdpr_data_breaches')\n      .select('*')\n      .eq('organization_id', organizationId)\n      .order('breach_date', { ascending: false })\n\n    // Si la table n'existe pas, retourner un tableau vide\n    if (error) {\n      const errorObj = error as { code?: string; status?: number; message?: string }\n      if (errorObj.code === 'PGRST200' || errorObj.status === 404 || errorObj.message?.includes('does not exist')) {\n        return []\n      }\n      throw error\n    }\n    return data || []\n  }\n\n  /**\n   * Créer une violation de données\n   */\n  async createDataBreach(breach: Partial<GDPRDataBreach>): Promise<GDPRDataBreach> {\n    const { data, error } = await this.supabase\n      .from('gdpr_data_breaches')\n      .insert(breach)\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Notifier la CNIL d'une violation\n   */\n  async notifyCNIL(breachId: string): Promise<void> {\n    // TODO: Implémenter l'envoi réel à la CNIL\n    // Pour l'instant, on met juste à jour le statut\n\n    const { error } = await this.supabase\n      .from('gdpr_data_breaches')\n      .update({\n        cnil_notified: true,\n        cnil_notification_date: new Date().toISOString(),\n        updated_at: new Date().toISOString(),\n      })\n      .eq('id', breachId)\n\n    if (error) throw error\n  }\n\n  // Méthodes privées pour récupérer les données utilisateur\n  private async getUserProfile(userId: string) {\n    const { data } = await this.supabase\n      .from('users')\n      .select('*')\n      .eq('id', userId)\n      .single()\n    return data\n  }\n\n  private async getUserEnrollments(userId: string) {\n    const { data } = await this.supabase\n      .from('enrollments')\n      .select('*')\n      .eq('student_id', userId)\n    return data || []\n  }\n\n  private async getUserPayments(organizationId: string, userId: string) {\n    const { data } = await this.supabase\n      .from('payments')\n      .select('*')\n      .eq('organization_id', organizationId)\n      .eq('student_id', userId)\n    return data || []\n  }\n\n  private async getUserDocuments(organizationId: string, userId: string) {\n    const { data } = await this.supabase\n      .from('generated_documents')\n      .select('*')\n      .eq('organization_id', organizationId)\n      .eq('student_id', userId)\n    return data || []\n  }\n}\n\nexport const gdprService = new GDPRService()\n"],"names":[],"mappings":"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"}