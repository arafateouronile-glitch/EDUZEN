module.exports=[400210,a=>{"use strict";let b=(0,a.i(170106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],400210)},426099,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getAllPrograms(a,b){let c=this.supabase.from("programs").select("*").eq("organization_id",a);b?.isActive!==void 0&&(c=c.eq("is_active",b.isActive)),b?.search&&(c=c.or(`name.ilike.%${b.search}%,code.ilike.%${b.search}%,description.ilike.%${b.search}%`));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e)throw e;return d}async getProgramById(a){let{data:b,error:c}=await this.supabase.from("programs").select(`
        *,
        formations(*)
      `).eq("id",a).single();if(c)throw c;return b}async createProgram(a){let{data:b,error:c}=await this.supabase.from("programs").insert(a).select().single();if(c)throw c;return b}async updateProgram(a,b){let{data:c,error:d}=await this.supabase.from("programs").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteProgram(a){return this.updateProgram(a,{is_active:!1})}async getFormationsByProgram(a){let{data:b,error:c}=await this.supabase.from("formations").select("*").eq("program_id",a).order("created_at",{ascending:!1});if(c)throw c;return b}async getGlobalStats(a){let{data:b,error:c}=await this.supabase.from("programs").select("id, is_active, created_at").eq("organization_id",a);if(c)throw c;let d=b||[],e=d.length,f=d.filter(a=>a.is_active).length,g=d.filter(a=>!a.is_active).length,h=0,i=d.map(a=>a.id);if(i.length>0){let{count:a,error:b}=await this.supabase.from("formations").select("*",{count:"exact",head:!0}).in("program_id",i);if(b)throw b;h=a||0}let j=0;if(i.length>0){let{data:a,error:b}=await this.supabase.from("formations").select("id").in("program_id",i);if(b)throw b;let c=a?.map(a=>a.id)||[];if(c.length>0){let{count:a,error:b}=await this.supabase.from("sessions").select("*",{count:"exact",head:!0}).in("formation_id",c);if(b)throw b;j=a||0}}let k=0;if(i.length>0){let{data:a,error:b}=await this.supabase.from("formations").select("id").in("program_id",i);if(b)throw b;let c=a?.map(a=>a.id)||[];if(c.length>0){let{data:a,error:b}=await this.supabase.from("sessions").select("id").in("formation_id",c);if(b)throw b;let d=a?.map(a=>a.id)||[];if(d.length>0){let{count:a,error:b}=await this.supabase.from("enrollments").select("*",{count:"exact",head:!0}).in("session_id",d);if(b)throw b;k=a||0}}}let l=[{name:"Actifs",value:f,color:"#335ACF"},{name:"Inactifs",value:g,color:"#6B7280"}].filter(a=>a.value>0),m={};return d.forEach(a=>{if(a.created_at){let b=new Date(a.created_at),c=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}`;m[c]=(m[c]||0)+1}}),{total:e,active:f,inactive:g,totalFormations:h,totalSessions:j,totalEnrollments:k,statusData:l,monthlyData:Object.entries(m).sort(([a],[b])=>a.localeCompare(b)).slice(-6).map(([a,b])=>({month:new Date(a+"-01").toLocaleDateString("fr-FR",{month:"short",year:"numeric"}),programmes:b}))}}};a.s(["programService",0,c])},437536,a=>{"use strict";var b=a.i(88780);let c=b.z.object({first_name:b.z.string().min(1,"Le prénom est requis").max(100,"Le prénom est trop long"),last_name:b.z.string().min(1,"Le nom est requis").max(100,"Le nom est trop long"),date_of_birth:b.z.string().optional().or(b.z.literal("")),gender:b.z.enum(["male","female","other"]).optional().or(b.z.literal("")),email:b.z.string().email("Email invalide").optional().or(b.z.literal("")),phone:b.z.string().optional().or(b.z.literal("")),address:b.z.string().optional().or(b.z.literal("")),city:b.z.string().optional().or(b.z.literal("")),class_id:b.z.string().optional().or(b.z.literal("")),enrollment_date:b.z.string().min(1,"La date d'inscription est requise"),guardian_first_name:b.z.string().min(1,"Le prénom du tuteur est requis"),guardian_last_name:b.z.string().min(1,"Le nom du tuteur est requis"),guardian_relationship:b.z.enum(["parent","guardian","other"]).default("parent"),guardian_phone_primary:b.z.string().min(1,"Le téléphone principal du tuteur est requis"),guardian_phone_secondary:b.z.string().optional().or(b.z.literal("")),guardian_email:b.z.string().email("Email invalide").optional().or(b.z.literal("")),guardian_address:b.z.string().optional().or(b.z.literal(""))});b.z.object({first_name:b.z.string().min(1,"Le prénom est requis").max(100,"Le prénom est trop long"),last_name:b.z.string().min(1,"Le nom est requis").max(100,"Le nom est trop long"),date_of_birth:b.z.string().optional().or(b.z.literal("")),gender:b.z.enum(["male","female","other"]).optional().or(b.z.literal("")),email:b.z.string().email("Email invalide").optional().or(b.z.literal("")),phone:b.z.string().optional().or(b.z.literal("")),address:b.z.string().optional().or(b.z.literal("")),city:b.z.string().optional().or(b.z.literal("")),class_id:b.z.string().optional().or(b.z.literal("")),enrollment_date:b.z.string().min(1,"La date d'inscription est requise"),status:b.z.enum(["active","inactive","graduated"]).default("active")});let d=b.z.object({code:b.z.string().min(1,"Le code est requis").max(50,"Le code est trop long"),name:b.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),subtitle:b.z.string().optional().or(b.z.literal("")),description:b.z.string().optional().or(b.z.literal("")),category:b.z.string().optional().or(b.z.literal("")),program_version:b.z.string().optional().or(b.z.literal("")),version_date:b.z.string().optional().or(b.z.literal("")),duration_hours:b.z.string().optional().or(b.z.literal("")),duration_days:b.z.string().optional().or(b.z.literal("")),photo_url:b.z.string().url("URL invalide").optional().or(b.z.literal("")),price:b.z.string().optional().or(b.z.literal("")),price_enterprise:b.z.string().optional().or(b.z.literal("")),price_individual:b.z.string().optional().or(b.z.literal("")),price_freelance:b.z.string().optional().or(b.z.literal("")),currency:b.z.string().default("XOF"),payment_plan:b.z.enum(["full","installment","free"]).default("full"),published_online:b.z.boolean().default(!1),is_public:b.z.boolean().default(!1),eligible_cpf:b.z.boolean().default(!1),cpf_code:b.z.string().optional().or(b.z.literal("")),modalities:b.z.string().optional().or(b.z.literal("")),training_action_type:b.z.string().optional().or(b.z.literal("")),pedagogical_objectives:b.z.string().optional().or(b.z.literal("")),learner_profile:b.z.string().optional().or(b.z.literal("")),training_content:b.z.string().optional().or(b.z.literal("")),execution_follow_up:b.z.string().optional().or(b.z.literal("")),certification_modalities:b.z.string().optional().or(b.z.literal("")),quality:b.z.string().optional().or(b.z.literal("")),accounting_product_config:b.z.string().optional().or(b.z.literal("")),edof_export_fields:b.z.string().optional().or(b.z.literal("")),competence_domains:b.z.string().optional().or(b.z.literal("")),prerequisites:b.z.string().optional().or(b.z.literal("")),capacity_max:b.z.string().optional().or(b.z.literal("")),age_min:b.z.string().optional().or(b.z.literal("")),age_max:b.z.string().optional().or(b.z.literal("")),certification_issued:b.z.boolean().default(!1),is_active:b.z.boolean().default(!0)}),e=b.z.object({program_id:b.z.string().min(1,"Le programme est requis"),code:b.z.string().min(1,"Le code est requis").max(50,"Le code est trop long"),name:b.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),subtitle:b.z.string().optional().or(b.z.literal("")),photo_url:b.z.string().url("URL invalide").optional().or(b.z.literal("")),category:b.z.string().optional().or(b.z.literal("")),description:b.z.string().optional().or(b.z.literal("")),program_version:b.z.string().optional().or(b.z.literal("")),version_date:b.z.string().optional().or(b.z.literal("")),duration_hours:b.z.string().optional().or(b.z.literal("")),duration_days:b.z.string().optional().or(b.z.literal("")),duration_unit:b.z.enum(["hours","days"]).default("hours"),price:b.z.string().optional().or(b.z.literal("")),currency:b.z.string().default("XOF"),payment_plan:b.z.enum(["full","installment","free"]).default("full"),published_online:b.z.boolean().default(!1),eligible_cpf:b.z.boolean().default(!1),cpf_code:b.z.string().optional().or(b.z.literal("")),modalities:b.z.string().optional().or(b.z.literal("")),training_action_type:b.z.string().optional().or(b.z.literal("")),pedagogical_objectives:b.z.string().optional().or(b.z.literal("")),learner_profile:b.z.string().optional().or(b.z.literal("")),training_content:b.z.string().optional().or(b.z.literal("")),execution_follow_up:b.z.string().optional().or(b.z.literal("")),certification_modalities:b.z.string().optional().or(b.z.literal("")),quality:b.z.string().optional().or(b.z.literal("")),accounting_product_config:b.z.string().optional().or(b.z.literal("")),edof_export_fields:b.z.string().optional().or(b.z.literal("")),competence_domains:b.z.string().optional().or(b.z.literal("")),prerequisites:b.z.string().optional().or(b.z.literal("")),capacity_max:b.z.string().optional().or(b.z.literal("")),age_min:b.z.string().optional().or(b.z.literal("")),age_max:b.z.string().optional().or(b.z.literal("")),certification_issued:b.z.boolean().default(!1),is_active:b.z.boolean().default(!0)}),f=b.z.object({formation_id:b.z.string().min(1,"La formation est requise"),name:b.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),code:b.z.string().optional().or(b.z.literal("")),start_date:b.z.string().min(1,"La date de début est requise"),end_date:b.z.string().min(1,"La date de fin est requise"),start_time:b.z.string().optional().or(b.z.literal("")),end_time:b.z.string().optional().or(b.z.literal("")),location:b.z.string().optional().or(b.z.literal("")),capacity_max:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseInt(a);return!isNaN(b)&&b>0},"La capacité maximale doit être un nombre entier positif"),currency:b.z.string().default("XOF"),status:b.z.enum(["planned","ongoing","completed","cancelled"]).default("planned"),teacher_id:b.z.string().optional().or(b.z.literal("")),manager1_id:b.z.string().optional().or(b.z.literal("")),manager2_id:b.z.string().optional().or(b.z.literal("")),inter_entreprise:b.z.boolean().default(!0),sous_traitance:b.z.boolean().default(!1),timezone:b.z.string().default("Europe/Paris"),program_ids:b.z.array(b.z.string()).default([])}).refine(a=>!a.start_date||!a.end_date||new Date(a.end_date)>=new Date(a.start_date),{message:"La date de fin doit être postérieure à la date de début",path:["end_date"]}),g=b.z.object({student_id:b.z.string().min(1,"L'étudiant est requis"),session_id:b.z.string().optional().or(b.z.literal("")),subject:b.z.string().min(1,"Le sujet est requis").max(200,"Le sujet est trop long"),assessment_type:b.z.enum(["pre_formation","hot","cold","manager","instructor","funder","quiz","exam","project","other"]).default("quiz"),score:b.z.string().min(1,"La note est requise").refine(a=>{let b=parseFloat(a);return!isNaN(b)&&b>=0},"La note doit être un nombre valide"),max_score:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>0},"La note maximale doit être un nombre valide supérieur à 0"),notes:b.z.string().optional().or(b.z.literal("")),graded_at:b.z.string().min(1,"La date d'évaluation est requise"),coefficient:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>0},"Le coefficient doit être un nombre valide supérieur à 0"),is_makeup:b.z.boolean().optional().default(!1),original_grade_id:b.z.string().optional().or(b.z.literal("")),appreciation:b.z.string().optional().or(b.z.literal("")),term_period:b.z.enum(["Q1","Q2","Q3","Q4","S1","S2","T1","T2","T3"]).optional().or(b.z.literal("")),academic_year_id:b.z.string().optional().or(b.z.literal(""))}).refine(a=>!a.max_score||!a.score||parseFloat(a.score)<=parseFloat(a.max_score),{message:"La note ne peut pas être supérieure à la note maximale",path:["score"]}),h=b.z.object({student_id:b.z.string().min(1,"L'étudiant est requis"),document_type:b.z.enum(["quote","invoice"]).default("invoice"),invoice_number:b.z.string().optional().or(b.z.literal("")),type:b.z.enum(["tuition","registration","other"]).default("tuition"),issue_date:b.z.string().min(1,"La date d'émission est requise"),due_date:b.z.string().min(1,"La date d'échéance est requise"),amount:b.z.string().min(1,"Le montant est requis").refine(a=>{let b=parseFloat(a);return!isNaN(b)&&b>=0},"Le montant doit être un nombre valide supérieur ou égal à 0"),tax_amount:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>=0},"Le montant de la taxe doit être un nombre valide supérieur ou égal à 0"),currency:b.z.string().default("XOF"),status:b.z.enum(["draft","sent","partial","paid","overdue","cancelled"]).default("draft"),notes:b.z.string().optional().or(b.z.literal("")),enrollment_id:b.z.string().optional().or(b.z.literal(""))}).refine(a=>!a.issue_date||!a.due_date||new Date(a.due_date)>=new Date(a.issue_date),{message:"La date d'échéance doit être postérieure à la date d'émission",path:["due_date"]});b.z.object({invoice_id:b.z.string().min(1,"La facture est requise"),student_id:b.z.string().min(1,"L'étudiant est requis"),amount:b.z.string().min(1,"Le montant est requis").refine(a=>{let b=parseFloat(a);return!isNaN(b)&&b>0},"Le montant doit être un nombre valide supérieur à 0"),currency:b.z.string().default("XOF"),payment_method:b.z.enum(["cash","mobile_money","card","bank_transfer"]).default("cash"),payment_provider:b.z.enum(["mtn","orange","airtel","wave"]).optional().or(b.z.literal("")),transaction_id:b.z.string().optional().or(b.z.literal("")),paid_at:b.z.string().optional().or(b.z.literal("")),notes:b.z.string().optional().or(b.z.literal(""))});let i=b.z.object({student_id:b.z.string().min(1,"L'étudiant est requis"),session_id:b.z.string().min(1,"La session est requise"),enrollment_date:b.z.string().min(1,"La date d'inscription est requise"),status:b.z.enum(["pending","confirmed","completed","cancelled","failed"]).default("confirmed"),payment_status:b.z.enum(["pending","partial","paid","overdue"]).default("pending"),total_amount:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>=0},"Le montant total doit être un nombre valide supérieur ou égal à 0"),paid_amount:b.z.string().optional().or(b.z.literal("")).refine(a=>{if(!a)return!0;let b=parseFloat(a);return!isNaN(b)&&b>=0},"Le montant payé doit être un nombre valide supérieur ou égal à 0")}).refine(a=>{if(a.total_amount&&a.paid_amount){let b=parseFloat(a.total_amount),c=parseFloat(a.paid_amount);if(!isNaN(b)&&!isNaN(c)&&c>b)return!1}return!0},{message:"Le montant payé ne peut pas dépasser le montant total",path:["paid_amount"]});a.s(["enrollmentSchema",0,i,"evaluationSchema",0,g,"formationSchema",0,e,"invoiceSchema",0,h,"programSchema",0,d,"sessionSchema",0,f,"studentSchema",0,c])},555074,a=>{"use strict";var b=a.i(269240);let c=async(a,b)=>(console.warn("videoconferenceService.createMeetingForSession not implemented"),null),d=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getAllSessions(a,b){let c=this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",a);b?.formationId&&(c=c.eq("formation_id",b.formationId)),b?.status&&(c=c.eq("status",b.status)),b?.startDate&&(c=c.gte("start_date",b.startDate)),b?.endDate&&(c=c.lte("end_date",b.endDate)),b?.search&&(c=c.ilike("name",`%${b.search}%`));let{data:d,error:e}=await c.order("start_date",{ascending:!0});if(e)throw e;return d}async getSessionById(a){let{data:b,error:c}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("id",a).single();if(c)throw c;let{data:d,error:e}=await this.supabase.from("session_programs").select(`
        program_id,
        programs(*)
      `).eq("session_id",a);if(e)throw e;return{...b,session_programs:d?.map(a=>a.programs).filter(Boolean)||[]}}async createSession(a,b,c){if(a.formation_id){let{data:b,error:c}=await this.supabase.from("formations").select("id, organization_id").eq("id",a.formation_id).single();if(c)throw console.error("Erreur lors de la vérification de la formation:",c),Error(`Formation non trouv\xe9e: ${c.message}`);if(!b)throw Error("Formation non trouvée");console.log("Formation trouvée:",b)}let{data:d,error:e}=await this.supabase.from("sessions").insert(a).select().single();if(e)throw console.error("Erreur RLS lors de la création de la session:",{code:e.code,message:e.message,details:e.details,hint:e.hint,formation_id:a.formation_id}),e;if(b&&b.length>0&&d){let{data:a}=await this.supabase.from("formations").select("organization_id").eq("id",d.formation_id).single();if(a){let c=b.map(b=>({session_id:d.id,program_id:b,organization_id:a.organization_id})),{error:e}=await this.supabase.from("session_programs").insert(c);e&&console.error("Erreur lors de la création des associations session-programme:",e),a.organization_id&&await this.syncWithCalendars(d.id,a.organization_id,"create").catch(a=>{console.error("Erreur lors de la synchronisation calendrier:",a)}),a.organization_id&&await this.createVideoconferenceMeeting(d.id,a.organization_id).catch(a=>{console.error("Erreur lors de la création de la réunion visioconférence:",a)})}}return console.log("Session créée avec succès:",d),d}async updateSessionPrograms(a,b,c){let{error:d}=await this.supabase.from("session_programs").delete().eq("session_id",a);if(d)throw d;if(b.length>0){let d=b.map(b=>({session_id:a,program_id:b,organization_id:c})),{error:e}=await this.supabase.from("session_programs").insert(d);if(e)throw e}return!0}async getSessionPrograms(a){let{data:b,error:c}=await this.supabase.from("session_programs").select(`
        program_id,
        programs(*)
      `).eq("session_id",a);if(c)throw c;return b?.map(a=>a.programs).filter(Boolean)||[]}async updateSession(a,b){let{data:c}=await this.supabase.from("sessions").select("formation_id, formations(organization_id)").eq("id",a).single(),{data:d,error:e}=await this.supabase.from("sessions").update(b).eq("id",a).select().single();if(e)throw e;let f=c?.formations;return c&&f?.organization_id&&await this.syncWithCalendars(a,f.organization_id,"update").catch(a=>{console.error("Erreur lors de la synchronisation calendrier:",a)}),d}async deleteSession(a){let{data:b}=await this.supabase.from("sessions").select("formation_id, formations(organization_id)").eq("id",a).single(),c=b?.formations;b&&c?.organization_id&&await this.syncWithCalendars(a,c.organization_id,"delete").catch(a=>{console.error("Erreur lors de la suppression de l'événement calendrier:",a)});let{error:d}=await this.supabase.from("sessions").delete().eq("id",a);if(d)throw d}async createVideoconferenceMeeting(a,b){let{data:d}=await this.supabase.from("videoconference_integrations").select("*").eq("organization_id",b).eq("is_active",!0).eq("auto_create_meetings",!0);if(d&&0!==d.length)for(let e of d)try{await c(a,{organizationId:b,provider:e.provider})}catch(a){console.error(`Erreur lors de la cr\xe9ation de r\xe9union avec ${e.provider}:`,a)}}async syncWithCalendars(a,b,c){let{data:d}=await this.supabase.from("calendar_integrations").select("*").eq("organization_id",b).eq("is_active",!0).eq("sync_sessions",!0).eq("create_events_for_sessions",!0);if(d&&0!==d.length)for(let a of d)try{console.warn(`Calendar sync for ${c} not implemented yet for provider ${a.provider}`)}catch(b){console.error(`Erreur lors de la synchronisation avec ${a.provider}:`,b)}}async getUpcomingSessions(a,b=10){let c=new Date().toISOString().split("T")[0],{data:d,error:e}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",a).gte("start_date",c).eq("status","planned").order("start_date",{ascending:!0}).limit(b);if(e)throw e;return d}async getOngoingSessions(a){let b=new Date().toISOString().split("T")[0],{data:c,error:d}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",a).lte("start_date",b).gte("end_date",b).eq("status","ongoing").order("start_date",{ascending:!0});if(d)throw d;return c}async addSessionToFormations(a,b,c){let d=b.map((b,d)=>({session_id:a,formation_id:b,organization_id:c,order_index:d})),{data:e,error:f}=await this.supabase.from("formation_sessions").insert(d).select();if(f)throw f;return e}async removeSessionFromFormation(a,b){let{error:c}=await this.supabase.from("formation_sessions").delete().eq("session_id",a).eq("formation_id",b);if(c)throw c;return!0}async updateSessionFormations(a,b,c){let{error:d}=await this.supabase.from("formation_sessions").delete().eq("session_id",a);if(d)throw d;return b.length>0?this.addSessionToFormations(a,b,c):[]}async getSessionFormations(a){let{data:b,error:c}=await this.supabase.from("formation_sessions").select(`
        formation_id,
        order_index,
        formations(*)
      `).eq("session_id",a).order("order_index",{ascending:!0});if(c)throw c;return b?.map(a=>a.formations).filter(Boolean)||[]}async getFormationSessions(a){let{data:b,error:c}=await this.supabase.from("formation_sessions").select(`
        session_id,
        order_index,
        sessions(*)
      `).eq("formation_id",a).order("order_index",{ascending:!0});if(c)throw c;return b?.map(a=>a.sessions).filter(Boolean)||[]}async createIndependentSession(a,b,c){let{data:d,error:e}=await this.supabase.from("sessions").insert({...a,formation_id:null}).select().single();if(e)throw e;return b&&b.length>0&&d&&await this.updateSessionPrograms(d.id,b,a.organization_id),c&&c.length>0&&d&&await this.addSessionToFormations(d.id,c,a.organization_id),d}};a.s(["sessionService",0,d],555074)},337130,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getAllFormations(a,b){let c=this.supabase.from("formations").select(`
        *,
        programs(*)
      `).eq("organization_id",a);b?.programId&&(c=c.eq("program_id",b.programId)),b?.isActive!==void 0&&(c=c.eq("is_active",b.isActive)),b?.search&&(c=c.or(`name.ilike.%${b.search}%,code.ilike.%${b.search}%,description.ilike.%${b.search}%`));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e)throw e;return d}async getFormationById(a){let{data:b,error:c}=await this.supabase.from("formations").select(`
        *,
        programs(*),
        sessions(*)
      `).eq("id",a).single();if(c)throw c;return b}async createFormation(a){let{data:b,error:c}=await this.supabase.from("formations").insert(a).select().single();if(c)throw c;return b}async updateFormation(a,b){let{data:c,error:d}=await this.supabase.from("formations").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteFormation(a){return this.updateFormation(a,{is_active:!1})}async getSessionsByFormation(a){let{data:b,error:c}=await this.supabase.from("sessions").select("*").eq("formation_id",a).order("start_date",{ascending:!0});if(c)throw c;return b}async getAllSessionsForFormation(a){let{data:b,error:c}=await this.supabase.from("formation_sessions").select(`
        session_id,
        order_index,
        sessions(*)
      `).eq("formation_id",a).order("order_index",{ascending:!0});if(c)throw c;let{data:d,error:e}=await this.supabase.from("sessions").select("*").eq("formation_id",a).order("start_date",{ascending:!0});if(e)throw e;let f=b?.map(a=>a.sessions).filter(Boolean)||[],g=[...f],h=new Set(f.map(a=>a.id));for(let a of d||[])h.has(a.id)||g.push(a);return g}async addSessionsToFormation(a,b,c){let d=b.map((b,d)=>({formation_id:a,session_id:b,organization_id:c,order_index:d})),{data:e,error:f}=await this.supabase.from("formation_sessions").insert(d).select();if(f)throw f;return e}async removeSessionFromFormation(a,b){let{error:c}=await this.supabase.from("formation_sessions").delete().eq("formation_id",a).eq("session_id",b);if(c)throw c;return!0}async updateFormationSessions(a,b,c){let{error:d}=await this.supabase.from("formation_sessions").delete().eq("formation_id",a);if(d)throw d;return b.length>0?this.addSessionsToFormation(a,b,c):[]}async getFormationWithAllSessions(a){let b=await this.getFormationById(a);if(!b)return null;let c=await this.getAllSessionsForFormation(a);return{...b,all_sessions:c}}};a.s(["formationService",0,c])},518523,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(633508);let e=(0,a.i(170106).default)("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);var f=a.i(533441),g=a.i(497895),h=a.i(340695),i=a.i(676504),j=a.i(254161);function k({options:a,selected:k,onChange:l,placeholder:m="Sélectionner...",className:n}){let[o,p]=c.useState(!1);return(0,b.jsx)("div",{className:(0,g.cn)("flex flex-col gap-2",n),children:(0,b.jsxs)(i.DropdownMenu,{open:o,onOpenChange:p,children:[(0,b.jsx)(i.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(h.Button,{variant:"outline",role:"combobox","aria-expanded":o,className:"w-full justify-between text-left font-normal h-auto min-h-[42px] py-2 px-3 bg-white border-gray-200 hover:bg-gray-50",children:[(0,b.jsxs)("div",{className:"flex flex-wrap gap-1.5 w-full items-center",children:[0===k.length&&(0,b.jsx)("span",{className:"text-muted-foreground text-sm",children:m}),k.length>0&&k.map(c=>{let e=a.find(a=>a.value===c);return(0,b.jsxs)(j.Badge,{variant:"secondary",className:"mr-0.5 rounded-md px-1.5 py-0.5 text-xs font-medium bg-brand-blue-ghost text-brand-blue hover:bg-brand-blue/20 border-brand-blue/10 transition-colors flex items-center gap-1",onClick:a=>{a.stopPropagation(),l(k.filter(a=>a!==c))},children:[e?.label||c,(0,b.jsx)("div",{className:"ml-0.5 rounded-full p-0.5 hover:bg-brand-blue/20 cursor-pointer",children:(0,b.jsx)(d.X,{className:"h-3 w-3"})})]},c)})]}),(0,b.jsx)(e,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,b.jsxs)(i.DropdownMenuContent,{align:"start",className:"w-[var(--radix-dropdown-menu-trigger-width)] p-1 max-h-60 overflow-y-auto",children:[a.map(a=>(0,b.jsxs)("div",{className:(0,g.cn)("relative flex cursor-pointer select-none items-center rounded-sm py-2 pl-8 pr-2 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",k.includes(a.value)?"bg-accent/50 font-medium":""),onClick:b=>{var c;b.preventDefault(),c=a.value,k.includes(c)?l(k.filter(a=>a!==c)):l([...k,c])},children:[(0,b.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:k.includes(a.value)&&(0,b.jsx)(f.Check,{className:"h-4 w-4 text-brand-blue"})}),a.label]},a.value)),0===a.length&&(0,b.jsx)("div",{className:"py-3 px-2 text-center text-sm text-muted-foreground",children:"Aucune option disponible"})]})]})})}a.s(["MultiSelect",()=>k],518523)}];

//# sourceMappingURL=_38da2789._.js.map