module.exports=[898958,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(370025),f=a.i(433217),g=a.i(937927),h=a.i(695245),i=a.i(159501),j=a.i(88780),k=a.i(913216),l=a.i(266275),m=a.i(269240),n=a.i(340695),o=a.i(219897),p=a.i(965733),q=a.i(205522),r=a.i(546893),s=a.i(917171),t=a.i(400210),u=a.i(469769),v=a.i(114548),w=a.i(773320),x=a.i(633508),y=a.i(915618),z=a.i(699464),A=a.i(781560),B=a.i(953722),C=a.i(452495),D=a.i(238246),E=a.i(864037);a.i(460355);var F=a.i(346271),G=a.i(497895);let H=j.z.object({title:j.z.string().min(3,"Le titre doit contenir au moins 3 caractères"),slug:j.z.string().min(3,"Le slug doit contenir au moins 3 caractères").regex(/^[a-z0-9-]+$/,"Le slug ne peut contenir que des lettres minuscules, chiffres et tirets"),short_description:j.z.string().optional(),description:j.z.string().optional(),difficulty_level:j.z.enum(["beginner","intermediate","advanced"]).default("beginner"),estimated_duration_hours:j.z.number().min(0).optional(),price:j.z.number().min(0).optional(),currency:j.z.string().default("XOF"),is_published:j.z.boolean().default(!1),is_featured:j.z.boolean().default(!1),instructor_id:j.z.string().optional(),formation_id:j.z.string().optional()});function I(){let a=(0,d.useParams)(),j=(0,d.useRouter)(),I=a.slug,{user:J}=(0,k.useAuth)(),{addToast:K}=(0,E.useToast)(),L=(0,g.useQueryClient)(),M=(0,m.createClient)(),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)(null),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)({id:"",title:"",description:"",order_index:0}),{data:X,isLoading:Y}=(0,f.useQuery)({queryKey:["course",I,J?.organization_id],queryFn:async()=>await l.elearningService.getCourseBySlug(I,J?.organization_id||""),enabled:!!I&&!!J?.organization_id}),Z=async()=>{await L.invalidateQueries({queryKey:["course",I,J?.organization_id]})},{data:$}=(0,f.useQuery)({queryKey:["teachers",J?.organization_id],queryFn:async()=>{let{data:a,error:b}=await M.from("users").select("id, full_name, email").eq("organization_id",J?.organization_id||"").eq("role","teacher").eq("is_active",!0);if(b)throw b;return a||[]},enabled:!!J?.organization_id}),{data:_}=(0,f.useQuery)({queryKey:["formations",J?.organization_id],queryFn:async()=>{let{data:a,error:b}=await M.from("formations").select("id, name, code").eq("organization_id",J?.organization_id||"").eq("is_active",!0);if(b)throw b;return a||[]},enabled:!!J?.organization_id}),{register:aa,handleSubmit:ab,formState:{errors:ac},watch:ad,setValue:ae,reset:af}=(0,h.useForm)({resolver:(0,i.zodResolver)(H),mode:"onChange",defaultValues:{difficulty_level:"beginner",currency:"XOF",is_published:!1,is_featured:!1}});(0,c.useEffect)(()=>{X&&(af({title:X.title||"",slug:X.slug||"",short_description:X.short_description||"",description:X.description||"",difficulty_level:X.difficulty_level||"beginner",estimated_duration_hours:X.estimated_duration_hours?Number(X.estimated_duration_hours):void 0,price:X.price?Number(X.price):0,currency:X.currency||"XOF",is_published:!!X.is_published,is_featured:!!X.is_featured,instructor_id:X.instructor_id||void 0,formation_id:X.formation_id||void 0}),X.thumbnail_url&&Q(X.thumbnail_url))},[X,af]);let ag=(0,e.useMutation)({mutationFn:async a=>{if(!J?.organization_id)throw Error("Organization ID manquant");if(!X?.id)throw Error("Course ID manquant");let b=X.thumbnail_url||null;if(N){let a=N.name.split(".").pop(),c=`${J.organization_id}/courses/thumbnails/${Date.now()}.${a}`,d=null;for(let a of["course-thumbnails","elearning-media","course-media"]){let{error:e}=await M.storage.from(a).upload(c,N,{cacheControl:"3600",upsert:!1});if(!e){let{data:e}=M.storage.from(a).getPublicUrl(c);b=e.publicUrl,d=null;break}d=e}if(d)throw console.error("Erreur upload miniature (storage):",d),Error(d?.message||"Erreur lors de l'upload de la miniature (bucket course-thumbnails/elearning-media/course-media).")}let c=a.is_published?X.published_at||new Date().toISOString():null;return l.elearningService.updateCourse(X.id,{title:a.title,slug:a.slug,short_description:a.short_description||null,description:a.description||null,difficulty_level:a.difficulty_level,estimated_duration_hours:a.estimated_duration_hours||null,price:a.price||0,currency:a.currency,is_published:a.is_published,is_featured:a.is_featured,instructor_id:a.instructor_id||J.id,formation_id:a.formation_id||null,thumbnail_url:b,published_at:c})},onSuccess:async a=>{K({type:"success",title:"Séquence mise à jour",description:"La séquence a été mise à jour avec succès."}),await Z(),a?.slug&&a.slug!==I&&j.replace(`/dashboard/elearning/courses/${a.slug}/edit`)},onError:a=>{K({type:"error",title:"Erreur",description:a.message||"Une erreur est survenue lors de la mise à jour"})}}),ah=(0,e.useMutation)({mutationFn:async()=>{if(!X?.id)throw Error("Course ID manquant");let a=Math.max(0,...(X.sections||[]).map(a=>Number(a.order_index??0)))+1;return l.elearningService.createSection({course_id:X.id,title:V.title,description:V.description||null,order_index:V.order_index??a})},onSuccess:async()=>{K({type:"success",title:"Section créée",description:"La section a été créée."}),S(!1),W({id:"",title:"",description:"",order_index:0}),await Z()},onError:a=>{K({type:"error",title:"Erreur",description:a?.message||"Impossible de créer la section."})}}),ai=(0,e.useMutation)({mutationFn:async()=>{if(!V.id)throw Error("Section ID manquant");return l.elearningService.updateSection(V.id,{title:V.title,description:V.description||null,order_index:V.order_index})},onSuccess:async()=>{K({type:"success",title:"Section mise à jour",description:"La section a été mise à jour."}),U(!1),W({id:"",title:"",description:"",order_index:0}),await Z()},onError:a=>{K({type:"error",title:"Erreur",description:a?.message||"Impossible de mettre à jour la section."})}}),aj=(0,e.useMutation)({mutationFn:async a=>{await l.elearningService.deleteSection(a)},onSuccess:async()=>{K({type:"success",title:"Section supprimée",description:"La section a été supprimée."}),await Z()},onError:a=>{K({type:"error",title:"Erreur",description:a?.message||"Impossible de supprimer la section."})}}),ak=(0,e.useMutation)({mutationFn:async a=>{await l.elearningService.deleteLesson(a)},onSuccess:async()=>{K({type:"success",title:"Leçon supprimée",description:"La leçon a été supprimée."}),await Z()},onError:a=>{K({type:"error",title:"Erreur",description:a?.message||"Impossible de supprimer la leçon."})}});if(Y||!X)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[300px]",children:(0,b.jsx)("p",{children:"Chargement..."})});let al=[...X.sections||[]].sort((a,b)=>Number(a.order_index??0)-Number(b.order_index??0)),am=[...X.lessons||[]].sort((a,b)=>Number(a.order_index??0)-Number(b.order_index??0)),an=am.reduce((a,b)=>{let c=b.section_id||"no-section";return a[c]=a[c]||[],a[c].push(b),a},{});return(0,b.jsxs)(F.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-8 pb-8 max-w-5xl mx-auto p-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(D.default,{href:`/dashboard/elearning/courses/${X.slug}`,children:(0,b.jsx)(n.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(t.ArrowLeft,{className:"h-4 w-4"})})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-brand-blue-ghost rounded-xl",children:(0,b.jsx)(u.GraduationCap,{className:"h-6 w-6 text-brand-blue"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Modifier la séquence"}),(0,b.jsx)("p",{className:"text-gray-500 mt-1",children:X.title})]})]})]}),(0,b.jsxs)("form",{onSubmit:ab(a=>ag.mutate(a)),className:"space-y-6",children:[(0,b.jsxs)(o.GlassCard,{variant:"premium",className:"p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Informations principales"}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Titre de la séquence *"}),(0,b.jsx)("input",{type:"text",...aa("title"),onChange:a=>{let b=a.target.value;ae("title",b),b&&ae("slug",b.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""))},className:(0,G.cn)("w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all",ac.title?"border-red-500":"border-gray-200"),placeholder:"Ex: Introduction à React"}),ac.title&&(0,b.jsx)("p",{className:"text-sm text-red-600 mt-1",children:ac.title.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slug (URL) *"}),(0,b.jsx)("input",{type:"text",...aa("slug"),className:(0,G.cn)("w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all bg-gray-50",ac.slug?"border-red-500":"border-gray-200"),placeholder:"introduction-a-react"}),ac.slug&&(0,b.jsx)("p",{className:"text-sm text-red-600 mt-1",children:ac.slug.message}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"URL : /courses/[slug]"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description courte"}),(0,b.jsx)("textarea",{...aa("short_description"),rows:2,className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all resize-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description complète"}),(0,b.jsx)("textarea",{...aa("description"),rows:6,className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all resize-none"})]})]})]}),(0,b.jsxs)(o.GlassCard,{variant:"premium",className:"p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Paramètres"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Niveau de difficulté"}),(0,b.jsxs)("select",{...aa("difficulty_level"),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all",children:[(0,b.jsx)("option",{value:"beginner",children:"Débutant"}),(0,b.jsx)("option",{value:"intermediate",children:"Intermédiaire"}),(0,b.jsx)("option",{value:"advanced",children:"Avancé"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Durée estimée (heures)"}),(0,b.jsx)("input",{type:"number",...aa("estimated_duration_hours",{valueAsNumber:!0}),min:"0",step:"0.5",className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"number",...aa("price",{valueAsNumber:!0}),min:"0",step:"0.01",className:"flex-1 px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all"}),(0,b.jsxs)("select",{...aa("currency"),className:"w-24 px-3 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all",children:[(0,b.jsx)("option",{value:"XOF",children:"XOF"}),(0,b.jsx)("option",{value:"EUR",children:"EUR"}),(0,b.jsx)("option",{value:"USD",children:"USD"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enseignant"}),(0,b.jsxs)("select",{...aa("instructor_id"),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all",children:[(0,b.jsx)("option",{value:"",children:"Moi-même"}),$?.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.full_name," (",a.email,")"]},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Formation associée (optionnel)"}),(0,b.jsxs)("select",{...aa("formation_id"),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all",children:[(0,b.jsx)("option",{value:"",children:"Aucune"}),_?.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.name," (",a.code,")"]},a.id))]})]})]})]}),(0,b.jsxs)(o.GlassCard,{variant:"premium",className:"p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Miniature"}),(0,b.jsx)("div",{className:"space-y-4",children:P?(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("img",{src:P,alt:"Aperçu",className:"w-full h-64 object-cover rounded-lg border border-gray-200"}),(0,b.jsx)("button",{type:"button",onClick:()=>{O(null),Q(null)},className:"absolute top-2 right-2 p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",children:(0,b.jsx)(x.X,{className:"h-4 w-4"})})]}):(0,b.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-12 text-center hover:border-brand-blue transition-colors",children:[(0,b.jsx)(w.Upload,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600 mb-2",children:"Cliquez pour télécharger une miniature"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"PNG, JPG jusqu'à 5MB"}),(0,b.jsx)("input",{type:"file",accept:"image/*",onChange:a=>{let b=a.target.files?.[0];if(b){O(b);let a=new FileReader;a.onloadend=()=>Q(a.result),a.readAsDataURL(b)}},className:"hidden",id:"thumbnail-upload"}),(0,b.jsx)("label",{htmlFor:"thumbnail-upload",className:"mt-4 inline-block px-4 py-2 bg-brand-blue text-white rounded-lg hover:bg-brand-blue/90 transition-colors cursor-pointer",children:"Choisir un fichier"})]})})]}),(0,b.jsxs)(o.GlassCard,{variant:"premium",className:"p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Options de publication"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",...aa("is_published"),className:"w-5 h-5 text-brand-blue border-gray-300 rounded focus:ring-brand-blue"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium text-gray-900",children:"Visible pour les apprenants"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Publier la séquence sur le catalogue apprenant"})]})]}),(0,b.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",...aa("is_featured"),className:"w-5 h-5 text-brand-blue border-gray-300 rounded focus:ring-brand-blue"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium text-gray-900",children:"Mettre en vedette"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Afficher dans la sélection du moment"})]})]})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,b.jsx)(D.default,{href:`/dashboard/elearning/courses/${X.slug}`,children:(0,b.jsx)(n.Button,{variant:"ghost",type:"button",children:"Annuler"})}),(0,b.jsx)(n.Button,{type:"submit",disabled:ag.isPending,className:"bg-brand-blue hover:bg-brand-blue/90 text-white shadow-lg shadow-brand-blue/20",children:ag.isPending?(0,b.jsx)(b.Fragment,{children:"Enregistrement..."}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.Save,{className:"h-4 w-4 mr-2"}),"Enregistrer"]})})]})]}),(0,b.jsxs)(o.GlassCard,{variant:"premium",className:"p-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Contenu de la séquence"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Gérez les sections et les leçons en défilant sur cette même page."})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsxs)(n.Button,{type:"button",variant:"outline",onClick:()=>S(!0),children:[(0,b.jsx)(y.Plus,{className:"h-4 w-4 mr-2"}),"Nouvelle section"]}),(0,b.jsx)(D.default,{href:`/dashboard/elearning/courses/${X.slug}/lessons/new`,children:(0,b.jsxs)(n.Button,{type:"button",className:"bg-brand-blue hover:bg-brand-blue/90 text-white",children:[(0,b.jsx)(y.Plus,{className:"h-4 w-4 mr-2"}),"Nouvelle leçon"]})})]})]}),(0,b.jsx)("div",{className:"space-y-6",children:0===al.length&&0===am.length?(0,b.jsxs)("div",{className:"text-center py-10 border-2 border-dashed border-gray-200 rounded-xl",children:[(0,b.jsx)(B.BookOpen,{className:"h-10 w-10 text-gray-300 mx-auto mb-3"}),(0,b.jsx)("p",{className:"text-gray-600 font-medium",children:"Aucune section / leçon pour le moment"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Crée une section puis ajoute des leçons."})]}):(0,b.jsxs)(b.Fragment,{children:[al.map(a=>{let c=an[a.id]||[];return(0,b.jsxs)("div",{className:"border border-gray-200 rounded-xl bg-white",children:[(0,b.jsxs)("div",{className:"p-4 flex flex-col md:flex-row md:items-center justify-between gap-3 border-b border-gray-100",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900 truncate",children:a.title}),(0,b.jsx)("span",{className:"text-xs text-gray-400",children:"•"}),(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:[c.length," leçon(s)"]})]}),a.description?(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:a.description}):null]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsxs)(n.Button,{type:"button",variant:"outline",onClick:()=>{W({id:a.id,title:a.title||"",description:a.description||"",order_index:Number(a.order_index??0)}),U(!0)},children:[(0,b.jsx)(z.Pencil,{className:"h-4 w-4 mr-2"}),"Modifier"]}),(0,b.jsx)(D.default,{href:`/dashboard/elearning/courses/${X.slug}/lessons/new`,children:(0,b.jsxs)(n.Button,{type:"button",variant:"outline",children:[(0,b.jsx)(y.Plus,{className:"h-4 w-4 mr-2"}),"Ajouter une leçon"]})}),(0,b.jsxs)(n.Button,{type:"button",variant:"outline",className:"border-red-200 text-red-700 hover:bg-red-50",onClick:()=>{window.confirm(`Supprimer la section "${a.title}" ? Les le\xe7ons seront conserv\xe9es (sans section).`)&&aj.mutate(a.id)},disabled:aj.isPending,children:[(0,b.jsx)(A.Trash2,{className:"h-4 w-4 mr-2"}),"Supprimer"]})]})]}),(0,b.jsx)("div",{className:"p-4 space-y-2",children:0===c.length?(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Aucune leçon dans cette section."}):c.map(a=>(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-2 p-3 border rounded-lg",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-gray-900 truncate",children:a.title}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:["Type: ",a.lesson_type||"text"," • Ordre: ",a.order_index??0]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(D.default,{href:`/dashboard/elearning/courses/${X.slug}/lessons/${a.slug}`,children:(0,b.jsxs)(n.Button,{type:"button",variant:"outline",size:"sm",children:[(0,b.jsx)(C.ExternalLink,{className:"h-4 w-4 mr-2"}),"Ouvrir"]})}),(0,b.jsx)(D.default,{href:`/dashboard/elearning/courses/${X.slug}/lessons/${a.slug}/edit`,children:(0,b.jsxs)(n.Button,{type:"button",variant:"outline",size:"sm",children:[(0,b.jsx)(z.Pencil,{className:"h-4 w-4 mr-2"}),"Modifier la leçon"]})}),(0,b.jsxs)(n.Button,{type:"button",variant:"outline",size:"sm",className:"border-red-200 text-red-700 hover:bg-red-50",onClick:()=>{window.confirm(`Supprimer la le\xe7on "${a.title}" ?`)&&ak.mutate(a.id)},disabled:ak.isPending,children:[(0,b.jsx)(A.Trash2,{className:"h-4 w-4 mr-2"}),"Supprimer"]})]})]},a.id))})]},a.id)}),an["no-section"]?.length?(0,b.jsxs)("div",{className:"border border-gray-200 rounded-xl bg-white",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-gray-100",children:[(0,b.jsx)("p",{className:"font-semibold text-gray-900",children:"Sans section"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Leçons non rattachées à une section."})]}),(0,b.jsx)("div",{className:"p-4 space-y-2",children:an["no-section"].map(a=>(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-2 p-3 border rounded-lg",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-gray-900 truncate",children:a.title}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:["Type: ",a.lesson_type||"text"," • Ordre: ",a.order_index??0]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(D.default,{href:`/dashboard/elearning/courses/${X.slug}/lessons/${a.slug}`,children:(0,b.jsxs)(n.Button,{type:"button",variant:"outline",size:"sm",children:[(0,b.jsx)(C.ExternalLink,{className:"h-4 w-4 mr-2"}),"Ouvrir"]})}),(0,b.jsx)(D.default,{href:`/dashboard/elearning/courses/${X.slug}/lessons/${a.slug}/edit`,children:(0,b.jsxs)(n.Button,{type:"button",variant:"outline",size:"sm",children:[(0,b.jsx)(z.Pencil,{className:"h-4 w-4 mr-2"}),"Modifier la leçon"]})}),(0,b.jsxs)(n.Button,{type:"button",variant:"outline",size:"sm",className:"border-red-200 text-red-700 hover:bg-red-50",onClick:()=>{window.confirm(`Supprimer la le\xe7on "${a.title}" ?`)&&ak.mutate(a.id)},disabled:ak.isPending,children:[(0,b.jsx)(A.Trash2,{className:"h-4 w-4 mr-2"}),"Supprimer"]})]})]},a.id))})]}):null]})})]}),(0,b.jsx)(p.Dialog,{open:R,onOpenChange:S,children:(0,b.jsxs)(p.DialogContent,{className:"sm:max-w-[520px]",children:[(0,b.jsxs)(p.DialogHeader,{children:[(0,b.jsx)(p.DialogTitle,{children:"Nouvelle section"}),(0,b.jsx)(p.DialogDescription,{children:"Ajoute une section pour organiser les leçons."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{htmlFor:"section-title",children:"Titre *"}),(0,b.jsx)(q.Input,{id:"section-title",value:V.title,onChange:a=>W(b=>({...b,title:a.target.value})),placeholder:"Ex: Module 1"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{htmlFor:"section-desc",children:"Description"}),(0,b.jsx)(r.Textarea,{id:"section-desc",value:V.description,onChange:a=>W(b=>({...b,description:a.target.value})),placeholder:"Description de la section..."})]})]}),(0,b.jsxs)(p.DialogFooter,{children:[(0,b.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>S(!1),children:"Annuler"}),(0,b.jsx)(n.Button,{type:"button",onClick:()=>{V.title.trim()?ah.mutate():K({type:"error",title:"Titre requis",description:"Veuillez saisir un titre."})},disabled:ah.isPending,children:ah.isPending?"Création...":"Créer"})]})]})}),(0,b.jsx)(p.Dialog,{open:T,onOpenChange:U,children:(0,b.jsxs)(p.DialogContent,{className:"sm:max-w-[520px]",children:[(0,b.jsxs)(p.DialogHeader,{children:[(0,b.jsx)(p.DialogTitle,{children:"Modifier la section"}),(0,b.jsx)(p.DialogDescription,{children:"Met à jour le titre et la description."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{htmlFor:"section-title-edit",children:"Titre *"}),(0,b.jsx)(q.Input,{id:"section-title-edit",value:V.title,onChange:a=>W(b=>({...b,title:a.target.value}))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{htmlFor:"section-desc-edit",children:"Description"}),(0,b.jsx)(r.Textarea,{id:"section-desc-edit",value:V.description,onChange:a=>W(b=>({...b,description:a.target.value}))})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(s.Label,{htmlFor:"section-order",children:"Ordre"}),(0,b.jsx)(q.Input,{id:"section-order",type:"number",value:V.order_index,onChange:a=>W(b=>({...b,order_index:Number(a.target.value||0)}))})]})]}),(0,b.jsxs)(p.DialogFooter,{children:[(0,b.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>U(!1),children:"Annuler"}),(0,b.jsx)(n.Button,{type:"button",onClick:()=>{V.title.trim()?ai.mutate():K({type:"error",title:"Titre requis",description:"Veuillez saisir un titre."})},disabled:ai.isPending,children:ai.isPending?"Enregistrement...":"Enregistrer"})]})]})})]})}a.s(["default",()=>I])}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_elearning_courses_%5Bslug%5D_edit_page_tsx_69f26cac._.js.map