module.exports=[915618,a=>{"use strict";let b=(0,a.i(170106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],915618)},177156,a=>{"use strict";let b=(0,a.i(170106).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>b],177156)},621958,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);let e=c.createContext(void 0);function f({value:a,defaultValue:f,onValueChange:g,children:h,className:i}){let j=void 0!==a,[k,l]=c.useState(f??"");c.useEffect(()=>{j||void 0===f||l(f)},[f]);let m=j?a:k,n=c.useCallback(a=>{j||l(a),g?.(a)},[j,g]);return(0,b.jsx)(e.Provider,{value:{value:m,onValueChange:n},children:(0,b.jsx)("div",{className:(0,d.cn)("w-full",i),children:h})})}function g(){let a=c.useContext(e);if(!a)throw Error("Tabs components must be used within a Tabs component");return a}function h({children:a,className:c}){return(0,b.jsx)("div",{className:(0,d.cn)("inline-flex h-10 items-center justify-center rounded-lg bg-bg-gray-100 p-1 text-text-tertiary",c),children:a})}function i({value:a,children:c,className:e}){let{value:f,onValueChange:h}=g(),i=f===a;return(0,b.jsx)("button",{type:"button",onClick:()=>h(a),className:(0,d.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-outline-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",i?"bg-white text-text-primary shadow-sm":"text-text-tertiary hover:text-text-primary",e),children:c})}function j({value:a,children:c,className:e}){let{value:f}=g();return f!==a?null:(0,b.jsx)("div",{className:(0,d.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),children:c})}a.s(["Tabs",()=>f,"TabsContent",()=>j,"TabsList",()=>h,"TabsTrigger",()=>i])},821374,a=>{"use strict";let b=(0,a.i(170106).default)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);a.s(["Star",()=>b],821374)},976472,a=>{"use strict";let b=(0,a.i(170106).default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);a.s(["Heart",()=>b],976472)},179257,a=>{"use strict";let b=(0,a.i(170106).default)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);a.s(["Link",()=>b],179257)},235792,216686,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getCategories(a){let{data:b,error:c}=await this.supabase.from("resource_categories").select("*").eq("organization_id",a).eq("is_active",!0).order("order_index",{ascending:!0});if(c)throw c;return b}async createCategory(a){let{data:b,error:c}=await this.supabase.from("resource_categories").insert(a).select().single();if(c)throw c;return b}async updateCategory(a,b){let{data:c,error:d}=await this.supabase.from("resource_categories").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteCategory(a){let{error:b}=await this.supabase.from("resource_categories").delete().eq("id",a);if(b)throw b}async getResources(a,b){try{let c=this.supabase.from("educational_resources").select(`
          *,
          category:resource_categories(*),
          author:users!author_id(id, full_name, email)
        `).eq("organization_id",a).eq("status","published");b?.categoryId&&(c=c.eq("category_id",b.categoryId)),b?.resourceType&&(c=c.eq("resource_type",b.resourceType)),b?.search&&(c=c.or(`title.ilike.%${b.search}%,description.ilike.%${b.search}%`)),b?.featured&&(c=c.eq("is_featured",!0)),b?.tags&&b.tags.length>0&&(c=c.contains("tags",b.tags));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e){if("PGRST116"===e.code||"PGRST200"===e.code||"42P01"===e.code||"PGRST301"===e.code||400===e.status||"400"===e.code||e.message?.includes("relation")||e.message?.includes("relationship")||e.message?.includes("does not exist")||e.message?.includes("schema cache"))return[];throw e}return d||[]}catch(a){if(a?.code==="PGRST116"||a?.code==="PGRST200"||a?.code==="42P01"||a?.code==="PGRST301"||a?.status===400||a?.code==="400"||a?.message?.includes("relation")||a?.message?.includes("relationship")||a?.message?.includes("does not exist")||a?.message?.includes("schema cache"))return console.warn("Table educational_resources does not exist yet or invalid query:",a?.message||String(a)),[];throw a}}async getResourceBySlug(a,b){try{let{data:c,error:d}=await this.supabase.from("educational_resources").select(`
          *,
          category:resource_categories(*),
          author:users!author_id(id, full_name, email),
          versions:resource_versions(*)
      `).eq("slug",a).eq("organization_id",b).eq("status","published").single();if(d)throw d;return await this.recordView(c.id),c}catch(a){throw(a?.code==="PGRST116"||a?.code==="42P01")&&console.warn("Table educational_resources does not exist yet:",a?.message||String(a)),a}}async createResource(a){let{data:b,error:c}=await this.supabase.from("educational_resources").insert(a).select().single();if(c)throw c;return b}async updateResource(a,b){let{data:c,error:d}=await this.supabase.from("educational_resources").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteResource(a){let{error:b}=await this.supabase.from("educational_resources").delete().eq("id",a);if(b)throw b}async addToFavorites(a,b){let{data:c,error:d}=await this.supabase.from("resource_favorites").insert({user_id:a,resource_id:b}).select().single();if(d)throw d;try{await this.supabase.rpc("increment",{table_name:"educational_resources",column_name:"favorite_count",row_id:b})}catch(a){console.warn("RPC increment not available, skipping favorite_count increment")}return c}async removeFromFavorites(a,b){let{error:c}=await this.supabase.from("resource_favorites").delete().eq("user_id",a).eq("resource_id",b);if(c)throw c;let{data:d}=await this.supabase.from("educational_resources").select("favorite_count").eq("id",b).single();d&&(d.favorite_count??0)>0&&await this.supabase.from("educational_resources").update({favorite_count:(d.favorite_count??0)-1}).eq("id",b)}async isFavorite(a,b){let{data:c,error:d}=await this.supabase.from("resource_favorites").select("id").eq("user_id",a).eq("resource_id",b).maybeSingle();if(d)throw d;return!!c}async getUserFavorites(a){let{data:b,error:c}=await this.supabase.from("resource_favorites").select("*, resource:educational_resources(*, category:resource_categories(*))").eq("user_id",a).order("created_at",{ascending:!1});if(c)throw c;return b}async recordDownload(a,b,c,d){let{data:e,error:f}=await this.supabase.from("resource_downloads").insert({resource_id:a,user_id:b,ip_address:c,user_agent:d}).select().single();if(f)throw f;return e}async getResourceDownloads(a){let{data:b,error:c}=await this.supabase.from("resource_downloads").select("*, user:users(id, full_name, email)").eq("resource_id",a).order("downloaded_at",{ascending:!1});if(c)throw c;return b}async recordView(a,b,c,d,e){let{data:f,error:g}=await this.supabase.from("resource_views").insert({resource_id:a,user_id:b,view_duration_seconds:c,ip_address:d,user_agent:e}).select().single();if(g)throw g;return f}async getCollections(a,b){let c=this.supabase.from("resource_collections").select("*, user:users(id, full_name, email)").eq("organization_id",a);b?.userId&&(c=c.eq("user_id",b.userId)),b?.isPublic!==void 0&&(c=c.eq("is_public",b.isPublic)),b?.isFeatured&&(c=c.eq("is_featured",!0));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e)throw e;return d}async getCollectionById(a){let{data:b,error:c}=await this.supabase.from("resource_collections").select(`
        *,
        user:users(id, full_name, email),
        resources:collection_resources(*, resource:educational_resources(*, category:resource_categories(*)))
      `).eq("id",a).single();if(c)throw c;return b}async createCollection(a){let{data:b,error:c}=await this.supabase.from("resource_collections").insert(a).select().single();if(c)throw c;return b}async addResourceToCollection(a,b,c){let{data:d,error:e}=await this.supabase.from("collection_resources").insert({collection_id:a,resource_id:b,added_by:c}).select().single();if(e)throw e;return d}async removeResourceFromCollection(a,b){let{error:c}=await this.supabase.from("collection_resources").delete().eq("collection_id",a).eq("resource_id",b);if(c)throw c}async getResourceComments(a){let{data:b,error:c}=await this.supabase.from("resource_comments").select("*, user:users(id, full_name, email), replies:resource_comments(*)").eq("resource_id",a).is("parent_id",null).order("created_at",{ascending:!1});if(c)throw c;return b}async createComment(a){let{data:b,error:c}=await this.supabase.from("resource_comments").insert(a).select(`
        *,
        user:users(id, full_name, email)
      `).single();if(c)throw c;return b}async updateComment(a,b){let{data:c,error:d}=await this.supabase.from("resource_comments").update({content:b,is_edited:!0}).eq("id",a).select().single();if(d)throw d;return c}async deleteComment(a){let{error:b}=await this.supabase.from("resource_comments").delete().eq("id",a);if(b)throw b}async createRating(a){let{data:b,error:c}=await this.supabase.from("resource_ratings").insert(a).select().single();if(c)throw c;return b}async updateRating(a,b,c){let{data:d,error:e}=await this.supabase.from("resource_ratings").update({rating:b,comment:c}).eq("id",a).select().single();if(e)throw e;return d}async getResourceRatings(a){let{data:b,error:c}=await this.supabase.from("resource_ratings").select("*, user:users(id, full_name, email)").eq("resource_id",a).order("created_at",{ascending:!1});if(c)throw c;return b}async getResourceRatingStats(a){let{data:b,error:c}=await this.supabase.from("resource_ratings").select("rating").eq("resource_id",a);if(c)throw c;let d={total:b.length,average:0,distribution:{1:0,2:0,3:0,4:0,5:0}};if(b.length>0){let a=b.map(a=>a.rating).filter(Boolean);d.average=a.reduce((a,b)=>a+b,0)/a.length,a.forEach(a=>{d.distribution[a]++})}return d}async getResourceVersions(a){let{data:b,error:c}=await this.supabase.from("resource_versions").select("*, created_by_user:users(id, full_name)").eq("resource_id",a).order("created_at",{ascending:!1});if(c)throw c;return b}async createVersion(a){let{data:b,error:c}=await this.supabase.from("resource_versions").insert(a).select().single();if(c)throw c;return b}};a.s(["educationalResourcesService",0,c],235792);let d=(0,a.i(170106).default)("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);a.s(["Music",()=>d],216686)},331189,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(433217),e=a.i(913216),f=a.i(235792),g=a.i(703130),h=a.i(340695),i=a.i(205522),j=a.i(621958),k=a.i(587532),l=a.i(953722),m=a.i(64791),n=a.i(104720),o=a.i(838632),p=a.i(179257),q=a.i(216686),r=a.i(821374),s=a.i(284505),t=a.i(177156),u=a.i(976472),v=a.i(109347),w=a.i(915618),x=a.i(238246);let y={document:n.FileText,video:m.Video,audio:q.Music,image:o.Image,link:p.Link,interactive:l.BookOpen,other:n.FileText},z={document:"Document",video:"Vidéo",audio:"Audio",image:"Image",link:"Lien",interactive:"Interactif",other:"Autre"};function A(){let{user:a}=(0,e.useAuth)(),[l,m]=(0,c.useState)(""),[o,p]=(0,c.useState)(),[q,A]=(0,c.useState)(),[B,C]=(0,c.useState)("all"),{data:D}=(0,d.useQuery)({queryKey:["resource-categories",a?.organization_id],queryFn:()=>f.educationalResourcesService.getCategories(a?.organization_id||""),enabled:!!a?.organization_id}),{data:E}=(0,d.useQuery)({queryKey:["educational-resources",a?.organization_id,l,o,q],queryFn:()=>f.educationalResourcesService.getResources(a?.organization_id||"",{categoryId:o,resourceType:q,search:l||void 0}),enabled:!!a?.organization_id}),{data:F}=(0,d.useQuery)({queryKey:["featured-resources",a?.organization_id],queryFn:()=>f.educationalResourcesService.getResources(a?.organization_id||"",{featured:!0}),enabled:!!a?.organization_id}),{data:G}=(0,d.useQuery)({queryKey:["user-favorites",a?.id],queryFn:()=>f.educationalResourcesService.getUserFavorites(a?.id||""),enabled:!!a?.id});return(0,b.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,b.jsxs)("div",{className:"mb-8 flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,b.jsx)(v.Library,{className:"h-8 w-8"}),"Bibliothèque de ressources"]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Accédez à une vaste collection de ressources pédagogiques"})]}),(0,b.jsx)(x.default,{href:"/dashboard/resources/new",children:(0,b.jsxs)(h.Button,{className:"bg-brand-blue hover:bg-brand-blue/90 text-white shadow-lg shadow-brand-blue/20",children:[(0,b.jsx)(w.Plus,{className:"h-4 w-4 mr-2"}),"Nouvelle ressource"]})})]}),(0,b.jsx)(g.Card,{className:"mb-8",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(k.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,b.jsx)(i.Input,{type:"text",placeholder:"Rechercher une ressource...",value:l,onChange:a=>m(a.target.value),className:"pl-10"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsxs)("select",{value:o||"",onChange:a=>p(a.target.value||void 0),className:"px-3 py-2 border rounded-md text-sm",children:[(0,b.jsx)("option",{value:"",children:"Toutes les catégories"}),D?.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]}),(0,b.jsxs)("select",{value:q||"",onChange:a=>A(a.target.value||void 0),className:"px-3 py-2 border rounded-md text-sm",children:[(0,b.jsx)("option",{value:"",children:"Tous les types"}),Object.entries(z).map(([a,c])=>(0,b.jsx)("option",{value:a,children:c},a))]})]})]})})}),(0,b.jsxs)(j.Tabs,{value:B,onValueChange:C,children:[(0,b.jsxs)(j.TabsList,{className:"mb-6",children:[(0,b.jsx)(j.TabsTrigger,{value:"all",children:"Toutes les ressources"}),(0,b.jsx)(j.TabsTrigger,{value:"featured",children:"En vedette"}),(0,b.jsx)(j.TabsTrigger,{value:"favorites",children:"Mes favoris"})]}),(0,b.jsx)(j.TabsContent,{value:"all",children:E&&E.length>0?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map(a=>{var c;let d=y[a.resource_type]||n.FileText;return(0,b.jsx)(g.Card,{className:"hover:shadow-lg transition-shadow",children:(0,b.jsxs)(x.default,{href:`/dashboard/resources/${a.slug}`,children:[a.thumbnail_url&&(0,b.jsxs)("div",{className:"relative h-48 w-full overflow-hidden rounded-t-lg",children:[(0,b.jsx)("img",{src:a.thumbnail_url,alt:a.title,className:"w-full h-full object-cover"}),a.is_featured&&(0,b.jsx)("div",{className:"absolute top-2 right-2",children:(0,b.jsx)(r.Star,{className:"h-5 w-5 text-yellow-500 fill-yellow-500"})})]}),(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(d,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(g.CardTitle,{className:"text-lg line-clamp-2",children:a.title}),a.category&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:a.category.name})]})]})}),(0,b.jsxs)(g.CardContent,{children:[a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-3",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(t.Eye,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:a.view_count||0})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(s.Download,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:a.download_count||0})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(u.Heart,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:a.favorite_count||0})]})]}),a.file_size_bytes&&(0,b.jsx)("span",{children:(c=a.file_size_bytes)?c<1024?`${c} B`:c<1048576?`${(c/1024).toFixed(1)} KB`:`${(c/1048576).toFixed(1)} MB`:"N/A"})]}),a.duration_minutes&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Durée: ",a.duration_minutes," min"]})]})]})},a.id)})}):(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6 text-center text-muted-foreground",children:"Aucune ressource disponible"})})}),(0,b.jsx)(j.TabsContent,{value:"featured",children:F&&F.length>0?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:F.map(a=>{let c=y[a.resource_type]||n.FileText;return(0,b.jsx)(g.Card,{className:"hover:shadow-lg transition-shadow",children:(0,b.jsxs)(x.default,{href:`/dashboard/resources/${a.slug}`,children:[a.thumbnail_url&&(0,b.jsxs)("div",{className:"relative h-48 w-full overflow-hidden rounded-t-lg",children:[(0,b.jsx)("img",{src:a.thumbnail_url,alt:a.title,className:"w-full h-full object-cover"}),(0,b.jsx)("div",{className:"absolute top-2 right-2",children:(0,b.jsx)(r.Star,{className:"h-5 w-5 text-yellow-500 fill-yellow-500"})})]}),(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(c,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5"}),(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)(g.CardTitle,{className:"text-lg line-clamp-2",children:a.title})})]})}),(0,b.jsxs)(g.CardContent,{children:[a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-3",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(t.Eye,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:a.view_count||0})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(s.Download,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:a.download_count||0})]})]})]})]})},a.id)})}):(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6 text-center text-muted-foreground",children:"Aucune ressource en vedette"})})}),(0,b.jsx)(j.TabsContent,{value:"favorites",children:G&&G.length>0?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:G.map(a=>{let c=a.resource;if(!c)return null;let d=y[c.resource_type]||n.FileText;return(0,b.jsx)(g.Card,{className:"hover:shadow-lg transition-shadow",children:(0,b.jsxs)(x.default,{href:`/dashboard/resources/${c.slug}`,children:[c.thumbnail_url&&(0,b.jsx)("div",{className:"relative h-48 w-full overflow-hidden rounded-t-lg",children:(0,b.jsx)("img",{src:c.thumbnail_url,alt:c.title,className:"w-full h-full object-cover"})}),(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(d,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5"}),(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsx)(g.CardTitle,{className:"text-lg line-clamp-2",children:c.title})})]})}),(0,b.jsxs)(g.CardContent,{children:[c.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-3",children:c.description}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(t.Eye,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:c.view_count||0})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(s.Download,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:c.download_count||0})]})]})]})]})},a.id)})}):(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6 text-center text-muted-foreground",children:"Aucun favori pour le moment"})})})]})]})}a.s(["default",()=>A])}];

//# sourceMappingURL=_818163d3._.js.map