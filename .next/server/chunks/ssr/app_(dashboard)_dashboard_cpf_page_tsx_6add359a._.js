module.exports=[480915,a=>{"use strict";var b=a.i(187924),c=a.i(433217),d=a.i(937927),e=a.i(913216),f=a.i(112882),g=a.i(703130),h=a.i(340695),i=a.i(254161),j=a.i(621958),k=a.i(864037),l=a.i(469769),m=a.i(641710),n=a.i(100336),o=a.i(669520),p=a.i(915618),q=a.i(104720),r=a.i(660246),s=a.i(724669),t=a.i(238246),u=a.i(497895);let v={pending:"bg-yellow-100 text-yellow-800",approved:"bg-blue-100 text-blue-800",in_progress:"bg-green-100 text-green-800",completed:"bg-green-100 text-green-800",cancelled:"bg-gray-100 text-gray-800",rejected:"bg-red-100 text-red-800"};function w(){let{user:a}=(0,e.useAuth)();(0,d.useQueryClient)();let{addToast:w}=(0,k.useToast)(),{data:x=[],isLoading:y}=(0,c.useQuery)({queryKey:["cpf-eligible-trainings",a?.organization_id],queryFn:async()=>{try{return await f.cpfService.getEligibleTrainings(a.organization_id)}catch(a){if(a?.code==="PGRST116"||a?.code==="42P01"||a?.code==="PGRST301"||a?.status===404||a?.code==="404"||a?.message?.includes("relation")||a?.message?.includes("relationship")||a?.message?.includes("does not exist")||a?.message?.includes("schema cache"))return console.warn("Error fetching CPF eligible trainings:",a?.message),[];throw a}},enabled:!!a?.organization_id,retry:!1}),{data:z=[],isLoading:A}=(0,c.useQuery)({queryKey:["cpf-enrollments",a?.organization_id],queryFn:async()=>{try{return await f.cpfService.getEnrollments(a.organization_id)}catch(a){if(a?.code==="PGRST116"||a?.code==="42P01"||a?.code==="PGRST301"||a?.status===404||a?.code==="404"||a?.message?.includes("relation")||a?.message?.includes("relationship")||a?.message?.includes("does not exist")||a?.message?.includes("schema cache"))return console.warn("Error fetching CPF enrollments:",a?.message),[];throw a}},enabled:!!a?.organization_id,retry:!1}),B={totalTrainings:x.length,totalEnrollments:z.length,activeEnrollments:z.filter(a=>"in_progress"===a.status).length,completedEnrollments:z.filter(a=>"completed"===a.status).length,totalFunding:z.reduce((a,b)=>a+b.cpf_funding_amount,0)};return y||A?(0,b.jsx)("div",{className:"container mx-auto py-8 px-4",children:(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(o.RefreshCw,{className:"h-8 w-8 animate-spin text-brand-blue"})})}):(0,b.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,b.jsx)(l.GraduationCap,{className:"h-8 w-8 text-brand-blue"}),"Compte Personnel de Formation (CPF)"]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Gérez les formations éligibles CPF et les inscriptions de vos stagiaires"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Formations éligibles"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:B.totalTrainings})]}),(0,b.jsx)(l.GraduationCap,{className:"h-8 w-8 text-blue-500"})]})})}),(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Inscriptions"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:B.totalEnrollments})]}),(0,b.jsx)(r.Users,{className:"h-8 w-8 text-green-500"})]})})}),(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"En cours"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:B.activeEnrollments})]}),(0,b.jsx)(m.Clock,{className:"h-8 w-8 text-blue-500"})]})})}),(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Financement CPF"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:(0,u.formatCurrency)(B.totalFunding)})]}),(0,b.jsx)(n.Euro,{className:"h-8 w-8 text-green-500"})]})})})]}),(0,b.jsxs)(j.Tabs,{defaultValue:"trainings",className:"space-y-6",children:[(0,b.jsxs)(j.TabsList,{children:[(0,b.jsx)(j.TabsTrigger,{value:"trainings",children:"Formations éligibles"}),(0,b.jsx)(j.TabsTrigger,{value:"enrollments",children:"Inscriptions"}),(0,b.jsx)(j.TabsTrigger,{value:"learners",children:"Droits des stagiaires"})]}),(0,b.jsx)(j.TabsContent,{value:"trainings",children:(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{children:"Formations éligibles CPF"}),(0,b.jsx)(g.CardDescription,{children:"Liste des formations éligibles au financement CPF"})]}),(0,b.jsx)(h.Button,{asChild:!0,children:(0,b.jsxs)(t.default,{href:"/dashboard/cpf/trainings/new",children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Ajouter une formation"]})})]})}),(0,b.jsx)(g.CardContent,{children:0===x.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(l.GraduationCap,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"Aucune formation éligible CPF configurée"}),(0,b.jsx)(h.Button,{asChild:!0,children:(0,b.jsxs)(t.default,{href:"/dashboard/cpf/trainings/new",children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Créer la première formation"]})})]}):(0,b.jsx)("div",{className:"space-y-4",children:x.map(a=>(0,b.jsx)(g.Card,{className:"hover:shadow-md transition-shadow",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:a.cpf_training_title}),(0,b.jsx)(i.Badge,{className:"bg-green-100 text-green-800",children:"Éligible CPF"}),a.cpf_training_code&&(0,b.jsx)(i.Badge,{variant:"outline",children:a.cpf_training_code})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,b.jsx)("span",{className:"font-semibold",children:(0,u.formatCurrency)(a.price,a.currency)}),a.duration_hours&&(0,b.jsxs)("span",{className:"text-muted-foreground",children:[a.duration_hours,"h"]}),a.certification_level&&(0,b.jsxs)("span",{className:"text-muted-foreground",children:["Niveau ",a.certification_level]}),(0,b.jsxs)("span",{className:"text-muted-foreground",children:[a.current_learners," / ",a.max_learners||"∞"," stagiaires"]})]})]}),(0,b.jsx)(h.Button,{variant:"outline",asChild:!0,children:(0,b.jsx)(t.default,{href:`/dashboard/cpf/trainings/${a.id}`,children:"Voir les détails"})})]})})},a.id))})})]})}),(0,b.jsx)(j.TabsContent,{value:"enrollments",children:(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(g.CardTitle,{children:"Inscriptions CPF"}),(0,b.jsx)(g.CardDescription,{children:"Liste des inscriptions aux formations CPF"})]}),(0,b.jsx)(h.Button,{asChild:!0,children:(0,b.jsxs)(t.default,{href:"/dashboard/cpf/enrollments/new",children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Nouvelle inscription"]})})]})}),(0,b.jsx)(g.CardContent,{children:0===z.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(r.Users,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"Aucune inscription CPF enregistrée"}),(0,b.jsx)(h.Button,{asChild:!0,children:(0,b.jsxs)(t.default,{href:"/dashboard/cpf/enrollments/new",children:[(0,b.jsx)(p.Plus,{className:"h-4 w-4 mr-2"}),"Créer une inscription"]})})]}):(0,b.jsx)("div",{className:"space-y-4",children:z.map(a=>(0,b.jsx)(g.Card,{className:"hover:shadow-md transition-shadow",children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold",children:["Inscription #",a.id.slice(0,8)]}),(0,b.jsx)(i.Badge,{className:v[a.status],children:a.status.replace(/_/g," ")})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Date d'inscription"}),(0,b.jsx)("p",{className:"font-medium",children:new Date(a.enrollment_date).toLocaleDateString("fr-FR")})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Financement CPF"}),(0,b.jsx)("p",{className:"font-medium",children:(0,u.formatCurrency)(a.cpf_funding_amount)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Participation"}),(0,b.jsx)("p",{className:"font-medium",children:(0,u.formatCurrency)(a.learner_contribution)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Total"}),(0,b.jsx)("p",{className:"font-medium",children:(0,u.formatCurrency)(a.total_amount)})]})]}),a.cpf_attestation_number&&(0,b.jsx)("div",{className:"mt-3",children:(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Attestation: ",a.cpf_attestation_number]})})]}),(0,b.jsx)(h.Button,{variant:"outline",asChild:!0,children:(0,b.jsxs)(t.default,{href:`/dashboard/cpf/enrollments/${a.id}`,children:[(0,b.jsx)(q.FileText,{className:"h-4 w-4 mr-2"}),"Voir les détails"]})})]})})},a.id))})})]})}),(0,b.jsx)(j.TabsContent,{value:"learners",children:(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{children:"Droits CPF des stagiaires"}),(0,b.jsx)(g.CardDescription,{children:"Consultez et synchronisez les droits CPF de vos stagiaires"})]}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(s.TrendingUp,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"Fonctionnalité en cours de développement"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"La synchronisation avec Mon Compte Formation sera disponible prochainement"})]})})]})})]}),(0,b.jsxs)("div",{className:"mt-8 flex gap-4",children:[(0,b.jsx)(h.Button,{variant:"outline",asChild:!0,children:(0,b.jsxs)(t.default,{href:"/dashboard/cpf/configuration",children:[(0,b.jsx)(l.GraduationCap,{className:"h-4 w-4 mr-2"}),"Configuration CPF"]})}),(0,b.jsx)(h.Button,{variant:"outline",asChild:!0,children:(0,b.jsxs)(t.default,{href:"/dashboard/cpf/catalog-sync",children:[(0,b.jsx)(o.RefreshCw,{className:"h-4 w-4 mr-2"}),"Synchronisation Catalogue"]})}),(0,b.jsx)(h.Button,{variant:"outline",asChild:!0,children:(0,b.jsxs)(t.default,{href:"/dashboard/cpf/attestations",children:[(0,b.jsx)(q.FileText,{className:"h-4 w-4 mr-2"}),"Attestations"]})}),(0,b.jsx)(h.Button,{variant:"outline",asChild:!0,children:(0,b.jsxs)(t.default,{href:"/dashboard/cpf/reports",children:[(0,b.jsx)(q.FileText,{className:"h-4 w-4 mr-2"}),"Rapports"]})})]})]})}a.s(["default",()=>w])}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_cpf_page_tsx_6add359a._.js.map