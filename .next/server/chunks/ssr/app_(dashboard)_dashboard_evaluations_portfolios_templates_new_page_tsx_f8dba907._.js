module.exports=[553893,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(370025),f=a.i(433217),g=a.i(913216),h=a.i(269240);let i=new class{supabase;constructor(a){this.supabase=a||(0,h.createClient)()}async getTemplates(a){let{data:b,error:c}=await this.supabase.from("learning_portfolio_templates").select("*").or(`organization_id.eq.${a},organization_id.is.null`).eq("is_active",!0).order("is_default",{ascending:!1}).order("created_at",{ascending:!1});return c?(console.error("Erreur récupération templates:",c),[]):b||[]}async getTemplateById(a){let{data:b,error:c}=await this.supabase.from("learning_portfolio_templates").select("*").eq("id",a).single();return c?(console.error("Erreur récupération template:",c),null):b}async createTemplate(a){let{data:b,error:c}=await this.supabase.from("learning_portfolio_templates").insert(a).select().single();if(c)throw console.error("Erreur création template:",c),c;return b}async updateTemplate(a,b){let{data:c,error:d}=await this.supabase.from("learning_portfolio_templates").update({...b,version:b.version?b.version+1:1}).eq("id",a).select().single();if(d)throw console.error("Erreur mise à jour template:",d),d;return c}async deleteTemplate(a){let{error:b}=await this.supabase.from("learning_portfolio_templates").update({is_active:!1}).eq("id",a);return!b||(console.error("Erreur suppression template:",b),!1)}async getPortfolios(a,b){let c=this.supabase.from("learning_portfolios").select(`
        *,
        template:learning_portfolio_templates(*),
        student:students(id, first_name, last_name, email, photo_url),
        session:sessions(id, name, start_date, end_date)
      `).eq("organization_id",a).order("updated_at",{ascending:!1});b?.studentId&&(c=c.eq("student_id",b.studentId)),b?.sessionId&&(c=c.eq("session_id",b.sessionId)),b?.status&&(c=c.eq("status",b.status)),b?.templateId&&(c=c.eq("template_id",b.templateId));let{data:d,error:e}=await c;return e?(console.error("Erreur récupération portfolios:",e),[]):d||[]}async getPortfolioById(a){let{data:b,error:c}=await this.supabase.from("learning_portfolios").select(`
        *,
        template:learning_portfolio_templates(*),
        student:students(id, first_name, last_name, email, photo_url, phone),
        session:sessions(id, name, start_date, end_date, formations(id, title))
      `).eq("id",a).single();return c?(console.error("Erreur récupération portfolio:",c),null):b}async getStudentPortfolios(a){let{data:b,error:c}=await this.supabase.from("learning_portfolios").select(`
        *,
        template:learning_portfolio_templates(id, name, description, primary_color),
        session:sessions(id, name, formations(id, title))
      `).eq("student_id",a).eq("is_visible_to_student",!0).order("updated_at",{ascending:!1});return c?(console.error("Erreur récupération portfolios étudiant:",c),[]):b||[]}async createPortfolio(a){let{data:b,error:c}=await this.supabase.from("learning_portfolios").insert({...a,status:"draft",progress_percentage:0,started_at:new Date().toISOString()}).select().single();if(c)throw console.error("Erreur création portfolio:",c),c;return b}async updatePortfolio(a,b,c){let{data:d,error:e}=await this.supabase.from("learning_portfolios").update({...b,last_modified_by:c}).eq("id",a).select().single();if(e)throw console.error("Erreur mise à jour portfolio:",e),e;return d}async validatePortfolio(a,b){let{data:c,error:d}=await this.supabase.from("learning_portfolios").update({status:"validated",validated_at:new Date().toISOString(),validated_by:b,is_visible_to_student:!0}).eq("id",a).select().single();if(d)throw console.error("Erreur validation portfolio:",d),d;return c}async getPortfolioEntries(a){let{data:b,error:c}=await this.supabase.from("learning_portfolio_entries").select("*").eq("portfolio_id",a).order("created_at",{ascending:!0});return c?(console.error("Erreur récupération entries:",c),[]):b||[]}async upsertEntry(a){let{data:b,error:c}=await this.supabase.from("learning_portfolio_entries").upsert({...a,evaluated_at:new Date().toISOString()},{onConflict:"portfolio_id,section_id,field_id"}).select().single();if(c)throw console.error("Erreur upsert entry:",c),c;return b}async bulkUpsertEntries(a){let{error:b}=await this.supabase.from("learning_portfolio_entries").upsert(a.map(a=>({...a,evaluated_at:new Date().toISOString()})),{onConflict:"portfolio_id,section_id,field_id"});if(b)throw console.error("Erreur bulk upsert entries:",b),b;return!0}async addSignature(a){let{error:b}=await this.supabase.from("learning_portfolio_signatures").insert({...a,signed_at:new Date().toISOString()});if(b)throw console.error("Erreur ajout signature:",b),b;return!0}async getSignatures(a){let{data:b,error:c}=await this.supabase.from("learning_portfolio_signatures").select("*").eq("portfolio_id",a).order("signed_at",{ascending:!0});return c?(console.error("Erreur récupération signatures:",c),[]):b||[]}getDefaultTemplateStructure(){return[{id:"page_garde",title:"Page de garde",description:"Informations générales sur le livret",icon:"file-text",fields:[{id:"formation_title",label:"Intitulé de la formation",type:"text",required:!0,placeholder:"Ex: CAP Menuisier"},{id:"formation_code",label:"Code formation / RNCP",type:"text",required:!1,placeholder:"Ex: RNCP34567"},{id:"formation_duration",label:"Durée totale de la formation",type:"text",required:!0,placeholder:"Ex: 1200 heures"},{id:"training_period_start",label:"Date de début de formation",type:"date",required:!0},{id:"training_period_end",label:"Date de fin de formation",type:"date",required:!0}]},{id:"identification_apprenant",title:"Identification de l'apprenant",description:"Coordonnées et informations personnelles de l'apprenant",icon:"user",fields:[{id:"learner_civility",label:"Civilité",type:"select",required:!0,options:["M.","Mme","Autre"]},{id:"learner_last_name",label:"Nom de famille",type:"text",required:!0},{id:"learner_first_name",label:"Prénom",type:"text",required:!0},{id:"learner_birth_date",label:"Date de naissance",type:"date",required:!0},{id:"learner_birth_place",label:"Lieu de naissance",type:"text",required:!1},{id:"learner_address",label:"Adresse",type:"textarea",required:!1,placeholder:"Adresse complète"},{id:"learner_phone",label:"Téléphone",type:"text",required:!1},{id:"learner_email",label:"Email",type:"text",required:!1},{id:"learner_photo",label:"Photo d'identité",type:"file",required:!1}]},{id:"organisme_formation",title:"Organisme de formation",description:"Informations sur l'organisme de formation (CFA / OF)",icon:"building",fields:[{id:"of_name",label:"Nom de l'organisme",type:"text",required:!0},{id:"of_address",label:"Adresse",type:"textarea",required:!1},{id:"of_phone",label:"Téléphone",type:"text",required:!1},{id:"of_email",label:"Email",type:"text",required:!1},{id:"of_siret",label:"N° SIRET",type:"text",required:!1},{id:"of_nda",label:"N° de déclaration d'activité",type:"text",required:!1},{id:"referent_pedagogique",label:"Référent pédagogique",type:"text",required:!0},{id:"referent_phone",label:"Téléphone du référent",type:"text",required:!1},{id:"referent_email",label:"Email du référent",type:"text",required:!1}]},{id:"entreprise_accueil",title:"Entreprise d'accueil",description:"Informations sur l'entreprise d'accueil pour l'alternance",icon:"briefcase",fields:[{id:"company_name",label:"Raison sociale",type:"text",required:!0},{id:"company_address",label:"Adresse",type:"textarea",required:!1},{id:"company_phone",label:"Téléphone",type:"text",required:!1},{id:"company_email",label:"Email",type:"text",required:!1},{id:"company_siret",label:"N° SIRET",type:"text",required:!1},{id:"company_activity",label:"Activité principale",type:"text",required:!1},{id:"company_size",label:"Effectif",type:"select",required:!1,options:["1-10","11-50","51-250","251-500","500+"]},{id:"tutor_name",label:"Maître d'apprentissage / Tuteur",type:"text",required:!0},{id:"tutor_function",label:"Fonction du tuteur",type:"text",required:!1},{id:"tutor_phone",label:"Téléphone du tuteur",type:"text",required:!1},{id:"tutor_email",label:"Email du tuteur",type:"text",required:!1}]},{id:"calendrier_alternance",title:"Calendrier de l'alternance",description:"Planning des périodes en entreprise et en formation",icon:"calendar",fields:[{id:"alternance_rhythm",label:"Rythme de l'alternance",type:"text",required:!0,placeholder:"Ex: 2 semaines entreprise / 1 semaine CFA"},{id:"total_hours_company",label:"Heures totales en entreprise",type:"number",required:!1,min:0},{id:"total_hours_training",label:"Heures totales en formation",type:"number",required:!1,min:0},{id:"calendar_notes",label:"Remarques sur le calendrier",type:"textarea",required:!1}]},{id:"objectifs_formation",title:"Objectifs de la formation",description:"Objectifs pédagogiques et professionnels visés",icon:"target",fields:[{id:"main_objectives",label:"Objectifs principaux de la formation",type:"textarea",required:!0,placeholder:"Décrire les objectifs généraux..."},{id:"professional_profile",label:"Profil professionnel visé",type:"textarea",required:!1,placeholder:"Métiers / fonctions visés..."},{id:"specific_objectives",label:"Objectifs spécifiques",type:"textarea",required:!1}]},{id:"referentiel_competences",title:"Référentiel de compétences",description:"Blocs de compétences et capacités à acquérir",icon:"book-open",fields:[{id:"bloc1_title",label:"Bloc 1 - Intitulé",type:"text",required:!0,placeholder:"Ex: Préparation et organisation du chantier"},{id:"bloc1_c1",label:"Bloc 1 - Compétence 1",type:"competency",required:!0,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc1_c2",label:"Bloc 1 - Compétence 2",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc1_c3",label:"Bloc 1 - Compétence 3",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc1_c4",label:"Bloc 1 - Compétence 4",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc2_title",label:"Bloc 2 - Intitulé",type:"text",required:!1,placeholder:"Ex: Réalisation des travaux"},{id:"bloc2_c1",label:"Bloc 2 - Compétence 1",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc2_c2",label:"Bloc 2 - Compétence 2",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc2_c3",label:"Bloc 2 - Compétence 3",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc2_c4",label:"Bloc 2 - Compétence 4",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc3_title",label:"Bloc 3 - Intitulé",type:"text",required:!1,placeholder:"Ex: Contrôle et suivi de la qualité"},{id:"bloc3_c1",label:"Bloc 3 - Compétence 1",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc3_c2",label:"Bloc 3 - Compétence 2",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc3_c3",label:"Bloc 3 - Compétence 3",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc3_c4",label:"Bloc 3 - Compétence 4",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]}]},{id:"suivi_periodes_entreprise",title:"Suivi des périodes en entreprise",description:"Bilans des périodes réalisées en entreprise",icon:"clipboard-list",fields:[{id:"period1_dates",label:"Période 1 - Dates",type:"text",required:!1,placeholder:"Du ... au ..."},{id:"period1_tasks",label:"Période 1 - Activités réalisées",type:"textarea",required:!1},{id:"period1_evaluation",label:"Période 1 - Évaluation tuteur",type:"rating",required:!1,min:1,max:5},{id:"period1_comments",label:"Période 1 - Observations",type:"textarea",required:!1},{id:"period2_dates",label:"Période 2 - Dates",type:"text",required:!1,placeholder:"Du ... au ..."},{id:"period2_tasks",label:"Période 2 - Activités réalisées",type:"textarea",required:!1},{id:"period2_evaluation",label:"Période 2 - Évaluation tuteur",type:"rating",required:!1,min:1,max:5},{id:"period2_comments",label:"Période 2 - Observations",type:"textarea",required:!1},{id:"period3_dates",label:"Période 3 - Dates",type:"text",required:!1,placeholder:"Du ... au ..."},{id:"period3_tasks",label:"Période 3 - Activités réalisées",type:"textarea",required:!1},{id:"period3_evaluation",label:"Période 3 - Évaluation tuteur",type:"rating",required:!1,min:1,max:5},{id:"period3_comments",label:"Période 3 - Observations",type:"textarea",required:!1}]},{id:"bilans_intermediaires",title:"Bilans intermédiaires",description:"Points d'étape avec l'apprenant, le tuteur et le formateur",icon:"users",fields:[{id:"bilan1_date",label:"Bilan 1 - Date",type:"date",required:!1},{id:"bilan1_progress",label:"Bilan 1 - Progression globale",type:"rating",required:!1,min:1,max:5},{id:"bilan1_strong_points",label:"Bilan 1 - Points forts",type:"textarea",required:!1},{id:"bilan1_improvements",label:"Bilan 1 - Axes d'amélioration",type:"textarea",required:!1},{id:"bilan1_objectives",label:"Bilan 1 - Objectifs pour la prochaine période",type:"textarea",required:!1},{id:"bilan2_date",label:"Bilan 2 - Date",type:"date",required:!1},{id:"bilan2_progress",label:"Bilan 2 - Progression globale",type:"rating",required:!1,min:1,max:5},{id:"bilan2_strong_points",label:"Bilan 2 - Points forts",type:"textarea",required:!1},{id:"bilan2_improvements",label:"Bilan 2 - Axes d'amélioration",type:"textarea",required:!1},{id:"bilan2_objectives",label:"Bilan 2 - Objectifs pour la prochaine période",type:"textarea",required:!1},{id:"bilan3_date",label:"Bilan 3 - Date",type:"date",required:!1},{id:"bilan3_progress",label:"Bilan 3 - Progression globale",type:"rating",required:!1,min:1,max:5},{id:"bilan3_strong_points",label:"Bilan 3 - Points forts",type:"textarea",required:!1},{id:"bilan3_improvements",label:"Bilan 3 - Axes d'amélioration",type:"textarea",required:!1},{id:"bilan3_objectives",label:"Bilan 3 - Objectifs finaux",type:"textarea",required:!1}]},{id:"competences_transversales",title:"Compétences transversales",description:"Savoir-être et compétences transférables",icon:"star",fields:[{id:"punctuality",label:"Ponctualité / Assiduité",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"autonomy",label:"Autonomie",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"initiative",label:"Prise d'initiative",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"teamwork",label:"Travail en équipe",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"communication",label:"Communication",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"adaptability",label:"Adaptabilité",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"safety_rules",label:"Respect des règles de sécurité",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"professionalism",label:"Professionnalisme",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]}]},{id:"evaluations_centre",title:"Évaluations en centre de formation",description:"Résultats des évaluations réalisées au CFA / OF",icon:"file-check",fields:[{id:"eval_general_knowledge",label:"Enseignement général",type:"rating",required:!1,min:0,max:20},{id:"eval_professional",label:"Enseignement professionnel",type:"rating",required:!1,min:0,max:20},{id:"eval_practical",label:"Travaux pratiques",type:"rating",required:!1,min:0,max:20},{id:"eval_project",label:"Projet / Chef-d'œuvre",type:"rating",required:!1,min:0,max:20},{id:"eval_average",label:"Moyenne générale",type:"number",required:!1,min:0,max:20},{id:"eval_comments",label:"Appréciations du conseil pédagogique",type:"textarea",required:!1}]},{id:"bilan_final",title:"Bilan final de la formation",description:"Synthèse et conclusion de la formation",icon:"award",fields:[{id:"final_overall_assessment",label:"Appréciation globale",type:"textarea",required:!0,placeholder:"Synthèse de la formation..."},{id:"final_skills_acquired",label:"Compétences acquises",type:"textarea",required:!1},{id:"final_skills_to_develop",label:"Compétences à approfondir",type:"textarea",required:!1},{id:"final_overall_rating",label:"Évaluation finale globale",type:"rating",required:!1,min:1,max:5},{id:"final_recommendation",label:"Recommandation de poursuite",type:"textarea",required:!1,placeholder:"Recommandations pour la suite..."},{id:"training_result",label:"Résultat de la formation",type:"select",required:!0,options:["Formation validée","Formation partiellement validée","Formation non validée","Abandon"]},{id:"certification_obtained",label:"Certification / Diplôme obtenu",type:"checkbox",required:!1},{id:"certification_date",label:"Date d'obtention",type:"date",required:!1}]},{id:"attestations_documents",title:"Attestations et documents",description:"Documents annexes (habilitations, attestations, etc.)",icon:"folder",fields:[{id:"sst_certificate",label:"Attestation SST (Sauveteur Secouriste du Travail)",type:"checkbox",required:!1},{id:"sst_date",label:"Date d'obtention SST",type:"date",required:!1},{id:"habilitation_electrique",label:"Habilitation électrique",type:"text",required:!1,placeholder:"Ex: B1V, BR..."},{id:"habilitation_date",label:"Date d'obtention habilitation",type:"date",required:!1},{id:"caces",label:"CACES obtenu(s)",type:"text",required:!1,placeholder:"Ex: R489 cat. 3"},{id:"caces_date",label:"Date d'obtention CACES",type:"date",required:!1},{id:"other_certifications",label:"Autres certifications / attestations",type:"textarea",required:!1},{id:"attached_documents",label:"Documents joints",type:"file",required:!1}]},{id:"signatures",title:"Signatures",description:"Validation par les différentes parties",icon:"pen-tool",fields:[{id:"learner_signature_date",label:"Date de signature apprenant",type:"date",required:!1},{id:"learner_signature_comment",label:"Observations de l'apprenant",type:"textarea",required:!1},{id:"tutor_signature_date",label:"Date de signature tuteur entreprise",type:"date",required:!1},{id:"tutor_signature_comment",label:"Observations du tuteur",type:"textarea",required:!1},{id:"trainer_signature_date",label:"Date de signature formateur",type:"date",required:!1},{id:"trainer_signature_comment",label:"Observations du formateur",type:"textarea",required:!1},{id:"manager_signature_date",label:"Date de signature responsable formation",type:"date",required:!1},{id:"manager_signature_comment",label:"Observations du responsable",type:"textarea",required:!1}]}]}};var j=a.i(703130),k=a.i(340695),l=a.i(205522),m=a.i(917171),n=a.i(546893),o=a.i(280281),p=a.i(864037),q=a.i(400210),r=a.i(114548),s=a.i(915618),t=a.i(781560),u=a.i(784581),v=a.i(405784),w=a.i(767552),x=a.i(104720),y=a.i(134148),z=a.i(80104),A=a.i(2835),B=a.i(367329),C=a.i(490525),D=a.i(941675),E=a.i(773320),F=a.i(821374),G=a.i(93518),H=a.i(321161),I=a.i(238246);a.i(460355);var J=a.i(346271),K=a.i(262036);let L=[{value:"text",label:"Texte court",icon:y.Type},{value:"textarea",label:"Texte long",icon:z.AlignLeft},{value:"number",label:"Nombre",icon:A.Hash},{value:"select",label:"Liste déroulante",icon:B.List},{value:"checkbox",label:"Case à cocher",icon:C.CheckSquare},{value:"date",label:"Date",icon:D.Calendar},{value:"file",label:"Fichier",icon:E.Upload},{value:"rating",label:"Note (étoiles)",icon:F.Star},{value:"competency",label:"Compétence",icon:G.Award}];function M(){let a=(0,d.useRouter)(),{user:y}=(0,g.useAuth)(),z=(0,h.createClient)(),{addToast:A}=(0,p.useToast)(),[B,C]=(0,c.useState)({name:"",description:"",primary_color:"#335ACF",secondary_color:"#34B9EE",formation_id:"",is_default:!1}),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)([]),{data:M}=(0,f.useQuery)({queryKey:["formations-select",y?.organization_id],queryFn:async()=>{if(!y?.organization_id)return[];let{data:a,error:b}=await z.from("formations").select("id, name").eq("organization_id",y.organization_id).eq("is_active",!0);return b?[]:a||[]},enabled:!!y?.organization_id}),N=(0,e.useMutation)({mutationFn:async()=>{let{data:a,error:b}=await z.from("learning_portfolio_templates").insert({organization_id:y?.organization_id,name:B.name,description:B.description,template_structure:D,primary_color:B.primary_color,secondary_color:B.secondary_color,formation_id:B.formation_id||null,is_default:B.is_default,created_by:y?.id}).select().single();if(b)throw b;return a},onSuccess:()=>{A({type:"success",title:"Modèle créé",description:"Le modèle de livret a été créé avec succès."}),a.push("/dashboard/evaluations/portfolios/templates")},onError:a=>{A({type:"error",title:"Erreur",description:a.message||"Impossible de créer le modèle."})}}),O=()=>{let a={id:`section_${Date.now()}`,title:"Nouvelle section",description:"",fields:[]};E([...D,a]),G([...F,a.id])},P=(a,b)=>{E(D.map(c=>c.id===a?{...c,...b}:c))},Q=(a,b,c)=>{E(D.map(d=>d.id===a?{...d,fields:d.fields.map(a=>a.id===b?{...a,...c}:a)}:d))},R=()=>{let a=i.getDefaultTemplateStructure();E(a),G(a.map(a=>a.id)),A({type:"info",title:"Modèle chargé",description:"Le modèle par défaut a été chargé."})};return(0,b.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-5xl",children:[(0,b.jsx)(J.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:(0,b.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,b.jsx)(I.default,{href:"/dashboard/evaluations/portfolios/templates",children:(0,b.jsx)(k.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(q.ArrowLeft,{className:"h-5 w-5"})})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Nouveau modèle de livret"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Créez un modèle de livret d'apprentissage personnalisé"})]}),(0,b.jsxs)(k.Button,{variant:"outline",onClick:R,children:[(0,b.jsx)(x.FileText,{className:"h-4 w-4 mr-2"}),"Charger modèle par défaut"]})]})}),(0,b.jsx)("form",{onSubmit:a=>{(a.preventDefault(),B.name)?0===D.length?A({type:"error",title:"Erreur",description:"Ajoutez au moins une section."}):N.mutate():A({type:"error",title:"Erreur",description:"Le nom du modèle est requis."})},children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsxs)(j.Card,{className:"sticky top-4",children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsxs)(j.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(H.Settings,{className:"h-5 w-5"}),"Paramètres"]})}),(0,b.jsxs)(j.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"name",children:"Nom du modèle *"}),(0,b.jsx)(l.Input,{id:"name",value:B.name,onChange:a=>C({...B,name:a.target.value}),placeholder:"Ex: Livret de suivi formation",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)(n.Textarea,{id:"description",value:B.description,onChange:a=>C({...B,description:a.target.value}),placeholder:"Description du modèle...",rows:3})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"formation",children:"Formation associée (optionnel)"}),(0,b.jsxs)("select",{id:"formation",value:B.formation_id,onChange:a=>C({...B,formation_id:a.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-blue",children:[(0,b.jsx)("option",{value:"",children:"Aucune (modèle générique)"}),M?.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"primary_color",children:"Couleur principale"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"color",id:"primary_color",value:B.primary_color,onChange:a=>C({...B,primary_color:a.target.value}),className:"w-10 h-10 rounded cursor-pointer"}),(0,b.jsx)(l.Input,{value:B.primary_color,onChange:a=>C({...B,primary_color:a.target.value}),className:"flex-1"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"secondary_color",children:"Couleur secondaire"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{type:"color",id:"secondary_color",value:B.secondary_color,onChange:a=>C({...B,secondary_color:a.target.value}),className:"w-10 h-10 rounded cursor-pointer"}),(0,b.jsx)(l.Input,{value:B.secondary_color,onChange:a=>C({...B,secondary_color:a.target.value}),className:"flex-1"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(m.Label,{htmlFor:"is_default",children:"Modèle par défaut"}),(0,b.jsx)(o.Switch,{checked:B.is_default,onCheckedChange:a=>C({...B,is_default:a})})]}),(0,b.jsx)("div",{className:"pt-4 border-t",children:(0,b.jsxs)(k.Button,{type:"submit",className:"w-full",disabled:N.isPending,children:[(0,b.jsx)(r.Save,{className:"h-4 w-4 mr-2"}),N.isPending?"Création...":"Créer le modèle"]})})]})]})}),(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Structure du livret (",D.length," section",D.length>1?"s":"",")"]}),(0,b.jsxs)(k.Button,{type:"button",onClick:O,children:[(0,b.jsx)(s.Plus,{className:"h-4 w-4 mr-2"}),"Ajouter une section"]})]}),0===D.length?(0,b.jsx)(j.Card,{children:(0,b.jsxs)(j.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(x.FileText,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune section"}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:"Ajoutez des sections pour structurer votre livret d'apprentissage."}),(0,b.jsxs)("div",{className:"flex justify-center gap-3",children:[(0,b.jsxs)(k.Button,{type:"button",onClick:O,children:[(0,b.jsx)(s.Plus,{className:"h-4 w-4 mr-2"}),"Ajouter une section"]}),(0,b.jsx)(k.Button,{type:"button",variant:"outline",onClick:R,children:"Charger modèle par défaut"})]})]})}):(0,b.jsx)(K.AnimatePresence,{children:D.map((a,c)=>(0,b.jsx)(J.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:.05*c},children:(0,b.jsxs)(j.Card,{className:"border-l-4",style:{borderLeftColor:B.primary_color},children:[(0,b.jsx)(j.CardHeader,{className:"py-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(u.GripVertical,{className:"h-5 w-5 text-gray-400 cursor-move"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(l.Input,{value:a.title,onChange:b=>P(a.id,{title:b.target.value}),className:"font-semibold text-lg border-none p-0 h-auto focus:ring-0",placeholder:"Titre de la section"}),(0,b.jsx)(l.Input,{value:a.description||"",onChange:b=>P(a.id,{description:b.target.value}),className:"text-sm text-gray-500 border-none p-0 h-auto focus:ring-0 mt-1",placeholder:"Description (optionnel)"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"text-sm text-gray-500",children:[a.fields.length," champ",a.fields.length>1?"s":""]}),(0,b.jsx)(k.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>{var b;return b=a.id,void G(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},children:F.includes(a.id)?(0,b.jsx)(w.ChevronUp,{className:"h-4 w-4"}):(0,b.jsx)(v.ChevronDown,{className:"h-4 w-4"})}),(0,b.jsx)(k.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>{var b;return b=a.id,void E(D.filter(a=>a.id!==b))},className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,b.jsx)(t.Trash2,{className:"h-4 w-4"})})]})]})}),(0,b.jsx)(K.AnimatePresence,{children:F.includes(a.id)&&(0,b.jsx)(J.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},children:(0,b.jsxs)(j.CardContent,{className:"pt-0",children:[(0,b.jsx)("div",{className:"space-y-3",children:a.fields.map((c,d)=>(0,b.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg border",children:[(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-3",children:[(0,b.jsxs)("div",{className:"col-span-5",children:[(0,b.jsx)(m.Label,{className:"text-xs",children:"Label"}),(0,b.jsx)(l.Input,{value:c.label,onChange:b=>Q(a.id,c.id,{label:b.target.value}),placeholder:"Nom du champ"})]}),(0,b.jsxs)("div",{className:"col-span-4",children:[(0,b.jsx)(m.Label,{className:"text-xs",children:"Type"}),(0,b.jsx)("select",{value:c.type,onChange:b=>Q(a.id,c.id,{type:b.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-blue text-sm",children:L.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),(0,b.jsx)("div",{className:"col-span-2 flex items-end justify-center",children:(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("input",{type:"checkbox",checked:c.required,onChange:b=>Q(a.id,c.id,{required:b.target.checked}),className:"rounded"}),"Requis"]})}),(0,b.jsx)("div",{className:"col-span-1 flex items-end justify-end",children:(0,b.jsx)(k.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>{var b,d;return b=a.id,d=c.id,void E(D.map(a=>a.id===b?{...a,fields:a.fields.filter(a=>a.id!==d)}:a))},className:"text-red-600 hover:text-red-700",children:(0,b.jsx)(t.Trash2,{className:"h-4 w-4"})})})]}),("select"===c.type||"competency"===c.type)&&(0,b.jsxs)("div",{className:"mt-3",children:[(0,b.jsxs)(m.Label,{className:"text-xs",children:["competency"===c.type?"Niveaux de compétence":"Options"," (séparées par des virgules)"]}),(0,b.jsx)(l.Input,{value:"competency"===c.type?(c.competencyLevels||["Non acquis","En cours","Acquis","Maîtrisé"]).join(", "):(c.options||[]).join(", "),onChange:b=>{let d=b.target.value.split(",").map(a=>a.trim());"competency"===c.type?Q(a.id,c.id,{competencyLevels:d}):Q(a.id,c.id,{options:d})},placeholder:"competency"===c.type?"Non acquis, En cours, Acquis, Maîtrisé":"Option 1, Option 2, Option 3"})]}),"rating"===c.type&&(0,b.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{className:"text-xs",children:"Note min"}),(0,b.jsx)(l.Input,{type:"number",value:c.min||1,onChange:b=>Q(a.id,c.id,{min:parseInt(b.target.value)})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{className:"text-xs",children:"Note max"}),(0,b.jsx)(l.Input,{type:"number",value:c.max||5,onChange:b=>Q(a.id,c.id,{max:parseInt(b.target.value)})})]})]})]},c.id))}),(0,b.jsxs)(k.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{var b;let c;return b=a.id,c={id:`field_${Date.now()}`,label:"Nouveau champ",type:"text",required:!1},void E(D.map(a=>a.id===b?{...a,fields:[...a.fields,c]}:a))},className:"mt-3 w-full",children:[(0,b.jsx)(s.Plus,{className:"h-4 w-4 mr-2"}),"Ajouter un champ"]})]})})})]})},a.id))})]})]})})]})}a.s(["default",()=>M],553893)}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_evaluations_portfolios_templates_new_page_tsx_f8dba907._.js.map