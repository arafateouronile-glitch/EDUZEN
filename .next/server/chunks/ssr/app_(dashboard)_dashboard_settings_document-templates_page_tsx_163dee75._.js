module.exports=[194954,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(433217),e=a.i(370025),f=a.i(937927),g=a.i(913216),h=a.i(872675),i=a.i(965733),j=a.i(340695),k=a.i(205522),l=a.i(917171),m=a.i(705151);function n({template:a,open:d,onOpenChange:n}){let{user:o}=(0,g.useAuth)(),p=(0,f.useQueryClient)(),[q,r]=(0,c.useState)(`${a.name} (copie)`),[s,t]=(0,c.useState)(!1),u=(0,e.useMutation)({mutationFn:async b=>{if(!o?.organization_id)throw Error("Organisation non trouvée");return h.documentTemplateService.duplicateTemplate(a.id,b)},onSuccess:()=>{p.invalidateQueries({queryKey:["document-templates",o?.organization_id]}),p.invalidateQueries({queryKey:["document-templates-by-type",o?.organization_id]}),n(!1),r(`${a.name} (copie)`)},onError:a=>{console.error("Erreur lors de la duplication:",a),alert("Erreur lors de la duplication du modèle")}}),v=async()=>{if(!q.trim())return void alert("Veuillez entrer un nom pour le modèle dupliqué");t(!0);try{await u.mutateAsync(q.trim())}finally{t(!1)}};return(0,b.jsx)(i.Dialog,{open:d,onOpenChange:n,children:(0,b.jsxs)(i.DialogContent,{children:[(0,b.jsxs)(i.DialogHeader,{children:[(0,b.jsxs)(i.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Copy,{className:"h-5 w-5"}),"Dupliquer le modèle"]}),(0,b.jsxs)(i.DialogDescription,{children:['Créez une copie du modèle "',a.name,'" que vous pourrez modifier indépendamment.']})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"template-name",children:"Nom du nouveau modèle"}),(0,b.jsx)(k.Input,{id:"template-name",value:q,onChange:a=>r(a.target.value),placeholder:"Nom du modèle",className:"mt-2",onKeyDown:a=>{"Enter"===a.key&&v()}})]}),(0,b.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,b.jsx)("p",{className:"font-medium mb-1",children:"Informations du modèle original :"}),(0,b.jsxs)("ul",{className:"list-disc list-inside space-y-1",children:[(0,b.jsxs)("li",{children:["Type : ",a.type]}),(0,b.jsxs)("li",{children:["Modifié le : ",new Date(a.updated_at).toLocaleDateString("fr-FR")]}),a.is_default&&(0,b.jsx)("li",{className:"text-primary font-medium",children:"Modèle par défaut"})]})]})]}),(0,b.jsxs)(i.DialogFooter,{children:[(0,b.jsx)(j.Button,{variant:"outline",onClick:()=>n(!1),disabled:s,children:"Annuler"}),(0,b.jsx)(j.Button,{onClick:v,disabled:s||!q.trim(),children:s?"Duplication...":"Dupliquer"})]})]})})}var o=a.i(683245);function p({template:a,open:d,onOpenChange:m}){let{user:n}=(0,g.useAuth)(),p=(0,f.useQueryClient)(),[q,r]=(0,c.useState)(a.name);(0,c.useEffect)(()=>{d&&r(a.name)},[d,a.name]);let s=(0,e.useMutation)({mutationFn:async b=>{if(!n?.organization_id)throw Error("Organisation non trouvée");return h.documentTemplateService.updateTemplate({id:a.id,name:b})},onSuccess:()=>{p.invalidateQueries({queryKey:["document-templates",n?.organization_id]}),p.invalidateQueries({queryKey:["document-templates-by-type",n?.organization_id]}),m(!1)},onError:a=>{console.error("Erreur lors du renommage:",a),alert("Erreur lors du renommage du modèle")}}),t=async()=>{if(!q.trim())return void alert("Veuillez entrer un nom pour le modèle");if(q.trim()===a.name)return void m(!1);try{await s.mutateAsync(q.trim())}catch(a){}};return(0,b.jsx)(i.Dialog,{open:d,onOpenChange:m,children:(0,b.jsxs)(i.DialogContent,{children:[(0,b.jsxs)(i.DialogHeader,{children:[(0,b.jsxs)(i.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(o.Edit,{className:"h-5 w-5"}),"Renommer le modèle"]}),(0,b.jsxs)(i.DialogDescription,{children:['Modifiez le nom du modèle "',a.name,'".']})]}),(0,b.jsx)("div",{className:"space-y-4 py-4",children:(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"template-name",children:"Nouveau nom du modèle"}),(0,b.jsx)(k.Input,{id:"template-name",value:q,onChange:a=>r(a.target.value),placeholder:"Nom du modèle",className:"mt-2",onKeyDown:a=>{"Enter"===a.key&&t()},autoFocus:!0})]})}),(0,b.jsxs)(i.DialogFooter,{children:[(0,b.jsx)(j.Button,{variant:"outline",onClick:()=>m(!1),disabled:s.isPending,children:"Annuler"}),(0,b.jsx)(j.Button,{onClick:t,disabled:s.isPending||!q.trim(),children:s.isPending?"Renommage...":"Renommer"})]})]})})}var q=a.i(781560);function r({template:a,open:c,onOpenChange:d}){let{user:k}=(0,g.useAuth)(),l=(0,f.useQueryClient)(),m=(0,e.useMutation)({mutationFn:async()=>h.documentTemplateService.deleteTemplate(a.id),onSuccess:()=>{l.invalidateQueries({queryKey:["document-templates",k?.organization_id]}),l.invalidateQueries({queryKey:["document-templates-by-type",k?.organization_id]}),d(!1)},onError:a=>{console.error("Erreur lors de la suppression:",a),alert("Erreur lors de la suppression du modèle")}}),n=async()=>{try{await m.mutateAsync()}catch(a){}};return(0,b.jsx)(i.Dialog,{open:c,onOpenChange:d,children:(0,b.jsxs)(i.DialogContent,{children:[(0,b.jsxs)(i.DialogHeader,{children:[(0,b.jsxs)(i.DialogTitle,{className:"flex items-center gap-2 text-red-600",children:[(0,b.jsx)(q.Trash2,{className:"h-5 w-5"}),"Supprimer le modèle"]}),(0,b.jsxs)(i.DialogDescription,{children:['Êtes-vous sûr de vouloir supprimer le modèle "',a.name,'" ? Cette action est irréversible.',a.is_default&&(0,b.jsx)("span",{className:"block mt-2 text-amber-600 font-medium",children:"⚠️ Ce modèle est actuellement défini comme modèle par défaut. La suppression supprimera cette configuration."})]})]}),(0,b.jsxs)(i.DialogFooter,{children:[(0,b.jsx)(j.Button,{variant:"outline",onClick:()=>d(!1),disabled:m.isPending,children:"Annuler"}),(0,b.jsx)(j.Button,{variant:"destructive",onClick:n,disabled:m.isPending,children:m.isPending?"Suppression...":"Supprimer"})]})]})})}var s=a.i(703130),t=a.i(104720),u=a.i(501199),v=a.i(87466),w=a.i(941675),x=a.i(911300),y=a.i(93518),z=a.i(469769),A=a.i(953722),B=a.i(46864),C=a.i(603314),D=a.i(218398),E=a.i(254115),F=a.i(495756),G=a.i(587532),H=a.i(581464),I=a.i(436265),J=a.i(177156),K=a.i(321161),L=a.i(111269),M=a.i(54018),N=a.i(255225),O=a.i(821374),P=a.i(699464),Q=a.i(915618),R=a.i(238246),S=a.i(497895),T=a.i(676504),U=a.i(254161),V=a.i(586547);let W=[{type:"convention",name:"Convention de formation",description:"Contrat entre l'établissement et l'apprenant",icon:t.FileText,color:"#335ACF"},{type:"facture",name:"Facture",description:"Document comptable de facturation",icon:u.Receipt,color:"#335ACF"},{type:"devis",name:"Devis",description:"Estimation de prix avant formation",icon:v.FileCheck,color:"#34B9EE"},{type:"convocation",name:"Convocation",description:"Invitation à une session ou examen",icon:w.Calendar,color:"#335ACF"},{type:"contrat",name:"Contrat de scolarité",description:"Accord de scolarisation officiel",icon:x.ClipboardList,color:"#335ACF"},{type:"attestation_reussite",name:"Attestation de réussite",description:"Certificat de réussite à une formation",icon:y.Award,color:"#335ACF"},{type:"certificat_scolarite",name:"Certificat de scolarité",description:"Justificatif d'inscription dans l'établissement",icon:z.GraduationCap,color:"#335ACF"},{type:"releve_notes",name:"Relevé de notes",description:"Bulletin de notes et appréciations",icon:A.BookOpen,color:"#34B9EE"},{type:"attestation_entree",name:"Attestation d'entrée en formation",description:"Certificat d'inscription à une formation",icon:B.UserCheck,color:"#335ACF"},{type:"reglement_interieur",name:"Règlement intérieur",description:"Règles et procédures de l'établissement",icon:C.Shield,color:"#335ACF"},{type:"cgv",name:"Conditions Générales de Vente",description:"CGV et conditions d'utilisation",icon:D.Scale,color:"#34B9EE"},{type:"programme",name:"Programme de formation",description:"Détails du contenu pédagogique",icon:E.Book,color:"#335ACF"},{type:"certificat_realisation",name:"Certificat de réalisation",description:"Certificat de réalisation de formation (OF obligatoire)",icon:F.CheckCircle,color:"#335ACF"},{type:"livret_accueil",name:"Livret d'accueil",description:"Livret d'accueil stagiaire (OF obligatoire)",icon:A.BookOpen,color:"#335ACF"},{type:"emargement",name:"Feuille d'émargement",description:"Feuille d'émargement formation (OF obligatoire)",icon:L.CheckCircle2,color:"#335ACF"},{type:"attestation_assiduite",name:"Attestation d'assiduité",description:"Justificatif de présence aux cours",icon:F.CheckCircle,color:"#335ACF"}];function X(){let{user:a}=(0,g.useAuth)(),i=(0,f.useQueryClient)(),[l,u]=(0,c.useState)(""),[v,w]=(0,c.useState)("all"),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(null),{data:F,isLoading:X}=(0,d.useQuery)({queryKey:["document-templates",a?.organization_id],queryFn:async()=>a?.organization_id?h.documentTemplateService.getAllTemplates(a.organization_id,{isActive:!0}):[],enabled:!!a?.organization_id}),Y=(0,c.useMemo)(()=>F?F.reduce((a,b)=>(a[b.type]||(a[b.type]=[]),a[b.type].push(b),a),{}):{},[F]),Z=(0,c.useMemo)(()=>{let a={};return Object.entries(Y).forEach(([b,c])=>{a[b]=[...c].sort((a,b)=>a.is_default&&!b.is_default?-1:!a.is_default&&b.is_default?1:new Date(b.created_at).getTime()-new Date(a.created_at).getTime())}),a},[Y]),$=(0,e.useMutation)({mutationFn:async b=>{if(!a?.organization_id)throw Error("Organisation non trouvée");return h.documentTemplateService.setAsDefault(b.id,a.organization_id)},onSuccess:()=>{i.invalidateQueries({queryKey:["document-templates",a?.organization_id]}),i.invalidateQueries({queryKey:["document-templates-by-type",a?.organization_id]})},onError:a=>{console.error("Erreur lors de la définition du modèle par défaut:",a),alert("Erreur lors de la définition du modèle par défaut")}}),_=W.filter(a=>{let b=a.name.toLowerCase().includes(l.toLowerCase())||a.description.toLowerCase().includes(l.toLowerCase()),c=(Z[a.type]||[]).length>0;return("configured"!==v||!!c)&&("not_configured"!==v||!c)&&b});return X?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-text-primary",children:"Modèles de Documents"}),(0,b.jsx)("p",{className:"text-text-tertiary mt-1",children:"Gérez vos modèles de documents administratifs"})]})}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((a,c)=>(0,b.jsx)(s.Card,{className:"animate-pulse",children:(0,b.jsxs)(s.CardContent,{className:"p-6",children:[(0,b.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),(0,b.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),(0,b.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})},c))})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold text-text-primary flex items-center gap-2",children:[(0,b.jsx)(K.Settings,{className:"h-8 w-8 text-brand-blue"}),"Modèles de Documents"]}),(0,b.jsx)("p",{className:"text-text-tertiary mt-1",children:"Gérez vos modèles de documents avec header et footer personnalisables"})]})}),(0,b.jsx)(s.Card,{children:(0,b.jsx)(s.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold",children:"Analytics & Reporting"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Consultez les métriques d'utilisation de vos templates"})]}),(0,b.jsx)(R.default,{href:"/dashboard/settings/document-templates/analytics",children:(0,b.jsxs)(j.Button,{variant:"outline",children:[(0,b.jsx)(N.BarChart3,{className:"h-4 w-4 mr-2"}),"Voir les analytics"]})})]})})}),(0,b.jsx)(s.Card,{children:(0,b.jsx)(s.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"flex-1 relative",children:[(0,b.jsx)(G.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-text-tertiary h-4 w-4"}),(0,b.jsx)(k.Input,{placeholder:"Rechercher un modèle...",value:l,onChange:a=>u(a.target.value),className:"pl-10"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(j.Button,{variant:"all"===v?"default":"outline",onClick:()=>w("all"),children:[(0,b.jsx)(H.Filter,{className:"h-4 w-4 mr-2"}),"Tous"]}),(0,b.jsxs)(j.Button,{variant:"configured"===v?"default":"outline",onClick:()=>w("configured"),children:[(0,b.jsx)(L.CheckCircle2,{className:"h-4 w-4 mr-2"}),"Configurés"]}),(0,b.jsxs)(j.Button,{variant:"not_configured"===v?"default":"outline",onClick:()=>w("not_configured"),children:[(0,b.jsx)(M.XCircle,{className:"h-4 w-4 mr-2"}),"Non configurés"]})]})]})})}),(0,b.jsx)(s.Card,{children:(0,b.jsx)(s.CardContent,{className:"p-0",children:(0,b.jsx)(V.Accordion,{type:"multiple",defaultValue:[],children:_.map(a=>{let c=Z[a.type]||[],d=a.icon,e=c.length>0;return c.find(a=>a.is_default),(0,b.jsxs)(V.AccordionItem,{value:a.type,children:[(0,b.jsx)(V.AccordionTrigger,{className:"px-6 hover:no-underline",children:(0,b.jsxs)("div",{className:"flex items-center justify-between w-full pr-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${a.color}15`},children:(0,b.jsx)(d,{className:"h-5 w-5",style:{color:a.color}})}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("div",{className:"font-semibold text-lg",children:a.name}),(0,b.jsx)("div",{className:"text-sm text-text-tertiary",children:a.description})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-3",children:(0,b.jsx)(U.Badge,{variant:e?"success":"secondary",children:e?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(L.CheckCircle2,{className:"h-3 w-3 mr-1"}),c.length," modèle",c.length>1?"s":""]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(M.XCircle,{className:"h-3 w-3 mr-1"}),"Aucun modèle"]})})})]})}),(0,b.jsx)(V.AccordionContent,{children:(0,b.jsx)("div",{className:"px-6 pb-4 space-y-3",children:0===c.length?(0,b.jsxs)("div",{className:"py-8 text-center",children:[(0,b.jsx)("p",{className:"text-text-tertiary mb-4",children:"Aucun modèle configuré pour ce type de document"}),(0,b.jsx)(R.default,{href:`/dashboard/settings/document-templates/${a.type}/edit`,children:(0,b.jsxs)(j.Button,{children:[(0,b.jsx)(Q.Plus,{className:"h-4 w-4 mr-2"}),"Créer un modèle"]})})]}):(0,b.jsxs)(b.Fragment,{children:[c.map(c=>(0,b.jsx)(s.Card,{className:"border-l-4",style:{borderLeftColor:a.color},children:(0,b.jsx)(s.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("h4",{className:"font-semibold",children:c.name}),c.is_default&&(0,b.jsxs)(U.Badge,{variant:"default",className:"text-xs",children:[(0,b.jsx)(O.Star,{className:"h-3 w-3 mr-1 fill-current"}),"Par défaut"]})]}),(0,b.jsxs)("div",{className:"text-sm text-text-tertiary space-y-1",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Modifié:"})," ",(0,S.formatDate)(c.updated_at)]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-medium",children:"Créé:"})," ",(0,S.formatDate)(c.created_at)]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(R.default,{href:`/dashboard/settings/document-templates/${a.type}/edit?template_id=${c.id}`,className:"no-underline",children:(0,b.jsxs)(j.Button,{variant:"default",size:"sm",children:[(0,b.jsx)(o.Edit,{className:"h-4 w-4 mr-2"}),"Modifier"]})}),(0,b.jsx)(R.default,{href:`/dashboard/settings/document-templates/${a.type}/preview?template_id=${c.id}`,className:"no-underline",children:(0,b.jsxs)(j.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(J.Eye,{className:"h-4 w-4 mr-2"}),"Aperçu"]})}),(0,b.jsxs)(T.DropdownMenu,{children:[(0,b.jsx)(T.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(j.Button,{variant:"outline",size:"sm",children:(0,b.jsx)(I.MoreVertical,{className:"h-4 w-4"})})}),(0,b.jsxs)(T.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(T.DropdownMenuLabel,{children:"Actions"}),(0,b.jsx)(T.DropdownMenuSeparator,{}),(0,b.jsxs)(T.DropdownMenuItem,{onClick:()=>{E(c),A(!0)},children:[(0,b.jsx)(P.Pencil,{className:"h-4 w-4 mr-2"}),"Renommer"]}),(0,b.jsxs)(T.DropdownMenuItem,{onClick:()=>{E(c),y(!0)},children:[(0,b.jsx)(m.Copy,{className:"h-4 w-4 mr-2"}),"Dupliquer"]}),!c.is_default&&(0,b.jsxs)(T.DropdownMenuItem,{onClick:()=>{$.mutate(c)},disabled:$.isPending,children:[(0,b.jsx)(O.Star,{className:"h-4 w-4 mr-2"}),"Définir par défaut"]}),(0,b.jsx)(T.DropdownMenuItem,{children:(0,b.jsxs)(R.default,{href:`/dashboard/settings/document-templates/${a.type}/analytics?template_id=${c.id}`,className:"flex items-center",children:[(0,b.jsx)(N.BarChart3,{className:"h-4 w-4 mr-2"}),"Analytics"]})}),(0,b.jsx)(T.DropdownMenuSeparator,{}),(0,b.jsxs)(T.DropdownMenuItem,{onClick:()=>{E(c),C(!0)},className:"text-red-600",children:[(0,b.jsx)(q.Trash2,{className:"h-4 w-4 mr-2"}),"Supprimer"]})]})]})]})]})})},c.id)),(0,b.jsx)("div",{className:"pt-2",children:(0,b.jsx)(R.default,{href:`/dashboard/settings/document-templates/${a.type}/edit`,children:(0,b.jsxs)(j.Button,{variant:"outline",className:"w-full",children:[(0,b.jsx)(Q.Plus,{className:"h-4 w-4 mr-2"}),"Créer un nouveau modèle"]})})})]})})})]},a.type)})})})}),0===_.length&&(0,b.jsx)(s.Card,{children:(0,b.jsxs)(s.CardContent,{className:"p-12 text-center",children:[(0,b.jsx)(t.FileText,{className:"h-12 w-12 text-text-tertiary mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Aucun modèle trouvé"}),(0,b.jsx)("p",{className:"text-text-tertiary",children:"Essayez de modifier vos critères de recherche ou de filtre"})]})}),D&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n,{template:D,open:x,onOpenChange:y}),(0,b.jsx)(p,{template:D,open:z,onOpenChange:A}),(0,b.jsx)(r,{template:D,open:B,onOpenChange:C})]})]})}a.s(["default",()=>X],194954)}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_settings_document-templates_page_tsx_163dee75._.js.map