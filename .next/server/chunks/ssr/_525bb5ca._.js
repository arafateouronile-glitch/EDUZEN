module.exports=[219897,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);a.i(460355);var e=a.i(346271);let f=c.forwardRef(({className:a,variant:c="default",hoverable:f=!1,glow:g=!1,glowColor:h="rgba(51, 90, 207, 0.3)",...i},j)=>(0,b.jsxs)(e.motion.div,{ref:j,className:(0,d.cn)("relative rounded-2xl border backdrop-blur-xl transition-all duration-300",{"bg-white/70 dark:bg-gray-900/70 border-white/20 dark:border-gray-700/30 shadow-lg":"default"===c,"bg-white/80 dark:bg-gray-900/80 border-white/30 dark:border-gray-700/40 shadow-xl":"premium"===c,"bg-white/50 dark:bg-gray-900/50 border-white/10 dark:border-gray-700/20 shadow-md":"subtle"===c,"cursor-pointer":f,"hover:shadow-2xl hover:scale-[1.02]":f,"hover:bg-white/90 dark:hover:bg-gray-900/90":f},a),whileHover:f?{scale:1.02,y:-2}:void 0,transition:{type:"spring",stiffness:300,damping:30},...i,children:[g&&(0,b.jsx)(e.motion.div,{className:"absolute inset-0 rounded-2xl opacity-0 blur-xl",style:{background:`radial-gradient(circle, ${h} 0%, transparent 70%)`},animate:{opacity:[0,.5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"}}),(0,b.jsx)("div",{className:"relative z-10",children:i.children})]}));f.displayName="GlassCard",a.s(["GlassCard",()=>f])},992258,a=>{"use strict";let b=(0,a.i(170106).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);a.s(["Mail",()=>b],992258)},177156,a=>{"use strict";let b=(0,a.i(170106).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>b],177156)},71277,a=>{"use strict";let b=(0,a.i(170106).default)("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);a.s(["PlayCircle",()=>b],71277)},963519,a=>{"use strict";let b=(0,a.i(170106).default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);a.s(["Phone",()=>b],963519)},318762,a=>{"use strict";var b=a.i(187924),c=a.i(433217),d=a.i(269240),e=a.i(913216),f=a.i(703130),g=a.i(219897),h=a.i(340695),i=a.i(205522),j=a.i(254161),k=a.i(660246),l=a.i(587532),m=a.i(992258),n=a.i(963519),o=a.i(469769),p=a.i(911300),q=a.i(177156),r=a.i(111269),s=a.i(953722),t=a.i(71277),u=a.i(238246),v=a.i(572131);a.i(460355);var w=a.i(346271),x=a.i(497895),y=a.i(576030);function z(){let a=(0,d.createClient)(),{user:z}=(0,e.useAuth)(),A=(0,y.useVocabulary)(),[B,C]=(0,v.useState)(""),{data:D,isLoading:E}=(0,c.useQuery)({queryKey:["teacher-sessions",z?.id],queryFn:async()=>{if(!z?.id)return[];let{data:b,error:c}=await a.from("session_teachers").select(`
          session_id,
          sessions (
            id,
            name,
            start_date,
            end_date,
            status,
            formation_id,
            formations (
              id,
              name
            )
          )
        `).eq("teacher_id",z.id);return c?(console.error("Erreur récupération sessions enseignant:",c),[]):b||[]},enabled:!!z?.id}),{data:F,isLoading:G}=(0,c.useQuery)({queryKey:["my-students",z?.id,D],queryFn:async()=>{if(!z?.id||!D||0===D.length)return[];let b=D.map(a=>a.session_id),{data:c,error:d}=await a.from("enrollments").select(`
          id,
          status,
          enrolled_at,
          session_id,
          sessions (
            id,
            name,
            start_date,
            end_date,
            formations (
              id,
              name
            )
          ),
          students (
            id,
            first_name,
            last_name,
            email,
            phone,
            status,
            photo_url
          )
        `).in("session_id",b).eq("status","active");return d?(console.error("Erreur récupération apprenants:",d),[]):c||[]},enabled:!!z?.id&&D&&D.length>0}),{data:H}=(0,c.useQuery)({queryKey:["attendance-stats",z?.id,F],queryFn:async()=>{if(!F||0===F.length)return{};let b=F.map(a=>a.students?.id).filter(Boolean),{data:c,error:d}=await a.from("attendance").select("student_id, status").in("student_id",b);if(d)return console.error("Erreur récupération émargements:",d),{};let e={};return c?.forEach(a=>{e[a.student_id]||(e[a.student_id]={present:0,absent:0,late:0,total:0}),e[a.student_id].total++,"present"===a.status?e[a.student_id].present++:"absent"===a.status?e[a.student_id].absent++:"late"===a.status&&e[a.student_id].late++}),e},enabled:!!F&&F.length>0}),I=F?.filter(a=>{let b=a.students;if(!b)return!1;let c=`${b.first_name} ${b.last_name}`.toLowerCase(),d=b.email?.toLowerCase()||"",e=B.toLowerCase();return c.includes(e)||d.includes(e)}),J={};return(I?.forEach(a=>{let b=a.session_id;J[b]||(J[b]=[]),J[b].push(a)}),E||G)?(0,b.jsx)("div",{className:"container mx-auto py-8 px-4",children:(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-blue"})})}):(0,b.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,b.jsxs)(w.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 mb-2 flex items-center gap-3",children:[(0,b.jsx)(k.Users,{className:"h-8 w-8 text-brand-blue"}),"Mes ",A.students]}),(0,b.jsx)("p",{className:"text-gray-600",children:"Gérez les apprenants qui vous sont assignés dans vos sessions de formation"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[(0,b.jsx)(g.GlassCard,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-brand-blue/10 rounded-lg",children:(0,b.jsx)(k.Users,{className:"h-5 w-5 text-brand-blue"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Total apprenants"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:F?.length||0})]})]})}),(0,b.jsx)(g.GlassCard,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,b.jsx)(s.BookOpen,{className:"h-5 w-5 text-purple-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Sessions actives"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:D?.filter(a=>a.sessions?.status==="active"||a.sessions?.status==="in_progress").length||0})]})]})}),(0,b.jsx)(g.GlassCard,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,b.jsx)(r.CheckCircle2,{className:"h-5 w-5 text-green-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"Taux présence moyen"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:H&&Object.keys(H).length>0?Math.round(Object.values(H).reduce((a,b)=>a+(b.total>0?b.present/b.total*100:0),0)/Object.keys(H).length)+"%":"N/A"})]})]})})]}),(0,b.jsxs)("div",{className:"mb-6 flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[(0,b.jsxs)("div",{className:"relative max-w-md flex-1",children:[(0,b.jsx)(l.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,b.jsx)(i.Input,{type:"text",placeholder:"Rechercher un apprenant...",value:B,onChange:a=>C(a.target.value),className:"pl-10"})]}),(0,b.jsx)(u.default,{href:"/dashboard/my-students/elearning",children:(0,b.jsxs)(h.Button,{variant:"outline",className:"gap-2",children:[(0,b.jsx)(t.PlayCircle,{className:"h-4 w-4 text-purple-600"}),"Suivi E-Learning"]})})]}),0===Object.keys(J).length?(0,b.jsx)(f.Card,{children:(0,b.jsxs)(f.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(k.Users,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun apprenant assigné"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Vous n'avez pas encore d'apprenants dans vos sessions de formation."})]})}):(0,b.jsx)("div",{className:"space-y-6",children:Object.entries(J).map(([a,c],d)=>{let e=c[0]?.sessions,g=e?.formations;return(0,b.jsx)(w.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*d},children:(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{className:"border-b",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(f.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(o.GraduationCap,{className:"h-5 w-5 text-brand-blue"}),e?.name||"Session"]}),(0,b.jsxs)(f.CardDescription,{className:"mt-1",children:[g?.name," • ",(0,x.formatDate)(e?.start_date)," - ",(0,x.formatDate)(e?.end_date)]})]}),(0,b.jsx)(j.Badge,{variant:e?.status==="active"||e?.status==="in_progress"?"default":"secondary",children:e?.status==="active"||e?.status==="in_progress"?"En cours":e?.status})]})}),(0,b.jsx)(f.CardContent,{className:"p-0",children:(0,b.jsx)("div",{className:"divide-y",children:c.map(c=>{var d;let e,f=c.students;if(!f)return null;let g=(d=f.id,(e=H?.[d])&&0!==e.total?Math.round(e.present/e.total*100):null);return(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-brand-blue/10 flex items-center justify-center",children:f.photo_url?(0,b.jsx)("img",{src:f.photo_url,alt:`${f.first_name} ${f.last_name}`,className:"w-10 h-10 rounded-full object-cover"}):(0,b.jsxs)("span",{className:"text-brand-blue font-medium",children:[f.first_name?.[0],f.last_name?.[0]]})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"font-medium text-gray-900",children:[f.first_name," ",f.last_name]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[f.email&&(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(m.Mail,{className:"h-3 w-3"}),f.email]}),f.phone&&(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(n.Phone,{className:"h-3 w-3"}),f.phone]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Présence"}),(0,b.jsx)("p",{className:(0,x.cn)("font-medium",null===g?"text-gray-400":g>=80?"text-green-600":g>=60?"text-yellow-600":"text-red-600"),children:null!==g?`${g}%`:"N/A"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(u.default,{href:`/dashboard/attendance?student=${f.id}&session=${a}`,children:(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",children:[(0,b.jsx)(p.ClipboardList,{className:"h-4 w-4 mr-1"}),"Émargement"]})}),(0,b.jsx)(u.default,{href:`/dashboard/students/${f.id}`,children:(0,b.jsx)(h.Button,{variant:"ghost",size:"sm",children:(0,b.jsx)(q.Eye,{className:"h-4 w-4"})})})]})]})]},c.id)})})})]})},a)})})]})}a.s(["default",()=>z])}];

//# sourceMappingURL=_525bb5ca._.js.map