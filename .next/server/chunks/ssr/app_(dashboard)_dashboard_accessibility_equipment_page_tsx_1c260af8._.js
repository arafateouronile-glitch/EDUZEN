module.exports=[530020,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(433217),e=a.i(913216),f=a.i(195308),g=a.i(703130),h=a.i(340695),i=a.i(205522),j=a.i(254161),k=a.i(883497),l=a.i(124987),m=a.i(941675),n=a.i(290821);let o={mobility:"Mobilité",visual:"Visuel",auditory:"Auditif",ergonomic:"Ergonomique",software:"Logiciel",other:"Autre"},p={available:"bg-green-100 text-green-800",in_use:"bg-blue-100 text-blue-800",maintenance:"bg-yellow-100 text-yellow-800",retired:"bg-gray-100 text-gray-800"},q={available:"Disponible",in_use:"En utilisation",maintenance:"Maintenance",retired:"Retiré"};function r({equipment:a,onAssign:c,onEdit:d,showActions:e=!0}){let f="available"===a.status&&a.quantity_available>0,i=a.next_maintenance_date&&new Date(a.next_maintenance_date)<new Date;return(0,b.jsxs)(g.Card,{className:`${f?"border-green-200":""} hover:shadow-md transition-shadow`,children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)("div",{className:"flex items-start justify-between",children:(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)(g.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,b.jsx)(k.Package,{className:"h-4 w-4"}),a.name]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[a.category&&(0,b.jsx)(j.Badge,{variant:"outline",className:"text-xs",children:o[a.category]||a.category}),(0,b.jsx)(j.Badge,{className:`${p[a.status]} text-xs`,children:q[a.status]})]})]})})}),(0,b.jsxs)(g.CardContent,{className:"space-y-3",children:[a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Disponibilité"}),(0,b.jsxs)("span",{className:`text-sm font-medium ${f?"text-green-600":"text-gray-600"}`,children:[a.quantity_available," / ",a.quantity_total]})]}),a.location&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)(l.MapPin,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:a.location})]}),a.next_maintenance_date&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)(m.Calendar,{className:"h-3 w-3"}),(0,b.jsxs)("span",{children:["Prochaine maintenance : ",new Date(a.next_maintenance_date).toLocaleDateString("fr-FR")]})]}),i&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-yellow-600 font-medium",children:[(0,b.jsx)(n.AlertCircle,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:"Maintenance requise"})]}),e&&(0,b.jsxs)("div",{className:"flex gap-2 pt-2",children:[f&&c&&(0,b.jsx)(h.Button,{onClick:c,size:"sm",className:"flex-1",children:"Attribuer"}),d&&(0,b.jsx)(h.Button,{onClick:d,variant:"outline",size:"sm",className:f?"":"flex-1",children:"Modifier"})]})]})]})}var s=a.i(370025),t=a.i(937927),u=a.i(917171),v=a.i(546893),w=a.i(864037),x=a.i(114548),y=a.i(633508);let z=[{value:"mobility",label:"Mobilité"},{value:"visual",label:"Visuel"},{value:"auditory",label:"Auditif"},{value:"ergonomic",label:"Ergonomique"},{value:"software",label:"Logiciel"},{value:"other",label:"Autre"}],A=[{value:"available",label:"Disponible"},{value:"in_use",label:"En utilisation"},{value:"maintenance",label:"Maintenance"},{value:"retired",label:"Retiré"}],B=[{value:"none",label:"Aucune"},{value:"monthly",label:"Mensuelle"},{value:"quarterly",label:"Trimestrielle"},{value:"biannual",label:"Semestrielle"},{value:"annual",label:"Annuelle"}];function C({organizationId:a,equipmentId:d,initialData:e,onSuccess:j,onCancel:k}){let l=(0,t.useQueryClient)(),{addToast:m}=(0,w.useToast)(),[n,o]=(0,c.useState)({name:e?.name||"",category:e?.category||"mobility",description:e?.description||"",location:e?.location||"",quantity_total:e?.quantity_total||1,quantity_available:e?.quantity_available||1,status:e?.status||"available",purchase_date:e?.purchase_date||"",warranty_expiry_date:e?.warranty_expiry_date||"",maintenance_schedule:e?.maintenance_schedule||"none",last_maintenance_date:e?.last_maintenance_date||"",next_maintenance_date:e?.next_maintenance_date||"",notes:e?.notes||"",metadata:e?.metadata||{}}),p=(0,s.useMutation)({mutationFn:async()=>{let b={organization_id:a,...n,purchase_date:n.purchase_date||null,warranty_expiry_date:n.warranty_expiry_date||null,last_maintenance_date:n.last_maintenance_date||null,next_maintenance_date:n.next_maintenance_date||null};return d?await f.accessibilityService.updateEquipment(d,b):await f.accessibilityService.createEquipment(b)},onSuccess:()=>{l.invalidateQueries({queryKey:["accessibility-equipment"]}),l.invalidateQueries({queryKey:["accessibility-stats"]}),m({type:"success",title:d?"Équipement mis à jour":"Équipement créé",description:`L'\xe9quipement a \xe9t\xe9 ${d?"mis à jour":"créé"} avec succ\xe8s.`}),j?.()},onError:a=>{m({type:"error",title:"Erreur",description:a?.message||"Impossible de sauvegarder l'équipement."})}}),q=(a,b)=>{o(c=>({...c,[a]:b}))};return(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{children:d?"Modifier l'équipement":"Nouvel équipement"})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("form",{onSubmit:a=>{(a.preventDefault(),n.name&&n.category)?n.quantity_available>n.quantity_total?m({type:"error",title:"Validation échouée",description:"La quantité disponible ne peut pas dépasser la quantité totale."}):p.mutate():m({type:"error",title:"Validation échouée",description:"Veuillez remplir tous les champs obligatoires."})},className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{htmlFor:"name",children:"Nom de l'équipement *"}),(0,b.jsx)(i.Input,{id:"name",value:n.name,onChange:a=>q("name",a.target.value),placeholder:"Ex: Fauteuil roulant électrique",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{htmlFor:"category",children:"Catégorie *"}),(0,b.jsx)("select",{id:"category",value:n.category,onChange:a=>q("category",a.target.value),className:"w-full px-4 py-3 border-2 border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",required:!0,children:z.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)(v.Textarea,{id:"description",value:n.description,onChange:a=>q("description",a.target.value),placeholder:"Caractéristiques techniques, modèle, etc.",rows:3})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{htmlFor:"location",children:"Localisation"}),(0,b.jsx)(i.Input,{id:"location",value:n.location,onChange:a=>q("location",a.target.value),placeholder:"Ex: Salle A12, Bâtiment B"})]})]}),(0,b.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,b.jsx)("h3",{className:"font-medium",children:"Disponibilité"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{htmlFor:"quantity_total",children:"Quantité totale *"}),(0,b.jsx)(i.Input,{id:"quantity_total",type:"number",min:"1",value:n.quantity_total,onChange:a=>{var b;return b=parseInt(a.target.value)||1,void o(a=>({...a,quantity_total:b,quantity_available:d?a.quantity_available:b}))},required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{htmlFor:"quantity_available",children:"Quantité disponible *"}),(0,b.jsx)(i.Input,{id:"quantity_available",type:"number",min:"0",max:n.quantity_total,value:n.quantity_available,onChange:a=>q("quantity_available",parseInt(a.target.value)||0),required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{htmlFor:"status",children:"Statut"}),(0,b.jsx)("select",{id:"status",value:n.status,onChange:a=>q("status",a.target.value),className:"w-full px-4 py-3 border-2 border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",children:A.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,b.jsx)("h3",{className:"font-medium",children:"Achat et garantie"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{htmlFor:"purchase_date",children:"Date d'achat"}),(0,b.jsx)(i.Input,{id:"purchase_date",type:"date",value:n.purchase_date,onChange:a=>q("purchase_date",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{htmlFor:"warranty_expiry_date",children:"Fin de garantie"}),(0,b.jsx)(i.Input,{id:"warranty_expiry_date",type:"date",value:n.warranty_expiry_date,onChange:a=>q("warranty_expiry_date",a.target.value)})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,b.jsx)("h3",{className:"font-medium",children:"Maintenance"}),(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{htmlFor:"maintenance_schedule",children:"Fréquence de maintenance"}),(0,b.jsx)("select",{id:"maintenance_schedule",value:n.maintenance_schedule,onChange:a=>q("maintenance_schedule",a.target.value),className:"w-full px-4 py-3 border-2 border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",children:B.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),"none"!==n.maintenance_schedule&&(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{htmlFor:"last_maintenance_date",children:"Dernière maintenance"}),(0,b.jsx)(i.Input,{id:"last_maintenance_date",type:"date",value:n.last_maintenance_date,onChange:a=>q("last_maintenance_date",a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{htmlFor:"next_maintenance_date",children:"Prochaine maintenance"}),(0,b.jsx)(i.Input,{id:"next_maintenance_date",type:"date",value:n.next_maintenance_date,onChange:a=>q("next_maintenance_date",a.target.value)})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Label,{htmlFor:"notes",children:"Notes internes"}),(0,b.jsx)(v.Textarea,{id:"notes",value:n.notes,onChange:a=>q("notes",a.target.value),placeholder:"Informations complémentaires, remarques...",rows:3})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[k&&(0,b.jsxs)(h.Button,{type:"button",variant:"outline",onClick:k,children:[(0,b.jsx)(y.X,{className:"h-4 w-4 mr-2"}),"Annuler"]}),(0,b.jsxs)(h.Button,{type:"submit",disabled:p.isPending,children:[(0,b.jsx)(x.Save,{className:"h-4 w-4 mr-2"}),p.isPending?"Enregistrement...":"Enregistrer"]})]})]})})]})}var D=a.i(915618),E=a.i(587532),F=a.i(400210),G=a.i(238246),H=a.i(965733);function I(){let{user:a}=(0,e.useAuth)(),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)(""),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(null),{data:w=[],isLoading:x}=(0,d.useQuery)({queryKey:["accessibility-equipment",a?.organization_id,n,p],queryFn:async()=>a?.organization_id?await f.accessibilityService.getEquipment(a.organization_id,{category:n||void 0,status:p||void 0}):[],enabled:!!a?.organization_id,retry:!1}),y=w.filter(a=>{if(!l)return!0;let b=l.toLowerCase();return a.name?.toLowerCase().includes(b)||a.description?.toLowerCase().includes(b)||a.location?.toLowerCase().includes(b)}),z={total:w.length,available:w.filter(a=>"available"===a.status&&a.quantity_available>0).length,in_use:w.filter(a=>"in_use"===a.status).length,maintenance:w.filter(a=>"maintenance"===a.status).length,total_capacity:w.reduce((a,b)=>a+(b.quantity_total||0),0),total_available:w.reduce((a,b)=>a+(b.quantity_available||0),0)},A=[{value:"",label:"Toutes catégories"},{value:"mobility",label:"Mobilité"},{value:"visual",label:"Visuel"},{value:"auditory",label:"Auditif"},{value:"ergonomic",label:"Ergonomique"},{value:"software",label:"Logiciel"},{value:"other",label:"Autre"}],B=[{value:"",label:"Tous statuts"},{value:"available",label:"Disponible"},{value:"in_use",label:"En utilisation"},{value:"maintenance",label:"Maintenance"},{value:"retired",label:"Retiré"}],I=()=>{t(!1),v(null)};return a?(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(G.default,{href:"/dashboard/accessibility",children:(0,b.jsxs)(h.Button,{variant:"ghost",size:"sm",children:[(0,b.jsx)(F.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Retour"]})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[(0,b.jsx)(k.Package,{className:"h-8 w-8 text-primary"}),"Gestion des Équipements"]}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1",children:"Inventaire et suivi des équipements adaptés"})]})]}),(0,b.jsxs)(h.Button,{onClick:()=>t(!0),children:[(0,b.jsx)(D.Plus,{className:"h-4 w-4 mr-2"}),"Ajouter un équipement"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{className:"pb-3",children:(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total équipements"})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("p",{className:"text-2xl font-bold",children:z.total})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{className:"pb-3",children:(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Disponibles"})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("p",{className:"text-2xl font-bold text-green-600",children:z.available})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{className:"pb-3",children:(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"En utilisation"})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:z.in_use})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{className:"pb-3",children:(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Maintenance"})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsx)("p",{className:"text-2xl font-bold text-amber-600",children:z.maintenance})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{className:"pb-3",children:(0,b.jsx)(g.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Capacité totale"})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("p",{className:"text-2xl font-bold",children:[z.total_available," / ",z.total_capacity]})})]})]}),(0,b.jsx)(g.Card,{children:(0,b.jsxs)(g.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(E.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(i.Input,{placeholder:"Rechercher par nom, description ou localisation...",value:l,onChange:a=>m(a.target.value),className:"pl-10"})]})}),(0,b.jsx)("div",{className:"w-full md:w-48",children:(0,b.jsx)("select",{value:n,onChange:a=>o(a.target.value),className:"w-full px-4 py-2 border-2 border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",children:A.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})}),(0,b.jsx)("div",{className:"w-full md:w-48",children:(0,b.jsx)("select",{value:p,onChange:a=>q(a.target.value),className:"w-full px-4 py-2 border-2 border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",children:B.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})})]}),(l||n||p)&&(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Filtres actifs:"}),l&&(0,b.jsxs)(j.Badge,{variant:"outline",children:["Recherche: ",l,(0,b.jsx)("button",{onClick:()=>m(""),className:"ml-2",children:"×"})]}),n&&(0,b.jsxs)(j.Badge,{variant:"outline",children:[A.find(a=>a.value===n)?.label,(0,b.jsx)("button",{onClick:()=>o(""),className:"ml-2",children:"×"})]}),p&&(0,b.jsxs)(j.Badge,{variant:"outline",children:[B.find(a=>a.value===p)?.label,(0,b.jsx)("button",{onClick:()=>q(""),className:"ml-2",children:"×"})]})]})]})}),x?(0,b.jsx)(g.Card,{children:(0,b.jsx)(g.CardContent,{className:"p-6",children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Chargement des équipements..."})})}):0===y.length?(0,b.jsx)(g.Card,{children:(0,b.jsxs)(g.CardContent,{className:"p-12 text-center",children:[(0,b.jsx)(k.Package,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Aucun équipement trouvé"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:0===w.length?"Commencez par ajouter votre premier équipement adapté":"Aucun équipement ne correspond à vos critères de recherche"}),0===w.length&&(0,b.jsxs)(h.Button,{onClick:()=>t(!0),children:[(0,b.jsx)(D.Plus,{className:"h-4 w-4 mr-2"}),"Ajouter un équipement"]})]})}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:y.map(a=>(0,b.jsx)(r,{equipment:a,onEdit:()=>{v(a),t(!0)},showActions:!0},a.id))}),(0,b.jsx)(H.Dialog,{open:s,onOpenChange:t,children:(0,b.jsxs)(H.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(H.DialogHeader,{children:[(0,b.jsx)(H.DialogTitle,{children:u?"Modifier l'équipement":"Nouvel équipement"}),(0,b.jsx)(H.DialogDescription,{children:u?"Modifiez les informations de l'équipement":"Ajoutez un nouvel équipement adapté à votre inventaire"})]}),(0,b.jsx)(C,{organizationId:a.organization_id||"",equipmentId:u?.id,initialData:u,onSuccess:I,onCancel:I})]})})]}):(0,b.jsx)("div",{className:"p-6",children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Chargement..."})})}a.s(["default",()=>I],530020)}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_accessibility_equipment_page_tsx_1c260af8._.js.map