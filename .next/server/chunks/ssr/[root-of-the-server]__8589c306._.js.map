{"version":3,"sources":["../../../../node_modules/lucide-react/src/icons/plus.ts","../../../../node_modules/lucide-react/src/icons/arrow-left.ts","../../../../node_modules/lucide-react/src/icons/check-circle.ts","../../../../components/ui/select.tsx","../../../../node_modules/lucide-react/src/icons/copy.ts","../../../../lib/utils/document-generation/variable-extractor.ts","../../../../components/document-editor/template-selector.tsx","../../../../app/%28dashboard%29/dashboard/documents/generate-batch/page.tsx"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Plus\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNSAxMmgxNCIgLz4KICA8cGF0aCBkPSJNMTIgNXYxNCIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/plus\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Plus = createLucideIcon('Plus', [\n  ['path', { d: 'M5 12h14', key: '1ays0h' }],\n  ['path', { d: 'M12 5v14', key: 's699le' }],\n]);\n\nexport default Plus;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ArrowLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTIgMTktNy03IDctNyIgLz4KICA8cGF0aCBkPSJNMTkgMTJINSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeft = createLucideIcon('ArrowLeft', [\n  ['path', { d: 'm12 19-7-7 7-7', key: '1l729n' }],\n  ['path', { d: 'M19 12H5', key: 'x3x0zl' }],\n]);\n\nexport default ArrowLeft;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name CheckCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjIgMTEuMDhWMTJhMTAgMTAgMCAxIDEtNS45My05LjE0IiAvPgogIDxwYXRoIGQ9Im05IDExIDMgM0wyMiA0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/check-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst CheckCircle = createLucideIcon('CheckCircle', [\n  ['path', { d: 'M22 11.08V12a10 10 0 1 1-5.93-9.14', key: 'g774vq' }],\n  ['path', { d: 'm9 11 3 3L22 4', key: '1pflzl' }],\n]);\n\nexport default CheckCircle;\n","'use client'\n\nimport * as React from 'react'\nimport { cn } from '@/lib/utils'\nimport { motion, AnimatePresence } from '@/components/ui/motion'\nimport { ChevronDown, Check, AlertCircle } from 'lucide-react'\n\nexport interface SelectProps\n  extends Omit<React.SelectHTMLAttributes<HTMLSelectElement>, 'children'> {\n  label?: string\n  error?: string\n  helperText?: string\n  variant?: 'default' | 'outlined' | 'filled'\n  leftIcon?: React.ReactNode\n  options: Array<{ value: string; label: string; disabled?: boolean }>\n  placeholder?: string\n}\n\nconst SelectNative = React.forwardRef<HTMLSelectElement, SelectProps>(\n  ({ \n    className, \n    label, \n    error, \n    helperText,\n    variant = 'default',\n    leftIcon,\n    id,\n    options,\n    placeholder,\n    value,\n    ...props \n  }, ref) => {\n    const [isFocused, setIsFocused] = React.useState(false)\n    const [isOpen, setIsOpen] = React.useState(false)\n    const selectId = id || `select-${Math.random().toString(36).substr(2, 9)}`\n    const hasValue = !!value\n\n    const baseStyles = cn(\n      'flex w-full rounded-lg font-medium transition-all duration-300',\n      'appearance-none cursor-pointer',\n      'focus:outline-none focus:ring-2 focus:ring-primary/20',\n      'disabled:cursor-not-allowed disabled:opacity-50',\n      {\n        // Default variant\n        'border-2 border-input bg-background px-4 py-3 pr-11': variant === 'default',\n        'focus:border-primary focus:bg-white': variant === 'default' && !error,\n        'border-destructive focus:border-destructive focus:ring-destructive/20': error,\n        \n        // Outlined variant\n        'border-2 border-input bg-transparent px-4 py-3 pr-11': variant === 'outlined',\n        'focus:border-primary focus:shadow-md focus:shadow-primary/10': variant === 'outlined' && !error,\n        \n        // Filled variant\n        'border-0 border-b-2 border-input bg-muted/50 px-4 py-3 pr-11 rounded-b-none': variant === 'filled',\n        'focus:bg-muted focus:border-primary': variant === 'filled' && !error,\n        'focus:border-destructive bg-destructive/5': variant === 'filled' && error,\n      },\n      leftIcon && 'pl-11',\n      className\n    )\n\n    return (\n      <div className=\"w-full space-y-1.5\">\n        {label && (\n          <motion.label\n            htmlFor={selectId}\n            initial={false}\n            animate={{\n              color: error ? '#EF4444' : isFocused ? 'rgb(37, 99, 235)' : 'rgb(107, 114, 128)',\n            }}\n            className={cn(\n              'block text-sm font-medium transition-colors duration-200',\n              error && 'text-destructive'\n            )}\n          >\n            {label}\n            {props.required && <span className=\"text-destructive ml-1\">*</span>}\n          </motion.label>\n        )}\n        \n        <div className=\"relative\">\n          {/* Left Icon */}\n          {leftIcon && (\n            <div className=\"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground pointer-events-none z-10\">\n              {leftIcon}\n            </div>\n          )}\n          \n          {/* Select */}\n          <motion.select\n            ref={ref}\n            id={selectId}\n            value={value}\n            {...props}\n            onFocus={(e) => {\n              setIsFocused(true)\n              props.onFocus?.(e)\n            }}\n            onBlur={(e) => {\n              setIsFocused(false)\n              setIsOpen(false)\n              props.onBlur?.(e)\n            }}\n            onMouseDown={() => setIsOpen(!isOpen)}\n            className={baseStyles}\n            animate={{\n              scale: isFocused ? 1.01 : 1,\n              borderColor: error \n                ? '#EF4444' \n                : isFocused \n                  ? 'rgb(37, 99, 235)' \n                  : 'rgb(226, 232, 240)',\n            }}\n            transition={{ duration: 0.2 }}\n          >\n            {placeholder && (\n              <option value=\"\" disabled>\n                {placeholder}\n              </option>\n            )}\n            {(options || []).map((option) => (\n              <option\n                key={option.value}\n                value={option.value}\n                disabled={option.disabled}\n              >\n                {option.label}\n              </option>\n            ))}\n          </motion.select>\n          \n          {/* Chevron Icon */}\n          <motion.div\n            className=\"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground\"\n            animate={{ rotate: isOpen ? 180 : 0 }}\n            transition={{ duration: 0.2 }}\n          >\n            <ChevronDown className=\"h-5 w-5\" />\n          </motion.div>\n          \n          {/* Error Icon */}\n          {error && (\n            <motion.div\n              className=\"absolute right-11 top-1/2 -translate-y-1/2 pointer-events-none\"\n              initial={{ scale: 0, opacity: 0 }}\n              animate={{ scale: 1, opacity: 1 }}\n              transition={{ type: \"spring\", stiffness: 500, damping: 30 }}\n            >\n              <AlertCircle className=\"h-5 w-5 text-destructive\" />\n            </motion.div>\n          )}\n        </div>\n        \n        {/* Helper Text / Error Message */}\n        <AnimatePresence mode=\"wait\">\n          {(error || helperText) && (\n            <motion.p\n              initial={{ opacity: 0, y: -5 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -5 }}\n              transition={{ duration: 0.2 }}\n              className={cn(\n                'text-xs transition-colors duration-200',\n                error ? 'text-destructive' : 'text-muted-foreground'\n              )}\n            >\n              {error || helperText}\n            </motion.p>\n          )}\n        </AnimatePresence>\n      </div>\n    )\n  }\n)\nSelectNative.displayName = 'SelectNative'\n\n// Export SelectNative as Select for backward compatibility\nexport { SelectNative as SelectField }\n\n// Composants Radix UI pour compatibilité avec l'API Radix\ninterface SelectContextValue {\n  value?: string\n  onValueChange?: (value: string) => void\n  open?: boolean\n  setOpen?: (open: boolean) => void\n}\n\nconst SelectContext = React.createContext<SelectContextValue>({})\n\ninterface SelectRootProps {\n  value?: string\n  onValueChange?: (value: string) => void\n  children: React.ReactNode\n}\n\n// Wrapper pour utiliser Select comme composant Radix\nexport const SelectRoot = React.forwardRef<HTMLDivElement, SelectRootProps>(\n  ({ value, onValueChange, children }, ref) => {\n    const [open, setOpen] = React.useState(false)\n    \n    return (\n      <SelectContext.Provider value={{ value, onValueChange, open, setOpen }}>\n        <div className=\"relative\" ref={ref}>{children}</div>\n      </SelectContext.Provider>\n    )\n  }\n)\nSelectRoot.displayName = 'SelectRoot'\n\ninterface SelectTriggerProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  children: React.ReactNode\n}\n\nexport const SelectTrigger = React.forwardRef<HTMLButtonElement, SelectTriggerProps>(\n  ({ children, className, ...props }, ref) => {\n    const { open, setOpen } = React.useContext(SelectContext)\n    \n    return (\n      <button\n        ref={ref}\n        type=\"button\"\n        className={cn(\n          'flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',\n          className\n        )}\n        onClick={() => setOpen?.(!open)}\n        {...props}\n      >\n        {children}\n        <ChevronDown className={cn('h-4 w-4 opacity-50 transition-transform', open && 'rotate-180')} />\n      </button>\n    )\n  }\n)\nSelectTrigger.displayName = 'SelectTrigger'\n\ninterface SelectValueProps {\n  placeholder?: string\n}\n\nexport const SelectValue = React.forwardRef<HTMLSpanElement, SelectValueProps>(\n  ({ placeholder }, ref) => {\n    const { value } = React.useContext(SelectContext)\n    return <span ref={ref}>{value || placeholder}</span>\n  }\n)\nSelectValue.displayName = 'SelectValue'\n\ninterface SelectContentProps {\n  children: React.ReactNode\n}\n\nexport const SelectContent = React.forwardRef<HTMLDivElement, SelectContentProps>(\n  ({ children }, ref) => {\n    const context = React.useContext(SelectContext)\n    const open = context?.open ?? false\n    \n    if (!open) return null\n    \n    // S'assurer que children est toujours défini et peut être rendu\n    if (!children) return null\n    \n    return (\n      <div \n        ref={ref} \n        className=\"absolute top-full left-0 z-50 mt-1 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md\"\n      >\n        <div className=\"p-1\">{children}</div>\n      </div>\n    )\n  }\n)\nSelectContent.displayName = 'SelectContent'\n\ninterface SelectItemProps extends React.HTMLAttributes<HTMLDivElement> {\n  value: string\n  children: React.ReactNode\n}\n\nexport const SelectItem = React.forwardRef<HTMLDivElement, SelectItemProps>(\n  ({ value, children, className, ...props }, ref) => {\n    const { value: selectedValue, onValueChange, setOpen } = React.useContext(SelectContext)\n    const isSelected = selectedValue === value\n\n    const handleClick = () => {\n      onValueChange?.(value)\n      setOpen?.(false)\n    }\n\n    return (\n      <div\n        ref={ref}\n        role=\"option\"\n        aria-selected={isSelected}\n        className={cn(\n          'relative flex w-full cursor-pointer select-none items-center rounded-sm py-1.5 px-2 text-sm outline-none hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground',\n          isSelected && 'bg-accent text-accent-foreground',\n          className\n        )}\n        onClick={handleClick}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n)\nSelectItem.displayName = 'SelectItem'\n\n// Export Select as alias for SelectRoot for Radix UI compatibility\nexport const Select = SelectRoot\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Copy\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cmVjdCB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHg9IjgiIHk9IjgiIHJ4PSIyIiByeT0iMiIgLz4KICA8cGF0aCBkPSJNNCAxNmMtMS4xIDAtMi0uOS0yLTJWNGMwLTEuMS45LTIgMi0yaDEwYzEuMSAwIDIgLjkgMiAyIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/copy\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Copy = createLucideIcon('Copy', [\n  ['rect', { width: '14', height: '14', x: '8', y: '8', rx: '2', ry: '2', key: '17jyea' }],\n  ['path', { d: 'M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2', key: 'zix9uf' }],\n]);\n\nexport default Copy;\n","/**\n * Extrait les variables pour la génération de documents\n */\n\nimport type { DocumentVariables } from '@/lib/types/document-templates'\nimport type { StudentWithRelations, SessionWithRelations, InvoiceWithRelations } from '@/lib/types/query-types'\nimport type { TableRow } from '@/lib/types/supabase-helpers'\n\ntype Organization = TableRow<'organizations'>\ntype Student = TableRow<'students'>\ntype Session = TableRow<'sessions'>\ntype Invoice = TableRow<'invoices'>\n\ntype Program = TableRow<'programs'>\n\nexport interface ExtractVariablesOptions {\n  student?: StudentWithRelations | Student\n  organization?: Organization\n  session?: SessionWithRelations | Session\n  invoice?: InvoiceWithRelations | Invoice\n  program?: Program & { formations?: Array<{ id: string; name: string; duration_hours?: number }> }\n  academicYear?: { name: string } | null\n  language?: 'fr' | 'en'\n  issueDate?: string\n}\n\n/**\n * Extrait les variables de document depuis les données fournies\n */\nexport function extractDocumentVariables(options: ExtractVariablesOptions): DocumentVariables {\n  const {\n    student,\n    organization,\n    session,\n    invoice,\n    program,\n    academicYear,\n    language = 'fr',\n    issueDate = new Date().toISOString(),\n  } = options\n\n  const variables: any = {\n    // Date actuelle\n    date_emission: new Date().toLocaleDateString('fr-FR'),\n    date_aujourd_hui: new Date().toLocaleDateString('fr-FR'),\n    date_jour: new Date().toLocaleDateString('fr-FR'),\n    annee_courante: new Date().getFullYear().toString(),\n    annee_actuelle: new Date().getFullYear().toString(),\n    date_generation: new Date().toLocaleDateString('fr-FR'),\n    heure: new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' }),\n\n    // Organisation/École (utiliser les deux formats pour compatibilité)\n    // Format standard (ecole_*)\n    ecole_nom: organization?.name || '',\n    ecole_logo: organization?.logo_url || '',\n    ecole_adresse: organization?.address || '',\n    ecole_ville: (organization?.address || '').split(',').pop()?.trim() || '',\n    ecole_telephone: organization?.phone || '',\n    ecole_email: organization?.email || '',\n    ecole_site_web: (organization as any)?.website || '',\n    ecole_code_postal: (organization?.address || '').match(/\\d{5}/)?.[0] || '',\n    \n    // Format alternatif (organisation_*) pour compatibilité avec anciens templates\n    organisation_nom: organization?.name || '',\n    organisation_adresse: organization?.address || '',\n    organisation_telephone: organization?.phone || '',\n    organisation_email: organization?.email || '',\n    organisation_logo: organization?.logo_url || '',\n    organisation_site_web: (organization as any)?.website || '',\n\n    // Étudiant/Élève (utiliser les deux formats pour compatibilité)\n    // Format standard (eleve_*)\n    eleve_nom: student?.last_name || '',\n    eleve_prenom: student?.first_name || '',\n    eleve_numero: student?.student_number || '',\n    eleve_date_naissance: student?.date_of_birth\n      ? new Date(student.date_of_birth).toLocaleDateString('fr-FR')\n      : '',\n    eleve_classe: ((student as StudentWithRelations) as any)?.classes\n      ? (((student as StudentWithRelations) as any).classes as { name: string }).name\n      : '',\n    eleve_photo: (student as any)?.photo_url || '',\n    eleve_adresse: (student as any)?.address || '',\n    eleve_telephone: (student as any)?.phone || '',\n    eleve_email: (student as any)?.email || '',\n    \n    // Format alternatif (etudiant_*) pour compatibilité\n    etudiant_nom: student?.last_name || '',\n    etudiant_prenom: student?.first_name || '',\n    etudiant_nom_complet: student\n      ? `${student.first_name} ${student.last_name}`\n      : '',\n    etudiant_numero: student?.student_number || '',\n    etudiant_date_naissance: student?.date_of_birth\n      ? new Date(student.date_of_birth).toLocaleDateString('fr-FR')\n      : '',\n    etudiant_adresse: (student as any)?.address || '',\n    etudiant_telephone: (student as any)?.phone || '',\n    etudiant_email: (student as any)?.email || '',\n    etudiant_photo: (student as any)?.photo_url || '',\n\n    // Classe\n    classe_nom: ((student as StudentWithRelations) as any)?.classes\n      ? (((student as StudentWithRelations) as any).classes as { name: string }).name\n      : '',\n\n    // Année académique\n    annee_academique: academicYear?.name || new Date().getFullYear().toString(),\n    annee_scolaire: academicYear?.name || new Date().getFullYear().toString(),\n\n    // Session/Formation\n    session_nom: session?.name || '',\n    session_debut: session?.start_date\n      ? new Date(session.start_date).toLocaleDateString('fr-FR')\n      : '',\n    session_fin: session?.end_date\n      ? new Date(session.end_date).toLocaleDateString('fr-FR')\n      : '',\n    session_date_debut: session?.start_date\n      ? new Date(session.start_date).toLocaleDateString('fr-FR')\n      : '',\n    session_date_fin: session?.end_date\n      ? new Date(session.end_date).toLocaleDateString('fr-FR')\n      : '',\n    formation_nom: (session as SessionWithRelations)?.formations?.name || '',\n    formation_duree: (session as SessionWithRelations)?.formations?.duration_hours\n      ? `${(session as SessionWithRelations).formations?.duration_hours} heures`\n      : '',\n    formation_objectifs: ((session as SessionWithRelations)?.formations as any)?.objectives || (program as any)?.objectives || '',\n    formation_public_concerne: ((session as SessionWithRelations)?.formations as any)?.target_audience || (program as any)?.target_audience || '',\n    formation_prerequis: ((session as SessionWithRelations)?.formations as any)?.prerequisites || (program as any)?.prerequisites || '',\n    formation_qualite_et_resultats: ((session as SessionWithRelations)?.formations as any)?.quality_indicators || (program as any)?.quality_indicators || '',\n    formation_contenu: ((session as SessionWithRelations)?.formations as any)?.content || (program as any)?.content || '',\n    formation_equipe_pedagogique: ((session as SessionWithRelations)?.formations as any)?.pedagogical_team || (program as any)?.pedagogical_team || '',\n    formation_ressources: ((session as SessionWithRelations)?.formations as any)?.resources || (program as any)?.resources || '',\n    formation_supports: ((session as SessionWithRelations)?.formations as any)?.materials || (program as any)?.materials || '',\n    session_lieu: (session as any)?.location || (session as any)?.venue || '',\n    session_effectif: (session as any)?.enrollment_count?.toString() || (session as any)?.student_count?.toString() || '',\n    diplome_ou_certification: ((session as SessionWithRelations)?.formations as any)?.certification || (program as any)?.certification || '',\n    ecole_region: (organization as any)?.region || (organization as any)?.administrative_region || '',\n    // Programme\n    programme_nom: program?.name || (session as SessionWithRelations)?.formations?.programs?.name || '',\n    programme_code: (program as any)?.code || '',\n    programme_description: (program as any)?.description || '',\n    programme_objectifs: (program as any)?.objectives || '',\n    programme_duree_totale: program?.formations\n      ? `${program.formations.reduce((total, f) => total + (f.duration_hours || 0), 0)} heures`\n      : '',\n    programme_nombre_formations: program?.formations ? `${program.formations.length}` : '',\n    programme_nombre_sessions: '', // À calculer si nécessaire\n    programme_public_concerne: (program as any)?.target_audience || '',\n    programme_modalites: (program as any)?.modalities || '',\n    programme_certification: (program as any)?.certification || '',\n\n    // Facture\n    numero_facture: invoice?.invoice_number || '',\n    facture_numero: invoice?.invoice_number || '',\n    facture_date_emission: invoice?.issue_date\n      ? new Date(invoice.issue_date).toLocaleDateString('fr-FR')\n      : '',\n    facture_date_echeance: invoice?.due_date\n      ? new Date(invoice.due_date).toLocaleDateString('fr-FR')\n      : '',\n    date_echeance: invoice?.due_date\n      ? new Date(invoice.due_date).toLocaleDateString('fr-FR')\n      : '',\n    montant: invoice?.amount ? Number(invoice.amount).toFixed(2) : '0.00',\n    montant_ht: invoice?.amount ? Number(invoice.amount).toFixed(2) : '0.00',\n    montant_ttc: invoice?.total_amount\n      ? Number(invoice.total_amount).toFixed(2)\n      : '0.00',\n    tva: invoice?.tax_amount\n      ? Number(invoice.tax_amount).toFixed(2)\n      : '0.00',\n    taux_tva: invoice?.tax_amount && invoice?.amount\n      ? ((Number(invoice.tax_amount) / Number(invoice.amount)) * 100).toFixed(2)\n      : '0.00',\n    facture_montant: invoice?.amount ? Number(invoice.amount).toFixed(2) : '0.00',\n    facture_tva: invoice?.tax_amount\n      ? Number(invoice.tax_amount).toFixed(2)\n      : '0.00',\n    facture_total: invoice?.total_amount\n      ? Number(invoice.total_amount).toFixed(2)\n      : '0.00',\n    facture_devise: invoice?.currency || 'EUR',\n    facture_items: invoice?.items\n      ? JSON.stringify(invoice.items)\n      : '[]',\n\n    // Variables supplémentaires pour factures\n    montant_lettres: invoice?.total_amount\n      ? convertNumberToWords(Number(invoice.total_amount), language)\n      : '',\n    mode_paiement: (invoice as any)?.payment_method || '',\n    date_paiement: (invoice as any)?.paid_at\n      ? new Date((invoice as any).paid_at).toLocaleDateString('fr-FR')\n      : '',\n    ecole_siret: (organization as any)?.siret || '',\n    ecole_numero_declaration: (organization as any)?.declaration_number || '',\n    ecole_representant: (organization as any)?.representative_name || '',\n\n    // Langue\n    langue: language,\n  }\n\n  return variables\n}\n\n/**\n * Convertit un nombre en lettres (français)\n */\nfunction convertNumberToWords(num: number, language: 'fr' | 'en' = 'fr'): string {\n  if (language === 'en') {\n    return convertNumberToWordsEN(num)\n  }\n  return convertNumberToWordsFR(num)\n}\n\n/**\n * Convertit un nombre en lettres en français\n */\nfunction convertNumberToWordsFR(num: number): string {\n  if (num === 0) return 'zéro euro'\n  if (num < 0) return 'moins ' + convertNumberToWordsFR(-num)\n  \n  const integerPart = Math.floor(num)\n  const decimalPart = Math.round((num - integerPart) * 100)\n  \n  let result = convertIntegerToWordsFR(integerPart)\n  \n  if (decimalPart > 0) {\n    result += ' virgule ' + convertIntegerToWordsFR(decimalPart)\n  }\n  \n  return result + (integerPart > 1 ? ' euros' : ' euro')\n}\n\nfunction convertIntegerToWordsFR(num: number): string {\n  if (num === 0) return ''\n  if (num < 10) {\n    const units = ['', 'un', 'deux', 'trois', 'quatre', 'cinq', 'six', 'sept', 'huit', 'neuf']\n    return units[num]\n  }\n  if (num < 20) {\n    const teens = ['dix', 'onze', 'douze', 'treize', 'quatorze', 'quinze', 'seize', 'dix-sept', 'dix-huit', 'dix-neuf']\n    return teens[num - 10]\n  }\n  if (num < 100) {\n    const tens = ['', '', 'vingt', 'trente', 'quarante', 'cinquante', 'soixante', 'soixante', 'quatre-vingt', 'quatre-vingt']\n    const ten = Math.floor(num / 10)\n    const unit = num % 10\n    let result = tens[ten]\n    if (ten === 7 || ten === 9) {\n      result += '-' + (unit === 1 ? 'et-' : '') + convertIntegerToWordsFR(10 + unit)\n    } else if (unit > 0) {\n      result += (unit === 1 && ten !== 8 ? '-et-' : '-') + convertIntegerToWordsFR(unit)\n    } else if (ten === 8) {\n      result += 's'\n    }\n    return result\n  }\n  if (num < 1000) {\n    const hundred = Math.floor(num / 100)\n    const remainder = num % 100\n    let result = hundred === 1 ? 'cent' : convertIntegerToWordsFR(hundred) + '-cent'\n    if (remainder > 0) {\n      result += '-' + convertIntegerToWordsFR(remainder)\n    } else if (hundred > 1) {\n      result += 's'\n    }\n    return result\n  }\n  if (num < 1000000) {\n    const thousand = Math.floor(num / 1000)\n    const remainder = num % 1000\n    let result = thousand === 1 ? 'mille' : convertIntegerToWordsFR(thousand) + '-mille'\n    if (remainder > 0) {\n      result += '-' + convertIntegerToWordsFR(remainder)\n    }\n    return result\n  }\n  // Pour les nombres plus grands, on simplifie\n  return num.toString()\n}\n\nfunction convertNumberToWordsEN(num: number): string {\n  // Implémentation simplifiée en anglais\n  return num.toFixed(2) + ' euros'\n}\n\n/**\n * Mappe les anciens types de documents vers les nouveaux types\n */\nexport function mapDocumentTypeToTemplateType(\n  oldType: string\n): string {\n  const mapping: Record<string, string> = {\n    // Mapping vers les valeurs valides de l'enum document_type\n    attestation: 'attestation_reussite', // Utilise attestation_reussite (peut être changé selon le contexte)\n    certificate: 'certificat_scolarite',\n    invoice: 'facture',\n    receipt: 'facture', // Les reçus utilisent le même type que les factures\n    transcript: 'releve_notes',\n    report_card: 'releve_notes',\n    convocation: 'convocation',\n    contract: 'contrat',\n  }\n\n  return mapping[oldType] || oldType\n}\n\n","'use client'\n\nimport { useState } from 'react'\nimport { useQuery } from '@tanstack/react-query'\nimport { documentTemplateService } from '@/lib/services/document-template.service'\nimport { useAuth } from '@/lib/hooks/use-auth'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Label } from '@/components/ui/label'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { FileText, Copy, Plus, Check } from 'lucide-react'\nimport type { DocumentType } from '@/lib/types/document-templates'\n\ninterface TemplateSelectorProps {\n  documentType: DocumentType | string\n  selectedTemplateId?: string\n  onTemplateSelect: (templateId: string) => void\n  onCreateNew?: () => void\n  onDuplicate?: (templateId: string) => void\n}\n\nexport function TemplateSelector({\n  documentType,\n  selectedTemplateId,\n  onTemplateSelect,\n  onCreateNew,\n  onDuplicate,\n}: TemplateSelectorProps) {\n  const { user } = useAuth()\n  const [showAll, setShowAll] = useState(false)\n\n  // Récupérer tous les templates du type sélectionné\n  const { data: templates, isLoading } = useQuery({\n    queryKey: ['document-templates-by-type', user?.organization_id, documentType],\n    queryFn: async () => {\n      if (!user?.organization_id || !documentType) return []\n      try {\n        return await documentTemplateService.getTemplatesByType(\n          documentType as DocumentType,\n          user.organization_id\n        )\n      } catch (error) {\n        console.error('Erreur lors de la récupération des templates:', error)\n        return []\n      }\n    },\n    enabled: !!user?.organization_id && !!documentType,\n  })\n\n  const activeTemplates = templates?.filter((t) => t.is_active) || []\n  const defaultTemplate = activeTemplates.find((t) => t.is_default)\n  const otherTemplates = activeTemplates.filter((t) => !t.is_default)\n\n  const displayedTemplates = showAll ? activeTemplates : [defaultTemplate, ...otherTemplates.slice(0, 2)].filter(Boolean)\n\n  if (isLoading) {\n    return (\n      <Card>\n        <CardContent className=\"pt-6\">\n          <div className=\"text-sm text-gray-500\">Chargement des modèles...</div>\n        </CardContent>\n      </Card>\n    )\n  }\n\n  if (!activeTemplates || activeTemplates.length === 0) {\n    return (\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-lg\">Modèle de document</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"text-sm text-gray-500 mb-4\">\n            Aucun modèle disponible pour ce type de document.\n          </div>\n          {onCreateNew && (\n            <Button onClick={onCreateNew} variant=\"outline\" size=\"sm\">\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Créer un modèle\n            </Button>\n          )}\n        </CardContent>\n      </Card>\n    )\n  }\n\n  return (\n    <Card>\n      <CardHeader>\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-lg\">Modèle de document</CardTitle>\n          {onCreateNew && (\n            <Button onClick={onCreateNew} variant=\"outline\" size=\"sm\">\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Nouveau\n            </Button>\n          )}\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div>\n          <Label htmlFor=\"template-select\">Sélectionner un modèle</Label>\n          <Select\n            value={selectedTemplateId || defaultTemplate?.id || ''}\n            onValueChange={onTemplateSelect}\n          >\n            <SelectTrigger id=\"template-select\" className=\"mt-2\">\n              <SelectValue placeholder=\"Choisir un modèle\" />\n            </SelectTrigger>\n            <SelectContent>\n              {activeTemplates.map((template) => (\n                <SelectItem key={template.id} value={template.id}>\n                  <div className=\"flex items-center justify-between w-full\">\n                    <div className=\"flex items-center gap-2\">\n                      <FileText className=\"h-4 w-4\" />\n                      <span>{template.name}</span>\n                      {template.is_default && (\n                        <span className=\"text-xs text-primary font-medium\">(Par défaut)</span>\n                      )}\n                    </div>\n                  </div>\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n\n        {/* Liste des templates avec actions */}\n        <div className=\"space-y-2\">\n          <div className=\"text-sm font-medium text-gray-700\">Modèles disponibles</div>\n          <div className=\"space-y-2 max-h-60 overflow-y-auto\">\n            {displayedTemplates.map((template) => (\n              <div\n                key={template.id}\n                className={`flex items-center justify-between p-3 border rounded-lg transition-colors ${\n                  selectedTemplateId === template.id\n                    ? 'border-primary bg-primary/5'\n                    : 'border-gray-200 hover:border-gray-300'\n                }`}\n              >\n                <div className=\"flex items-center gap-3 flex-1\">\n                  <FileText className=\"h-4 w-4 text-gray-400\" />\n                  <div className=\"flex-1 min-w-0\">\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"font-medium text-sm\">{template.name}</span>\n                      {template.is_default && (\n                        <span className=\"text-xs px-2 py-0.5 bg-primary/10 text-primary rounded-full\">\n                          Par défaut\n                        </span>\n                      )}\n                      {selectedTemplateId === template.id && (\n                        <Check className=\"h-4 w-4 text-primary\" />\n                      )}\n                    </div>\n                    <div className=\"text-xs text-gray-500 mt-0.5\">\n                      Modifié le {new Date(template.updated_at).toLocaleDateString('fr-FR')}\n                    </div>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  {selectedTemplateId !== template.id && (\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => onTemplateSelect(template.id)}\n                    >\n                      Sélectionner\n                    </Button>\n                  )}\n                  {onDuplicate && (\n                    <Button\n                      variant=\"ghost\"\n                      size=\"icon\"\n                      onClick={() => onDuplicate(template.id)}\n                      title=\"Dupliquer ce modèle\"\n                    >\n                      <Copy className=\"h-4 w-4\" />\n                    </Button>\n                  )}\n                </div>\n              </div>\n            ))}\n          </div>\n\n          {activeTemplates.length > displayedTemplates.length && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => setShowAll(!showAll)}\n              className=\"w-full\"\n            >\n              {showAll\n                ? `Afficher moins (${activeTemplates.length - 3} autres)`\n                : `Afficher tous les modèles (${activeTemplates.length - displayedTemplates.length} autres)`}\n            </Button>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\n","'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { useQuery } from '@tanstack/react-query'\nimport { useAuth } from '@/lib/hooks/use-auth'\nimport { createClient } from '@/lib/supabase/client'\nimport { documentService } from '@/lib/services/document.service'\nimport { generatePDFFromHTML } from '@/lib/utils/pdf-generator'\nimport { generateHTML } from '@/lib/utils/document-generation/html-generator'\nimport { extractDocumentVariables, mapDocumentTypeToTemplateType } from '@/lib/utils/document-generation/variable-extractor'\nimport { documentTemplateService } from '@/lib/services/document-template.service'\nimport { TemplateSelector } from '@/components/document-editor/template-selector'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { ArrowLeft, Download, FileText, Users, CheckCircle, XCircle } from 'lucide-react'\nimport Link from 'next/link'\nimport { useToast } from '@/components/ui/toast'\nimport type { StudentWithRelations, SessionWithRelations } from '@/lib/types/query-types'\nimport type { TableRow } from '@/lib/types/supabase-helpers'\nimport { createZipFromPDFs } from '@/lib/utils/pdf-generator'\n\ntype Organization = TableRow<'organizations'>\ntype Student = TableRow<'students'>\ntype Session = TableRow<'sessions'>\n\nexport default function GenerateBatchDocumentPage() {\n  const router = useRouter()\n  const { user } = useAuth()\n  const supabase = createClient()\n  const { addToast } = useToast()\n\n  const [documentType, setDocumentType] = useState<string>('attestation')\n  const [selectedSessionId, setSelectedSessionId] = useState<string>('')\n  const [selectedTemplateId, setSelectedTemplateId] = useState<string>('')\n  const [selectedStudentIds, setSelectedStudentIds] = useState<string[]>([])\n  const [language, setLanguage] = useState<'fr' | 'en'>('fr')\n  const [isGenerating, setIsGenerating] = useState(false)\n  const [generationProgress, setGenerationProgress] = useState<{\n    current: number\n    total: number\n    currentStudent?: string\n  } | null>(null)\n\n  // Récupérer l'organisation\n  const { data: organization } = useQuery({\n    queryKey: ['organization', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return null\n      const { data, error } = await supabase\n        .from('organizations')\n        .select('*')\n        .eq('id', user.organization_id)\n        .single()\n      if (error) throw error\n      return data\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  // Récupérer les sessions\n  const { data: sessions } = useQuery<Array<{ id: string; [key: string]: any }>>({\n    queryKey: ['sessions', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return []\n      const { data, error } = await supabase\n        .from('sessions')\n        .select('id, name, formation_id, formations(name, duration_hours, programs(name)), start_date, end_date, enrollments(*, students(*))')\n        .eq('formations.organization_id', user.organization_id)\n        .order('start_date', { ascending: false })\n        .limit(50)\n      if (error) throw error\n      return (data || []) as Array<{ id: string; [key: string]: any }>\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  // Récupérer les étudiants de la session sélectionnée\n  const selectedSession = sessions?.find((s) => s.id === selectedSessionId) as { id: string; enrollments?: Array<{ students?: any }>; [key: string]: any } | undefined\n  const sessionStudents = selectedSession?.enrollments\n    ?.map((enrollment: any) => enrollment.students)\n    .filter((student: any) => student && student.status === 'active') || []\n\n  // Récupérer l'année académique actuelle\n  const { data: academicYear } = useQuery({\n    queryKey: ['academic-year', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return null\n      const { data, error } = await supabase\n        .from('academic_years')\n        .select('*')\n        .eq('organization_id', user.organization_id)\n        .eq('is_current', true)\n        .maybeSingle()\n      if (error) {\n        console.warn('Erreur lors de la récupération de l\\'année académique:', error)\n        return null\n      }\n      return data || null\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  // Récupérer le template sélectionné\n  const { data: selectedTemplate } = useQuery({\n    queryKey: ['document-template', selectedTemplateId],\n    queryFn: async () => {\n      if (!selectedTemplateId) return null\n      return documentTemplateService.getTemplateById(selectedTemplateId)\n    },\n    enabled: !!selectedTemplateId,\n  })\n\n  const handleGenerateBatch = async () => {\n    if (!documentType || !organization || !selectedTemplate || !selectedSessionId) {\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: 'Veuillez sélectionner un type de document, un modèle, et une session.',\n      })\n      return\n    }\n\n    const studentsToProcess = selectedStudentIds.length > 0\n      ? sessionStudents.filter((s: any) => selectedStudentIds.includes(s.id))\n      : sessionStudents\n\n    if (studentsToProcess.length === 0) {\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: 'Aucun étudiant sélectionné pour la génération.',\n      })\n      return\n    }\n\n    setIsGenerating(true)\n    setGenerationProgress({ current: 0, total: studentsToProcess.length })\n\n    const pdfBlobs: { blob: Blob; filename: string }[] = []\n    const session = selectedSession as SessionWithRelations\n\n    try {\n      for (let i = 0; i < studentsToProcess.length; i++) {\n        const student = studentsToProcess[i] as StudentWithRelations\n        setGenerationProgress({\n          current: i + 1,\n          total: studentsToProcess.length,\n          currentStudent: `${student.first_name} ${student.last_name}`,\n        })\n\n        try {\n          // Extraire les variables\n          const variables = extractDocumentVariables({\n            student,\n            organization: organization as Organization,\n            session,\n            invoice: undefined,\n            academicYear,\n            language,\n            issueDate: new Date().toISOString(),\n          })\n\n          // Générer le HTML avec le template\n          const result = await generateHTML(\n            selectedTemplate,\n            variables,\n            undefined,\n            user?.organization_id || ''\n          )\n\n          // Générer le nom de fichier\n          const filename = `${documentType}_${student.last_name}_${student.first_name}.pdf`\n\n          // Créer un élément temporaire pour la génération PDF\n          const tempDiv = document.createElement('div')\n          tempDiv.style.position = 'absolute'\n          tempDiv.style.left = '-9999px'\n          tempDiv.style.top = '0'\n          tempDiv.style.width = '794px'\n          tempDiv.style.minHeight = '1123px'\n          tempDiv.style.backgroundColor = '#ffffff'\n          tempDiv.style.overflow = 'visible'\n          tempDiv.style.fontFamily = 'Arial, sans-serif'\n          document.body.appendChild(tempDiv)\n\n          // Extraire le contenu du body\n          const parser = new DOMParser()\n          const doc = parser.parseFromString(result.html, 'text/html')\n          const bodyContent = doc.body.innerHTML\n          tempDiv.innerHTML = bodyContent\n\n          // Trouver l'élément principal du document\n          let element = tempDiv.querySelector('.document-container') || tempDiv.querySelector('[id$=\"-document\"]') || tempDiv.firstElementChild\n\n          if (!element || !(element instanceof HTMLElement)) {\n            element = tempDiv\n          }\n\n          const elementId = `temp-pdf-batch-${student.id}-${Date.now()}`\n          if (element instanceof HTMLElement) {\n            element.id = elementId\n            if (!element.style.width) {\n              element.style.width = '794px'\n            }\n            if (!element.style.minHeight) {\n              element.style.minHeight = '1123px'\n            }\n            element.style.backgroundColor = '#ffffff'\n          }\n\n          // Attendre que le DOM soit mis à jour\n          await new Promise((resolve) => setTimeout(resolve, 500))\n\n          // Vérifier que l'élément est visible\n          if (element instanceof HTMLElement) {\n            const rect = element.getBoundingClientRect()\n            if (rect.width === 0 || rect.height === 0) {\n              element = tempDiv\n              tempDiv.id = elementId\n              tempDiv.style.width = '794px'\n              tempDiv.style.minHeight = '1123px'\n            }\n          }\n\n          // Générer le PDF\n          const blob = await generatePDFFromHTML(elementId, filename)\n          pdfBlobs.push({ blob, filename })\n\n          // Nettoyer l'élément temporaire\n          if (tempDiv.parentNode === document.body) {\n            document.body.removeChild(tempDiv)\n          }\n        } catch (error) {\n          console.error(`Erreur lors de la génération pour ${student.first_name} ${student.last_name}:`, error)\n          // Continuer avec les autres étudiants même en cas d'erreur\n        }\n      }\n\n      // Créer un ZIP avec tous les PDFs\n      if (pdfBlobs.length > 0) {\n        const zipFilename = `documents_${documentType}_${selectedSession?.name || 'batch'}_${Date.now()}.zip`\n        await createZipFromPDFs(\n          pdfBlobs.map((item) => ({ name: item.filename, blob: item.blob })),\n          zipFilename\n        )\n\n        addToast({\n          type: 'success',\n          title: 'Génération terminée',\n          description: `${pdfBlobs.length} document(s) généré(s) avec succès.`,\n        })\n      } else {\n        addToast({\n          type: 'error',\n          title: 'Erreur',\n          description: 'Aucun document n\\'a pu être généré.',\n        })\n      }\n    } catch (error) {\n      console.error('Erreur lors de la génération en masse:', error)\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: 'Une erreur est survenue lors de la génération en masse.',\n      })\n    } finally {\n      setIsGenerating(false)\n      setGenerationProgress(null)\n      // Nettoyer tous les éléments temporaires\n      const tempDivs = document.querySelectorAll('[id^=\"temp-pdf-batch-\"]')\n      tempDivs.forEach((div) => {\n        if (div.parentNode === document.body) {\n          document.body.removeChild(div)\n        }\n      })\n    }\n  }\n\n  const documentTypes = [\n    { value: 'attestation', label: 'Attestation de scolarité', icon: FileText },\n    { value: 'certificate', label: 'Certificat de formation', icon: FileText },\n  ]\n\n  const toggleStudentSelection = (studentId: string) => {\n    setSelectedStudentIds((prev) =>\n      prev.includes(studentId)\n        ? prev.filter((id) => id !== studentId)\n        : [...prev, studentId]\n    )\n  }\n\n  const selectAllStudents = () => {\n    setSelectedStudentIds(sessionStudents.map((s: any) => s.id))\n  }\n\n  const deselectAllStudents = () => {\n    setSelectedStudentIds([])\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center space-x-4\">\n        <Link href=\"/dashboard/documents\">\n          <Button variant=\"ghost\" size=\"icon\">\n            <ArrowLeft className=\"h-4 w-4\" />\n          </Button>\n        </Link>\n        <div>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Génération en masse</h1>\n          <p className=\"mt-2 text-sm text-gray-600\">\n            Générez plusieurs documents à la fois pour une session\n          </p>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Formulaire */}\n        <div className=\"lg:col-span-2 space-y-6\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Type de document</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-2 gap-4\">\n                {documentTypes.map((type) => {\n                  const Icon = type.icon\n                  return (\n                    <button\n                      key={type.value}\n                      type=\"button\"\n                      onClick={() => setDocumentType(type.value)}\n                      className={`p-4 border-2 rounded-lg text-left transition-colors ${\n                        documentType === type.value\n                          ? 'border-primary bg-primary/5'\n                          : 'border-gray-200 hover:border-gray-300'\n                      }`}\n                    >\n                      <Icon className=\"h-6 w-6 mb-2 text-primary\" />\n                      <div className=\"font-medium\">{type.label}</div>\n                    </button>\n                  )\n                })}\n              </div>\n            </CardContent>\n          </Card>\n\n          {documentType && (\n            <>\n              {/* Sélecteur de template */}\n              <TemplateSelector\n                documentType={mapDocumentTypeToTemplateType(documentType)}\n                selectedTemplateId={selectedTemplateId}\n                onTemplateSelect={setSelectedTemplateId}\n                onCreateNew={() => {\n                  router.push(`/dashboard/settings/document-templates/${mapDocumentTypeToTemplateType(documentType)}/edit`)\n                }}\n                onDuplicate={async (templateId) => {\n                  try {\n                    const duplicated = await documentTemplateService.duplicateTemplate(templateId)\n                    setSelectedTemplateId(duplicated.id)\n                    addToast({\n                      type: 'success',\n                      title: 'Modèle dupliqué',\n                      description: 'Le modèle a été dupliqué avec succès.',\n                    })\n                  } catch (error) {\n                    console.error('Erreur lors de la duplication:', error)\n                    addToast({\n                      type: 'error',\n                      title: 'Erreur',\n                      description: 'Erreur lors de la duplication du modèle.',\n                    })\n                  }\n                }}\n              />\n\n              {/* Sélection de session */}\n              <Card>\n                <CardHeader>\n                  <CardTitle>Session de formation</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <select\n                    value={selectedSessionId}\n                    onChange={(e) => {\n                      setSelectedSessionId(e.target.value)\n                      setSelectedStudentIds([])\n                    }}\n                    className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target\"\n                    required\n                  >\n                    <option value=\"\">Sélectionner une session</option>\n                    {sessions?.map((session) => (\n                      <option key={session.id} value={session.id}>\n                        {(session as SessionWithRelations).name} - {(session as SessionWithRelations).formations?.programs?.name}\n                      </option>\n                    ))}\n                  </select>\n                </CardContent>\n              </Card>\n\n              {/* Sélection des étudiants */}\n              {selectedSessionId && sessionStudents.length > 0 && (\n                <Card>\n                  <CardHeader>\n                    <div className=\"flex items-center justify-between\">\n                      <CardTitle>Étudiants ({sessionStudents.length})</CardTitle>\n                      <div className=\"flex gap-2\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={selectAllStudents}\n                        >\n                          Tout sélectionner\n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={deselectAllStudents}\n                        >\n                          Tout désélectionner\n                        </Button>\n                      </div>\n                    </div>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-2 max-h-64 overflow-y-auto\">\n                      {sessionStudents.map((student: any) => (\n                        <label\n                          key={student.id}\n                          className=\"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50 cursor-pointer\"\n                        >\n                          <input\n                            type=\"checkbox\"\n                            checked={selectedStudentIds.includes(student.id)}\n                            onChange={() => toggleStudentSelection(student.id)}\n                            className=\"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary\"\n                          />\n                          <div className=\"flex-1\">\n                            <p className=\"font-medium\">\n                              {student.first_name} {student.last_name}\n                            </p>\n                            {student.student_number && (\n                              <p className=\"text-sm text-gray-500\">\n                                N° {student.student_number}\n                              </p>\n                            )}\n                          </div>\n                        </label>\n                      ))}\n                    </div>\n                    <p className=\"text-sm text-gray-500 mt-4\">\n                      {selectedStudentIds.length > 0\n                        ? `${selectedStudentIds.length} étudiant(s) sélectionné(s)`\n                        : 'Aucun étudiant sélectionné (tous seront générés)'}\n                    </p>\n                  </CardContent>\n                </Card>\n              )}\n\n              <Card>\n                <CardHeader>\n                  <CardTitle>Options</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">Langue</label>\n                    <select\n                      value={language}\n                      onChange={(e) => setLanguage(e.target.value as 'fr' | 'en')}\n                      className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target\"\n                    >\n                      <option value=\"fr\">Français</option>\n                      <option value=\"en\">English</option>\n                    </select>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <div className=\"flex justify-end space-x-4\">\n                <Link href=\"/dashboard/documents\">\n                  <Button variant=\"outline\">Annuler</Button>\n                </Link>\n                <Button\n                  onClick={handleGenerateBatch}\n                  disabled={\n                    isGenerating ||\n                    !selectedTemplateId ||\n                    !selectedSessionId ||\n                    sessionStudents.length === 0\n                  }\n                >\n                  <Download className=\"mr-2 h-4 w-4\" />\n                  {isGenerating ? 'Génération...' : 'Générer en masse'}\n                </Button>\n              </div>\n            </>\n          )}\n        </div>\n\n        {/* Informations */}\n        <div className=\"lg:col-span-1\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Informations</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              {generationProgress && (\n                <div className=\"bg-blue-50 p-4 rounded-lg\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <span className=\"text-sm font-medium\">Progression</span>\n                    <span className=\"text-sm text-gray-600\">\n                      {generationProgress.current} / {generationProgress.total}\n                    </span>\n                  </div>\n                  <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                    <div\n                      className=\"bg-primary h-2 rounded-full transition-all\"\n                      style={{\n                        width: `${(generationProgress.current / generationProgress.total) * 100}%`,\n                      }}\n                    />\n                  </div>\n                  {generationProgress.currentStudent && (\n                    <p className=\"text-sm text-gray-600 mt-2\">\n                      En cours: {generationProgress.currentStudent}\n                    </p>\n                  )}\n                </div>\n              )}\n\n              <div className=\"space-y-2\">\n                <div className=\"flex items-center space-x-2\">\n                  <Users className=\"h-4 w-4 text-gray-400\" />\n                  <span className=\"text-sm text-gray-600\">\n                    {sessionStudents.length} étudiant(s) dans la session\n                  </span>\n                </div>\n                {selectedStudentIds.length > 0 && (\n                  <div className=\"flex items-center space-x-2\">\n                    <CheckCircle className=\"h-4 w-4 text-success-primary\" />\n                    <span className=\"text-sm text-gray-600\">\n                      {selectedStudentIds.length} étudiant(s) sélectionné(s)\n                    </span>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"pt-4 border-t\">\n                <p className=\"text-xs text-gray-500\">\n                  Les documents générés seront regroupés dans un fichier ZIP.\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","ignoreList":[0,1,2,4]}