{"version":3,"sources":["../../../../lib/utils/logger.ts","../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts","../../../../lib/utils/document-generation/signature-processor.ts","../../../../.next-internal/server/app/%28dashboard%29/dashboard/sessions/%5Bid%5D/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["/**\n * Logger centralis√© pour l'application Eduzen\n * \n * Fournit une interface unifi√©e pour le logging avec :\n * - Niveaux de log (error, warn, info, debug)\n * - Support pour services externes (Sentry, LogRocket)\n * - Formatage coh√©rent\n * - Mode d√©veloppement vs production\n */\n\ntype LogLevel = 'error' | 'warn' | 'info' | 'debug'\n\ninterface LogContext {\n  userId?: string\n  organizationId?: string\n  sessionId?: string\n  [key: string]: unknown\n}\n\nclass Logger {\n  private isDevelopment = process.env.NODE_ENV === 'development'\n  private isProduction = process.env.NODE_ENV === 'production'\n  private sentryEnabled = !!process.env.NEXT_PUBLIC_SENTRY_DSN\n\n  /**\n   * Initialise Sentry si disponible\n   */\n  private initSentry() {\n    if (this.sentryEnabled && typeof window !== 'undefined') {\n      // Lazy load Sentry pour √©viter d'augmenter la taille du bundle\n      import('@sentry/nextjs').then((Sentry) => {\n        try {\n          // V√©rifier si Sentry est d√©j√† initialis√© en essayant d'acc√©der au client\n          // Si ce n'est pas le cas, l'initialiser\n          Sentry.init({\n            dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,\n            environment: process.env.NODE_ENV,\n            tracesSampleRate: 0.1, // 10% des transactions\n            beforeSend(event) {\n              // Filtrer les erreurs sensibles\n              if (event.request?.headers) {\n                delete event.request.headers['authorization']\n                delete event.request.headers['cookie']\n              }\n              return event\n            },\n          })\n        } catch (e) {\n          // Sentry d√©j√† initialis√© ou erreur, continuer sans\n        }\n      }).catch(() => {\n        // Sentry non disponible, continuer sans\n      })\n    }\n  }\n\n  constructor() {\n    if (this.sentryEnabled) {\n      this.initSentry()\n    }\n  }\n\n  /**\n   * Log une erreur avec contexte optionnel\n   */\n  error(message: string, error?: Error | unknown, context?: LogContext) {\n    const logData = {\n      message,\n      error: error instanceof Error ? {\n        name: error.name,\n        message: error.message,\n        stack: error.stack,\n      } : error,\n      context,\n      timestamp: new Date().toISOString(),\n      level: 'error' as LogLevel,\n    }\n\n    // En production, envoyer vers Sentry si disponible\n    if (this.isProduction && this.sentryEnabled && typeof window !== 'undefined') {\n      import('@sentry/nextjs').then((Sentry) => {\n        if (error instanceof Error) {\n          Sentry.captureException(error, {\n            extra: {\n              message,\n              context,\n            },\n            tags: {\n              source: 'logger',\n            },\n          })\n        } else {\n          Sentry.captureMessage(message, {\n            level: 'error',\n            extra: {\n              error,\n              context,\n            },\n          })\n        }\n      }).catch(() => {\n        // Sentry non disponible, continuer sans\n      })\n    }\n\n    // Envoyer une alerte pour les erreurs critiques (en production uniquement)\n    if (this.isProduction && message.includes('[CRITICAL]')) {\n      // Import dynamique pour √©viter les d√©pendances circulaires\n      import('@/lib/services/alert.service').then(({ alertService }) => {\n        const errorObj = error instanceof Error ? error : new Error(message)\n        alertService.sendCriticalError(errorObj, {\n          context,\n          timestamp: logData.timestamp,\n        }).catch((err) => {\n          // Ne pas logger l'erreur d'alerte pour √©viter les boucles infinies\n          if (this.isDevelopment) {\n            console.error('Failed to send critical alert:', err)\n          }\n        })\n      }).catch(() => {\n        // Service d'alertes non disponible, continuer sans\n      })\n    }\n\n    // Toujours logger en console pour le d√©veloppement\n    if (this.isDevelopment || !this.isProduction) {\n      console.error('‚ùå [ERROR]', message, {\n        error,\n        context,\n        timestamp: logData.timestamp,\n      })\n    }\n  }\n\n  /**\n   * Log un avertissement\n   */\n  warn(message: string, context?: LogContext) {\n    const logData = {\n      message,\n      context,\n      timestamp: new Date().toISOString(),\n      level: 'warn' as LogLevel,\n    }\n\n    if (this.isDevelopment) {\n      console.warn('‚ö†Ô∏è [WARN]', message, { context, timestamp: logData.timestamp })\n    }\n  }\n\n  /**\n   * Log une information\n   */\n  info(message: string, context?: LogContext) {\n    const logData = {\n      message,\n      context,\n      timestamp: new Date().toISOString(),\n      level: 'info' as LogLevel,\n    }\n\n    if (this.isDevelopment) {\n      console.info('‚ÑπÔ∏è [INFO]', message, { context, timestamp: logData.timestamp })\n    }\n  }\n\n  /**\n   * Log pour le d√©bogage (uniquement en d√©veloppement)\n   */\n  debug(message: string, context?: LogContext) {\n    if (!this.isDevelopment) return\n\n    console.debug('üêõ [DEBUG]', message, {\n      context,\n      timestamp: new Date().toISOString(),\n    })\n  }\n\n  /**\n   * Helper pour logger les erreurs de requ√™te API\n   */\n  apiError(endpoint: string, error: Error | unknown, context?: LogContext) {\n    this.error(`API Error: ${endpoint}`, error, {\n      ...context,\n      endpoint,\n    })\n  }\n\n  /**\n   * Helper pour logger les erreurs de mutation\n   */\n  mutationError(mutationName: string, error: Error | unknown, context?: LogContext) {\n    this.error(`Mutation Error: ${mutationName}`, error, {\n      ...context,\n      mutationName,\n    })\n  }\n\n  /**\n   * Helper pour logger les erreurs de query\n   */\n  queryError(queryKey: string, error: Error | unknown, context?: LogContext) {\n    this.error(`Query Error: ${queryKey}`, error, {\n      ...context,\n      queryKey,\n    })\n  }\n}\n\n// Export d'une instance singleton\nexport const logger = new Logger()\n\n// Export du type pour utilisation dans d'autres fichiers\nexport type { LogContext, LogLevel }\n\n/**\n * Utilitaires pour sanitiser les donn√©es sensibles dans les logs\n */\n\n/**\n * Masque un email (garde 2 premiers caract√®res + domaine)\n */\nexport function maskEmail(email: string | null | undefined): string {\n  if (!email) return '[NO_EMAIL]'\n  const [local, domain] = email.split('@')\n  if (!domain) return '[INVALID_EMAIL]'\n  return `${local.substring(0, 2)}***@${domain}`\n}\n\n/**\n * Masque un ID (garde 8 premiers caract√®res)\n */\nexport function maskId(id: string | null | undefined): string {\n  if (!id) return '[NO_ID]'\n  return id.substring(0, 8) + '...'\n}\n\n/**\n * Masque un token (retourne juste un indicateur)\n */\nexport function maskToken(token: string | null | undefined): string {\n  if (!token) return '[NO_TOKEN]'\n  return '[REDACTED]'\n}\n\n/**\n * Masque un num√©ro de t√©l√©phone (garde 4 derniers chiffres)\n */\nexport function maskPhone(phone: string | null | undefined): string {\n  if (!phone) return '[NO_PHONE]'\n  if (phone.length < 4) return '***'\n  return '***' + phone.slice(-4)\n}\n\n/**\n * Sanitise un objet erreur pour √©viter d'exposer des informations sensibles\n */\nexport function sanitizeError(error: any): Record<string, any> {\n  if (!error) return {}\n\n  return {\n    message: error.message,\n    code: error.code,\n    name: error.name,\n    // Ne pas inclure stack traces en production\n    ...(process.env.NODE_ENV === 'development' ? { stack: error.stack } : {}),\n  }\n}\n\n/**\n * Sanitise un objet utilisateur pour les logs\n */\nexport function sanitizeUser(user: any): Record<string, any> {\n  if (!user) return {}\n\n  return {\n    id: maskId(user.id),\n    email: maskEmail(user.email),\n    role: user.role,\n    organizationId: maskId(user.organization_id),\n  }\n}\n\n/**\n * Sanitise un objet √©tudiant pour les logs\n */\nexport function sanitizeStudent(student: any): Record<string, any> {\n  if (!student) return {}\n\n  return {\n    id: maskId(student.id),\n    email: maskEmail(student.email),\n    firstName: student.first_name ? student.first_name.charAt(0) + '***' : '[NO_NAME]',\n    lastName: student.last_name ? student.last_name.charAt(0) + '***' : '[NO_NAME]',\n  }\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n","/**\n * Traitement des signatures dans les templates\n * \n * Ce fichier doit √™tre utilis√© uniquement c√¥t√© serveur (API routes)\n */\n\n'use server'\n\nimport { logger } from '@/lib/utils/logger'\n\n// Import conditionnel pour √©viter les erreurs c√¥t√© serveur\n// Le signatureService utilise createClient() c√¥t√© client, donc on l'importe dynamiquement\nlet signatureService: any = null\nasync function getSignatureService() {\n  if (typeof window !== 'undefined') {\n    // C√¥t√© client\n    if (!signatureService) {\n      const module = await import('@/lib/services/signature.service')\n      signatureService = module.signatureService\n    }\n    return signatureService\n  } else {\n    // C√¥t√© serveur - utiliser le client serveur directement\n    // Import dynamique pour √©viter que Next.js bundler essaie de bundler next/headers c√¥t√© client\n    try {\n      const { createClient } = await import('@/lib/supabase/server')\n      const supabase = await createClient()\n      return {\n        getSignaturesByDocument: async (documentId: string) => {\n          const { data, error } = await supabase\n            .from('document_signatures')\n            .select(`\n              *,\n              signer:users!document_signatures_signer_id_fkey(id, full_name, email, role)\n            `)\n            .eq('document_id', documentId)\n            .eq('status', 'signed')\n            .order('signed_at', { ascending: true })\n          if (error) throw error\n          return data || []\n        },\n      }\n    } catch (error) {\n      // Si l'import √©choue (par exemple c√¥t√© client), retourner un service vide\n      console.warn('Impossible d\\'importer createClient c√¥t√© serveur:', error)\n      return {\n        getSignaturesByDocument: async () => [],\n      }\n    }\n  }\n}\n\n/**\n * Interface pour une zone de signature dans un document\n */\nexport interface SignatureField {\n  id: string\n  type: 'signature' | 'initials' | 'date' | 'text'\n  label?: string\n  required?: boolean\n  signerRole?: string\n  signerEmail?: string\n  width?: number\n  height?: number\n  page?: number\n}\n\n/**\n * Traite les zones de signature dans le contenu HTML\n * Recherche les balises <signature-field> et les remplace par:\n * - Les signatures r√©elles si disponibles (documentId fourni)\n * - Des zones vides √† remplir si pas encore sign√©es\n *\n * Format support√©:\n * <signature-field\n *   id=\"unique-id\"\n *   type=\"signature|initials|date|text\"\n *   label=\"Signature du formateur\"\n *   required=\"true|false\"\n *   signer-role=\"trainer|student|admin\"\n *   signer-email=\"email@example.com\"\n *   width=\"200\"\n *   height=\"80\"\n *   page=\"1\"\n * />\n */\nexport async function processSignatures(\n  html: string,\n  variables: Record<string, any> = {},\n  documentId?: string\n): Promise<string> {\n  try {\n    // Regex pour trouver toutes les balises signature-field\n    const signatureFieldRegex = /<signature-field\\s+([^>]*?)\\/>/gi\n\n    // Extraire toutes les balises\n    const matches = Array.from(html.matchAll(signatureFieldRegex))\n\n    if (matches.length === 0) {\n      return html\n    }\n\n    // Charger les signatures existantes si documentId est fourni\n    let existingSignatures: any[] = []\n    if (documentId) {\n      try {\n        const service = await getSignatureService()\n        existingSignatures = await service.getSignaturesByDocument(documentId)\n      } catch (error) {\n        logger.warn('Erreur lors du chargement des signatures', {\n          documentId,\n          error: error instanceof Error ? error.message : String(error),\n        })\n      }\n    }\n\n    // Traiter chaque balise\n    let processedHtml = html\n    for (const match of matches) {\n      const fullTag = match[0]\n      const attributes = match[1]\n\n      // Parser les attributs\n      const field = parseSignatureFieldAttributes(attributes)\n\n      // Chercher une signature correspondante\n      const existingSignature = existingSignatures.find(sig => {\n        // Correspondance par r√¥le ou email\n        if (field.signerRole && sig.signer_role === field.signerRole) return true\n        if (field.signerEmail && sig.signer_email === field.signerEmail) return true\n        return false\n      })\n\n      // G√©n√©rer le HTML de remplacement\n      const replacementHtml = existingSignature\n        ? generateSignedFieldHtml(existingSignature, field)\n        : generateEmptyFieldHtml(field, variables)\n\n      processedHtml = processedHtml.replace(fullTag, replacementHtml)\n    }\n\n    return processedHtml\n  } catch (error) {\n    logger.error('Erreur lors du traitement des signatures', error instanceof Error ? error : new Error(String(error)), {\n      documentId,\n    })\n    // En cas d'erreur, retourner le HTML original\n    return html\n  }\n}\n\n/**\n * Parse les attributs d'une balise signature-field\n */\nfunction parseSignatureFieldAttributes(attributesString: string): SignatureField {\n  const attrs: Record<string, string> = {}\n\n  // Regex pour extraire les attributs\n  const attrRegex = /(\\w+(?:-\\w+)*)=\"([^\"]*?)\"|(\\w+(?:-\\w+)*)='([^']*?)'|(\\w+(?:-\\w+)*)=(\\S+)/g\n\n  let attrMatch\n  while ((attrMatch = attrRegex.exec(attributesString)) !== null) {\n    const key = attrMatch[1] || attrMatch[3] || attrMatch[5]\n    const value = attrMatch[2] || attrMatch[4] || attrMatch[6]\n    if (key && value) {\n      attrs[key] = value\n    }\n  }\n\n  return {\n    id: attrs.id || `signature-${Date.now()}`,\n    type: (attrs.type as any) || 'signature',\n    label: attrs.label,\n    required: attrs.required === 'true',\n    signerRole: attrs['signer-role'],\n    signerEmail: attrs['signer-email'],\n    width: attrs.width ? parseInt(attrs.width) : 200,\n    height: attrs.height ? parseInt(attrs.height) : 80,\n    page: attrs.page ? parseInt(attrs.page) : 1,\n  }\n}\n\n/**\n * G√©n√®re le HTML pour une zone de signature remplie\n */\nfunction generateSignedFieldHtml(signature: any, field: SignatureField): string {\n  const width = field.width || 200\n  const height = field.height || 80\n\n  if (field.type === 'date') {\n    const signedDate = signature.signed_at\n      ? new Date(signature.signed_at).toLocaleDateString('fr-FR', {\n          year: 'numeric',\n          month: 'long',\n          day: 'numeric',\n        })\n      : ''\n    return `\n      <div class=\"signature-field signed\" style=\"display: inline-block; margin: 10px 0;\">\n        ${field.label ? `<p style=\"font-size: 10pt; color: #666; margin: 0 0 5px 0;\">${field.label}</p>` : ''}\n        <div style=\"border: 1px solid #10b981; border-radius: 4px; padding: 8px 12px; background-color: #f0fdf4; display: inline-block;\">\n          <p style=\"margin: 0; font-size: 11pt; color: #047857; font-weight: 500;\">${signedDate}</p>\n        </div>\n      </div>\n    `\n  }\n\n  if (field.type === 'text' && signature.comment) {\n    return `\n      <div class=\"signature-field signed\" style=\"display: inline-block; margin: 10px 0;\">\n        ${field.label ? `<p style=\"font-size: 10pt; color: #666; margin: 0 0 5px 0;\">${field.label}</p>` : ''}\n        <div style=\"border: 1px solid #10b981; border-radius: 4px; padding: 8px 12px; background-color: #f0fdf4; display: inline-block; min-width: ${width}px;\">\n          <p style=\"margin: 0; font-size: 11pt; color: #047857;\">${signature.comment}</p>\n        </div>\n      </div>\n    `\n  }\n\n  // Pour signature et initials, afficher l'image\n  return `\n    <div class=\"signature-field signed\" style=\"display: inline-block; margin: 10px 0;\">\n      ${field.label ? `<p style=\"font-size: 10pt; color: #666; margin: 0 0 5px 0;\">${field.label}</p>` : ''}\n      <div style=\"border: 1px solid #10b981; border-radius: 4px; padding: 8px; background-color: #f0fdf4; display: inline-block;\">\n        <img\n          src=\"${signature.signature_data}\"\n          alt=\"Signature de ${signature.signer_name || 'utilisateur'}\"\n          style=\"max-width: ${width}px; max-height: ${height}px; display: block;\"\n        />\n        <p style=\"margin: 8px 0 0 0; font-size: 9pt; color: #047857; text-align: center;\">\n          Sign√© par ${signature.signer_name || 'utilisateur'} le ${new Date(signature.signed_at).toLocaleDateString('fr-FR')}\n        </p>\n      </div>\n    </div>\n  `\n}\n\n/**\n * G√©n√®re le HTML pour une zone de signature vide\n */\nfunction generateEmptyFieldHtml(field: SignatureField, variables: Record<string, any>): string {\n  const width = field.width || 200\n  const height = field.height || 80\n\n  // V√©rifier si une variable contient d√©j√† la signature\n  const variableKey = field.id.replace(/-/g, '_')\n  const signatureFromVariable = variables[variableKey] || variables[`signature_${variableKey}`]\n\n  if (signatureFromVariable && typeof signatureFromVariable === 'string') {\n    // Si la variable contient une image en base64 ou une URL\n    if (signatureFromVariable.startsWith('data:image') || signatureFromVariable.startsWith('http')) {\n      return `\n        <div class=\"signature-field filled-from-variable\" style=\"display: inline-block; margin: 10px 0;\">\n          ${field.label ? `<p style=\"font-size: 10pt; color: #666; margin: 0 0 5px 0;\">${field.label}</p>` : ''}\n          <div style=\"border: 1px solid #3b82f6; border-radius: 4px; padding: 8px; background-color: #eff6ff; display: inline-block;\">\n            <img\n              src=\"${signatureFromVariable}\"\n              alt=\"${field.label || 'Signature'}\"\n              style=\"max-width: ${width}px; max-height: ${height}px; display: block;\"\n            />\n          </div>\n        </div>\n      `\n    }\n    // Sinon, afficher comme texte\n    return `\n      <div class=\"signature-field filled-from-variable\" style=\"display: inline-block; margin: 10px 0;\">\n        ${field.label ? `<p style=\"font-size: 10pt; color: #666; margin: 0 0 5px 0;\">${field.label}</p>` : ''}\n        <div style=\"border: 1px solid #3b82f6; border-radius: 4px; padding: 8px 12px; background-color: #eff6ff; display: inline-block; min-width: ${width}px;\">\n          <p style=\"margin: 0; font-size: 11pt; color: #1e40af;\">${signatureFromVariable}</p>\n        </div>\n      </div>\n    `\n  }\n\n  // Zone vide √† remplir\n  if (field.type === 'date') {\n    return `\n      <div class=\"signature-field empty\" style=\"display: inline-block; margin: 10px 0;\">\n        ${field.label ? `<p style=\"font-size: 10pt; color: #666; margin: 0 0 5px 0;\">${field.label}${field.required ? ' <span style=\"color: #ef4444;\">*</span>' : ''}</p>` : ''}\n        <div style=\"border: 2px dashed #d1d5db; border-radius: 4px; padding: 8px 12px; background-color: #f9fafb; display: inline-block; min-width: 150px;\">\n          <p style=\"margin: 0; font-size: 10pt; color: #9ca3af; text-align: center;\">Date √† remplir</p>\n        </div>\n      </div>\n    `\n  }\n\n  if (field.type === 'text') {\n    return `\n      <div class=\"signature-field empty\" style=\"display: inline-block; margin: 10px 0; width: 100%; max-width: 400px;\">\n        ${field.label ? `<p style=\"font-size: 10pt; color: #666; margin: 0 0 5px 0;\">${field.label}${field.required ? ' <span style=\"color: #ef4444;\">*</span>' : ''}</p>` : ''}\n        <div style=\"border: 2px dashed #d1d5db; border-radius: 4px; padding: 12px; background-color: #f9fafb; min-height: 60px;\">\n          <p style=\"margin: 0; font-size: 10pt; color: #9ca3af;\">Texte √† remplir</p>\n        </div>\n      </div>\n    `\n  }\n\n  // Signature ou initials\n  return `\n    <div class=\"signature-field empty\" style=\"display: inline-block; margin: 10px 0;\">\n      ${field.label ? `<p style=\"font-size: 10pt; color: #666; margin: 0 0 5px 0;\">${field.label}${field.required ? ' <span style=\"color: #ef4444;\">*</span>' : ''}</p>` : ''}\n      <div style=\"border: 2px dashed #d1d5db; border-radius: 4px; padding: 12px; background-color: #f9fafb; width: ${width}px; height: ${height}px; display: flex; align-items: center; justify-content: center;\">\n        <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#9ca3af\" stroke-width=\"1.5\" style=\"opacity: 0.5;\">\n          <path d=\"M16 3.13a4 4 0 0 1 0 7.75\" />\n          <path d=\"M3 20.05V5.5a2.5 2.5 0 0 1 5 0V20.05\" />\n          <path d=\"M7 13.5h9.5\" />\n          <path d=\"M20 20.5V10.5a2.5 2.5 0 0 0-5 0V20.5\" />\n        </svg>\n      </div>\n      ${field.signerRole || field.signerEmail ? `<p style=\"margin: 5px 0 0 0; font-size: 9pt; color: #6b7280;\">${field.signerRole || field.signerEmail}</p>` : ''}\n    </div>\n  `\n}\n","export {processSignatures as '70bafc011444c60487d1ee4847afd169e191567030'} from 'ACTIONS_MODULE0'\n"],"names":["registerServerReference","ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"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","ignoreList":[1,2]}