module.exports=[23415,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(238246),e=a.i(50944),f=a.i(497895),g=a.i(576030),h=a.i(534357),i=a.i(32886);function j(a,b){return(...a)=>{try{return b(...a)}catch{throw Error(void 0)}}}let k=j(0,i.useTranslations);j(0,i.useFormatter);var l=a.i(630617),m=a.i(563588),n=a.i(660246),o=a.i(953722),p=a.i(911156),q=a.i(104720),r=a.i(911300),s=a.i(321161),t=a.i(220005),u=a.i(469769),v=a.i(87466),w=a.i(405784),x=a.i(987105),y=a.i(941675),z=a.i(808406),A=a.i(255225),B=a.i(539833),C=a.i(603314),D=a.i(492596),E=a.i(267900),F=a.i(93518),G=a.i(943108),H=a.i(170106);let I=(0,H.default)("BookOpenCheck",[["path",{d:"M8 3H2v15h7c1.7 0 3 1.3 3 3V7c0-2.2-1.8-4-4-4Z",key:"1i8u0n"}],["path",{d:"m16 12 2 2 4-4",key:"mdajum"}],["path",{d:"M22 6V3h-6c-2.2 0-4 1.8-4 4v14c0-1.7 1.3-3 3-3h7v-2.3",key:"jb5l51"}]]),J=(0,H.default)("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);var K=a.i(64791),L=a.i(290669),M=a.i(626251),N=a.i(660450),O=a.i(244494),P=a.i(124987);let Q=(0,H.default)("Badge",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]]);var R=a.i(913216);a.i(460355);var S=a.i(346271),T=a.i(262036);let U=["super_admin","admin","secretary","accountant"],V=["super_admin","admin","secretary","accountant"],W=["super_admin","admin","secretary"];function X(){var a;let i=(0,e.usePathname)(),{logout:j,user:H}=(0,R.useAuth)(),X=(0,g.useVocabulary)()||(0,h.getVocabulary)("school"),Y=k(),[Z,$]=(0,c.useState)(!1),[_,aa]=(0,c.useState)(null),[ab,ac]=(0,c.useState)([]);(0,c.useEffect)(()=>{$(!0),aa(i||null)},[i]),(0,c.useEffect)(()=>{Z&&_?ac((()=>{if(!Z||!_)return[];let a=[];return(_.startsWith("/dashboard/programs")||_.startsWith("/dashboard/formations")||_.startsWith("/dashboard/sessions")||_.startsWith("/dashboard/elearning")||_.startsWith("/dashboard/catalog"))&&a.push(Y("navigation.pedagogy")),(_.startsWith("/dashboard/attendance")||_.startsWith("/dashboard/evaluations"))&&a.push(Y("navigation.tracking")),(_.startsWith("/dashboard/payments")||_.startsWith("/dashboard/financial-reports")||_.startsWith("/dashboard/bpf"))&&a.push(Y("navigation.finances")),(_.startsWith("/dashboard/qualiopi")||_.startsWith("/dashboard/cpf")||_.startsWith("/dashboard/certifications")||_.startsWith("/dashboard/opco")||_.startsWith("/dashboard/gdpr")||_.startsWith("/dashboard/compliance")||_.startsWith("/dashboard/accessibility")||_.startsWith("/dashboard/admin"))&&a.push(Y("navigation.qualityRegulation")),(_.startsWith("/dashboard/tutorials")||_.startsWith("/dashboard/documentation")||_.startsWith("/dashboard/knowledge-base")||_.startsWith("/dashboard/support"))&&a.push(Y("navigation.helpCenter")),a})()):ac([])},[_,Z]);let ad=[{title:Y("navigation.main"),items:[{name:Y("common.dashboard"),href:"/dashboard",icon:l.LayoutDashboard},{name:Y("navigation.calendar"),href:"/dashboard/calendar",icon:y.Calendar},{name:Y("common.messages"),href:"/dashboard/messages",icon:m.MessageSquare}]},{title:Y("navigation.pedagogy"),items:[{name:X.students,href:"/dashboard/students",icon:n.Users,allowedRoles:U},{name:Y("navigation.myStudents"),href:"/dashboard/my-students",icon:n.Users,allowedRoles:["teacher"]},{name:Y("navigation.pedagogy"),icon:x.BookMarked,allowedRoles:W,children:[{name:Y("common.programs"),href:"/dashboard/programs",icon:o.BookOpen},{name:Y("common.sessions"),href:"/dashboard/sessions",icon:y.Calendar},{name:Y("common.formations"),href:"/dashboard/formations",icon:x.BookMarked},{name:Y("navigation.elearning"),href:"/dashboard/elearning",icon:u.GraduationCap},{name:"Catalogue Public",href:"/dashboard/catalog",icon:O.Globe},{name:Y("navigation.resources"),href:"/dashboard/resources",icon:D.Folder}]},{name:Y("navigation.tracking"),icon:r.ClipboardList,children:[{name:X.attendance,href:"/dashboard/attendance",icon:r.ClipboardList},{name:X.evaluations,href:"/dashboard/evaluations",icon:v.FileCheck},{name:Y("navigation.learningPortfolios"),href:"/dashboard/evaluations/portfolios",icon:x.BookMarked},{name:"Rapports & Analytics",href:"/dashboard/reports",icon:A.BarChart3}]}]},{title:Y("navigation.management"),allowedRoles:U,items:[{name:Y("navigation.finances"),icon:p.CreditCard,allowedRoles:V,children:[{name:X.payments,href:"/dashboard/payments",icon:p.CreditCard},{name:Y("navigation.financialReports"),href:"/dashboard/financial-reports",icon:A.BarChart3},{name:"Bilan P√©dagogique Financier",href:"/dashboard/bpf",icon:A.BarChart3}]},{name:Y("navigation.documents"),href:"/dashboard/documents",icon:q.FileText},{name:"Sites et Antennes",href:"/dashboard/sites",icon:P.MapPin}]},{title:Y("navigation.compliance"),allowedRoles:U,items:[{name:Y("navigation.qualityRegulation"),icon:C.Shield,children:[{name:Y("navigation.qualiopi"),href:"/dashboard/qualiopi",icon:F.Award},{name:"Accessibilit√© Handicap",href:"/dashboard/accessibility",icon:N.Accessibility},{name:Y("navigation.cpf"),href:"/dashboard/cpf",icon:u.GraduationCap},{name:"Certifications RNCP/RS",href:"/dashboard/certifications",icon:Q},{name:Y("navigation.opco"),href:"/dashboard/opco",icon:E.Building2},{name:Y("navigation.gdpr"),href:"/dashboard/gdpr",icon:G.Lock},{name:Y("navigation.compliance"),href:"/dashboard/compliance",icon:C.Shield},{name:Y("navigation.admin"),icon:C.Shield,allowedRoles:U,children:[{name:Y("navigation.systemHealth"),href:"/dashboard/admin/health",icon:L.Activity},{name:Y("navigation.exportHistory"),href:"/dashboard/admin/exports",icon:M.FileDown}]}]}]},{title:Y("navigation.help"),items:[{name:Y("navigation.helpCenter"),icon:B.HelpCircle,children:[{name:Y("navigation.videoTutorials"),href:"/dashboard/tutorials",icon:K.Video},{name:Y("navigation.documentation"),href:"/dashboard/documentation",icon:I},{name:Y("navigation.knowledgeBase"),href:"/dashboard/knowledge-base",icon:o.BookOpen},{name:Y("navigation.support"),href:"/dashboard/support",icon:J}]}]}],ae=Z&&H?.role?(a=H.role)?ad.filter(b=>!b.allowedRoles||!!b.allowedRoles.includes(a)).map(b=>({...b,items:b.items.filter(b=>!b.allowedRoles||!!b.allowedRoles.includes(a)).map(b=>({...b,children:b.children?.filter(b=>!b.allowedRoles||!!b.allowedRoles.includes(a))}))})).filter(a=>a.items.length>0):ad:ad;return(0,b.jsx)("div",{className:"hidden md:flex md:flex-shrink-0",children:(0,b.jsx)("div",{className:"flex flex-col w-72",children:(0,b.jsxs)(S.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,ease:[.16,1,.3,1]},className:"relative flex flex-col flex-grow bg-gradient-to-b from-white via-gray-50/50 to-white backdrop-blur-xl border-r-2 border-gray-200/50 pt-8 pb-6 overflow-y-auto shadow-2xl shadow-gray-900/5",style:{background:"linear-gradient(to bottom, rgba(255,255,255,0.98), rgba(249,250,251,0.95), rgba(255,255,255,0.98))",backdropFilter:"blur(20px)"},children:[(0,b.jsx)(S.motion.div,{className:"absolute inset-0 bg-gradient-to-b from-brand-blue/[0.02] via-transparent to-brand-cyan/[0.02] pointer-events-none",animate:{opacity:[.3,.5,.3]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}}),(0,b.jsx)(S.motion.div,{initial:{scale:.8,opacity:0,y:-20},animate:{scale:1,opacity:1,y:0},transition:{delay:.2,type:"spring",stiffness:400,damping:20},className:"relative flex items-center flex-shrink-0 px-6 mb-8",children:(0,b.jsxs)("div",{className:"flex items-center gap-3 group cursor-pointer",children:[(0,b.jsxs)(S.motion.div,{className:"relative",whileHover:{scale:1.1,rotate:5},transition:{type:"spring",stiffness:500,damping:15},children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-brand-blue to-brand-cyan blur-2xl opacity-40 rounded-full animate-pulse"}),(0,b.jsx)("div",{className:"relative p-2.5 bg-gradient-to-br from-brand-blue to-brand-cyan rounded-2xl shadow-xl shadow-brand-blue/30",children:(0,b.jsx)(z.Sparkles,{className:"h-6 w-6 text-white"})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-display font-bold text-transparent bg-clip-text bg-gradient-to-r from-brand-blue via-brand-cyan to-brand-blue tracking-tight",children:"eduzen"}),(0,b.jsx)("p",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest",children:"Premium LMS"})]})]})}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col overflow-y-auto relative z-10",children:[(0,b.jsx)("nav",{className:"flex-1 px-4 space-y-8",children:ae.map((a,c)=>(0,b.jsxs)("div",{children:[(0,b.jsx)(S.motion.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.08*c+.3,duration:.4,ease:[.16,1,.3,1]},className:"px-3 mb-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(S.motion.div,{className:"h-1 w-1 rounded-full bg-gradient-to-r from-brand-blue to-brand-cyan shadow-sm",animate:{scale:[1,1.3,1],opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0,delay:.2*c}}),(0,b.jsx)("h3",{className:"text-[11px] font-bold text-gray-500 uppercase tracking-widest",children:a.title})]})}),(0,b.jsx)("div",{className:"space-y-1",children:a.items.map((a,e)=>{if(a.children){var g,h;let j=!!(g=a.children)&&g.some(a=>i===a.href||i?.startsWith(a.href+"/")),k=(h=a.name,!!Z&&ab.includes(h));return(0,b.jsxs)(S.motion.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},transition:{delay:.1*c+.04*e,duration:.4,ease:[.16,1,.3,1]},whileHover:{x:4},children:[(0,b.jsxs)(S.motion.button,{onClick:()=>{var b;return b=a.name,void ac(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},whileHover:{scale:1.02},whileTap:{scale:.98},className:(0,f.cn)("group relative flex items-center justify-between w-full px-4 py-3 text-sm font-semibold rounded-xl overflow-hidden","transition-all duration-300 ease-out",j?"bg-gradient-to-br from-brand-blue to-brand-cyan text-white shadow-xl shadow-brand-blue/30":"text-gray-700 hover:bg-white hover:text-gray-900 hover:shadow-lg"),children:[(0,b.jsx)(S.motion.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.6,ease:"easeInOut"}}),(0,b.jsxs)("div",{className:"flex items-center relative z-10",children:[(0,b.jsx)(S.motion.div,{className:(0,f.cn)("p-1.5 rounded-lg mr-3",j?"bg-white/20":"bg-gray-100 group-hover:bg-brand-blue/10"),whileHover:{rotate:5,scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:(0,b.jsx)(a.icon,{className:(0,f.cn)("flex-shrink-0 h-4 w-4 transition-colors",j?"text-white":"text-gray-500 group-hover:text-brand-blue")})}),(0,b.jsx)("span",{className:"tracking-tight",children:a.name})]}),(0,b.jsx)(S.motion.div,{animate:{rotate:180*!!k},transition:{duration:.3,type:"spring",stiffness:400,damping:20},className:"relative z-10",children:(0,b.jsx)(w.ChevronDown,{className:(0,f.cn)("h-4 w-4 flex-shrink-0 transition-colors",j?"text-white/90":"text-gray-400 group-hover:text-gray-600")})}),j&&(0,b.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-brand-blue/20 to-brand-cyan/20 blur-xl opacity-50"})]}),(0,b.jsx)(T.AnimatePresence,{children:k&&(0,b.jsx)(S.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:[.16,1,.3,1]},className:"overflow-hidden",children:(0,b.jsx)("div",{className:"ml-4 mt-2 space-y-1 pl-4 border-l-2 border-gradient-to-b from-brand-blue/30 to-brand-cyan/30",children:a.children.map((c,e)=>{if(!c.href)return null;let g=i===c.href||i?.startsWith(c.href+"/");return(0,b.jsx)(S.motion.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.05*e,duration:.3,ease:[.16,1,.3,1]},whileHover:{x:4},children:(0,b.jsxs)(d.default,{href:c.href,className:(0,f.cn)("group relative flex items-center px-3 py-2.5 text-sm font-medium rounded-lg overflow-hidden","transition-all duration-300",g?"bg-gradient-to-r from-brand-blue/10 to-brand-cyan/10 text-brand-blue shadow-md":"text-gray-600 hover:bg-white/80 hover:text-gray-900 hover:shadow-sm"),children:[!g&&(0,b.jsx)(S.motion.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.5}}),(0,b.jsx)(S.motion.div,{className:(0,f.cn)("p-1 rounded-md mr-3 relative z-10",g?"bg-brand-blue/10":"bg-gray-100 group-hover:bg-brand-blue/5"),whileHover:{rotate:8,scale:1.1},transition:{type:"spring",stiffness:500,damping:15},children:(0,b.jsx)(c.icon,{className:(0,f.cn)("flex-shrink-0 h-3.5 w-3.5 transition-colors",g?"text-brand-blue":"text-gray-400 group-hover:text-brand-cyan")})}),(0,b.jsx)("span",{className:"relative z-10 tracking-tight",children:c.name}),g&&(0,b.jsx)(S.motion.div,{layoutId:`activeChild-${a.name}`,className:"absolute left-0 top-1/2 -translate-y-1/2 w-1 h-4 bg-gradient-to-b from-brand-blue to-brand-cyan rounded-r-full",transition:{type:"spring",stiffness:500,damping:30}})]})},c.name)})})})})]},a.name)}if(a.href){let g=i===a.href||i?.startsWith(a.href+"/");return(0,b.jsx)(S.motion.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},transition:{delay:.1*c+.04*e,duration:.4,ease:[.16,1,.3,1]},whileHover:{x:4},children:(0,b.jsxs)(d.default,{href:a.href,className:(0,f.cn)("group relative flex items-center px-4 py-3 text-sm font-semibold rounded-xl overflow-hidden","transition-all duration-300 ease-out",g?"bg-gradient-to-br from-brand-blue to-brand-cyan text-white shadow-xl shadow-brand-blue/30":"text-gray-700 hover:bg-white hover:text-gray-900 hover:shadow-lg"),children:[(0,b.jsx)(S.motion.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.6,ease:"easeInOut"}}),(0,b.jsx)(S.motion.div,{className:(0,f.cn)("p-1.5 rounded-lg mr-3 relative z-10",g?"bg-white/20":"bg-gray-100 group-hover:bg-brand-blue/10"),whileHover:{rotate:5,scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:(0,b.jsx)(a.icon,{className:(0,f.cn)("flex-shrink-0 h-4 w-4 transition-colors",g?"text-white":"text-gray-500 group-hover:text-brand-blue")})}),(0,b.jsx)("span",{className:"relative z-10 tracking-tight",children:a.name}),g&&(0,b.jsx)(S.motion.div,{layoutId:"activeSidebarItem",className:"absolute left-0 top-1/2 -translate-y-1/2 w-1 h-8 bg-white/40 rounded-r-full shadow-lg",transition:{type:"spring",stiffness:500,damping:30}}),g&&(0,b.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-brand-blue/20 to-brand-cyan/20 blur-xl opacity-50"})]})},a.name)}return null})})]},a.title))}),(0,b.jsxs)(S.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5,ease:[.16,1,.3,1]},className:"relative z-10 px-4 mt-auto pt-6 space-y-2",children:[(0,b.jsxs)("div",{className:"relative mb-4",children:[(0,b.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,b.jsx)("div",{className:"w-full border-t-2 border-gradient-to-r from-transparent via-gray-200 to-transparent"})}),(0,b.jsx)("div",{className:"relative flex justify-center",children:(0,b.jsx)(S.motion.div,{className:"px-3 bg-gradient-to-r from-brand-blue to-brand-cyan rounded-full p-0.5",animate:{scale:[1,1.05,1]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:(0,b.jsx)("div",{className:"bg-white px-2 py-0.5 rounded-full",children:(0,b.jsx)("span",{className:"text-[9px] font-bold text-transparent bg-clip-text bg-gradient-to-r from-brand-blue to-brand-cyan uppercase tracking-widest",children:"Syst√®me"})})})})]}),(0,b.jsx)(S.motion.div,{whileHover:{x:4},children:(0,b.jsxs)(d.default,{href:"/dashboard/settings",className:(0,f.cn)("group relative flex items-center px-4 py-3 text-sm font-semibold rounded-xl overflow-hidden","transition-all duration-300",i?.startsWith("/dashboard/settings")?"bg-gradient-to-br from-gray-700 to-gray-800 text-white shadow-xl shadow-gray-700/30":"text-gray-700 hover:bg-white hover:text-gray-900 hover:shadow-lg"),children:[(0,b.jsx)(S.motion.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.6,ease:"easeInOut"}}),(0,b.jsx)(S.motion.div,{className:(0,f.cn)("p-1.5 rounded-lg mr-3 relative z-10",i?.startsWith("/dashboard/settings")?"bg-white/20":"bg-gray-100 group-hover:bg-gray-200"),whileHover:{rotate:90,scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:(0,b.jsx)(s.Settings,{className:(0,f.cn)("flex-shrink-0 h-4 w-4 transition-colors",i?.startsWith("/dashboard/settings")?"text-white":"text-gray-500 group-hover:text-gray-700")})}),(0,b.jsx)("span",{className:"relative z-10 tracking-tight",children:Y("common.settings")})]})}),(0,b.jsx)(S.motion.div,{whileHover:{x:4},children:(0,b.jsxs)(S.motion.button,{onClick:()=>j(),whileHover:{scale:1.02},whileTap:{scale:.98},className:"group relative flex items-center w-full px-4 py-3 text-sm font-semibold text-gray-700 rounded-xl hover:bg-gradient-to-br hover:from-red-50 hover:to-red-100 hover:text-red-600 hover:shadow-lg transition-all duration-300 overflow-hidden",children:[(0,b.jsx)(S.motion.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.6,ease:"easeInOut"}}),(0,b.jsx)(S.motion.div,{className:"p-1.5 rounded-lg mr-3 bg-gray-100 group-hover:bg-red-100 transition-colors relative z-10",whileHover:{rotate:-15,scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:(0,b.jsx)(t.LogOut,{className:"flex-shrink-0 h-4 w-4 text-gray-500 group-hover:text-red-500 transition-colors"})}),(0,b.jsx)("span",{className:"relative z-10 tracking-tight",children:Y("common.logout")})]})})]})]})]})})})}var Y=a.i(546842),Z=a.i(972692),$=a.i(340695),_=a.i(807706),aa=a.i(109347),ab=a.i(633508);let ac=[{name:"Dashboard",href:"/dashboard",icon:l.LayoutDashboard},{name:"√âl√®ves",href:"/dashboard/students",icon:n.Users},{name:"Biblioth√®que",icon:aa.Library,children:[{name:"Programmes",href:"/dashboard/programs",icon:o.BookOpen},{name:"Formations",href:"/dashboard/formations",icon:x.BookMarked},{name:"Sessions",href:"/dashboard/sessions",icon:y.Calendar},{name:"E-learning",href:"/dashboard/elearning",icon:u.GraduationCap},{name:"√âvaluations",href:"/dashboard/evaluations",icon:v.FileCheck}]},{name:"Paiements",href:"/dashboard/payments",icon:p.CreditCard},{name:"√âmargement",href:"/dashboard/attendance",icon:r.ClipboardList},{name:"Documents",href:"/dashboard/documents",icon:q.FileText},{name:"Param√®tres",href:"/dashboard/settings",icon:s.Settings}];function ad({isOpen:a,onClose:g}){let h=(0,e.usePathname)(),{logout:i,user:j}=(0,R.useAuth)(),[k,l]=(0,c.useState)(()=>h?.startsWith("/dashboard/programs")||h?.startsWith("/dashboard/formations")||h?.startsWith("/dashboard/sessions")||h?.startsWith("/dashboard/elearning")||h?.startsWith("/dashboard/evaluations")?["Biblioth√®que"]:[]);(0,c.useEffect)(()=>{g()},[h,g]),(0,c.useEffect)(()=>(a?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[a]);let m=a=>h===a||h?.startsWith(a+"/");return(0,b.jsx)(T.AnimatePresence,{children:a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(S.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40 md:hidden",onClick:g}),(0,b.jsxs)(S.motion.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-2xl md:hidden flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-primary/20 blur-xl rounded-full"}),(0,b.jsx)(z.Sparkles,{className:"h-6 w-6 text-primary relative z-10"})]}),(0,b.jsx)("h1",{className:"text-xl font-bold bg-gradient-to-r from-primary via-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"eduzen"})]}),(0,b.jsx)($.Button,{variant:"ghost",size:"icon",onClick:g,className:"h-10 w-10 rounded-full",children:(0,b.jsx)(ab.X,{className:"h-5 w-5"})})]}),(0,b.jsx)("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:ac.map((a,c)=>{if("children"in a&&a.children){var e;let c,g=!!(e=a.children)&&e.some(a=>"href"in a&&m(a.href)),h=(c=a.name,k.includes(c));return(0,b.jsxs)("div",{children:[(0,b.jsxs)("button",{onClick:()=>{var b;return b=a.name,void l(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},className:(0,f.cn)("w-full flex items-center justify-between px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200",g?"bg-gradient-to-r from-primary to-blue-600 text-white shadow-lg shadow-primary/25":"text-gray-700 hover:bg-gray-100 active:bg-gray-200"),children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)(a.icon,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:a.name})]}),(0,b.jsx)(S.motion.div,{animate:{rotate:180*!!h},transition:{duration:.2},children:(0,b.jsx)(w.ChevronDown,{className:"h-4 w-4"})})]}),(0,b.jsx)(T.AnimatePresence,{children:h&&(0,b.jsx)(S.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,b.jsx)("div",{className:"pl-4 mt-2 space-y-1",children:a.children.map(a=>(0,b.jsxs)(d.default,{href:a.href,className:(0,f.cn)("flex items-center space-x-3 px-4 py-2.5 rounded-lg text-sm transition-all duration-200",m(a.href)?"bg-primary/10 text-primary font-medium":"text-gray-600 hover:bg-gray-50 active:bg-gray-100"),children:[(0,b.jsx)(a.icon,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:a.name})]},a.href))})})})]},a.name)}return"href"in a?(0,b.jsxs)(d.default,{href:a.href,className:(0,f.cn)("flex items-center space-x-3 px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200",m(a.href)?"bg-gradient-to-r from-primary to-blue-600 text-white shadow-lg shadow-primary/25":"text-gray-700 hover:bg-gray-100 active:bg-gray-200"),children:[(0,b.jsx)(a.icon,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:a.name})]},a.href):null})}),(0,b.jsxs)("div",{className:"p-4 border-t border-gray-200 space-y-2",children:[j&&(0,b.jsx)("div",{className:"px-4 py-2 text-sm text-gray-600",children:(0,b.jsx)("p",{className:"font-medium",children:j.email})}),(0,b.jsxs)($.Button,{variant:"ghost",onClick:()=>{i(),g()},className:"w-full justify-start text-gray-700 hover:bg-gray-100 hover:text-gray-900",children:[(0,b.jsx)(t.LogOut,{className:"mr-3 h-4 w-4"}),"D√©connexion"]})]})]})]})})}var ae=a.i(470880),af=a.i(65341);let ag=(0,H.default)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);var ah=a.i(269240),ai=a.i(460017),aj=a.i(676504);function ak(){let{theme:a,resolvedTheme:d,setTheme:e,toggleTheme:f}=function(){let[a,b]=function(a,b){let[d,e]=(0,c.useState)(()=>b),f=(0,c.useCallback)(b=>{try{let a=b instanceof Function?b(d):b;e(a)}catch(b){console.error(`Error setting localStorage key "${a}":`,b)}},[a,d]),g=(0,c.useCallback)(()=>{try{e(b)}catch(b){console.error(`Error removing localStorage key "${a}":`,b)}},[a,b]);return(0,c.useEffect)(()=>{},[a]),[d,f,g]}("theme","system"),[d,e]=(0,c.useState)("light"),f=(0,ah.createClient)(),{user:g}=(0,R.useAuth)();(0,c.useEffect)(()=>{g?.id&&(async()=>{try{let{data:a}=await f.from("users").select("theme_preference").eq("id",g.id).single();a?.theme_preference&&b(a.theme_preference)}catch(a){console.error("Error loading theme preference:",a)}})()},[g?.id,b,f]),(0,c.useEffect)(()=>{},[a]);let h=a=>{};return{theme:a,resolvedTheme:d,setTheme:h,toggleTheme:()=>{h("dark"===d?"light":"dark")}}}();return(0,b.jsxs)(aj.DropdownMenu,{children:[(0,b.jsx)(aj.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)($.Button,{variant:"ghost",size:"icon",className:"h-10 w-10 rounded-xl min-touch-target touch-manipulation",children:[(0,b.jsx)(S.motion.div,{animate:{rotate:180*("dark"===d)},transition:{duration:.3},children:"dark"===d?(0,b.jsx)(ae.Moon,{className:"h-5 w-5"}):(0,b.jsx)(af.Sun,{className:"h-5 w-5"})}),(0,b.jsx)("span",{className:"sr-only",children:"Changer le th√®me"})]})}),(0,b.jsxs)(aj.DropdownMenuContent,{align:"end",className:"w-40",children:[(0,b.jsxs)(aj.DropdownMenuItem,{onClick:()=>e("light"),className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)(af.Sun,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Clair"}),"light"===a&&(0,b.jsx)(S.motion.span,{initial:{scale:0},animate:{scale:1},className:"ml-auto h-2 w-2 rounded-full bg-primary"})]}),(0,b.jsxs)(aj.DropdownMenuItem,{onClick:()=>e("dark"),className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)(ae.Moon,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Sombre"}),"dark"===a&&(0,b.jsx)(S.motion.span,{initial:{scale:0},animate:{scale:1},className:"ml-auto h-2 w-2 rounded-full bg-primary"})]}),(0,b.jsxs)(aj.DropdownMenuItem,{onClick:()=>e("system"),className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)(ag,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Syst√®me"}),"system"===a&&(0,b.jsx)(S.motion.span,{initial:{scale:0},animate:{scale:1},className:"ml-auto h-2 w-2 rounded-full bg-primary"})]})]})]})}var al=a.i(433217),am=a.i(587532),an=a.i(526017);let ao=new class{supabase;constructor(a){this.supabase=a||(0,ah.createClient)()}async searchGlobal(a,b,c){if(!a||a.trim().length<2)return[];let d=a.trim().toLowerCase(),e=[],[f,g,h,i]=await Promise.all([this.searchStudents(d,b),this.searchSessions(d,b),this.searchDocuments(d,b),c?this.searchConversations(d,b,c):Promise.resolve([])]);return e.push(...f,...g,...h,...i),e.sort((a,b)=>{let c=+!!a.title.toLowerCase().startsWith(d);return!!b.title.toLowerCase().startsWith(d)-c})}async searchStudents(a,b){let{data:c,error:d}=await this.supabase.from("students").select("id, first_name, last_name, student_number, email").eq("organization_id",b).or(`first_name.ilike.%${a}%,last_name.ilike.%${a}%,student_number.ilike.%${a}%,email.ilike.%${a}%`).limit(10);return d||!c?[]:c.map(a=>({type:"student",id:a.id,title:`${a.first_name||""} ${a.last_name||""}`.trim()||a.student_number||"√âtudiant",description:a.student_number||a.email||void 0,url:`/dashboard/students/${a.id}`,metadata:{student_number:a.student_number,email:a.email}}))}async searchSessions(a,b){let{data:c,error:d}=await this.supabase.from("sessions").select("id, name, start_date, end_date").eq("organization_id",b).ilike("name",`%${a}%`).limit(10);return d||!c?[]:c.map(a=>({type:"session",id:a.id,title:a.name||"Session",description:a.start_date?`Du ${new Date(a.start_date).toLocaleDateString("fr-FR")}`:void 0,url:`/dashboard/sessions/${a.id}`,metadata:{start_date:a.start_date,end_date:a.end_date}}))}async searchDocuments(a,b){let{data:c,error:d}=await this.supabase.from("documents").select("id, title, type, created_at").eq("organization_id",b).ilike("title",`%${a}%`).limit(10);return d||!c?[]:c.map(a=>({type:"document",id:a.id,title:a.title||"Document",description:a.type||void 0,url:"/dashboard/documents",metadata:{type:a.type,created_at:a.created_at}}))}async searchConversations(a,b,c){let{data:d,error:e}=await this.supabase.from("conversations").select("id, name, conversation_type").eq("organization_id",b).ilike("name",`%${a}%`).limit(5);if(e||!d)return[];let f=d.map(a=>a.id),{data:g}=await this.supabase.from("conversation_participants").select("conversation_id").in("conversation_id",f).eq("user_id",c),h=new Set(g?.map(a=>a.conversation_id)||[]);return d.filter(a=>h.has(a.id)).map(a=>({type:"message",id:a.id,title:a.name||"Conversation",description:"group"===a.conversation_type?"Groupe":"Direct",url:`/dashboard/messages/${a.id}`,metadata:{conversation_type:a.conversation_type}}))}};function ap(a,b){if(!b||!a)return[{text:a,highlight:!1}];let c=a.toLowerCase(),d=b.toLowerCase(),e=[],f=0,g=c.indexOf(d,f);for(;-1!==g;)g>f&&e.push({text:a.substring(f,g),highlight:!1}),e.push({text:a.substring(g,g+b.length),highlight:!0}),f=g+b.length,g=c.indexOf(d,f);return f<a.length&&e.push({text:a.substring(f),highlight:!1}),e.length>0?e:[{text:a,highlight:!1}]}let aq={student:n.Users,session:o.BookOpen,document:q.FileText,message:m.MessageSquare},ar={student:"√âtudiant",session:"Session",document:"Document",message:"Message"};function as({className:a}){let{user:d}=(0,R.useAuth)(),g=(0,e.useRouter)(),[h,i]=(0,c.useState)(""),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(!1),n=function(a,b=300){let[d,e]=(0,c.useState)(a);return(0,c.useEffect)(()=>{let c=setTimeout(()=>{e(a)},b);return()=>{clearTimeout(c)}},[a,b]),d}(h,300),o=(0,c.useRef)(null);!function(a,b=!0){let d=(0,c.useRef)(null);(0,c.useEffect)(()=>{if(!b)return;let c=b=>{d.current&&!d.current.contains(b.target)&&a()};return document.addEventListener("mousedown",c),document.addEventListener("touchstart",c),()=>{document.removeEventListener("mousedown",c),document.removeEventListener("touchstart",c)}},[a,b])}(o,()=>k(!1));let{data:p,isLoading:q}=(0,al.useQuery)({queryKey:["global-search",n,d?.organization_id,d?.id],queryFn:async()=>{if(!n||n.length<2||!d?.organization_id)return[];let a=await ao.searchGlobal(n,d.organization_id,d.id);return a.length>0&&ai.analytics.search.performed(n,a.length),a},enabled:n.length>=2&&!!d?.organization_id,staleTime:3e4});(0,c.useEffect)(()=>{h.length>=2&&l?k(!0):0===h.length&&k(!1)},[h,l]);let r=a=>{g.push(a.url),i(""),k(!1),m(!1)};return(0,b.jsxs)("div",{ref:o,className:(0,f.cn)("relative flex-1 max-w-xl",a),children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("div",{className:"absolute left-3 md:left-4 top-1/2 -translate-y-1/2 pointer-events-none",children:q?(0,b.jsx)(an.Loader2,{className:"h-4 w-4 md:h-5 md:w-5 animate-spin text-text-tertiary"}):(0,b.jsx)(am.Search,{className:"h-4 w-4 md:h-5 md:w-5 text-text-tertiary"})}),(0,b.jsx)("input",{type:"text",placeholder:"Rechercher des √©tudiants, sessions, documents...",value:h,onChange:a=>i(a.target.value),onFocus:()=>m(!0),onBlur:()=>{setTimeout(()=>m(!1),200)},onKeyDown:a=>{"Escape"===a.key?(k(!1),m(!1)):"Enter"===a.key&&p&&p.length>0&&r(p[0])},className:(0,f.cn)("w-full pl-10 md:pl-12 pr-10 py-2.5 md:py-3 rounded-xl border-2 transition-all duration-300 text-sm md:text-base","focus:outline-none focus:ring-2 focus:ring-brand-cyan/30","bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm text-text-primary placeholder:text-text-placeholder",l||j?"border-brand-cyan shadow-lg shadow-brand-cyan/20 bg-white dark:bg-gray-800":"border-white/30 dark:border-gray-700/30 hover:border-white/50 dark:hover:border-gray-700/50")}),h&&(0,b.jsx)("button",{onClick:()=>{i(""),k(!1)},className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:(0,b.jsx)(ab.X,{className:"h-4 w-4 text-text-tertiary"})})]}),(0,b.jsx)(T.AnimatePresence,{children:j&&p&&p.length>0&&(0,b.jsx)(S.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute top-full mt-2 w-full bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 max-h-96 overflow-y-auto z-50",children:p.map(a=>{let c=aq[a.type],d=ap(a.title,n),e=a.description?ap(a.description,n):null;return(0,b.jsxs)("button",{onClick:()=>r(a),className:"w-full px-4 py-3 flex items-start gap-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left first:rounded-t-xl last:rounded-b-xl",children:[(0,b.jsx)(c,{className:"h-5 w-5 text-brand-cyan mt-0.5 flex-shrink-0"}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("p",{className:"font-medium text-text-primary truncate",children:d.map((a,c)=>a.highlight?(0,b.jsx)("mark",{className:"bg-brand-cyan/20 text-brand-cyan dark:bg-brand-cyan/30 dark:text-brand-cyan font-semibold px-0.5 rounded",children:a.text},c):(0,b.jsx)("span",{children:a.text},c))}),(0,b.jsx)("span",{className:"text-xs text-text-tertiary bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded flex-shrink-0",children:ar[a.type]})]}),e&&(0,b.jsx)("p",{className:"text-sm text-text-tertiary mt-1 truncate",children:e.map((a,c)=>a.highlight?(0,b.jsx)("mark",{className:"bg-brand-cyan/20 text-brand-cyan dark:bg-brand-cyan/30 dark:text-brand-cyan font-semibold px-0.5 rounded",children:a.text},c):(0,b.jsx)("span",{children:a.text},c))})]})]},`${a.type}-${a.id}`)})})}),j&&h.length>=2&&!q&&(!p||0===p.length)&&(0,b.jsx)(S.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-full mt-2 w-full bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 p-4 z-50",children:(0,b.jsxs)("p",{className:"text-sm text-text-tertiary text-center",children:['Aucun r√©sultat trouv√© pour "',h,'"']})})]})}var at=a.i(370025);let au=new class{supabase;constructor(a){this.supabase=a||(0,ah.createClient)()}async create(a){let{data:b,error:c}=await this.supabase.from("user_feedback").insert({organization_id:a.organizationId,user_id:a.userId,student_id:a.studentId,feedback_type:a.feedbackType,category:a.category,title:a.title,description:a.description,page_url:a.pageUrl,user_agent:a.userAgent,screenshot_url:a.screenshotUrl,priority:a.priority||"medium",status:"pending"}).select().single();if(c)throw c;return b}async getByOrganization(a,b){let c=b?.page||1,d=b?.limit||50,e=(c-1)*d,f=this.supabase.from("user_feedback").select("*, users(id, full_name, email), students(id, first_name, last_name, email), assigned_user:users!assigned_to(id, full_name, email)",{count:"exact"}).eq("organization_id",a).order("created_at",{ascending:!1});b?.userId&&(f=f.eq("user_id",b.userId)),b?.status&&(f=f.eq("status",b.status)),b?.feedbackType&&(f=f.eq("feedback_type",b.feedbackType)),b?.priority&&(f=f.eq("priority",b.priority)),b?.assignedTo&&(f=f.eq("assigned_to",b.assignedTo));let{data:g,error:h,count:i}=await f.range(e,e+d-1);if(h)throw h;return{data:g||[],total:i||0,page:c,limit:d,totalPages:Math.ceil((i||0)/d)}}async getById(a){let{data:b,error:c}=await this.supabase.from("user_feedback").select("*, users(id, full_name, email), students(id, first_name, last_name, email), assigned_user:users!assigned_to(id, full_name, email)").eq("id",a).single();if(c)throw c;return b}async update(a,b){let{data:c,error:d}=await this.supabase.from("user_feedback").update(b).eq("id",a).select().single();if(d)throw d;return c}async assign(a,b){return this.update(a,{assigned_to:b,status:"reviewing"})}async updateStatus(a,b,c){let d={status:b,resolved_at:"resolved"===b?new Date().toISOString():null,resolution_notes:c};return this.update(a,d)}async getStats(a){let{data:b,error:c}=await this.supabase.from("user_feedback").select("status, feedback_type, priority").eq("organization_id",a);if(c)throw c;let d={total:b?.length||0,byStatus:{},byType:{},byPriority:{},pending:0,resolved:0};return b?.forEach(a=>{d.byStatus[a.status]=(d.byStatus[a.status]||0)+1,d.byType[a.feedback_type]=(d.byType[a.feedback_type]||0)+1,d.byPriority[a.priority]=(d.byPriority[a.priority]||0)+1,"pending"===a.status&&d.pending++,"resolved"===a.status&&d.resolved++}),d}async delete(a){let{error:b}=await this.supabase.from("user_feedback").delete().eq("id",a);if(b)throw b}};var av=a.i(864037),aw=a.i(965733),ax=a.i(205522),ay=a.i(917171),az=a.i(546893),aA=a.i(800006),aB=a.i(838632);function aC({variant:a="outline",size:d="default",className:e}){let{user:f}=(0,R.useAuth)(),{addToast:g}=(0,av.useToast)(),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)("improvement"),[l,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(null),w=(0,ah.createClient)(),x=(0,at.useMutation)({mutationFn:async()=>{if(!f?.organization_id)throw Error("Organisation non trouv√©e");let a=null;if(s){let b=s.name.split(".").pop(),c=`feedback-${Date.now()}.${b}`,d=`feedback/${f.organization_id}/${c}`,{data:e,error:g}=await w.storage.from("documents").upload(d,s,{cacheControl:"3600",upsert:!1});if(g)console.error("Erreur upload screenshot:",g);else{let{data:b}=w.storage.from("documents").getPublicUrl(d);a=b.publicUrl}}return au.create({organizationId:f.organization_id,userId:f.id,feedbackType:j,category:q||void 0,title:l,description:o,pageUrl:void 0,userAgent:void 0,screenshotUrl:a||void 0})},onSuccess:()=>{g({type:"success",title:"Feedback envoy√©",description:"Merci pour votre retour ! Nous examinerons votre demande rapidement."}),i(!1),n(""),p(""),r(""),t(null),v(null)},onError:a=>{g({type:"error",title:"Erreur",description:a.message||"Une erreur est survenue lors de l'envoi du feedback."})}});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)($.Button,{variant:a,size:d,onClick:()=>i(!0),className:e,children:[(0,b.jsx)(m.MessageSquare,{className:"mr-2 h-4 w-4"}),"Feedback"]}),(0,b.jsx)(aw.Dialog,{open:h,onOpenChange:i,children:(0,b.jsxs)(aw.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)(aw.DialogHeader,{children:[(0,b.jsx)(aw.DialogTitle,{children:"Envoyer un feedback"}),(0,b.jsx)(aw.DialogDescription,{children:"Partagez vos id√©es, signalez un bug ou posez une question. Votre avis nous aide √† am√©liorer l'application."})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(ay.Label,{htmlFor:"feedback-type",children:"Type de feedback"}),(0,b.jsxs)(aA.Select,{value:j,onValueChange:a=>k(a),children:[(0,b.jsx)(aA.SelectTrigger,{id:"feedback-type",children:(0,b.jsx)(aA.SelectValue,{})}),(0,b.jsxs)(aA.SelectContent,{children:[(0,b.jsx)(aA.SelectItem,{value:"bug",children:"üêõ Bug / Probl√®me"}),(0,b.jsx)(aA.SelectItem,{value:"feature_request",children:"‚ú® Demande de fonctionnalit√©"}),(0,b.jsx)(aA.SelectItem,{value:"improvement",children:"üí° Am√©lioration"}),(0,b.jsx)(aA.SelectItem,{value:"question",children:"‚ùì Question"}),(0,b.jsx)(aA.SelectItem,{value:"other",children:"üìù Autre"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(ay.Label,{htmlFor:"category",children:"Cat√©gorie (optionnel)"}),(0,b.jsx)(ax.Input,{id:"category",placeholder:"Ex: Messagerie, Paiements, Documents...",value:q,onChange:a=>r(a.target.value)})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(ay.Label,{htmlFor:"title",children:"Titre *"}),(0,b.jsx)(ax.Input,{id:"title",placeholder:"R√©sum√© court de votre feedback",value:l,onChange:a=>n(a.target.value),required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(ay.Label,{htmlFor:"description",children:"Description *"}),(0,b.jsx)(az.Textarea,{id:"description",placeholder:"D√©crivez en d√©tail votre feedback, bug ou demande...",value:o,onChange:a=>p(a.target.value),rows:6,required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(ay.Label,{htmlFor:"screenshot",children:"Capture d'√©cran (optionnel)"}),u?(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("img",{src:u,alt:"Screenshot preview",className:"w-full rounded-lg border border-gray-200 max-h-64 object-contain"}),(0,b.jsx)($.Button,{variant:"ghost",size:"icon",onClick:()=>{t(null),v(null)},className:"absolute top-2 right-2",children:(0,b.jsx)(ab.X,{className:"h-4 w-4"})})]}):(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(ax.Input,{id:"screenshot",type:"file",accept:"image/*",onChange:a=>{let b=a.target.files?.[0];if(b){if(b.size>5242880)return void g({type:"warning",title:"Fichier trop volumineux",description:"La capture d'√©cran ne doit pas d√©passer 5 MB."});t(b);let a=new FileReader;a.onloadend=()=>{v(a.result)},a.readAsDataURL(b)}},className:"hidden"}),(0,b.jsxs)(ay.Label,{htmlFor:"screenshot",className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,b.jsx)(aB.Image,{className:"h-4 w-4"}),"Ajouter une capture d'√©cran"]})]})]})]}),(0,b.jsxs)(aw.DialogFooter,{children:[(0,b.jsx)($.Button,{variant:"outline",onClick:()=>i(!1),children:"Annuler"}),(0,b.jsx)($.Button,{onClick:()=>x.mutate(),disabled:!l||!o||x.isPending,children:x.isPending?"Envoi...":"Envoyer le feedback"})]})]})})]})}var aD=a.i(523312),aE=a.i(937927),aF=a.i(325383);class aG{supabase;constructor(a){this.supabase=a||(0,ah.createClient)()}channels=new Map;async create(a){try{let{data:b,error:c}=await this.supabase.rpc("create_notification",{p_user_id:a.user_id,p_organization_id:a.organization_id,p_type:a.type,p_title:a.title,p_message:a.message,p_data:a.data||{},p_link:a.link||null,p_expires_at:a.expires_at||null});if(c)throw c;let{data:d,error:e}=await this.supabase.from("notifications").select("*").eq("id",b).single();if(e)throw e;return d}catch(b){throw aF.logger.error("Error creating notification",b,{params:a}),b}}async createForUsers(a,b,c,d,e,f,g){try{if(0===a.length)return[];let{data:h,error:i}=await this.supabase.from("notifications").insert(a.map(a=>({user_id:a,organization_id:b,type:c,title:d,message:e,data:f||{},link:g||null}))).select();if(i)throw aF.logger.error("Error creating batch notifications",i,{userCount:a.length,organizationId:b,type:c}),i;return aF.logger.info("Batch notifications created successfully",{count:h.length,organizationId:b,type:c}),h}catch(a){throw aF.logger.error("Error in createForUsers",a),a}}async getByUser(a,b){try{let c=this.supabase.from("notifications").select("*").eq("user_id",a).order("created_at",{ascending:!1});b?.unread_only&&(c=c.is("read_at",null)),b?.limit&&(c=c.limit(b.limit)),b?.offset&&(c=c.range(b.offset,b.offset+(b.limit||50)-1));let{data:d,error:e}=await c;if(e)throw e;return d||[]}catch(c){throw aF.logger.error("Error fetching notifications",c,{user_id:a,options:b}),c}}async getUnreadCount(a){try{if(!a)return 0;let{count:b,error:c}=await this.supabase.from("notifications").select("*",{count:"exact",head:!0}).eq("user_id",a).is("read_at",null);if(c)return aF.logger.warn("Error getting unread count, returning 0",{error:c,user_id:a,errorCode:c.code,errorMessage:c.message}),0;return b||0}catch(b){return aF.logger.error("Exception in getUnreadCount, returning 0",b,{user_id:a}),0}}async markAsRead(a){try{let{data:b,error:c}=await this.supabase.rpc("mark_notification_read",{p_notification_id:a});if(c)throw c;return b||!1}catch(b){throw aF.logger.error("Error marking notification as read",b,{notification_id:a}),b}}async markAllAsRead(a){try{let{data:b,error:c}=await this.supabase.rpc("mark_all_notifications_read",{p_user_id:a});if(c)throw c;return b||0}catch(b){throw aF.logger.error("Error marking all notifications as read",b,{user_id:a}),b}}async delete(a){try{let{error:b}=await this.supabase.from("notifications").delete().eq("id",a);if(b)throw b;return!0}catch(b){throw aF.logger.error("Error deleting notification",b,{notification_id:a}),b}}subscribeToNotifications(a,b){let c=`notifications:${a}`;this.channels.has(c)&&this.unsubscribeFromNotifications(a);let d=this.supabase.channel(c).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${a}`},a=>{b(a.new)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"notifications",filter:`user_id=eq.${a}`},a=>{b(a.new)}).subscribe();return this.channels.set(c,d),()=>{this.unsubscribeFromNotifications(a)}}unsubscribeFromNotifications(a){let b=`notifications:${a}`,c=this.channels.get(b);c&&(this.supabase.removeChannel(c),this.channels.delete(b))}cleanup(){this.channels.forEach(a=>{this.supabase.removeChannel(a)}),this.channels.clear()}}let aH=new aG;function aI({onClick:a,className:d,showCount:e=!0}){let g=function(){let{user:a}=(0,R.useAuth)(),b=(0,aE.useQueryClient)(),{data:d=0}=(0,al.useQuery)({queryKey:["notifications","unread-count",a?.id],queryFn:()=>a?.id?aH.getUnreadCount(a.id):Promise.resolve(0),enabled:!!a?.id,refetchInterval:1e4});return(0,c.useEffect)(()=>{if(a?.id)return aH.subscribeToNotifications(a.id,()=>{b.invalidateQueries({queryKey:["notifications","unread-count",a.id]})})},[a?.id,b]),d}();return(0,b.jsxs)($.Button,{variant:"ghost",size:"icon",onClick:a,className:(0,f.cn)("relative",d),"aria-label":`Notifications${g>0?` (${g} non lues)`:""}`,children:[(0,b.jsx)(aD.Bell,{className:"h-5 w-5"}),e&&g>0&&(0,b.jsx)("span",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs font-bold text-white",children:g>99?"99+":g})]})}let aJ=(0,H.default)("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);var aK=a.i(781560),aL=a.i(452495);let aM=c.forwardRef(({className:a,children:c,...d},e)=>(0,b.jsx)("div",{ref:e,className:(0,f.cn)("relative overflow-auto",a),...d,children:c}));aM.displayName="ScrollArea";var aN=a.i(254161),aO=a.i(96659);let aP={info:"bg-blue-500",success:"bg-green-500",warning:"bg-yellow-500",error:"bg-red-500",message:"bg-purple-500",payment:"bg-indigo-500",attendance:"bg-teal-500",grade:"bg-pink-500",document:"bg-orange-500",system:"bg-gray-500"},aQ={info:"Information",success:"Succ√®s",warning:"Avertissement",error:"Erreur",message:"Message",payment:"Paiement",attendance:"Pr√©sence",grade:"Note",document:"Document",system:"Syst√®me"};function aR({open:a,onOpenChange:e}){let{notifications:g,unreadCount:h,isLoading:i,markAsRead:j,markAllAsRead:k,deleteNotification:l,isMarkingAllAsRead:m}=function(a){let{user:b}=(0,R.useAuth)(),d=(0,aE.useQueryClient)(),{addToast:e}=(0,av.useToast)(),[f,g]=(0,c.useState)([]),{data:h=[],isLoading:i,error:j,refetch:k}=(0,al.useQuery)({queryKey:["notifications",b?.id,a?.unread_only,a?.limit],queryFn:()=>aH.getByUser(b.id,{limit:a?.limit||50,unread_only:a?.unread_only}),enabled:!!b?.id,refetchInterval:!!a?.auto_refresh&&3e4}),{data:l=0}=(0,al.useQuery)({queryKey:["notifications","unread-count",b?.id],queryFn:()=>b?.id?aH.getUnreadCount(b.id):Promise.resolve(0),enabled:!!b?.id,refetchInterval:1e4});(0,c.useEffect)(()=>{if(!b?.id)return;let a=aH.subscribeToNotifications(b.id,a=>{g(b=>[a,...b]),d.invalidateQueries({queryKey:["notifications",b.id]}),d.invalidateQueries({queryKey:["notifications","unread-count",b.id]}),"system"!==a.type&&e({type:"error"===a.type?"error":"info",title:a.title,description:a.message,duration:5e3})});return()=>{a()}},[b?.id,d,e]);let m=(0,at.useMutation)({mutationFn:a=>aH.markAsRead(a),onSuccess:()=>{d.invalidateQueries({queryKey:["notifications",b?.id]}),d.invalidateQueries({queryKey:["notifications","unread-count",b?.id]})}}),n=(0,at.useMutation)({mutationFn:()=>aH.markAllAsRead(b.id),onSuccess:a=>{d.invalidateQueries({queryKey:["notifications",b?.id]}),d.invalidateQueries({queryKey:["notifications","unread-count",b?.id]}),e({type:"success",title:"Notifications marqu√©es comme lues",description:`${a} notification(s) marqu\xe9e(s) comme lue(s).`})}}),o=(0,at.useMutation)({mutationFn:a=>aH.delete(a),onSuccess:()=>{d.invalidateQueries({queryKey:["notifications",b?.id]}),d.invalidateQueries({queryKey:["notifications","unread-count",b?.id]})}});return{notifications:[...f,...h].filter((a,b,c)=>b===c.findIndex(b=>b.id===a.id)),unreadCount:l,isLoading:i,error:j,refetch:k,markAsRead:m.mutate,markAllAsRead:n.mutate,deleteNotification:o.mutate,isMarkingAsRead:m.isPending,isMarkingAllAsRead:n.isPending,isDeleting:o.isPending}}({limit:50}),[n,o]=(0,c.useState)("all"),p=g.filter(a=>"unread"!==n||!a.read_at);return(0,b.jsx)(aw.Dialog,{open:a,onOpenChange:e,children:(0,b.jsxs)(aw.DialogContent,{className:"sm:max-w-[500px]",children:[(0,b.jsx)(aw.DialogHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(aw.DialogTitle,{children:"Notifications"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[h>0&&(0,b.jsxs)($.Button,{variant:"ghost",size:"sm",onClick:()=>{k()},disabled:m,className:"text-xs",children:[(0,b.jsx)(aJ,{className:"mr-1 h-3 w-3"}),"Tout marquer comme lu"]}),(0,b.jsx)($.Button,{variant:"ghost",size:"icon",onClick:()=>e(!1),className:"h-6 w-6",children:(0,b.jsx)(ab.X,{className:"h-4 w-4"})})]})]})}),(0,b.jsxs)("div",{className:"flex gap-2 border-b pb-2",children:[(0,b.jsxs)($.Button,{variant:"all"===n?"default":"ghost",size:"sm",onClick:()=>o("all"),className:"text-xs",children:["Toutes (",g.length,")"]}),(0,b.jsxs)($.Button,{variant:"unread"===n?"default":"ghost",size:"sm",onClick:()=>o("unread"),className:"text-xs",children:["Non lues (",h,")"]})]}),(0,b.jsx)(aM,{className:"h-[500px]",children:i?(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Chargement..."})}):0===p.length?(0,b.jsx)("div",{className:"flex flex-col items-center justify-center py-8",children:(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"unread"===n?"Aucune notification non lue":"Aucune notification"})}):(0,b.jsx)("div",{className:"space-y-1",children:p.map(a=>(0,b.jsx)("div",{className:(0,f.cn)("group relative rounded-lg border p-3 transition-colors hover:bg-accent",!a.read_at&&"bg-accent/50"),onClick:()=>{a.read_at||j(a.id)},children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:(0,f.cn)("mt-1 h-2 w-2 rounded-full",aP[a.type])}),(0,b.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("h4",{className:"text-sm font-medium",children:a.title}),(0,b.jsx)(aN.Badge,{variant:"outline",className:"text-xs",children:aQ[a.type]})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.message})]}),(0,b.jsx)($.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100",onClick:b=>{var c;return c=a.id,void(b.stopPropagation(),l(c))},children:(0,b.jsx)(aK.Trash2,{className:"h-3 w-3"})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:(0,aO.formatRelativeTime)(a.created_at)}),a.link&&(0,b.jsxs)(d.default,{href:a.link,onClick:a=>a.stopPropagation(),className:"flex items-center gap-1 text-primary hover:underline",children:["Voir ",(0,b.jsx)(aL.ExternalLink,{className:"h-3 w-3"})]})]})]}),!a.read_at&&(0,b.jsx)("div",{className:"absolute right-2 top-2",children:(0,b.jsx)("div",{className:"h-2 w-2 rounded-full bg-primary"})})]})},a.id))})})]})})}var aS=c["use".trim()],aT=a.i(606985),aU=a.i(109067),aV=a.i(673199),aW=a.i(945804);let{Link:aX,redirect:aY,usePathname:aZ,useRouter:a$}=function(a){let{Link:d,config:f,getPathname:g,...h}=function(a,d){var f,g,h;let i={...f=d||{},localePrefix:"object"==typeof(h=f.localePrefix)?h:{mode:h||"always"},localeCookie:!!((g=f.localeCookie)??1)&&{name:"NEXT_LOCALE",sameSite:"lax",..."object"==typeof g&&g},localeDetection:f.localeDetection??!0,alternateLinks:f.alternateLinks??!0},j=i.pathnames,k=(0,c.forwardRef)(function({href:c,locale:d,...e},f){let g,h;"object"==typeof c?(g=c.pathname,h=c.params):g=c;let k=(0,aT.isLocalizableHref)(c),m=a(),n=(0,aT.isPromise)(m)?aS(m):m,o=k?l({locale:d||n,href:null==j?g:{pathname:g,params:h},forcePrefix:null!=d||void 0}):g;return(0,b.jsx)(aU.default,{ref:f,href:"object"==typeof c?{...c,pathname:o}:o,locale:d,localeCookie:i.localeCookie,...e})});function l(a){let b,{forcePrefix:c,href:d,locale:e}=a;return null==j?"object"==typeof d?(b=d.pathname,d.query&&(b+=(0,aV.serializeSearchParams)(d.query))):b=d:b=(0,aV.compileLocalizedPathname)({locale:e,...(0,aV.normalizeNameOrNameWithParams)(d),pathnames:i.pathnames}),(0,aV.applyPathnamePrefix)(b,e,i,c)}function m(a){return function(b,...c){return a(l(b),...c)}}return{config:i,Link:k,redirect:m(e.redirect),permanentRedirect:m(e.permanentRedirect),getPathname:l}}(i.useLocale,a);return{...h,Link:d,usePathname:function(){let a,b,d=(a=(0,e.usePathname)(),b=(0,i.useLocale)(),(0,c.useMemo)(()=>{if(!a)return a;let c=a,d=(0,aT.getLocalePrefix)(b,f.localePrefix);if((0,aT.hasPathnamePrefixed)(d,a))c=(0,aT.unprefixPathname)(a,d);else if("never"!==f.localePrefix.mode&&f.localePrefix.prefixes){let d=(0,aT.getLocaleAsPrefix)(b);(0,aT.hasPathnamePrefixed)(d,a)&&(c=(0,aT.unprefixPathname)(a,d))}return c},[f.localePrefix,b,a])),g=(0,i.useLocale)();return(0,c.useMemo)(()=>d&&f.pathnames?(0,aV.getRoute)(g,d,f.pathnames):d,[g,d])},useRouter:function(){let a=(0,e.useRouter)(),b=(0,i.useLocale)(),d=(0,e.usePathname)();return(0,c.useMemo)(()=>{function c(a){return function(c,e){let{locale:h,...i}=e||{},j=[g({href:c,locale:h||b,forcePrefix:null!=h||void 0})];Object.keys(i).length>0&&j.push(i),(0,aW.default)(f.localeCookie,d,b,h),a(...j)}}return{...a,push:c(a.push),replace:c(a.replace),prefetch:c(a.prefetch)}},[b,d,a])},getPathname:g}}({locales:["fr","en"],defaultLocale:"fr",localePrefix:"never"}),a_=[{code:"fr",label:"Fran√ßais",flag:"üá´üá∑"},{code:"en",label:"English",flag:"üá¨üáß"}];function a0(){let a=(0,i.useLocale)(),d=a$(),e=aZ(),[f,g]=(0,c.useState)(!1),h=a_.find(b=>b.code===a)||a_[0];return(0,b.jsxs)(aj.DropdownMenu,{children:[(0,b.jsx)(aj.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)($.Button,{variant:"ghost",size:"sm",className:"gap-2",disabled:f,children:[(0,b.jsx)(O.Globe,{className:"h-4 w-4"}),(0,b.jsxs)("span",{className:"hidden sm:inline",children:[h.flag," ",h.label]}),(0,b.jsx)("span",{className:"sm:hidden",children:h.flag})]})}),(0,b.jsx)(aj.DropdownMenuContent,{align:"end",children:a_.map(c=>(0,b.jsxs)(aj.DropdownMenuItem,{onClick:()=>{var b;(b=c.code)===a||f||(g(!0),d.replace(e,{locale:b}),setTimeout(()=>{g(!1)},500))},disabled:c.code===a||f,className:"cursor-pointer",children:[(0,b.jsx)("span",{className:"mr-2",children:c.flag}),c.label,c.code===a&&(0,b.jsx)("span",{className:"ml-auto text-xs text-muted-foreground",children:"‚úì"})]},c.code))})]})}function a1({onMenuClick:a}){let{user:d,logout:e}=(0,R.useAuth)(),[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(!1),m=(0,c.useRef)(null);return(0,c.useEffect)(()=>{function a(a){m.current&&!m.current.contains(a.target)&&h(!1)}return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]),(0,b.jsxs)(c.default.Fragment,{children:[(0,b.jsx)(ad,{isOpen:i,onClose:()=>j(!1)}),(0,b.jsx)(aR,{open:k,onOpenChange:l}),(0,b.jsx)(S.motion.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-bg-gray-50 border-b border-bg-gray-200 px-4 md:px-6 py-3 md:py-4 sticky top-0 z-30 shadow-sm",children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsx)($.Button,{variant:"ghost",size:"icon",onClick:()=>j(!0),className:"md:hidden h-10 w-10 rounded-xl",children:(0,b.jsx)(Z.Menu,{className:"h-5 w-5"})}),(0,b.jsx)(as,{}),(0,b.jsxs)("div",{className:"flex items-center space-x-2 md:space-x-4",children:[(0,b.jsx)(aC,{variant:"ghost",size:"icon",className:"hidden md:flex"}),(0,b.jsx)(a0,{}),(0,b.jsx)(ak,{}),(0,b.jsx)(aI,{onClick:()=>l(!0)}),(0,b.jsxs)("div",{className:"relative",ref:m,children:[(0,b.jsxs)(S.motion.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>h(!g),className:"flex items-center space-x-3 px-3 py-2 rounded-xl hover:bg-bg-gray-100 transition-colors duration-200 min-touch-target touch-manipulation group",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)(_.Avatar,{fallback:d?.full_name||"Utilisateur",userId:d?.id||"default",size:"md",variant:"auto",className:"shadow-lg group-hover:shadow-xl transition-shadow duration-300 rounded-xl border-2 border-bg-gray-200"}),(0,b.jsxs)("div",{className:"text-right hidden md:block",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-text-primary",children:d?.full_name||"Utilisateur"}),(0,b.jsx)("p",{className:"text-xs text-text-tertiary",children:d?.role||"R√¥le"})]})]}),(0,b.jsx)(w.ChevronDown,{className:(0,f.cn)("h-4 w-4 text-text-tertiary transition-transform duration-200 hidden md:block",g&&"rotate-180")})]}),(0,b.jsx)(T.AnimatePresence,{children:g&&(0,b.jsxs)(S.motion.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute right-0 mt-2 w-56 rounded-xl bg-white shadow-xl border border-bg-gray-200 backdrop-blur-md overflow-hidden z-50",children:[(0,b.jsxs)("div",{className:"px-4 py-3 bg-gradient-to-r from-brand-blue-ghost to-transparent border-b border-bg-gray-200",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-text-primary",children:d?.full_name||"Utilisateur"}),(0,b.jsx)("p",{className:"text-xs text-text-tertiary mt-0.5",children:d?.email||""})]}),(0,b.jsxs)("div",{className:"py-2",children:[(0,b.jsxs)(S.motion.button,{whileHover:{x:4},className:"w-full flex items-center px-4 py-2.5 text-sm text-text-secondary hover:bg-bg-gray-100 transition-colors duration-200",children:[(0,b.jsx)(Y.User,{className:"h-4 w-4 mr-3 text-text-tertiary"}),"Mon profil"]}),(0,b.jsxs)(S.motion.button,{whileHover:{x:4},className:"w-full flex items-center px-4 py-2.5 text-sm text-text-secondary hover:bg-bg-gray-100 transition-colors duration-200",children:[(0,b.jsx)(s.Settings,{className:"h-4 w-4 mr-3 text-text-tertiary"}),"Param√®tres"]}),(0,b.jsx)("div",{className:"border-t border-bg-gray-200 my-2"}),(0,b.jsxs)(S.motion.button,{whileHover:{x:4},onClick:()=>e(),className:"w-full flex items-center px-4 py-2.5 text-sm text-danger-primary hover:bg-danger-bg transition-colors duration-200",children:[(0,b.jsx)(t.LogOut,{className:"h-4 w-4 mr-3"}),"D√©connexion"]})]})]})})]})]})]})})]})}function a2({children:a}){let c=(0,e.usePathname)();return(0,b.jsx)(T.AnimatePresence,{mode:"wait",children:(0,b.jsx)(S.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,ease:[.16,1,.3,1]},className:"w-full",children:a},c)})}var a3=a.i(284505);let a4=(0,H.default)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);function a5(){let{isInstallable:a,isInstalled:d,install:e}=function(){let[a,b]=(0,c.useState)(null),[d,e]=(0,c.useState)(!1),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{window.matchMedia("(display-mode: standalone)").matches&&(g(!0),i(!0));let a=a=>{a.preventDefault(),b(a),e(!0)};window.addEventListener("beforeinstallprompt",a);let c=()=>{g(!0),e(!1),b(null)};return window.addEventListener("appinstalled",c),()=>{window.removeEventListener("beforeinstallprompt",a),window.removeEventListener("appinstalled",c)}},[]),{isInstallable:d,isInstalled:f,isStandalone:h,install:async()=>{if(!a)return!1;try{await a.prompt();let{outcome:c}=await a.userChoice;if("accepted"===c)return e(!1),b(null),!0;return!1}catch(a){return console.error("Error installing PWA:",a),!1}}}}(),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(d||h)return;let b=localStorage.getItem("pwa-install-dismissed");if(b){let a=new Date(b);if((Date.now()-a.getTime())/864e5<7)return}if(a){let a=setTimeout(()=>{g(!0)},3e3);return()=>clearTimeout(a)}},[a,d,h]);let j=async()=>{await e()&&g(!1)};return!f||d?null:(0,b.jsx)(aw.Dialog,{open:f,onOpenChange:g,children:(0,b.jsxs)(aw.DialogContent,{children:[(0,b.jsxs)(aw.DialogHeader,{children:[(0,b.jsxs)(aw.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(a4,{className:"h-5 w-5"}),"Installer EDUZEN"]}),(0,b.jsx)(aw.DialogDescription,{children:"Installez EDUZEN sur votre appareil pour un acc√®s rapide et une meilleure exp√©rience."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2 text-sm text-muted-foreground",children:[(0,b.jsx)("p",{children:"‚úì Acc√®s rapide depuis l'√©cran d'accueil"}),(0,b.jsx)("p",{children:"‚úì Fonctionne hors ligne"}),(0,b.jsx)("p",{children:"‚úì Notifications push"}),(0,b.jsx)("p",{children:"‚úì Exp√©rience optimis√©e"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)($.Button,{onClick:j,className:"flex-1",children:[(0,b.jsx)(a3.Download,{className:"h-4 w-4 mr-2"}),"Installer"]}),(0,b.jsx)($.Button,{onClick:()=>{g(!1),i(!0),localStorage.setItem("pwa-install-dismissed",new Date().toISOString())},variant:"outline",children:(0,b.jsx)(ab.X,{className:"h-4 w-4"})})]})]})]})})}function a6({children:a}){return(0,c.useEffect)(()=>{let a=a=>{if(a.filename?.includes("frame.js")||a.filename?.includes("operationBanner")||a.filename?.includes("chrome-extension://")||a.filename?.includes("moz-extension://")||a.filename?.includes("safari-extension://"))return a.preventDefault(),!1},b=a=>{let b=a.reason?.message||String(a.reason);if(b.includes("sendMessage")||b.includes("frame.js")||b.includes("operationBanner"))return a.preventDefault(),!1};return window.addEventListener("error",a),window.addEventListener("unhandledrejection",b),()=>{window.removeEventListener("error",a),window.removeEventListener("unhandledrejection",b)}},[]),(0,c.useEffect)(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(a=>{console.log("Service Worker registered:",a)}).catch(a=>{console.error("Service Worker registration failed:",a)})},[]),(0,c.useEffect)(()=>{},[]),(0,b.jsxs)("div",{className:"min-h-screen bg-bg-gray-50",children:[(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)(X,{}),(0,b.jsxs)("div",{className:"flex flex-col flex-1 overflow-hidden w-0 min-w-0",children:[(0,b.jsx)(a1,{}),(0,b.jsx)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 smooth-scroll-premium",children:(0,b.jsx)(a2,{children:a})})]})]}),(0,b.jsx)(a5,{})]})}a.s(["default",()=>a6],23415)}];

//# sourceMappingURL=app_%28dashboard%29_layout_tsx_82dc2da3._.js.map