{"version":3,"sources":["../../../../app/%28dashboard%29/dashboard/evaluations/portfolios/new/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { useQuery, useMutation } from '@tanstack/react-query'\nimport { useAuth } from '@/lib/hooks/use-auth'\nimport { createClient } from '@/lib/supabase/client'\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { useToast } from '@/components/ui/toast'\nimport {\n  ArrowLeft, Plus, Search, Users, FileText, Calendar, \n  CheckCircle2, User, BookOpen\n} from 'lucide-react'\nimport Link from 'next/link'\nimport { motion } from '@/components/ui/motion'\nimport { cn } from '@/lib/utils'\n\nexport default function NewPortfolioPage() {\n  const router = useRouter()\n  const { user } = useAuth()\n  const supabase = createClient()\n  const { addToast } = useToast()\n\n  const [step, setStep] = useState(1)\n  const [selectedTemplateId, setSelectedTemplateId] = useState<string>('')\n  const [selectedSessionId, setSelectedSessionId] = useState<string>('')\n  const [selectedStudentIds, setSelectedStudentIds] = useState<string[]>([])\n  const [searchQuery, setSearchQuery] = useState('')\n\n  // Récupérer les templates (organisation + modèles système)\n  const { data: templates, isLoading: isLoadingTemplates } = useQuery({\n    queryKey: ['portfolio-templates-active', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return []\n      \n      // Récupérer les templates de l'organisation ET les templates système (organization_id IS NULL)\n      const { data, error } = await supabase\n        .from('learning_portfolio_templates')\n        .select('*')\n        .or(`organization_id.eq.${user.organization_id},organization_id.is.null`)\n        .eq('is_active', true)\n        .order('is_default', { ascending: false }) // Modèles par défaut en premier\n        .order('name')\n      \n      if (error) {\n        console.log('Table non trouvée:', error)\n        return []\n      }\n      return data || []\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  // Récupérer les sessions\n  const { data: sessions } = useQuery({\n    queryKey: ['sessions-for-portfolio', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return []\n      const { data, error } = await supabase\n        .from('sessions')\n        .select('id, name, start_date, end_date, formations!inner(id, name, organization_id)')\n        .eq('formations.organization_id', user.organization_id)\n        .in('status', ['planned', 'ongoing', 'active', 'in_progress'])\n        .order('start_date', { ascending: false })\n      if (error) return []\n      return data || []\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  // Récupérer les apprenants de la session sélectionnée\n  const { data: students, isLoading: isLoadingStudents } = useQuery({\n    queryKey: ['session-students', selectedSessionId],\n    queryFn: async () => {\n      if (!selectedSessionId) return []\n      \n      // Récupérer les inscriptions avec statuts valides (pas annulées ou refusées)\n      const { data, error } = await supabase\n        .from('enrollments')\n        .select('student:students(id, first_name, last_name, email, photo_url)')\n        .eq('session_id', selectedSessionId)\n        .not('status', 'in', '(\"cancelled\",\"rejected\",\"dropped\")')\n      \n      if (error) {\n        console.error('Erreur récupération apprenants:', error)\n        return []\n      }\n      \n      // Filtrer les résultats valides et dédupliquer par ID\n      const studentsMap = new Map()\n      data?.forEach((e: any) => {\n        if (e.student && e.student.id) {\n          studentsMap.set(e.student.id, e.student)\n        }\n      })\n      \n      return Array.from(studentsMap.values())\n    },\n    enabled: !!selectedSessionId,\n  })\n\n  // Mutation pour créer les livrets\n  const createMutation = useMutation({\n    mutationFn: async () => {\n      const portfoliosToCreate = selectedStudentIds.map(studentId => ({\n        organization_id: user?.organization_id,\n        template_id: selectedTemplateId,\n        student_id: studentId,\n        session_id: selectedSessionId || null,\n        status: 'draft',\n        progress_percentage: 0,\n        started_at: new Date().toISOString(),\n        content: {},\n      }))\n\n      const { data, error } = await (supabase\n        .from('learning_portfolios') as any)\n        .insert(portfoliosToCreate)\n        .select()\n\n      if (error) throw error\n      return data\n    },\n    onSuccess: (data) => {\n      addToast({ \n        type: 'success', \n        title: 'Livrets créés', \n        description: `${data.length} livret(s) ont été créés avec succès.` \n      })\n      // Rediriger vers le premier livret créé ou la liste\n      if (data.length === 1) {\n        router.push(`/dashboard/evaluations/portfolios/${data[0].id}`)\n      } else {\n        router.push('/dashboard/evaluations/portfolios')\n      }\n    },\n    onError: (error: any) => {\n      addToast({ \n        type: 'error', \n        title: 'Erreur', \n        description: error.message || 'Impossible de créer les livrets.' \n      })\n    },\n  })\n\n  const handleCreate = () => {\n    if (!selectedTemplateId) {\n      addToast({ type: 'error', title: 'Erreur', description: 'Sélectionnez un modèle de livret.' })\n      return\n    }\n    if (selectedStudentIds.length === 0) {\n      addToast({ type: 'error', title: 'Erreur', description: 'Sélectionnez au moins un apprenant.' })\n      return\n    }\n    createMutation.mutate()\n  }\n\n  const toggleStudent = (studentId: string) => {\n    setSelectedStudentIds(prev => \n      prev.includes(studentId) \n        ? prev.filter(id => id !== studentId)\n        : [...prev, studentId]\n    )\n  }\n\n  const selectAllStudents = () => {\n    if (students) {\n      setSelectedStudentIds(students.map((s: any) => s.id))\n    }\n  }\n\n  const filteredStudents = students?.filter((s: any) => {\n    const fullName = `${s.first_name} ${s.last_name}`.toLowerCase()\n    return fullName.includes(searchQuery.toLowerCase()) || s.email?.toLowerCase().includes(searchQuery.toLowerCase())\n  })\n\n  return (\n    <div className=\"container mx-auto py-8 px-4 max-w-4xl\">\n      {/* Header */}\n      <motion.div\n        initial={{ opacity: 0, y: -20 }}\n        animate={{ opacity: 1, y: 0 }}\n        className=\"mb-8\"\n      >\n        <div className=\"flex items-center gap-4 mb-4\">\n          <Link href=\"/dashboard/evaluations/portfolios\">\n            <Button variant=\"ghost\" size=\"icon\">\n              <ArrowLeft className=\"h-5 w-5\" />\n            </Button>\n          </Link>\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">\n              Nouveau livret d'apprentissage\n            </h1>\n            <p className=\"text-gray-600\">\n              Créez un livret pour un ou plusieurs apprenants\n            </p>\n          </div>\n        </div>\n\n        {/* Indicateur d'étapes */}\n        <div className=\"flex items-center gap-2 mt-6\">\n          {[1, 2, 3].map((s) => (\n            <div key={s} className=\"flex items-center\">\n              <div \n                className={cn(\n                  'w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors',\n                  step >= s ? 'bg-brand-blue text-white' : 'bg-gray-200 text-gray-600'\n                )}\n              >\n                {step > s ? <CheckCircle2 className=\"h-5 w-5\" /> : s}\n              </div>\n              {s < 3 && (\n                <div className={cn(\n                  'w-12 h-1 mx-2 rounded',\n                  step > s ? 'bg-brand-blue' : 'bg-gray-200'\n                )} />\n              )}\n            </div>\n          ))}\n        </div>\n        <div className=\"flex gap-16 mt-2 text-sm text-gray-600\">\n          <span className={step >= 1 ? 'text-brand-blue font-medium' : ''}>Modèle</span>\n          <span className={step >= 2 ? 'text-brand-blue font-medium' : ''}>Session</span>\n          <span className={step >= 3 ? 'text-brand-blue font-medium' : ''}>Apprenants</span>\n        </div>\n      </motion.div>\n\n      {/* Étape 1: Sélection du modèle */}\n      {step === 1 && (\n        <motion.div\n          initial={{ opacity: 0, x: 20 }}\n          animate={{ opacity: 1, x: 0 }}\n        >\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <FileText className=\"h-5 w-5 text-brand-blue\" />\n                Choisir un modèle de livret\n              </CardTitle>\n              <CardDescription>\n                Sélectionnez le modèle de livret à utiliser pour ce(s) apprenant(s)\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              {isLoadingTemplates ? (\n                <div className=\"flex justify-center py-8\">\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-blue\"></div>\n                </div>\n              ) : templates?.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <FileText className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                  <p className=\"text-gray-600 mb-4\">Aucun modèle de livret disponible</p>\n                  <Link href=\"/dashboard/evaluations/portfolios/templates/new\">\n                    <Button>\n                      <Plus className=\"h-4 w-4 mr-2\" />\n                      Créer un modèle\n                    </Button>\n                  </Link>\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  {templates?.map((template: any) => (\n                    <div\n                      key={template.id}\n                      onClick={() => setSelectedTemplateId(template.id)}\n                      className={cn(\n                        'p-4 border-2 rounded-lg cursor-pointer transition-all',\n                        selectedTemplateId === template.id\n                          ? 'border-brand-blue bg-brand-blue/5'\n                          : 'border-gray-200 hover:border-gray-300'\n                      )}\n                    >\n                      <div className=\"flex items-start gap-3\">\n                        <div \n                          className=\"w-10 h-10 rounded-lg flex items-center justify-center\"\n                          style={{ backgroundColor: `${template.primary_color}20` }}\n                        >\n                          <FileText className=\"h-5 w-5\" style={{ color: template.primary_color }} />\n                        </div>\n                        <div className=\"flex-1\">\n                          <h4 className=\"font-medium text-gray-900\">{template.name}</h4>\n                          {template.description && (\n                            <p className=\"text-sm text-gray-600 line-clamp-2\">{template.description}</p>\n                          )}\n                          <p className=\"text-xs text-gray-500 mt-1\">\n                            {template.template_structure?.length || 0} sections\n                          </p>\n                        </div>\n                        {selectedTemplateId === template.id && (\n                          <CheckCircle2 className=\"h-5 w-5 text-brand-blue\" />\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n\n              <div className=\"flex justify-end mt-6\">\n                <Button \n                  onClick={() => setStep(2)} \n                  disabled={!selectedTemplateId}\n                >\n                  Continuer\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      )}\n\n      {/* Étape 2: Sélection de la session (optionnel) */}\n      {step === 2 && (\n        <motion.div\n          initial={{ opacity: 0, x: 20 }}\n          animate={{ opacity: 1, x: 0 }}\n        >\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Calendar className=\"h-5 w-5 text-brand-blue\" />\n                Sélectionner une session (optionnel)\n              </CardTitle>\n              <CardDescription>\n                Associez le livret à une session de formation pour faciliter le suivi\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-3\">\n                <div\n                  onClick={() => setSelectedSessionId('')}\n                  className={cn(\n                    'p-4 border-2 rounded-lg cursor-pointer transition-all',\n                    !selectedSessionId\n                      ? 'border-brand-blue bg-brand-blue/5'\n                      : 'border-gray-200 hover:border-gray-300'\n                  )}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <h4 className=\"font-medium text-gray-900\">Sans session</h4>\n                      <p className=\"text-sm text-gray-600\">Créer un livret indépendant</p>\n                    </div>\n                    {!selectedSessionId && <CheckCircle2 className=\"h-5 w-5 text-brand-blue\" />}\n                  </div>\n                </div>\n\n                {sessions?.map((session: any) => (\n                  <div\n                    key={session.id}\n                    onClick={() => setSelectedSessionId(session.id)}\n                    className={cn(\n                      'p-4 border-2 rounded-lg cursor-pointer transition-all',\n                      selectedSessionId === session.id\n                        ? 'border-brand-blue bg-brand-blue/5'\n                        : 'border-gray-200 hover:border-gray-300'\n                    )}\n                  >\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <h4 className=\"font-medium text-gray-900\">{session.name}</h4>\n                        <p className=\"text-sm text-gray-600\">{session.formations?.name}</p>\n                      </div>\n                      {selectedSessionId === session.id && <CheckCircle2 className=\"h-5 w-5 text-brand-blue\" />}\n                    </div>\n                  </div>\n                ))}\n              </div>\n\n              <div className=\"flex justify-between mt-6\">\n                <Button variant=\"outline\" onClick={() => setStep(1)}>\n                  Retour\n                </Button>\n                <Button onClick={() => setStep(3)}>\n                  Continuer\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      )}\n\n      {/* Étape 3: Sélection des apprenants */}\n      {step === 3 && (\n        <motion.div\n          initial={{ opacity: 0, x: 20 }}\n          animate={{ opacity: 1, x: 0 }}\n        >\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Users className=\"h-5 w-5 text-brand-blue\" />\n                Sélectionner les apprenants\n              </CardTitle>\n              <CardDescription>\n                {selectedSessionId \n                  ? 'Sélectionnez les apprenants de la session'\n                  : 'Recherchez et sélectionnez les apprenants'}\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center gap-4 mb-4\">\n                <div className=\"relative flex-1\">\n                  <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400\" />\n                  <Input\n                    placeholder=\"Rechercher un apprenant...\"\n                    value={searchQuery}\n                    onChange={(e) => setSearchQuery(e.target.value)}\n                    className=\"pl-10\"\n                  />\n                </div>\n                {students && students.length > 0 && (\n                  <Button variant=\"outline\" onClick={selectAllStudents}>\n                    Tout sélectionner\n                  </Button>\n                )}\n              </div>\n\n              {isLoadingStudents ? (\n                <div className=\"flex justify-center py-8\">\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-blue\"></div>\n                </div>\n              ) : !selectedSessionId ? (\n                <div className=\"text-center py-8 text-gray-600\">\n                  <BookOpen className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                  <p>Sélectionnez une session à l'étape précédente pour voir les apprenants</p>\n                  <p className=\"text-sm mt-2\">ou créez un livret sans session</p>\n                </div>\n              ) : filteredStudents?.length === 0 ? (\n                <div className=\"text-center py-8 text-gray-600\">\n                  <Users className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                  <p>Aucun apprenant trouvé dans cette session</p>\n                </div>\n              ) : (\n                <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n                  {filteredStudents?.map((student: any) => (\n                    <div\n                      key={student.id}\n                      onClick={() => toggleStudent(student.id)}\n                      className={cn(\n                        'p-3 border rounded-lg cursor-pointer transition-all flex items-center gap-3',\n                        selectedStudentIds.includes(student.id)\n                          ? 'border-brand-blue bg-brand-blue/5'\n                          : 'border-gray-200 hover:border-gray-300'\n                      )}\n                    >\n                      <div className=\"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-medium\">\n                        {student.photo_url ? (\n                          <img src={student.photo_url} alt=\"\" className=\"w-10 h-10 rounded-full object-cover\" />\n                        ) : (\n                          `${student.first_name?.[0]}${student.last_name?.[0]}`\n                        )}\n                      </div>\n                      <div className=\"flex-1\">\n                        <p className=\"font-medium text-gray-900\">{student.first_name} {student.last_name}</p>\n                        <p className=\"text-sm text-gray-600\">{student.email}</p>\n                      </div>\n                      {selectedStudentIds.includes(student.id) && (\n                        <CheckCircle2 className=\"h-5 w-5 text-brand-blue\" />\n                      )}\n                    </div>\n                  ))}\n                </div>\n              )}\n\n              {selectedStudentIds.length > 0 && (\n                <div className=\"mt-4 p-3 bg-brand-blue/5 rounded-lg\">\n                  <p className=\"text-sm text-brand-blue font-medium\">\n                    {selectedStudentIds.length} apprenant(s) sélectionné(s)\n                  </p>\n                </div>\n              )}\n\n              <div className=\"flex justify-between mt-6\">\n                <Button variant=\"outline\" onClick={() => setStep(2)}>\n                  Retour\n                </Button>\n                <Button \n                  onClick={handleCreate} \n                  disabled={selectedStudentIds.length === 0 || createMutation.isPending}\n                >\n                  {createMutation.isPending ? 'Création...' : `Créer ${selectedStudentIds.length} livret(s)`}\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      )}\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"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"}