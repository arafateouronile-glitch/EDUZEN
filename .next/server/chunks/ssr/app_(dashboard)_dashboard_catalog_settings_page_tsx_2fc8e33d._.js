module.exports=[774657,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(433217),e=a.i(370025),f=a.i(937927),g=a.i(913216),h=a.i(269240);let i=new class{supabase;constructor(a){this.supabase=a||(0,h.createClient)()}async getSettings(a){let{data:b,error:c}=await this.supabase.from("public_catalog_settings").select("*").eq("organization_id",a).maybeSingle();if(c)throw c;return b}async upsertSettings(a,b){if(await this.getSettings(a)){let{data:c,error:d}=await this.supabase.from("public_catalog_settings").update(b).eq("organization_id",a).select().single();if(d)throw d;return c}{let{data:c,error:d}=await this.supabase.from("public_catalog_settings").insert({organization_id:a,...b}).select().single();if(d)throw d;return c}}async getPublicSettings(a){let b=this.supabase.from("public_catalog_settings").select("*").eq("is_enabled",!0);a&&(b=b.eq("organization_id",a));let{data:c,error:d}=await b.maybeSingle();if(d)throw d;return c}async setEnabled(a,b){return this.upsertSettings(a,{is_enabled:b})}};var j=a.i(340695),k=a.i(703130),l=a.i(205522),m=a.i(917171),n=a.i(546893),o=a.i(280281),p=a.i(621958),q=a.i(864037),r=a.i(114548),s=a.i(773320),t=a.i(154347),u=a.i(244494),v=a.i(104720),w=a.i(992258),x=a.i(321161),y=a.i(452495),z=a.i(238246);function A(){let{user:a}=(0,g.useAuth)(),{addToast:A}=(0,q.useToast)(),B=(0,f.useQueryClient)(),C=(0,h.createClient)(),[D,E]=(0,c.useState)({is_enabled:!1,primary_color:"#274472",background_color:"#ffffff",text_color:"#000000",hero_button_text:"Découvrir nos formations",show_contact_form:!0}),{data:F}=(0,d.useQuery)({queryKey:["organization",a?.organization_id],queryFn:async()=>{if(!a?.organization_id)return null;let{data:b,error:c}=await C.from("organizations").select("*").eq("id",a.organization_id).maybeSingle();if(c)throw c;return b},enabled:!!a?.organization_id}),{data:G,isLoading:H}=(0,d.useQuery)({queryKey:["public-catalog-settings",a?.organization_id],queryFn:async()=>await i.getSettings(a?.organization_id),enabled:!!a?.organization_id});(0,c.useEffect)(()=>{(G||F)&&E({is_enabled:G?.is_enabled??!1,site_title:G?.site_title??F?.name??void 0,site_description:G?.site_description??void 0,site_keywords:G?.site_keywords??void 0,primary_color:G?.primary_color??"#274472",secondary_color:G?.secondary_color??void 0,accent_color:G?.accent_color??void 0,background_color:G?.background_color??"#ffffff",text_color:G?.text_color??"#000000",logo_url:G?.logo_url??F?.logo_url??void 0,favicon_url:G?.favicon_url??void 0,cover_image_url:G?.cover_image_url??void 0,footer_image_url:G?.footer_image_url??void 0,hero_title:G?.hero_title??F?.name??void 0,hero_subtitle:G?.hero_subtitle??void 0,hero_description:G?.hero_description??void 0,hero_button_text:G?.hero_button_text??"Découvrir nos formations",hero_button_link:G?.hero_button_link??"/programmes",about_title:G?.about_title??void 0,about_content:G?.about_content??void 0,about_image_url:G?.about_image_url??void 0,contact_email:G?.contact_email??F?.email??void 0,contact_phone:G?.contact_phone??F?.phone??void 0,contact_address:G?.contact_address??F?.address??void 0,show_contact_form:G?.show_contact_form??!0,footer_text:G?.footer_text??void 0,footer_links:G?.footer_links??void 0,social_links:G?.social_links??void 0,google_analytics_id:G?.google_analytics_id??void 0,google_tag_manager_id:G?.google_tag_manager_id??void 0,meta_title:G?.meta_title??F?.name??void 0,meta_description:G?.meta_description??void 0,meta_image_url:G?.meta_image_url??F?.logo_url??void 0,custom_domain:G?.custom_domain??void 0})},[G,F]);let I=(0,e.useMutation)({mutationFn:async b=>{if(!a?.organization_id)throw Error("Organization ID manquant");return i.upsertSettings(a.organization_id,b)},onSuccess:()=>{A({title:"Paramètres sauvegardés",description:"Les paramètres du catalogue public ont été sauvegardés avec succès.",type:"success"}),B.invalidateQueries({queryKey:["public-catalog-settings"]})},onError:a=>{A({title:"Erreur",description:a.message||"Une erreur est survenue lors de la sauvegarde.",type:"error"})}}),J=a=>{a.preventDefault(),I.mutate(D)},K=async(b,c)=>{if(a?.organization_id)try{let d=c.name.split(".").pop(),e=`${a.organization_id}/catalog/${b}/${Date.now()}.${d}`,{error:f}=await C.storage.from("organizations").upload(e,c,{upsert:!0});if(f)throw f;let{data:{publicUrl:g}}=C.storage.from("organizations").getPublicUrl(e);E(a=>({...a,[b]:g}))}catch(a){A({title:"Erreur d'upload",description:a.message||"Erreur lors de l'upload de l'image",type:"error"})}};return H?(0,b.jsx)("div",{className:"p-6",children:"Chargement..."}):(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Paramètres du site vitrine"}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Personnalisez votre catalogue public et votre site vitrine"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[F&&(0,b.jsx)(z.default,{href:`/cataloguepublic/${F.code||F.id}`,target:"_blank",rel:"noopener noreferrer",children:(0,b.jsxs)(j.Button,{variant:"outline",children:[(0,b.jsx)(y.ExternalLink,{className:"w-4 h-4 mr-2"}),"Voir le site public"]})}),(0,b.jsxs)(j.Button,{onClick:J,disabled:I.isPending,children:[(0,b.jsx)(r.Save,{className:"w-4 h-4 mr-2"}),"Enregistrer"]})]})]}),(0,b.jsx)("form",{onSubmit:J,children:(0,b.jsxs)(p.Tabs,{defaultValue:"general",className:"space-y-6",children:[(0,b.jsxs)(p.TabsList,{children:[(0,b.jsxs)(p.TabsTrigger,{value:"general",children:[(0,b.jsx)(x.Settings,{className:"w-4 h-4 mr-2"}),"Général"]}),(0,b.jsxs)(p.TabsTrigger,{value:"appearance",children:[(0,b.jsx)(t.Palette,{className:"w-4 h-4 mr-2"}),"Apparence"]}),(0,b.jsxs)(p.TabsTrigger,{value:"content",children:[(0,b.jsx)(v.FileText,{className:"w-4 h-4 mr-2"}),"Contenu"]}),(0,b.jsxs)(p.TabsTrigger,{value:"contact",children:[(0,b.jsx)(w.Mail,{className:"w-4 h-4 mr-2"}),"Contact"]}),(0,b.jsxs)(p.TabsTrigger,{value:"seo",children:[(0,b.jsx)(u.Globe,{className:"w-4 h-4 mr-2"}),"SEO"]})]}),(0,b.jsxs)(p.TabsContent,{value:"general",className:"space-y-6",children:[(0,b.jsxs)(k.Card,{children:[(0,b.jsxs)(k.CardHeader,{children:[(0,b.jsx)(k.CardTitle,{children:"Activation"}),(0,b.jsx)(k.CardDescription,{children:"Activez votre site vitrine pour le rendre accessible publiquement"})]}),(0,b.jsx)(k.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{children:"Site vitrine actif"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Rendre le site vitrine accessible publiquement"})]}),(0,b.jsx)(o.Switch,{checked:D.is_enabled,onCheckedChange:a=>E(b=>({...b,is_enabled:a}))})]})})]}),(0,b.jsxs)(k.Card,{children:[(0,b.jsx)(k.CardHeader,{children:(0,b.jsx)(k.CardTitle,{children:"Informations de base"})}),(0,b.jsxs)(k.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"site_title",children:"Titre du site"}),(0,b.jsx)(l.Input,{id:"site_title",value:D.site_title||"",onChange:a=>E(b=>({...b,site_title:a.target.value})),placeholder:"Ex: Formations Professionnelles - Mon Organisme"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"site_description",children:"Description"}),(0,b.jsx)(n.Textarea,{id:"site_description",value:D.site_description||"",onChange:a=>E(b=>({...b,site_description:a.target.value})),placeholder:"Description du site pour le SEO",rows:3})]})]})]})]}),(0,b.jsxs)(p.TabsContent,{value:"appearance",className:"space-y-6",children:[(0,b.jsxs)(k.Card,{children:[(0,b.jsxs)(k.CardHeader,{children:[(0,b.jsx)(k.CardTitle,{children:"Couleurs"}),(0,b.jsx)(k.CardDescription,{children:"Personnalisez les couleurs de votre site vitrine"})]}),(0,b.jsx)(k.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"primary_color",children:"Couleur principale"}),(0,b.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,b.jsx)(l.Input,{id:"primary_color",type:"color",value:D.primary_color,onChange:a=>E(b=>({...b,primary_color:a.target.value})),className:"w-16 h-10"}),(0,b.jsx)(l.Input,{value:D.primary_color,onChange:a=>E(b=>({...b,primary_color:a.target.value})),placeholder:"#274472"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"secondary_color",children:"Couleur secondaire"}),(0,b.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,b.jsx)(l.Input,{id:"secondary_color",type:"color",value:D.secondary_color||"#ffffff",onChange:a=>E(b=>({...b,secondary_color:a.target.value})),className:"w-16 h-10"}),(0,b.jsx)(l.Input,{value:D.secondary_color||"",onChange:a=>E(b=>({...b,secondary_color:a.target.value})),placeholder:"#ffffff"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"accent_color",children:"Couleur d'accent"}),(0,b.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,b.jsx)(l.Input,{id:"accent_color",type:"color",value:D.accent_color||"#274472",onChange:a=>E(b=>({...b,accent_color:a.target.value})),className:"w-16 h-10"}),(0,b.jsx)(l.Input,{value:D.accent_color||"",onChange:a=>E(b=>({...b,accent_color:a.target.value})),placeholder:"#274472"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"background_color",children:"Couleur de fond"}),(0,b.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,b.jsx)(l.Input,{id:"background_color",type:"color",value:D.background_color,onChange:a=>E(b=>({...b,background_color:a.target.value})),className:"w-16 h-10"}),(0,b.jsx)(l.Input,{value:D.background_color,onChange:a=>E(b=>({...b,background_color:a.target.value})),placeholder:"#ffffff"})]})]})]})})]}),(0,b.jsxs)(k.Card,{children:[(0,b.jsx)(k.CardHeader,{children:(0,b.jsx)(k.CardTitle,{children:"Images"})}),(0,b.jsxs)(k.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{children:"Logo"}),(0,b.jsxs)("div",{className:"flex gap-4 mt-2",children:[D.logo_url&&(0,b.jsx)("img",{src:D.logo_url,alt:"Logo",className:"h-20 w-auto object-contain border rounded"}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Input,{type:"file",accept:"image/*",onChange:a=>{let b=a.target.files?.[0];b&&K("logo_url",b)},className:"hidden",id:"logo-upload"}),(0,b.jsxs)(j.Button,{type:"button",variant:"outline",onClick:()=>document.getElementById("logo-upload")?.click(),children:[(0,b.jsx)(s.Upload,{className:"w-4 h-4 mr-2"}),D.logo_url?"Changer le logo":"Uploader un logo"]})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{children:"Image de couverture (Hero)"}),(0,b.jsxs)("div",{className:"flex gap-4 mt-2",children:[D.cover_image_url&&(0,b.jsx)("img",{src:D.cover_image_url,alt:"Cover",className:"h-32 w-auto object-cover border rounded"}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Input,{type:"file",accept:"image/*",onChange:a=>{let b=a.target.files?.[0];b&&K("cover_image_url",b)},className:"hidden",id:"cover-upload"}),(0,b.jsxs)(j.Button,{type:"button",variant:"outline",onClick:()=>document.getElementById("cover-upload")?.click(),children:[(0,b.jsx)(s.Upload,{className:"w-4 h-4 mr-2"}),D.cover_image_url?"Changer l'image":"Uploader une image"]})]})]})]})]})]})]}),(0,b.jsxs)(p.TabsContent,{value:"content",className:"space-y-6",children:[(0,b.jsxs)(k.Card,{children:[(0,b.jsxs)(k.CardHeader,{children:[(0,b.jsx)(k.CardTitle,{children:"Section Hero"}),(0,b.jsx)(k.CardDescription,{children:"En-tête principal de votre site"})]}),(0,b.jsxs)(k.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"hero_title",children:"Titre principal"}),(0,b.jsx)(l.Input,{id:"hero_title",value:D.hero_title||"",onChange:a=>E(b=>({...b,hero_title:a.target.value})),placeholder:"Ex: Formations Professionnelles de Qualité"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"hero_subtitle",children:"Sous-titre"}),(0,b.jsx)(l.Input,{id:"hero_subtitle",value:D.hero_subtitle||"",onChange:a=>E(b=>({...b,hero_subtitle:a.target.value})),placeholder:"Ex: Développez vos compétences"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"hero_description",children:"Description"}),(0,b.jsx)(n.Textarea,{id:"hero_description",value:D.hero_description||"",onChange:a=>E(b=>({...b,hero_description:a.target.value})),placeholder:"Description de votre organisme",rows:4})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"hero_button_text",children:"Texte du bouton"}),(0,b.jsx)(l.Input,{id:"hero_button_text",value:D.hero_button_text||"",onChange:a=>E(b=>({...b,hero_button_text:a.target.value}))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"hero_button_link",children:"Lien du bouton"}),(0,b.jsx)(l.Input,{id:"hero_button_link",value:D.hero_button_link||"",onChange:a=>E(b=>({...b,hero_button_link:a.target.value})),placeholder:"/programmes"})]})]})]})]}),(0,b.jsxs)(k.Card,{children:[(0,b.jsx)(k.CardHeader,{children:(0,b.jsx)(k.CardTitle,{children:"Section À propos"})}),(0,b.jsxs)(k.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"about_title",children:"Titre"}),(0,b.jsx)(l.Input,{id:"about_title",value:D.about_title||"",onChange:a=>E(b=>({...b,about_title:a.target.value}))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"about_content",children:"Contenu"}),(0,b.jsx)(n.Textarea,{id:"about_content",value:D.about_content||"",onChange:a=>E(b=>({...b,about_content:a.target.value})),rows:6})]})]})]})]}),(0,b.jsx)(p.TabsContent,{value:"contact",className:"space-y-6",children:(0,b.jsxs)(k.Card,{children:[(0,b.jsx)(k.CardHeader,{children:(0,b.jsx)(k.CardTitle,{children:"Informations de contact"})}),(0,b.jsxs)(k.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"contact_email",children:"Email"}),(0,b.jsx)(l.Input,{id:"contact_email",type:"email",value:D.contact_email||"",onChange:a=>E(b=>({...b,contact_email:a.target.value}))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"contact_phone",children:"Téléphone"}),(0,b.jsx)(l.Input,{id:"contact_phone",value:D.contact_phone||"",onChange:a=>E(b=>({...b,contact_phone:a.target.value}))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"contact_address",children:"Adresse"}),(0,b.jsx)(n.Textarea,{id:"contact_address",value:D.contact_address||"",onChange:a=>E(b=>({...b,contact_address:a.target.value})),rows:3})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{children:"Formulaire de contact"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Afficher un formulaire de contact sur le site"})]}),(0,b.jsx)(o.Switch,{checked:D.show_contact_form??!0,onCheckedChange:a=>E(b=>({...b,show_contact_form:a}))})]})]})]})}),(0,b.jsx)(p.TabsContent,{value:"seo",className:"space-y-6",children:(0,b.jsxs)(k.Card,{children:[(0,b.jsx)(k.CardHeader,{children:(0,b.jsx)(k.CardTitle,{children:"Métadonnées SEO"})}),(0,b.jsxs)(k.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"meta_title",children:"Titre SEO"}),(0,b.jsx)(l.Input,{id:"meta_title",value:D.meta_title||"",onChange:a=>E(b=>({...b,meta_title:a.target.value}))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"meta_description",children:"Description SEO"}),(0,b.jsx)(n.Textarea,{id:"meta_description",value:D.meta_description||"",onChange:a=>E(b=>({...b,meta_description:a.target.value})),rows:3})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Label,{htmlFor:"google_analytics_id",children:"Google Analytics ID"}),(0,b.jsx)(l.Input,{id:"google_analytics_id",value:D.google_analytics_id||"",onChange:a=>E(b=>({...b,google_analytics_id:a.target.value})),placeholder:"G-XXXXXXXXXX"})]})]})]})})]})})]})}a.s(["default",()=>A],774657)}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_catalog_settings_page_tsx_2fc8e33d._.js.map