{"version":3,"sources":["../../../../app/%28dashboard%29/dashboard/payments/%5Bid%5D/page.tsx"],"sourcesContent":["'use client'\n\nimport { useParams, useRouter } from 'next/navigation'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { invoiceService } from '@/lib/services/invoice.service'\nimport { paymentService } from '@/lib/services/payment.service'\nimport { useAuth } from '@/lib/hooks/use-auth'\nimport { createClient } from '@/lib/supabase/client'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { ArrowLeft, Plus, DollarSign, Calendar, FileText, CheckCircle, XCircle, Clock, CreditCard, Building2, Download, Receipt } from 'lucide-react'\nimport Link from 'next/link'\nimport { formatCurrency, formatDate, formatDateTime } from '@/lib/utils'\nimport { useState } from 'react'\nimport { useToast } from '@/components/ui/toast'\nimport type { TableRow } from '@/lib/types/supabase-helpers'\nimport { documentTemplateService } from '@/lib/services/document-template.service'\nimport { generateHTML } from '@/lib/utils/document-generation/html-generator'\nimport { extractDocumentVariables, mapDocumentTypeToTemplateType } from '@/lib/utils/document-generation/variable-extractor'\nimport { generatePDFFromHTML } from '@/lib/utils/pdf-generator'\nimport type { StudentWithRelations, InvoiceWithRelations } from '@/lib/types/query-types'\n\ntype Payment = TableRow<'payments'>\n\nexport default function InvoiceDetailPage() {\n  const params = useParams()\n  const router = useRouter()\n  const invoiceId = params.id as string\n  const { user } = useAuth()\n  const { addToast } = useToast()\n  const supabase = createClient()\n  const queryClient = useQueryClient()\n  const [showPaymentForm, setShowPaymentForm] = useState(false)\n  const [showStripeForm, setShowStripeForm] = useState(false)\n  const [showSEPAForm, setShowSEPAForm] = useState(false)\n  const [showCreditNoteForm, setShowCreditNoteForm] = useState(false)\n  const [isDownloadingInvoice, setIsDownloadingInvoice] = useState(false)\n\n  // Récupérer la facture\n  const { data: invoice, isLoading, refetch } = useQuery<InvoiceWithRelations>({\n    queryKey: ['invoice', invoiceId],\n    queryFn: () => invoiceService.getById(invoiceId) as Promise<InvoiceWithRelations>,\n  })\n\n  // Récupérer les paiements\n  const { data: payments, refetch: refetchPayments } = useQuery({\n    queryKey: ['payments', invoiceId],\n    queryFn: async () => {\n      if (!user?.organization_id) return []\n      return paymentService.getAll(user.organization_id, { invoiceId })\n    },\n    enabled: !!invoiceId && !!user?.organization_id,\n  })\n\n  // Récupérer l'organisation\n  const { data: organization } = useQuery({\n    queryKey: ['organization', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return null\n      const { data, error } = await supabase\n        .from('organizations')\n        .select('*')\n        .eq('id', user.organization_id)\n        .single()\n      if (error) throw error\n      return data\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  // Récupérer l'année académique actuelle\n  const { data: academicYear } = useQuery({\n    queryKey: ['academic-year', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return null\n      const { data, error } = await supabase\n        .from('academic_years')\n        .select('*')\n        .eq('organization_id', user.organization_id)\n        .eq('is_current', true)\n        .maybeSingle()\n      if (error) {\n        console.warn('Erreur lors de la récupération de l\\'année académique:', error)\n        return null\n      }\n      return data || null\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  // Récupérer le template de facture par défaut\n  const { data: invoiceTemplate } = useQuery({\n    queryKey: ['invoice-template', user?.organization_id],\n    queryFn: async () => {\n      if (!user?.organization_id) return null\n      const templates = await documentTemplateService.getTemplatesByType(\n        'facture',\n        user.organization_id\n      )\n      return templates.length > 0 ? templates[0] : null\n    },\n    enabled: !!user?.organization_id,\n  })\n\n  // Formulaire de paiement\n  const [paymentForm, setPaymentForm] = useState({\n    amount: '',\n    currency: invoice?.currency || 'EUR',\n    payment_method: 'cash' as 'cash' | 'card' | 'bank_transfer' | 'sepa',\n    payment_provider: 'stripe' as 'stripe' | 'sepa',\n    transaction_id: '',\n    notes: '',\n  })\n\n  // Formulaire d'avoir\n  const [creditNoteForm, setCreditNoteForm] = useState({\n    amount: '',\n    reason: '',\n    notes: '',\n  })\n\n  // Calculer remainingAmount (doit être fait avant les hooks useMutation)\n  const totalPaid =\n    payments\n      ?.filter((p: any) => p.status === 'completed')\n      .reduce((sum: number, p: any) => sum + Number(p.amount), 0) || 0\n  const remainingAmount = invoice ? Number(invoice.total_amount) - totalPaid : 0\n\n  const recordPaymentMutation = useMutation({\n    mutationFn: async () => {\n      if (!invoice) throw new Error('Facture non trouvée')\n\n      const amountNumber = parseFloat(paymentForm.amount)\n\n      if (isNaN(amountNumber) || amountNumber <= 0) {\n        throw new Error('Montant de paiement invalide')\n      }\n\n      // Recalculer remainingAmount dans la fonction pour être sûr\n      const currentTotalPaid =\n        payments\n          ?.filter((p: any) => p.status === 'completed')\n          .reduce((sum: number, p: any) => sum + Number(p.amount), 0) || 0\n      const currentRemainingAmount = Number(invoice.total_amount) - currentTotalPaid\n\n      if (amountNumber > currentRemainingAmount) {\n        throw new Error(\"Le montant du paiement ne peut pas dépasser le reste à payer\")\n      }\n\n      const isCompleted = paymentForm.payment_method === 'cash'\n      const paidAt = isCompleted ? new Date().toISOString() : null\n      \n      return paymentService.create({\n        organization_id: invoice.organization_id,\n        invoice_id: invoiceId,\n        student_id: invoice.student_id,\n        amount: amountNumber,\n        currency: paymentForm.currency,\n        payment_method: paymentForm.payment_method,\n        payment_provider:\n          paymentForm.payment_method === 'card' || paymentForm.payment_method === 'sepa'\n            ? paymentForm.payment_provider\n            : null,\n        transaction_id: paymentForm.transaction_id || null,\n        status: isCompleted ? 'completed' : 'pending',\n        paid_at: paidAt,\n        metadata: {\n          notes: paymentForm.notes,\n        },\n      })\n    },\n    onSuccess: () => {\n      addToast({\n        type: 'success',\n        title: 'Paiement enregistré',\n        description: 'Le paiement a bien été enregistré et les totaux ont été mis à jour.',\n      })\n      setShowPaymentForm(false)\n      setPaymentForm({\n        amount: '',\n        currency: invoice?.currency || 'EUR',\n        payment_method: 'cash',\n        payment_provider: 'stripe',\n        transaction_id: '',\n        notes: '',\n      })\n      \n      refetch()\n      refetchPayments()\n      \n      // Forcer le rafraîchissement immédiat des queries du tableau de bord pour synchroniser les revenus\n      queryClient.refetchQueries({ queryKey: ['dashboard-stats', user?.organization_id] })\n      queryClient.refetchQueries({ queryKey: ['revenue-evolution', user?.organization_id] })\n      queryClient.refetchQueries({ queryKey: ['payment-stats', user?.organization_id] })\n      \n      queryClient.invalidateQueries({ queryKey: ['invoices'] })\n      queryClient.invalidateQueries({ queryKey: ['overdue-invoices'] })\n    },\n    onError: (error: any) => {\n      addToast({\n        type: 'error',\n        title: 'Erreur lors de lenregistrement du paiement',\n        description: error?.message || 'Veuillez vérifier les informations saisies.',\n      })\n    },\n  })\n\n  // Mutation pour créer un avoir (doit être avant les returns conditionnels)\n  const createCreditNoteMutation = useMutation({\n    mutationFn: async () => {\n      if (!invoice) throw new Error('Facture non trouvée')\n\n      const amountNumber = parseFloat(creditNoteForm.amount)\n\n      if (isNaN(amountNumber) || amountNumber <= 0) {\n        throw new Error('Montant de l\\'avoir invalide')\n      }\n\n      if (amountNumber > Number(invoice.total_amount)) {\n        throw new Error(\"Le montant de l'avoir ne peut pas dépasser le montant total de la facture\")\n      }\n\n      // Créer un avoir (pour l'instant, on le stocke comme une facture avec un type spécial)\n      // TODO: Créer une table credit_notes dans la base de données\n      const { data, error } = await supabase\n        .from('invoices')\n        .insert({\n          organization_id: invoice.organization_id,\n          student_id: invoice.student_id,\n          invoice_number: `AVOIR-${invoice.invoice_number}`,\n          type: 'credit_note',\n          document_type: 'invoice',\n          issue_date: new Date().toISOString().split('T')[0],\n          due_date: new Date().toISOString().split('T')[0],\n          amount: -amountNumber, // Montant négatif pour un avoir\n          tax_amount: 0,\n          total_amount: -amountNumber,\n          currency: invoice.currency,\n          status: 'sent',\n          notes: `Avoir pour la facture ${invoice.invoice_number}. Raison: ${creditNoteForm.reason}. ${creditNoteForm.notes}`,\n          metadata: {\n            original_invoice_id: invoice.id,\n            reason: creditNoteForm.reason,\n            notes: creditNoteForm.notes,\n          },\n        })\n        .select()\n        .single()\n\n      if (error) throw error\n      return data\n    },\n    onSuccess: () => {\n      addToast({\n        type: 'success',\n        title: 'Avoir créé',\n        description: 'L\\'avoir a été créé avec succès.',\n      })\n      setShowCreditNoteForm(false)\n      setCreditNoteForm({\n        amount: '',\n        reason: '',\n        notes: '',\n      })\n      refetch()\n      queryClient.invalidateQueries({ queryKey: ['invoices'] })\n    },\n    onError: (error: any) => {\n      addToast({\n        type: 'error',\n        title: 'Erreur lors de la création de l\\'avoir',\n        description: error?.message || 'Veuillez vérifier les informations saisies.',\n      })\n    },\n  })\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"text-muted-foreground\">Chargement...</div>\n        </div>\n      </div>\n    )\n  }\n\n  if (!invoice) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"text-muted-foreground\">Facture non trouvée</div>\n          <Link href=\"/dashboard/payments\">\n            <Button className=\"mt-4\">Retour à la liste</Button>\n          </Link>\n        </div>\n      </div>\n    )\n  }\n\n  // remainingAmount est déjà calculé avant les returns conditionnels\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'paid':\n        return 'bg-success-bg text-success-primary'\n      case 'sent':\n        return 'bg-blue-100 text-blue-800'\n      case 'partial':\n        return 'bg-warning-bg text-warning-primary'\n      case 'overdue':\n        return 'bg-red-100 text-red-800'\n      case 'draft':\n        return 'bg-gray-100 text-gray-800'\n      default:\n        return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  const getStatusLabel = (status: string) => {\n    switch (status) {\n      case 'paid':\n        return 'Payée'\n      case 'sent':\n        return 'Envoyée'\n      case 'partial':\n        return 'Partielle'\n      case 'overdue':\n        return 'En retard'\n      case 'draft':\n        return 'Brouillon'\n      default:\n        return status\n    }\n  }\n\n  const getPaymentStatusIcon = (status: string) => {\n    switch (status) {\n      case 'completed':\n        return <CheckCircle className=\"h-5 w-5 text-success-primary\" />\n      case 'failed':\n        return <XCircle className=\"h-5 w-5 text-red-600\" />\n      case 'pending':\n      case 'processing':\n        return <Clock className=\"h-5 w-5 text-warning-primary\" />\n      default:\n        return null\n    }\n  }\n\n  const getPaymentMethodLabel = (method: string) => {\n    switch (method) {\n      case 'cash':\n        return 'Espèces'\n      case 'card':\n        return 'Carte bancaire'\n      case 'bank_transfer':\n        return 'Virement bancaire'\n      case 'sepa':\n        return 'Virement SEPA'\n      default:\n        return method\n    }\n  }\n\n  // Fonction pour télécharger la facture\n  const handleDownloadInvoice = async () => {\n    if (!invoice || !organization || !invoiceTemplate) {\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: 'Impossible de générer la facture. Données manquantes.',\n      })\n      return\n    }\n\n    setIsDownloadingInvoice(true)\n\n    try {\n      // Extraire les variables\n      const student = invoice.students as StudentWithRelations | undefined\n      const invoiceData = invoice as InvoiceWithRelations\n\n      const variables = extractDocumentVariables({\n        student,\n        organization: organization as any,\n        session: undefined,\n        invoice: invoiceData,\n        academicYear,\n        language: 'fr',\n        issueDate: invoice.issue_date ?? undefined,\n      })\n\n      // Générer le HTML avec le template\n      const result = await generateHTML(\n        invoiceTemplate,\n        variables,\n        undefined,\n        user?.organization_id || undefined\n      )\n\n      // Générer le nom de fichier\n      const filename = `facture_${invoice.invoice_number}.pdf`\n\n      // Créer un élément temporaire avec les bonnes dimensions pour la génération PDF\n      const tempDiv = document.createElement('div')\n      tempDiv.style.position = 'absolute'\n      tempDiv.style.left = '-9999px'\n      tempDiv.style.top = '0'\n      tempDiv.style.width = '794px'\n      tempDiv.style.minHeight = '1123px'\n      tempDiv.style.backgroundColor = '#ffffff'\n      tempDiv.style.overflow = 'visible'\n      tempDiv.style.fontFamily = 'Arial, sans-serif'\n      document.body.appendChild(tempDiv)\n\n      // Extraire le contenu du body\n      const parser = new DOMParser()\n      const doc = parser.parseFromString(result.html, 'text/html')\n      const bodyContent = doc.body.innerHTML\n      tempDiv.innerHTML = bodyContent\n\n      // Trouver l'élément principal du document\n      let element = tempDiv.querySelector('.document-container') || tempDiv.querySelector('[id$=\"-document\"]') || tempDiv.firstElementChild\n\n      if (!element || !(element instanceof HTMLElement)) {\n        element = tempDiv\n      }\n\n      const elementId = `temp-pdf-invoice-${Date.now()}`\n      if (element instanceof HTMLElement) {\n        element.id = elementId\n        if (!element.style.width) {\n          element.style.width = '794px'\n        }\n        if (!element.style.minHeight) {\n          element.style.minHeight = '1123px'\n        }\n        element.style.backgroundColor = '#ffffff'\n      }\n\n      // Attendre que le DOM soit mis à jour\n      await new Promise((resolve) => setTimeout(resolve, 1000))\n\n      // Vérifier que l'élément est visible\n      if (element instanceof HTMLElement) {\n        const rect = element.getBoundingClientRect()\n        if (rect.width === 0 || rect.height === 0) {\n          element = tempDiv\n          tempDiv.id = elementId\n          tempDiv.style.width = '794px'\n          tempDiv.style.minHeight = '1123px'\n        }\n      }\n\n      await generatePDFFromHTML(elementId, filename)\n\n      addToast({\n        type: 'success',\n        title: 'Facture téléchargée',\n        description: 'La facture a été générée et téléchargée avec succès.',\n      })\n    } catch (error) {\n      console.error('Erreur lors de la génération de la facture:', error)\n      addToast({\n        type: 'error',\n        title: 'Erreur',\n        description: 'Une erreur est survenue lors de la génération de la facture.',\n      })\n    } finally {\n      setIsDownloadingInvoice(false)\n      // Nettoyer l'élément temporaire\n      const tempDivs = document.querySelectorAll('[id^=\"temp-pdf-invoice-\"]')\n      tempDivs.forEach((div) => {\n        if (div.parentNode === document.body) {\n          document.body.removeChild(div)\n        }\n      })\n    }\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center space-x-4\">\n          <Link href=\"/dashboard/payments\">\n            <Button variant=\"ghost\" size=\"icon\">\n              <ArrowLeft className=\"h-4 w-4\" />\n            </Button>\n          </Link>\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">\n              Facture {invoice.invoice_number}\n            </h1>\n            <p className=\"mt-2 text-sm text-gray-600\">\n              {invoice.students?.first_name} {invoice.students?.last_name}\n            </p>\n          </div>\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          <Button\n            variant=\"outline\"\n            onClick={handleDownloadInvoice}\n            disabled={isDownloadingInvoice || !invoiceTemplate}\n          >\n            <Download className=\"mr-2 h-4 w-4\" />\n            {isDownloadingInvoice ? 'Génération...' : 'Télécharger la facture'}\n          </Button>\n          {remainingAmount > 0 && (\n            <>\n              <Button onClick={() => setShowPaymentForm(!showPaymentForm)}>\n                <Plus className=\"mr-2 h-4 w-4\" />\n                Enregistrer un paiement\n              </Button>\n              <Button variant=\"outline\" onClick={() => setShowStripeForm(!showStripeForm)}>\n                <CreditCard className=\"mr-2 h-4 w-4\" />\n                Payer par carte\n              </Button>\n              <Button variant=\"outline\" onClick={() => setShowSEPAForm(!showSEPAForm)}>\n                <Building2 className=\"mr-2 h-4 w-4\" />\n                Virement SEPA\n              </Button>\n            </>\n          )}\n          <Button variant=\"outline\" onClick={() => setShowCreditNoteForm(!showCreditNoteForm)}>\n            <Receipt className=\"mr-2 h-4 w-4\" />\n            Créer un avoir\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Informations principales */}\n        <div className=\"lg:col-span-2 space-y-6\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <CardTitle>Détails de la facture</CardTitle>\n                <span className={`px-3 py-1 rounded text-sm font-medium ${getStatusColor(invoice.status || 'pending')}`}>\n                  {getStatusLabel(invoice.status || 'pending')}\n                </span>\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground flex items-center mb-2\">\n                    <FileText className=\"mr-2 h-4 w-4\" />\n                    Numéro\n                  </p>\n                  <p className=\"font-medium\">{invoice.invoice_number}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground flex items-center mb-2\">\n                    <Calendar className=\"mr-2 h-4 w-4\" />\n                    Type\n                  </p>\n                  <p className=\"font-medium capitalize\">{invoice.type}</p>\n                </div>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Date d'émission</p>\n                  <p className=\"font-medium\">{formatDate(invoice.issue_date || '')}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Date d'échéance</p>\n                  <p className={`font-medium ${invoice.due_date && invoice.due_date < new Date().toISOString().split('T')[0] && invoice.status !== 'paid' ? 'text-red-600' : ''}`}>\n                    {formatDate(invoice.due_date || '')}\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"bg-gray-50 p-4 rounded-lg space-y-2\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-muted-foreground\">Montant HT:</span>\n                  <span className=\"font-medium\">{formatCurrency(Number(invoice.amount), invoice.currency)}</span>\n                </div>\n                {Number(invoice.tax_amount) > 0 && (\n                  <div className=\"flex justify-between\">\n                    <span className=\"text-muted-foreground\">TVA:</span>\n                    <span className=\"font-medium\">{formatCurrency(Number(invoice.tax_amount), invoice.currency)}</span>\n                  </div>\n                )}\n                <div className=\"flex justify-between pt-2 border-t\">\n                  <span className=\"font-semibold\">Total TTC:</span>\n                  <span className=\"font-bold text-lg\">{formatCurrency(Number(invoice.total_amount), invoice.currency)}</span>\n                </div>\n                {totalPaid > 0 && (\n                  <>\n                    <div className=\"flex justify-between pt-2 border-t\">\n                      <span className=\"text-muted-foreground\">Total payé:</span>\n                      <span className=\"font-medium text-success-primary\">{formatCurrency(totalPaid, invoice.currency)}</span>\n                    </div>\n                    {remainingAmount > 0 && (\n                      <div className=\"flex justify-between pt-2 border-t\">\n                        <span className=\"font-semibold\">Reste à payer:</span>\n                        <span className=\"font-bold text-lg text-red-600\">\n                          {formatCurrency(remainingAmount, invoice.currency)}\n                        </span>\n                      </div>\n                    )}\n                  </>\n                )}\n              </div>\n\n              {invoice.notes && (\n                <div>\n                  <p className=\"text-sm text-muted-foreground mb-2\">Notes</p>\n                  <p className=\"text-gray-700 whitespace-pre-wrap\">{invoice.notes}</p>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {/* Historique des paiements */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Historique des paiements</CardTitle>\n            </CardHeader>\n            <CardContent>\n              {payments && payments.length > 0 ? (\n                <div className=\"space-y-4\">\n                  {payments.map((payment: any) => (\n                    <div\n                      key={payment.id}\n                      className=\"flex items-center justify-between p-4 border rounded-lg\"\n                    >\n                      <div className=\"flex items-center space-x-4\">\n                        {getPaymentStatusIcon(payment.status)}\n                        <div>\n                          <p className=\"font-semibold\">\n                            {formatCurrency(Number(payment.amount), payment.currency)}\n                          </p>\n                          <p className=\"text-sm text-muted-foreground\">\n                            {getPaymentMethodLabel(payment.payment_method)}\n                            {payment.payment_provider && ` - ${payment.payment_provider.toUpperCase()}`}\n                          </p>\n                          {payment.transaction_id && (\n                            <p className=\"text-xs text-muted-foreground\">\n                              Transaction: {payment.transaction_id}\n                            </p>\n                          )}\n                        </div>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-sm text-muted-foreground\">\n                          {payment.paid_at\n                            ? formatDateTime(payment.paid_at)\n                            : formatDateTime(payment.created_at)}\n                        </p>\n                        <span\n                          className={`inline-block px-2 py-1 rounded text-xs mt-1 ${\n                            payment.status === 'completed'\n                              ? 'bg-success-bg text-success-primary'\n                              : payment.status === 'failed'\n                              ? 'bg-red-100 text-red-800'\n                              : 'bg-warning-bg text-warning-primary'\n                          }`}\n                        >\n                          {payment.status === 'completed'\n                            ? 'Complété'\n                            : payment.status === 'failed'\n                            ? 'Échoué'\n                            : payment.status === 'pending'\n                            ? 'En attente'\n                            : payment.status}\n                        </span>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <div className=\"text-center py-8 text-muted-foreground\">\n                  Aucun paiement enregistré\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Formulaire de paiement */}\n        {showPaymentForm && remainingAmount > 0 && (\n          <div className=\"lg:col-span-1\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Enregistrer un paiement</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <form\n                  onSubmit={(e) => {\n                    e.preventDefault()\n                    recordPaymentMutation.mutate()\n                  }}\n                  className=\"space-y-4\"\n                >\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">Montant *</label>\n                    <input\n                      type=\"number\"\n                      required\n                      step=\"0.01\"\n                      min=\"0.01\"\n                      max={remainingAmount}\n                      value={paymentForm.amount}\n                      onChange={(e) =>\n                        setPaymentForm({ ...paymentForm, amount: e.target.value })\n                      }\n                      className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target\"\n                      placeholder={remainingAmount.toString()}\n                    />\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      Reste à payer: {formatCurrency(remainingAmount, invoice.currency)}\n                    </p>\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">Méthode de paiement *</label>\n                    <select\n                      required\n                      value={paymentForm.payment_method || ''}\n                      onChange={(e) =>\n                        setPaymentForm({\n                          ...paymentForm,\n                          payment_method: e.target.value as 'cash' | 'card' | 'bank_transfer' | 'sepa',\n                        })\n                      }\n                      className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target\"\n                    >\n                      <option value=\"cash\">Espèces</option>\n                      <option value=\"card\">Carte bancaire (Stripe)</option>\n                      <option value=\"sepa\">Virement SEPA</option>\n                      <option value=\"bank_transfer\">Virement bancaire</option>\n                    </select>\n                  </div>\n\n                  {paymentForm.payment_method === 'card' && (\n                    <div>\n                      <label className=\"block text-sm font-medium mb-2\">Fournisseur *</label>\n                      <select\n                        required\n                        value={paymentForm.payment_provider || ''}\n                        onChange={(e) =>\n                          setPaymentForm({\n                            ...paymentForm,\n                            payment_provider: (e.target.value || 'stripe') as 'sepa' | 'stripe',\n                          })\n                        }\n                        className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target\"\n                      >\n                        <option value=\"stripe\">Stripe</option>\n                      </select>\n                    </div>\n                  )}\n                  \n                  {paymentForm.payment_method === 'sepa' && (\n                    <div>\n                      <label className=\"block text-sm font-medium mb-2\">Fournisseur *</label>\n                      <select\n                        required\n                        value={paymentForm.payment_provider || ''}\n                        onChange={(e) =>\n                          setPaymentForm({\n                            ...paymentForm,\n                            payment_provider: (e.target.value || 'stripe') as 'sepa' | 'stripe',\n                          })\n                        }\n                        className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target\"\n                      >\n                        <option value=\"sepa\">SEPA</option>\n                      </select>\n                    </div>\n                  )}\n\n                  {paymentForm.payment_method !== 'cash' && (\n                    <div>\n                      <label className=\"block text-sm font-medium mb-2\">ID de transaction</label>\n                      <input\n                        type=\"text\"\n                        value={paymentForm.transaction_id}\n                        onChange={(e) =>\n                          setPaymentForm({ ...paymentForm, transaction_id: e.target.value })\n                        }\n                        className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target\"\n                        placeholder=\"ID de la transaction\"\n                      />\n                    </div>\n                  )}\n\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">Notes</label>\n                    <textarea\n                      value={paymentForm.notes}\n                      onChange={(e) =>\n                        setPaymentForm({ ...paymentForm, notes: e.target.value })\n                      }\n                      rows={2}\n                      className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                      placeholder=\"Notes supplémentaires...\"\n                    />\n                  </div>\n\n                  {recordPaymentMutation.error && (\n                    <div className=\"bg-destructive/10 text-destructive px-4 py-3 rounded-lg text-sm\">\n                      {recordPaymentMutation.error instanceof Error\n                        ? recordPaymentMutation.error.message\n                        : 'Une erreur est survenue'}\n                    </div>\n                  )}\n\n                  <div className=\"flex space-x-2\">\n                    <Button\n                      type=\"button\"\n                      variant=\"outline\"\n                      className=\"flex-1\"\n                      onClick={() => setShowPaymentForm(false)}\n                    >\n                      Annuler\n                    </Button>\n                    <Button type=\"submit\" className=\"flex-1\" disabled={recordPaymentMutation.isPending}>\n                      {recordPaymentMutation.isPending ? 'Enregistrement...' : 'Enregistrer'}\n                    </Button>\n                  </div>\n                </form>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Formulaire d'avoir */}\n        {showCreditNoteForm && (\n          <div className=\"lg:col-span-1\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Créer un avoir</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <form\n                  onSubmit={(e) => {\n                    e.preventDefault()\n                    createCreditNoteMutation.mutate()\n                  }}\n                  className=\"space-y-4\"\n                >\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">Montant de l'avoir *</label>\n                    <input\n                      type=\"number\"\n                      required\n                      step=\"0.01\"\n                      min=\"0.01\"\n                      max={Number(invoice.total_amount)}\n                      value={creditNoteForm.amount}\n                      onChange={(e) =>\n                        setCreditNoteForm({ ...creditNoteForm, amount: e.target.value })\n                      }\n                      className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target\"\n                      placeholder=\"0.00\"\n                    />\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      Montant total de la facture: {formatCurrency(Number(invoice.total_amount), invoice.currency)}\n                    </p>\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">Raison de l'avoir *</label>\n                    <select\n                      required\n                      value={creditNoteForm.reason}\n                      onChange={(e) =>\n                        setCreditNoteForm({ ...creditNoteForm, reason: e.target.value })\n                      }\n                      className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target\"\n                    >\n                      <option value=\"\">Sélectionner une raison</option>\n                      <option value=\"retour_produit\">Retour de produit/service</option>\n                      <option value=\"erreur_facturation\">Erreur de facturation</option>\n                      <option value=\"remise_commerciale\">Remise commerciale</option>\n                      <option value=\"annulation\">Annulation de commande</option>\n                      <option value=\"autre\">Autre</option>\n                    </select>\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium mb-2\">Notes</label>\n                    <textarea\n                      value={creditNoteForm.notes}\n                      onChange={(e) =>\n                        setCreditNoteForm({ ...creditNoteForm, notes: e.target.value })\n                      }\n                      rows={3}\n                      className=\"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent\"\n                      placeholder=\"Notes supplémentaires sur l'avoir...\"\n                    />\n                  </div>\n\n                  {createCreditNoteMutation.error && (\n                    <div className=\"bg-destructive/10 text-destructive px-4 py-3 rounded-lg text-sm\">\n                      {createCreditNoteMutation.error instanceof Error\n                        ? createCreditNoteMutation.error.message\n                        : 'Une erreur est survenue'}\n                    </div>\n                  )}\n\n                  <div className=\"flex space-x-2\">\n                    <Button\n                      type=\"button\"\n                      variant=\"outline\"\n                      className=\"flex-1\"\n                      onClick={() => {\n                        setShowCreditNoteForm(false)\n                        setCreditNoteForm({\n                          amount: '',\n                          reason: '',\n                          notes: '',\n                        })\n                      }}\n                    >\n                      Annuler\n                    </Button>\n                    <Button type=\"submit\" className=\"flex-1\" disabled={createCreditNoteMutation.isPending}>\n                      {createCreditNoteMutation.isPending ? 'Création...' : 'Créer l\\'avoir'}\n                    </Button>\n                  </div>\n                </form>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"0DAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAEA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAKe,SAAS,IACtB,IAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IACT,CAAA,EAAA,EAAA,SAAA,AAAS,IACxB,IAAM,EAAY,EAAO,EAAE,CACrB,MAAE,CAAI,CAAE,CAAG,CAAA,EAAA,EAAA,OAAA,AAAO,IAClB,CAAE,UAAQ,CAAE,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,IACvB,EAAW,CAAA,EAAA,EAAA,YAAY,AAAZ,IACX,EAAc,CAAA,EAAA,EAAA,cAAA,AAAc,IAC5B,CAAC,EAAiB,EAAmB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GACjD,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC/C,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC3C,CAAC,EAAoB,EAAsB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACvD,CAAC,EAAsB,EAAwB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAG3D,CAAE,KAAM,CAAO,WAAE,CAAS,SAAE,CAAO,CAAE,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAuB,CAC3E,SAAU,CAAC,UAAW,EAAU,CAChC,QAAS,IAAM,EAAA,cAAc,CAAC,OAAO,CAAC,EACxC,GAGM,CAAE,KAAM,CAAQ,CAAE,QAAS,CAAe,CAAE,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CAC5D,SAAU,CAAC,WAAY,EAAU,CACjC,QAAS,SACP,AAAK,GAAM,CAAP,eACG,CADqB,CACrB,cAAc,CAAC,MAAM,CAAC,EAAK,eAAe,CAAE,WAAE,CAAU,GAD5B,EAAE,CAGvC,QAAS,CAAC,CAAC,GAAa,CAAC,CAAC,GAAM,eAClC,GAGM,CAAE,KAAM,CAAY,CAAE,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CACtC,SAAU,CAAC,eAAgB,GAAM,gBAAgB,CACjD,QAAS,UACP,GAAI,CAAC,GAAM,gBAAiB,OAAO,KACnC,GAAM,CAAE,MAAI,OAAE,CAAK,CAAE,CAAG,MAAM,EAC3B,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,KAAM,EAAK,eAAe,EAC7B,MAAM,GACT,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,EACA,QAAS,CAAC,CAAC,GAAM,eACnB,GAGM,CAAE,KAAM,CAAY,CAAE,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,CACtC,SAAU,CAAC,gBAAiB,GAAM,gBAAgB,CAClD,QAAS,UACP,GAAI,CAAC,GAAM,gBAAiB,OAAO,KACnC,GAAM,CAAE,MAAI,OAAE,CAAK,CAAE,CAAG,MAAM,EAC3B,IAAI,CAAC,kBACL,MAAM,CAAC,KACP,EAAE,CAAC,kBAAmB,EAAK,eAAe,EAC1C,EAAE,CAAC,cAAc,GACjB,WAAW,UACV,AAAJ,GACE,IADS,IACD,IAAI,CAAC,wDAA0D,GAChE,MAEF,GAAQ,IACjB,EACA,QAAS,CAAC,CAAC,GAAM,eACnB,GAGM,CAAE,KAAM,CAAe,CAAE,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CACzC,SAAU,CAAC,mBAAoB,GAAM,gBAAgB,CACrD,QAAS,UACP,GAAI,CAAC,GAAM,gBAAiB,OAAO,KACnC,IAAM,EAAY,MAAM,EAAA,uBAAuB,CAAC,kBAAkB,CAChE,UACA,EAAK,eAAe,EAEtB,OAAO,EAAU,MAAM,CAAG,EAAI,CAAS,CAAC,EAAE,CAAG,IAC/C,EACA,QAAS,CAAC,CAAC,GAAM,eACnB,GAGM,CAAC,GAAa,GAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CAC7C,OAAQ,GACR,SAAU,GAAS,UAAY,MAC/B,eAAgB,OAChB,iBAAkB,SAClB,eAAgB,GAChB,MAAO,EACT,GAGM,CAAC,GAAgB,GAAkB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,CACnD,OAAQ,GACR,OAAQ,GACR,MAAO,EACT,GAGM,GACJ,GACI,OAAQ,AAAD,GAAyB,cAAb,EAAE,MAAM,EAC5B,OAAO,CAAC,EAAa,IAAW,EAAM,OAAO,EAAE,MAAM,EAAG,IAAM,EAC7D,GAAkB,EAAU,OAAO,EAAQ,YAAY,EAAI,GAAY,EAEvE,GAAwB,CAAA,EAAA,EAAA,WAAW,AAAX,EAAY,CACxC,WAAY,UACV,GAAI,CAAC,EAAS,MAAM,AAAI,MAAM,uBAE9B,IAAM,EAAe,WAAW,GAAY,MAAM,EAElD,GAAI,MAAM,IAAiB,GAAgB,EACzC,CAD4C,KACtC,AAAI,MAAM,gCAIlB,IAAM,EACJ,GACI,OAAQ,AAAD,GAAyB,cAAb,EAAE,MAAM,EAC5B,OAAO,CAAC,EAAa,IAAW,EAAM,OAAO,EAAE,MAAM,EAAG,IAAM,EAGnE,GAAI,EAF2B,OAAO,EAAQ,IAE3B,QAFuC,EAAI,EAG5D,MAAU,AAAJ,MAAU,AADyB,gEAI3C,IAAM,EAAc,AAA+B,YAAnB,cAAc,CACxC,EAAS,EAAc,IAAI,OAAO,WAAW,GAAK,KAExD,OAAO,EAAA,cAAc,CAAC,MAAM,CAAC,CAC3B,gBAAiB,EAAQ,eAAe,CACxC,WAAY,EACZ,WAAY,EAAQ,UAAU,CAC9B,OAAQ,EACR,SAAU,GAAY,QAAQ,CAC9B,eAAgB,GAAY,cAAc,CAC1C,iBACiC,SAA/B,GAAY,cAAc,EAAe,AAA+B,YAAnB,cAAc,CAC/D,GAAY,gBAAgB,CAC5B,KACN,eAAgB,GAAY,cAAc,EAAI,KAC9C,OAAQ,EAAc,YAAc,UACpC,QAAS,EACT,SAAU,CACR,MAAO,GAAY,KAAK,AAC1B,CACF,EACF,EACA,UAAW,KACT,EAAS,CACP,KAAM,UACN,MAAO,sBACP,YAAa,qEACf,GACA,GAAmB,GACnB,GAAe,CACb,OAAQ,GACR,SAAU,GAAS,UAAY,MAC/B,eAAgB,OAChB,iBAAkB,SAClB,eAAgB,GAChB,MAAO,EACT,GAEA,IACA,IAGA,EAAY,cAAc,CAAC,CAAE,SAAU,CAAC,kBAAmB,GAAM,gBAAgB,AAAC,GAClF,EAAY,cAAc,CAAC,CAAE,SAAU,CAAC,oBAAqB,GAAM,gBAAiB,AAAD,GACnF,EAAY,cAAc,CAAC,CAAE,SAAU,CAAC,gBAAiB,GAAM,gBAAgB,AAAC,GAEhF,EAAY,iBAAiB,CAAC,CAAE,SAAU,CAAC,WAAW,AAAC,GACvD,EAAY,iBAAiB,CAAC,CAAE,SAAU,CAAC,mBAAmB,AAAC,EACjE,EACA,QAAS,AAAC,IACR,EAAS,CACP,KAAM,QACN,MAAO,6CACP,YAAa,GAAO,SAAW,6CACjC,EACF,CACF,GAGM,GAA2B,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,CAC3C,WAAY,UACV,GAAI,CAAC,EAAS,MAAM,AAAI,MAAM,uBAE9B,IAAM,EAAe,WAAW,GAAe,MAAM,EAErD,GAAI,MAAM,IAAiB,GAAgB,EACzC,CAD4C,KACtC,AAAI,MAAM,+BAGlB,GAAI,EAAe,OAAO,EAAQ,YAAY,EAC5C,CAD+C,KACzC,AAAI,MAAM,6EAKlB,GAAM,MAAE,CAAI,CAAE,OAAK,CAAE,CAAG,MAAM,EAC3B,IAAI,CAAC,YACL,MAAM,CAAC,CACN,gBAAiB,EAAQ,eAAe,CACxC,WAAY,EAAQ,UAAU,CAC9B,eAAgB,CAAC,MAAM,EAAE,EAAQ,cAAc,CAAA,CAAE,CACjD,KAAM,cACN,cAAe,UACf,WAAY,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAClD,SAAU,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAChD,OAAQ,CAAC,EACT,WAAY,EACZ,aAAc,CAAC,EACf,SAAU,EAAQ,QAAQ,CAC1B,OAAQ,OACR,MAAO,CAAC,sBAAsB,EAAE,EAAQ,cAAc,CAAC,UAAU,EAAE,GAAe,MAAM,CAAC,EAAE,EAAE,GAAe,KAAK,CAAA,CAAE,CACnH,SAAU,CACR,oBAAqB,EAAQ,EAAE,CAC/B,OAAQ,GAAe,MAAM,CAC7B,MAAO,GAAe,KAAK,AAC7B,CACF,GACC,MAAM,GACN,MAAM,GAET,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,EACA,UAAW,KACT,EAAS,CACP,KAAM,UACN,MAAO,aACP,YAAa,iCACf,GACA,EAAsB,IACtB,GAAkB,CAChB,OAAQ,GACR,OAAQ,GACR,MAAO,EACT,GACA,IACA,EAAY,iBAAiB,CAAC,CAAE,SAAU,CAAC,WAAW,AAAC,EACzD,EACA,QAAS,AAAC,IACR,EAAS,CACP,KAAM,QACN,MAAO,wCACP,YAAa,GAAO,SAAW,6CACjC,EACF,CACF,GAEA,GAAI,EACF,MACE,CAAA,EAFW,AAEX,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yDACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,sBAM/C,GAAI,CAAC,EACH,MACE,CAFU,AAEV,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iCAAwB,wBACvC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAAC,KAAK,+BACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,UAAU,gBAAO,6BAyEnC,IAAM,GAAwB,UAC5B,GAAI,CAAC,GAAW,CAAC,GAAgB,CAAC,EAAiB,YACjD,EAAS,CACP,KAAM,QACN,MAAO,SACP,YAAa,uDACf,GAIF,EAAwB,IAExB,GAAI,CAEF,IAAM,EAAU,EAAQ,QAAQ,CAG1B,EAAY,CAAA,EAAA,EAAA,wBAAwB,AAAxB,EAAyB,SACzC,EACA,aAAc,EACd,aAAS,EACT,QANkB,CAMT,cACT,EACA,SAAU,KACV,UAAW,EAAQ,UAAU,OAAI,CACnC,GAGM,EAAS,MAAM,CAAA,EAAA,EAAA,YAAY,AAAZ,EACnB,EACA,OACA,EACA,GAAM,sBAAmB,GAIrB,EAAW,CAAC,QAAQ,EAAE,EAAQ,cAAc,CAAC,IAAI,CAAC,CAGlD,EAAU,SAAS,aAAa,CAAC,MACvC,GAAQ,KAAK,CAAC,QAAQ,CAAG,WACzB,EAAQ,KAAK,CAAC,IAAI,CAAG,UACrB,EAAQ,KAAK,CAAC,GAAG,CAAG,IACpB,EAAQ,KAAK,CAAC,KAAK,CAAG,QACtB,EAAQ,KAAK,CAAC,SAAS,CAAG,SAC1B,EAAQ,KAAK,CAAC,eAAe,CAAG,UAChC,EAAQ,KAAK,CAAC,QAAQ,CAAG,UACzB,EAAQ,KAAK,CAAC,UAAU,CAAG,oBAC3B,SAAS,IAAI,CAAC,WAAW,CAAC,GAM1B,EAAQ,SAAS,CAHF,AACH,AACQ,EACA,EAHD,YACA,eAAe,CAAC,EAAO,IAAI,CAAE,aACxB,IAAI,CAAC,SAAS,CAItC,IAAI,EAAU,EAAQ,aAAa,CAAC,wBAA0B,EAAQ,aAAa,CAAC,sBAAwB,EAAQ,iBAAiB,AAEjI,CAAC,GAAa,QAAF,CAAC,IAAoB,WAAW,GAAG,AACjD,EAAU,CAAA,EAGZ,IAAM,EAAY,CAAC,iBAAiB,EAAE,KAAK,GAAG,GAAA,CAAI,CAgBlD,GAfI,aAAmB,aAAa,CAClC,EAAQ,EAAE,CAAG,EACT,AAAC,EAAQ,KAAK,CAAC,KAAK,EAAE,CACxB,EAAQ,KAAK,CAAC,KAAK,CAAG,OAAA,EAEpB,AAAC,EAAQ,KAAK,CAAC,SAAS,EAAE,CAC5B,EAAQ,KAAK,CAAC,SAAS,CAAG,QAAA,EAE5B,EAAQ,KAAK,CAAC,eAAe,CAAG,WAIlC,MAAM,IAAI,QAAQ,AAAC,GAAY,WAAW,EAAS,MAG/C,aAAmB,YAAa,CAClC,IAAM,EAAO,EAAQ,qBAAqB,IACvB,IAAf,EAAK,KAAK,EAA0B,GAAG,CAAnB,EAAK,MAAM,IACjC,EAAU,EACV,EAAQ,EAAE,CAAG,EACb,EAAQ,KAAK,CAAC,KAAK,CAAG,QACtB,EAAQ,KAAK,CAAC,SAAS,CAAG,SAE9B,CAEA,MAAM,CAAA,EAAA,EAAA,mBAAA,AAAmB,EAAC,EAAW,GAErC,EAAS,CACP,KAAM,UACN,MAAO,sBACP,YAAa,sDACf,EACF,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,8CAA+C,GAC7D,EAAS,CACP,KAAM,QACN,MAAO,SACP,YAAa,8DACf,EACF,QAAU,CACR,GAAwB,GAEP,AACjB,SAD0B,gBAAgB,CAAC,6BAClC,OAAO,CAAC,AAAC,IACZ,EAAI,UAAU,GAAK,SAAS,IAAI,EAAE,AACpC,SAAS,IAAI,CAAC,WAAW,CAAC,EAE9B,EACF,CACF,EAEA,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAAC,KAAK,+BACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,QAAQ,KAAK,gBAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,gBAGzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,6CAAmC,WACtC,EAAQ,cAAc,IAEjC,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,uCACV,EAAQ,QAAQ,EAAE,WAAW,IAAE,EAAQ,QAAQ,EAAE,mBAIxD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,UACR,QAAS,GACT,SAAU,GAAwB,CAAC,YAEnC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,iBACnB,EAAuB,gBAAkB,4BAE3C,GAAkB,GACjB,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAS,IAAM,EAAmB,CAAC,aACzC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,iBAAiB,6BAGnC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,QAAS,IAAM,EAAkB,CAAC,aAC1D,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,iBAAiB,qBAGzC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,QAAS,IAAM,EAAgB,CAAC,aACxD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,iBAAiB,sBAK5C,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,QAAS,IAAM,EAAsB,CAAC,aAC9D,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,iBAAiB,0BAM1C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,UACT,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,0BACX,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,CAAC,sCAAsC,EAAE,CA5OjD,AAAC,IACtB,OAAQ,GACN,IAAK,OACH,MAAO,oCACT,KAAK,OACH,MAAO,2BACT,KAAK,UACH,MAAO,oCACT,KAAK,UACH,MAAO,yBACT,KAAK,IACH,MAAO,2BAGX,CACF,GA6NuF,EAAQ,MAAM,EAAI,WAAA,CAAY,UA3N9F,AA4NN,CA5NO,IACtB,OAAQ,GACN,IAAK,OACH,MAAO,OACT,KAAK,OACH,MAAO,SACT,KAAK,UACH,MAAO,WACT,KAAK,UACH,MAAO,WACT,KAAK,QACH,MAAO,WACT,SACE,OAAO,CACX,EACF,EA6MgC,EAAQ,MAAM,EAAI,kBAIxC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,sBACrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,iEACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,iBAAiB,YAGvC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,uBAAe,EAAQ,cAAc,MAEpD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,iEACX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,iBAAiB,UAGvC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,kCAA0B,EAAQ,IAAI,SAIvD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCAAgC,oBAC7C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,uBAAe,CAAA,EAAA,EAAA,UAAA,AAAU,EAAC,EAAQ,UAAU,EAAI,SAE/D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCAAgC,oBAC7C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAC,YAAY,EAAE,EAAQ,QAAQ,EAAI,EAAQ,QAAQ,CAAG,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,EAAI,AAAmB,WAAX,MAAM,CAAc,eAAiB,GAAA,CAAI,UAC5J,CAAA,EAAA,EAAA,UAAA,AAAU,EAAC,EAAQ,QAAQ,EAAI,YAKtC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iCACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,iCAAwB,gBACxC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAe,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,OAAO,EAAQ,MAAM,EAAG,EAAQ,QAAQ,OAEvF,OAAO,EAAQ,UAAU,EAAI,GAC5B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iCACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,iCAAwB,SACxC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,uBAAe,CAAA,EAAA,EAAA,cAAc,AAAd,EAAe,OAAO,EAAQ,UAAU,EAAG,EAAQ,QAAQ,OAG9F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+CACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yBAAgB,eAChC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,6BAAqB,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,OAAO,EAAQ,YAAY,EAAG,EAAQ,QAAQ,OAEnG,GAAY,GACX,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+CACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,iCAAwB,gBACxC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,4CAAoC,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,GAAW,EAAQ,QAAQ,OAE/F,GAAkB,GACjB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+CACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yBAAgB,mBAChC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,0CACb,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,GAAiB,EAAQ,QAAQ,aAQ5D,EAAQ,KAAK,EACZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,8CAAqC,UAClD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,6CAAqC,EAAQ,KAAK,YAOvE,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,+BAEb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACT,GAAY,EAAS,MAAM,CAAG,EAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EAAS,GAAG,CAAC,AAAC,GACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAU,oEAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCACZ,CAtSO,AAAD,IAC3B,OAAQ,GACN,IAAK,YACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,gCAChC,KAAK,SACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAO,CAAA,CAAC,UAAU,wBAC5B,KAAK,UACL,IAAK,aACH,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,gCAC1B,SACE,OAAO,IACX,EACF,EA0R4C,EAAQ,MAAM,EACpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yBACV,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,OAAO,EAAQ,MAAM,EAAG,EAAQ,QAAQ,IAE1D,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,0CACV,CA9RG,AAAC,IAC7B,OAAQ,GACN,IAAK,OACH,MAAO,SACT,KAAK,OACH,MAAO,gBACT,KAAK,gBACH,MAAO,mBACT,KAAK,OACH,MAAO,eACT,SACE,OAAO,CACX,EACF,EAiRiD,EAAQ,cAAc,EAC5C,EAAQ,gBAAgB,EAAI,CAAC,GAAG,EAAE,EAAQ,gBAAgB,CAAC,WAAW,GAAA,CAAI,IAE5E,EAAQ,cAAc,EACrB,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,0CAAgC,gBAC7B,EAAQ,cAAc,UAK5C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yCACV,EAAQ,OAAO,CACZ,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,EAAQ,OAAO,EAC9B,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,EAAQ,UAAU,IAEvC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACC,UAAW,CAAC,4CAA4C,EACnC,cAAnB,EAAQ,MAAM,CACV,qCACmB,WAAnB,EAAQ,MAAM,CACd,0BACA,qCAAA,CACJ,UAEkB,cAAnB,EAAQ,MAAM,CACX,WACmB,WAAnB,EAAQ,MAAM,CACd,SACmB,YAAnB,EAAQ,MAAM,CACd,aACA,EAAQ,MAAM,QAzCjB,EAAQ,EAAE,KAgDrB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kDAAyC,sCAS/D,GAAmB,GAAkB,GACpC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,8BAEb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACV,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CACC,SAAU,AAAC,IACT,EAAE,cAAc,GAChB,GAAsB,MAAM,EAC9B,EACA,UAAU,sBAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,0CAAiC,cAClD,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,SACL,QAAQ,CAAA,CAAA,EACR,KAAK,OACL,IAAI,OACJ,IAAK,GACL,MAAO,GAAY,MAAM,CACzB,SAAU,AAAC,GACT,GAAe,CAAE,GAAG,EAAW,CAAE,OAAQ,EAAE,MAAM,CAAC,KAAK,AAAC,GAE1D,UAAU,+GACV,YAAa,GAAgB,QAAQ,KAEvC,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,+CAAqC,kBAChC,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,GAAiB,EAAQ,QAAQ,QAIpE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,0CAAiC,0BAClD,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAQ,CAAA,CAAA,EACR,MAAO,GAAY,cAAc,EAAI,GACrC,SAAU,AAAC,GACT,GAAe,CACb,GAAG,EAAW,CACd,eAAgB,EAAE,MAAM,CAAC,KAAK,AAChC,GAEF,UAAU,yHAEV,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,gBAAO,YACrB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,gBAAO,4BACrB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,gBAAO,kBACrB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,yBAAgB,4BAIF,SAA/B,GAAY,cAAc,EACzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,0CAAiC,kBAClD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAQ,CAAA,CAAA,EACR,MAAO,GAAY,gBAAgB,EAAI,GACvC,SAAU,AAAC,GACT,GAAe,CACb,GAAG,EAAW,CACd,iBAAmB,EAAE,MAAM,CAAC,KAAK,EAAI,QACvC,GAEF,UAAU,wHAEV,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,kBAAS,gBAKG,SAA/B,GAAY,cAAc,EACzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,0CAAiC,kBAClD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAQ,CAAA,CAAA,EACR,MAAO,GAAY,gBAAgB,EAAI,GACvC,SAAU,AAAC,GACT,GAAe,CACb,GAAG,EAAW,CACd,iBAAmB,EAAE,MAAM,CAAC,KAAK,EAAI,QACvC,GAEF,UAAU,wHAEV,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,gBAAO,cAK1B,AAA+B,YAAnB,cAAc,EACzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,0CAAiC,sBAClD,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,MAAO,GAAY,cAAc,CACjC,SAAU,AAAC,GACT,GAAe,CAAE,GAAG,EAAW,CAAE,eAAgB,EAAE,MAAM,CAAC,KAAK,AAAC,GAElE,UAAU,+GACV,YAAY,4BAKlB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,0CAAiC,UAClD,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,MAAO,GAAY,KAAK,CACxB,SAAU,AAAC,GACT,GAAe,CAAE,GAAG,EAAW,CAAE,MAAO,EAAE,MAAM,CAAC,KAAK,AAAC,GAEzD,KAAM,EACN,UAAU,8FACV,YAAY,gCAIf,GAAsB,KAAK,EAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2EACZ,GAAsB,KAAK,YAAY,MACpC,GAAsB,KAAK,CAAC,OAAO,CACnC,4BAIR,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,KAAK,SACL,QAAQ,UACR,UAAU,SACV,QAAS,IAAM,GAAmB,YACnC,YAGD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,KAAK,SAAS,UAAU,SAAS,SAAU,GAAsB,SAAS,UAC/E,GAAsB,SAAS,CAAG,oBAAsB,6BAUtE,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,IAAI,CAAA,WACH,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,UACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,UAAC,qBAEb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,UACV,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CACC,SAAU,AAAC,IACT,EAAE,cAAc,GAChB,GAAyB,MAAM,EACjC,EACA,UAAU,sBAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,0CAAiC,yBAClD,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,SACL,QAAQ,CAAA,CAAA,EACR,KAAK,OACL,IAAI,OACJ,IAAK,OAAO,EAAQ,YAAY,EAChC,MAAO,GAAe,MAAM,CAC5B,SAAU,AAAC,GACT,GAAkB,CAAE,GAAG,EAAc,CAAE,OAAQ,EAAE,MAAM,CAAC,KAAM,AAAD,GAE/D,UAAU,+GACV,YAAY,SAEd,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,+CAAqC,gCAClB,CAAA,EAAA,EAAA,cAAc,AAAd,EAAe,OAAO,EAAQ,YAAY,EAAG,EAAQ,QAAQ,QAI/F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,0CAAiC,wBAClD,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,QAAQ,CAAA,CAAA,EACR,MAAO,GAAe,MAAM,CAC5B,SAAU,AAAC,GACT,GAAkB,CAAE,GAAG,EAAc,CAAE,OAAQ,EAAE,MAAM,CAAC,KAAK,AAAC,GAEhE,UAAU,yHAEV,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,YAAG,4BACjB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,0BAAiB,8BAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,8BAAqB,0BACnC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,8BAAqB,uBACnC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,sBAAa,2BAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,iBAAQ,gBAI1B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,0CAAiC,UAClD,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,MAAO,GAAe,KAAK,CAC3B,SAAU,AAAC,GACT,GAAkB,CAAE,GAAG,EAAc,CAAE,MAAO,EAAE,MAAM,CAAC,KAAK,AAAC,GAE/D,KAAM,EACN,UAAU,8FACV,YAAY,4CAIf,GAAyB,KAAK,EAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2EACZ,GAAyB,KAAK,YAAY,MACvC,GAAyB,KAAK,CAAC,OAAO,CACtC,4BAIR,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,KAAK,SACL,QAAQ,UACR,UAAU,SACV,QAAS,KACP,GAAsB,GACtB,GAAkB,CAChB,OAAQ,GACR,OAAQ,GACR,MAAO,EACT,EACF,WACD,YAGD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,KAAK,SAAS,UAAU,SAAS,SAAU,GAAyB,SAAS,UAClF,GAAyB,SAAS,CAAG,cAAgB,oCAW5E"}