module.exports=[641710,a=>{"use strict";let b=(0,a.i(170106).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],641710)},821374,a=>{"use strict";let b=(0,a.i(170106).default)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);a.s(["Star",()=>b],821374)},71277,a=>{"use strict";let b=(0,a.i(170106).default)("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);a.s(["PlayCircle",()=>b],71277)},733143,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(433217),e=a.i(913216),f=a.i(269240);let g=new class{supabase;constructor(a){this.supabase=a||(0,f.createClient)()}async getModules(){let{data:a,error:b}=await this.supabase.from("tutorial_modules").select("*").eq("is_active",!0).order("order_index",{ascending:!0});if(b)throw b;return a}async getModuleBySlug(a){let{data:b,error:c}=await this.supabase.from("tutorial_modules").select("*").eq("slug",a).eq("is_active",!0).single();if(c)throw c;return b}async getVideos(a){let b=this.supabase.from("tutorial_videos").select(`
        *,
        module:tutorial_modules(*)
      `);a?.moduleId&&(b=b.eq("module_id",a.moduleId)),a?.moduleSlug&&(b=b.eq("module:tutorial_modules.slug",a.moduleSlug)),a?.search&&(b=b.or(`title.ilike.%${a.search}%,description.ilike.%${a.search}%`)),a?.difficultyLevel&&(b=b.eq("difficulty_level",a.difficultyLevel)),b=a?.isPublished!==void 0?b.eq("is_published",a.isPublished):b.eq("is_published",!0);let{data:c,error:d}=await b.order("order_index",{ascending:!0});if(d)throw d;return c}async getVideoBySlug(a,b){let{data:c,error:d}=await this.supabase.from("tutorial_videos").select(`
        *,
        module:tutorial_modules(*)
      `).eq("slug",b).eq("module:tutorial_modules.slug",a).eq("is_published",!0).single();if(d)throw d;return c}async createVideo(a){let{data:b,error:c}=await this.supabase.from("tutorial_videos").insert(a).select().single();if(c)throw c;return b}async updateVideo(a,b){let{data:c,error:d}=await this.supabase.from("tutorial_videos").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteVideo(a){let{error:b}=await this.supabase.from("tutorial_videos").delete().eq("id",a);if(b)throw b}async getProgress(a,b){if(b){let{data:c,error:d}=await this.supabase.from("tutorial_progress").select("*, video:tutorial_videos(*)").eq("user_id",a).eq("video_id",b).maybeSingle();if(d)throw d;return c}let{data:c,error:d}=await this.supabase.from("tutorial_progress").select("*, video:tutorial_videos(*)").eq("user_id",a);if(d)throw d;return c}async updateProgress(a,b,c,d){if(!await this.getVideoById(b))throw Error("Video not found");let e=d>=90,{data:f,error:g}=await this.supabase.from("tutorial_progress").upsert({user_id:a,video_id:b,watched_seconds:c,completion_percentage:d,is_completed:e,completed_at:e?new Date().toISOString():null,last_watched_at:new Date().toISOString()},{onConflict:"user_id,video_id"}).select().single();if(g)throw g;return f}async getVideoById(a){let{data:b,error:c}=await this.supabase.from("tutorial_videos").select("*").eq("id",a).single();if(c)throw c;return b}async getUserProgress(a){let{data:b,error:c}=await this.supabase.from("tutorial_progress").select("*, video:tutorial_videos(*, module:tutorial_modules(*))").eq("user_id",a).order("last_watched_at",{ascending:!1});if(c)throw c;return b}async getCompletionStats(a){let b=await this.getUserProgress(a),c=await this.getVideos({isPublished:!0}),d=b||[],e=d.filter(a=>a.is_completed).length||0,f=(c||[]).length||0;return{completed:e,total:f,inProgress:d.filter(a=>!a.is_completed&&a.watched_seconds>0).length||0,completionRate:f>0?e/f*100:0}}async getNotes(a,b){let c=this.supabase.from("tutorial_notes").select("*, video:tutorial_videos(*)").eq("user_id",a);b&&(c=c.eq("video_id",b));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e)throw e;return d}async createNote(a){let{data:b,error:c}=await this.supabase.from("tutorial_notes").insert(a).select().single();if(c)throw c;return b}async updateNote(a,b){let{data:c,error:d}=await this.supabase.from("tutorial_notes").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteNote(a){let{error:b}=await this.supabase.from("tutorial_notes").delete().eq("id",a);if(b)throw b}async addToFavorites(a,b){let{data:c,error:d}=await this.supabase.from("tutorial_favorites").insert({user_id:a,video_id:b}).select().single();if(d)throw d;return c}async removeFromFavorites(a,b){let{error:c}=await this.supabase.from("tutorial_favorites").delete().eq("user_id",a).eq("video_id",b);if(c)throw c}async isFavorite(a,b){let{data:c,error:d}=await this.supabase.from("tutorial_favorites").select("id").eq("user_id",a).eq("video_id",b).maybeSingle();if(d)throw d;return!!c}async getFavorites(a){let{data:b,error:c}=await this.supabase.from("tutorial_favorites").select("*, video:tutorial_videos(*, module:tutorial_modules(*))").eq("user_id",a).order("created_at",{ascending:!1});if(c)throw c;return b}async getPlaylists(a,b){let c=this.supabase.from("tutorial_playlists").select("*, user:users(id, full_name, email)");a&&(c=c.eq("user_id",a)),void 0!==b&&(c=c.eq("is_public",b));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e)throw e;return d}async createPlaylist(a){let{data:b,error:c}=await this.supabase.from("tutorial_playlists").insert(a).select().single();if(c)throw c;return b}async addVideoToPlaylist(a,b){let{data:c,error:d}=await this.supabase.from("tutorial_playlist_videos").insert({playlist_id:a,video_id:b}).select().single();if(d)throw d;return c}async getComments(a){let{data:b,error:c}=await this.supabase.from("tutorial_comments").select("*, user:users(id, full_name, email), replies:tutorial_comments(*)").eq("video_id",a).eq("is_approved",!0).is("parent_id",null).order("created_at",{ascending:!1});if(c)throw c;return b}async createComment(a){let{data:b,error:c}=await this.supabase.from("tutorial_comments").insert(a).select().single();if(c)throw c;return b}};var h=a.i(703130),i=a.i(340695),j=a.i(205522),k=a.i(254161),l=a.i(71277),m=a.i(641710),n=a.i(111269),o=a.i(953722),p=a.i(587532),q=a.i(821374),r=a.i(238246);function s(){let{user:a}=(0,e.useAuth)(),[f,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(null),{data:v}=(0,d.useQuery)({queryKey:["tutorial-modules"],queryFn:()=>g.getModules()}),{data:w}=(0,d.useQuery)({queryKey:["tutorial-videos",t,f],queryFn:()=>g.getVideos({moduleId:t||void 0,search:f||void 0})}),{data:x}=(0,d.useQuery)({queryKey:["tutorial-stats",a?.id],queryFn:()=>g.getCompletionStats(a?.id||""),enabled:!!a?.id}),y={beginner:"bg-green-100 text-green-800",intermediate:"bg-yellow-100 text-yellow-800",advanced:"bg-red-100 text-red-800"},z={beginner:"Débutant",intermediate:"Intermédiaire",advanced:"Avancé"};return(0,b.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,b.jsx)(l.PlayCircle,{className:"h-8 w-8"}),"Vidéos Tutoriels"]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Apprenez à utiliser EDUZEN avec nos tutoriels vidéo complets"})]}),x&&(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,b.jsx)(h.Card,{children:(0,b.jsx)(h.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Vidéos complétées"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:x.completed})]}),(0,b.jsx)(n.CheckCircle2,{className:"h-8 w-8 text-green-500"})]})})}),(0,b.jsx)(h.Card,{children:(0,b.jsx)(h.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"En cours"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:x.inProgress})]}),(0,b.jsx)(m.Clock,{className:"h-8 w-8 text-yellow-500"})]})})}),(0,b.jsx)(h.Card,{children:(0,b.jsx)(h.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:x.total})]}),(0,b.jsx)(o.BookOpen,{className:"h-8 w-8 text-blue-500"})]})})}),(0,b.jsx)(h.Card,{children:(0,b.jsx)(h.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Progression"}),(0,b.jsxs)("p",{className:"text-2xl font-bold",children:[Math.round(x.completionRate),"%"]})]}),(0,b.jsx)(q.Star,{className:"h-8 w-8 text-purple-500"})]})})})]}),(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(p.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,b.jsx)(j.Input,{placeholder:"Rechercher un tutoriel...",value:f,onChange:a=>s(a.target.value),className:"pl-10"})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsxs)(h.Card,{children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsx)(h.CardTitle,{children:"Modules"})}),(0,b.jsx)(h.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("button",{onClick:()=>u(null),className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${null===t?"bg-primary text-primary-foreground":"hover:bg-gray-100"}`,children:"Tous les modules"}),v?.map(a=>(0,b.jsx)("button",{onClick:()=>u(a.id),className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${t===a.id?"bg-primary text-primary-foreground":"hover:bg-gray-100"}`,children:a.name},a.id))]})})]})}),(0,b.jsx)("div",{className:"lg:col-span-3",children:w&&w.length>0?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:w.map(a=>{var c;let d,e,f;return(0,b.jsxs)(h.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsx)("div",{className:"flex items-start justify-between",children:(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(h.CardTitle,{className:"text-lg mb-2",children:a.title}),(0,b.jsx)(h.CardDescription,{className:"line-clamp-2",children:a.description})]})})}),(0,b.jsx)(h.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsx)(k.Badge,{className:y[a.difficulty_level]||"bg-gray-100 text-gray-800",children:z[a.difficulty_level]||a.difficulty_level}),a.duration_seconds&&(0,b.jsxs)("span",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,b.jsx)(m.Clock,{className:"h-4 w-4"}),(d=Math.floor((c=a.duration_seconds)/3600),e=Math.floor(c%3600/60),f=c%60,d>0?`${d}h ${e}m`:e>0?`${e}m ${f}s`:`${f}s`)]}),a.module&&(0,b.jsx)(k.Badge,{variant:"outline",children:a.module.name})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[a.view_count||0," vues"]}),(0,b.jsx)(r.default,{href:`/dashboard/tutorials/${a.module?.slug}/${a.slug}`,children:(0,b.jsxs)(i.Button,{children:[(0,b.jsx)(l.PlayCircle,{className:"h-4 w-4 mr-2"}),"Regarder"]})})]})]})})]},a.id)})}):(0,b.jsx)(h.Card,{children:(0,b.jsxs)(h.CardContent,{className:"pt-6 text-center text-muted-foreground",children:["Aucune vidéo trouvée. ",f&&"Essayez une autre recherche."]})})})]})]})}a.s(["default",()=>s],733143)}];

//# sourceMappingURL=_474cd738._.js.map