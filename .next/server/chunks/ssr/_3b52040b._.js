module.exports=[915618,a=>{"use strict";let b=(0,a.i(170106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],915618)},400210,a=>{"use strict";let b=(0,a.i(170106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],400210)},790166,a=>{"use strict";let b=(0,a.i(170106).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);a.s(["DollarSign",()=>b],790166)},426099,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getAllPrograms(a,b){let c=this.supabase.from("programs").select("*").eq("organization_id",a);b?.isActive!==void 0&&(c=c.eq("is_active",b.isActive)),b?.search&&(c=c.or(`name.ilike.%${b.search}%,code.ilike.%${b.search}%,description.ilike.%${b.search}%`));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e)throw e;return d}async getProgramById(a){let{data:b,error:c}=await this.supabase.from("programs").select(`
        *,
        formations(*)
      `).eq("id",a).single();if(c)throw c;return b}async createProgram(a){let{data:b,error:c}=await this.supabase.from("programs").insert(a).select().single();if(c)throw c;return b}async updateProgram(a,b){let{data:c,error:d}=await this.supabase.from("programs").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteProgram(a){return this.updateProgram(a,{is_active:!1})}async getFormationsByProgram(a){let{data:b,error:c}=await this.supabase.from("formations").select("*").eq("program_id",a).order("created_at",{ascending:!1});if(c)throw c;return b}async getGlobalStats(a){let{data:b,error:c}=await this.supabase.from("programs").select("id, is_active, created_at").eq("organization_id",a);if(c)throw c;let d=b||[],e=d.length,f=d.filter(a=>a.is_active).length,g=d.filter(a=>!a.is_active).length,h=0,i=d.map(a=>a.id);if(i.length>0){let{count:a,error:b}=await this.supabase.from("formations").select("*",{count:"exact",head:!0}).in("program_id",i);if(b)throw b;h=a||0}let j=0;if(i.length>0){let{data:a,error:b}=await this.supabase.from("formations").select("id").in("program_id",i);if(b)throw b;let c=a?.map(a=>a.id)||[];if(c.length>0){let{count:a,error:b}=await this.supabase.from("sessions").select("*",{count:"exact",head:!0}).in("formation_id",c);if(b)throw b;j=a||0}}let k=0;if(i.length>0){let{data:a,error:b}=await this.supabase.from("formations").select("id").in("program_id",i);if(b)throw b;let c=a?.map(a=>a.id)||[];if(c.length>0){let{data:a,error:b}=await this.supabase.from("sessions").select("id").in("formation_id",c);if(b)throw b;let d=a?.map(a=>a.id)||[];if(d.length>0){let{count:a,error:b}=await this.supabase.from("enrollments").select("*",{count:"exact",head:!0}).in("session_id",d);if(b)throw b;k=a||0}}}let l=[{name:"Actifs",value:f,color:"#335ACF"},{name:"Inactifs",value:g,color:"#6B7280"}].filter(a=>a.value>0),m={};return d.forEach(a=>{if(a.created_at){let b=new Date(a.created_at),c=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}`;m[c]=(m[c]||0)+1}}),{total:e,active:f,inactive:g,totalFormations:h,totalSessions:j,totalEnrollments:k,statusData:l,monthlyData:Object.entries(m).sort(([a],[b])=>a.localeCompare(b)).slice(-6).map(([a,b])=>({month:new Date(a+"-01").toLocaleDateString("fr-FR",{month:"short",year:"numeric"}),programmes:b}))}}};a.s(["programService",0,c])},477510,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(433217),f=a.i(426099),g=a.i(340695),h=a.i(703130),i=a.i(400210),j=a.i(915618),k=a.i(587532),l=a.i(987105),m=a.i(941675),n=a.i(790166),o=a.i(660246),p=a.i(238246),q=a.i(497895);function r(){let a=(0,d.useParams)();(0,d.useRouter)();let r=a.id,[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(!0),{data:w,isLoading:x}=(0,e.useQuery)({queryKey:["program",r],queryFn:()=>f.programService.getProgramById(r),enabled:!!r}),{data:y,isLoading:z}=(0,e.useQuery)({queryKey:["program-formations",r,s,u],queryFn:async()=>{let a=await f.programService.getFormationsByProgram(r)||[];if(u&&(a=a.filter(a=>a.is_active)),s){let b=s.toLowerCase();a=a.filter(a=>a.name?.toLowerCase().includes(b)||a.code?.toLowerCase().includes(b)||a.description?.toLowerCase().includes(b))}return a},enabled:!!r});if(x)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("div",{className:"text-muted-foreground",children:"Chargement..."})})});if(!w)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-muted-foreground",children:"Programme non trouvé"}),(0,b.jsx)(p.default,{href:"/dashboard/programs",children:(0,b.jsx)(g.Button,{className:"mt-4",children:"Retour à la liste"})})]})});let A=y||[];return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)(p.default,{href:`/dashboard/programs/${r}`,children:(0,b.jsx)(g.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(i.ArrowLeft,{className:"h-4 w-4"})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Formations"}),(0,b.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Programme: ",(0,b.jsx)(p.default,{href:`/dashboard/programs/${r}`,className:"text-primary hover:underline",children:w.name})]})]})]}),(0,b.jsx)(p.default,{href:"/dashboard/formations/new",children:(0,b.jsxs)(g.Button,{children:[(0,b.jsx)(j.Plus,{className:"mr-2 h-4 w-4"}),"Nouvelle formation"]})})]}),(0,b.jsxs)(h.Card,{children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsx)("div",{className:"flex flex-col space-y-4",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-4",children:[(0,b.jsx)("div",{className:"flex-1 w-full",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(k.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"Rechercher une formation...",value:s,onChange:a=>t(a.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]})}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"activeOnly",checked:u,onChange:a=>v(a.target.checked),className:"rounded border-gray-300 text-primary focus:ring-primary"}),(0,b.jsx)("label",{htmlFor:"activeOnly",className:"text-sm text-gray-600",children:"Actives uniquement"})]})]})})}),(0,b.jsx)(h.CardContent,{children:z?(0,b.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:"Chargement..."}):A.length>0?(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:A.map(a=>(0,b.jsxs)(h.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,b.jsx)(h.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(h.CardTitle,{className:"text-lg",children:a.name}),a.subtitle&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:a.subtitle}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Code: ",a.code]})]}),(0,b.jsx)("span",{className:`px-2 py-1 rounded text-xs ${a.is_active?"bg-success-bg text-success-primary":"bg-gray-100 text-gray-800"}`,children:a.is_active?"Active":"Inactive"})]})}),(0,b.jsxs)(h.CardContent,{className:"space-y-3",children:[a.description&&(0,b.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[a.duration_hours&&(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(m.Calendar,{className:"mr-1 h-4 w-4"}),a.duration_hours,"h"]}),a.price&&(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(n.DollarSign,{className:"mr-1 h-4 w-4"}),(0,q.formatCurrency)(Number(a.price),a.currency||"XOF")]})]}),a.capacity_max&&(0,b.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,b.jsx)(o.Users,{className:"mr-1 h-4 w-4"}),"Capacité: ",a.capacity_max," apprenants"]}),(0,b.jsxs)("div",{className:"flex space-x-2 pt-2",children:[(0,b.jsx)(p.default,{href:`/dashboard/formations/${a.id}`,className:"flex-1",children:(0,b.jsx)(g.Button,{variant:"outline",className:"w-full",size:"sm",children:"Voir détails"})}),(0,b.jsx)(p.default,{href:`/dashboard/formations/${a.id}/sessions`,className:"flex-1",children:(0,b.jsx)(g.Button,{variant:"default",className:"w-full",size:"sm",children:"Sessions"})})]})]})]},a.id))}):(0,b.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,b.jsx)(l.BookMarked,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,b.jsx)("p",{children:"Aucune formation trouvée"}),s||u?(0,b.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,b.jsx)("p",{className:"text-sm",children:"Essayez de modifier vos filtres"}),(0,b.jsx)(g.Button,{variant:"outline",onClick:()=>{t(""),v(!1)},children:"Réinitialiser les filtres"})]}):(0,b.jsx)(p.default,{href:"/dashboard/formations/new",children:(0,b.jsx)(g.Button,{variant:"outline",className:"mt-4",children:"Créer une formation"})})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsx)(h.Card,{children:(0,b.jsx)(h.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:A.length}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total des formations"})]})})}),(0,b.jsx)(h.Card,{children:(0,b.jsx)(h.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-success-primary",children:A.filter(a=>a.is_active).length}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Formations actives"})]})})}),(0,b.jsx)(h.Card,{children:(0,b.jsx)(h.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-gray-600",children:A.filter(a=>!a.is_active).length}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:"Formations inactives"})]})})})]})]})}a.s(["default",()=>r])}];

//# sourceMappingURL=_3b52040b._.js.map