module.exports=[400210,a=>{"use strict";let b=(0,a.i(170106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],400210)},114548,a=>{"use strict";let b=(0,a.i(170106).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);a.s(["Save",()=>b],114548)},280281,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);let e=c.forwardRef(({checked:a,onCheckedChange:c,disabled:e,className:f,...g},h)=>(0,b.jsx)("button",{type:"button",role:"switch","aria-checked":a,ref:h,disabled:e,onClick:()=>c?.(!a),className:(0,d.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",a?"bg-brand-blue":"bg-input",f),...g,children:(0,b.jsx)("span",{className:(0,d.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform",a?"translate-x-5":"translate-x-0")})}));e.displayName="Switch",a.s(["Switch",0,e])},887682,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);a.i(460355);var e=a.i(346271),f=a.i(262036),g=a.i(405784),h=a.i(290821);c.forwardRef(({className:a,label:i,error:j,helperText:k,variant:l="default",leftIcon:m,id:n,options:o,placeholder:p,value:q,...r},s)=>{let[t,u]=c.useState(!1),[v,w]=c.useState(!1),x=n||`select-${Math.random().toString(36).substr(2,9)}`,y=(0,d.cn)("flex w-full rounded-lg font-medium transition-all duration-300","appearance-none cursor-pointer","focus:outline-none focus:ring-2 focus:ring-primary/20","disabled:cursor-not-allowed disabled:opacity-50",{"border-2 border-input bg-background px-4 py-3 pr-11":"default"===l,"focus:border-primary focus:bg-white":"default"===l&&!j,"border-destructive focus:border-destructive focus:ring-destructive/20":j,"border-2 border-input bg-transparent px-4 py-3 pr-11":"outlined"===l,"focus:border-primary focus:shadow-md focus:shadow-primary/10":"outlined"===l&&!j,"border-0 border-b-2 border-input bg-muted/50 px-4 py-3 pr-11 rounded-b-none":"filled"===l,"focus:bg-muted focus:border-primary":"filled"===l&&!j,"focus:border-destructive bg-destructive/5":"filled"===l&&j},m&&"pl-11",a);return(0,b.jsxs)("div",{className:"w-full space-y-1.5",children:[i&&(0,b.jsxs)(e.motion.label,{htmlFor:x,initial:!1,animate:{color:j?"#EF4444":t?"rgb(37, 99, 235)":"rgb(107, 114, 128)"},className:(0,d.cn)("block text-sm font-medium transition-colors duration-200",j&&"text-destructive"),children:[i,r.required&&(0,b.jsx)("span",{className:"text-destructive ml-1",children:"*"})]}),(0,b.jsxs)("div",{className:"relative",children:[m&&(0,b.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground pointer-events-none z-10",children:m}),(0,b.jsxs)(e.motion.select,{ref:s,id:x,value:q,...r,onFocus:a=>{u(!0),r.onFocus?.(a)},onBlur:a=>{u(!1),w(!1),r.onBlur?.(a)},onMouseDown:()=>w(!v),className:y,animate:{scale:t?1.01:1,borderColor:j?"#EF4444":t?"rgb(37, 99, 235)":"rgb(226, 232, 240)"},transition:{duration:.2},children:[p&&(0,b.jsx)("option",{value:"",disabled:!0,children:p}),(o||[]).map(a=>(0,b.jsx)("option",{value:a.value,disabled:a.disabled,children:a.label},a.value))]}),(0,b.jsx)(e.motion.div,{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",animate:{rotate:180*!!v},transition:{duration:.2},children:(0,b.jsx)(g.ChevronDown,{className:"h-5 w-5"})}),j&&(0,b.jsx)(e.motion.div,{className:"absolute right-11 top-1/2 -translate-y-1/2 pointer-events-none",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:(0,b.jsx)(h.AlertCircle,{className:"h-5 w-5 text-destructive"})})]}),(0,b.jsx)(f.AnimatePresence,{mode:"wait",children:(j||k)&&(0,b.jsx)(e.motion.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},transition:{duration:.2},className:(0,d.cn)("text-xs transition-colors duration-200",j?"text-destructive":"text-muted-foreground"),children:j||k})})]})}).displayName="SelectNative";let i=c.createContext({}),j=c.forwardRef(({value:a,onValueChange:d,children:e},f)=>{let[g,h]=c.useState(!1);return(0,b.jsx)(i.Provider,{value:{value:a,onValueChange:d,open:g,setOpen:h},children:(0,b.jsx)("div",{className:"relative",ref:f,children:e})})});j.displayName="SelectRoot";let k=c.forwardRef(({children:a,className:e,...f},h)=>{let{open:j,setOpen:k}=c.useContext(i);return(0,b.jsxs)("button",{ref:h,type:"button",className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),onClick:()=>k?.(!j),...f,children:[a,(0,b.jsx)(g.ChevronDown,{className:(0,d.cn)("h-4 w-4 opacity-50 transition-transform",j&&"rotate-180")})]})});k.displayName="SelectTrigger";let l=c.forwardRef(({placeholder:a},d)=>{let{value:e}=c.useContext(i);return(0,b.jsx)("span",{ref:d,children:e||a})});l.displayName="SelectValue";let m=c.forwardRef(({children:a},d)=>{let e=c.useContext(i);return e?.open&&a?(0,b.jsx)("div",{ref:d,className:"absolute top-full left-0 z-50 mt-1 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md",children:(0,b.jsx)("div",{className:"p-1",children:a})}):null});m.displayName="SelectContent";let n=c.forwardRef(({value:a,children:e,className:f,...g},h)=>{let{value:j,onValueChange:k,setOpen:l}=c.useContext(i),m=j===a;return(0,b.jsx)("div",{ref:h,role:"option","aria-selected":m,className:(0,d.cn)("relative flex w-full cursor-pointer select-none items-center rounded-sm py-1.5 px-2 text-sm outline-none hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground",m&&"bg-accent text-accent-foreground",f),onClick:()=>{k?.(a),l?.(!1)},...g,children:e})});n.displayName="SelectItem",a.s(["Select",0,j,"SelectContent",0,m,"SelectItem",0,n,"SelectRoot",0,j,"SelectTrigger",0,k,"SelectValue",0,l])},481402,a=>{"use strict";let b=(0,a.i(170106).default)("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);a.s(["Key",()=>b],481402)},179228,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(433217),e=a.i(370025),f=a.i(937927),g=a.i(913216),h=a.i(269240),i=a.i(703130),j=a.i(340695),k=a.i(205522),l=a.i(917171),m=a.i(280281),n=a.i(864037),o=a.i(400210),p=a.i(114548),q=a.i(469769),r=a.i(267900),s=a.i(481402),t=a.i(669520),u=a.i(290821),v=a.i(797063),w=a.i(238246),x=a.i(887682);function y(){let{user:a}=(0,g.useAuth)(),y=(0,h.createClient)(),z=(0,f.useQueryClient)(),{addToast:A}=(0,n.useToast)(),[B,C]=(0,c.useState)({organization_id:a?.organization_id||"",provider_name:"",siret_number:"",api_endpoint:"https://api.moncompteformation.gouv.fr",is_active:!1,sync_frequency:"daily"}),[D,E]=(0,c.useState)(!1),{data:F,isLoading:G}=(0,d.useQuery)({queryKey:["cpf-configuration",a?.organization_id],queryFn:async()=>{if(!a?.organization_id)return null;let{data:b,error:c}=await y.from("cpf_configurations").select("*").eq("organization_id",a.organization_id).single();if(c){if("PGRST116"===c.code)return null;throw c}return b},enabled:!!a?.organization_id,retry:!1});(0,c.useEffect)(()=>{F&&C({...F,organization_id:a?.organization_id||""})},[F,a?.organization_id]);let H=(0,e.useMutation)({mutationFn:async b=>{if(!a?.organization_id)throw Error("Organisation non trouvée");let c={...b,organization_id:a.organization_id,updated_at:new Date().toISOString()};if(F?.id){let{data:a,error:b}=await y.from("cpf_configurations").update(c).eq("id",F.id).select().single();if(b)throw b;return a}{let{data:a,error:b}=await y.from("cpf_configurations").insert({...c,created_at:new Date().toISOString()}).select().single();if(b){if("PGRST116"===b.code||"42P01"===b.code)throw Error("La table cpf_configurations n'existe pas encore. Veuillez exécuter les migrations Supabase.");throw b}return a}},onSuccess:()=>{A({type:"success",title:"Configuration sauvegardée",description:"La configuration CPF a été enregistrée avec succès."}),z.invalidateQueries({queryKey:["cpf-configuration",a?.organization_id]})},onError:a=>{A({type:"error",title:"Erreur lors de la sauvegarde",description:a?.message||"Une erreur est survenue lors de la sauvegarde de la configuration."})}}),I=async a=>{a.preventDefault(),E(!0);try{await H.mutateAsync(B)}finally{E(!1)}},J=async()=>{A({type:"info",title:"Synchronisation",description:"La synchronisation avec Mon Compte Formation sera disponible prochainement."})};return G?(0,b.jsx)("div",{className:"container mx-auto py-8 px-4",children:(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(t.RefreshCw,{className:"h-8 w-8 animate-spin text-brand-blue"})})}):(0,b.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsx)(w.default,{href:"/dashboard/cpf",children:(0,b.jsxs)(j.Button,{variant:"ghost",className:"mb-4",children:[(0,b.jsx)(o.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Retour"]})}),(0,b.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,b.jsx)(q.GraduationCap,{className:"h-8 w-8 text-brand-blue"}),"Configuration CPF"]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Configurez l'intégration avec Mon Compte Formation pour votre organisation"})]}),H.error?.message?.includes("n'existe pas")&&(0,b.jsx)(i.Card,{className:"mb-6 border-yellow-200 bg-yellow-50",children:(0,b.jsx)(i.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(u.AlertCircle,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold text-yellow-900 mb-1",children:"Table manquante"}),(0,b.jsx)("p",{className:"text-sm text-yellow-800",children:"La table cpf_configurations n'existe pas encore dans votre base de données. Veuillez exécuter les migrations Supabase nécessaires."})]})]})})}),(0,b.jsx)("form",{onSubmit:I,children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(i.Card,{children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(r.Building2,{className:"h-5 w-5"}),"Informations de l'organisme"]}),(0,b.jsx)(i.CardDescription,{children:"Informations requises pour l'intégration avec Mon Compte Formation"})]}),(0,b.jsxs)(i.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"provider_name",children:"Nom de l'organisme *"}),(0,b.jsx)(k.Input,{id:"provider_name",value:B.provider_name,onChange:a=>C({...B,provider_name:a.target.value}),placeholder:"Nom de votre organisme de formation",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"siret_number",children:"Numéro SIRET *"}),(0,b.jsx)(k.Input,{id:"siret_number",value:B.siret_number,onChange:a=>C({...B,siret_number:a.target.value}),placeholder:"12345678901234",required:!0,maxLength:14})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"cpf_provider_number",children:"Numéro d'organisme CPF (optionnel)"}),(0,b.jsx)(k.Input,{id:"cpf_provider_number",value:B.cpf_provider_number||"",onChange:a=>C({...B,cpf_provider_number:a.target.value}),placeholder:"Numéro attribué par Mon Compte Formation"})]})]})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(s.Key,{className:"h-5 w-5"}),"Configuration API"]}),(0,b.jsx)(i.CardDescription,{children:"Paramètres de connexion à l'API Mon Compte Formation"})]}),(0,b.jsxs)(i.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"api_endpoint",children:"Endpoint API *"}),(0,b.jsx)(k.Input,{id:"api_endpoint",value:B.api_endpoint,onChange:a=>C({...B,api_endpoint:a.target.value}),placeholder:"https://api.moncompteformation.gouv.fr",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"api_key",children:"Clé API (optionnel)"}),(0,b.jsx)(k.Input,{id:"api_key",type:"password",value:B.api_key||"",onChange:a=>C({...B,api_key:a.target.value}),placeholder:"Votre clé API"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"La clé API sera stockée de manière sécurisée"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"api_secret",children:"Secret API (optionnel)"}),(0,b.jsx)(k.Input,{id:"api_secret",type:"password",value:B.api_secret||"",onChange:a=>C({...B,api_secret:a.target.value}),placeholder:"Votre secret API"})]})]})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsxs)(i.CardHeader,{children:[(0,b.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(t.RefreshCw,{className:"h-5 w-5"}),"Paramètres de synchronisation"]}),(0,b.jsx)(i.CardDescription,{children:"Configurez la fréquence de synchronisation avec Mon Compte Formation"})]}),(0,b.jsxs)(i.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(l.Label,{htmlFor:"sync_frequency",children:"Fréquence de synchronisation *"}),(0,b.jsxs)(x.Select,{value:B.sync_frequency,onValueChange:a=>C({...B,sync_frequency:a}),children:[(0,b.jsx)(x.SelectTrigger,{children:(0,b.jsx)(x.SelectValue,{})}),(0,b.jsxs)(x.SelectContent,{children:[(0,b.jsx)(x.SelectItem,{value:"manual",children:"Manuelle"}),(0,b.jsx)(x.SelectItem,{value:"hourly",children:"Toutes les heures"}),(0,b.jsx)(x.SelectItem,{value:"daily",children:"Quotidienne"}),(0,b.jsx)(x.SelectItem,{value:"weekly",children:"Hebdomadaire"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)(l.Label,{htmlFor:"is_active",children:"Activer la synchronisation"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Activez la synchronisation automatique avec Mon Compte Formation"})]}),(0,b.jsx)(m.Switch,{checked:B.is_active,onCheckedChange:a=>C({...B,is_active:a})})]}),F?.last_sync_date&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsx)(v.Info,{className:"h-4 w-4"}),(0,b.jsxs)("span",{children:["Dernière synchronisation :"," ",new Date(F.last_sync_date).toLocaleString("fr-FR")]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(j.Button,{type:"button",variant:"outline",onClick:J,disabled:!B.is_active||!F,children:[(0,b.jsx)(t.RefreshCw,{className:"h-4 w-4 mr-2"}),"Synchroniser maintenant"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(w.default,{href:"/dashboard/cpf",children:(0,b.jsx)(j.Button,{type:"button",variant:"outline",children:"Annuler"})}),(0,b.jsx)(j.Button,{type:"submit",disabled:D||H.isPending,children:D||H.isPending?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(t.RefreshCw,{className:"h-4 w-4 mr-2 animate-spin"}),"Enregistrement..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.Save,{className:"h-4 w-4 mr-2"}),"Enregistrer"]})})]})]})]})})]})}a.s(["default",()=>y])}];

//# sourceMappingURL=_6031b683._.js.map