module.exports=[224361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},814747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},915618,a=>{"use strict";let b=(0,a.i(170106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],915618)},177156,a=>{"use strict";let b=(0,a.i(170106).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>b],177156)},683245,a=>{"use strict";let b=(0,a.i(170106).default)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);a.s(["Edit",()=>b],683245)},254799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},522734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},500874,(a,b,c)=>{b.exports=a.x("buffer",()=>require("buffer"))},688947,(a,b,c)=>{b.exports=a.x("stream",()=>require("stream"))},501199,a=>{"use strict";let b=(0,a.i(170106).default)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);a.s(["Receipt",()=>b],501199)},767552,a=>{"use strict";let b=(0,a.i(170106).default)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);a.s(["ChevronUp",()=>b],767552)},595583,a=>{"use strict";function b(a){let{student:b,organization:d,session:e,invoice:f,program:g,academicYear:h,language:i="fr",issueDate:j=new Date().toISOString()}=a;return{date_emission:new Date().toLocaleDateString("fr-FR"),date_aujourd_hui:new Date().toLocaleDateString("fr-FR"),date_jour:new Date().toLocaleDateString("fr-FR"),annee_courante:new Date().getFullYear().toString(),annee_actuelle:new Date().getFullYear().toString(),date_generation:new Date().toLocaleDateString("fr-FR"),heure:new Date().toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),ecole_nom:d?.name||"",ecole_logo:d?.logo_url||"",ecole_adresse:d?.address||"",ecole_ville:(d?.address||"").split(",").pop()?.trim()||"",ecole_telephone:d?.phone||"",ecole_email:d?.email||"",ecole_site_web:d?.website||"",ecole_code_postal:(d?.address||"").match(/\d{5}/)?.[0]||"",organisation_nom:d?.name||"",organisation_adresse:d?.address||"",organisation_telephone:d?.phone||"",organisation_email:d?.email||"",organisation_logo:d?.logo_url||"",organisation_site_web:d?.website||"",eleve_nom:b?.last_name||"",eleve_prenom:b?.first_name||"",eleve_numero:b?.student_number||"",eleve_date_naissance:b?.date_of_birth?new Date(b.date_of_birth).toLocaleDateString("fr-FR"):"",eleve_classe:b?.classes?b.classes.name:"",eleve_photo:b?.photo_url||"",eleve_adresse:b?.address||"",eleve_telephone:b?.phone||"",eleve_email:b?.email||"",etudiant_nom:b?.last_name||"",etudiant_prenom:b?.first_name||"",etudiant_nom_complet:b?`${b.first_name} ${b.last_name}`:"",etudiant_numero:b?.student_number||"",etudiant_date_naissance:b?.date_of_birth?new Date(b.date_of_birth).toLocaleDateString("fr-FR"):"",etudiant_adresse:b?.address||"",etudiant_telephone:b?.phone||"",etudiant_email:b?.email||"",etudiant_photo:b?.photo_url||"",classe_nom:b?.classes?b.classes.name:"",annee_academique:h?.name||new Date().getFullYear().toString(),annee_scolaire:h?.name||new Date().getFullYear().toString(),session_nom:e?.name||"",session_debut:e?.start_date?new Date(e.start_date).toLocaleDateString("fr-FR"):"",session_fin:e?.end_date?new Date(e.end_date).toLocaleDateString("fr-FR"):"",session_date_debut:e?.start_date?new Date(e.start_date).toLocaleDateString("fr-FR"):"",session_date_fin:e?.end_date?new Date(e.end_date).toLocaleDateString("fr-FR"):"",formation_nom:e?.formations?.name||"",formation_duree:e?.formations?.duration_hours?`${e.formations?.duration_hours} heures`:"",formation_objectifs:e?.formations?.objectives||g?.objectives||"",formation_public_concerne:e?.formations?.target_audience||g?.target_audience||"",formation_prerequis:e?.formations?.prerequisites||g?.prerequisites||"",formation_qualite_et_resultats:e?.formations?.quality_indicators||g?.quality_indicators||"",formation_contenu:e?.formations?.content||g?.content||"",formation_equipe_pedagogique:e?.formations?.pedagogical_team||g?.pedagogical_team||"",formation_ressources:e?.formations?.resources||g?.resources||"",formation_supports:e?.formations?.materials||g?.materials||"",session_lieu:e?.location||e?.venue||"",session_effectif:e?.enrollment_count?.toString()||e?.student_count?.toString()||"",diplome_ou_certification:e?.formations?.certification||g?.certification||"",ecole_region:d?.region||d?.administrative_region||"",programme_nom:g?.name||e?.formations?.programs?.name||"",programme_code:g?.code||"",programme_description:g?.description||"",programme_objectifs:g?.objectives||"",programme_duree_totale:g?.formations?`${g.formations.reduce((a,b)=>a+(b.duration_hours||0),0)} heures`:"",programme_nombre_formations:g?.formations?`${g.formations.length}`:"",programme_nombre_sessions:"",programme_public_concerne:g?.target_audience||"",programme_modalites:g?.modalities||"",programme_certification:g?.certification||"",numero_facture:f?.invoice_number||"",facture_numero:f?.invoice_number||"",facture_date_emission:f?.issue_date?new Date(f.issue_date).toLocaleDateString("fr-FR"):"",facture_date_echeance:f?.due_date?new Date(f.due_date).toLocaleDateString("fr-FR"):"",date_echeance:f?.due_date?new Date(f.due_date).toLocaleDateString("fr-FR"):"",montant:f?.amount?Number(f.amount).toFixed(2):"0.00",montant_ht:f?.amount?Number(f.amount).toFixed(2):"0.00",montant_ttc:f?.total_amount?Number(f.total_amount).toFixed(2):"0.00",tva:f?.tax_amount?Number(f.tax_amount).toFixed(2):"0.00",taux_tva:f?.tax_amount&&f?.amount?(Number(f.tax_amount)/Number(f.amount)*100).toFixed(2):"0.00",facture_montant:f?.amount?Number(f.amount).toFixed(2):"0.00",facture_tva:f?.tax_amount?Number(f.tax_amount).toFixed(2):"0.00",facture_total:f?.total_amount?Number(f.total_amount).toFixed(2):"0.00",facture_devise:f?.currency||"EUR",facture_items:f?.items?JSON.stringify(f.items):"[]",montant_lettres:f?.total_amount?function(a,b="fr"){return"en"===b?a.toFixed(2)+" euros":function a(b){if(0===b)return"zéro euro";if(b<0)return"moins "+a(-b);let d=Math.floor(b),e=Math.round((b-d)*100),f=c(d);return e>0&&(f+=" virgule "+c(e)),f+(d>1?" euros":" euro")}(a)}(Number(f.total_amount),i):"",mode_paiement:f?.payment_method||"",date_paiement:f?.paid_at?new Date(f.paid_at).toLocaleDateString("fr-FR"):"",ecole_siret:d?.siret||"",ecole_numero_declaration:d?.declaration_number||"",ecole_representant:d?.representative_name||"",langue:i}}function c(a){if(0===a)return"";if(a<10)return["","un","deux","trois","quatre","cinq","six","sept","huit","neuf"][a];if(a<20)return["dix","onze","douze","treize","quatorze","quinze","seize","dix-sept","dix-huit","dix-neuf"][a-10];if(a<100){let b=Math.floor(a/10),d=a%10,e=["","","vingt","trente","quarante","cinquante","soixante","soixante","quatre-vingt","quatre-vingt"][b];return 7===b||9===b?e+="-"+(1===d?"et-":"")+c(10+d):d>0?e+=(1===d&&8!==b?"-et-":"-")+c(d):8===b&&(e+="s"),e}if(a<1e3){let b=Math.floor(a/100),d=a%100,e=1===b?"cent":c(b)+"-cent";return d>0?e+="-"+c(d):b>1&&(e+="s"),e}if(a<1e6){let b=Math.floor(a/1e3),d=a%1e3,e=1===b?"mille":c(b)+"-mille";return d>0&&(e+="-"+c(d)),e}return a.toString()}function d(a){return({attestation:"attestation_reussite",certificate:"certificat_scolarite",invoice:"facture",receipt:"facture",transcript:"releve_notes",report_card:"releve_notes",convocation:"convocation",contract:"contrat"})[a]||a}a.s(["extractDocumentVariables",()=>b,"mapDocumentTypeToTemplateType",()=>d])},371791,653277,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getCategories(a){let{data:b,error:c}=await this.supabase.from("charge_categories").select("*").eq("organization_id",a).eq("is_active",!0).order("name",{ascending:!0});return c?(console.error("Erreur récupération catégories:",c),[]):b||[]}async createCategory(a,b){let{data:c,error:d}=await this.supabase.from("charge_categories").insert({...b,organization_id:a}).select().single();if(d)throw d;return c}async initDefaultCategories(a){let{error:b}=await this.supabase.rpc("init_default_charge_categories",{p_organization_id:a});if(b)throw b}async getBySession(a){let{data:b,error:c}=await this.supabase.from("session_charges").select(`
        *,
        charge_categories(*)
      `).eq("session_id",a).order("charge_date",{ascending:!1});return c?(console.error("Erreur récupération charges:",c),[]):b||[]}async getAll(a,b){let c=this.supabase.from("session_charges").select(`
        *,
        charge_categories(*),
        sessions(id, name)
      `).eq("organization_id",a);b?.sessionId&&(c=c.eq("session_id",b.sessionId)),b?.categoryId&&(c=c.eq("category_id",b.categoryId)),b?.paymentStatus&&(c=c.eq("payment_status",b.paymentStatus)),b?.startDate&&(c=c.gte("charge_date",b.startDate)),b?.endDate&&(c=c.lte("charge_date",b.endDate));let{data:d,error:e}=await c.order("charge_date",{ascending:!1});return e?(console.error("Erreur récupération charges:",e),[]):d||[]}async getById(a){let{data:b,error:c}=await this.supabase.from("session_charges").select(`
        *,
        charge_categories(*),
        sessions(id, name)
      `).eq("id",a).single();if(c){if("PGRST116"===c.code)return null;throw c}return b}async create(a,b,c){let{data:d,error:e}=await this.supabase.from("session_charges").insert({...c,organization_id:a,session_id:b}).select(`
        *,
        charge_categories(*)
      `).single();if(e)throw e;return d}async update(a,b){let{data:c,error:d}=await this.supabase.from("session_charges").update(b).eq("id",a).select(`
        *,
        charge_categories(*)
      `).single();if(d)throw d;return c}async delete(a){let{error:b}=await this.supabase.from("session_charges").delete().eq("id",a);if(b)throw b}async getSessionSummary(a){let{data:b,error:c}=await this.supabase.rpc("calculate_session_charges_total",{p_session_id:a});return c?(console.error("Erreur calcul résumé charges:",c),null):b&&0!==b.length?{total_amount:Number(b[0].total_amount)||0,paid_amount:Number(b[0].paid_amount)||0,pending_amount:Number(b[0].pending_amount)||0,charge_count:Number(b[0].charge_count)||0}:{total_amount:0,paid_amount:0,pending_amount:0,charge_count:0}}};a.s(["sessionChargesService",0,c],371791);let d=(0,a.i(170106).default)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);a.s(["TrendingDown",()=>d],653277)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__aa2dab29._.js.map