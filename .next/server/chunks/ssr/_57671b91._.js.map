{"version":3,"sources":["../../../../node_modules/lucide-react/src/icons/plus.ts","../../../../node_modules/lucide-react/src/icons/arrow-left.ts","../../../../node_modules/lucide-react/src/icons/clock.ts","../../../../node_modules/lucide-react/src/icons/check-circle.ts","../../../../node_modules/lucide-react/src/icons/save.ts","../../../../node_modules/lucide-react/src/icons/mail.ts","../../../../node_modules/lucide-react/src/icons/x-circle.ts","../../../../components/ui/tabs.tsx","../../../../node_modules/lucide-react/src/icons/send.ts","../../../../lib/errors/error-handler.ts","../../../../lib/utils/supabase-helpers.ts","../../../../lib/services/session.service.ts","../../../../lib/services/videoconference.service.ts","../../../../components/ui/checkbox.tsx","../../../../components/ui/alert.tsx","../../../../node_modules/date-fns/esm/endOfMonth/index.js","../../../../node_modules/date-fns/esm/formatDistance/index.js","../../../../node_modules/date-fns/esm/compareAsc/index.js","../../../../node_modules/date-fns/esm/differenceInCalendarMonths/index.js","../../../../node_modules/date-fns/esm/endOfDay/index.js","../../../../node_modules/date-fns/esm/isLastDayOfMonth/index.js","../../../../node_modules/date-fns/esm/differenceInMonths/index.js","../../../../node_modules/date-fns/esm/differenceInMilliseconds/index.js","../../../../node_modules/date-fns/esm/_lib/roundingMethods/index.js","../../../../node_modules/date-fns/esm/differenceInSeconds/index.js","../../../../node_modules/date-fns/esm/_lib/assign/index.js","../../../../node_modules/date-fns/esm/_lib/cloneObject/index.js","../../../../node_modules/date-fns/esm/formatDistanceToNow/index.js","../../../../lib/services/attendance.service.ts","../../../../app/%28dashboard%29/dashboard/sessions/%5Bid%5D/attendance/page.tsx"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Plus\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNSAxMmgxNCIgLz4KICA8cGF0aCBkPSJNMTIgNXYxNCIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/plus\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Plus = createLucideIcon('Plus', [\n  ['path', { d: 'M5 12h14', key: '1ays0h' }],\n  ['path', { d: 'M12 5v14', key: 's699le' }],\n]);\n\nexport default Plus;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ArrowLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTIgMTktNy03IDctNyIgLz4KICA8cGF0aCBkPSJNMTkgMTJINSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeft = createLucideIcon('ArrowLeft', [\n  ['path', { d: 'm12 19-7-7 7-7', key: '1l729n' }],\n  ['path', { d: 'M19 12H5', key: 'x3x0zl' }],\n]);\n\nexport default ArrowLeft;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Clock\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8cG9seWxpbmUgcG9pbnRzPSIxMiA2IDEyIDEyIDE2IDE0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/clock\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Clock = createLucideIcon('Clock', [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['polyline', { points: '12 6 12 12 16 14', key: '68esgv' }],\n]);\n\nexport default Clock;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name CheckCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjIgMTEuMDhWMTJhMTAgMTAgMCAxIDEtNS45My05LjE0IiAvPgogIDxwYXRoIGQ9Im05IDExIDMgM0wyMiA0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/check-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst CheckCircle = createLucideIcon('CheckCircle', [\n  ['path', { d: 'M22 11.08V12a10 10 0 1 1-5.93-9.14', key: 'g774vq' }],\n  ['path', { d: 'm9 11 3 3L22 4', key: '1pflzl' }],\n]);\n\nexport default CheckCircle;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Save\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTkgMjFINWEyIDIgMCAwIDEtMi0yVjVhMiAyIDAgMCAxIDItMmgxMWw1IDV2MTFhMiAyIDAgMCAxLTIgMnoiIC8+CiAgPHBvbHlsaW5lIHBvaW50cz0iMTcgMjEgMTcgMTMgNyAxMyA3IDIxIiAvPgogIDxwb2x5bGluZSBwb2ludHM9IjcgMyA3IDggMTUgOCIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/save\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Save = createLucideIcon('Save', [\n  ['path', { d: 'M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z', key: '1owoqh' }],\n  ['polyline', { points: '17 21 17 13 7 13 7 21', key: '1md35c' }],\n  ['polyline', { points: '7 3 7 8 15 8', key: '8nz8an' }],\n]);\n\nexport default Save;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Mail\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cmVjdCB3aWR0aD0iMjAiIGhlaWdodD0iMTYiIHg9IjIiIHk9IjQiIHJ4PSIyIiAvPgogIDxwYXRoIGQ9Im0yMiA3LTguOTcgNS43YTEuOTQgMS45NCAwIDAgMS0yLjA2IDBMMiA3IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/mail\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Mail = createLucideIcon('Mail', [\n  ['rect', { width: '20', height: '16', x: '2', y: '4', rx: '2', key: '18n3k1' }],\n  ['path', { d: 'm22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7', key: '1ocrg3' }],\n]);\n\nexport default Mail;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name XCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8cGF0aCBkPSJtMTUgOS02IDYiIC8+CiAgPHBhdGggZD0ibTkgOSA2IDYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/x-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst XCircle = createLucideIcon('XCircle', [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['path', { d: 'm15 9-6 6', key: '1uzhvr' }],\n  ['path', { d: 'm9 9 6 6', key: 'z0biqf' }],\n]);\n\nexport default XCircle;\n","'use client'\n\nimport * as React from 'react'\nimport { cn } from '@/lib/utils'\n\ninterface TabsContextValue {\n  value: string\n  onValueChange: (value: string) => void\n}\n\nconst TabsContext = React.createContext<TabsContextValue | undefined>(undefined)\n\ninterface TabsProps {\n  value?: string\n  defaultValue?: string\n  onValueChange?: (value: string) => void\n  children: React.ReactNode\n  className?: string\n}\n\nexport function Tabs({ value: controlledValue, defaultValue, onValueChange, children, className }: TabsProps) {\n  const isControlled = controlledValue !== undefined\n  const [uncontrolledValue, setUncontrolledValue] = React.useState<string>(defaultValue ?? '')\n\n  // Si defaultValue arrive plus tard (montage), on l'applique uniquement en mode non contrôlé\n  React.useEffect(() => {\n    if (!isControlled && defaultValue !== undefined) {\n      setUncontrolledValue(defaultValue)\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [defaultValue])\n\n  const currentValue = isControlled ? (controlledValue as string) : uncontrolledValue\n  const handleValueChange = React.useCallback(\n    (nextValue: string) => {\n      if (!isControlled) setUncontrolledValue(nextValue)\n      onValueChange?.(nextValue)\n    },\n    [isControlled, onValueChange]\n  )\n\n  return (\n    <TabsContext.Provider value={{ value: currentValue, onValueChange: handleValueChange }}>\n      <div className={cn('w-full', className)}>{children}</div>\n    </TabsContext.Provider>\n  )\n}\n\nfunction useTabsContext() {\n  const context = React.useContext(TabsContext)\n  if (!context) {\n    throw new Error('Tabs components must be used within a Tabs component')\n  }\n  return context\n}\n\ninterface TabsListProps {\n  children: React.ReactNode\n  className?: string\n}\n\nexport function TabsList({ children, className }: TabsListProps) {\n  return (\n    <div\n      className={cn(\n        'inline-flex h-10 items-center justify-center rounded-lg bg-bg-gray-100 p-1 text-text-tertiary',\n        className\n      )}\n    >\n      {children}\n    </div>\n  )\n}\n\ninterface TabsTriggerProps {\n  value: string\n  children: React.ReactNode\n  className?: string\n}\n\nexport function TabsTrigger({ value, children, className }: TabsTriggerProps) {\n  const { value: selectedValue, onValueChange } = useTabsContext()\n  const isSelected = selectedValue === value\n\n  return (\n    <button\n      type=\"button\"\n      onClick={() => onValueChange(value)}\n      className={cn(\n        'inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-outline-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50',\n        isSelected\n          ? 'bg-white text-text-primary shadow-sm'\n          : 'text-text-tertiary hover:text-text-primary',\n        className\n      )}\n    >\n      {children}\n    </button>\n  )\n}\n\ninterface TabsContentProps {\n  value: string\n  children: React.ReactNode\n  className?: string\n}\n\nexport function TabsContent({ value, children, className }: TabsContentProps) {\n  const { value: selectedValue } = useTabsContext()\n  \n  if (selectedValue !== value) {\n    return null\n  }\n\n  return (\n    <div\n      className={cn(\n        'mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2',\n        className\n      )}\n    >\n      {children}\n    </div>\n  )\n}\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Send\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMjIgMi03IDIwLTQtOS05LTRaIiAvPgogIDxwYXRoIGQ9Ik0yMiAyIDExIDEzIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/send\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Send = createLucideIcon('Send', [\n  ['path', { d: 'm22 2-7 20-4-9-9-4Z', key: '1q3vgg' }],\n  ['path', { d: 'M22 2 11 13', key: 'nzbqef' }],\n]);\n\nexport default Send;\n","/**\n * ErrorHandler Global - Gestion centralisée des erreurs\n * \n * Fournit :\n * - Types d'erreurs personnalisés\n * - Classification automatique des erreurs\n * - Messages utilisateur traduits\n * - Logging automatique\n * - Formatage cohérent\n */\n\nimport { logger } from '@/lib/utils/logger'\nimport type { LogContext } from '@/lib/utils/logger'\n\n// ============================================================================\n// TYPES D'ERREURS PERSONNALISÉS\n// ============================================================================\n\nexport enum ErrorCode {\n  // Erreurs d'authentification (1000-1999)\n  AUTH_REQUIRED = 'AUTH_1001',\n  AUTH_INVALID_CREDENTIALS = 'AUTH_1002',\n  AUTH_SESSION_EXPIRED = 'AUTH_1003',\n  AUTH_INSUFFICIENT_PERMISSIONS = 'AUTH_1004',\n  AUTH_2FA_REQUIRED = 'AUTH_1005',\n  AUTH_2FA_INVALID = 'AUTH_1006',\n\n  // Erreurs de validation (2000-2999)\n  VALIDATION_ERROR = 'VALID_2001',\n  VALIDATION_REQUIRED_FIELD = 'VALID_2002',\n  VALIDATION_INVALID_FORMAT = 'VALID_2003',\n  VALIDATION_UNIQUE_CONSTRAINT = 'VALID_2004',\n\n  // Erreurs de base de données (3000-3999)\n  DB_CONNECTION_ERROR = 'DB_3001',\n  DB_QUERY_ERROR = 'DB_3002',\n  DB_NOT_FOUND = 'DB_3003',\n  DB_CONSTRAINT_VIOLATION = 'DB_3004',\n  DB_FOREIGN_KEY_CONSTRAINT = 'DB_3006',\n  DB_RLS_POLICY_VIOLATION = 'DB_3005',\n\n  // Erreurs réseau/API (4000-4999)\n  NETWORK_ERROR = 'NET_4001',\n  API_TIMEOUT = 'NET_4002',\n  API_RATE_LIMIT = 'NET_4003',\n  API_SERVER_ERROR = 'NET_4004',\n  API_NOT_FOUND = 'NET_4005',\n  API_BAD_REQUEST = 'NET_4006',\n\n  // Erreurs métier (5000-5999)\n  BUSINESS_LOGIC_ERROR = 'BIZ_5001',\n  RESOURCE_LOCKED = 'BIZ_5002',\n  OPERATION_NOT_ALLOWED = 'BIZ_5003',\n  QUOTA_EXCEEDED = 'BIZ_5004',\n\n  // Erreurs système (6000-6999)\n  INTERNAL_ERROR = 'SYS_6001',\n  CONFIGURATION_ERROR = 'SYS_6002',\n  SERVICE_UNAVAILABLE = 'SYS_6003',\n}\n\nexport enum ErrorSeverity {\n  LOW = 'low',\n  MEDIUM = 'medium',\n  HIGH = 'high',\n  CRITICAL = 'critical',\n}\n\nexport interface AppErrorContext extends LogContext {\n  code?: ErrorCode\n  severity?: ErrorSeverity\n  userMessage?: string\n  retryable?: boolean\n  timestamp?: string\n}\n\n/**\n * Classe d'erreur personnalisée pour l'application\n */\nexport class AppError extends Error {\n  public readonly code: ErrorCode\n  public readonly severity: ErrorSeverity\n  public readonly userMessage: string\n  public readonly retryable: boolean\n  public readonly context: AppErrorContext\n  public readonly originalError?: Error | unknown\n\n  constructor(\n    message: string,\n    code: ErrorCode = ErrorCode.INTERNAL_ERROR,\n    severity: ErrorSeverity = ErrorSeverity.MEDIUM,\n    context: AppErrorContext = {},\n    originalError?: Error | unknown\n  ) {\n    super(message)\n    this.name = 'AppError'\n    this.code = code\n    this.severity = severity\n    this.userMessage = context.userMessage || this.getDefaultUserMessage(code)\n    this.retryable = context.retryable ?? this.isRetryable(code)\n    this.context = {\n      ...context,\n      code,\n      severity,\n      timestamp: new Date().toISOString(),\n    }\n    this.originalError = originalError\n\n    // Maintenir la stack trace\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, AppError)\n    }\n  }\n\n  /**\n   * Messages utilisateur par défaut selon le code d'erreur\n   */\n  private getDefaultUserMessage(code: ErrorCode): string {\n    const messages: Record<ErrorCode, string> = {\n      // Auth\n      [ErrorCode.AUTH_REQUIRED]: 'Vous devez être connecté pour effectuer cette action.',\n      [ErrorCode.AUTH_INVALID_CREDENTIALS]: 'Email ou mot de passe incorrect.',\n      [ErrorCode.AUTH_SESSION_EXPIRED]: 'Votre session a expiré. Veuillez vous reconnecter.',\n      [ErrorCode.AUTH_INSUFFICIENT_PERMISSIONS]: \"Vous n'avez pas les permissions nécessaires.\",\n      [ErrorCode.AUTH_2FA_REQUIRED]: 'Authentification à deux facteurs requise.',\n      [ErrorCode.AUTH_2FA_INVALID]: 'Code d\\'authentification invalide.',\n\n      // Validation\n      [ErrorCode.VALIDATION_ERROR]: 'Les données fournies ne sont pas valides.',\n      [ErrorCode.VALIDATION_REQUIRED_FIELD]: 'Certains champs obligatoires sont manquants.',\n      [ErrorCode.VALIDATION_INVALID_FORMAT]: 'Le format des données est incorrect.',\n      [ErrorCode.VALIDATION_UNIQUE_CONSTRAINT]: 'Cette valeur existe déjà.',\n\n      // Database\n      [ErrorCode.DB_CONNECTION_ERROR]: 'Impossible de se connecter à la base de données.',\n      [ErrorCode.DB_QUERY_ERROR]: 'Erreur lors de l\\'exécution de la requête.',\n      [ErrorCode.DB_NOT_FOUND]: 'Ressource introuvable.',\n      [ErrorCode.DB_CONSTRAINT_VIOLATION]: 'Cette opération viole une contrainte de la base de données.',\n      [ErrorCode.DB_FOREIGN_KEY_CONSTRAINT]: 'Cette opération viole une contrainte de clé étrangère.',\n      [ErrorCode.DB_RLS_POLICY_VIOLATION]: 'Vous n\\'avez pas accès à cette ressource.',\n\n      // Network\n      [ErrorCode.NETWORK_ERROR]: 'Erreur de connexion réseau. Vérifiez votre connexion internet.',\n      [ErrorCode.API_TIMEOUT]: 'La requête a pris trop de temps. Veuillez réessayer.',\n      [ErrorCode.API_RATE_LIMIT]: 'Trop de requêtes. Veuillez patienter quelques instants.',\n      [ErrorCode.API_SERVER_ERROR]: 'Erreur serveur. Veuillez réessayer plus tard.',\n      [ErrorCode.API_NOT_FOUND]: 'Ressource introuvable.',\n      [ErrorCode.API_BAD_REQUEST]: 'Requête invalide.',\n\n      // Business\n      [ErrorCode.BUSINESS_LOGIC_ERROR]: 'Cette opération n\\'est pas autorisée dans le contexte actuel.',\n      [ErrorCode.RESOURCE_LOCKED]: 'Cette ressource est actuellement verrouillée.',\n      [ErrorCode.OPERATION_NOT_ALLOWED]: 'Cette opération n\\'est pas autorisée.',\n      [ErrorCode.QUOTA_EXCEEDED]: 'Vous avez atteint la limite autorisée.',\n\n      // System\n      [ErrorCode.INTERNAL_ERROR]: 'Une erreur interne est survenue. Veuillez réessayer.',\n      [ErrorCode.CONFIGURATION_ERROR]: 'Erreur de configuration du système.',\n      [ErrorCode.SERVICE_UNAVAILABLE]: 'Service temporairement indisponible.',\n    }\n\n    return messages[code] || 'Une erreur inattendue est survenue.'\n  }\n\n  /**\n   * Détermine si une erreur est retryable selon son code\n   */\n  private isRetryable(code: ErrorCode): boolean {\n    const retryableCodes = [\n      ErrorCode.NETWORK_ERROR,\n      ErrorCode.API_TIMEOUT,\n      ErrorCode.API_SERVER_ERROR,\n      ErrorCode.DB_CONNECTION_ERROR,\n      ErrorCode.SERVICE_UNAVAILABLE,\n    ]\n    return retryableCodes.includes(code)\n  }\n\n  /**\n   * Convertit l'erreur en objet JSON pour logging\n   */\n  toJSON() {\n    return {\n      name: this.name,\n      message: this.message,\n      code: this.code,\n      severity: this.severity,\n      userMessage: this.userMessage,\n      retryable: this.retryable,\n      context: this.context,\n      stack: this.stack,\n      originalError: this.originalError instanceof Error\n        ? {\n            name: this.originalError.name,\n            message: this.originalError.message,\n            stack: this.originalError.stack,\n          }\n        : this.originalError,\n    }\n  }\n}\n\n// ============================================================================\n// ERROR HANDLER PRINCIPAL\n// ============================================================================\n\nexport class ErrorHandler {\n  /**\n   * Analyse et classe une erreur inconnue\n   */\n  handleError(error: unknown, context: AppErrorContext = {}): AppError {\n    // Si c'est déjà une AppError, la retourner telle quelle\n    if (error instanceof AppError) {\n      this.logError(error)\n      return error\n    }\n\n    // Si c'est une Error standard, la convertir\n    if (error instanceof Error) {\n      return this.handleStandardError(error, context)\n    }\n\n    // Si c'est une erreur Supabase\n    if (this.isSupabaseError(error)) {\n      return this.handleSupabaseError(error, context)\n    }\n\n    // Erreur inconnue\n    const appError = new AppError(\n      'Une erreur inattendue est survenue.',\n      ErrorCode.INTERNAL_ERROR,\n      ErrorSeverity.HIGH,\n      context,\n      error\n    )\n    this.logError(appError)\n    return appError\n  }\n\n  /**\n   * Gère les erreurs Error standard\n   */\n  private handleStandardError(error: Error, context: AppErrorContext): AppError {\n    const message = error.message.toLowerCase()\n\n    // Détection par message\n    let code = ErrorCode.INTERNAL_ERROR\n    let severity = ErrorSeverity.MEDIUM\n\n    if (message.includes('network') || message.includes('fetch')) {\n      code = ErrorCode.NETWORK_ERROR\n      severity = ErrorSeverity.MEDIUM\n    } else if (message.includes('timeout')) {\n      code = ErrorCode.API_TIMEOUT\n      severity = ErrorSeverity.MEDIUM\n    } else if (message.includes('unauthorized') || message.includes('401')) {\n      code = ErrorCode.AUTH_REQUIRED\n      severity = ErrorSeverity.HIGH\n    } else if (message.includes('forbidden') || message.includes('403')) {\n      code = ErrorCode.AUTH_INSUFFICIENT_PERMISSIONS\n      severity = ErrorSeverity.HIGH\n    } else if (message.includes('not found') || message.includes('404')) {\n      code = ErrorCode.DB_NOT_FOUND\n      severity = ErrorSeverity.LOW\n    } else if (message.includes('validation') || message.includes('invalid')) {\n      code = ErrorCode.VALIDATION_ERROR\n      severity = ErrorSeverity.LOW\n    }\n\n    const appError = new AppError(error.message, code, severity, context, error)\n    this.logError(appError)\n    return appError\n  }\n\n  /**\n   * Gère les erreurs Supabase\n   */\n  private handleSupabaseError(error: any, context: AppErrorContext): AppError {\n    const code = error.code || error.status\n    const message = error.message || 'Erreur Supabase'\n\n    // Si un code d'erreur est fourni dans le contexte, l'utiliser en priorité\n    let errorCode = context.code || ErrorCode.DB_QUERY_ERROR\n    let severity = ErrorSeverity.MEDIUM\n\n    // Classification par code Supabase (seulement si pas de code dans le contexte)\n    if (!context.code) {\n      switch (code) {\n        case 'PGRST116':\n        case '42P01':\n          errorCode = ErrorCode.DB_NOT_FOUND\n          severity = ErrorSeverity.LOW\n          break\n        case '42501':\n          errorCode = ErrorCode.DB_RLS_POLICY_VIOLATION\n          severity = ErrorSeverity.HIGH\n          break\n        case '23505':\n          errorCode = ErrorCode.VALIDATION_UNIQUE_CONSTRAINT\n          severity = ErrorSeverity.LOW\n          break\n        case '23503':\n          errorCode = ErrorCode.DB_CONSTRAINT_VIOLATION\n          severity = ErrorSeverity.MEDIUM\n          break\n        case 'PGRST301':\n        case '400':\n          errorCode = ErrorCode.API_BAD_REQUEST\n          severity = ErrorSeverity.LOW\n          break\n        case '401':\n          errorCode = ErrorCode.AUTH_REQUIRED\n          severity = ErrorSeverity.HIGH\n          break\n        case '403':\n          errorCode = ErrorCode.AUTH_INSUFFICIENT_PERMISSIONS\n          severity = ErrorSeverity.HIGH\n          break\n        case '404':\n          errorCode = ErrorCode.API_NOT_FOUND\n          severity = ErrorSeverity.LOW\n          break\n        case '500':\n          errorCode = ErrorCode.API_SERVER_ERROR\n          severity = ErrorSeverity.HIGH\n          break\n      }\n    }\n\n    // Ajuster la sévérité selon le code d'erreur\n    if (errorCode === ErrorCode.DB_FOREIGN_KEY_CONSTRAINT) {\n      severity = ErrorSeverity.MEDIUM\n    }\n\n    const appError = new AppError(message, errorCode, severity, context, error)\n    this.logError(appError)\n    return appError\n  }\n\n  /**\n   * Vérifie si une erreur est une erreur Supabase\n   */\n  private isSupabaseError(error: any): boolean {\n    return (\n      error &&\n      (error.code || error.status || error.message) &&\n      (typeof error.code === 'string' || typeof error.status === 'number')\n    )\n  }\n\n  /**\n   * Log l'erreur selon sa sévérité\n   */\n  private logError(error: AppError) {\n    const logContext: LogContext = {\n      ...error.context,\n      code: error.code,\n      severity: error.severity,\n      retryable: error.retryable,\n    }\n\n    switch (error.severity) {\n      case ErrorSeverity.CRITICAL:\n      case ErrorSeverity.HIGH:\n        logger.error(error.message, error.originalError || error, logContext)\n        break\n      case ErrorSeverity.MEDIUM:\n        logger.warn(error.message, logContext)\n        break\n      case ErrorSeverity.LOW:\n        logger.info(`Error: ${error.message}`, logContext)\n        break\n    }\n  }\n\n  /**\n   * Crée une erreur de validation\n   */\n  createValidationError(message: string, field?: string): AppError {\n    return new AppError(\n      message,\n      ErrorCode.VALIDATION_ERROR,\n      ErrorSeverity.LOW,\n      { field, userMessage: message }\n    )\n  }\n\n  /**\n   * Crée une erreur d'authentification\n   */\n  createAuthError(code: ErrorCode, message?: string): AppError {\n    return new AppError(\n      message || 'Erreur d\\'authentification',\n      code,\n      ErrorSeverity.HIGH\n    )\n  }\n\n  /**\n   * Crée une erreur de base de données\n   */\n  createDatabaseError(message: string, originalError?: unknown): AppError {\n    return new AppError(\n      message,\n      ErrorCode.DB_QUERY_ERROR,\n      ErrorSeverity.MEDIUM,\n      {},\n      originalError\n    )\n  }\n\n  /**\n   * Crée une erreur \"Not Found\"\n   */\n  createNotFoundError(message: string, context?: AppErrorContext): AppError {\n    return new AppError(\n      message,\n      ErrorCode.DB_NOT_FOUND,\n      ErrorSeverity.LOW,\n      context\n    )\n  }\n}\n\n// Export d'une instance singleton\nexport const errorHandler = new ErrorHandler()\n\n// Export de fonctions helper pour faciliter l'utilisation\nexport const handleError = (error: unknown, context?: AppErrorContext) =>\n  errorHandler.handleError(error, context)\n\nexport const createValidationError = (message: string, field?: string) =>\n  errorHandler.createValidationError(message, field)\n\nexport const createAuthError = (code: ErrorCode, message?: string) =>\n  errorHandler.createAuthError(code, message)\n\nexport const createDatabaseError = (message: string, originalError?: unknown) =>\n  errorHandler.createDatabaseError(message, originalError)\n\nexport const createNotFoundError = (message: string, context?: AppErrorContext) =>\n  errorHandler.createNotFoundError(message, context)\n\n// Alias pour NotFoundError (compatibilité)\nexport const NotFoundError = createNotFoundError\n\n","/**\n * Helpers réutilisables pour les requêtes Supabase\n * \n * Réduit la duplication de code dans les services\n */\n\nimport { SupabaseClient } from '@supabase/supabase-js'\nimport { errorHandler, AppError, ErrorCode } from '@/lib/errors'\n\nexport interface GetAllByOrganizationOptions {\n  filters?: Record<string, unknown>\n  orderBy?: { column: string; ascending?: boolean }\n  select?: string\n  search?: { field: string; value: string }\n}\n\n/**\n * Récupère tous les enregistrements d'une organisation avec options\n */\nexport async function getAllByOrganization<T>(\n  supabase: SupabaseClient,\n  table: string,\n  organizationId: string,\n  options?: GetAllByOrganizationOptions\n): Promise<T[]> {\n  try {\n    let query = supabase\n      .from(table)\n      .select(options?.select || '*')\n      .eq('organization_id', organizationId)\n\n    // Appliquer les filtres\n    if (options?.filters) {\n      Object.entries(options.filters).forEach(([key, value]) => {\n        if (value !== undefined && value !== null) {\n          query = query.eq(key, value)\n        }\n      })\n    }\n\n    // Appliquer la recherche\n    if (options?.search) {\n      query = query.ilike(options.search.field, `%${options.search.value}%`)\n    }\n\n    // Appliquer le tri\n    if (options?.orderBy) {\n      query = query.order(options.orderBy.column, {\n        ascending: options.orderBy.ascending ?? false,\n      })\n    } else {\n      query = query.order('created_at', { ascending: false })\n    }\n\n    const { data, error } = await query\n\n    if (error) {\n      throw errorHandler.handleError(error, {\n        organizationId,\n        operation: 'getAllByOrganization',\n        table,\n      })\n    }\n\n    return (data || []) as T[]\n  } catch (error) {\n    if (error instanceof AppError) {\n      throw error\n    }\n    throw errorHandler.handleError(error, {\n      organizationId,\n      operation: 'getAllByOrganization',\n      table,\n    })\n  }\n}\n\n/**\n * Récupère un enregistrement par ID avec gestion d'erreur\n */\nexport async function getById<T>(\n  supabase: SupabaseClient,\n  table: string,\n  id: string,\n  select?: string\n): Promise<T> {\n  try {\n    const { data, error } = await supabase\n      .from(table)\n      .select(select || '*')\n      .eq('id', id)\n      .single()\n\n    if (error) {\n      if (error.code === 'PGRST116' || error.code === '42P01') {\n        throw errorHandler.handleError(error, {\n          code: ErrorCode.DB_NOT_FOUND,\n          operation: 'getById',\n          id,\n          table,\n        })\n      }\n      throw errorHandler.handleError(error, {\n        operation: 'getById',\n        id,\n        table,\n      })\n    }\n\n    if (!data) {\n      throw errorHandler.createDatabaseError(\n        `Enregistrement avec l'ID ${id} introuvable dans ${table}`,\n        { id, table }\n      )\n    }\n\n    return data as T\n  } catch (error) {\n    if (error instanceof AppError) {\n      throw error\n    }\n    throw errorHandler.handleError(error, {\n      operation: 'getById',\n      id,\n      table,\n    })\n  }\n}\n\n","import { createClient } from '@/lib/supabase/client'\nimport type { SupabaseClient } from '@supabase/supabase-js'\nimport { calendarService } from './calendar.service'\nimport { videoconferenceService } from './videoconference.service'\nimport type { TableRow, TableInsert, TableUpdate, FlexibleInsert, FlexibleUpdate } from '@/lib/types/supabase-helpers'\n\n// Types pour les sessions (niveau 3)\ntype Session = TableRow<'sessions'>\ntype SessionInsert = TableInsert<'sessions'>\ntype SessionUpdate = TableUpdate<'sessions'>\n\n/**\n * Service pour gérer les SESSIONS\n * Une session appartient à une formation\n * Exemple : \"Session Hiver 2024\" (de la formation \"Excel avancé\")\n */\nexport class SessionService {\n  private supabase: SupabaseClient<any>\n\n\n  constructor(supabaseClient?: SupabaseClient<any>) {\n\n    this.supabase = supabaseClient || createClient()\n\n  }\n\n  /**\n   * Récupère toutes les sessions d'une organisation\n   */\n  async getAllSessions(organizationId: string, filters?: {\n    formationId?: string\n    status?: Session['status']\n    startDate?: string\n    endDate?: string\n    search?: string\n  }) {\n    let query = this.supabase\n      .from('sessions')\n      .select(`\n        *,\n        formations!inner(\n          *,\n          programs(*)\n        )\n      `)\n      .eq('formations.organization_id', organizationId)\n\n    if (filters?.formationId) {\n      query = query.eq('formation_id', filters.formationId)\n    }\n\n    if (filters?.status) {\n      query = query.eq('status', filters.status)\n    }\n\n    if (filters?.startDate) {\n      query = query.gte('start_date', filters.startDate)\n    }\n\n    if (filters?.endDate) {\n      query = query.lte('end_date', filters.endDate)\n    }\n\n    if (filters?.search) {\n      query = query.ilike('name', `%${filters.search}%`)\n    }\n\n    const { data, error } = await query.order('start_date', { ascending: true })\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Récupère une session par son ID avec sa formation, son programme (via formation) et tous ses programmes associés\n   */\n  async getSessionById(id: string) {\n    // Récupérer la session avec sa formation et son programme (relation indirecte)\n    const { data: session, error: sessionError } = await this.supabase\n      .from('sessions')\n      .select(`\n        *,\n        formations!inner(\n          *,\n          programs(*)\n        )\n      `)\n      .eq('id', id)\n      .single()\n\n    if (sessionError) throw sessionError\n\n    // Récupérer tous les programmes associés directement à cette session (relation many-to-many)\n    const { data: sessionPrograms, error: programsError } = await this.supabase\n      .from('session_programs')\n      .select(`\n        program_id,\n        programs(*)\n      `)\n      .eq('session_id', id)\n\n    if (programsError) throw programsError\n\n    // Ajouter les programmes associés à la session\n    return {\n      ...session,\n      session_programs: sessionPrograms?.map((sp: { programs: unknown }) => sp.programs).filter(Boolean) || [],\n    }\n  }\n\n  /**\n   * Crée une nouvelle session avec optionnellement plusieurs programmes associés\n   */\n  async createSession(session: FlexibleInsert<'sessions'>, programIds?: string[], organizationId?: string) {\n    // Vérifier d'abord que la formation existe et appartient à l'organisation de l'utilisateur\n    if (session.formation_id) {\n      const { data: formation, error: formationError } = await this.supabase\n        .from('formations')\n        .select('id, organization_id')\n        .eq('id', session.formation_id)\n        .single()\n\n      if (formationError) {\n        console.error('Erreur lors de la vérification de la formation:', formationError)\n        throw new Error(`Formation non trouvée: ${formationError.message}`)\n      }\n\n      if (!formation) {\n        throw new Error('Formation non trouvée')\n      }\n\n      console.log('Formation trouvée:', formation)\n    }\n\n    // Créer la session\n    const { data, error } = await this.supabase\n      .from('sessions')\n      .insert(session as SessionInsert)\n      .select()\n      .single()\n\n    if (error) {\n      console.error('Erreur RLS lors de la création de la session:', {\n        code: error.code,\n        message: error.message,\n        details: error.details,\n        hint: error.hint,\n        formation_id: session.formation_id,\n      })\n      throw error\n    }\n\n    // Si des programmes sont fournis, créer les associations\n    if (programIds && programIds.length > 0 && data) {\n      // Récupérer l'organization_id de la formation\n      const { data: formation } = await this.supabase\n        .from('formations')\n        .select('organization_id')\n        .eq('id', data.formation_id)\n        .single()\n\n      if (formation) {\n        const sessionPrograms = programIds.map((programId) => ({\n          session_id: data.id,\n          program_id: programId,\n          organization_id: formation.organization_id,\n        }))\n\n        const { error: linkError } = await this.supabase\n          .from('session_programs')\n          .insert(sessionPrograms)\n\n        if (linkError) {\n          console.error('Erreur lors de la création des associations session-programme:', linkError)\n          // Ne pas échouer complètement, mais logger l'erreur\n        }\n\n        // Synchroniser avec les calendriers si activé\n        if (formation.organization_id) {\n          await this.syncWithCalendars(data.id, formation.organization_id, 'create').catch((error) => {\n            console.error('Erreur lors de la synchronisation calendrier:', error)\n            // Ne pas échouer la création de session si la synchronisation échoue\n          })\n        }\n\n        // Créer une réunion visioconférence si activé\n        if (formation.organization_id) {\n          await this.createVideoconferenceMeeting(data.id, formation.organization_id).catch((error) => {\n            console.error('Erreur lors de la création de la réunion visioconférence:', error)\n            // Ne pas échouer la création de session si la création de réunion échoue\n          })\n        }\n      }\n    }\n\n    console.log('Session créée avec succès:', data)\n    return data\n  }\n\n  /**\n   * Met à jour les programmes associés à une session\n   */\n  async updateSessionPrograms(sessionId: string, programIds: string[], organizationId: string) {\n    // Supprimer toutes les associations existantes\n    const { error: deleteError } = await this.supabase\n      .from('session_programs')\n      .delete()\n      .eq('session_id', sessionId)\n\n    if (deleteError) throw deleteError\n\n    // Créer les nouvelles associations\n    if (programIds.length > 0) {\n      const sessionPrograms = programIds.map((programId) => ({\n        session_id: sessionId,\n        program_id: programId,\n        organization_id: organizationId,\n      }))\n\n      const { error: insertError } = await this.supabase\n        .from('session_programs')\n        .insert(sessionPrograms)\n\n      if (insertError) throw insertError\n    }\n\n    return true\n  }\n\n  /**\n   * Récupère tous les programmes associés à une session\n   */\n  async getSessionPrograms(sessionId: string) {\n    const { data, error } = await this.supabase\n      .from('session_programs')\n      .select(`\n        program_id,\n        programs(*)\n      `)\n      .eq('session_id', sessionId)\n\n    if (error) throw error\n    return data?.map((sp: { programs: unknown }) => sp.programs).filter(Boolean) || []\n  }\n\n  /**\n   * Met à jour une session\n   */\n  async updateSession(id: string, updates: FlexibleUpdate<'sessions'>) {\n    // Récupérer l'organization_id avant la mise à jour\n    const { data: existingSession } = await this.supabase\n      .from('sessions')\n      .select('formation_id, formations(organization_id)')\n      .eq('id', id)\n      .single()\n\n    const { data, error } = await this.supabase\n      .from('sessions')\n      .update(updates as SessionUpdate)\n      .eq('id', id)\n      .select()\n      .single()\n\n    if (error) throw error\n\n    // Synchroniser avec les calendriers si activé\n    const formation = existingSession?.formations as { organization_id?: string } | null\n    if (existingSession && formation?.organization_id) {\n      await this.syncWithCalendars(id, formation.organization_id, 'update').catch((error) => {\n        console.error('Erreur lors de la synchronisation calendrier:', error)\n      })\n    }\n\n    return data\n  }\n\n  /**\n   * Supprime une session\n   */\n  async deleteSession(id: string) {\n    // Récupérer l'organization_id avant la suppression\n    const { data: existingSession } = await this.supabase\n      .from('sessions')\n      .select('formation_id, formations(organization_id)')\n      .eq('id', id)\n      .single()\n\n    // Supprimer les événements calendrier si activé\n    const formation = existingSession?.formations as { organization_id?: string } | null\n    if (existingSession && formation?.organization_id) {\n      await this.syncWithCalendars(id, formation.organization_id, 'delete').catch((error) => {\n        console.error('Erreur lors de la suppression de l\\'événement calendrier:', error)\n      })\n    }\n\n    const { error } = await this.supabase\n      .from('sessions')\n      .delete()\n      .eq('id', id)\n\n    if (error) throw error\n  }\n\n  /**\n   * Crée une réunion visioconférence pour une session\n   */\n  private async createVideoconferenceMeeting(\n    sessionId: string,\n    organizationId: string\n  ): Promise<void> {\n    // Récupérer les intégrations visioconférence actives\n    const { data: integrations } = await this.supabase\n      .from('videoconference_integrations')\n      .select('*')\n      .eq('organization_id', organizationId)\n      .eq('is_active', true)\n      .eq('auto_create_meetings', true)\n\n    if (!integrations || integrations.length === 0) {\n      return // Pas d'intégrations actives\n    }\n\n    // Créer une réunion avec chaque système actif\n    for (const integration of integrations) {\n      try {\n        await videoconferenceService.createMeetingForSession(\n          sessionId,\n          { organizationId, provider: integration.provider as string }\n        )\n      } catch (error) {\n        console.error(`Erreur lors de la création de réunion avec ${integration.provider}:`, error)\n        // Continuer avec les autres intégrations même si une échoue\n      }\n    }\n  }\n\n  /**\n   * Synchronise une session avec les calendriers configurés\n   */\n  private async syncWithCalendars(\n    sessionId: string,\n    organizationId: string,\n    action: 'create' | 'update' | 'delete'\n  ): Promise<void> {\n    // Récupérer les intégrations calendrier actives\n    const { data: integrations } = await this.supabase\n      .from('calendar_integrations')\n      .select('*')\n      .eq('organization_id', organizationId)\n      .eq('is_active', true)\n      .eq('sync_sessions', true)\n      .eq('create_events_for_sessions', true)\n\n    if (!integrations || integrations.length === 0) {\n      return // Pas d'intégrations actives\n    }\n\n    // Synchroniser avec chaque calendrier\n    for (const integration of integrations) {\n      try {\n        // TODO: Implémenter deleteSessionEvent et syncSession dans CalendarService\n        // if (action === 'delete') {\n        //   await calendarService.deleteSessionEvent(\n        //     organizationId,\n        //     integration.provider as string,\n        //     sessionId\n        //   )\n        // } else {\n        //   await calendarService.syncSession(\n        //     organizationId,\n        //     integration.provider as string,\n        //     sessionId\n        //   )\n        // }\n        console.warn(`Calendar sync for ${action} not implemented yet for provider ${integration.provider}`)\n      } catch (error) {\n        console.error(`Erreur lors de la synchronisation avec ${integration.provider}:`, error)\n        // Continuer avec les autres intégrations même si une échoue\n      }\n    }\n  }\n\n  /**\n   * Récupère les sessions à venir\n   */\n  async getUpcomingSessions(organizationId: string, limit: number = 10) {\n    const today = new Date().toISOString().split('T')[0]\n    \n    const { data, error } = await this.supabase\n      .from('sessions')\n      .select(`\n        *,\n        formations!inner(\n          *,\n          programs(*)\n        )\n      `)\n      .eq('formations.organization_id', organizationId)\n      .gte('start_date', today)\n      .eq('status', 'planned')\n      .order('start_date', { ascending: true })\n      .limit(limit)\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Récupère les sessions en cours\n   */\n  async getOngoingSessions(organizationId: string) {\n    const today = new Date().toISOString().split('T')[0]\n    \n    const { data, error } = await this.supabase\n      .from('sessions')\n      .select(`\n        *,\n        formations!inner(\n          *,\n          programs(*)\n        )\n      `)\n      .eq('formations.organization_id', organizationId)\n      .lte('start_date', today)\n      .gte('end_date', today)\n      .eq('status', 'ongoing')\n      .order('start_date', { ascending: true })\n\n    if (error) throw error\n    return data\n  }\n\n  // ========== GESTION DES RELATIONS N:N FORMATION-SESSION ==========\n\n  /**\n   * Associe une session à une ou plusieurs formations\n   */\n  async addSessionToFormations(sessionId: string, formationIds: string[], organizationId: string) {\n    const formationSessions = formationIds.map((formationId, index) => ({\n      session_id: sessionId,\n      formation_id: formationId,\n      organization_id: organizationId,\n      order_index: index,\n    }))\n\n    const { data, error } = await this.supabase\n      .from('formation_sessions')\n      .insert(formationSessions)\n      .select()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Retire une session d'une formation\n   */\n  async removeSessionFromFormation(sessionId: string, formationId: string) {\n    const { error } = await this.supabase\n      .from('formation_sessions')\n      .delete()\n      .eq('session_id', sessionId)\n      .eq('formation_id', formationId)\n\n    if (error) throw error\n    return true\n  }\n\n  /**\n   * Met à jour les formations associées à une session\n   */\n  async updateSessionFormations(sessionId: string, formationIds: string[], organizationId: string) {\n    // Supprimer toutes les associations existantes\n    const { error: deleteError } = await this.supabase\n      .from('formation_sessions')\n      .delete()\n      .eq('session_id', sessionId)\n\n    if (deleteError) throw deleteError\n\n    // Créer les nouvelles associations\n    if (formationIds.length > 0) {\n      return this.addSessionToFormations(sessionId, formationIds, organizationId)\n    }\n\n    return []\n  }\n\n  /**\n   * Récupère toutes les formations associées à une session\n   */\n  async getSessionFormations(sessionId: string) {\n    const { data, error } = await this.supabase\n      .from('formation_sessions')\n      .select(`\n        formation_id,\n        order_index,\n        formations(*)\n      `)\n      .eq('session_id', sessionId)\n      .order('order_index', { ascending: true })\n\n    if (error) throw error\n    return data?.map((fs: { formations: unknown }) => fs.formations).filter(Boolean) || []\n  }\n\n  /**\n   * Récupère toutes les sessions d'une formation (via la table de liaison N:N)\n   */\n  async getFormationSessions(formationId: string) {\n    const { data, error } = await this.supabase\n      .from('formation_sessions')\n      .select(`\n        session_id,\n        order_index,\n        sessions(*)\n      `)\n      .eq('formation_id', formationId)\n      .order('order_index', { ascending: true })\n\n    if (error) throw error\n    return data?.map((fs: { sessions: unknown }) => fs.sessions).filter(Boolean) || []\n  }\n\n  /**\n   * Crée une session indépendante (sans formation obligatoire)\n   */\n  async createIndependentSession(\n    session: Omit<FlexibleInsert<'sessions'>, 'formation_id'> & { organization_id: string },\n    programIds?: string[],\n    formationIds?: string[]\n  ) {\n    // Créer la session sans formation_id\n    const { data, error } = await this.supabase\n      .from('sessions')\n      .insert({\n        ...session,\n        formation_id: null, // Pas de formation directe\n      } as SessionInsert)\n      .select()\n      .single()\n\n    if (error) throw error\n\n    // Associer les programmes si fournis\n    if (programIds && programIds.length > 0 && data) {\n      await this.updateSessionPrograms(data.id, programIds, session.organization_id)\n    }\n\n    // Associer les formations si fournies\n    if (formationIds && formationIds.length > 0 && data) {\n      await this.addSessionToFormations(data.id, formationIds, session.organization_id)\n    }\n\n    return data\n  }\n}\n\nexport const sessionService = new SessionService()\n\n\n\n\n\n\n\n\n\n\n\n","/**\n * Service pour gérer les vidéoconférences\n * TODO: Implémenter le service de vidéoconférence\n */\n\nexport const videoconferenceService = {\n  /**\n   * Crée une réunion vidéo pour une session\n   */\n  async createMeetingForSession(sessionId: string, options?: any) {\n    // TODO: Implémenter la création de réunion vidéo\n    console.warn('videoconferenceService.createMeetingForSession not implemented')\n    return null\n  },\n}\n","'use client'\n\nimport * as React from 'react'\nimport { cn } from '@/lib/utils'\nimport { Check } from 'lucide-react'\n\nexport interface CheckboxProps\n  extends Omit<React.InputHTMLAttributes<HTMLInputElement>, 'type'> {\n  checked?: boolean\n  onCheckedChange?: (checked: boolean) => void\n}\n\nconst Checkbox = React.forwardRef<HTMLInputElement, CheckboxProps>(\n  ({ className, checked, onCheckedChange, ...props }, ref) => {\n    return (\n      <div className=\"relative inline-flex items-center\">\n        <input\n          type=\"checkbox\"\n          ref={ref}\n          checked={checked}\n          onChange={(e) => onCheckedChange?.(e.target.checked)}\n          className={cn(\n            'peer h-4 w-4 shrink-0 rounded border border-gray-300',\n            'focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-blue focus-visible:ring-offset-2',\n            'disabled:cursor-not-allowed disabled:opacity-50',\n            'cursor-pointer',\n            checked && 'border-brand-blue bg-brand-blue',\n            className\n          )}\n          {...props}\n        />\n        {checked && (\n          <Check className=\"absolute h-3 w-3 text-white pointer-events-none left-0.5 top-0.5\" />\n        )}\n      </div>\n    )\n  }\n)\nCheckbox.displayName = 'Checkbox'\n\nexport { Checkbox }\n","import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","import toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name endOfMonth\n * @category Month Helpers\n * @summary Return the end of a month for the given date.\n *\n * @description\n * Return the end of a month for the given date.\n * The result will be in the local timezone.\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the end of a month\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The end of a month for 2 September 2014 11:55:00:\n * const result = endOfMonth(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 30 2014 23:59:59.999\n */\nexport default function endOfMonth(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  var month = date.getMonth();\n  date.setFullYear(date.getFullYear(), month + 1, 0);\n  date.setHours(23, 59, 59, 999);\n  return date;\n}","import { getDefaultOptions } from \"../_lib/defaultOptions/index.js\";\nimport compareAsc from \"../compareAsc/index.js\";\nimport differenceInMonths from \"../differenceInMonths/index.js\";\nimport differenceInSeconds from \"../differenceInSeconds/index.js\";\nimport defaultLocale from \"../_lib/defaultLocale/index.js\";\nimport toDate from \"../toDate/index.js\";\nimport cloneObject from \"../_lib/cloneObject/index.js\";\nimport assign from \"../_lib/assign/index.js\";\nimport getTimezoneOffsetInMilliseconds from \"../_lib/getTimezoneOffsetInMilliseconds/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\nvar MINUTES_IN_DAY = 1440;\nvar MINUTES_IN_ALMOST_TWO_DAYS = 2520;\nvar MINUTES_IN_MONTH = 43200;\nvar MINUTES_IN_TWO_MONTHS = 86400;\n\n/**\n * @name formatDistance\n * @category Common Helpers\n * @summary Return the distance between the given dates in words.\n *\n * @description\n * Return the distance between the given dates in words.\n *\n * | Distance between dates                                            | Result              |\n * |-------------------------------------------------------------------|---------------------|\n * | 0 ... 30 secs                                                     | less than a minute  |\n * | 30 secs ... 1 min 30 secs                                         | 1 minute            |\n * | 1 min 30 secs ... 44 mins 30 secs                                 | [2..44] minutes     |\n * | 44 mins ... 30 secs ... 89 mins 30 secs                           | about 1 hour        |\n * | 89 mins 30 secs ... 23 hrs 59 mins 30 secs                        | about [2..24] hours |\n * | 23 hrs 59 mins 30 secs ... 41 hrs 59 mins 30 secs                 | 1 day               |\n * | 41 hrs 59 mins 30 secs ... 29 days 23 hrs 59 mins 30 secs         | [2..30] days        |\n * | 29 days 23 hrs 59 mins 30 secs ... 44 days 23 hrs 59 mins 30 secs | about 1 month       |\n * | 44 days 23 hrs 59 mins 30 secs ... 59 days 23 hrs 59 mins 30 secs | about 2 months      |\n * | 59 days 23 hrs 59 mins 30 secs ... 1 yr                           | [2..12] months      |\n * | 1 yr ... 1 yr 3 months                                            | about 1 year        |\n * | 1 yr 3 months ... 1 yr 9 month s                                  | over 1 year         |\n * | 1 yr 9 months ... 2 yrs                                           | almost 2 years      |\n * | N yrs ... N yrs 3 months                                          | about N years       |\n * | N yrs 3 months ... N yrs 9 months                                 | over N years        |\n * | N yrs 9 months ... N+1 yrs                                        | almost N+1 years    |\n *\n * With `options.includeSeconds == true`:\n * | Distance between dates | Result               |\n * |------------------------|----------------------|\n * | 0 secs ... 5 secs      | less than 5 seconds  |\n * | 5 secs ... 10 secs     | less than 10 seconds |\n * | 10 secs ... 20 secs    | less than 20 seconds |\n * | 20 secs ... 40 secs    | half a minute        |\n * | 40 secs ... 60 secs    | less than a minute   |\n * | 60 secs ... 90 secs    | 1 minute             |\n *\n * @param {Date|Number} date - the date\n * @param {Date|Number} baseDate - the date to compare with\n * @param {Object} [options] - an object with options.\n * @param {Boolean} [options.includeSeconds=false] - distances less than a minute are more detailed\n * @param {Boolean} [options.addSuffix=false] - result indicates if the second date is earlier or later than the first\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @returns {String} the distance in words\n * @throws {TypeError} 2 arguments required\n * @throws {RangeError} `date` must not be Invalid Date\n * @throws {RangeError} `baseDate` must not be Invalid Date\n * @throws {RangeError} `options.locale` must contain `formatDistance` property\n *\n * @example\n * // What is the distance between 2 July 2014 and 1 January 2015?\n * const result = formatDistance(new Date(2014, 6, 2), new Date(2015, 0, 1))\n * //=> '6 months'\n *\n * @example\n * // What is the distance between 1 January 2015 00:00:15\n * // and 1 January 2015 00:00:00, including seconds?\n * const result = formatDistance(\n *   new Date(2015, 0, 1, 0, 0, 15),\n *   new Date(2015, 0, 1, 0, 0, 0),\n *   { includeSeconds: true }\n * )\n * //=> 'less than 20 seconds'\n *\n * @example\n * // What is the distance from 1 January 2016\n * // to 1 January 2015, with a suffix?\n * const result = formatDistance(new Date(2015, 0, 1), new Date(2016, 0, 1), {\n *   addSuffix: true\n * })\n * //=> 'about 1 year ago'\n *\n * @example\n * // What is the distance between 1 August 2016 and 1 January 2015 in Esperanto?\n * import { eoLocale } from 'date-fns/locale/eo'\n * const result = formatDistance(new Date(2016, 7, 1), new Date(2015, 0, 1), {\n *   locale: eoLocale\n * })\n * //=> 'pli ol 1 jaro'\n */\n\nexport default function formatDistance(dirtyDate, dirtyBaseDate, options) {\n  var _ref, _options$locale;\n  requiredArgs(2, arguments);\n  var defaultOptions = getDefaultOptions();\n  var locale = (_ref = (_options$locale = options === null || options === void 0 ? void 0 : options.locale) !== null && _options$locale !== void 0 ? _options$locale : defaultOptions.locale) !== null && _ref !== void 0 ? _ref : defaultLocale;\n  if (!locale.formatDistance) {\n    throw new RangeError('locale must contain formatDistance property');\n  }\n  var comparison = compareAsc(dirtyDate, dirtyBaseDate);\n  if (isNaN(comparison)) {\n    throw new RangeError('Invalid time value');\n  }\n  var localizeOptions = assign(cloneObject(options), {\n    addSuffix: Boolean(options === null || options === void 0 ? void 0 : options.addSuffix),\n    comparison: comparison\n  });\n  var dateLeft;\n  var dateRight;\n  if (comparison > 0) {\n    dateLeft = toDate(dirtyBaseDate);\n    dateRight = toDate(dirtyDate);\n  } else {\n    dateLeft = toDate(dirtyDate);\n    dateRight = toDate(dirtyBaseDate);\n  }\n  var seconds = differenceInSeconds(dateRight, dateLeft);\n  var offsetInSeconds = (getTimezoneOffsetInMilliseconds(dateRight) - getTimezoneOffsetInMilliseconds(dateLeft)) / 1000;\n  var minutes = Math.round((seconds - offsetInSeconds) / 60);\n  var months;\n\n  // 0 up to 2 mins\n  if (minutes < 2) {\n    if (options !== null && options !== void 0 && options.includeSeconds) {\n      if (seconds < 5) {\n        return locale.formatDistance('lessThanXSeconds', 5, localizeOptions);\n      } else if (seconds < 10) {\n        return locale.formatDistance('lessThanXSeconds', 10, localizeOptions);\n      } else if (seconds < 20) {\n        return locale.formatDistance('lessThanXSeconds', 20, localizeOptions);\n      } else if (seconds < 40) {\n        return locale.formatDistance('halfAMinute', 0, localizeOptions);\n      } else if (seconds < 60) {\n        return locale.formatDistance('lessThanXMinutes', 1, localizeOptions);\n      } else {\n        return locale.formatDistance('xMinutes', 1, localizeOptions);\n      }\n    } else {\n      if (minutes === 0) {\n        return locale.formatDistance('lessThanXMinutes', 1, localizeOptions);\n      } else {\n        return locale.formatDistance('xMinutes', minutes, localizeOptions);\n      }\n    }\n\n    // 2 mins up to 0.75 hrs\n  } else if (minutes < 45) {\n    return locale.formatDistance('xMinutes', minutes, localizeOptions);\n\n    // 0.75 hrs up to 1.5 hrs\n  } else if (minutes < 90) {\n    return locale.formatDistance('aboutXHours', 1, localizeOptions);\n\n    // 1.5 hrs up to 24 hrs\n  } else if (minutes < MINUTES_IN_DAY) {\n    var hours = Math.round(minutes / 60);\n    return locale.formatDistance('aboutXHours', hours, localizeOptions);\n\n    // 1 day up to 1.75 days\n  } else if (minutes < MINUTES_IN_ALMOST_TWO_DAYS) {\n    return locale.formatDistance('xDays', 1, localizeOptions);\n\n    // 1.75 days up to 30 days\n  } else if (minutes < MINUTES_IN_MONTH) {\n    var days = Math.round(minutes / MINUTES_IN_DAY);\n    return locale.formatDistance('xDays', days, localizeOptions);\n\n    // 1 month up to 2 months\n  } else if (minutes < MINUTES_IN_TWO_MONTHS) {\n    months = Math.round(minutes / MINUTES_IN_MONTH);\n    return locale.formatDistance('aboutXMonths', months, localizeOptions);\n  }\n  months = differenceInMonths(dateRight, dateLeft);\n\n  // 2 months up to 12 months\n  if (months < 12) {\n    var nearestMonth = Math.round(minutes / MINUTES_IN_MONTH);\n    return locale.formatDistance('xMonths', nearestMonth, localizeOptions);\n\n    // 1 year up to max Date\n  } else {\n    var monthsSinceStartOfYear = months % 12;\n    var years = Math.floor(months / 12);\n\n    // N years up to 1 years 3 months\n    if (monthsSinceStartOfYear < 3) {\n      return locale.formatDistance('aboutXYears', years, localizeOptions);\n\n      // N years 3 months up to N years 9 months\n    } else if (monthsSinceStartOfYear < 9) {\n      return locale.formatDistance('overXYears', years, localizeOptions);\n\n      // N years 9 months up to N year 12 months\n    } else {\n      return locale.formatDistance('almostXYears', years + 1, localizeOptions);\n    }\n  }\n}","import toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name compareAsc\n * @category Common Helpers\n * @summary Compare the two dates and return -1, 0 or 1.\n *\n * @description\n * Compare the two dates and return 1 if the first date is after the second,\n * -1 if the first date is before the second or 0 if dates are equal.\n *\n * @param {Date|Number} dateLeft - the first date to compare\n * @param {Date|Number} dateRight - the second date to compare\n * @returns {Number} the result of the comparison\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Compare 11 February 1987 and 10 July 1989:\n * const result = compareAsc(new Date(1987, 1, 11), new Date(1989, 6, 10))\n * //=> -1\n *\n * @example\n * // Sort the array of dates:\n * const result = [\n *   new Date(1995, 6, 2),\n *   new Date(1987, 1, 11),\n *   new Date(1989, 6, 10)\n * ].sort(compareAsc)\n * //=> [\n * //   Wed Feb 11 1987 00:00:00,\n * //   Mon Jul 10 1989 00:00:00,\n * //   Sun Jul 02 1995 00:00:00\n * // ]\n */\nexport default function compareAsc(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var diff = dateLeft.getTime() - dateRight.getTime();\n  if (diff < 0) {\n    return -1;\n  } else if (diff > 0) {\n    return 1;\n    // Return 0 if diff is 0; return NaN if diff is NaN\n  } else {\n    return diff;\n  }\n}","import toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name differenceInCalendarMonths\n * @category Month Helpers\n * @summary Get the number of calendar months between the given dates.\n *\n * @description\n * Get the number of calendar months between the given dates.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of calendar months\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many calendar months are between 31 January 2014 and 1 September 2014?\n * const result = differenceInCalendarMonths(\n *   new Date(2014, 8, 1),\n *   new Date(2014, 0, 31)\n * )\n * //=> 8\n */\nexport default function differenceInCalendarMonths(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var yearDiff = dateLeft.getFullYear() - dateRight.getFullYear();\n  var monthDiff = dateLeft.getMonth() - dateRight.getMonth();\n  return yearDiff * 12 + monthDiff;\n}","import toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name endOfDay\n * @category Day Helpers\n * @summary Return the end of a day for the given date.\n *\n * @description\n * Return the end of a day for the given date.\n * The result will be in the local timezone.\n *\n * @param {Date|Number} date - the original date\n * @returns {Date} the end of a day\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // The end of a day for 2 September 2014 11:55:00:\n * const result = endOfDay(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 02 2014 23:59:59.999\n */\nexport default function endOfDay(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  date.setHours(23, 59, 59, 999);\n  return date;\n}","import toDate from \"../toDate/index.js\";\nimport endOfDay from \"../endOfDay/index.js\";\nimport endOfMonth from \"../endOfMonth/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name isLastDayOfMonth\n * @category Month Helpers\n * @summary Is the given date the last day of a month?\n *\n * @description\n * Is the given date the last day of a month?\n *\n * @param {Date|Number} date - the date to check\n * @returns {Boolean} the date is the last day of a month\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // Is 28 February 2014 the last day of a month?\n * const result = isLastDayOfMonth(new Date(2014, 1, 28))\n * //=> true\n */\nexport default function isLastDayOfMonth(dirtyDate) {\n  requiredArgs(1, arguments);\n  var date = toDate(dirtyDate);\n  return endOfDay(date).getTime() === endOfMonth(date).getTime();\n}","import toDate from \"../toDate/index.js\";\nimport differenceInCalendarMonths from \"../differenceInCalendarMonths/index.js\";\nimport compareAsc from \"../compareAsc/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\nimport isLastDayOfMonth from \"../isLastDayOfMonth/index.js\";\n/**\n * @name differenceInMonths\n * @category Month Helpers\n * @summary Get the number of full months between the given dates.\n *\n * @description\n * Get the number of full months between the given dates using trunc as a default rounding method.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of full months\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many full months are between 31 January 2014 and 1 September 2014?\n * const result = differenceInMonths(new Date(2014, 8, 1), new Date(2014, 0, 31))\n * //=> 7\n */\nexport default function differenceInMonths(dirtyDateLeft, dirtyDateRight) {\n  requiredArgs(2, arguments);\n  var dateLeft = toDate(dirtyDateLeft);\n  var dateRight = toDate(dirtyDateRight);\n  var sign = compareAsc(dateLeft, dateRight);\n  var difference = Math.abs(differenceInCalendarMonths(dateLeft, dateRight));\n  var result;\n\n  // Check for the difference of less than month\n  if (difference < 1) {\n    result = 0;\n  } else {\n    if (dateLeft.getMonth() === 1 && dateLeft.getDate() > 27) {\n      // This will check if the date is end of Feb and assign a higher end of month date\n      // to compare it with Jan\n      dateLeft.setDate(30);\n    }\n    dateLeft.setMonth(dateLeft.getMonth() - sign * difference);\n\n    // Math.abs(diff in full months - diff in calendar months) === 1 if last calendar month is not full\n    // If so, result must be decreased by 1 in absolute value\n    var isLastMonthNotFull = compareAsc(dateLeft, dateRight) === -sign;\n\n    // Check for cases of one full calendar month\n    if (isLastDayOfMonth(toDate(dirtyDateLeft)) && difference === 1 && compareAsc(dirtyDateLeft, dateRight) === 1) {\n      isLastMonthNotFull = false;\n    }\n    result = sign * (difference - Number(isLastMonthNotFull));\n  }\n\n  // Prevent negative zero\n  return result === 0 ? 0 : result;\n}","import toDate from \"../toDate/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name differenceInMilliseconds\n * @category Millisecond Helpers\n * @summary Get the number of milliseconds between the given dates.\n *\n * @description\n * Get the number of milliseconds between the given dates.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @returns {Number} the number of milliseconds\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many milliseconds are between\n * // 2 July 2014 12:30:20.600 and 2 July 2014 12:30:21.700?\n * const result = differenceInMilliseconds(\n *   new Date(2014, 6, 2, 12, 30, 21, 700),\n *   new Date(2014, 6, 2, 12, 30, 20, 600)\n * )\n * //=> 1100\n */\nexport default function differenceInMilliseconds(dateLeft, dateRight) {\n  requiredArgs(2, arguments);\n  return toDate(dateLeft).getTime() - toDate(dateRight).getTime();\n}","var roundingMap = {\n  ceil: Math.ceil,\n  round: Math.round,\n  floor: Math.floor,\n  trunc: function trunc(value) {\n    return value < 0 ? Math.ceil(value) : Math.floor(value);\n  } // Math.trunc is not supported by IE\n};\n\nvar defaultRoundingMethod = 'trunc';\nexport function getRoundingMethod(method) {\n  return method ? roundingMap[method] : roundingMap[defaultRoundingMethod];\n}","import differenceInMilliseconds from \"../differenceInMilliseconds/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\nimport { getRoundingMethod } from \"../_lib/roundingMethods/index.js\";\n/**\n * @name differenceInSeconds\n * @category Second Helpers\n * @summary Get the number of seconds between the given dates.\n *\n * @description\n * Get the number of seconds between the given dates.\n *\n * @param {Date|Number} dateLeft - the later date\n * @param {Date|Number} dateRight - the earlier date\n * @param {Object} [options] - an object with options.\n * @param {String} [options.roundingMethod='trunc'] - a rounding method (`ceil`, `floor`, `round` or `trunc`)\n * @returns {Number} the number of seconds\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // How many seconds are between\n * // 2 July 2014 12:30:07.999 and 2 July 2014 12:30:20.000?\n * const result = differenceInSeconds(\n *   new Date(2014, 6, 2, 12, 30, 20, 0),\n *   new Date(2014, 6, 2, 12, 30, 7, 999)\n * )\n * //=> 12\n */\nexport default function differenceInSeconds(dateLeft, dateRight, options) {\n  requiredArgs(2, arguments);\n  var diff = differenceInMilliseconds(dateLeft, dateRight) / 1000;\n  return getRoundingMethod(options === null || options === void 0 ? void 0 : options.roundingMethod)(diff);\n}","export default function assign(target, object) {\n  if (target == null) {\n    throw new TypeError('assign requires that input parameter not be null or undefined');\n  }\n  for (var property in object) {\n    if (Object.prototype.hasOwnProperty.call(object, property)) {\n      ;\n      target[property] = object[property];\n    }\n  }\n  return target;\n}","import assign from \"../assign/index.js\";\nexport default function cloneObject(object) {\n  return assign({}, object);\n}","import distanceInWords from \"../formatDistance/index.js\";\nimport requiredArgs from \"../_lib/requiredArgs/index.js\";\n/**\n * @name formatDistanceToNow\n * @category Common Helpers\n * @summary Return the distance between the given date and now in words.\n * @pure false\n *\n * @description\n * Return the distance between the given date and now in words.\n *\n * | Distance to now                                                   | Result              |\n * |-------------------------------------------------------------------|---------------------|\n * | 0 ... 30 secs                                                     | less than a minute  |\n * | 30 secs ... 1 min 30 secs                                         | 1 minute            |\n * | 1 min 30 secs ... 44 mins 30 secs                                 | [2..44] minutes     |\n * | 44 mins ... 30 secs ... 89 mins 30 secs                           | about 1 hour        |\n * | 89 mins 30 secs ... 23 hrs 59 mins 30 secs                        | about [2..24] hours |\n * | 23 hrs 59 mins 30 secs ... 41 hrs 59 mins 30 secs                 | 1 day               |\n * | 41 hrs 59 mins 30 secs ... 29 days 23 hrs 59 mins 30 secs         | [2..30] days        |\n * | 29 days 23 hrs 59 mins 30 secs ... 44 days 23 hrs 59 mins 30 secs | about 1 month       |\n * | 44 days 23 hrs 59 mins 30 secs ... 59 days 23 hrs 59 mins 30 secs | about 2 months      |\n * | 59 days 23 hrs 59 mins 30 secs ... 1 yr                           | [2..12] months      |\n * | 1 yr ... 1 yr 3 months                                            | about 1 year        |\n * | 1 yr 3 months ... 1 yr 9 month s                                  | over 1 year         |\n * | 1 yr 9 months ... 2 yrs                                           | almost 2 years      |\n * | N yrs ... N yrs 3 months                                          | about N years       |\n * | N yrs 3 months ... N yrs 9 months                                 | over N years        |\n * | N yrs 9 months ... N+1 yrs                                        | almost N+1 years    |\n *\n * With `options.includeSeconds == true`:\n * | Distance to now     | Result               |\n * |---------------------|----------------------|\n * | 0 secs ... 5 secs   | less than 5 seconds  |\n * | 5 secs ... 10 secs  | less than 10 seconds |\n * | 10 secs ... 20 secs | less than 20 seconds |\n * | 20 secs ... 40 secs | half a minute        |\n * | 40 secs ... 60 secs | less than a minute   |\n * | 60 secs ... 90 secs | 1 minute             |\n *\n * > ⚠️ Please note that this function is not present in the FP submodule as\n * > it uses `Date.now()` internally hence impure and can't be safely curried.\n *\n * @param {Date|Number} date - the given date\n * @param {Object} [options] - the object with options\n * @param {Boolean} [options.includeSeconds=false] - distances less than a minute are more detailed\n * @param {Boolean} [options.addSuffix=false] - result specifies if now is earlier or later than the passed date\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @returns {String} the distance in words\n * @throws {TypeError} 1 argument required\n * @throws {RangeError} `date` must not be Invalid Date\n * @throws {RangeError} `options.locale` must contain `formatDistance` property\n *\n * @example\n * // If today is 1 January 2015, what is the distance to 2 July 2014?\n * const result = formatDistanceToNow(\n *   new Date(2014, 6, 2)\n * )\n * //=> '6 months'\n *\n * @example\n * // If now is 1 January 2015 00:00:00,\n * // what is the distance to 1 January 2015 00:00:15, including seconds?\n * const result = formatDistanceToNow(\n *   new Date(2015, 0, 1, 0, 0, 15),\n *   {includeSeconds: true}\n * )\n * //=> 'less than 20 seconds'\n *\n * @example\n * // If today is 1 January 2015,\n * // what is the distance to 1 January 2016, with a suffix?\n * const result = formatDistanceToNow(\n *   new Date(2016, 0, 1),\n *   {addSuffix: true}\n * )\n * //=> 'in about 1 year'\n *\n * @example\n * // If today is 1 January 2015,\n * // what is the distance to 1 August 2016 in Esperanto?\n * const eoLocale = require('date-fns/locale/eo')\n * const result = formatDistanceToNow(\n *   new Date(2016, 7, 1),\n *   {locale: eoLocale}\n * )\n * //=> 'pli ol 1 jaro'\n */\nexport default function formatDistanceToNow(dirtyDate, options) {\n  requiredArgs(1, arguments);\n  return distanceInWords(dirtyDate, Date.now(), options);\n}","import { createClient } from '@/lib/supabase/client'\nimport type { SupabaseClient } from '@supabase/supabase-js'\nimport { Database } from '@/types/database.types'\nimport { errorHandler, ErrorCode, AppError } from '@/lib/errors'\nimport { logger } from '@/lib/utils/logger'\nimport { getAllByOrganization, getById } from '@/lib/utils/supabase-helpers'\n\ntype Attendance = Database['public']['Tables']['attendance']['Row']\ntype AttendanceInsert = Database['public']['Tables']['attendance']['Insert']\ntype AttendanceUpdate = Database['public']['Tables']['attendance']['Update']\n\nexport class AttendanceService {\n  private supabase: SupabaseClient<Database>\n\n\n  constructor(supabaseClient?: SupabaseClient<Database>) {\n\n    this.supabase = supabaseClient || createClient()\n\n  }\n\n  /**\n   * Récupère toutes les présences d'une organisation\n   */\n  async getAll(organizationId: string, filters?: {\n    studentId?: string\n    classId?: string\n    programSessionId?: string\n    date?: string\n    status?: Attendance['status']\n  }) {\n    try {\n      // Utiliser le helper pour réduire la duplication\n      const filtersMap: Record<string, unknown> = {}\n      if (filters?.studentId) filtersMap.student_id = filters.studentId\n      if (filters?.classId) filtersMap.class_id = filters.classId\n      if (filters?.programSessionId) filtersMap.session_id = filters.programSessionId\n      if (filters?.date) filtersMap.date = filters.date\n      if (filters?.status) filtersMap.status = filters.status\n\n      return getAllByOrganization<Attendance>(\n        this.supabase,\n        'attendance',\n        organizationId,\n        {\n          select: '*, students(id, first_name, last_name, student_number), classes(id, name), sessions(id, title, start_time)',\n          filters: filtersMap,\n          orderBy: { column: 'date', ascending: false },\n        }\n      )\n    } catch (error) {\n      if (error instanceof AppError) {\n        throw error\n      }\n      throw errorHandler.handleError(error, {\n        organizationId,\n        operation: 'getAll',\n      })\n    }\n  }\n\n  /**\n   * Récupère l'émargement d'une classe pour une date donnée\n   */\n  async getByClassAndDate(classId: string, date: string) {\n    try {\n      const { data, error } = await this.supabase\n        .from('attendance')\n        .select('*, students(id, first_name, last_name, student_number)') // ✅ Jointure optimisée\n        .eq('class_id', classId)\n        .eq('date', date)\n        .order('students(last_name)', { ascending: true })\n\n      if (error) {\n        throw errorHandler.handleError(error, {\n          operation: 'getByClassAndDate',\n          classId,\n          date,\n        })\n      }\n\n      return data || []\n    } catch (error) {\n      if (error instanceof AppError) {\n        throw error\n      }\n      throw errorHandler.handleError(error, {\n        operation: 'getByClassAndDate',\n        classId,\n        date,\n      })\n    }\n  }\n\n  /**\n   * Récupère l'émargement d'une session pour une date donnée\n   */\n  async getBySessionAndDate(sessionId: string, date: string) {\n    try {\n      const { data, error } = await this.supabase\n        .from('attendance')\n        .select('*, students(id, first_name, last_name, student_number)') // ✅ Jointure optimisée\n        .eq('session_id', sessionId)\n        .eq('date', date)\n        .order('students(last_name)', { ascending: true })\n\n      if (error) {\n        throw errorHandler.handleError(error, {\n          operation: 'getBySessionAndDate',\n          sessionId,\n          date,\n        })\n      }\n\n      return data || []\n    } catch (error) {\n      if (error instanceof AppError) {\n        throw error\n      }\n      throw errorHandler.handleError(error, {\n        operation: 'getBySessionAndDate',\n        sessionId,\n        date,\n      })\n    }\n  }\n\n  /**\n   * Crée ou met à jour un émargement\n   */\n  async upsert(attendance: AttendanceInsert & {\n    latitude?: number\n    longitude?: number\n    location_accuracy?: number\n    location_address?: string\n    location_method?: 'manual' | 'qr_code' | 'gps' | 'ip'\n  }) {\n    // Vérifier la géolocalisation si la session l'exige\n    if (attendance.session_id && (attendance.latitude || attendance.longitude)) {\n      const locationValid = await this.validateLocation(\n        attendance.session_id,\n        attendance.latitude,\n        attendance.longitude\n      )\n\n      if (!locationValid.valid) {\n        throw errorHandler.createValidationError(\n          locationValid.error || 'Localisation invalide',\n          'location'\n        )\n      }\n\n      // Ajouter les informations de vérification\n      ;(attendance as Attendance & { location_verified?: boolean }).location_verified = locationValid.verified\n    }\n\n    try {\n      const { data, error } = await this.supabase\n        .from('attendance')\n        .upsert(attendance, {\n          onConflict: 'student_id,class_id,session_id,date',\n        })\n        .select()\n        .single()\n\n      if (error) {\n        if (error.code === '42501') {\n          throw errorHandler.handleError(error, {\n            code: ErrorCode.DB_RLS_POLICY_VIOLATION,\n            operation: 'upsert',\n          })\n        }\n        throw errorHandler.handleError(error, {\n          operation: 'upsert',\n          attendance,\n        })\n      }\n\n      logger.info('Émargement créé/mis à jour avec succès', {\n        id: data?.id,\n        studentId: attendance.student_id,\n        date: attendance.date,\n      })\n\n      return data\n    } catch (error) {\n      if (error instanceof AppError) {\n        throw error\n      }\n      throw errorHandler.handleError(error, {\n        operation: 'upsert',\n        attendance,\n      })\n    }\n  }\n\n  /**\n   * Valide la géolocalisation pour un émargement\n   */\n  async validateLocation(\n    sessionId: string,\n    latitude?: number,\n    longitude?: number\n  ): Promise<{ valid: boolean; verified: boolean; error?: string; distance?: number }> {\n    if (!latitude || !longitude) {\n      return { valid: false, verified: false, error: 'Coordonnées GPS manquantes' }\n    }\n\n    // Récupérer les informations de la session\n    const { data: session, error } = await this.supabase\n      .from('sessions')\n      .select('latitude, longitude, require_location_for_attendance, allowed_attendance_radius_meters')\n      .eq('id', sessionId)\n      .single()\n\n    if (error || !session) {\n      return { valid: false, verified: false, error: 'Session non trouvée' }\n    }\n\n    const sessionData = session as any\n\n    // Si la géolocalisation n'est pas requise, c'est valide\n    if (!sessionData.require_location_for_attendance) {\n      return { valid: true, verified: false }\n    }\n\n    // Si la session n'a pas de coordonnées GPS, on ne peut pas vérifier\n    if (!sessionData.latitude || !sessionData.longitude) {\n      return { valid: true, verified: false, error: 'Session sans coordonnées GPS' }\n    }\n\n    // Calculer la distance\n    const distance = this.calculateDistance(\n      sessionData.latitude,\n      sessionData.longitude,\n      latitude,\n      longitude\n    )\n\n    // Vérifier le rayon autorisé\n    if (sessionData.allowed_attendance_radius_meters) {\n      if (distance > sessionData.allowed_attendance_radius_meters) {\n        return {\n          valid: false,\n          verified: false,\n          error: `Vous êtes trop loin de la session (${Math.round(distance)}m, maximum: ${sessionData.allowed_attendance_radius_meters}m)`,\n          distance,\n        }\n      }\n    }\n\n    return { valid: true, verified: true, distance }\n  }\n\n  /**\n   * Calcule la distance entre deux points GPS (formule de Haversine)\n   */\n  private calculateDistance(lat1: number, lon1: number, lat2: number, lon2: number): number {\n    const R = 6371e3 // Rayon de la Terre en mètres\n    const φ1 = (lat1 * Math.PI) / 180\n    const φ2 = (lat2 * Math.PI) / 180\n    const Δφ = ((lat2 - lat1) * Math.PI) / 180\n    const Δλ = ((lon2 - lon1) * Math.PI) / 180\n\n    const a =\n      Math.sin(Δφ / 2) * Math.sin(Δφ / 2) +\n      Math.cos(φ1) * Math.cos(φ2) * Math.sin(Δλ / 2) * Math.sin(Δλ / 2)\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))\n\n    return R * c // Distance en mètres\n  }\n\n  /**\n   * Met à jour un émargement\n   */\n  async update(id: string, updates: AttendanceUpdate) {\n    try {\n      const { data, error } = await this.supabase\n        .from('attendance')\n        .update(updates)\n        .eq('id', id)\n        .select()\n        .single()\n\n      if (error) {\n        if (error.code === 'PGRST116' || error.code === '42P01') {\n          throw errorHandler.handleError(error, {\n            code: ErrorCode.DB_NOT_FOUND,\n            operation: 'update',\n            id,\n          })\n        }\n        if (error.code === '42501') {\n          throw errorHandler.handleError(error, {\n            code: ErrorCode.DB_RLS_POLICY_VIOLATION,\n            operation: 'update',\n            id,\n          })\n        }\n        throw errorHandler.handleError(error, {\n          operation: 'update',\n          id,\n          updates,\n        })\n      }\n\n      if (!data) {\n        throw errorHandler.createDatabaseError(\n          `Émargement avec l'ID ${id} introuvable pour la mise à jour`,\n          { id }\n        )\n      }\n\n      logger.info('Émargement mis à jour avec succès', {\n        id,\n        updates,\n      })\n\n      return data\n    } catch (error) {\n      if (error instanceof AppError) {\n        throw error\n      }\n      throw errorHandler.handleError(error, {\n        operation: 'update',\n        id,\n        updates,\n      })\n    }\n  }\n\n  /**\n   * Marque plusieurs présences en une fois\n   */\n  async markMultiple(\n    organizationId: string,\n    records: Array<{\n      student_id: string\n      class_id?: string\n      session_id?: string // Utiliser session_id au lieu de program_session_id\n      date: string\n      status: 'present' | 'absent' | 'late' | 'excused'\n      late_minutes?: number\n      teacher_id?: string\n      notes?: string\n    }>\n  ) {\n    const attendanceRecords = records.map((record) => ({\n      organization_id: organizationId,\n      ...record,\n      late_minutes: record.late_minutes || 0,\n    }))\n\n    try {\n      if (!records || records.length === 0) {\n        throw errorHandler.createValidationError(\n          'Aucun enregistrement à marquer',\n          'records'\n        )\n      }\n\n      const { data, error } = await this.supabase\n        .from('attendance')\n        .upsert(attendanceRecords, {\n          onConflict: 'student_id,class_id,session_id,date',\n        })\n        .select()\n\n      if (error) {\n        throw errorHandler.handleError(error, {\n          operation: 'markMultiple',\n          organizationId,\n          count: records.length,\n        })\n      }\n\n      logger.info('Présences marquées en masse avec succès', {\n        organizationId,\n        count: data?.length || 0,\n      })\n\n      return data || []\n    } catch (error) {\n      if (error instanceof AppError) {\n        throw error\n      }\n      throw errorHandler.handleError(error, {\n        operation: 'markMultiple',\n        organizationId,\n      })\n    }\n  }\n\n  /**\n   * Récupère les statistiques de présence pour un élève\n   */\n  async getStudentStats(studentId: string, startDate?: string, endDate?: string) {\n    let query = this.supabase\n      .from('attendance')\n      .select('status, date')\n      .eq('student_id', studentId)\n\n    if (startDate) {\n      query = query.gte('date', startDate)\n    }\n\n    if (endDate) {\n      query = query.lte('date', endDate)\n    }\n\n    try {\n      const { data, error } = await query\n\n      if (error) throw error\n\n      const total = data?.length || 0\n      const present = data?.filter((a) => a.status === 'present').length || 0\n      const absent = data?.filter((a) => a.status === 'absent').length || 0\n      const late = data?.filter((a) => a.status === 'late').length || 0\n      const excused = data?.filter((a) => a.status === 'excused').length || 0\n\n      return {\n        total,\n        present,\n        absent,\n        late,\n        excused,\n        attendanceRate: total > 0 ? (present / total) * 100 : 0,\n      }\n    } catch (error) {\n      if (error instanceof AppError) {\n        throw error\n      }\n      throw errorHandler.handleError(error, {\n        operation: 'getStudentStats',\n        studentId,\n      })\n    }\n  }\n\n  /**\n   * Récupère les statistiques de présence pour une classe\n   */\n  async getClassStats(classId: string, date?: string) {\n    let query = this.supabase\n      .from('attendance')\n      .select('status')\n      .eq('class_id', classId)\n\n    if (date) {\n      query = query.eq('date', date)\n    }\n\n    try {\n      const { data, error } = await query\n\n      if (error) {\n        throw errorHandler.handleError(error, {\n          operation: 'getClassStats',\n          classId,\n          date,\n        })\n      }\n\n      const total = data?.length || 0\n      const present = data?.filter((a) => a.status === 'present').length || 0\n      const absent = data?.filter((a) => a.status === 'absent').length || 0\n\n      return {\n        total,\n        present,\n        absent,\n        attendanceRate: total > 0 ? (present / total) * 100 : 0,\n      }\n    } catch (error) {\n      if (error instanceof AppError) {\n        throw error\n      }\n      throw errorHandler.handleError(error, {\n        operation: 'getClassStats',\n        classId,\n      })\n    }\n  }\n\n  /**\n   * Sauvegarde une signature d'enseignant\n   */\n  async saveTeacherSignature(attendanceId: string, signatureUrl: string) {\n    return this.update(attendanceId, {\n      teacher_signature_url: signatureUrl,\n    })\n  }\n}\n\nexport const attendanceService = new AttendanceService()\n","'use client'\n\nimport { useParams, useSearchParams, useRouter } from 'next/navigation'\nimport { useQuery, useMutation } from '@tanstack/react-query'\nimport { createClient } from '@/lib/supabase/client'\nimport { attendanceService } from '@/lib/services/attendance.service'\nimport { sessionService } from '@/lib/services/session.service'\nimport { useAuth } from '@/lib/hooks/use-auth'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { ArrowLeft, Save, CheckCircle, XCircle, Clock, AlertCircle, Calendar } from 'lucide-react'\nimport Link from 'next/link'\nimport { formatDate } from '@/lib/utils'\nimport { useState, useEffect } from 'react'\nimport type { SessionWithRelations, EnrollmentWithRelations, StudentWithRelations, AttendanceWithRelations } from '@/lib/types/query-types'\nimport type { TableRow } from '@/lib/types/supabase-helpers'\nimport { ElectronicAttendanceManager } from '@/components/attendance'\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'\n\ntype Attendance = TableRow<'attendance'>\n\ntype AttendanceStatus = 'present' | 'absent' | 'late' | 'excused'\n\nexport default function SessionAttendancePage() {\n  const params = useParams()\n  const searchParams = useSearchParams()\n  const router = useRouter()\n  const sessionId = params.id as string\n  const date = searchParams.get('date') || new Date().toISOString().split('T')[0]\n  const { user } = useAuth()\n  const supabase = createClient()\n\n  // Récupérer la session\n  const { data: session, isLoading: sessionLoading } = useQuery({\n    queryKey: ['session', sessionId],\n    queryFn: () => sessionService.getSessionById(sessionId),\n    enabled: !!sessionId,\n  })\n\n  // Récupérer les inscriptions à cette session\n  const { data: enrollments, isLoading: enrollmentsLoading } = useQuery<EnrollmentWithRelations[]>({\n    queryKey: ['session-enrollments', sessionId],\n    queryFn: async () => {\n      const { data, error } = await supabase\n        .from('enrollments')\n        .select('*, students(*)')\n        .eq('session_id', sessionId)\n        .in('status', ['confirmed', 'completed'])\n        .order('students(last_name)', { ascending: true })\n      if (error) throw error\n      // Mapper les résultats pour convertir null en undefined\n      return (data || []).map(enrollment => ({\n        ...enrollment,\n        students: enrollment.students || undefined,\n      })) as EnrollmentWithRelations[]\n    },\n    enabled: !!sessionId,\n  })\n\n  // Récupérer l'émargement existant\n  const { data: existingAttendance, refetch: refetchAttendance } = useQuery<AttendanceWithRelations[]>({\n    queryKey: ['attendance-session', sessionId, date],\n    queryFn: async () => {\n      const data = await attendanceService.getBySessionAndDate(sessionId, date)\n      // Convertir students: null en students: undefined pour correspondre à AttendanceWithRelations\n      return data.map((att: any) => ({\n        ...att,\n        students: att.students || undefined,\n      }))\n    },\n    enabled: !!sessionId,\n  })\n\n  // État local pour les présences\n  const [attendance, setAttendance] = useState<Record<string, {\n    status: AttendanceStatus\n    lateMinutes?: number\n    notes?: string\n  }>>({})\n\n  // Initialiser avec les données existantes\n  useEffect(() => {\n    if (existingAttendance && Array.isArray(existingAttendance) && enrollments) {\n      const initial: Record<string, {\n        status: AttendanceStatus\n        lateMinutes?: number\n        notes?: string\n      }> = {}\n      for (const att of existingAttendance) {\n        if (att.student_id) {\n          initial[att.student_id] = {\n            status: att.status as AttendanceStatus,\n            lateMinutes: att.late_minutes ?? undefined,\n            notes: att.notes || '',\n          }\n        }\n      }\n      // Ajouter les étudiants non encore émarginés\n      (enrollments as EnrollmentWithRelations[]).forEach((enrollment) => {\n        const studentId = enrollment.student_id\n        if (studentId && !initial[studentId]) {\n          initial[studentId] = {\n            status: 'present' as AttendanceStatus,\n            lateMinutes: 0,\n            notes: '',\n          }\n        }\n      })\n      setAttendance(initial)\n    } else if (enrollments && Array.isArray(enrollments)) {\n      // Initialiser tous les étudiants comme présents par défaut\n      const initial: Record<string, {\n        status: AttendanceStatus\n        lateMinutes?: number\n        notes?: string\n      }> = {}\n      for (const enrollment of enrollments) {\n        if (enrollment.student_id) {\n          initial[enrollment.student_id] = {\n            status: 'present' as AttendanceStatus,\n            lateMinutes: 0,\n            notes: '',\n          }\n        }\n      }\n      setAttendance(initial)\n    }\n  }, [existingAttendance, enrollments])\n\n  const updateAttendance = (\n    studentId: string,\n    field: 'status' | 'lateMinutes' | 'notes',\n    value: AttendanceStatus | number | string\n  ) => {\n    setAttendance((prev) => ({\n      ...prev,\n      [studentId]: {\n        ...prev[studentId],\n        [field]: value,\n      },\n    }))\n  }\n\n  const saveMutation = useMutation({\n    mutationFn: async () => {\n      if (!user?.organization_id || !enrollments) throw new Error('Données manquantes')\n\n      // Préparer les enregistrements\n      const records = (enrollments as EnrollmentWithRelations[])\n        .filter((enrollment) => enrollment.student_id) // Filtrer les student_id null\n        .map((enrollment) => ({\n          student_id: enrollment.student_id!,\n          session_id: sessionId,\n          date: date,\n          status: attendance[enrollment.student_id!]?.status || 'present',\n          late_minutes: attendance[enrollment.student_id!]?.lateMinutes || 0,\n          teacher_id: user.id,\n          notes: attendance[enrollment.student_id!]?.notes || undefined,\n        }))\n\n      return attendanceService.markMultiple(user.organization_id, records)\n    },\n    onSuccess: () => {\n      refetchAttendance()\n    },\n  })\n\n  const getStatusIcon = (status: AttendanceStatus) => {\n    switch (status) {\n      case 'present':\n        return <CheckCircle className=\"h-5 w-5 text-success-primary\" />\n      case 'absent':\n        return <XCircle className=\"h-5 w-5 text-red-600\" />\n      case 'late':\n        return <Clock className=\"h-5 w-5 text-warning-primary\" />\n      case 'excused':\n        return <AlertCircle className=\"h-5 w-5 text-blue-600\" />\n    }\n  }\n\n  const getStatusLabel = (status: AttendanceStatus) => {\n    switch (status) {\n      case 'present':\n        return 'Présent'\n      case 'absent':\n        return 'Absent'\n      case 'late':\n        return 'En retard'\n      case 'excused':\n        return 'Justifié'\n    }\n  }\n\n  const students = (enrollments as EnrollmentWithRelations[])?.map((e) => e.students).filter(Boolean) || []\n  const stats = students.length > 0\n    ? {\n        total: students.length,\n        present: Object.values(attendance).filter((a) => a.status === 'present').length,\n        absent: Object.values(attendance).filter((a) => a.status === 'absent').length,\n        late: Object.values(attendance).filter((a) => a.status === 'late').length,\n        excused: Object.values(attendance).filter((a) => a.status === 'excused').length,\n      }\n    : null\n\n  if (sessionLoading || enrollmentsLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"text-muted-foreground\">Chargement...</div>\n        </div>\n      </div>\n    )\n  }\n\n  if (!session) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"text-muted-foreground\">Session non trouvée</div>\n          <Link href=\"/dashboard/sessions\">\n            <Button className=\"mt-4\">Retour à la liste des sessions</Button>\n          </Link>\n        </div>\n      </div>\n    )\n  }\n\n  // La session a maintenant formations -> programs\n  const sessionData = session as SessionWithRelations\n  const formation = sessionData?.formations\n  const program = formation?.programs\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center space-x-4\">\n        <Link href={`/dashboard/sessions/${sessionId}`}>\n          <Button variant=\"ghost\" size=\"icon\">\n            <ArrowLeft className=\"h-4 w-4\" />\n          </Button>\n        </Link>\n        <div>\n          <h1 className=\"text-3xl font-bold text-gray-900\">\n            Émargement - {sessionData?.name || 'Session'}\n          </h1>\n          <p className=\"mt-2 text-sm text-gray-600\">\n            {formation && (\n              <Link href={`/dashboard/formations/${formation?.id}`} className=\"text-primary hover:underline\">\n                {formation?.name}\n              </Link>\n            )}\n            {program && (\n              <> • <Link href={`/dashboard/programs/${program?.id}`} className=\"text-primary hover:underline\">\n                {program?.name}\n              </Link></>\n            )}\n            {' - '}\n            <span className=\"flex items-center inline-flex mt-1\">\n              <Calendar className=\"mr-1 h-3 w-3\" />\n              {formatDate(date)}\n            </span>\n            {sessionData?.location && ` - ${sessionData.location}`}\n          </p>\n        </div>\n      </div>\n\n      <Tabs defaultValue=\"manual\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-2\">\n          <TabsTrigger value=\"manual\">Émargement manuel</TabsTrigger>\n          <TabsTrigger value=\"electronic\">Émargement électronique</TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"manual\" className=\"space-y-6\">\n          <div className=\"flex items-center justify-end\">\n            <Button\n              onClick={() => saveMutation.mutate()}\n              disabled={saveMutation.isPending || students.length === 0}\n            >\n              <Save className=\"mr-2 h-4 w-4\" />\n              {saveMutation.isPending ? 'Enregistrement...' : 'Enregistrer'}\n            </Button>\n          </div>\n\n      {/* Statistiques */}\n      {stats && (\n        <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4\">\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold\">{stats.total}</div>\n                <div className=\"text-sm text-muted-foreground\">Total</div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-success-primary\">{stats.present}</div>\n                <div className=\"text-sm text-muted-foreground\">Présents</div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-red-600\">{stats.absent}</div>\n                <div className=\"text-sm text-muted-foreground\">Absents</div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-warning-primary\">{stats.late}</div>\n                <div className=\"text-sm text-muted-foreground\">En retard</div>\n              </div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-blue-600\">{stats.excused}</div>\n                <div className=\"text-sm text-muted-foreground\">Justifiés</div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n\n      {/* Liste des participants */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Liste des participants</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {enrollments && enrollments.length > 0 ? (\n            <div className=\"space-y-4\">\n              {(enrollments as EnrollmentWithRelations[]).map((enrollment) => {\n                const student = enrollment.students\n                if (!student) return null\n                const studentAttendance = attendance[enrollment.student_id || ''] || {\n                  status: 'present' as AttendanceStatus,\n                  lateMinutes: 0,\n                  notes: '',\n                }\n\n                return (\n                  <div\n                    key={enrollment.id}\n                    className=\"flex items-center space-x-4 p-4 border rounded-lg hover:bg-gray-50 transition-colors\"\n                  >\n                    <div className=\"flex-shrink-0\">\n                      {student.photo_url ? (\n                        <img\n                          src={student.photo_url}\n                          alt={`${student.first_name} ${student.last_name}`}\n                          className=\"h-12 w-12 rounded-full object-cover\"\n                        />\n                      ) : (\n                        <div className=\"h-12 w-12 rounded-full bg-primary text-white flex items-center justify-center font-semibold\">\n                          {student.first_name.charAt(0)}{student.last_name.charAt(0)}\n                        </div>\n                      )}\n                    </div>\n\n                    <div className=\"flex-1 min-w-0\">\n                      <h3 className=\"font-semibold truncate\">\n                        {student.first_name} {student.last_name}\n                      </h3>\n                      <p className=\"text-sm text-muted-foreground\">{student.student_number}</p>\n                    </div>\n\n                    <div className=\"flex items-center space-x-4\">\n                      {/* Statut */}\n                      <div className=\"flex space-x-2\">\n                        {(['present', 'absent', 'late', 'excused'] as AttendanceStatus[]).map(\n                          (status) => (\n                            <button\n                              key={status}\n                              type=\"button\"\n                              onClick={() => updateAttendance(student.id, 'status', status)}\n                              className={`p-2 rounded-lg transition-colors min-touch-target touch-manipulation ${\n                                studentAttendance.status === status\n                                  ? 'bg-primary text-white'\n                                  : 'bg-gray-100 hover:bg-gray-200'\n                              }`}\n                              title={getStatusLabel(status)}\n                            >\n                              {getStatusIcon(status)}\n                            </button>\n                          )\n                        )}\n                      </div>\n\n                      {/* Minutes de retard */}\n                      {studentAttendance.status === 'late' && (\n                        <div className=\"w-20\">\n                          <input\n                            type=\"number\"\n                            min=\"0\"\n                            value={studentAttendance.lateMinutes || 0}\n                            onChange={(e) =>\n                              updateAttendance(enrollment.student_id || '', 'lateMinutes', parseInt(e.target.value) || 0)\n                            }\n                            className=\"w-full px-2 py-1 text-sm border rounded focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target\"\n                            placeholder=\"min\"\n                          />\n                          <p className=\"text-xs text-muted-foreground text-center mt-1\">min</p>\n                        </div>\n                      )}\n\n                      {/* Notes */}\n                      <div className=\"w-32\">\n                        <input\n                          type=\"text\"\n                          value={studentAttendance.notes || ''}\n                          onChange={(e) =>\n                            updateAttendance(enrollment.student_id || '', 'notes', e.target.value)\n                          }\n                          className=\"w-full px-2 py-1 text-sm border rounded focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target\"\n                          placeholder=\"Notes...\"\n                        />\n                      </div>\n                    </div>\n                  </div>\n                )\n              })}\n            </div>\n          ) : (\n            <div className=\"text-center py-12 text-muted-foreground\">\n              Aucun participant inscrit à cette session\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {saveMutation.error && (\n        <div className=\"bg-destructive/10 text-destructive px-4 py-3 rounded-lg text-sm\">\n          {saveMutation.error instanceof Error\n            ? saveMutation.error.message\n            : 'Une erreur est survenue lors de l\\'enregistrement'}\n        </div>\n      )}\n\n      {saveMutation.isSuccess && (\n        <div className=\"bg-success-bg text-success-primary px-4 py-3 rounded-lg text-sm\">\n          Émargement enregistré avec succès !\n        </div>\n      )}\n        </TabsContent>\n\n        <TabsContent value=\"electronic\" className=\"space-y-6\">\n          {user?.organization_id && (\n            <ElectronicAttendanceManager\n              sessionId={sessionId}\n              organizationId={user.organization_id}\n            />\n          )}\n        </TabsContent>\n      </Tabs>\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,8,15,16,17,18,19,20,21,22,23,24,25,26,27]}