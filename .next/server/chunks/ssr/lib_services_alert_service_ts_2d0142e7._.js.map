{"version":3,"sources":["../../../../lib/services/alert.service.ts","../../../../lib/services/email.service.ts"],"sourcesContent":["/**\n * Service pour gérer les alertes système (email, Slack, etc.)\n * Utilisé pour notifier les administrateurs en cas d'erreurs critiques ou d'événements importants\n */\n\nimport { logger } from '@/lib/utils/logger'\nimport { emailService } from './email.service'\n\nexport type AlertLevel = 'info' | 'warning' | 'error' | 'critical'\nexport type AlertChannel = 'email' | 'slack' | 'both'\n\nexport interface AlertOptions {\n  level: AlertLevel\n  title: string\n  message: string\n  details?: Record<string, any>\n  channel?: AlertChannel\n  recipients?: string[]\n  organizationId?: string\n}\n\nexport class AlertService {\n  /**\n   * Envoie une alerte via les canaux configurés\n   */\n  async sendAlert(options: AlertOptions): Promise<void> {\n    const {\n      level,\n      title,\n      message,\n      details = {},\n      channel = 'email',\n      recipients,\n      organizationId,\n    } = options\n\n    try {\n      // Logger l'alerte\n      logger[level === 'critical' || level === 'error' ? 'error' : 'warn'](\n        `[ALERT ${level.toUpperCase()}] ${title}: ${message}`,\n        details\n      )\n\n      // Envoyer via les canaux configurés\n      const promises: Promise<void>[] = []\n\n      if (channel === 'email' || channel === 'both') {\n        promises.push(this.sendEmailAlert(options))\n      }\n\n      if (channel === 'slack' || channel === 'both') {\n        promises.push(this.sendSlackAlert(options))\n      }\n\n      await Promise.allSettled(promises)\n    } catch (error) {\n      // Ne pas faire échouer l'application si l'alerte échoue\n      logger.error('Failed to send alert:', error)\n    }\n  }\n\n  /**\n   * Envoie une alerte par email\n   */\n  private async sendEmailAlert(options: AlertOptions): Promise<void> {\n    const { level, title, message, details, recipients, organizationId } = options\n\n    // Déterminer les destinataires\n    let emailRecipients: string[] = []\n\n    if (recipients && recipients.length > 0) {\n      emailRecipients = recipients\n    } else {\n      // Récupérer les admins de l'organisation ou les super admins\n      emailRecipients = await this.getAdminEmails(organizationId)\n    }\n\n    if (emailRecipients.length === 0) {\n      logger.warn('No email recipients found for alert')\n      return\n    }\n\n    // Construire le contenu de l'email\n    const subject = `[${level.toUpperCase()}] ${title}`\n    const htmlContent = this.buildEmailContent(level, title, message, details)\n\n    // Envoyer l'email\n    for (const recipient of emailRecipients) {\n      try {\n        await emailService.sendEmail({\n          to: recipient,\n          subject,\n          html: htmlContent,\n        })\n      } catch (error) {\n        logger.error(`Failed to send alert email to ${recipient}:`, error)\n      }\n    }\n  }\n\n  /**\n   * Envoie une alerte via Slack\n   */\n  private async sendSlackAlert(options: AlertOptions): Promise<void> {\n    const { level, title, message, details, organizationId } = options\n\n    const webhookUrl = process.env.SLACK_WEBHOOK_URL\n\n    if (!webhookUrl) {\n      logger.warn('SLACK_WEBHOOK_URL not configured, skipping Slack alert')\n      return\n    }\n\n    try {\n      // Déterminer la couleur selon le niveau\n      const colorMap: Record<AlertLevel, string> = {\n        info: '#36a64f', // Vert\n        warning: '#ffa500', // Orange\n        error: '#ff0000', // Rouge\n        critical: '#8b0000', // Rouge foncé\n      }\n\n      const payload = {\n        text: `*[${level.toUpperCase()}] ${title}*`,\n        attachments: [\n          {\n            color: colorMap[level],\n            fields: [\n              {\n                title: 'Message',\n                value: message,\n                short: false,\n              },\n              ...(organizationId\n                ? [\n                    {\n                      title: 'Organization ID',\n                      value: organizationId,\n                      short: true,\n                    },\n                  ]\n                : []),\n              ...(details && Object.keys(details).length > 0\n                ? [\n                    {\n                      title: 'Details',\n                      value: '```' + JSON.stringify(details, null, 2) + '```',\n                      short: false,\n                    },\n                  ]\n                : []),\n              {\n                title: 'Timestamp',\n                value: new Date().toISOString(),\n                short: true,\n              },\n            ],\n          },\n        ],\n      }\n\n      const response = await fetch(webhookUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(payload),\n      })\n\n      if (!response.ok) {\n        throw new Error(`Slack API returned ${response.status}`)\n      }\n    } catch (error) {\n      logger.error('Failed to send Slack alert:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Récupère les emails des administrateurs\n   */\n  private async getAdminEmails(organizationId?: string): Promise<string[]> {\n    // Cette fonction devrait être implémentée pour récupérer les emails des admins\n    // Pour l'instant, on retourne les emails depuis les variables d'environnement\n    const adminEmails = process.env.ADMIN_EMAILS?.split(',') || []\n\n    if (adminEmails.length > 0) {\n      return adminEmails.filter((email) => email.trim().length > 0)\n    }\n\n    // Fallback : utiliser l'email de support\n    const supportEmail = process.env.SUPPORT_EMAIL\n    if (supportEmail) {\n      return [supportEmail]\n    }\n\n    return []\n  }\n\n  /**\n   * Construit le contenu HTML de l'email\n   */\n  private buildEmailContent(\n    level: AlertLevel,\n    title: string,\n    message: string,\n    details?: Record<string, any>\n  ): string {\n    const colorMap: Record<AlertLevel, string> = {\n      info: '#36a64f',\n      warning: '#ffa500',\n      error: '#ff0000',\n      critical: '#8b0000',\n    }\n\n    const color = colorMap[level]\n    const timestamp = new Date().toLocaleString('fr-FR', {\n      dateStyle: 'full',\n      timeStyle: 'long',\n    })\n\n    return `\n      <!DOCTYPE html>\n      <html>\n        <head>\n          <meta charset=\"UTF-8\">\n          <style>\n            body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n            .header { background-color: ${color}; color: white; padding: 20px; border-radius: 5px 5px 0 0; }\n            .content { background-color: #f9f9f9; padding: 20px; border: 1px solid #ddd; }\n            .details { background-color: white; padding: 15px; margin-top: 15px; border-radius: 5px; }\n            .footer { text-align: center; margin-top: 20px; color: #666; font-size: 12px; }\n            pre { background-color: #f4f4f4; padding: 10px; border-radius: 3px; overflow-x: auto; }\n          </style>\n        </head>\n        <body>\n          <div class=\"container\">\n            <div class=\"header\">\n              <h2>[${level.toUpperCase()}] ${title}</h2>\n            </div>\n            <div class=\"content\">\n              <p><strong>Message:</strong></p>\n              <p>${message}</p>\n              ${details && Object.keys(details).length > 0 ? `\n                <div class=\"details\">\n                  <p><strong>Détails:</strong></p>\n                  <pre>${JSON.stringify(details, null, 2)}</pre>\n                </div>\n              ` : ''}\n            </div>\n            <div class=\"footer\">\n              <p>Alert générée le ${timestamp}</p>\n              <p>EDUZEN - Système de gestion scolaire</p>\n            </div>\n          </div>\n        </body>\n      </html>\n    `\n  }\n\n  /**\n   * Alerte pour erreur critique\n   */\n  async sendCriticalError(\n    error: Error,\n    context?: Record<string, any>\n  ): Promise<void> {\n    await this.sendAlert({\n      level: 'critical',\n      title: 'Erreur Critique',\n      message: error.message,\n      details: {\n        error: error.name,\n        stack: error.stack,\n        ...context,\n      },\n      channel: 'both',\n    })\n  }\n\n  /**\n   * Alerte pour erreur système\n   */\n  async sendSystemError(\n    message: string,\n    details?: Record<string, any>\n  ): Promise<void> {\n    await this.sendAlert({\n      level: 'error',\n      title: 'Erreur Système',\n      message,\n      details,\n      channel: 'email',\n    })\n  }\n\n  /**\n   * Alerte pour avertissement\n   */\n  async sendWarning(\n    message: string,\n    details?: Record<string, any>\n  ): Promise<void> {\n    await this.sendAlert({\n      level: 'warning',\n      title: 'Avertissement',\n      message,\n      details,\n      channel: 'email',\n    })\n  }\n\n  /**\n   * Alerte pour information\n   */\n  async sendInfo(\n    message: string,\n    details?: Record<string, any>\n  ): Promise<void> {\n    await this.sendAlert({\n      level: 'info',\n      title: 'Information',\n      message,\n      details,\n      channel: 'email',\n    })\n  }\n}\n\nexport const alertService = new AlertService()\n\n\n\n","/**\n * Service d'envoi d'emails\n * \n * Ce service permet d'envoyer des emails avec pièces jointes depuis l'application.\n * \n * Configuration requise :\n * - Installer Resend : npm install resend\n * - Ajouter RESEND_API_KEY dans .env.local\n * - Ou utiliser un autre service d'email (SendGrid, etc.)\n */\n\ninterface EmailAttachment {\n  filename: string\n  content: Blob | ArrayBuffer | string // Base64 ou Blob\n  contentType: string\n}\n\ninterface SendEmailOptions {\n  to: string | string[]\n  subject: string\n  html?: string\n  text?: string\n  attachments?: EmailAttachment[]\n  cc?: string | string[]\n  bcc?: string | string[]\n  replyTo?: string\n}\n\nexport class EmailService {\n  /**\n   * Convertit un Blob en base64\n   */\n  private async blobToBase64(blob: Blob): Promise<string> {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader()\n      reader.onloadend = () => {\n        const base64 = (reader.result as string).split(',')[1]\n        resolve(base64)\n      }\n      reader.onerror = reject\n      reader.readAsDataURL(blob)\n    })\n  }\n\n  /**\n   * Envoie un email avec pièces jointes\n   */\n  async sendEmail(options: SendEmailOptions): Promise<{ success: boolean; message: string }> {\n    try {\n      // Convertir les pièces jointes en base64 si nécessaire\n      const attachments = options.attachments\n        ? await Promise.all(\n            options.attachments.map(async (att) => {\n              let content: string\n              if (att.content instanceof Blob) {\n                content = await this.blobToBase64(att.content)\n              } else if (att.content instanceof ArrayBuffer) {\n                const blob = new Blob([att.content], { type: att.contentType })\n                content = await this.blobToBase64(blob)\n              } else {\n                content = att.content\n              }\n\n              return {\n                filename: att.filename,\n                content,\n                contentType: att.contentType,\n              }\n            })\n          )\n        : undefined\n\n      const response = await fetch('/api/email/send', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include', // Inclure les cookies pour l'authentification\n        body: JSON.stringify({\n          to: options.to,\n          subject: options.subject,\n          html: options.html,\n          text: options.text,\n          attachments,\n          cc: options.cc,\n          bcc: options.bcc,\n          replyTo: options.replyTo,\n        }),\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.message || 'Erreur lors de l\\'envoi de l\\'email')\n      }\n\n      const data = await response.json()\n      return { success: true, message: data.message || 'Email envoyé avec succès' }\n    } catch (error) {\n      throw new Error(\n        error instanceof Error\n          ? error.message\n          : 'Erreur lors de l\\'envoi de l\\'email'\n      )\n    }\n  }\n\n  /**\n   * Envoie un document PDF par email\n   */\n  async sendDocument(\n    to: string | string[],\n    subject: string,\n    pdfBlob: Blob,\n    filename: string,\n    htmlBody?: string,\n    textBody?: string\n  ): Promise<{ success: boolean; message: string }> {\n    return this.sendEmail({\n      to,\n      subject,\n      html: htmlBody,\n      text: textBody,\n      attachments: [\n        {\n          filename,\n          content: pdfBlob,\n          contentType: 'application/pdf',\n        },\n      ],\n    })\n  }\n\n  /**\n   * Envoie plusieurs documents par email\n   */\n  async sendMultipleDocuments(\n    to: string | string[],\n    subject: string,\n    documents: Array<{ blob: Blob; filename: string }>,\n    htmlBody?: string,\n    textBody?: string\n  ): Promise<{ success: boolean; message: string }> {\n    return this.sendEmail({\n      to,\n      subject,\n      html: htmlBody,\n      text: textBody,\n      attachments: documents.map((doc) => ({\n        filename: doc.filename,\n        content: doc.blob,\n        contentType: 'application/pdf',\n      })),\n    })\n  }\n}\n\nexport const emailService = new EmailService()\n"],"names":[],"mappings":"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"}