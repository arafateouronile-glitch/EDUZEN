module.exports=[724669,a=>{"use strict";let b=(0,a.i(170106).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);a.s(["TrendingUp",()=>b],724669)},621958,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);let e=c.createContext(void 0);function f({value:a,defaultValue:f,onValueChange:g,children:h,className:i}){let j=void 0!==a,[k,l]=c.useState(f??"");c.useEffect(()=>{j||void 0===f||l(f)},[f]);let m=j?a:k,n=c.useCallback(a=>{j||l(a),g?.(a)},[j,g]);return(0,b.jsx)(e.Provider,{value:{value:m,onValueChange:n},children:(0,b.jsx)("div",{className:(0,d.cn)("w-full",i),children:h})})}function g(){let a=c.useContext(e);if(!a)throw Error("Tabs components must be used within a Tabs component");return a}function h({children:a,className:c}){return(0,b.jsx)("div",{className:(0,d.cn)("inline-flex h-10 items-center justify-center rounded-lg bg-bg-gray-100 p-1 text-text-tertiary",c),children:a})}function i({value:a,children:c,className:e}){let{value:f,onValueChange:h}=g(),i=f===a;return(0,b.jsx)("button",{type:"button",onClick:()=>h(a),className:(0,d.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-outline-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",i?"bg-white text-text-primary shadow-sm":"text-text-tertiary hover:text-text-primary",e),children:c})}function j({value:a,children:c,className:e}){let{value:f}=g();return f!==a?null:(0,b.jsx)("div",{className:(0,d.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),children:c})}a.s(["Tabs",()=>f,"TabsContent",()=>j,"TabsList",()=>h,"TabsTrigger",()=>i])},824115,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getPolicies(a,b){let c=this.supabase.from("security_policies").select("*, approved_by_user:users!security_policies_approved_by_fkey(id, full_name, email)").or(`organization_id.eq.${a},organization_id.is.null`);b?.status&&(c=c.eq("status",b.status)),b?.category&&(c=c.eq("category",b.category));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e)throw e;return d}async createPolicy(a){let{data:b,error:c}=await this.supabase.from("security_policies").insert(a).select().single();if(c)throw c;return b}async updatePolicy(a,b){let{data:c,error:d}=await this.supabase.from("security_policies").update(b).eq("id",a).select().single();if(d)throw d;return c}async approvePolicy(a,b){return this.updatePolicy(a,{approval_status:"approved",approved_by:b,approved_at:new Date().toISOString(),status:"active"})}async getControls(a,b){let c=this.supabase.from("security_controls").select("*").eq("organization_id",a);b?.framework&&(c=c.eq("framework",b.framework)),b?.status&&(c=c.eq("implementation_status",b.status));let{data:d,error:e}=await c.order("control_id",{ascending:!0});if(e)throw e;return d}async createControl(a){let{data:b,error:c}=await this.supabase.from("security_controls").insert(a).select().single();if(c)throw c;return b}async updateControl(a,b){let{data:c,error:d}=await this.supabase.from("security_controls").update(b).eq("id",a).select().single();if(d)throw d;return c}async getControlComplianceStats(a,b){let c=await this.getControls(a,{framework:b}),d={total:c.length,implemented:c.filter(a=>"implemented"===a.implementation_status).length,partial:c.filter(a=>"partial"===a.implementation_status).length,not_implemented:c.filter(a=>"not_implemented"===a.implementation_status).length,compliant:c.filter(a=>"compliant"===a.compliance_status).length,partially_compliant:c.filter(a=>"partially_compliant"===a.compliance_status).length,non_compliant:c.filter(a=>"non_compliant"===a.compliance_status).length,compliance_percentage:0};return d.total>0&&(d.compliance_percentage=d.compliant/d.total*100),d}async getEvidence(a){let{data:b,error:c}=await this.supabase.from("compliance_evidence").select("*, collected_by_user:users!compliance_evidence_collected_by_fkey(id, full_name, email), verified_by_user:users!compliance_evidence_verified_by_fkey(id, full_name, email)").eq("control_id",a).order("collected_at",{ascending:!1});if(c)throw c;return b}async createEvidence(a){let{data:b,error:c}=await this.supabase.from("compliance_evidence").insert(a).select().single();if(c)throw c;return b}async verifyEvidence(a,b){let{data:c,error:d}=await this.supabase.from("compliance_evidence").update({verified_by:b,verified_at:new Date().toISOString()}).eq("id",a).select().single();if(d)throw d;return c}async getRisks(a,b){let c=this.supabase.from("risk_assessments").select("*, owner:users(id, full_name, email)").eq("organization_id",a);b?.treatmentStatus&&(c=c.eq("treatment_status",b.treatmentStatus)),b?.riskLevel&&(c=c.eq("risk_level",b.riskLevel));let{data:d,error:e}=await c.order("risk_level",{ascending:!1});if(e){if("PGRST200"===e.code||404===e.status||400===e.status||e.message?.includes("does not exist"))return[];throw e}return d||[]}async createRisk(a){let{data:b,error:c}=await this.supabase.from("risk_assessments").insert(a).select().single();if(c)throw c;return b}async updateRisk(a,b){let{data:c,error:d}=await this.supabase.from("risk_assessments").update(b).eq("id",a).select().single();if(d)throw d;return c}async getCriticalRisks(a){return this.getRisks(a,{riskLevel:"critical",treatmentStatus:"open"})}async getIncidents(a,b){let c=this.supabase.from("security_incidents").select("*, reported_by_user:users(id, full_name, email), assigned_to_user:users(id, full_name, email)").eq("organization_id",a);b?.status&&(c=c.eq("status",b.status)),b?.severity&&(c=c.eq("severity",b.severity));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e){if("PGRST200"===e.code||404===e.status||400===e.status||e.message?.includes("does not exist"))return[];throw e}return d||[]}async createIncident(a){let b=`INC-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,{data:c,error:d}=await this.supabase.from("security_incidents").insert({...a,incident_id:b}).select().single();if(d)throw d;return c}async updateIncident(a,b){let{data:c,error:d}=await this.supabase.from("security_incidents").update(b).eq("id",a).select().single();if(d)throw d;return c}async resolveIncident(a,b,c){return this.updateIncident(a,{status:"resolved",resolution:b,root_cause:c,resolved_at:new Date().toISOString()})}async getAudits(a,b){let c=this.supabase.from("security_audits").select("*").eq("organization_id",a);b?.status&&(c=c.eq("status",b.status)),b?.framework&&(c=c.eq("framework",b.framework));let{data:d,error:e}=await c.order("start_date",{ascending:!1});if(e)throw e;return d}async createAudit(a){let b=`AUDIT-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,{data:c,error:d}=await this.supabase.from("security_audits").insert({...a,audit_id:b}).select().single();if(d)throw d;return c}async getAuditFindings(a){let{data:b,error:c}=await this.supabase.from("audit_findings").select("*, assigned_to_user:users!audit_findings_assigned_to_fkey(id, full_name, email), control:security_controls(*)").eq("audit_id",a).order("severity",{ascending:!1});if(c)throw c;return b}async createAuditFinding(a){let{data:b,error:c}=await this.supabase.from("audit_findings").insert(a).select().single();if(c)throw c;return b}async getTrainings(a){let{data:b,error:c}=await this.supabase.from("security_training").select("*").eq("organization_id",a).eq("is_active",!0).order("created_at",{ascending:!1});if(c)throw c;return b}async getTrainingRecords(a){let{data:b,error:c}=await this.supabase.from("security_training_records").select("*, training:security_training(*)").eq("user_id",a).order("created_at",{ascending:!1});if(c)throw c;return b}async createTrainingRecord(a){let{data:b,error:c}=await this.supabase.from("security_training_records").insert(a).select().single();if(c)throw c;return b}async completeTraining(a,b){let{data:c,error:d}=await this.supabase.from("security_training_records").update({status:"completed",completion_percentage:100,score:b,completed_at:new Date().toISOString()}).eq("id",a).select().single();if(d)throw d;return c}async logAccess(a){let{data:b,error:c}=await this.supabase.from("access_logs").insert(a).select().single();if(c)throw c;return b}async getAccessLogs(a,b){let c=this.supabase.from("access_logs").select("*, user:users(id, full_name, email)").eq("organization_id",a);b?.userId&&(c=c.eq("user_id",b.userId)),b?.action&&(c=c.eq("action",b.action)),b?.startDate&&(c=c.gte("created_at",b.startDate.toISOString())),b?.endDate&&(c=c.lte("created_at",b.endDate.toISOString()));let{data:d,error:e}=await c.order("created_at",{ascending:!1}).limit(1e3);if(e)throw e;return d}async generateComplianceReport(a,b){await this.getControls(a,{framework:b});let c=await this.getRisks(a),d=await this.getIncidents(a),e=await this.getAudits(a,{framework:b}),f=await this.getControlComplianceStats(a,b),g=c.filter(a=>"critical"===a.risk_level&&"open"===a.treatment_status),h=d.filter(a=>"resolved"!==a.status&&"closed"!==a.status),i=e.filter(a=>{let b=new Date(a.start_date),c=new Date;return c.setMonth(c.getMonth()-6),b>=c});return{framework:b||"all",generated_at:new Date().toISOString(),controls:{total:f.total,compliance_percentage:f.compliance_percentage,implemented:f.implemented,partial:f.partial,not_implemented:f.not_implemented,compliant:f.compliant,partially_compliant:f.partially_compliant,non_compliant:f.non_compliant},risks:{total:c.length,critical:g.length,high:c.filter(a=>"high"===a.risk_level&&"open"===a.treatment_status).length,medium:c.filter(a=>"medium"===a.risk_level&&"open"===a.treatment_status).length,low:c.filter(a=>"low"===a.risk_level&&"open"===a.treatment_status).length,mitigated:c.filter(a=>"mitigated"===a.treatment_status).length},incidents:{total:d.length,open:h.length,critical:d.filter(a=>"critical"===a.severity&&"resolved"!==a.status).length,data_breaches:d.filter(a=>a.data_breach).length},audits:{total:e.length,recent:i.length,average_score:e.length>0?e.reduce((a,b)=>a+(b.overall_score||0),0)/e.length:0,average_compliance:e.length>0?e.reduce((a,b)=>a+(b.compliance_percentage||0),0)/e.length:0},recommendations:this.generateRecommendations(f,g,h)}}generateRecommendations(a,b,c){let d=[];return a.compliance_percentage<80&&d.push(`Le pourcentage de conformit\xe9 est de ${a.compliance_percentage.toFixed(1)}%. Il est recommand\xe9 d'am\xe9liorer l'impl\xe9mentation des contr\xf4les.`),b.length>0&&d.push(`${b.length} risque(s) critique(s) ouvert(s) n\xe9cessitent une attention imm\xe9diate.`),c.filter(a=>"critical"===a.severity).length>0&&d.push("Des incidents critiques sont en cours. Une intervention immédiate est requise."),a.not_implemented>0&&d.push(`${a.not_implemented} contr\xf4le(s) ne sont pas encore impl\xe9ment\xe9s.`),0===d.length&&d.push("Aucune recommandation urgente. La conformité est bonne."),d}};a.s(["complianceService",0,c])}];

//# sourceMappingURL=_3a51f22f._.js.map