module.exports=[450207,a=>{"use strict";var b=a.i(187924),c=a.i(50944),d=a.i(433217),e=a.i(337130),f=a.i(555074),g=a.i(269240),h=a.i(913216),i=a.i(340695),j=a.i(703130),k=a.i(400210),l=a.i(683245),m=a.i(941675),n=a.i(641710),o=a.i(790166),p=a.i(660246),q=a.i(953722),r=a.i(724669),s=a.i(495756),t=a.i(915618),u=a.i(124987),v=a.i(238246),w=a.i(497895),x=a.i(264321),y=a.i(427165),z=a.i(467149),A=a.i(659854),B=a.i(902274),C=a.i(48662);function D(){let a=(0,c.useParams)();(0,c.useRouter)();let D=a.id,{user:E}=(0,h.useAuth)(),F=(0,g.createClient)(),{data:G,isLoading:H}=(0,d.useQuery)({queryKey:["formation",D],queryFn:()=>e.formationService.getFormationById(D),enabled:!!D}),{data:I}=(0,d.useQuery)({queryKey:["formation-sessions",D,E?.organization_id],queryFn:async()=>E?.organization_id?f.sessionService.getAllSessions(E.organization_id,{formationId:D}):[],enabled:!!D&&!!E?.organization_id}),{data:J}=(0,d.useQuery)({queryKey:["formation-detail-stats",D,E?.organization_id],queryFn:async()=>{if(!D||!E?.organization_id)return null;let{data:a}=await F.from("sessions").select("id, status, start_date, end_date").eq("formation_id",D),b=a||[],c=b.map(a=>a.id).filter(a=>!!a),d=0,e=0,f=0;if(c&&c.length>0){let{data:a,error:b}=await F.from("enrollments").select("status").in("session_id",c);if(b)throw b;let g=a||[];d=g.length,e=g.filter(a=>a.status&&["confirmed","active"].includes(a.status)).length,f=g.filter(a=>"completed"===a.status).length}let g=b.length,h=b.filter(a=>"planned"===a.status).length,i=b.filter(a=>"ongoing"===a.status).length,j=b.filter(a=>"completed"===a.status).length,k=b.filter(a=>"cancelled"===a.status).length,l=G?.price?Number(G.price)*d:0,m=[{name:"Planifiées",value:h,color:"#3B82F6"},{name:"En cours",value:i,color:"#335ACF"},{name:"Terminées",value:j,color:"#6B7280"},{name:"Annulées",value:k,color:"#EF4444"}].filter(a=>a.value>0);if(c&&c.length>0){let{data:a,error:b}=await F.from("enrollments").select("status").in("session_id",c);if(b)throw b;let n=a||[];return{totalSessions:g,plannedSessions:h,ongoingSessions:i,completedSessions:j,cancelledSessions:k,totalEnrollments:d,activeEnrollments:e,completedEnrollments:f,totalRevenue:l,sessionStatusData:m,enrollmentStatusData:[{name:"Confirmées",value:n.filter(a=>"confirmed"===a.status).length,color:"#3B82F6"},{name:"Actives",value:n.filter(a=>"active"===a.status).length,color:"#335ACF"},{name:"Complétées",value:n.filter(a=>"completed"===a.status).length,color:"#6B7280"},{name:"Annulées",value:n.filter(a=>"cancelled"===a.status).length,color:"#EF4444"}].filter(a=>a.value>0)}}return{totalSessions:g,plannedSessions:h,ongoingSessions:i,completedSessions:j,cancelledSessions:k,totalEnrollments:d,activeEnrollments:e,completedEnrollments:f,totalRevenue:l,sessionStatusData:m,enrollmentStatusData:[]}},enabled:!!D&&!!E?.organization_id&&!!G});if(H)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("div",{className:"text-muted-foreground",children:"Chargement..."})})});if(!G)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-muted-foreground",children:"Formation non trouvée"}),(0,b.jsx)(v.default,{href:"/dashboard/formations",children:(0,b.jsx)(i.Button,{className:"mt-4",children:"Retour à la liste"})})]})});let K=G?.programs,L=I||[];return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)(v.default,{href:"/dashboard/formations",children:(0,b.jsx)(i.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(k.ArrowLeft,{className:"h-4 w-4"})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:G.name}),G.subtitle&&(0,b.jsx)("p",{className:"mt-1 text-lg text-gray-600",children:G.subtitle}),(0,b.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Code: ",G.code,K&&(0,b.jsxs)(b.Fragment,{children:[" • Programme: ",(0,b.jsx)(v.default,{href:`/dashboard/programs/${K.id}`,className:"text-primary hover:underline",children:K.name})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(v.default,{href:`/dashboard/formations/${D}/edit`,children:(0,b.jsxs)(i.Button,{variant:"outline",children:[(0,b.jsx)(l.Edit,{className:"mr-2 h-4 w-4"}),"Modifier"]})}),(0,b.jsx)(v.default,{href:`/dashboard/formations/${D}/sessions`,children:(0,b.jsxs)(i.Button,{children:[(0,b.jsx)(t.Plus,{className:"mr-2 h-4 w-4"}),"Nouvelle session"]})})]})]}),J&&(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(j.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Sessions"}),(0,b.jsx)("div",{className:"p-2 bg-blue-50 rounded-lg",children:(0,b.jsx)(m.Calendar,{className:"h-5 w-5 text-blue-600"})})]}),(0,b.jsxs)(j.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:J.totalSessions}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[J.ongoingSessions," en cours"]})]})]}),(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(j.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Inscriptions"}),(0,b.jsx)("div",{className:"p-2 bg-cyan-50 rounded-lg",children:(0,b.jsx)(p.Users,{className:"h-5 w-5 text-cyan-600"})})]}),(0,b.jsxs)(j.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:J.totalEnrollments}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[J.activeEnrollments," active",J.activeEnrollments>1?"s":""]})]})]}),(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(j.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Terminées"}),(0,b.jsx)("div",{className:"p-2 bg-brand-blue-ghost rounded-lg",children:(0,b.jsx)(s.CheckCircle,{className:"h-5 w-5 text-brand-blue"})})]}),(0,b.jsxs)(j.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-brand-blue",children:J.completedSessions}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Sessions"})]})]}),(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(j.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Complétées"}),(0,b.jsx)("div",{className:"p-2 bg-teal-50 rounded-lg",children:(0,b.jsx)(r.TrendingUp,{className:"h-5 w-5 text-teal-600"})})]}),(0,b.jsxs)(j.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-teal-600",children:J.completedEnrollments}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Inscriptions"})]})]}),(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(j.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Planifiées"}),(0,b.jsx)("div",{className:"p-2 bg-purple-50 rounded-lg",children:(0,b.jsx)(m.Calendar,{className:"h-5 w-5 text-purple-600"})})]}),(0,b.jsxs)(j.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:J.plannedSessions}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Sessions"})]})]}),(0,b.jsxs)(j.Card,{children:[(0,b.jsxs)(j.CardHeader,{className:"flex flex-row items-center justify-between pb-2",children:[(0,b.jsx)(j.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Revenu estimé"}),(0,b.jsx)("div",{className:"p-2 bg-brand-cyan-ghost rounded-lg",children:(0,b.jsx)(o.DollarSign,{className:"h-5 w-5 text-brand-cyan"})})]}),(0,b.jsxs)(j.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-brand-cyan",children:(0,w.formatCurrency)(J.totalRevenue,G?.currency||"XOF")}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Total"})]})]})]}),J&&(J.sessionStatusData.length>0||J.enrollmentStatusData.length>0)&&(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[J.sessionStatusData.length>0&&(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"Répartition des sessions"})}),(0,b.jsx)(j.CardContent,{children:(0,b.jsx)(C.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(x.PieChart,{children:[(0,b.jsx)(y.Pie,{data:J.sessionStatusData,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percent:b})=>`${a} ${(100*b).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:J.sessionStatusData.map((a,c)=>(0,b.jsx)(z.Cell,{fill:a.color},`cell-${c}`))}),(0,b.jsx)(A.Tooltip,{}),(0,b.jsx)(B.Legend,{})]})})})]}),J.enrollmentStatusData.length>0&&(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"Répartition des inscriptions"})}),(0,b.jsx)(j.CardContent,{children:(0,b.jsx)(C.ResponsiveContainer,{width:"100%",height:250,children:(0,b.jsxs)(x.PieChart,{children:[(0,b.jsx)(y.Pie,{data:J.enrollmentStatusData,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percent:b})=>`${a} ${(100*b).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:J.enrollmentStatusData.map((a,c)=>(0,b.jsx)(z.Cell,{fill:a.color},`cell-${c}`))}),(0,b.jsx)(A.Tooltip,{}),(0,b.jsx)(B.Legend,{})]})})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"Informations générales"})}),(0,b.jsxs)(j.CardContent,{className:"space-y-4",children:[G.description&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Description"}),(0,b.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:G.description})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[G.category&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Catégorie"}),(0,b.jsx)("p",{className:"font-medium",children:G.category})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Statut"}),(0,b.jsx)("span",{className:`px-2 py-1 rounded text-xs font-medium ${G.is_active?"bg-brand-blue-ghost text-brand-blue":"bg-gray-100 text-gray-800"}`,children:G.is_active?"Active":"Inactive"})]})]}),(G.duration_hours||G.duration_days)&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Durée"}),(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[G.duration_hours&&(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(n.Clock,{className:"mr-1 h-4 w-4"}),(0,b.jsxs)("span",{children:[G.duration_hours," heures"]})]}),G.duration_days&&(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(m.Calendar,{className:"mr-1 h-4 w-4"}),(0,b.jsxs)("span",{children:[G.duration_days," jours"]})]})]})]}),G.price&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Prix"}),(0,b.jsxs)("p",{className:"text-lg font-semibold flex items-center",children:[(0,b.jsx)(o.DollarSign,{className:"mr-1 h-5 w-5"}),(0,w.formatCurrency)(Number(G.price),G.currency||"XOF")]})]}),G.capacity_max&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Capacité maximale"}),(0,b.jsxs)("p",{className:"font-medium flex items-center",children:[(0,b.jsx)(p.Users,{className:"mr-1 h-4 w-4"}),G.capacity_max," apprenants"]})]})]})]}),G.pedagogical_objectives&&(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"Objectifs pédagogiques"})}),(0,b.jsx)(j.CardContent,{children:(0,b.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:G.pedagogical_objectives})})]}),G.learner_profile&&(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"Profil des apprenants"})}),(0,b.jsx)(j.CardContent,{children:(0,b.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:G.learner_profile})})]}),G.training_content&&(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"Contenu de la formation"})}),(0,b.jsx)(j.CardContent,{children:(0,b.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:G.training_content})})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[K&&(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsxs)(j.CardTitle,{className:"flex items-center",children:[(0,b.jsx)(q.BookOpen,{className:"mr-2 h-5 w-5"}),"Programme"]})}),(0,b.jsxs)(j.CardContent,{children:[(0,b.jsx)(v.default,{href:`/dashboard/programs/${K.id}`,children:(0,b.jsx)("p",{className:"font-semibold text-primary hover:underline",children:K.name})}),K.code&&(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["Code: ",K.code]})]})]}),(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"Actions rapides"})}),(0,b.jsxs)(j.CardContent,{className:"space-y-2",children:[(0,b.jsx)(v.default,{href:`/dashboard/formations/${D}/sessions`,className:"block",children:(0,b.jsxs)(i.Button,{variant:"outline",className:"w-full",children:[(0,b.jsx)(m.Calendar,{className:"mr-2 h-4 w-4"}),"Sessions"]})}),(0,b.jsx)(v.default,{href:`/dashboard/formations/${D}/edit`,className:"block",children:(0,b.jsxs)(i.Button,{variant:"outline",className:"w-full",children:[(0,b.jsx)(l.Edit,{className:"mr-2 h-4 w-4"}),"Modifier"]})})]})]}),(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsx)(j.CardTitle,{children:"Informations supplémentaires"})}),(0,b.jsxs)(j.CardContent,{className:"space-y-3 text-sm",children:[G.cpf_eligible&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"CPF éligible"}),(0,b.jsx)("p",{className:"font-medium text-brand-blue",children:"Oui"}),G.cpf_code&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Code CPF: ",G.cpf_code]})]}),G.modalities&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Modalités"}),(0,b.jsx)("p",{className:"font-medium",children:G.modalities})]}),G.version&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Version"}),(0,b.jsx)("p",{className:"font-medium",children:G.version}),G.version_date&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Date: ",(0,w.formatDate)(G.version_date)]})]}),G.created_at&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Date de création"}),(0,b.jsx)("p",{className:"font-medium",children:(0,w.formatDate)(G.created_at)})]}),G.updated_at&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground",children:"Dernière modification"}),(0,b.jsx)("p",{className:"font-medium",children:(0,w.formatDate)(G.updated_at)})]})]})]})]})]}),(0,b.jsxs)(j.Card,{children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(j.CardTitle,{className:"flex items-center",children:[(0,b.jsx)(m.Calendar,{className:"mr-2 h-5 w-5"}),"Sessions (",L.length,")"]}),(0,b.jsx)(v.default,{href:`/dashboard/formations/${D}/sessions`,children:(0,b.jsx)(i.Button,{variant:"outline",size:"sm",children:"Voir toutes les sessions"})})]})}),(0,b.jsx)(j.CardContent,{children:L.length>0?(0,b.jsxs)("div",{className:"space-y-3",children:[L.slice(0,5).map(a=>(0,b.jsx)(v.default,{href:`/dashboard/sessions/${a.id}`,children:(0,b.jsx)("div",{className:"p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"font-semibold",children:a.name}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground mt-1",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(m.Calendar,{className:"mr-1 h-3 w-3"}),(0,w.formatDate)(a.start_date),a.end_date&&` - ${(0,w.formatDate)(a.end_date)}`]}),a.location&&(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(u.MapPin,{className:"mr-1 h-3 w-3"}),a.location]}),a.start_time&&a.end_time&&(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(n.Clock,{className:"mr-1 h-3 w-3"}),a.start_time," - ",a.end_time]})]})]}),(0,b.jsx)("span",{className:`px-2 py-1 rounded text-xs font-medium ${"planned"===a.status?"bg-blue-100 text-blue-800":"ongoing"===a.status?"bg-brand-blue-ghost text-brand-blue":"completed"===a.status?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:"planned"===a.status?"Planifiée":"ongoing"===a.status?"En cours":"completed"===a.status?"Terminée":"Annulée"})]})})},a.id)),L.length>5&&(0,b.jsx)("div",{className:"text-center pt-2",children:(0,b.jsx)(v.default,{href:`/dashboard/formations/${D}/sessions`,children:(0,b.jsxs)(i.Button,{variant:"outline",size:"sm",children:["Voir toutes les ",L.length," sessions"]})})})]}):(0,b.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,b.jsx)(m.Calendar,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,b.jsx)("p",{children:"Aucune session pour cette formation"}),(0,b.jsx)(v.default,{href:`/dashboard/formations/${D}/sessions`,children:(0,b.jsx)(i.Button,{variant:"outline",className:"mt-4",children:"Créer une session"})})]})})]})]})}a.s(["default",()=>D])}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_formations_%5Bid%5D_page_tsx_c128c9a9._.js.map