module.exports=[641710,a=>{"use strict";let b=(0,a.i(170106).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],641710)},219897,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);a.i(460355);var e=a.i(346271);let f=c.forwardRef(({className:a,variant:c="default",hoverable:f=!1,glow:g=!1,glowColor:h="rgba(51, 90, 207, 0.3)",...i},j)=>(0,b.jsxs)(e.motion.div,{ref:j,className:(0,d.cn)("relative rounded-2xl border backdrop-blur-xl transition-all duration-300",{"bg-white/70 dark:bg-gray-900/70 border-white/20 dark:border-gray-700/30 shadow-lg":"default"===c,"bg-white/80 dark:bg-gray-900/80 border-white/30 dark:border-gray-700/40 shadow-xl":"premium"===c,"bg-white/50 dark:bg-gray-900/50 border-white/10 dark:border-gray-700/20 shadow-md":"subtle"===c,"cursor-pointer":f,"hover:shadow-2xl hover:scale-[1.02]":f,"hover:bg-white/90 dark:hover:bg-gray-900/90":f},a),whileHover:f?{scale:1.02,y:-2}:void 0,transition:{type:"spring",stiffness:300,damping:30},...i,children:[g&&(0,b.jsx)(e.motion.div,{className:"absolute inset-0 rounded-2xl opacity-0 blur-xl",style:{background:`radial-gradient(circle, ${h} 0%, transparent 70%)`},animate:{opacity:[0,.5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"}}),(0,b.jsx)("div",{className:"relative z-10",children:i.children})]}));f.displayName="GlassCard",a.s(["GlassCard",()=>f])},495756,a=>{"use strict";let b=(0,a.i(170106).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],495756)},284505,a=>{"use strict";let b=(0,a.i(170106).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);a.s(["Download",()=>b],284505)},177156,a=>{"use strict";let b=(0,a.i(170106).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);a.s(["Eye",()=>b],177156)},49583,a=>{"use strict";var b=a.i(187924),c=a.i(433217),d=a.i(572131),e=a.i(323625),f=a.i(727163),g=a.i(703130),h=a.i(340695),i=a.i(495756),j=a.i(641710),k=a.i(290821),l=a.i(911156),m=a.i(284505),n=a.i(177156),o=a.i(104720),p=a.i(497895);a.i(460355);var q=a.i(346271),r=a.i(219897),s=a.i(325383);function t(){let{student:a,studentId:t}=(0,e.useLearnerContext)(),u=(0,d.useMemo)(()=>t?(0,f.createLearnerClient)(t):null,[t]),{data:v,isLoading:w}=(0,c.useQuery)({queryKey:["learner-invoices",t],queryFn:async()=>{if(!t||!u)return[];try{let{data:a,error:b}=await u.from("invoices").select("*").eq("student_id",t).order("issue_date",{ascending:!1});if(b)return s.logger.warn("Error fetching invoices",{studentId:(0,s.maskId)(t),error:(0,s.sanitizeError)(b)}),[];return a||[]}catch(a){return s.logger.error("Unexpected error fetching invoices",a,{studentId:(0,s.maskId)(t),error:(0,s.sanitizeError)(a)}),[]}},enabled:!!t&&!!u,refetchOnWindowFocus:!0,refetchOnMount:!0}),{data:x,isLoading:y}=(0,c.useQuery)({queryKey:["learner-payments",t],queryFn:async()=>{if(!t||!u)return[];try{let{data:a,error:b}=await u.from("invoices").select("id").eq("student_id",t);if(b)return s.logger.warn("Error fetching invoices for payments",{studentId:(0,s.maskId)(t),error:(0,s.sanitizeError)(b)}),[];if(!a||0===a.length)return[];let c=a.map(a=>a.id),{data:d,error:e}=await u.from("payments").select("*").in("invoice_id",c).order("paid_at",{ascending:!1});if(e)return s.logger.warn("Error fetching payments",{studentId:(0,s.maskId)(t),error:(0,s.sanitizeError)(e)}),[];return d||[]}catch(a){return s.logger.error("Unexpected error fetching payments",a,{studentId:(0,s.maskId)(t),error:(0,s.sanitizeError)(a)}),[]}},enabled:!!t&&!!u,refetchOnWindowFocus:!0,refetchOnMount:!0}),z=v?.reduce((a,b)=>a+Number(b.total_amount||0),0)||0,A=x?.reduce((a,b)=>"completed"===b.status?a+Number(b.amount||0):a,0)||0,B=v?.filter(a=>(x?.filter(b=>b.invoice_id===a.id)||[]).filter(a=>"completed"===a.status).reduce((a,b)=>a+Number(b.amount||0),0)<Number(a.total_amount||0))||[],C=a=>{let b=(x?.filter(b=>b.invoice_id===a.id)||[]).filter(a=>"completed"===a.status).reduce((a,b)=>a+Number(b.amount||0),0);return b>=Number(a.total_amount||0)?{status:"paid",label:"Payée",icon:i.CheckCircle,color:"text-emerald-600"}:b>0?{status:"partial",label:"Partiellement payée",icon:j.Clock,color:"text-yellow-600"}:{status:"unpaid",label:"Impayée",icon:k.AlertCircle,color:"text-red-600"}};return w||y?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-blue mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Chargement des paiements..."})]})}):(0,b.jsxs)("div",{className:"space-y-8 pb-24 lg:pb-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Paiements"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Gérez vos factures et paiements"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,b.jsx)(r.GlassCard,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total factures"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:(0,p.formatCurrency)(z)})]}),(0,b.jsx)("div",{className:"p-3 bg-blue-100 rounded-full",children:(0,b.jsx)(o.FileText,{className:"h-6 w-6 text-blue-600"})})]})})}),(0,b.jsx)(r.GlassCard,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total payé"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-emerald-600",children:(0,p.formatCurrency)(A)})]}),(0,b.jsx)("div",{className:"p-3 bg-emerald-100 rounded-full",children:(0,b.jsx)(i.CheckCircle,{className:"h-6 w-6 text-emerald-600"})})]})})}),(0,b.jsx)(r.GlassCard,{children:(0,b.jsx)(g.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"En attente"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-red-600",children:(0,p.formatCurrency)(z-A)})]}),(0,b.jsx)("div",{className:"p-3 bg-red-100 rounded-full",children:(0,b.jsx)(k.AlertCircle,{className:"h-6 w-6 text-red-600"})})]})})})]}),B.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Factures en attente"}),(0,b.jsx)("div",{className:"grid gap-4",children:B.map((a,c)=>{let d=C(a),e=d.icon;return(0,b.jsx)(q.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*c},children:(0,b.jsx)(r.GlassCard,{children:(0,b.jsx)(g.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)(e,{className:`h-5 w-5 ${d.color}`}),(0,b.jsxs)("h3",{className:"font-semibold text-gray-900",children:["Facture #",a.invoice_number||a.id.slice(0,8)]}),(0,b.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${d.color} bg-opacity-10`,children:d.label})]}),(0,b.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,b.jsxs)("p",{children:["Date d'émission : ",a.issue_date?(0,p.formatDate)(a.issue_date):"N/A"]}),a.due_date&&(0,b.jsxs)("p",{children:["Échéance : ",(0,p.formatDate)(a.due_date)]})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-gray-900 mb-2",children:(0,p.formatCurrency)(a.total_amount||0)}),(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(n.Eye,{className:"h-4 w-4 mr-2"}),"Voir détails"]})]})]})})})},a.id)})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Historique des factures"}),v&&v.length>0?(0,b.jsx)("div",{className:"space-y-4",children:v.map((a,c)=>{let d=C(a),e=d.icon;return(0,b.jsx)(q.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*c},children:(0,b.jsx)(r.GlassCard,{children:(0,b.jsx)(g.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:`p-2 rounded-lg ${d.color.replace("text-","bg-").replace("-600","-100")}`,children:(0,b.jsx)(e,{className:`h-5 w-5 ${d.color}`})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"font-semibold text-gray-900",children:["Facture #",a.invoice_number||a.id.slice(0,8)]}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:a.issue_date?(0,p.formatDate)(a.issue_date):"N/A"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("p",{className:"text-lg font-bold text-gray-900",children:(0,p.formatCurrency)(a.total_amount||0)}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:d.label})]}),(0,b.jsxs)(h.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(m.Download,{className:"h-4 w-4 mr-2"}),"Télécharger"]})]})]})})})},a.id)})}):(0,b.jsx)(r.GlassCard,{children:(0,b.jsxs)(g.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(l.CreditCard,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Aucune facture disponible"})]})})]})]})}a.s(["default",()=>t])}];

//# sourceMappingURL=_edbcfc7f._.js.map