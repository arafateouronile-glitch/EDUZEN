{"version":3,"sources":["../../../../node_modules/lucide-react/src/icons/plus.ts","../../../../node_modules/lucide-react/src/icons/arrow-left.ts","../../../../node_modules/lucide-react/src/icons/clock.ts","../../../../node_modules/lucide-react/src/icons/user-plus.ts","../../../../lib/services/session.service.ts","../../../../lib/services/videoconference.service.ts","../../../../lib/services/formation.service.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Plus\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNSAxMmgxNCIgLz4KICA8cGF0aCBkPSJNMTIgNXYxNCIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/plus\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Plus = createLucideIcon('Plus', [\n  ['path', { d: 'M5 12h14', key: '1ays0h' }],\n  ['path', { d: 'M12 5v14', key: 's699le' }],\n]);\n\nexport default Plus;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ArrowLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTIgMTktNy03IDctNyIgLz4KICA8cGF0aCBkPSJNMTkgMTJINSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeft = createLucideIcon('ArrowLeft', [\n  ['path', { d: 'm12 19-7-7 7-7', key: '1l729n' }],\n  ['path', { d: 'M19 12H5', key: 'x3x0zl' }],\n]);\n\nexport default ArrowLeft;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Clock\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8cG9seWxpbmUgcG9pbnRzPSIxMiA2IDEyIDEyIDE2IDE0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/clock\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Clock = createLucideIcon('Clock', [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['polyline', { points: '12 6 12 12 16 14', key: '68esgv' }],\n]);\n\nexport default Clock;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name UserPlus\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTYgMjF2LTJhNCA0IDAgMCAwLTQtNEg2YTQgNCAwIDAgMC00IDR2MiIgLz4KICA8Y2lyY2xlIGN4PSI5IiBjeT0iNyIgcj0iNCIgLz4KICA8bGluZSB4MT0iMTkiIHgyPSIxOSIgeTE9IjgiIHkyPSIxNCIgLz4KICA8bGluZSB4MT0iMjIiIHgyPSIxNiIgeTE9IjExIiB5Mj0iMTEiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/user-plus\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst UserPlus = createLucideIcon('UserPlus', [\n  ['path', { d: 'M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2', key: '1yyitq' }],\n  ['circle', { cx: '9', cy: '7', r: '4', key: 'nufk8' }],\n  ['line', { x1: '19', x2: '19', y1: '8', y2: '14', key: '1bvyxn' }],\n  ['line', { x1: '22', x2: '16', y1: '11', y2: '11', key: '1shjgl' }],\n]);\n\nexport default UserPlus;\n","import { createClient } from '@/lib/supabase/client'\nimport type { SupabaseClient } from '@supabase/supabase-js'\nimport { calendarService } from './calendar.service'\nimport { videoconferenceService } from './videoconference.service'\nimport type { TableRow, TableInsert, TableUpdate, FlexibleInsert, FlexibleUpdate } from '@/lib/types/supabase-helpers'\n\n// Types pour les sessions (niveau 3)\ntype Session = TableRow<'sessions'>\ntype SessionInsert = TableInsert<'sessions'>\ntype SessionUpdate = TableUpdate<'sessions'>\n\n/**\n * Service pour gérer les SESSIONS\n * Une session appartient à une formation\n * Exemple : \"Session Hiver 2024\" (de la formation \"Excel avancé\")\n */\nexport class SessionService {\n  private supabase: SupabaseClient<any>\n\n\n  constructor(supabaseClient?: SupabaseClient<any>) {\n\n    this.supabase = supabaseClient || createClient()\n\n  }\n\n  /**\n   * Récupère toutes les sessions d'une organisation\n   */\n  async getAllSessions(organizationId: string, filters?: {\n    formationId?: string\n    status?: Session['status']\n    startDate?: string\n    endDate?: string\n    search?: string\n  }) {\n    let query = this.supabase\n      .from('sessions')\n      .select(`\n        *,\n        formations!inner(\n          *,\n          programs(*)\n        )\n      `)\n      .eq('formations.organization_id', organizationId)\n\n    if (filters?.formationId) {\n      query = query.eq('formation_id', filters.formationId)\n    }\n\n    if (filters?.status) {\n      query = query.eq('status', filters.status)\n    }\n\n    if (filters?.startDate) {\n      query = query.gte('start_date', filters.startDate)\n    }\n\n    if (filters?.endDate) {\n      query = query.lte('end_date', filters.endDate)\n    }\n\n    if (filters?.search) {\n      query = query.ilike('name', `%${filters.search}%`)\n    }\n\n    const { data, error } = await query.order('start_date', { ascending: true })\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Récupère une session par son ID avec sa formation, son programme (via formation) et tous ses programmes associés\n   */\n  async getSessionById(id: string) {\n    // Récupérer la session avec sa formation et son programme (relation indirecte)\n    const { data: session, error: sessionError } = await this.supabase\n      .from('sessions')\n      .select(`\n        *,\n        formations!inner(\n          *,\n          programs(*)\n        )\n      `)\n      .eq('id', id)\n      .single()\n\n    if (sessionError) throw sessionError\n\n    // Récupérer tous les programmes associés directement à cette session (relation many-to-many)\n    const { data: sessionPrograms, error: programsError } = await this.supabase\n      .from('session_programs')\n      .select(`\n        program_id,\n        programs(*)\n      `)\n      .eq('session_id', id)\n\n    if (programsError) throw programsError\n\n    // Ajouter les programmes associés à la session\n    return {\n      ...session,\n      session_programs: sessionPrograms?.map((sp: { programs: unknown }) => sp.programs).filter(Boolean) || [],\n    }\n  }\n\n  /**\n   * Crée une nouvelle session avec optionnellement plusieurs programmes associés\n   */\n  async createSession(session: FlexibleInsert<'sessions'>, programIds?: string[], organizationId?: string) {\n    // Vérifier d'abord que la formation existe et appartient à l'organisation de l'utilisateur\n    if (session.formation_id) {\n      const { data: formation, error: formationError } = await this.supabase\n        .from('formations')\n        .select('id, organization_id')\n        .eq('id', session.formation_id)\n        .single()\n\n      if (formationError) {\n        console.error('Erreur lors de la vérification de la formation:', formationError)\n        throw new Error(`Formation non trouvée: ${formationError.message}`)\n      }\n\n      if (!formation) {\n        throw new Error('Formation non trouvée')\n      }\n\n      console.log('Formation trouvée:', formation)\n    }\n\n    // Créer la session\n    const { data, error } = await this.supabase\n      .from('sessions')\n      .insert(session as SessionInsert)\n      .select()\n      .single()\n\n    if (error) {\n      console.error('Erreur RLS lors de la création de la session:', {\n        code: error.code,\n        message: error.message,\n        details: error.details,\n        hint: error.hint,\n        formation_id: session.formation_id,\n      })\n      throw error\n    }\n\n    // Si des programmes sont fournis, créer les associations\n    if (programIds && programIds.length > 0 && data) {\n      // Récupérer l'organization_id de la formation\n      const { data: formation } = await this.supabase\n        .from('formations')\n        .select('organization_id')\n        .eq('id', data.formation_id)\n        .single()\n\n      if (formation) {\n        const sessionPrograms = programIds.map((programId) => ({\n          session_id: data.id,\n          program_id: programId,\n          organization_id: formation.organization_id,\n        }))\n\n        const { error: linkError } = await this.supabase\n          .from('session_programs')\n          .insert(sessionPrograms)\n\n        if (linkError) {\n          console.error('Erreur lors de la création des associations session-programme:', linkError)\n          // Ne pas échouer complètement, mais logger l'erreur\n        }\n\n        // Synchroniser avec les calendriers si activé\n        if (formation.organization_id) {\n          await this.syncWithCalendars(data.id, formation.organization_id, 'create').catch((error) => {\n            console.error('Erreur lors de la synchronisation calendrier:', error)\n            // Ne pas échouer la création de session si la synchronisation échoue\n          })\n        }\n\n        // Créer une réunion visioconférence si activé\n        if (formation.organization_id) {\n          await this.createVideoconferenceMeeting(data.id, formation.organization_id).catch((error) => {\n            console.error('Erreur lors de la création de la réunion visioconférence:', error)\n            // Ne pas échouer la création de session si la création de réunion échoue\n          })\n        }\n      }\n    }\n\n    console.log('Session créée avec succès:', data)\n    return data\n  }\n\n  /**\n   * Met à jour les programmes associés à une session\n   */\n  async updateSessionPrograms(sessionId: string, programIds: string[], organizationId: string) {\n    // Supprimer toutes les associations existantes\n    const { error: deleteError } = await this.supabase\n      .from('session_programs')\n      .delete()\n      .eq('session_id', sessionId)\n\n    if (deleteError) throw deleteError\n\n    // Créer les nouvelles associations\n    if (programIds.length > 0) {\n      const sessionPrograms = programIds.map((programId) => ({\n        session_id: sessionId,\n        program_id: programId,\n        organization_id: organizationId,\n      }))\n\n      const { error: insertError } = await this.supabase\n        .from('session_programs')\n        .insert(sessionPrograms)\n\n      if (insertError) throw insertError\n    }\n\n    return true\n  }\n\n  /**\n   * Récupère tous les programmes associés à une session\n   */\n  async getSessionPrograms(sessionId: string) {\n    const { data, error } = await this.supabase\n      .from('session_programs')\n      .select(`\n        program_id,\n        programs(*)\n      `)\n      .eq('session_id', sessionId)\n\n    if (error) throw error\n    return data?.map((sp: { programs: unknown }) => sp.programs).filter(Boolean) || []\n  }\n\n  /**\n   * Met à jour une session\n   */\n  async updateSession(id: string, updates: FlexibleUpdate<'sessions'>) {\n    // Récupérer l'organization_id avant la mise à jour\n    const { data: existingSession } = await this.supabase\n      .from('sessions')\n      .select('formation_id, formations(organization_id)')\n      .eq('id', id)\n      .single()\n\n    const { data, error } = await this.supabase\n      .from('sessions')\n      .update(updates as SessionUpdate)\n      .eq('id', id)\n      .select()\n      .single()\n\n    if (error) throw error\n\n    // Synchroniser avec les calendriers si activé\n    const formation = existingSession?.formations as { organization_id?: string } | null\n    if (existingSession && formation?.organization_id) {\n      await this.syncWithCalendars(id, formation.organization_id, 'update').catch((error) => {\n        console.error('Erreur lors de la synchronisation calendrier:', error)\n      })\n    }\n\n    return data\n  }\n\n  /**\n   * Supprime une session\n   */\n  async deleteSession(id: string) {\n    // Récupérer l'organization_id avant la suppression\n    const { data: existingSession } = await this.supabase\n      .from('sessions')\n      .select('formation_id, formations(organization_id)')\n      .eq('id', id)\n      .single()\n\n    // Supprimer les événements calendrier si activé\n    const formation = existingSession?.formations as { organization_id?: string } | null\n    if (existingSession && formation?.organization_id) {\n      await this.syncWithCalendars(id, formation.organization_id, 'delete').catch((error) => {\n        console.error('Erreur lors de la suppression de l\\'événement calendrier:', error)\n      })\n    }\n\n    const { error } = await this.supabase\n      .from('sessions')\n      .delete()\n      .eq('id', id)\n\n    if (error) throw error\n  }\n\n  /**\n   * Crée une réunion visioconférence pour une session\n   */\n  private async createVideoconferenceMeeting(\n    sessionId: string,\n    organizationId: string\n  ): Promise<void> {\n    // Récupérer les intégrations visioconférence actives\n    const { data: integrations } = await this.supabase\n      .from('videoconference_integrations')\n      .select('*')\n      .eq('organization_id', organizationId)\n      .eq('is_active', true)\n      .eq('auto_create_meetings', true)\n\n    if (!integrations || integrations.length === 0) {\n      return // Pas d'intégrations actives\n    }\n\n    // Créer une réunion avec chaque système actif\n    for (const integration of integrations) {\n      try {\n        await videoconferenceService.createMeetingForSession(\n          sessionId,\n          { organizationId, provider: integration.provider as string }\n        )\n      } catch (error) {\n        console.error(`Erreur lors de la création de réunion avec ${integration.provider}:`, error)\n        // Continuer avec les autres intégrations même si une échoue\n      }\n    }\n  }\n\n  /**\n   * Synchronise une session avec les calendriers configurés\n   */\n  private async syncWithCalendars(\n    sessionId: string,\n    organizationId: string,\n    action: 'create' | 'update' | 'delete'\n  ): Promise<void> {\n    // Récupérer les intégrations calendrier actives\n    const { data: integrations } = await this.supabase\n      .from('calendar_integrations')\n      .select('*')\n      .eq('organization_id', organizationId)\n      .eq('is_active', true)\n      .eq('sync_sessions', true)\n      .eq('create_events_for_sessions', true)\n\n    if (!integrations || integrations.length === 0) {\n      return // Pas d'intégrations actives\n    }\n\n    // Synchroniser avec chaque calendrier\n    for (const integration of integrations) {\n      try {\n        // TODO: Implémenter deleteSessionEvent et syncSession dans CalendarService\n        // if (action === 'delete') {\n        //   await calendarService.deleteSessionEvent(\n        //     organizationId,\n        //     integration.provider as string,\n        //     sessionId\n        //   )\n        // } else {\n        //   await calendarService.syncSession(\n        //     organizationId,\n        //     integration.provider as string,\n        //     sessionId\n        //   )\n        // }\n        console.warn(`Calendar sync for ${action} not implemented yet for provider ${integration.provider}`)\n      } catch (error) {\n        console.error(`Erreur lors de la synchronisation avec ${integration.provider}:`, error)\n        // Continuer avec les autres intégrations même si une échoue\n      }\n    }\n  }\n\n  /**\n   * Récupère les sessions à venir\n   */\n  async getUpcomingSessions(organizationId: string, limit: number = 10) {\n    const today = new Date().toISOString().split('T')[0]\n    \n    const { data, error } = await this.supabase\n      .from('sessions')\n      .select(`\n        *,\n        formations!inner(\n          *,\n          programs(*)\n        )\n      `)\n      .eq('formations.organization_id', organizationId)\n      .gte('start_date', today)\n      .eq('status', 'planned')\n      .order('start_date', { ascending: true })\n      .limit(limit)\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Récupère les sessions en cours\n   */\n  async getOngoingSessions(organizationId: string) {\n    const today = new Date().toISOString().split('T')[0]\n    \n    const { data, error } = await this.supabase\n      .from('sessions')\n      .select(`\n        *,\n        formations!inner(\n          *,\n          programs(*)\n        )\n      `)\n      .eq('formations.organization_id', organizationId)\n      .lte('start_date', today)\n      .gte('end_date', today)\n      .eq('status', 'ongoing')\n      .order('start_date', { ascending: true })\n\n    if (error) throw error\n    return data\n  }\n\n  // ========== GESTION DES RELATIONS N:N FORMATION-SESSION ==========\n\n  /**\n   * Associe une session à une ou plusieurs formations\n   */\n  async addSessionToFormations(sessionId: string, formationIds: string[], organizationId: string) {\n    const formationSessions = formationIds.map((formationId, index) => ({\n      session_id: sessionId,\n      formation_id: formationId,\n      organization_id: organizationId,\n      order_index: index,\n    }))\n\n    const { data, error } = await this.supabase\n      .from('formation_sessions')\n      .insert(formationSessions)\n      .select()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Retire une session d'une formation\n   */\n  async removeSessionFromFormation(sessionId: string, formationId: string) {\n    const { error } = await this.supabase\n      .from('formation_sessions')\n      .delete()\n      .eq('session_id', sessionId)\n      .eq('formation_id', formationId)\n\n    if (error) throw error\n    return true\n  }\n\n  /**\n   * Met à jour les formations associées à une session\n   */\n  async updateSessionFormations(sessionId: string, formationIds: string[], organizationId: string) {\n    // Supprimer toutes les associations existantes\n    const { error: deleteError } = await this.supabase\n      .from('formation_sessions')\n      .delete()\n      .eq('session_id', sessionId)\n\n    if (deleteError) throw deleteError\n\n    // Créer les nouvelles associations\n    if (formationIds.length > 0) {\n      return this.addSessionToFormations(sessionId, formationIds, organizationId)\n    }\n\n    return []\n  }\n\n  /**\n   * Récupère toutes les formations associées à une session\n   */\n  async getSessionFormations(sessionId: string) {\n    const { data, error } = await this.supabase\n      .from('formation_sessions')\n      .select(`\n        formation_id,\n        order_index,\n        formations(*)\n      `)\n      .eq('session_id', sessionId)\n      .order('order_index', { ascending: true })\n\n    if (error) throw error\n    return data?.map((fs: { formations: unknown }) => fs.formations).filter(Boolean) || []\n  }\n\n  /**\n   * Récupère toutes les sessions d'une formation (via la table de liaison N:N)\n   */\n  async getFormationSessions(formationId: string) {\n    const { data, error } = await this.supabase\n      .from('formation_sessions')\n      .select(`\n        session_id,\n        order_index,\n        sessions(*)\n      `)\n      .eq('formation_id', formationId)\n      .order('order_index', { ascending: true })\n\n    if (error) throw error\n    return data?.map((fs: { sessions: unknown }) => fs.sessions).filter(Boolean) || []\n  }\n\n  /**\n   * Crée une session indépendante (sans formation obligatoire)\n   */\n  async createIndependentSession(\n    session: Omit<FlexibleInsert<'sessions'>, 'formation_id'> & { organization_id: string },\n    programIds?: string[],\n    formationIds?: string[]\n  ) {\n    // Créer la session sans formation_id\n    const { data, error } = await this.supabase\n      .from('sessions')\n      .insert({\n        ...session,\n        formation_id: null, // Pas de formation directe\n      } as SessionInsert)\n      .select()\n      .single()\n\n    if (error) throw error\n\n    // Associer les programmes si fournis\n    if (programIds && programIds.length > 0 && data) {\n      await this.updateSessionPrograms(data.id, programIds, session.organization_id)\n    }\n\n    // Associer les formations si fournies\n    if (formationIds && formationIds.length > 0 && data) {\n      await this.addSessionToFormations(data.id, formationIds, session.organization_id)\n    }\n\n    return data\n  }\n}\n\nexport const sessionService = new SessionService()\n\n\n\n\n\n\n\n\n\n\n\n","/**\n * Service pour gérer les vidéoconférences\n * TODO: Implémenter le service de vidéoconférence\n */\n\nexport const videoconferenceService = {\n  /**\n   * Crée une réunion vidéo pour une session\n   */\n  async createMeetingForSession(sessionId: string, options?: any) {\n    // TODO: Implémenter la création de réunion vidéo\n    console.warn('videoconferenceService.createMeetingForSession not implemented')\n    return null\n  },\n}\n","import { createClient } from '@/lib/supabase/client'\nimport type { SupabaseClient } from '@supabase/supabase-js'\nimport { Database } from '@/types/database.types'\nimport type { TableRow, TableInsert, TableUpdate, FlexibleInsert, FlexibleUpdate } from '@/lib/types/supabase-helpers'\n\n// Types pour les formations (niveau 2)\ntype Formation = TableRow<'formations'>\ntype FormationInsert = TableInsert<'formations'>\ntype FormationUpdate = TableUpdate<'formations'>\n\n/**\n * Service pour gérer les FORMATIONS\n * Une formation appartient à un programme et contient plusieurs sessions\n * Exemple : \"Formation Excel avancé\" (dans le programme \"Formation continue\")\n */\nexport class FormationService {\n  private supabase: SupabaseClient<Database>\n\n\n  constructor(supabaseClient?: SupabaseClient<Database>) {\n\n    this.supabase = supabaseClient || createClient()\n\n  }\n\n  /**\n   * Récupère toutes les formations d'une organisation\n   */\n  async getAllFormations(organizationId: string, filters?: {\n    programId?: string\n    isActive?: boolean\n    search?: string\n  }) {\n    let query = this.supabase\n      .from('formations')\n      .select(`\n        *,\n        programs(*)\n      `)\n      .eq('organization_id', organizationId)\n\n    if (filters?.programId) {\n      query = query.eq('program_id', filters.programId)\n    }\n\n    if (filters?.isActive !== undefined) {\n      query = query.eq('is_active', filters.isActive)\n    }\n\n    if (filters?.search) {\n      query = query.or(`name.ilike.%${filters.search}%,code.ilike.%${filters.search}%,description.ilike.%${filters.search}%`)\n    }\n\n    const { data, error } = await query.order('created_at', { ascending: false })\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Récupère une formation par son ID avec son programme et ses sessions\n   */\n  async getFormationById(id: string) {\n    const { data, error } = await this.supabase\n      .from('formations')\n      .select(`\n        *,\n        programs(*),\n        sessions(*)\n      `)\n      .eq('id', id)\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Crée une nouvelle formation\n   */\n  async createFormation(formation: FlexibleInsert<'formations'>) {\n    const { data, error } = await this.supabase\n      .from('formations')\n      .insert(formation as FormationInsert)\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Met à jour une formation\n   */\n  async updateFormation(id: string, updates: FlexibleUpdate<'formations'>) {\n    const { data, error } = await this.supabase\n      .from('formations')\n      .update(updates as FormationUpdate)\n      .eq('id', id)\n      .select()\n      .single()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Supprime une formation (soft delete)\n   */\n  async deleteFormation(id: string) {\n    return this.updateFormation(id, { is_active: false })\n  }\n\n  /**\n   * Récupère toutes les sessions d'une formation (relation directe legacy)\n   */\n  async getSessionsByFormation(formationId: string) {\n    const { data, error } = await this.supabase\n      .from('sessions')\n      .select('*')\n      .eq('formation_id', formationId)\n      .order('start_date', { ascending: true })\n\n    if (error) throw error\n    return data\n  }\n\n  // ========== GESTION DES RELATIONS N:N FORMATION-SESSION ==========\n\n  /**\n   * Récupère toutes les sessions d'une formation (via la table de liaison N:N)\n   * Inclut les sessions liées directement ET via formation_sessions\n   */\n  async getAllSessionsForFormation(formationId: string) {\n    // Sessions liées via formation_sessions (N:N)\n    const { data: linkedSessions, error: linkedError } = await this.supabase\n      .from('formation_sessions')\n      .select(`\n        session_id,\n        order_index,\n        sessions(*)\n      `)\n      .eq('formation_id', formationId)\n      .order('order_index', { ascending: true })\n\n    if (linkedError) throw linkedError\n\n    // Sessions liées directement (legacy)\n    const { data: directSessions, error: directError } = await this.supabase\n      .from('sessions')\n      .select('*')\n      .eq('formation_id', formationId)\n      .order('start_date', { ascending: true })\n\n    if (directError) throw directError\n\n    // Combiner les deux en évitant les doublons\n    const linkedSessionsData = (linkedSessions?.map((fs: { sessions: unknown }) => fs.sessions).filter(Boolean) || []) as Array<{ id: string }>\n    const directSessionsData = directSessions || []\n    \n    const allSessions = [...linkedSessionsData]\n    const linkedIds = new Set(linkedSessionsData.map((s: { id: string }) => s.id))\n    \n    for (const session of directSessionsData) {\n      if (!linkedIds.has(session.id)) {\n        allSessions.push(session)\n      }\n    }\n\n    return allSessions\n  }\n\n  /**\n   * Associe des sessions à une formation\n   */\n  async addSessionsToFormation(formationId: string, sessionIds: string[], organizationId: string) {\n    const formationSessions = sessionIds.map((sessionId, index) => ({\n      formation_id: formationId,\n      session_id: sessionId,\n      organization_id: organizationId,\n      order_index: index,\n    }))\n\n    const { data, error } = await this.supabase\n      .from('formation_sessions')\n      .insert(formationSessions)\n      .select()\n\n    if (error) throw error\n    return data\n  }\n\n  /**\n   * Retire une session d'une formation\n   */\n  async removeSessionFromFormation(formationId: string, sessionId: string) {\n    const { error } = await this.supabase\n      .from('formation_sessions')\n      .delete()\n      .eq('formation_id', formationId)\n      .eq('session_id', sessionId)\n\n    if (error) throw error\n    return true\n  }\n\n  /**\n   * Met à jour les sessions associées à une formation\n   */\n  async updateFormationSessions(formationId: string, sessionIds: string[], organizationId: string) {\n    // Supprimer toutes les associations existantes\n    const { error: deleteError } = await this.supabase\n      .from('formation_sessions')\n      .delete()\n      .eq('formation_id', formationId)\n\n    if (deleteError) throw deleteError\n\n    // Créer les nouvelles associations\n    if (sessionIds.length > 0) {\n      return this.addSessionsToFormation(formationId, sessionIds, organizationId)\n    }\n\n    return []\n  }\n\n  /**\n   * Récupère une formation avec toutes ses sessions (N:N et directes)\n   */\n  async getFormationWithAllSessions(id: string) {\n    const formation = await this.getFormationById(id)\n    if (!formation) return null\n\n    const allSessions = await this.getAllSessionsForFormation(id)\n    \n    return {\n      ...formation,\n      all_sessions: allSessions,\n    }\n  }\n}\n\nexport const formationService = new FormationService()\n\n"],"names":[],"mappings":"wCAaM,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAO,CAAP,WAAO,OAAA,EAAiB,MAAQ,CAAA,CAAA,AACpC,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA,CAAA,AAAE,EAAG,CAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAK,AAAL,QAAK,CAAU,CAAA,CAAA,AACzC,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA,CAAA,AAAE,EAAG,CAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CAC1C,CAAA,CAAA,oDCHK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAY,CAAZ,CAAA,CAAA,CAAA,CAAA,CAAA,MAAY,OAAA,EAAiB,WAAa,CAAA,CAAA,AAC9C,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA,CAAA,AAAE,EAAG,CAAkB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CAAA,AAC/C,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA,CAAA,AAAE,EAAG,CAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CAC1C,CAAA,CAAA,yDCHK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAQ,CAAR,CAAA,UAAQ,OAAA,EAAiB,OAAS,CAAA,CAAA,AACtC,CAAC,QAAU,CAAA,CAAA,AAAE,EAAI,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,CAAI,CAAA,CAAA,IAAA,CAAM,CAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAM,GAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA,CAAA,AACzD,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAY,CAAA,CAAE,AAAF,OAAU,CAAoB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CAC3D,CAAA,CAAA,qDCHK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAW,CAAX,CAAA,CAAA,CAAA,CAAA,OAAW,OAAA,EAAiB,UAAY,CAAA,CAAA,AAC5C,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA,CAAA,AAAE,EAAG,CAA6C,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CAAA,AAC1E,CAAC,QAAU,CAAA,CAAA,AAAE,EAAI,CAAA,CAAA,CAAA,CAAA,CAAK,CAAI,CAAA,CAAA,GAAA,CAAK,CAAG,CAAA,CAAA,CAAA,CAAA,CAAK,AAAL,GAAU,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAS,CAAA,CAAA,AACrD,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAQ,CAAE,CAAA,CAAA,CAAI,CAAM,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAI,AAAJ,CAAU,CAAA,CAAA,CAAA,CAAA,EAAA,CAAI,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAI,CAAA,CAAA,CAAA,CAAM,CAAA,CAAA,CAAA,CAAA,CAAK,AAAL,QAAK,CAAU,CAAA,CAAA,AACjE,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAQ,CAAE,CAAA,CAAA,CAAI,CAAM,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAI,CAAM,CAAA,CAAA,CAAA,CAAA,EAAA,CAAI,CAAA,CAAA,CAAA,CAAM,CAAA,CAAA,CAAA,CAAI,CAAA,CAAA,CAAA,CAAM,CAAA,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CACnE,CAAA,CAAA,wDClBD,IAAA,EAAA,EAAA,CAAA,CAAA,QCKO,MAIL,AAJW,MAIL,AAAwB,EAAmB,KAE/C,EAF6C,AAAe,MAEpD,IAAI,AANsB,CAMrB,kEACN,MDkiBE,EAAiB,IA9hBvB,AA8hB2B,MA9hBrB,AACH,QAA6B,AAGrC,aAAY,CAAoC,CAAE,CAEhD,IAAI,CAAC,QAAQ,CAAG,GAAkB,CAAA,EAAA,EAAA,YAAA,AAAY,GAEhD,CAKA,MAAM,eAAe,CAAsB,CAAE,CAM5C,CAAE,CACD,IAAI,EAAQ,IAAI,CAAC,QAAQ,CACtB,IAAI,CAAC,YACL,MAAM,CAAC,CAAC;;;;;;MAMT,CAAC,EACA,EAAE,CAAC,6BAA8B,GAEhC,GAAS,aAAa,CACxB,EAAQ,EAAM,EAAE,CAAC,eAAgB,EAAQ,YAAW,EAGlD,GAAS,QAAQ,CACnB,EAAQ,EAAM,EAAE,CAAC,SAAU,EAAQ,OAAM,EAGvC,GAAS,WAAW,CACtB,EAAQ,EAAM,GAAG,CAAC,aAAc,EAAQ,UAAS,EAG/C,GAAS,SAAS,CACpB,EAAQ,EAAM,GAAG,CAAC,WAAY,EAAQ,QAAO,EAG3C,GAAS,QAAQ,CACnB,EAAQ,EAAM,KAAK,CAAC,OAAQ,CAAC,CAAC,EAAE,EAAQ,MAAM,CAAC,CAAC,EAAC,EAGnD,GAAM,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,EAAM,KAAK,CAAC,aAAc,CAAE,WAAW,CAAK,GAE1E,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,CAKA,MAAM,eAAe,CAAU,CAAE,CAE/B,GAAM,CAAE,KAAM,CAAO,CAAE,MAAO,CAAY,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAC/D,IAAI,CAAC,YACL,MAAM,CAAC,CAAC;;;;;;MAMT,CAAC,EACA,EAAE,CAAC,KAAM,GACT,MAAM,GAET,GAAI,EAAc,MAAM,EAGxB,GAAM,CAAE,KAAM,CAAe,CAAE,MAAO,CAAa,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxE,IAAI,CAAC,oBACL,MAAM,CAAC,CAAC;;;MAGT,CAAC,EACA,EAAE,CAAC,aAAc,GAEpB,GAAI,EAAe,MAAM,EAGzB,MAAO,CACL,GAAG,CAAO,CACV,iBAAkB,GAAiB,IAAI,AAAC,GAA8B,EAAG,QAAQ,EAAE,OAAO,UAAY,EAAE,AAC1G,CACF,CAKA,MAAM,cAAc,CAAmC,CAAE,CAAqB,CAAE,CAAuB,CAAE,CAEvG,GAAI,EAAQ,YAAY,CAAE,CACxB,GAAM,CAAE,KAAM,CAAS,CAAE,MAAO,CAAc,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACnE,IAAI,CAAC,cACL,MAAM,CAAC,uBACP,EAAE,CAAC,KAAM,EAAQ,YAAY,EAC7B,MAAM,GAET,GAAI,EAEF,MADA,QAAQ,AADU,KACL,CAAC,kDAAmD,GAC3D,AAAI,MAAM,CAAC,0BAAuB,EAAE,EAAe,OAAO,CAAA,CAAE,EAGpE,GAAI,CAAC,EACH,MAAM,AAAI,GADI,GACE,yBAGlB,QAAQ,GAAG,CAAC,qBAAsB,EACpC,CAGA,GAAM,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,YACL,MAAM,CAAC,GACP,MAAM,GACN,MAAM,GAET,GAAI,EAQF,KARS,CACT,QAAQ,KAAK,CAAC,gDAAiD,CAC7D,KAAM,EAAM,IAAI,CAChB,QAAS,EAAM,OAAO,CACtB,QAAS,EAAM,OAAO,CACtB,KAAM,EAAM,IAAI,CAChB,aAAc,EAAQ,YACxB,AADoC,GAE9B,EAIR,GAAI,GAAc,EAAW,MAAM,CAAG,GAAK,EAAM,CAE/C,GAAM,CAAE,KAAM,CAAS,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAC5C,IAAI,CAAC,cACL,MAAM,CAAC,mBACP,EAAE,CAAC,KAAM,EAAK,YAAY,EAC1B,MAAM,GAET,GAAI,EAAW,CACb,IAAM,EAAkB,EAAW,GAAG,CAAC,AAAC,IAAe,CACrD,OADoD,IACxC,EAAK,EAAE,CACnB,WAAY,EACZ,gBAAiB,EAAU,eAAe,CAC5C,CAAC,EAEK,CAAE,MAAO,CAAS,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAC7C,IAAI,CAAC,oBACL,MAAM,CAAC,EAEN,IACF,OADa,CACL,KAAK,CAAC,iEAAkE,GAK9E,EAAU,eAAe,EAAE,AAC7B,MAAM,IAAI,CAAC,iBAAiB,CAAC,EAAK,EAAE,CAAE,EAAU,eAAe,CAAE,UAAU,KAAK,CAAC,AAAC,IAChF,QAAQ,KAAK,CAAC,gDAAiD,EAEjE,GAIE,EAAU,eAAe,EAAE,AAC7B,MAAM,IAAI,CAAC,4BAA4B,CAAC,EAAK,EAAE,CAAE,EAAU,eAAe,EAAE,KAAK,CAAE,AAAD,IAChF,QAAQ,KAAK,CAAC,4DAA6D,EAE7E,EAEJ,CACF,CAGA,OADA,QAAQ,GAAG,CAAC,6BAA8B,GACnC,CACT,CAKA,MAAM,sBAAsB,CAAiB,CAAE,CAAoB,CAAE,CAAsB,CAAE,CAE3F,GAAM,CAAE,MAAO,CAAW,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAC/C,IAAI,CAAC,oBACL,MAAM,GACN,EAAE,CAAC,aAAc,GAEpB,GAAI,EAAa,MAAM,EAGvB,GAAI,EAAW,MAAM,CAAG,EAAG,CACzB,IAAM,EAAkB,EAAW,GAAG,CAAC,AAAC,IAAe,CACrD,OADoD,IACxC,EACZ,WAAY,EACZ,gBAAiB,EACnB,CAAC,EAEK,CAAE,MAAO,CAAW,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAC/C,IAAI,CAAC,oBACL,MAAM,CAAC,GAEV,GAAI,EAAa,MAAM,CACzB,CAEA,OAAO,CACT,CAKA,MAAM,mBAAmB,CAAiB,CAAE,CAC1C,GAAM,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,oBACL,MAAM,CAAC,CAAC;;;MAGT,CAAC,EACA,EAAE,CAAC,aAAc,GAEpB,GAAI,EAAO,MAAM,EACjB,OAAO,GAAM,IAAI,AAAC,GAA8B,EAAG,QAAQ,EAAE,OAAO,UAAY,EAAE,AACpF,CAKA,MAAM,cAAc,CAAU,CAAE,CAAmC,CAAE,CAEnE,GAAM,CAAE,KAAM,CAAe,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAClD,IAAI,CAAC,YACL,MAAM,CAAC,6CACP,EAAE,CAAC,KAAM,GACT,MAAM,GAEH,MAAE,CAAI,CAAE,OAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,YACL,MAAM,CAAC,GACP,EAAE,CAAC,KAAM,GACT,MAAM,GACN,MAAM,GAET,GAAI,EAAO,MAAM,EAGjB,IAAM,EAAY,GAAiB,WAOnC,OANI,GAAmB,GAAW,iBAAiB,AACjD,MAAM,IAAI,CAAC,iBAAiB,CAAC,EAAI,EAAU,eAAe,CAAE,UAAU,KAAK,CAAC,AAAC,IAC3E,QAAQ,KAAK,CAAC,gDAAiD,EACjE,GAGK,CACT,CAKA,MAAM,cAAc,CAAU,CAAE,CAE9B,GAAM,CAAE,KAAM,CAAe,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAClD,IAAI,CAAC,YACL,MAAM,CAAC,6CACP,EAAE,CAAC,KAAM,GACT,MAAM,GAGH,EAAY,GAAiB,WAC/B,GAAmB,GAAW,iBAAiB,AACjD,MAAM,IAAI,CAAC,iBAAiB,CAAC,EAAI,EAAU,eAAe,CAAE,UAAU,KAAK,CAAC,AAAC,IAC3E,QAAQ,KAAK,CAAC,2DAA6D,EAC7E,GAGF,GAAM,OAAE,CAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAClC,IAAI,CAAC,YACL,MAAM,GACN,EAAE,CAAC,KAAM,GAEZ,GAAI,EAAO,MAAM,CACnB,CAKA,MAAc,6BACZ,CAAiB,CACjB,CAAsB,CACP,CAEf,GAAM,CAAE,KAAM,CAAY,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAC/C,IAAI,CAAC,gCACL,MAAM,CAAC,KACP,EAAE,CAAC,kBAAmB,GACtB,EAAE,CAAC,aAAa,GAChB,EAAE,CAAC,wBAAwB,GAE9B,GAAK,AAAD,GAAyC,GAAG,CAA3B,EAAa,MAAM,CAKxC,IAAK,IAAM,KAAe,EACxB,GAAI,CACF,MAAM,CAF8B,CAGlC,EACA,gBAAE,EAAgB,CAFS,QAEC,EAAY,QAAQ,AAAW,EAE/D,CAAE,EAJoD,IAI7C,EAAO,CACd,QAAQ,KAAK,CAAC,CAAC,iDAA2C,EAAE,EAAY,QAAQ,CAAC,CAAC,CAAC,CAAE,EAEvF,CAEJ,CAKA,MAAc,kBACZ,CAAiB,CACjB,CAAsB,CACtB,CAAsC,CACvB,CAEf,GAAM,CAAE,KAAM,CAAY,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAC/C,IAAI,CAAC,yBACL,MAAM,CAAC,KACP,EAAE,CAAC,kBAAmB,GACtB,EAAE,CAAC,aAAa,GAChB,EAAE,CAAC,iBAAiB,GACpB,EAAE,CAAC,6BAA8B,IAEpC,GAAK,AAAD,GAAyC,GAAG,CAA3B,EAAa,MAAM,CAKxC,IAAK,IAAM,KAAe,EACxB,GAAI,CAeF,OAhBoC,CAgB5B,IAAI,CAAC,CAAC,kBAAkB,EAAE,EAAO,kCAAkC,EAAE,EAAY,QAAQ,CAAA,CAAE,CACrG,CAAE,MAAO,EAAO,CACd,QAAQ,KAAK,CAAC,CAAC,uCAAuC,EAAE,EAAY,QAAQ,CAAC,CAAC,CAAC,CAAE,EAEnF,CAEJ,CAKA,MAAM,oBAAoB,CAAsB,CAAE,EAAgB,EAAE,CAAE,CACpE,IAAM,EAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAE9C,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,YACL,MAAM,CAAC,CAAC;;;;;;MAMT,CAAC,EACA,EAAE,CAAC,6BAA8B,GACjC,GAAG,CAAC,aAAc,GAClB,EAAE,CAAC,SAAU,WACb,KAAK,CAAC,aAAc,CAAE,WAAW,CAAK,GACtC,KAAK,CAAC,GAET,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,CAKA,MAAM,mBAAmB,CAAsB,CAAE,CAC/C,IAAM,EAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAE9C,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,YACL,MAAM,CAAC,CAAC;;;;;;MAMT,CAAC,EACA,EAAE,CAAC,6BAA8B,GACjC,GAAG,CAAC,aAAc,GAClB,GAAG,CAAC,WAAY,GAChB,EAAE,CAAC,SAAU,WACb,KAAK,CAAC,aAAc,CAAE,WAAW,CAAK,GAEzC,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,CAOA,MAAM,uBAAuB,CAAiB,CAAE,CAAsB,CAAE,CAAsB,CAAE,CAC9F,IAAM,EAAoB,EAAa,GAAG,CAAC,CAAC,EAAa,KAAW,CAClE,EADiE,SACrD,EACZ,aAAc,EACd,gBAAiB,EACjB,YAAa,EACf,CAAC,EAEK,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,sBACL,MAAM,CAAC,GACP,MAAM,GAET,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,CAKA,MAAM,2BAA2B,CAAiB,CAAE,CAAmB,CAAE,CACvE,GAAM,CAAE,OAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAClC,IAAI,CAAC,sBACL,MAAM,GACN,EAAE,CAAC,aAAc,GACjB,EAAE,CAAC,eAAgB,GAEtB,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,CAKA,MAAM,wBAAwB,CAAiB,CAAE,CAAsB,CAAE,CAAsB,CAAE,CAE/F,GAAM,CAAE,MAAO,CAAW,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAC/C,IAAI,CAAC,sBACL,MAAM,GACN,EAAE,CAAC,aAAc,GAEpB,GAAI,EAAa,MAAM,SAGvB,AAAI,EAAa,MAAM,CAAG,EACjB,CADoB,GAChB,CAAC,sBAAsB,CAAC,EAAW,EAAc,GAGvD,EAAE,AACX,CAKA,MAAM,qBAAqB,CAAiB,CAAE,CAC5C,GAAM,CAAE,MAAI,CAAE,OAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,sBACL,MAAM,CAAC,CAAC;;;;MAIT,CAAC,EACA,EAAE,CAAC,aAAc,GACjB,KAAK,CAAC,cAAe,CAAE,WAAW,CAAK,GAE1C,GAAI,EAAO,MAAM,EACjB,OAAO,GAAM,IAAK,AAAD,GAAiC,EAAG,UAAU,EAAE,OAAO,UAAY,EAAE,AACxF,CAKA,MAAM,qBAAqB,CAAmB,CAAE,CAC9C,GAAM,MAAE,CAAI,CAAE,OAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,sBACL,MAAM,CAAC,CAAC;;;;MAIT,CAAC,EACA,EAAE,CAAC,eAAgB,GACnB,KAAK,CAAC,cAAe,CAAE,WAAW,CAAK,GAE1C,GAAI,EAAO,MAAM,EACjB,OAAO,GAAM,IAAK,AAAD,GAA+B,EAAG,QAAQ,EAAE,OAAO,UAAY,EAAE,AACpF,CAKA,MAAM,yBACJ,CAAuF,CACvF,CAAqB,CACrB,CAAuB,CACvB,CAEA,GAAM,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,YACL,MAAM,CAAC,CACN,GAAG,CAAO,CACV,aAAc,IAChB,GACC,MAAM,GACN,MAAM,GAET,GAAI,EAAO,MAAM,EAYjB,OATI,GAAc,EAAW,MAAM,CAAG,GAAK,GACzC,GAD+C,GACzC,IAAI,CAAC,qBAAqB,CAAC,EAAK,EAAE,CAAE,EAAY,EAAQ,eAAe,EAI3E,GAAgB,EAAa,MAAM,CAAG,GAAK,GAC7C,GADmD,GAC7C,IAAI,CAAC,sBAAsB,CAAC,EAAK,EAAE,CAAE,EAAc,EAAQ,eAAe,EAG3E,CACT,CACF,8DE5iBA,IAAA,EAAA,EAAA,CAAA,CAAA,QAkPO,IAAM,EAAmB,IAnOzB,AAmO6B,MAnOvB,AACH,QAAkC,AAG1C,aAAY,CAAyC,CAAE,CAErD,IAAI,CAAC,QAAQ,CAAG,GAAkB,CAAA,EAAA,EAAA,YAAA,AAAY,GAEhD,CAKA,MAAM,iBAAiB,CAAsB,CAAE,CAI9C,CAAE,CACD,IAAI,EAAQ,IAAI,CAAC,QAAQ,CACtB,IAAI,CAAC,cACL,MAAM,CAAC,CAAC;;;MAGT,CAAC,EACA,EAAE,CAAC,kBAAmB,GAErB,GAAS,WAAW,CACtB,EAAQ,EAAM,EAAE,CAAC,aAAc,EAAQ,UAAS,EAG9C,GAAS,gBAAa,IACxB,EAAQ,EAAM,EAAE,CAAC,AADkB,YACL,EAAQ,SAAQ,EAG5C,GAAS,QAAQ,CACnB,EAAQ,EAAM,EAAE,CAAC,CAAC,YAAY,EAAE,EAAQ,MAAM,CAAC,cAAc,EAAE,EAAQ,MAAM,CAAC,qBAAqB,EAAE,EAAQ,MAAM,CAAC,CAAC,EAAC,EAGxH,GAAM,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,EAAM,KAAK,CAAC,aAAc,CAAE,WAAW,CAAM,GAE3E,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,CAKA,MAAM,iBAAiB,CAAU,CAAE,CACjC,GAAM,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,cACL,MAAM,CAAC,CAAC;;;;MAIT,CAAC,EACA,EAAE,CAAC,KAAM,GACT,MAAM,GAET,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,CAKA,MAAM,gBAAgB,CAAuC,CAAE,CAC7D,GAAM,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,cACL,MAAM,CAAC,GACP,MAAM,GACN,MAAM,GAET,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,CAKA,MAAM,gBAAgB,CAAU,CAAE,CAAqC,CAAE,CACvE,GAAM,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,cACL,MAAM,CAAC,GACP,EAAE,CAAC,KAAM,GACT,MAAM,GACN,MAAM,GAET,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,CAKA,MAAM,gBAAgB,CAAU,CAAE,CAChC,OAAO,IAAI,CAAC,eAAe,CAAC,EAAI,CAAE,WAAW,CAAM,EACrD,CAKA,MAAM,uBAAuB,CAAmB,CAAE,CAChD,GAAM,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,eAAgB,GACnB,KAAK,CAAC,aAAc,CAAE,WAAW,CAAK,GAEzC,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,CAQA,MAAM,2BAA2B,CAAmB,CAAE,CAEpD,GAAM,CAAE,KAAM,CAAc,CAAE,MAAO,CAAW,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACrE,IAAI,CAAC,sBACL,MAAM,CAAC,CAAC;;;;MAIT,CAAC,EACA,EAAE,CAAC,eAAgB,GACnB,KAAK,CAAC,cAAe,CAAE,WAAW,CAAK,GAE1C,GAAI,EAAa,MAAM,EAGvB,GAAM,CAAE,KAAM,CAAc,CAAE,MAAO,CAAW,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACrE,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,eAAgB,GACnB,KAAK,CAAC,aAAc,CAAE,WAAW,CAAK,GAEzC,GAAI,EAAa,MAAM,EAGvB,IAAM,EAAsB,GAAgB,IAAI,AAAC,GAA8B,EAAG,QAAQ,EAAE,OAAO,UAAY,EAAE,CAG3G,EAAc,IAAI,EAAmB,CACrC,EAAY,IAAI,IAAI,EAAmB,GAAG,CAAC,AAAC,GAAsB,EAAE,EAAE,GAE5E,IAAK,IAAM,KALgB,GAAkB,EAAE,CAMxC,AADe,AAChB,EAAW,GAAG,CAAC,EAAQ,EAAE,GAAG,AAC9B,EAAY,IAF0B,AAEtB,CAAC,GAIrB,OAAO,CACT,CAKA,MAAM,uBAAuB,CAAmB,CAAE,CAAoB,CAAE,CAAsB,CAAE,CAC9F,IAAM,EAAoB,EAAW,GAAG,CAAC,CAAC,EAAW,KAAW,CAC9D,EAD6D,WAC/C,EACd,WAAY,EACZ,gBAAiB,EACjB,YAAa,EACf,CAAC,EAEK,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CACxC,IAAI,CAAC,sBACL,MAAM,CAAC,GACP,MAAM,GAET,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,CAKA,MAAM,2BAA2B,CAAmB,CAAE,CAAiB,CAAE,CACvE,GAAM,OAAE,CAAK,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAClC,IAAI,CAAC,sBACL,MAAM,GACN,EAAE,CAAC,eAAgB,GACnB,EAAE,CAAC,aAAc,GAEpB,GAAI,EAAO,MAAM,EACjB,OAAO,CACT,CAKA,MAAM,wBAAwB,CAAmB,CAAE,CAAoB,CAAE,CAAsB,CAAE,CAE/F,GAAM,CAAE,MAAO,CAAW,CAAE,CAAG,MAAM,IAAI,CAAC,QAAQ,CAC/C,IAAI,CAAC,sBACL,MAAM,GACN,EAAE,CAAC,eAAgB,GAEtB,GAAI,EAAa,MAAM,SAGvB,AAAI,EAAW,MAAM,CAAG,EACf,CADkB,GACd,CAAC,sBAAsB,CAAC,EAAa,EAAY,GAGvD,EAAE,AACX,CAKA,MAAM,4BAA4B,CAAU,CAAE,CAC5C,IAAM,EAAY,MAAM,IAAI,CAAC,gBAAgB,CAAC,GAC9C,GAAI,CAAC,EAAW,OAAO,KAEvB,IAAM,EAAc,MAAM,IAAI,CAAC,0BAA0B,CAAC,GAE1D,MAAO,CACL,GAAG,CAAS,CACZ,aAAc,CAChB,CACF,CACF","ignoreList":[0,1,2,3]}