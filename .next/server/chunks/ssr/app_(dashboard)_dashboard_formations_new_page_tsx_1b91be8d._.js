module.exports=[939753,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(433217),f=a.i(370025),g=a.i(695245),h=a.i(159501),i=a.i(913216),j=a.i(337130),k=a.i(426099),l=a.i(555074),m=a.i(340695),n=a.i(703130),o=a.i(518523),p=a.i(400210),q=a.i(238246),r=a.i(437536);function s(){let a=(0,d.useRouter)(),{user:s,isLoading:t}=(0,i.useAuth)(),[u,v]=(0,c.useState)([]),{data:w}=(0,e.useQuery)({queryKey:["programs",s?.organization_id],queryFn:async()=>s?.organization_id?k.programService.getAllPrograms(s.organization_id,{isActive:!0}):[],enabled:!!s?.organization_id&&!t}),{data:x}=(0,e.useQuery)({queryKey:["sessions",s?.organization_id],queryFn:async()=>s?.organization_id?l.sessionService.getAllSessions(s.organization_id):[],enabled:!!s?.organization_id&&!t}),{register:y,handleSubmit:z,formState:{errors:A},watch:B,setValue:C}=(0,g.useForm)({resolver:(0,h.zodResolver)(r.formationSchema),mode:"onChange",defaultValues:{program_id:"",code:"",name:"",subtitle:"",photo_url:"",category:"",description:"",program_version:"",version_date:"",duration_hours:"",duration_days:"",duration_unit:"hours",price:"",currency:"XOF",payment_plan:"full",prerequisites:"",capacity_max:"",age_min:"",age_max:"",published_online:!1,eligible_cpf:!1,cpf_code:"",modalities:"",training_action_type:"",pedagogical_objectives:"",learner_profile:"",training_content:"",execution_follow_up:"",certification_modalities:"",quality:"",accounting_product_config:"",edof_export_fields:"",competence_domains:"",certification_issued:!1,is_active:!0}}),D=B(),E=(0,f.useMutation)({mutationFn:async a=>{if(!s?.organization_id)throw Error("Organization ID manquant");return j.formationService.createFormation({organization_id:s.organization_id,program_id:a.program_id||null,code:a.code,name:a.name,subtitle:a.subtitle||null,photo_url:a.photo_url||null,category:a.category||null,description:a.description||null,program_version:a.program_version||null,version_date:a.version_date||null,duration_hours:a.duration_hours?parseInt(a.duration_hours):null,duration_days:a.duration_days?parseInt(a.duration_days):null,duration_unit:a.duration_unit,price:a.price&&parseFloat(a.price)||0,currency:a.currency||"XOF",payment_plan:a.payment_plan,prerequisites:a.prerequisites||null,capacity_max:a.capacity_max?parseInt(a.capacity_max):null,age_min:a.age_min?parseInt(a.age_min):null,age_max:a.age_max?parseInt(a.age_max):null,published_online:a.published_online,eligible_cpf:a.eligible_cpf,cpf_code:a.cpf_code||null,modalities:a.modalities||null,training_action_type:a.training_action_type||null,pedagogical_objectives:a.pedagogical_objectives||null,learner_profile:a.learner_profile||null,training_content:a.training_content||null,execution_follow_up:a.execution_follow_up||null,certification_modalities:a.certification_modalities||null,quality:a.quality||null,accounting_product_config:a.accounting_product_config||null,edof_export_fields:a.edof_export_fields?JSON.parse(a.edof_export_fields):null,competence_domains:a.competence_domains||null,certification_issued:a.certification_issued,is_active:a.is_active??!0})},onSuccess:async b=>{if(u.length>0&&s?.organization_id&&b?.id)try{await j.formationService.addSessionsToFormation(b.id,u,s.organization_id)}catch(a){console.error("Erreur lors de l'ajout des sessions:",a)}b?.id&&a.push(`/dashboard/formations/${b.id}`)}}),F=z(a=>{E.mutate(a)});if(t)return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("p",{children:"Chargement..."})});if(!s||!s.organization_id)return(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Organisation manquante"}),(0,b.jsx)("p",{className:"text-red-700",children:"Votre compte n'est pas associé à une organisation."})]})});let G=x?.map(a=>({label:a.name,value:a.id}))||[];return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)(q.default,{href:"/dashboard/formations",children:(0,b.jsx)(m.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(p.ArrowLeft,{className:"h-4 w-4"})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Nouvelle formation"}),(0,b.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Créez une nouvelle formation (une formation appartient à un programme et contient plusieurs sessions)"})]})]}),(0,b.jsxs)("form",{onSubmit:F,className:"space-y-6",children:[(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{children:(0,b.jsx)(n.CardTitle,{children:"Informations de base"})}),(0,b.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Programme (Optionnel - Legacy)"}),(0,b.jsxs)("select",{...y("program_id"),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target ${A.program_id?"border-danger-primary":""}`,children:[(0,b.jsx)("option",{value:"",children:"Aucun programme"}),w?.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]}),A.program_id&&(0,b.jsx)("p",{className:"text-sm text-danger-primary mt-1",children:A.program_id.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Sessions associées (Nouveau - Multiples)"}),(0,b.jsx)(o.MultiSelect,{options:G,selected:u,onChange:v,placeholder:"Sélectionner des sessions existantes..."}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Vous pourrez également créer de nouvelles sessions plus tard."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Code *"}),(0,b.jsx)("input",{type:"text",...y("code"),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target ${A.code?"border-danger-primary":""}`,placeholder:"Ex: FORM-001"}),A.code&&(0,b.jsx)("p",{className:"text-sm text-danger-primary mt-1",children:A.code.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Titre de la formation *"}),(0,b.jsx)("input",{type:"text",...y("name"),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target ${A.name?"border-danger-primary":""}`,placeholder:"Ex: Formation en Informatique"}),A.name&&(0,b.jsx)("p",{className:"text-sm text-danger-primary mt-1",children:A.name.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Sous-titre"}),(0,b.jsx)("input",{type:"text",...y("subtitle"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Sous-titre de la formation"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Catégorie"}),(0,b.jsx)("input",{type:"text",...y("category"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Ex: Informatique, Management..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Photo de la formation (URL)"}),(0,b.jsx)("input",{type:"url",...y("photo_url"),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target ${A.photo_url?"border-danger-primary":""}`,placeholder:"https://..."}),A.photo_url&&(0,b.jsx)("p",{className:"text-sm text-danger-primary mt-1",children:A.photo_url.message})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Description de la formation"}),(0,b.jsx)("textarea",{...y("description"),rows:4,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Description détaillée de la formation..."})]})]})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{children:(0,b.jsx)(n.CardTitle,{children:"Version de la formation"})}),(0,b.jsx)(n.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Version de la formation"}),(0,b.jsx)("input",{type:"text",...y("program_version"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Ex: 1.0"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Date de la version"}),(0,b.jsx)("input",{type:"date",...y("version_date"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target"})]})]})})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{children:(0,b.jsx)(n.CardTitle,{children:"Durée de la formation"})}),(0,b.jsx)(n.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Durée (heures)"}),(0,b.jsx)("input",{type:"number",...y("duration_hours"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Ex: 120"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Durée (jours)"}),(0,b.jsx)("input",{type:"number",...y("duration_days"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Ex: 15"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Unité de durée"}),(0,b.jsxs)("select",{...y("duration_unit"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",children:[(0,b.jsx)("option",{value:"hours",children:"Heure(s)"}),(0,b.jsx)("option",{value:"days",children:"Jour(s)"})]})]})]})})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{children:(0,b.jsx)(n.CardTitle,{children:"Tarification"})}),(0,b.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Prix"}),(0,b.jsx)("input",{type:"number",step:"0.01",...y("price"),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target ${A.price?"border-danger-primary":""}`,placeholder:"0.00"}),A.price&&(0,b.jsx)("p",{className:"text-sm text-danger-primary mt-1",children:A.price.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Devise"}),(0,b.jsxs)("select",{...y("currency"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",children:[(0,b.jsx)("option",{value:"XOF",children:"XOF (Franc CFA Ouest)"}),(0,b.jsx)("option",{value:"XAF",children:"XAF (Franc CFA Centre)"}),(0,b.jsx)("option",{value:"EUR",children:"EUR (Euro)"}),(0,b.jsx)("option",{value:"USD",children:"USD (Dollar)"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Plan de paiement"}),(0,b.jsxs)("select",{...y("payment_plan"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",children:[(0,b.jsx)("option",{value:"full",children:"Paiement unique"}),(0,b.jsx)("option",{value:"installment",children:"Échelonné"}),(0,b.jsx)("option",{value:"free",children:"Gratuit"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Configuration comptable du produit"}),(0,b.jsx)("textarea",{...y("accounting_product_config"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Configuration comptable..."})]})]})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{children:(0,b.jsx)(n.CardTitle,{children:"Catalogue en ligne et CPF"})}),(0,b.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"published_online",...y("published_online"),className:"rounded border-gray-300 text-primary focus:ring-primary"}),(0,b.jsx)("label",{htmlFor:"published_online",className:"text-sm font-medium",children:"Publier sur le catalogue en ligne"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"eligible_cpf",...y("eligible_cpf"),className:"rounded border-gray-300 text-primary focus:ring-primary"}),(0,b.jsx)("label",{htmlFor:"eligible_cpf",className:"text-sm font-medium",children:"Eligible CPF (Compte Personnel Formation)"})]}),D.eligible_cpf&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Code CPF"}),(0,b.jsx)("input",{type:"text",...y("cpf_code"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Ex: 236631"})]})]})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{children:(0,b.jsx)(n.CardTitle,{children:"Détails de la formation"})}),(0,b.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Modalités"}),(0,b.jsx)("textarea",{...y("modalities"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Modalités de la formation..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Type d'action de formation"}),(0,b.jsx)("input",{type:"text",...y("training_action_type"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Type d'action de formation..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Objectifs pédagogiques"}),(0,b.jsx)("textarea",{...y("pedagogical_objectives"),rows:4,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Objectifs pédagogiques..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Profil des apprenants"}),(0,b.jsx)("textarea",{...y("learner_profile"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Profil des apprenants..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Contenu de la formation (progression pédagogique)"}),(0,b.jsx)("textarea",{...y("training_content"),rows:6,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Contenu de la formation..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Suivi de l'exécution"}),(0,b.jsx)("textarea",{...y("execution_follow_up"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Suivi de l'exécution..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Modalités de certification"}),(0,b.jsx)("textarea",{...y("certification_modalities"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Modalités de certification..."})]})]})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{children:(0,b.jsx)(n.CardTitle,{children:"Public cible"})}),(0,b.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Prérequis"}),(0,b.jsx)("textarea",{...y("prerequisites"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Prérequis pour suivre cette formation..."})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Âge minimum"}),(0,b.jsx)("input",{type:"number",...y("age_min"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Âge maximum"}),(0,b.jsx)("input",{type:"number",...y("age_max"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Capacité maximale"}),(0,b.jsx)("input",{type:"number",...y("capacity_max"),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target ${A.capacity_max?"border-danger-primary":""}`,placeholder:"Ex: 30"}),A.capacity_max&&(0,b.jsx)("p",{className:"text-sm text-danger-primary mt-1",children:A.capacity_max.message})]})]})]})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{children:(0,b.jsx)(n.CardTitle,{children:"Qualité et export"})}),(0,b.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Qualité"}),(0,b.jsx)("textarea",{...y("quality"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Informations qualité..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Champs pour l'export EDOF (JSON)"}),(0,b.jsx)("textarea",{...y("edof_export_fields"),rows:4,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",placeholder:'{"field1": "value1", "field2": "value2"}'})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Domaines de compétences"}),(0,b.jsx)("textarea",{...y("competence_domains"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Domaines de compétences..."})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"certification",...y("certification_issued"),className:"rounded border-gray-300 text-primary focus:ring-primary"}),(0,b.jsx)("label",{htmlFor:"certification",className:"text-sm font-medium",children:"Certificat délivré à l'issue de la formation"})]})]})]}),Object.keys(A).length>0&&(0,b.jsxs)("div",{className:"bg-warning-bg border border-warning-border rounded-lg p-4",children:[(0,b.jsx)("p",{className:"text-sm text-warning-primary font-medium mb-2",children:"Veuillez corriger les erreurs suivantes :"}),(0,b.jsxs)("ul",{className:"list-disc list-inside text-sm text-warning-primary space-y-1",children:[A.program_id&&(0,b.jsx)("li",{children:A.program_id.message}),A.code&&(0,b.jsx)("li",{children:A.code.message}),A.name&&(0,b.jsx)("li",{children:A.name.message}),A.photo_url&&(0,b.jsx)("li",{children:A.photo_url.message}),A.price&&(0,b.jsx)("li",{children:A.price.message}),A.capacity_max&&(0,b.jsx)("li",{children:A.capacity_max.message})]})]}),E.error&&(0,b.jsx)("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-lg text-sm",children:E.error instanceof Error?E.error.message:"Une erreur est survenue"}),(0,b.jsxs)("div",{className:"flex justify-end space-x-4 pt-4",children:[(0,b.jsx)(q.default,{href:"/dashboard/formations",children:(0,b.jsx)(m.Button,{type:"button",variant:"outline",children:"Annuler"})}),(0,b.jsx)(m.Button,{type:"submit",disabled:E.isPending,children:E.isPending?"Création...":"Créer la formation"})]})]})]})}a.s(["default",()=>s])}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_formations_new_page_tsx_1b91be8d._.js.map