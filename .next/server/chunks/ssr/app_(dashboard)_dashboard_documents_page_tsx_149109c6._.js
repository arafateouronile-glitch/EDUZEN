module.exports=[524830,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(433217),e=a.i(370025),f=a.i(937927),g=a.i(913216),h=a.i(163584),i=a.i(269240),j=a.i(542502),k=a.i(340695),l=a.i(219897),m=a.i(806368),n=a.i(915618),o=a.i(587532),p=a.i(104720),q=a.i(284505),r=a.i(773320),s=a.i(633508),t=a.i(177156),u=a.i(781560),v=a.i(435487),w=a.i(87466),x=a.i(660246),y=a.i(624722),z=a.i(170106);let A=(0,z.default)("FileOutput",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4",key:"702lig"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M2 15h10",key:"jfw4w8"}],["path",{d:"m5 12-3 3 3 3",key:"oke12k"}]]),B=(0,z.default)("FileInput",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4",key:"702lig"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M2 15h10",key:"jfw4w8"}],["path",{d:"m9 18 3-3-3-3",key:"112psh"}]]);var C=a.i(172162),D=a.i(992258),E=a.i(692759),F=a.i(584362),G=a.i(238246),H=a.i(497895);a.i(460355);var I=a.i(346271),J=a.i(262036),K=a.i(950463);function L(){let{user:a}=(0,g.useAuth)(),z=(0,i.createClient)(),L=(0,f.useQueryClient)(),M=(0,c.useRef)(null),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)("all"),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(null),[X,Y]=(0,c.useState)(!1),[Z,$]=(0,c.useState)(!1),[_,aa]=(0,c.useState)(null),[ab,ac]=(0,c.useState)({to:"",subject:"",message:""}),[ad,ae]=(0,c.useState)(!1),[af,ag]=(0,c.useState)({title:"",type:"other",studentId:"",file:null}),[ah,ai]=(0,c.useState)(1),aj=[{value:"all",label:"Tous les documents",icon:p.FileText},{value:"attestation",label:"Attestations de scolarité",icon:w.FileCheck},{value:"certificate",label:"Certificats de formation",icon:w.FileCheck},{value:"transcript",label:"Relevés de notes",icon:p.FileText},{value:"report_card",label:"Bulletins scolaires",icon:y.FileSpreadsheet},{value:"invoice",label:"Factures",icon:A},{value:"receipt",label:"Reçus de paiement",icon:B},{value:"convocation",label:"Convocations",icon:p.FileText},{value:"contract",label:"Contrats de scolarité",icon:p.FileText}],{data:ak,isLoading:al}=(0,d.useQuery)({queryKey:["documents",a?.organization_id,N,P,ah],queryFn:async()=>{if(!a?.organization_id)return{data:[],total:0,page:1,limit:20,totalPages:0};let b=await h.documentService.getAll(a.organization_id,{type:"all"!==P?P:void 0,page:ah,limit:20});if(N&&b.data){let a=b.data?.filter(a=>a.title?.toLowerCase().includes(N.toLowerCase())||a.type?.toLowerCase().includes(N.toLowerCase())||a.students?.first_name?.toLowerCase().includes(N.toLowerCase())||a.students?.last_name?.toLowerCase().includes(N.toLowerCase()))||[];return{...b,data:a,total:a.length,totalPages:Math.ceil(a.length/20)}}return b},enabled:!!a?.organization_id}),am=ak?.data||[];ak?.total,ak?.totalPages,(0,c.useEffect)(()=>{ai(1)},[N,P]);let{data:an}=(0,d.useQuery)({queryKey:["expected-documents",a?.organization_id],queryFn:async()=>{if(!a?.organization_id)return[];let b=new Date;b.setMonth(b.getMonth()-3);let{data:c,error:d}=await z.from("sessions").select(`
          id,
          name,
          start_date,
          end_date,
          status,
          formations!inner(
            id,
            name,
            organization_id,
            programs(id, name)
          )
        `).eq("formations.organization_id",a.organization_id).or(`status.eq.ongoing,status.eq.completed,end_date.gte.${b.toISOString().split("T")[0]}`).order("end_date",{ascending:!1});if(d)return console.error("Erreur lors de la récupération des sessions:",d),[];if(!c||0===c.length)return[];let e=[];for(let a of c){let b=a.id,c=await z.from("enrollments").select(`
            student_id,
            status,
            students!inner(id, first_name, last_name, student_number)
          `).eq("session_id",b).in("status",["confirmed","completed"]),d=c.data||null,f=c.error;if(f){console.error("Erreur lors de la récupération des inscriptions:",f);continue}if(d&&0!==d.length)for(let b of d){let c=b.students;if(!c)continue;let d=am?.find(b=>"certificate"===b.type&&b.student_id===c.id&&b.session_id===a.id);if(e.push({id:`expected-cert-${a.id}-${c.id}`,title:`Certificat de formation - ${c.first_name} ${c.last_name}`,type:"certificate",student_id:c.id,student:{first_name:c.first_name,last_name:c.last_name,student_number:c.student_number},session_id:a.id,session_name:a.name,isGenerated:!!d,document_id:d?.id||void 0,created_at:d?.created_at||void 0}),"ongoing"===a.status||new Date(a.end_date)>=new Date){let b=am?.find(b=>"attestation"===b.type&&b.student_id===c.id&&b.session_id===a.id);e.push({id:`expected-attest-${a.id}-${c.id}`,title:`Attestation de scolarit\xe9 - ${c.first_name} ${c.last_name}`,type:"attestation",student_id:c.id,student:{first_name:c.first_name,last_name:c.last_name,student_number:c.student_number},session_id:a.id,session_name:a.name,isGenerated:!!b,document_id:b?.id||void 0,created_at:b?.created_at||void 0})}}}return e},enabled:!!a?.organization_id}),ao=[...(am||[]).map(a=>({...a,isExpected:!1})),...(an||[]).map(a=>({...a,isExpected:!0}))],ap="all"!==P?ao.filter(a=>a.type===P):ao,{data:aq}=(0,d.useQuery)({queryKey:["students-all",a?.organization_id],queryFn:async()=>a?.organization_id?j.studentService.getAll(a.organization_id):[],enabled:!!a?.organization_id&&R}),ar=(0,e.useMutation)({mutationFn:async a=>{await h.documentService.delete(a)},onSuccess:()=>{L.invalidateQueries({queryKey:["documents",a?.organization_id]})}}),as=async()=>{if(!a?.organization_id||!af.file||!af.title)return void alert("Veuillez remplir tous les champs requis");U(!0);try{let b=af.file.name.split(".").pop(),c=`${Date.now()}_${Math.random().toString(36).substring(7)}.${b}`,d=`${a.organization_id}/${c}`,{data:e,error:f}=await z.storage.from("documents").upload(d,af.file,{cacheControl:"3600",upsert:!1});if(f)throw f;let{data:g}=z.storage.from("documents").getPublicUrl(d);await h.documentService.create({organization_id:a.organization_id,title:af.title,type:af.type,file_url:g.publicUrl,student_id:af.studentId||void 0}),ag({title:"",type:"other",studentId:"",file:null}),S(!1),M.current&&(M.current.value=""),L.invalidateQueries({queryKey:["documents",a?.organization_id]})}catch(a){console.error("Erreur lors de l'upload:",a),alert("Erreur lors de l'upload du document")}finally{U(!1)}},at=async()=>{if(!_||!ab.to)return void alert("Veuillez renseigner l'adresse email du destinataire");ae(!0);try{if(!(await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:ab.to,subject:ab.subject,message:ab.message,attachmentUrl:_.file_url,attachmentName:_.title})})).ok)throw Error("Erreur lors de l'envoi de l'email");alert("Email envoyé avec succès !"),$(!1),aa(null),ac({to:"",subject:"",message:""})}catch(a){console.error("Erreur lors de l'envoi de l'email:",a),alert("Erreur lors de l'envoi de l'email")}finally{ae(!1)}},au=(0,e.useMutation)({mutationFn:async b=>{if(!b.student_id)throw Error("Ce document n'est pas lié à un étudiant");let{error:c}=await z.from("learner_documents").insert({student_id:b.student_id,document_id:b.id,title:b.title,file_url:b.file_url,type:b.type,organization_id:a?.organization_id,sent_at:new Date().toISOString()});if(c)throw c},onSuccess:()=>{alert("Document envoyé dans l'espace apprenant avec succès !")},onError:a=>{console.error("Erreur lors de l'envoi vers l'espace apprenant:",a),alert(a.message||"Erreur lors de l'envoi vers l'espace apprenant")}}),av=a=>{let b=aj.find(b=>b.value===a);return b?.label||a},aw={total:am.length,generated:am.filter(a=>a.file_path).length,toGenerate:an?.filter(a=>!a.isGenerated).length||0,uploaded:am.filter(a=>a.uploaded_by).length},ax={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:[.16,1,.3,1]}}};return(0,b.jsxs)(I.motion.div,{className:"space-y-8 p-6 pb-8 max-w-[1600px] mx-auto",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"visible",children:[(0,b.jsxs)(I.motion.div,{variants:ax,className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"inline-flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:"p-2.5 bg-gradient-to-br from-brand-blue to-brand-cyan rounded-xl shadow-lg",children:(0,b.jsx)(p.FileText,{className:"h-7 w-7 text-white"})}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("h1",{className:"text-3xl lg:text-4xl font-bold bg-gradient-to-r from-brand-blue to-brand-cyan bg-clip-text text-transparent",children:"Documents"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"px-3 py-1 bg-gradient-to-r from-brand-blue-ghost to-brand-cyan-ghost text-brand-blue rounded-full text-sm font-medium border border-brand-blue/20",children:[ap?.length||0," total"]}),an&&an.filter(a=>!a.isGenerated).length>0&&(0,b.jsxs)("span",{className:"px-3 py-1 bg-gradient-to-r from-amber-500 to-amber-600 text-white rounded-full text-sm font-bold border border-amber-600 shadow-md",children:[an.filter(a=>!a.isGenerated).length," à générer"]})]})]})]}),(0,b.jsx)("p",{className:"text-gray-600 text-sm lg:text-base ml-1",children:"Gérez, générez et organisez tous vos documents administratifs"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(G.default,{href:"/dashboard/settings/document-templates",children:(0,b.jsxs)(k.Button,{variant:"outline",className:"hover:bg-brand-blue-ghost hover:border-brand-blue/30 hover:text-brand-blue transition-all",children:[(0,b.jsx)(p.FileText,{className:"mr-2 h-4 w-4"}),"Templates"]})}),(0,b.jsxs)(k.Button,{onClick:()=>S(!0),variant:"outline",className:"hover:bg-brand-cyan-ghost hover:border-brand-cyan/30 hover:text-brand-cyan transition-all",children:[(0,b.jsx)(r.Upload,{className:"mr-2 h-4 w-4"}),"Uploader"]}),(0,b.jsx)(G.default,{href:"/dashboard/documents/generate",children:(0,b.jsxs)(k.Button,{variant:"outline",className:"hover:bg-brand-blue-ghost hover:border-brand-blue/30 hover:text-brand-blue transition-all",children:[(0,b.jsx)(n.Plus,{className:"mr-2 h-4 w-4"}),"Générer"]})}),(0,b.jsx)(G.default,{href:"/dashboard/documents/generate-batch",children:(0,b.jsxs)(k.Button,{className:"bg-gradient-to-r from-brand-blue to-brand-cyan hover:from-brand-blue-dark hover:to-brand-cyan shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105",children:[(0,b.jsx)(x.Users,{className:"mr-2 h-4 w-4"}),"Génération en masse"]})})]})]}),(0,b.jsx)(m.BentoGrid,{columns:4,gap:"md",children:[{title:"Total Documents",value:aw.total,icon:p.FileText,color:"text-brand-blue",bg:"bg-gradient-to-br from-brand-blue-ghost to-brand-blue-ghost/50",borderColor:"border-brand-blue/20",desc:"Documents existants"},{title:"Documents Générés",value:aw.generated,icon:w.FileCheck,color:"text-brand-cyan",bg:"bg-gradient-to-br from-brand-cyan-ghost to-brand-cyan-ghost/50",borderColor:"border-brand-cyan/20",desc:"Depuis les templates"},{title:"À Générer",value:aw.toGenerate,icon:A,color:"text-amber-600",bg:"bg-gradient-to-br from-amber-50 to-amber-100/50",borderColor:"border-amber-200",desc:"Documents attendus",urgent:aw.toGenerate>0},{title:"Uploadés",value:aw.uploaded,icon:r.Upload,color:"text-brand-blue",bg:"bg-gradient-to-br from-brand-blue-ghost to-brand-blue-ghost/50",borderColor:"border-brand-blue/20",desc:"Importés manuellement"}].map((a,c)=>(0,b.jsx)(m.BentoCard,{span:1,className:"min-w-[200px]",children:(0,b.jsxs)(l.GlassCard,{variant:"premium",hoverable:!0,className:(0,H.cn)("h-full p-5 border-2 transition-all duration-300",a.borderColor),children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsx)(I.motion.div,{className:(0,H.cn)("p-2.5 rounded-xl transition-all duration-300 border",a.bg,a.borderColor),whileHover:{scale:1.1,rotate:5},children:(0,b.jsx)(a.icon,{className:(0,H.cn)("h-5 w-5",a.color)})}),(0,b.jsx)("span",{className:(0,H.cn)("text-2xl font-bold",0===c||3===c?"text-brand-blue":1===c?"text-brand-cyan":"text-amber-600"),children:a.value})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:a.title}),(0,b.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:a.desc})]})]})},a.title))}),(0,b.jsx)(I.motion.div,{variants:ax,children:(0,b.jsxs)(l.GlassCard,{variant:"default",className:"p-2 border-2 border-brand-blue/20 bg-gradient-to-br from-brand-blue-ghost/20 to-brand-cyan-ghost/20",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row gap-2",children:[(0,b.jsxs)("div",{className:"relative flex-1 group",children:[(0,b.jsx)(o.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-brand-blue group-focus-within:text-brand-cyan transition-colors"}),(0,b.jsx)("input",{type:"text",placeholder:"Rechercher un document...",value:N,onChange:a=>O(a.target.value),className:"w-full pl-10 pr-4 py-2.5 rounded-lg bg-white border-2 border-brand-blue/20 focus:border-brand-blue focus:ring-4 focus:ring-brand-blue/10 transition-all outline-none text-sm"})]}),(0,b.jsxs)(k.Button,{variant:"ghost",onClick:()=>Y(!X),className:(0,H.cn)("gap-2 transition-all",X?"bg-gradient-to-r from-brand-blue-ghost to-brand-cyan-ghost text-brand-blue border-2 border-brand-blue/30":"text-gray-600 hover:bg-brand-blue-ghost hover:text-brand-blue"),children:[(0,b.jsx)(C.SlidersHorizontal,{className:"h-4 w-4"}),"Filtres","all"!==P&&(0,b.jsx)("span",{className:"w-5 h-5 bg-gradient-to-r from-brand-blue to-brand-cyan text-white text-[10px] font-bold flex items-center justify-center rounded-full ml-1",children:"!"})]})]}),(0,b.jsx)(J.AnimatePresence,{children:X&&(0,b.jsx)(I.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:(0,b.jsx)("div",{className:"p-4 border-t border-brand-blue/20 mt-2",children:(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)("label",{className:"text-xs font-semibold text-brand-blue uppercase tracking-wider",children:"Type de document"}),(0,b.jsx)("select",{value:P,onChange:a=>Q(a.target.value),className:"w-full px-3 py-2 rounded-lg bg-white border-2 border-brand-blue/20 focus:border-brand-blue focus:ring-4 focus:ring-brand-blue/10 outline-none text-sm transition-all",children:aj.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]})})})})]})}),(0,b.jsx)(I.motion.div,{variants:ax,children:al?(0,b.jsx)(K.SkeletonList,{count:5}):am&&am.length>0?(0,b.jsx)(l.GlassCard,{variant:"default",className:"overflow-hidden p-0 border-2 border-brand-blue/10 bg-gradient-to-br from-white to-brand-blue-ghost/5",children:(0,b.jsx)("div",{className:"divide-y divide-brand-blue/10",children:am.map(a=>{var c;let d,e=(c=a.type,d=aj.find(a=>a.value===c),d?.icon||p.FileText);return(0,b.jsxs)(I.motion.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},className:"p-4 hover:bg-gradient-to-r hover:from-brand-blue-ghost/30 hover:to-brand-cyan-ghost/20 transition-all duration-300 flex items-center justify-between group",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,b.jsx)(I.motion.div,{whileHover:{scale:1.05,rotate:3},className:"h-12 w-12 rounded-xl bg-gradient-to-br from-brand-blue-ghost to-brand-cyan-ghost flex items-center justify-center text-brand-blue border border-brand-blue/20 shadow-sm",children:(0,b.jsx)(e,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("h3",{className:"font-bold text-gray-900 truncate group-hover:text-brand-blue transition-colors",children:a.title}),(0,b.jsx)("span",{className:"px-2.5 py-0.5 text-xs bg-gradient-to-br from-brand-blue-ghost to-brand-cyan-ghost text-brand-blue rounded-lg font-semibold uppercase tracking-wide border border-brand-blue/20",children:av(a.type)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[a.students&&(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(x.Users,{className:"h-3.5 w-3.5 text-brand-cyan"}),(0,b.jsxs)("span",{className:"font-medium text-gray-700",children:[a.students.first_name," ",a.students.last_name]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(p.FileText,{className:"h-3.5 w-3.5 text-brand-blue"}),(0,b.jsxs)("span",{className:"font-medium",children:["Généré le ",(0,H.formatDate)(a.created_at)]})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.file_url&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(G.default,{href:`/dashboard/documents/${a.id}`,children:(0,b.jsxs)(k.Button,{variant:"ghost",size:"sm",className:"text-gray-600 hover:text-brand-blue hover:bg-brand-blue-ghost transition-all",children:[(0,b.jsx)(t.Eye,{className:"mr-2 h-4 w-4"}),"Voir"]})}),(0,b.jsx)("a",{href:a.file_url,target:"_blank",rel:"noopener noreferrer",download:!0,children:(0,b.jsxs)(k.Button,{variant:"ghost",size:"sm",className:"text-gray-600 hover:text-brand-cyan hover:bg-brand-cyan-ghost transition-all",children:[(0,b.jsx)(q.Download,{className:"mr-2 h-4 w-4"}),"Télécharger"]})}),(0,b.jsx)(G.default,{href:`/dashboard/documents/${a.id}/sign`,children:(0,b.jsxs)(k.Button,{variant:"ghost",size:"sm",className:"text-gray-600 hover:text-purple-600 hover:bg-purple-50 transition-all",children:[(0,b.jsx)(F.PenTool,{className:"mr-2 h-4 w-4"}),"Signer"]})}),(0,b.jsxs)(k.Button,{variant:"ghost",size:"sm",onClick:()=>{let b;return aa(a),b=a.students?.email||"",void(ac({to:b,subject:`${av(a.type)} - ${a.title}`,message:`Bonjour ${a.students?.first_name||""} ${a.students?.last_name||""},

Veuillez trouver ci-joint votre ${av(a.type).toLowerCase()}.

Cordialement,
L'\xe9quipe EDUZEN`}),$(!0))},className:"text-gray-600 hover:text-brand-blue hover:bg-brand-blue-ghost transition-all",children:[(0,b.jsx)(D.Mail,{className:"mr-2 h-4 w-4"}),"Email"]}),a.student_id&&(0,b.jsxs)(k.Button,{variant:"ghost",size:"sm",onClick:()=>au.mutate(a),disabled:au.isPending,className:"text-gray-600 hover:text-brand-cyan hover:bg-brand-cyan-ghost transition-all",children:[(0,b.jsx)(E.Send,{className:"mr-2 h-4 w-4"}),"Espace"]})]}),(0,b.jsx)(k.Button,{variant:"ghost",size:"icon",onClick:()=>{confirm("Êtes-vous sûr de vouloir supprimer ce document ?")&&ar.mutate(a.id)},className:"text-gray-400 hover:text-red-600 hover:bg-red-50 transition-all",children:(0,b.jsx)(u.Trash2,{className:"h-4 w-4"})})]})]},a.id)})})}):(0,b.jsxs)(l.GlassCard,{variant:"default",className:"p-12 text-center border-2 border-brand-blue/20 bg-gradient-to-br from-brand-blue-ghost/30 to-brand-cyan-ghost/30",children:[(0,b.jsxs)("div",{className:"relative inline-block mb-6",children:[(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,b.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-brand-blue-ghost to-brand-cyan-ghost rounded-full opacity-50 blur-2xl"})}),(0,b.jsx)("div",{className:"relative p-6 bg-gradient-to-br from-brand-blue-ghost to-brand-cyan-ghost rounded-2xl inline-block",children:(0,b.jsx)(p.FileText,{className:"h-16 w-16 mx-auto text-brand-blue"})})]}),(0,b.jsxs)("div",{className:"space-y-2 mb-6",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"Aucun document trouvé"}),(0,b.jsx)("p",{className:"text-gray-600",children:N||"all"!==P?"Aucun document ne correspond à vos critères.":"Commencez par générer ou uploader votre premier document."})]}),!N&&"all"===P&&(0,b.jsx)(G.default,{href:"/dashboard/documents/generate",children:(0,b.jsxs)(k.Button,{className:"bg-gradient-to-r from-brand-blue to-brand-cyan hover:from-brand-blue-dark hover:to-brand-cyan shadow-md hover:shadow-lg transition-all",children:[(0,b.jsx)(n.Plus,{className:"mr-2 h-4 w-4"}),"Générer un document"]})})]})}),(0,b.jsx)(J.AnimatePresence,{children:R&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,b.jsxs)(I.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"w-full max-w-2xl bg-white rounded-2xl shadow-2xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Uploader un document"}),(0,b.jsx)(k.Button,{variant:"ghost",size:"icon",onClick:()=>{S(!1),ag({title:"",type:"other",studentId:"",file:null})},children:(0,b.jsx)(s.X,{className:"h-5 w-5"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6 max-h-[80vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Titre du document *"}),(0,b.jsx)("input",{type:"text",value:af.title,onChange:a=>ag(b=>({...b,title:a.target.value})),className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 focus:ring-2 focus:ring-brand-blue/20 focus:border-brand-blue outline-none transition-all",placeholder:"Ex: Certificat de formation"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Type de document *"}),(0,b.jsxs)("select",{value:af.type,onChange:a=>ag(b=>({...b,type:a.target.value})),className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 focus:ring-2 focus:ring-brand-blue/20 focus:border-brand-blue outline-none transition-all",children:[aj.filter(a=>"all"!==a.value).map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value)),(0,b.jsx)("option",{value:"other",children:"Autre"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Étudiant (optionnel)"}),(0,b.jsxs)("select",{value:af.studentId||"",onChange:a=>ag(b=>({...b,studentId:a.target.value||void 0})),className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 focus:ring-2 focus:ring-brand-blue/20 focus:border-brand-blue outline-none transition-all",children:[(0,b.jsx)("option",{value:"",children:"Aucun étudiant spécifique"}),aq?.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.first_name," ",a.last_name]},a.id))]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Fichier *"}),(0,b.jsxs)("div",{className:(0,H.cn)("border-2 border-dashed rounded-xl p-8 text-center transition-all cursor-pointer hover:border-brand-blue hover:bg-brand-blue-ghost/10",af.file?"border-success-primary bg-success-bg/10":"border-gray-300"),onClick:()=>!af.file&&M.current?.click(),children:[(0,b.jsx)("input",{ref:M,type:"file",onChange:a=>{let b=a.target.files?.[0];b&&ag(a=>({...a,file:b}))},accept:".pdf,.jpg,.jpeg,.png,.gif,.doc,.docx,.xls,.xlsx",className:"hidden"}),af.file?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-success-bg rounded-full flex items-center justify-center mx-auto",children:(0,b.jsx)(w.FileCheck,{className:"h-6 w-6 text-success-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:af.file.name}),(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:[(af.file.size/1024/1024).toFixed(2)," MB"]})]}),(0,b.jsx)(k.Button,{variant:"outline",size:"sm",onClick:a=>{a.stopPropagation(),ag(a=>({...a,file:null})),M.current&&(M.current.value="")},className:"mt-2",children:"Changer de fichier"})]}):(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto group-hover:bg-brand-blue-ghost group-hover:text-brand-blue transition-colors",children:(0,b.jsx)(r.Upload,{className:"h-6 w-6 text-gray-400 group-hover:text-brand-blue"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:"Cliquez pour sélectionner un fichier"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"PDF, Images, Word, Excel (max 10MB)"})]})]})]})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[(0,b.jsx)(k.Button,{variant:"ghost",onClick:()=>{S(!1),ag({title:"",type:"other",studentId:"",file:null})},children:"Annuler"}),(0,b.jsx)(k.Button,{onClick:as,disabled:T||!af.file||!af.title,className:"shadow-lg shadow-brand-blue/20",children:T?"Upload en cours...":"Uploader"})]})]})]})})}),(0,b.jsx)(J.AnimatePresence,{children:Z&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,b.jsxs)(I.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"w-full max-w-2xl bg-white rounded-2xl shadow-2xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 bg-blue-50 rounded-lg",children:(0,b.jsx)(D.Mail,{className:"h-5 w-5 text-blue-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Envoyer par email"}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:_?.title})]})]}),(0,b.jsx)(k.Button,{variant:"ghost",size:"icon",onClick:()=>{$(!1),aa(null),ac({to:"",subject:"",message:""})},children:(0,b.jsx)(s.X,{className:"h-5 w-5"})})]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Destinataire *"}),(0,b.jsx)("input",{type:"email",value:ab.to,onChange:a=>ac(b=>({...b,to:a.target.value})),className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",placeholder:"email@example.com"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Objet *"}),(0,b.jsx)("input",{type:"text",value:ab.subject,onChange:a=>ac(b=>({...b,subject:a.target.value})),className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",placeholder:"Objet de l'email"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Message"}),(0,b.jsx)("textarea",{value:ab.message,onChange:a=>ac(b=>({...b,message:a.target.value})),rows:6,className:"w-full px-4 py-2.5 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all resize-none",placeholder:"Votre message..."})]}),_?.file_url&&(0,b.jsx)("div",{className:"p-4 bg-gray-50 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(p.FileText,{className:"h-5 w-5 text-gray-400"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Pièce jointe"}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:_.title})]})]})}),(0,b.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100",children:[(0,b.jsx)(k.Button,{variant:"ghost",onClick:()=>{$(!1),aa(null),ac({to:"",subject:"",message:""})},children:"Annuler"}),(0,b.jsx)(k.Button,{onClick:at,disabled:ad||!ab.to||!ab.subject,className:"bg-blue-600 hover:bg-blue-700 shadow-lg shadow-blue-600/20",children:ad?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"animate-spin mr-2",children:"⏳"}),"Envoi en cours..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(D.Mail,{className:"mr-2 h-4 w-4"}),"Envoyer"]})})]})]})]})})}),(0,b.jsx)(J.AnimatePresence,{children:V&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,b.jsxs)(I.motion.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"w-full max-w-5xl h-[90vh] bg-white rounded-2xl shadow-2xl overflow-hidden flex flex-col",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between bg-gray-50/50",children:[(0,b.jsx)("h3",{className:"font-bold text-gray-900",children:V.title}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[V.file_url&&(0,b.jsx)("a",{href:V.file_url,target:"_blank",rel:"noopener noreferrer",download:!0,children:(0,b.jsxs)(k.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(q.Download,{className:"mr-2 h-4 w-4"}),"Télécharger"]})}),(0,b.jsx)(k.Button,{variant:"ghost",size:"icon",onClick:()=>W(null),children:(0,b.jsx)(s.X,{className:"h-5 w-5"})})]})]}),(0,b.jsx)("div",{className:"flex-1 bg-gray-100 p-4 overflow-auto flex items-center justify-center",children:V.file_url&&(0,b.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:V.file_url.toLowerCase().endsWith(".pdf")?(0,b.jsx)("iframe",{src:V.file_url,className:"w-full h-full rounded-lg shadow-lg bg-white",title:"Prévisualisation PDF"}):["jpg","jpeg","png","gif","webp"].some(a=>V.file_url?.toLowerCase().endsWith(`.${a}`))?(0,b.jsx)("img",{src:V.file_url,alt:V.title,className:"max-w-full max-h-full rounded-lg shadow-lg object-contain"}):(0,b.jsxs)("div",{className:"text-center p-12 bg-white rounded-2xl shadow-sm max-w-md",children:[(0,b.jsx)("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,b.jsx)(v.File,{className:"h-10 w-10 text-gray-400"})}),(0,b.jsx)("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:"Aperçu non disponible"}),(0,b.jsx)("p",{className:"text-gray-500 mb-6",children:"Ce type de fichier ne peut pas être prévisualisé directement."}),(0,b.jsx)("a",{href:V.file_url,target:"_blank",rel:"noopener noreferrer",download:!0,children:(0,b.jsxs)(k.Button,{className:"shadow-lg shadow-brand-blue/20",children:[(0,b.jsx)(q.Download,{className:"mr-2 h-4 w-4"}),"Télécharger pour voir"]})})]})})})]})})})]})}a.s(["default",()=>L],524830)}];

//# sourceMappingURL=app_%28dashboard%29_dashboard_documents_page_tsx_149109c6._.js.map