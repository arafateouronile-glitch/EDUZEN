{"version":3,"sources":["../../../../app/%28learner%29/learner/elearning/%5Bslug%5D/page.tsx","../../../../node_modules/lucide-react/src/icons/list-checks.ts"],"sourcesContent":["'use client'\n\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { useLearnerContext } from '@/lib/contexts/learner-context'\nimport { createLearnerClient } from '@/lib/supabase/learner-client'\nimport { GlassCard } from '@/components/ui/glass-card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { useToast } from '@/components/ui/toast'\nimport { motion, AnimatePresence } from '@/components/ui/motion'\nimport {\n  PlayCircle,\n  BookOpen,\n  Clock,\n  CheckCircle2,\n  ChevronLeft,\n  ChevronRight,\n  Play,\n  Pause,\n  Lock,\n  Award,\n  FileText,\n  Video,\n  Image as ImageIcon,\n  ListChecks,\n  ArrowLeft,\n  Download,\n  Share2,\n  RotateCcw,\n} from 'lucide-react'\nimport Link from 'next/link'\nimport { useParams, useRouter } from 'next/navigation'\nimport { useMemo, useState, useEffect, useRef } from 'react'\nimport ReactMarkdown from 'react-markdown'\nimport { logger, maskId, sanitizeError } from '@/lib/utils/logger'\n\nexport default function LearnerCourseDetailPage() {\n  const params = useParams()\n  const router = useRouter()\n  const slug = params.slug as string\n  const { student: studentData, studentId } = useLearnerContext()\n  const supabase = useMemo(() => (studentId ? createLearnerClient(studentId) : null), [studentId])\n  const queryClient = useQueryClient()\n  const { addToast } = useToast()\n  \n  const [currentLessonIndex, setCurrentLessonIndex] = useState(0)\n  const [isPlaying, setIsPlaying] = useState(false)\n  const videoRef = useRef<HTMLVideoElement>(null)\n\n  // Réponses aux quiz intégrés dans le contenu des leçons (blocs \"quiz\")\n  // Format: { [lessonId]: { [blockId]: selectedOptionIdOrText } }\n  const [inlineQuizAnswers, setInlineQuizAnswers] = useState<Record<string, Record<string, string>>>({})\n\n  const inlineQuizStorageKey = useMemo(() => {\n    if (!studentId) return null\n    return `eduzen.inlineQuizAnswers.${studentId}`\n  }, [studentId])\n\n  const loadInlineAnswersFromStorage = (lessonId: string) => {\n    if (!inlineQuizStorageKey) return null\n    try {\n      const raw = localStorage.getItem(inlineQuizStorageKey)\n      if (!raw) return null\n      const parsed = JSON.parse(raw)\n      const lessonAnswers = parsed?.[lessonId]\n      if (lessonAnswers && typeof lessonAnswers === 'object') return lessonAnswers as Record<string, string>\n      return null\n    } catch {\n      return null\n    }\n  }\n\n  const saveInlineAnswersToStorage = (lessonId: string, lessonAnswers: Record<string, string>) => {\n    if (!inlineQuizStorageKey) return\n    try {\n      const raw = localStorage.getItem(inlineQuizStorageKey)\n      const parsed = raw ? JSON.parse(raw) : {}\n      const next = { ...(parsed || {}), [lessonId]: lessonAnswers }\n      localStorage.setItem(inlineQuizStorageKey, JSON.stringify(next))\n    } catch {\n      // ignore\n    }\n  }\n\n  // Récupérer le cours\n  const { data: course, isLoading: loadingCourse, refetch: refetchCourse } = useQuery({\n    queryKey: ['learner-course', slug],\n    queryFn: async () => {\n      try {\n        if (!supabase) return null\n        const { data, error } = await supabase\n          .from('courses')\n          .select(`\n            *,\n            course_sections(\n              id,\n              title,\n              description,\n              order_index,\n              lessons(\n                id,\n                title,\n                description,\n                content,\n                lesson_type,\n                video_duration_minutes,\n                order_index,\n                video_url,\n                is_preview,\n                quizzes(id)\n              )\n            )\n          `)\n          .eq('slug', slug)\n          .maybeSingle()\n        \n        if (error) {\n          // Si la table n'existe pas encore ou erreur 400, retourner null\n          if (\n            error.code === 'PGRST116' ||\n            error.code === '42P01' ||\n            error.code === 'PGRST301' ||\n            (error as any).status === 400 ||\n            error.code === '400' ||\n            error.message?.includes('relation') ||\n            error.message?.includes('relationship') ||\n            error.message?.includes('does not exist') ||\n            error.message?.includes('schema cache')\n          ) {\n            logger.warn('Course table or relations do not exist yet or invalid query', {\n              slug: slug,\n              error: sanitizeError(error),\n            })\n            return null\n          }\n          throw error\n        }\n        return data\n      } catch (error: any) {\n        // Gérer les erreurs de table inexistante ou erreurs 400\n        if (\n          error?.code === 'PGRST116' ||\n          error?.code === '42P01' ||\n          error?.code === 'PGRST301' ||\n          error?.status === 400 ||\n          error?.code === '400' ||\n          error?.message?.includes('relation') ||\n          error?.message?.includes('relationship') ||\n          error?.message?.includes('does not exist') ||\n          error?.message?.includes('schema cache')\n        ) {\n          logger.warn('Course table or relations do not exist yet or invalid query', {\n            slug: slug,\n            error: sanitizeError(error),\n          })\n          return null\n        }\n        throw error\n      }\n    },\n    enabled: !!slug && !!supabase,\n  })\n\n  const scoresEnabled = (course as any)?.scores_enabled !== false\n\n  // Récupérer l'inscription de l'étudiant\n  // Table course_enrollments n'existe pas\n  const enrollment = null\n\n  // Récupérer la progression des leçons\n  const { data: lessonProgress } = useQuery({\n    queryKey: ['learner-lesson-progress', course?.id, studentId],\n    queryFn: async () => {\n      if (!course?.id || !studentId || !supabase) return {}\n      \n      const { data } = await supabase\n        .from('lesson_progress')\n        .select('*')\n        .eq('student_id', studentId)\n      \n      const progressMap: Record<string, any> = {}\n      data?.forEach((p: any) => {\n        progressMap[p.lesson_id] = p\n      })\n      \n      return progressMap\n    },\n    enabled: !!course?.id && !!studentId && !!supabase,\n  })\n\n  // Fallback: si les sections ne sont pas visibles (RLS course_sections pas appliquée),\n  // on charge les leçons directement via `lessons` pour permettre au candidat de démarrer.\n  const { data: lessonsFallback } = useQuery({\n    queryKey: ['learner-course-lessons-fallback', course?.id],\n    queryFn: async () => {\n      if (!supabase || !course?.id) return []\n      if (course?.course_sections?.length) return [] // inutile si on a déjà sections+lessons\n\n      const { data, error } = await supabase\n        .from('lessons')\n        .select(\n          `\n          id,\n          title,\n          description,\n          content,\n          lesson_type,\n          video_duration_minutes,\n          order_index,\n          video_url,\n          is_preview,\n          course_id,\n          section_id,\n          section:course_sections(title),\n          quizzes(id)\n        `\n        )\n        .eq('course_id', course.id)\n        .order('order_index', { ascending: true })\n\n      if (error) {\n        logger.warn('Error fetching lessons fallback', {\n          courseId: maskId(course.id),\n          error: sanitizeError(error),\n        })\n        return []\n      }\n\n      return data || []\n    },\n    enabled: !!supabase && !!course?.id,\n  })\n\n  // Organiser les leçons\n  const allLessons =\n    course?.course_sections?.length\n      ? course.course_sections\n          ?.sort((a: any, b: any) => a.order_index - b.order_index)\n          .flatMap((section: any) =>\n            (section.lessons || [])\n              .sort((a: any, b: any) => a.order_index - b.order_index)\n              .map((lesson: any) => ({ ...lesson, sectionTitle: section.title }))\n          ) || []\n      : (lessonsFallback || []).map((lesson: any) => ({\n          ...lesson,\n          sectionTitle: lesson?.section?.title || 'Sans section',\n        }))\n\n  const currentLesson = allLessons[currentLessonIndex]\n  const totalLessons = allLessons.length\n  const completedLessons = Object.values(lessonProgress || {}).filter((p: any) => p.is_completed).length\n  const progressPercentage = totalLessons > 0 ? Math.round((completedLessons / totalLessons) * 100) : 0\n\n  // Recharger les réponses des quiz inline depuis localStorage à chaque changement de leçon\n  useEffect(() => {\n    if (!currentLesson?.id) return\n    const stored = loadInlineAnswersFromStorage(currentLesson.id)\n    if (!stored) return\n    setInlineQuizAnswers((prev) => {\n      if (prev[currentLesson.id] && Object.keys(prev[currentLesson.id]).length > 0) return prev\n      return { ...prev, [currentLesson.id]: stored }\n    })\n  }, [currentLesson?.id, inlineQuizStorageKey])\n\n  // Si le nombre de leçons change (RLS/migrations), s'assurer que l'index reste valide\n  useEffect(() => {\n    if (currentLessonIndex > 0 && currentLessonIndex >= totalLessons) {\n      setCurrentLessonIndex(0)\n    }\n  }, [currentLessonIndex, totalLessons])\n\n  // Mutation pour marquer une leçon comme terminée\n  const completeLessonMutation = useMutation({\n    mutationFn: async (lessonId: string) => {\n      if (!studentId || !supabase) throw new Error('Student not found')\n      \n      // IMPORTANT:\n      // On évite `upsert/on_conflict` (409 selon l'état des contraintes/index).\n      // Flow robuste: SELECT -> UPDATE si existe, sinon INSERT. Et si INSERT renvoie 409 (race), on UPDATE.\n      const nowIso = new Date().toISOString()\n      const payloadInsert = {\n        student_id: studentId,\n        lesson_id: lessonId,\n        is_completed: true,\n        completed_at: nowIso,\n        completion_percentage: 100,\n      }\n\n      const payloadUpdate = {\n        is_completed: true,\n        completed_at: nowIso,\n        completion_percentage: 100,\n      }\n\n      const { data: existing, error: existingError } = await supabase\n        .from('lesson_progress')\n        .select('id')\n        .eq('lesson_id', lessonId)\n        .eq('student_id', studentId)\n        .maybeSingle()\n\n      if (existingError && existingError.code !== 'PGRST116') {\n        // PGRST116 = no rows\n        throw existingError\n      }\n\n      if (existing?.id) {\n        const { error: updateError } = await supabase\n          .from('lesson_progress')\n          .update(payloadUpdate)\n          .eq('id', existing.id)\n        if (updateError) throw updateError\n      } else {\n        const { error: insertError } = await supabase\n          .from('lesson_progress')\n          .insert(payloadInsert)\n\n        if (insertError) {\n          // Si conflit (ligne créée en parallèle), on retente en update.\n          if (insertError.code === '23505' || insertError.message?.toLowerCase().includes('duplicate') || insertError.message?.toLowerCase().includes('conflict')) {\n            const { error: updateError } = await supabase\n              .from('lesson_progress')\n              .update(payloadUpdate)\n              .eq('lesson_id', lessonId)\n              .eq('student_id', studentId)\n            if (updateError) throw updateError\n          } else {\n            throw insertError\n          }\n        }\n      }\n      \n      // Mettre à jour la progression globale du cours\n      const newCompletedCount = completedLessons + 1\n      const newProgress = Math.round((newCompletedCount / totalLessons) * 100)\n      \n      // Table course_enrollments n'existe pas - désactivé pour l'instant\n      // TODO: Implémenter la sauvegarde de progression quand la table sera disponible\n      /*\n      await supabase\n        // Table course_enrollments n'existe pas - désactivé\n        // .from('course_enrollments')\n        .update({\n          progress_percentage: newProgress,\n          status: newProgress >= 100 ? 'completed' : 'in_progress',\n          completed_at: newProgress >= 100 ? new Date().toISOString() : null,\n        })\n        .eq('course_id', course?.id)\n        .eq('student_id', studentData.id)\n      */\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['learner-lesson-progress'] })\n      queryClient.invalidateQueries({ queryKey: ['learner-course-enrollment'] })\n      addToast({\n        type: 'success',\n        title: 'Leçon terminée !',\n        description: 'Votre progression a été enregistrée.',\n      })\n    },\n    onError: (error: any) => {\n      const msg = error?.message || ''\n      addToast({\n        type: 'error',\n        title: 'Impossible d’enregistrer',\n        description:\n          msg.includes('401') || msg.toLowerCase().includes('unauthorized')\n            ? \"Accès non autorisé (RLS). Applique la migration '20251217000014_learner_write_lesson_progress.sql' puis réessaie.\"\n            : msg.includes('409') || msg.toLowerCase().includes('conflict')\n            ? \"Conflit (409). Très souvent: la FK de `lesson_progress.student_id` pointe vers `auth.users` au lieu de `public.students`. Applique '20251217000016_fix_lesson_progress_student_fk.sql' (et éventuellement '20251217000015_lesson_progress_unique_index.sql'), puis réessaie.\"\n            : 'Une erreur est survenue lors de l’enregistrement de votre progression.',\n      })\n    },\n  })\n\n  const handleNextLesson = () => {\n    if (currentLessonIndex < totalLessons - 1) {\n      setCurrentLessonIndex(currentLessonIndex + 1)\n    }\n  }\n\n  const handlePrevLesson = () => {\n    if (currentLessonIndex > 0) {\n      setCurrentLessonIndex(currentLessonIndex - 1)\n    }\n  }\n\n  const handleCompleteLesson = () => {\n    if (currentLesson) {\n      completeLessonMutation.mutate(currentLesson.id)\n    }\n  }\n\n  const getLessonIcon = (type: string) => {\n    switch (type) {\n      case 'video': return <Video className=\"h-4 w-4\" />\n      case 'quiz': return <ListChecks className=\"h-4 w-4\" />\n      case 'text': return <FileText className=\"h-4 w-4\" />\n      case 'image': return <ImageIcon className=\"h-4 w-4\" />\n      default: return <BookOpen className=\"h-4 w-4\" />\n    }\n  }\n\n  const isLessonCompleted = (lessonId: string) => {\n    return lessonProgress?.[lessonId]?.is_completed\n  }\n\n  const renderLessonContent = (content?: string | null, lessonId?: string) => {\n    if (!content) return null\n\n    try {\n      const parsed = JSON.parse(content)\n      if (Array.isArray(parsed)) {\n        return (\n          <div className=\"space-y-4\">\n            {parsed.map((block: any, idx: number) => {\n              if (!block?.type) return null\n\n              if (block.type === 'text') {\n                return (\n                  <div key={block.id || idx} className=\"prose prose-sm max-w-none\">\n                    <ReactMarkdown>{block?.data?.content || ''}</ReactMarkdown>\n                  </div>\n                )\n              }\n\n              if (block.type === 'media') {\n                const mediaType = block?.data?.mediaType\n                const url = block?.data?.mediaUrl\n                const caption = block?.data?.caption\n                if (!url) return null\n\n                if (mediaType === 'image') {\n                  return (\n                    <div key={block.id || idx} className=\"space-y-2\">\n                      <img src={url} alt={caption || 'Image'} className=\"w-full rounded-lg border border-gray-200\" />\n                      {caption ? <p className=\"text-sm text-gray-500 text-center italic\">{caption}</p> : null}\n                    </div>\n                  )\n                }\n\n                if (mediaType === 'video') {\n                  return (\n                    <div key={block.id || idx} className=\"space-y-2\">\n                      <video src={url} controls className=\"w-full rounded-lg\" />\n                      {caption ? <p className=\"text-sm text-gray-500 text-center italic\">{caption}</p> : null}\n                    </div>\n                  )\n                }\n\n                if (mediaType === 'audio') {\n                  return (\n                    <div key={block.id || idx} className=\"space-y-2\">\n                      <audio src={url} controls className=\"w-full\" />\n                      {caption ? <p className=\"text-sm text-gray-500 text-center italic\">{caption}</p> : null}\n                    </div>\n                  )\n                }\n\n                // file\n                return (\n                  <div key={block.id || idx} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                    <span className=\"text-sm font-medium\">{caption || 'Fichier'}</span>\n                    <a href={url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-sm text-brand-blue hover:underline\">\n                      Télécharger\n                    </a>\n                  </div>\n                )\n              }\n\n              if (block.type === 'quiz') {\n                const blockId = String(block?.id || `quiz-${idx}`)\n                const selected =\n                  (lessonId && inlineQuizAnswers?.[lessonId]?.[blockId]) || ''\n\n                const options = (block?.data?.options || []).map((opt: any, optIdx: number) => ({\n                  id: String(opt?.id || `${blockId}-opt-${optIdx}`),\n                  text: String(opt?.text || ''),\n                  isCorrect: !!opt?.isCorrect,\n                }))\n\n                const correctOptions = options.filter((o: any) => o.isCorrect)\n                const selectedOption = options.find((o: any) => (o.id || o.text) === selected)\n                const isAnswered = !!selected\n                const isGraded = correctOptions.length > 0\n                const isCorrect = isAnswered && isGraded ? !!selectedOption?.isCorrect : false\n\n                return (\n                  <div key={block.id || idx} className=\"p-4 border rounded-lg bg-white\">\n                    <div className=\"flex items-center justify-between gap-3 mb-2\">\n                      <h4 className=\"font-semibold text-gray-900\">\n                        {scoresEnabled && isGraded ? 'Quiz (noté)' : 'Quiz'}\n                      </h4>\n                      {scoresEnabled && isGraded && (\n                        <Badge className={isAnswered ? (isCorrect ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700') : 'bg-gray-100 text-gray-700'}>\n                          {isAnswered ? (isCorrect ? '1/1' : '0/1') : '0/1'}\n                        </Badge>\n                      )}\n                    </div>\n                    <p className=\"text-sm text-gray-700 mb-3\">{block?.data?.question || ''}</p>\n\n                    <div className=\"space-y-2\">\n                      {options.map((opt: any) => {\n                        const value = opt.id || opt.text\n                        const isSelected = selected === value\n                        const isLocked = !!selected\n\n                        return (\n                          <button\n                            key={value}\n                            type=\"button\"\n                            onClick={(e) => {\n                              e.preventDefault()\n                              e.stopPropagation()\n                              if (!lessonId) return\n                              if (isLocked) return\n                              setInlineQuizAnswers((prev) => {\n                                const nextLessonAnswers = {\n                                  ...(prev[lessonId] || {}),\n                                  [blockId]: value,\n                                }\n                                // Persistance immédiate: ne disparaît pas au refresh\n                                saveInlineAnswersToStorage(lessonId, nextLessonAnswers)\n                                return { ...prev, [lessonId]: nextLessonAnswers }\n                              })\n                            }}\n                            disabled={isLocked}\n                            className={`w-full text-left border rounded-md px-3 py-2 text-sm transition-colors ${\n                              isSelected\n                                ? 'border-brand-blue bg-brand-blue/10 text-gray-900'\n                                : 'border-gray-200 hover:bg-gray-50 text-gray-700'\n                            }`}\n                          >\n                            {opt.text}\n                          </button>\n                        )\n                      })}\n                    </div>\n\n                    {/* Feedback si noté */}\n                    {scoresEnabled && isAnswered && isGraded && (\n                      <div className=\"mt-3 text-sm\">\n                        {isCorrect ? (\n                          <p className=\"text-green-700 font-medium\">Bonne réponse (+1)</p>\n                        ) : (\n                          <p className=\"text-red-700 font-medium\">Mauvaise réponse (0)</p>\n                        )}\n                      </div>\n                    )}\n\n                    {selected && (\n                      <p className=\"mt-2 text-xs text-gray-500\">\n                        Réponse verrouillée (vous ne pouvez plus la modifier).\n                      </p>\n                    )}\n                  </div>\n                )\n              }\n\n              if (block.type === 'poll') {\n                return (\n                  <div key={block.id || idx} className=\"p-4 border rounded-lg bg-white\">\n                    <h4 className=\"font-semibold text-gray-900 mb-2\">Sondage</h4>\n                    <p className=\"text-sm text-gray-700 mb-3\">{block?.data?.pollQuestion || ''}</p>\n                    <ul className=\"space-y-2\">\n                      {(block?.data?.pollOptions || []).map((opt: any) => (\n                        <li key={opt.id} className=\"text-sm text-gray-600 border rounded-md px-3 py-2\">\n                          {opt.text}\n                        </li>\n                      ))}\n                    </ul>\n                  </div>\n                )\n              }\n\n              return null\n            })}\n          </div>\n        )\n      }\n    } catch {\n      // Not JSON\n    }\n\n    return (\n      <div className=\"prose prose-sm max-w-none mt-6 pt-6 border-t\">\n        <ReactMarkdown>{content}</ReactMarkdown>\n      </div>\n    )\n  }\n\n  // Score global des quiz \"inline\" de la leçon courante (si des bonnes réponses existent).\n  const inlineLessonScore = useMemo(() => {\n    if (!currentLesson?.id || !currentLesson?.content) {\n      return { total: 0, answered: 0, correct: 0, percentage: 0, graded: false }\n    }\n\n    try {\n      const parsed = JSON.parse(currentLesson.content)\n      if (!Array.isArray(parsed)) return { total: 0, answered: 0, correct: 0, percentage: 0, graded: false }\n\n      const quizBlocks = parsed.filter((b: any) => b?.type === 'quiz')\n      if (!quizBlocks.length) return { total: 0, answered: 0, correct: 0, percentage: 0, graded: false }\n\n      const lessonAnswers = inlineQuizAnswers?.[currentLesson.id] || {}\n\n      let total = 0\n      let answered = 0\n      let correct = 0\n\n      for (let i = 0; i < quizBlocks.length; i++) {\n        const block = quizBlocks[i]\n        const blockId = String(block?.id || `quiz-${i}`)\n        const selected = lessonAnswers[blockId]\n        if (selected) answered += 1\n\n        const options = (block?.data?.options || []).map((opt: any, optIdx: number) => ({\n          id: String(opt?.id || `${blockId}-opt-${optIdx}`),\n          text: String(opt?.text || ''),\n          isCorrect: !!opt?.isCorrect,\n        }))\n\n        const correctOptions = options.filter((o: any) => o.isCorrect)\n        if (!correctOptions.length) {\n          // pas de correction => non noté\n          continue\n        }\n\n        total += 1\n        const selectedOption = options.find((o: any) => (o.id || o.text) === selected)\n        if (selected && selectedOption?.isCorrect) correct += 1\n      }\n\n      const graded = total > 0\n      const percentage = graded ? Math.round((correct / total) * 100) : 0\n      return { total, answered, correct, percentage, graded }\n    } catch {\n      return { total: 0, answered: 0, correct: 0, percentage: 0, graded: false }\n    }\n  }, [currentLesson?.id, currentLesson?.content, inlineQuizAnswers])\n\n  if (loadingCourse) {\n    return (\n      <div className=\"space-y-6 pb-24 lg:pb-8\">\n        <div className=\"h-12 w-48 bg-gray-100 rounded-lg animate-pulse\" />\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          <div className=\"lg:col-span-2 h-96 bg-gray-100 rounded-2xl animate-pulse\" />\n          <div className=\"h-96 bg-gray-100 rounded-2xl animate-pulse\" />\n        </div>\n      </div>\n    )\n  }\n\n  if (!course) {\n    return (\n      <div className=\"text-center py-12\">\n        <BookOpen className=\"h-16 w-16 text-gray-300 mx-auto mb-4\" />\n        <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">Cours introuvable</h2>\n        <Link href=\"/learner/elearning\">\n          <Button variant=\"outline\">\n            <ArrowLeft className=\"h-4 w-4 mr-2\" />\n            Retour aux cours\n          </Button>\n        </Link>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-6 pb-24 lg:pb-8\">\n      {/* Header */}\n      <div className=\"flex items-center gap-4\">\n        <Link href=\"/learner/elearning\">\n          <Button variant=\"ghost\" size=\"icon\">\n            <ArrowLeft className=\"h-5 w-5\" />\n          </Button>\n        </Link>\n        <div className=\"flex-1\">\n          <h1 className=\"text-xl md:text-2xl font-bold text-gray-900 line-clamp-1\">\n            {course.title}\n          </h1>\n          <div className=\"flex items-center gap-4 text-sm text-gray-500 mt-1\">\n            <span>{progressPercentage}% complété</span>\n            <span>•</span>\n            <span>{completedLessons}/{totalLessons} leçons</span>\n          </div>\n        </div>\n        {progressPercentage >= 100 && (\n          <Badge className=\"bg-green-100 text-green-700\">\n            <Award className=\"h-3 w-3 mr-1\" />\n            Terminé\n          </Badge>\n        )}\n      </div>\n\n      {/* Progress bar */}\n      <div className=\"w-full h-2 bg-gray-100 rounded-full overflow-hidden\">\n        <motion.div\n          className=\"h-full bg-gradient-to-r from-brand-blue to-indigo-500\"\n          initial={{ width: 0 }}\n          animate={{ width: `${progressPercentage}%` }}\n          transition={{ duration: 0.5 }}\n        />\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Contenu principal */}\n        <div className=\"lg:col-span-2 space-y-4\">\n          {currentLesson && (\n            <GlassCard className=\"overflow-hidden\">\n              {/* Video/Content Area */}\n              <div className=\"relative aspect-video bg-gray-900\">\n                {currentLesson.video_url ? (\n                  <video\n                    ref={videoRef}\n                    src={currentLesson.video_url}\n                    className=\"w-full h-full object-contain\"\n                    controls\n                    onEnded={handleCompleteLesson}\n                  />\n                ) : currentLesson.lesson_type === 'quiz' ? (\n                  <div className=\"absolute inset-0 flex flex-col items-center justify-center text-white\">\n                    <ListChecks className=\"h-16 w-16 mb-4 text-brand-blue\" />\n                    <h3 className=\"text-xl font-semibold mb-2\">Quiz interactif</h3>\n                    <p className=\"text-gray-400 mb-4\">Testez vos connaissances</p>\n                    <Link\n                      href={`/learner/evaluations/${currentLesson?.quizzes?.[0]?.id || currentLesson.id}`}\n                    >\n                      <Button>\n                        <Play className=\"h-4 w-4 mr-2\" />\n                        Commencer le quiz\n                      </Button>\n                    </Link>\n                  </div>\n                ) : (\n                  <div className=\"absolute inset-0 flex items-center justify-center\">\n                    <div className=\"text-center text-white\">\n                      <BookOpen className=\"h-16 w-16 mx-auto mb-4 text-brand-blue\" />\n                      <p className=\"text-gray-400\">Contenu textuel ci-dessous</p>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Lesson Info */}\n              <div className=\"p-6\">\n                <div className=\"flex items-start justify-between gap-4 mb-4\">\n                  <div>\n                    <p className=\"text-sm text-brand-blue font-medium mb-1\">\n                      {currentLesson.sectionTitle}\n                    </p>\n                    <h2 className=\"text-xl font-bold text-gray-900\">\n                      {currentLesson.title}\n                    </h2>\n                    {scoresEnabled && inlineLessonScore.graded && (\n                      <div className=\"mt-2\">\n                        <Badge className=\"bg-indigo-100 text-indigo-700\">\n                          Score quiz: {inlineLessonScore.correct}/{inlineLessonScore.total} ({inlineLessonScore.percentage}%)\n                        </Badge>\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    {currentLesson.video_duration_minutes && (\n                      <Badge variant=\"outline\">\n                        <Clock className=\"h-3 w-3 mr-1\" />\n                        {currentLesson.video_duration_minutes} min\n                      </Badge>\n                    )}\n                    {isLessonCompleted(currentLesson.id) && (\n                      <Badge className=\"bg-green-100 text-green-700\">\n                        <CheckCircle2 className=\"h-3 w-3 mr-1\" />\n                        Terminé\n                      </Badge>\n                    )}\n                  </div>\n                </div>\n\n                {currentLesson.description && (\n                  <p className=\"text-gray-600 mb-4\">{currentLesson.description}</p>\n                )}\n\n                {/* Contenu de la leçon */}\n                {renderLessonContent(currentLesson.content, currentLesson.id)}\n\n                {/* Navigation */}\n                <div className=\"flex items-center justify-between mt-6 pt-6 border-t\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={handlePrevLesson}\n                    disabled={currentLessonIndex === 0}\n                  >\n                    <ChevronLeft className=\"h-4 w-4 mr-2\" />\n                    Précédent\n                  </Button>\n\n                  {!isLessonCompleted(currentLesson.id) && (\n                    <Button\n                      onClick={handleCompleteLesson}\n                      disabled={completeLessonMutation.isPending}\n                      className=\"bg-green-600 hover:bg-green-700\"\n                    >\n                      <CheckCircle2 className=\"h-4 w-4 mr-2\" />\n                      Marquer comme terminé\n                    </Button>\n                  )}\n\n                  <Button\n                    onClick={handleNextLesson}\n                    disabled={currentLessonIndex >= totalLessons - 1}\n                  >\n                    Suivant\n                    <ChevronRight className=\"h-4 w-4 ml-2\" />\n                  </Button>\n                </div>\n              </div>\n            </GlassCard>\n          )}\n\n          {!currentLesson && (\n            <GlassCard className=\"p-6 border border-amber-200 bg-amber-50/40\">\n              <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">Impossible de démarrer le cours</h3>\n              <p className=\"text-sm text-gray-700 mb-4\">\n                Ce cours ne contient pas encore de leçons, ou l’accès aux sections/leçons n’est pas encore autorisé.\n              </p>\n              <div className=\"flex gap-3\">\n                <Button\n                  onClick={() => refetchCourse()}\n                  className=\"bg-brand-blue hover:bg-brand-blue/90\"\n                >\n                  Réessayer\n                </Button>\n                <Link href=\"/learner/elearning\">\n                  <Button variant=\"outline\">Retour aux cours</Button>\n                </Link>\n              </div>\n            </GlassCard>\n          )}\n        </div>\n\n        {/* Sidebar - Liste des leçons */}\n        <div className=\"space-y-4\">\n          <GlassCard className=\"p-4\">\n            <h3 className=\"font-bold text-gray-900 mb-4\">Contenu du cours</h3>\n            <div className=\"space-y-2 max-h-[600px] overflow-y-auto pr-2\">\n              {course.course_sections?.length ? course.course_sections\n                ?.sort((a: any, b: any) => a.order_index - b.order_index)\n                .map((section: any) => (\n                  <div key={section.id} className=\"mb-4\">\n                    <h4 className=\"text-sm font-semibold text-gray-700 mb-2 px-2\">\n                      {section.title}\n                    </h4>\n                    <div className=\"space-y-1\">\n                      {section.lessons\n                        .sort((a: any, b: any) => a.order_index - b.order_index)\n                        .map((lesson: any, idx: number) => {\n                          const globalIndex = allLessons.findIndex((l: any) => l.id === lesson.id)\n                          const isActive = globalIndex === currentLessonIndex\n                          const isComplete = isLessonCompleted(lesson.id)\n                          \n                          return (\n                            <button\n                              key={lesson.id}\n                              onClick={() => setCurrentLessonIndex(globalIndex)}\n                              className={`w-full flex items-center gap-3 p-3 rounded-xl text-left transition-all ${\n                                isActive\n                                  ? 'bg-brand-blue text-white shadow-lg'\n                                  : isComplete\n                                  ? 'bg-green-50 text-gray-700 hover:bg-green-100'\n                                  : 'hover:bg-gray-50 text-gray-600'\n                              }`}\n                            >\n                              <div className={`p-1.5 rounded-lg ${\n                                isActive ? 'bg-white/20' : isComplete ? 'bg-green-100' : 'bg-gray-100'\n                              }`}>\n                                {isComplete ? (\n                                  <CheckCircle2 className={`h-4 w-4 ${isActive ? 'text-white' : 'text-green-600'}`} />\n                                ) : (\n                                  getLessonIcon(lesson.lesson_type)\n                                )}\n                              </div>\n                              <div className=\"flex-1 min-w-0\">\n                                <p className={`text-sm font-medium truncate ${\n                                  isActive ? 'text-white' : ''\n                                }`}>\n                                  {lesson.title}\n                                </p>\n                                {lesson.video_duration_minutes && (\n                                  <p className={`text-xs ${\n                                    isActive ? 'text-white/70' : 'text-gray-400'\n                                  }`}>\n                                  {lesson.video_duration_minutes} min\n                                  </p>\n                                )}\n                              </div>\n                              {isActive && (\n                                <PlayCircle className=\"h-5 w-5 text-white\" />\n                              )}\n                            </button>\n                          )\n                        })}\n                    </div>\n                  </div>\n                )) : allLessons.length ? (\n                  <div className=\"mb-4\">\n                    <h4 className=\"text-sm font-semibold text-gray-700 mb-2 px-2\">Leçons</h4>\n                    <div className=\"space-y-1\">\n                      {allLessons.map((lesson: any) => {\n                        const globalIndex = allLessons.findIndex((l: any) => l.id === lesson.id)\n                        const isActive = globalIndex === currentLessonIndex\n                        const isComplete = isLessonCompleted(lesson.id)\n\n                        return (\n                          <button\n                            key={lesson.id}\n                            onClick={() => setCurrentLessonIndex(globalIndex)}\n                            className={`w-full flex items-center gap-3 p-3 rounded-xl text-left transition-all ${\n                              isActive\n                                ? 'bg-brand-blue text-white shadow-lg'\n                                : isComplete\n                                ? 'bg-green-50 text-gray-700 hover:bg-green-100'\n                                : 'hover:bg-gray-50 text-gray-600'\n                            }`}\n                          >\n                            <div\n                              className={`p-1.5 rounded-lg ${\n                                isActive ? 'bg-white/20' : isComplete ? 'bg-green-100' : 'bg-gray-100'\n                              }`}\n                            >\n                              {isComplete ? (\n                                <CheckCircle2 className={`h-4 w-4 ${isActive ? 'text-white' : 'text-green-600'}`} />\n                              ) : (\n                                getLessonIcon(lesson.lesson_type)\n                              )}\n                            </div>\n                            <div className=\"flex-1 min-w-0\">\n                              <p className={`text-sm font-medium truncate ${isActive ? 'text-white' : ''}`}>\n                                {lesson.title}\n                              </p>\n                              {lesson.video_duration_minutes && (\n                                <p className={`text-xs ${isActive ? 'text-white/70' : 'text-gray-400'}`}>\n                                  {lesson.video_duration_minutes} min\n                                </p>\n                              )}\n                            </div>\n                            {isActive && <PlayCircle className=\"h-5 w-5 text-white\" />}\n                          </button>\n                        )\n                      })}\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"text-sm text-gray-600 p-3 bg-gray-50 rounded-lg border\">\n                    Aucune section/leçon visible pour le moment. Si le cours est bien assigné, applique la migration RLS\n                    pour `course_sections` puis réessaye.\n                  </div>\n                )}\n            </div>\n          </GlassCard>\n\n          {/* Certificate */}\n          {progressPercentage >= 100 && (\n            <GlassCard className=\"p-4 bg-gradient-to-br from-amber-50 to-amber-100/50 border-amber-200\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 bg-amber-100 rounded-xl\">\n                  <Award className=\"h-6 w-6 text-amber-600\" />\n                </div>\n                <div className=\"flex-1\">\n                  <h4 className=\"font-semibold text-gray-900\">Félicitations !</h4>\n                  <p className=\"text-sm text-gray-600\">Cours terminé avec succès</p>\n                </div>\n              </div>\n              <Button variant=\"outline\" className=\"w-full mt-3\">\n                <Download className=\"h-4 w-4 mr-2\" />\n                Télécharger le certificat\n              </Button>\n            </GlassCard>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n\n\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ListChecks\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMyAxNyAyIDIgNC00IiAvPgogIDxwYXRoIGQ9Im0zIDcgMiAyIDQtNCIgLz4KICA8cGF0aCBkPSJNMTMgNmg4IiAvPgogIDxwYXRoIGQ9Ik0xMyAxMmg4IiAvPgogIDxwYXRoIGQ9Ik0xMyAxOGg4IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/list-checks\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ListChecks = createLucideIcon('ListChecks', [\n  ['path', { d: 'm3 17 2 2 4-4', key: '1jhpwq' }],\n  ['path', { d: 'm3 7 2 2 4-4', key: '1obspn' }],\n  ['path', { d: 'M13 6h8', key: '15sg57' }],\n  ['path', { d: 'M13 12h8', key: 'h98zly' }],\n  ['path', { d: 'M13 18h8', key: 'oe0vm4' }],\n]);\n\nexport default ListChecks;\n"],"names":[],"mappings":"0DAEA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,CAAA,CAAA,QAAA,IAAA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,QCGM,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAa,CAAb,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,KAAa,OAAA,EAAiB,YAAc,CAAA,CAAA,AAChD,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA,CAAA,AAAE,EAAG,CAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAK,AAAL,QAAK,CAAU,CAAA,CAAA,AAC9C,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA,CAAA,AAAE,EAAG,CAAgB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CAAA,AAC7C,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA,CAAA,AAAE,EAAG,CAAW,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CACxC,AADwC,CACvC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA,CAAA,AAAE,EAAG,CAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CAAA,AACzC,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQ,CAAA,CAAA,AAAE,EAAG,CAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CAC1C,CAAA,CAAA,ADTD,IAAA,EAAA,EAAA,CAAA,CAAA,QAAA,EAAA,EAAA,CAAA,CAAA,QAoBA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QACA,EAAA,EAAA,CAAA,CAAA,QAEe,SAAS,IACtB,IAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IACT,CAAA,EAAA,EAAA,SAAA,AAAS,IACxB,IAAM,EAAO,EAAO,IAAI,CAClB,CAAE,QAAS,CAAW,WAAE,CAAS,CAAE,CAAG,CAAA,EAAA,EAAA,iBAAA,AAAiB,IACvD,EAAW,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAAO,EAAY,CAAA,EAAA,EAAA,mBAAA,AAAmB,EAAC,GAAa,KAAO,CAAC,EAAU,EACzF,EAAc,CAAA,EAAA,EAAA,cAAA,AAAc,IAC5B,UAAE,CAAQ,CAAE,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,IAEvB,CAAC,EAAoB,EAAsB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GACvD,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACrC,EAAW,CAAA,EAAA,EAAA,MAAA,AAAM,EAAmB,MAIpC,CAAC,EAAmB,EAAqB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAyC,CAAC,GAE9F,EAAuB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,IAC9B,AAAL,EACO,CAAC,CADJ,OAAY,iBACiB,EAAE,EAAA,CAAW,CADvB,KAEtB,CAAC,EAAU,EA6BR,CAAE,KAAM,CAAM,CAAE,UAAW,CAAa,CAAE,QAAS,CAAa,CAAE,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CAClF,SAAU,CAAC,iBAAkB,EAAK,CAClC,QAAS,UACP,GAAI,CACF,GAAI,CAAC,EAAU,OAAO,KACtB,GAAM,CAAE,MAAI,OAAE,CAAK,CAAE,CAAG,MAAM,EAC3B,IAAI,CAAC,WACL,MAAM,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;UAoBT,CAAC,EACA,EAAE,CAAC,OAAQ,GACX,WAAW,GAEd,GAAI,EAAO,CAET,GACiB,aAAf,EAAM,IAAI,EACK,UAAf,EAAM,IAAI,EACK,aAAf,EAAM,IAAI,EACgB,MAAzB,EAAc,MAAM,EACN,QAAf,EAAM,IAAI,EACV,EAAM,OAAO,EAAE,SAAS,aACxB,EAAM,OAAO,EAAE,SAAS,iBACxB,EAAM,OAAO,EAAE,SAAS,mBACxB,EAAM,OAAO,EAAE,SAAS,gBAMxB,CALA,MACA,EAAA,MAAM,CAAC,IAAI,CAAC,8DAA+D,CACzE,KAAM,EACN,MAAO,CAAA,EAAA,EAAA,aAAA,AAAa,EAAC,EACvB,GACO,IAET,OAAM,CACR,CACA,OAAO,CACT,CAAE,MAAO,EAAY,CAEnB,GACE,GAAO,OAAS,YAChB,GAAO,OAAS,SAChB,GAAO,OAAS,YAChB,GAAO,SAAW,KAClB,GAAO,OAAS,OAChB,GAAO,SAAS,SAAS,aACzB,GAAO,SAAS,SAAS,iBACzB,GAAO,SAAS,SAAS,mBACzB,GAAO,SAAS,SAAS,gBAMzB,CALA,MACA,EAAA,MAAM,CAAC,IAAI,CAAC,8DAA+D,CACzE,KAAM,EACN,MAAO,CAAA,EAAA,EAAA,aAAA,AAAa,EAAC,EACvB,GACO,IAET,OAAM,CACR,CACF,EACA,QAAS,CAAC,CAAC,GAAQ,CAAC,CAAC,CACvB,GAEM,EAAiB,GAAgB,kBAAmB,EAOpD,CAAE,KAAM,CAAc,CAAE,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CACxC,SAAU,CAAC,0BAA2B,GAAQ,GAAI,EAAU,CAC5D,QAAS,UACP,GAAI,CAAC,GAAQ,IAAM,CAAC,GAAa,CAAC,EAAU,MAAO,CAAC,EAEpD,GAAM,MAAE,CAAI,CAAE,CAAG,MAAM,EACpB,IAAI,CAAC,mBACL,MAAM,CAAC,KACP,EAAE,CAAC,aAAc,GAEd,EAAmC,CAAC,EAK1C,OAJA,GAAM,QAAQ,AAAC,IACb,CAAW,CAAC,EAAE,SAAS,CAAC,CAAG,CAC7B,GAEO,CACT,EACA,QAAS,CAAC,CAAC,GAAQ,IAAM,CAAC,CAAC,GAAa,CAAC,CAAC,CAC5C,GAIM,CAAE,KAAM,CAAe,CAAE,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CACzC,SAAU,CAAC,kCAAmC,GAAQ,GAAG,CACzD,QAAS,UACP,GAAI,CAAC,GAAY,CAAC,GAAQ,IACtB,GAAQ,iBAAiB,OADC,CACO,KADA,EAAE,AACK,CAE5C,CAF8C,CAAC,CAEzC,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,MAAM,EAC3B,IAAI,CAAC,SAH+E,EAIpF,MAAM,CACL,CAAC;;;;;;;;;;;;;;QAcH,CAAC,EAEA,EAAE,CAAC,YAAa,EAAO,EAAE,EACzB,KAAK,CAAC,cAAe,CAAE,WAAW,CAAK,UAE1C,AAAI,GACF,EAAA,EADS,IACH,CAAC,IAAI,CAAC,kCAAmC,CAC7C,SAAU,CAAA,EAAA,EAAA,MAAA,AAAM,EAAC,EAAO,EAAE,EAC1B,MAAO,CAAA,EAAA,EAAA,aAAA,AAAa,EAAC,EACvB,GACO,EAAE,EAGJ,GAAQ,EAAE,AACnB,EACA,QAAS,CAAC,CAAC,GAAY,CAAC,CAAC,GAAQ,EACnC,GAGM,EACJ,GAAQ,iBAAiB,OACrB,EAAO,eAAe,EAClB,KAAK,CAAC,EAAQ,IAAW,EAAE,WAAW,CAAG,EAAE,WAAW,EACvD,QAAQ,AAAC,GACR,AAAC,GAAQ,OAAO,EAAI,EAAA,AAAE,EACnB,IAAI,CAAC,CAAC,EAAQ,IAAW,EAAE,WAAW,CAAG,EAAE,WAAW,EACtD,GAAG,CAAC,AAAC,GAAiB,EAAE,GAAG,CAAN,AAAY,CAAE,aAAc,EAAQ,KAAK,CAAC,CAAC,IAChE,EAAE,CACT,AAAC,IAAmB,EAAA,AAAE,EAAE,GAAG,CAAC,AAAC,IAAiB,CAC5C,GAAG,CADwC,AAClC,CACT,aAAc,GAAQ,SAAS,OAAS,eAC1C,CAAC,EAED,EAAgB,CAAU,CAAC,EAAmB,CAC9C,EAAe,EAAW,MAAM,CAChC,GAAmB,OAAO,MAAM,CAAC,GAAkB,CAAC,GAAG,MAAM,CAAC,AAAC,GAAW,EAAE,YAAY,EAAE,MAAM,CAChG,GAAqB,EAAe,EAAI,KAAK,KAAK,CAAC,GAAoB,EAAgB,KAAO,EAGpG,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,GAAI,CAAC,GAAe,GAAI,OACxB,IAAM,EAAS,CAtMoB,AAAC,IACpC,GAAI,CAAC,EAAsB,OAAO,KAClC,GAAI,CACF,IAAM,EAAM,aAAa,OAAO,CAAC,GACjC,GAAI,CAAC,EAAK,OAAO,KACjB,IAAM,EAAS,KAAK,KAAK,CAAC,GACpB,EAAgB,GAAQ,CAAC,EAAS,CACxC,GAAI,GAA0C,UAAzB,OAAO,EAA4B,OAAO,EAC/D,OAAO,IACT,CAAE,KAAM,CACN,OAAO,IACT,EACF,EA0L8C,EAAc,EAAE,EACvD,GACL,EAAqB,AAAC,GADT,AAEX,AAAI,CAAI,CAAC,EAAc,EAAE,CAAC,EAAI,OAAO,IAAI,CAAC,CAAI,CAAC,EAAc,EAAE,CAAC,EAAE,MAAM,CAAG,EAAU,CAAP,CACvE,CAAE,GAAG,CAAI,CAAE,CAAC,EAAc,EAAE,CAAC,CAAE,CAAO,EAEjD,EAAG,CAAC,GAAe,GAAI,EAAqB,EAG5C,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACJ,EAAqB,GAAK,GAAsB,GAClD,EAAsB,EAE1B,EAAG,CAAC,EAAoB,EAAa,AAH+B,EAMpE,IAAM,GAAyB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,CACzC,WAAY,MAAO,IACjB,GAAI,CAAC,GAAa,CAAC,EAAU,MAAM,AAAI,MAAM,qBAK7C,IAAM,EAAS,IAAI,OAAO,WAAW,GAS/B,EAAgB,CACpB,aAAc,GACd,aAAc,EACd,sBAAuB,GACzB,EAEM,CAAE,KAAM,CAAQ,CAAE,MAAO,CAAa,CAAE,CAAG,MAAM,EACpD,IAAI,CAAC,mBACL,MAAM,CAAC,MACP,EAAE,CAAC,YAAa,GAChB,EAAE,CAAC,aAAc,GACjB,WAAW,GAEd,GAAI,GAAwC,YAAY,CAAnC,EAAc,IAAI,CAErC,MAAM,EAGR,GAAI,GAAU,GAAI,CAChB,GAAM,CAAE,MAAO,CAAW,CAAE,CAAG,MAAM,EAClC,IAAI,CAAC,mBACL,MAAM,CAAC,GACP,EAAE,CAAC,KAAM,EAAS,EAAE,EACvB,GAAI,EAAa,MAAM,CACzB,KAAO,CACL,GAAM,CAAE,MAAO,CAAW,CAAE,CAAG,MAAM,EAClC,IAAI,CAAC,mBACL,MAAM,CAAC,AAnCU,CACpB,WAAY,EACZ,UAAW,EACX,cAAc,EACd,aAAc,EACd,sBAAuB,GACzB,GA+BE,GAAI,EAEF,GAAyB,QAFV,EAEX,EAAY,IAAI,EAAgB,EAAY,OAAO,EAAE,cAAc,SAAS,cAAgB,EAAY,OAAO,EAAE,cAAc,SAAS,YAAa,CACvJ,GAAM,CAAE,MAAO,CAAW,CAAE,CAAG,MAAM,EAClC,IAAI,CAAC,mBACL,MAAM,CAAC,GACP,EAAE,CAAC,YAAa,GAChB,EAAE,CAAC,aAAc,GACpB,GAAI,EAAa,MAAM,CACzB,MACE,CADK,KACC,CAGZ,CAoBF,EACA,UAAW,KACT,EAAY,iBAAiB,CAAC,CAAE,SAAU,CAAC,0BAA0B,AAAC,GACtE,EAAY,iBAAiB,CAAC,CAAE,SAAU,CAAC,4BAA4B,AAAC,GACxE,EAAS,CACP,KAAM,UACN,MAAO,mBACP,YAAa,sCACf,EACF,EACA,QAAS,AAAC,IACR,IAAM,EAAM,GAAO,SAAW,GAC9B,EAAS,CACP,KAAM,QACN,MAAO,2BACP,YACE,EAAI,QAAQ,CAAC,QAAU,EAAI,WAAW,GAAG,QAAQ,CAAC,gBAC9C,oHACA,EAAI,QAAQ,CAAC,QAAU,EAAI,WAAW,GAAG,QAAQ,CAAC,YAClD,+QACA,wEACR,EACF,CACF,GAcM,GAAuB,KACvB,GACF,GAAuB,MAAM,CAAC,EADb,AAC2B,EAAE,CAElD,EAEM,GAAiB,AAAD,IACpB,OAAQ,GACN,IAAK,QAAS,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,WACtC,KAAK,OAAQ,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAW,UAAU,WAC1C,KAAK,OAAQ,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,WACxC,KAAK,QAAS,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAS,CAAA,CAAC,UAAU,WAC1C,SAAS,MAAO,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,WACtC,CACF,EAEM,GAAoB,AAAC,GAClB,GAAgB,CAAC,EAAS,EAAE,aA4L/B,GAAoB,CAAA,EAAA,EAAA,OAAA,AAAO,EAAC,KAChC,GAAI,CAAC,GAAe,IAAM,CAAC,GAAe,QACxC,CADiD,KAC1C,CAAE,MAAO,EAAG,SAAU,EAAG,QAAS,EAAG,WAAY,EAAG,OAAQ,EAAM,EAG3E,GAAI,CACF,IAAM,EAAS,KAAK,KAAK,CAAC,EAAc,OAAO,EAC/C,GAAI,CAAC,MAAM,OAAO,CAAC,GAAS,MAAO,CAAE,MAAO,EAAG,SAAU,EAAG,QAAS,EAAG,WAAY,EAAG,QAAQ,CAAM,EAErG,IAAM,EAAa,EAAO,MAAM,CAAC,AAAC,GAAW,GAAG,OAAS,QACzD,GAAI,CAAC,EAAW,MAAM,CAAE,MAAO,CAAE,MAAO,EAAG,SAAU,EAAG,QAAS,EAAG,WAAY,EAAG,QAAQ,CAAM,EAEjG,IAAM,EAAgB,GAAmB,CAAC,EAAc,EAAE,CAAC,EAAI,CAAC,EAE5D,EAAQ,EACR,EAAW,EACX,EAAU,EAEd,IAAK,IAAI,EAAI,EAAG,EAAI,EAAW,MAAM,CAAE,IAAK,CAC1C,IAAM,EAAQ,CAAU,CAAC,EAAE,CACrB,EAAU,OAAO,GAAO,IAAM,CAAC,KAAK,EAAE,EAAA,CAAG,EACzC,EAAW,CAAa,CAAC,EAAQ,CACnC,IAAU,IAAY,EAE1B,IAAM,EAAU,CAAC,GAAO,MAAM,SAAW,EAAA,AAAE,EAAE,GAAG,CAAC,CAAC,EAAU,KAAoB,CAC9E,GAAI,AADyE,OAClE,GAAK,IAAM,CAAA,EAAG,EAAQ,KAAK,EAAE,EAAA,CAAQ,EAChD,KAAM,OAAO,GAAK,MAAQ,IAC1B,UAAW,CAAC,CAAC,GAAK,UACpB,CAAC,EAGD,GAAI,CADmB,AAClB,EAD0B,MAAM,CAAC,AAAC,GAAW,EAAE,SAAS,EACzC,MAAM,CAExB,CAF0B,QAK5B,GAAS,EACT,IAAM,EAAiB,EAAQ,IAAI,CAAC,AAAC,GAAW,CAAC,EAAE,EAAE,EAAI,EAAE,IAAA,AAAI,IAAM,GACjE,GAAY,GAAgB,YAAW,IAAW,CACxD,CAEA,IAAM,EAAS,EAAQ,EACjB,EAAa,EAAS,KAAK,KAAK,CAAE,EAAU,EAAS,KAAO,EAClE,MAAO,OAAE,WAAO,UAAU,EAAS,oBAAY,CAAO,CACxD,CAAE,KAAM,CACN,MAAO,CAAE,MAAO,EAAG,SAAU,EAAG,QAAS,EAAG,WAAY,EAAG,QAAQ,CAAM,CAC3E,CACF,EAAG,CAAC,GAAe,GAAI,GAAe,QAAS,EAAkB,SAE7D,AAAJ,EAEI,CAAA,EAAA,EAAA,IAAA,EAAC,EAFc,IAEd,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mDACf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6DACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qDAMlB,EAgBH,CAAA,EAAA,EAAA,CAhBW,GAgBX,EAAC,MAAA,CAAI,UAAU,oCAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAAC,KAAK,8BACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,QAAQ,KAAK,gBAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,gBAGzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oEACX,EAAO,KAAK,GAEf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+DACb,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAM,GAAmB,gBAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,MACN,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAM,GAAiB,IAAE,EAAa,mBAG1C,IAAsB,KACrB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,wCACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,iBAAiB,gBAOxC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+DACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAC,GAAG,CAAA,CACT,UAAU,wDACV,QAAS,CAAE,MAAO,CAAE,EACpB,QAAS,CAAE,MAAO,CAAA,EAAG,GAAmB,CAAC,CAAC,AAAC,EAC3C,WAAY,CAAE,SAAU,EAAI,MAIhC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACZ,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,4BAEnB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6CACZ,EAAc,SAAS,CACtB,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,IAAK,EACL,IAAK,EAAc,SAAS,CAC5B,UAAU,+BACV,QAAQ,CAAA,CAAA,EACR,QAAS,KAEqB,SAA9B,EAAc,WAAW,CAC3B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kFACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAW,UAAU,mCACtB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sCAA6B,oBAC3C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,8BAAqB,6BAClC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CACH,KAAM,CAAC,qBAAqB,EAAE,GAAe,SAAS,CAAC,EAAE,EAAE,IAAM,EAAc,EAAE,CAAA,CAAE,UAEnF,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,WACL,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,UAAU,iBAAiB,4BAMvC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,6DACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,2CACpB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,yBAAgB,sCAOrC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,gBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDACV,EAAc,YAAY,GAE7B,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,2CACX,EAAc,KAAK,GAErB,GAAiB,GAAkB,MAAM,EACxC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,0CAAgC,eAClC,GAAkB,OAAO,CAAC,IAAE,GAAkB,KAAK,CAAC,KAAG,GAAkB,UAAU,CAAC,aAKzG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACZ,EAAc,sBAAsB,EACnC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,oBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,iBAChB,EAAc,sBAAsB,CAAC,UAGzC,GAAkB,EAAc,EAAE,GACjC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,wCACf,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,YAAY,CAAA,CAAC,UAAU,iBAAiB,mBAOhD,EAAc,WAAW,EACxB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,8BAAsB,EAAc,WAAW,GAI7D,CAxXa,CAAC,EAAyB,KACpD,GAAI,CAAC,EAAS,OAAO,KAErB,GAAI,CACF,IAAM,EAAS,KAAK,KAAK,CAAC,GAC1B,GAAI,MAAM,OAAO,CAAC,GAChB,MACE,AAFuB,CAEvB,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EAAO,GAAG,CAAC,CAAC,EAAY,KACvB,GAAI,CAAC,GAAO,KAAM,OAAO,KAEzB,GAAmB,QAAQ,CAAvB,EAAM,IAAI,CACZ,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAA0B,UAAU,qCACnC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAa,CAAA,UAAE,GAAO,MAAM,SAAW,MADhC,EAAM,EAAE,EAAI,GAM1B,GAAmB,UAAf,EAAM,IAAI,CAAc,CAC1B,IAAM,EAAY,GAAO,MAAM,UACzB,EAAM,GAAO,MAAM,SACnB,EAAU,GAAO,MAAM,eAC7B,AAAK,EAED,AAAc,EAFd,CAAM,MAEiB,GAEvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAA0B,UAAU,sBACnC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,IAAK,EAAK,IAAK,GAAW,QAAS,UAAU,6CACjD,EAAU,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDAA4C,IAAe,OAF3E,EAAM,EAAE,EAAI,GAOR,SAAS,CAAvB,EAEA,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAA0B,UAAU,sBACnC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,IAAK,EAAK,QAAQ,CAAA,CAAA,EAAC,UAAU,sBACnC,EAAU,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDAA4C,IAAe,OAF3E,EAAM,EAAE,EAAI,GAOR,SAAS,CAAvB,EAEA,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAA0B,UAAU,sBACnC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,IAAK,EAAK,QAAQ,CAAA,CAAA,EAAC,UAAU,WACnC,EAAU,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oDAA4C,IAAe,OAF3E,EAAM,EAAE,EAAI,GASxB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAA0B,UAAU,oEACnC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,+BAAuB,GAAW,YAClD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,KAAM,EAAK,OAAO,SAAS,IAAI,sBAAsB,UAAU,mDAA0C,kBAFpG,EAAM,EAAE,EAAI,GA/BP,IAsCnB,CAEA,GAAmB,SAAf,EAAM,IAAI,CAAa,CACzB,IAAM,EAAU,OAAO,GAAO,IAAM,CAAC,KAAK,EAAE,EAAA,CAAK,EAC3C,EACH,GAAY,GAAmB,CAAC,EAAS,EAAE,CAAC,EAAQ,EAAK,GAEtD,EAAU,AAAC,IAAO,MAAM,SAAW,EAAA,AAAE,EAAE,GAAG,CAAC,CAAC,EAAU,KAAoB,CAC9E,GAD6E,AACzE,OAAO,GAAK,IAAM,CAAA,EAAG,EAAQ,KAAK,EAAE,EAAA,CAAQ,EAChD,KAAM,OAAO,GAAK,MAAQ,IAC1B,UAAW,CAAC,CAAC,GAAK,UACpB,CAAC,EAEK,EAAiB,EAAQ,MAAM,CAAC,AAAC,GAAW,EAAE,SAAS,EACvD,EAAiB,EAAQ,IAAI,CAAC,AAAC,GAAW,CAAC,EAAE,EAAE,EAAI,EAAE,IAAA,AAAI,IAAM,GAC/D,EAAa,CAAC,CAAC,EACf,EAAW,EAAe,MAAM,CAAG,EACnC,EAAY,OAAc,GAAW,CAAC,CAAC,GAAgB,UAE7D,EAFyE,IAGvE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAA0B,UAAU,2CACnC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,yDACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uCACX,GAAiB,EAAW,cAAgB,SAE9C,GAAiB,GAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAW,EAAc,EAAY,8BAAgC,0BAA6B,qCACtG,GAAc,EAAY,MAAQ,QAAS,GAIlD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sCAA8B,GAAO,MAAM,UAAY,KAEpE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EAAQ,GAAG,CAAC,AAAC,IACZ,IAAM,EAAQ,EAAI,EAAE,EAAI,EAAI,IAAI,CAC1B,EAAa,IAAa,EAC1B,EAAW,CAAC,CAAC,EAEnB,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAEC,KAAK,SACL,QAAS,AAAC,IACR,AAEA,EAFE,cAAc,GAChB,EAAE,eAAe,GACb,CAAC,GACD,GACJ,EAAqB,AAAC,EAFP,EAGb,CAFY,GAEN,EAAoB,CACxB,GAAI,CAAI,CAAC,EAAS,EAAI,CAAC,CAAC,CACxB,CAAC,EAAQ,CAAE,CACb,EA/b5B,GAAK,CAAD,CACJ,GAAI,CACF,IAAM,EAAM,UAFa,GAEA,OAAO,CAAC,GAE3B,EAAO,CAAE,GAAI,CADJ,EAAM,KAAK,KAAK,CAAC,GAAO,EAAC,GACX,CAAC,CAAC,CAAG,CAAC,AA6bkB,EA7bT,CA6bmB,CA7bjB,AAAc,EAC5D,aAAa,OAAO,CAAC,EAAsB,KAAK,SAAS,CAAC,GAC5D,CAAE,KAAM,CAER,CA0b4B,MAAO,CAAE,GAAG,CAAI,CAAE,CAAC,EAAS,CAAE,CAAkB,CAClD,EACF,EACA,SAAU,EACV,UAAW,CAAC,uEAAuE,EACjF,EACI,mDACA,iDAAA,CACJ,UAED,EAAI,IAAI,EAxBJ,EA2BX,KAID,GAAiB,GAAc,GAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,wBACZ,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sCAA6B,uBAE1C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,oCAA2B,2BAK7C,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sCAA6B,6DA/DpC,EAAM,EAAE,EAAI,EAqE1B,OAEA,AAAmB,QAAQ,CAAvB,EAAM,IAAI,CAEV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAA0B,UAAU,2CACnC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,4CAAmC,YACjD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sCAA8B,GAAO,MAAM,cAAgB,KACxE,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,qBACX,CAAC,GAAO,MAAM,aAAe,EAAA,AAAE,EAAE,GAAG,CAAE,AAAD,GACpC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAgB,UAAU,6DACxB,EAAI,IAAI,EADF,EAAI,EAAE,OALX,EAAM,EAAE,EAAI,GAcnB,IACT,IAIR,CAAE,KAAM,CAER,CAEA,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,wDACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAa,CAAA,UAAE,KAGtB,GAkMmC,EAAc,OAAO,CAAE,EAAc,EAAE,EAG5D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iEACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,UACR,QAxZO,CAwZE,IAvZrB,EAAqB,GACvB,AAD0B,EACJ,EAAqB,EAE/C,EAqZkB,SAAiC,AAAvB,gBAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,WAAW,CAAA,CAAC,UAAU,iBAAiB,eAIzC,CAAC,GAAkB,EAAc,EAAE,GAClC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAS,GACT,SAAU,GAAuB,SAAS,CAC1C,UAAU,4CAEV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,YAAY,CAAA,CAAC,UAAU,iBAAiB,2BAK7C,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAjbO,CAibE,IAhbrB,EAAqB,EAAe,GAAG,AACzC,EAAsB,EAAqB,EAE/C,EA8akB,SAAU,GAAsB,EAAe,YAChD,UAEC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,YAAY,CAAA,CAAC,UAAU,6BAOjC,CAAC,GACA,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,uDACnB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oDAA2C,oCACzD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sCAA6B,yGAG1C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,uBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAS,IAAM,IACf,UAAU,gDACX,cAGD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAAC,KAAK,8BACT,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,mBAAU,gCAQpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,gBACnB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,wCAA+B,qBAC7C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,wDACZ,EAAO,eAAe,EAAE,OAAS,EAAO,eAAe,EACpD,KAAK,CAAC,EAAQ,IAAW,EAAE,WAAW,CAAG,EAAE,WAAW,EACvD,IAAI,AAAC,GACJ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAqB,UAAU,iBAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,yDACX,EAAQ,KAAK,GAEhB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EAAQ,OAAO,CACb,IAAI,CAAC,CAAC,EAAQ,IAAW,EAAE,WAAW,CAAG,EAAE,WAAW,EACtD,GAAG,CAAC,CAAC,EAAa,KACjB,IAAM,EAAc,EAAW,SAAS,CAAE,AAAD,GAAY,EAAE,EAAE,GAAK,EAAO,EAAE,EACjE,EAAW,IAAgB,EAC3B,EAAa,GAAkB,EAAO,EAAE,EAE9C,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAEC,QAAS,IAAM,EAAsB,GACrC,UAAW,CAAC,uEAAuE,EACjF,EACI,qCACA,EACA,+CACA,iCAAA,CACJ,WAEF,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,CAAC,iBAAiB,EAChC,EAAW,cAAgB,EAAa,eAAiB,cAAA,CACzD,UACC,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,YAAY,CAAA,CAAC,UAAW,CAAC,QAAQ,EAAE,EAAW,aAAe,iBAAA,CAAkB,GAEhF,GAAc,EAAO,WAAW,IAGpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAC,6BAA6B,EAC1C,EAAW,aAAe,GAAA,CAC1B,UACC,EAAO,KAAK,GAEd,EAAO,sBAAsB,EAC5B,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAW,CAAC,QAAQ,EACrB,EAAW,gBAAkB,gBAAA,CAC7B,WACD,EAAO,sBAAsB,CAAC,aAIlC,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,yBAlCnB,EAAO,EAAE,CAsCpB,OApDI,EAAQ,EAAE,GAuDjB,EAAW,MAAM,CACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,yDAAgD,WAC9D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EAAW,GAAG,CAAC,AAAC,IACf,IAAM,EAAc,EAAW,SAAS,CAAC,AAAC,GAAW,EAAE,EAAE,GAAK,EAAO,EAAE,EACjE,EAAW,IAAgB,EAC3B,EAAa,GAAkB,EAAO,EAAE,EAE9C,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAEC,QAAS,IAAM,EAAsB,GACrC,UAAW,CAAC,uEAAuE,EACjF,EACI,qCACA,EACA,+CACA,iCAAA,CACJ,WAEF,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CACC,UAAW,CAAC,iBAAiB,EAC3B,EAAW,cAAgB,EAAa,eAAiB,cAAA,CACzD,UAED,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,YAAY,CAAA,CAAC,UAAW,CAAC,QAAQ,EAAE,EAAW,aAAe,iBAAA,CAAkB,GAEhF,GAAc,EAAO,WAAW,IAGpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,CAAC,6BAA6B,EAAE,EAAW,aAAe,GAAA,CAAI,UACzE,EAAO,KAAK,GAEd,EAAO,sBAAsB,EAC5B,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAW,CAAC,QAAQ,EAAE,EAAW,gBAAkB,gBAAA,CAAiB,WACpE,EAAO,sBAAsB,CAAC,aAIpC,GAAY,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CAAC,UAAU,yBA/B9B,EAAO,EAAE,CAkCpB,QAIJ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kEAAyD,oJAS/E,IAAsB,KACrB,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,iFACnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uCACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,UAAU,6BAEnB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uCAA8B,oBAC5C,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,iCAAwB,oCAGzC,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,UAAU,wBAClC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,iBAAiB,2CA9T/C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8BACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CAAC,UAAU,yCACpB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oDAA2C,sBACzD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAI,CAAA,CAAC,KAAK,8BACT,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,oBACd,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CAAC,UAAU,iBAAiB,0BAkUlD","ignoreList":[1]}