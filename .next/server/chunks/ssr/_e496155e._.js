module.exports=[915618,a=>{"use strict";let b=(0,a.i(170106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],915618)},400210,a=>{"use strict";let b=(0,a.i(170106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],400210)},114548,a=>{"use strict";let b=(0,a.i(170106).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);a.s(["Save",()=>b],114548)},315470,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getTemplates(a){let{data:b,error:c}=await this.supabase.from("evaluation_templates").select(`
        *,
        questions:evaluation_template_questions(*)
      `).or(`organization_id.eq.${a},organization_id.is.null`).eq("is_active",!0).order("created_at",{ascending:!1});return c?(console.error("Erreur récupération modèles:",c),[]):b||[]}async getTemplateById(a){let{data:b,error:c}=await this.supabase.from("evaluation_templates").select(`
        *,
        questions:evaluation_template_questions(*)
      `).eq("id",a).single();return c?(console.error("Erreur récupération modèle:",c),null):b}async createTemplate(a,b,c){let{data:d,error:e}=await this.supabase.from("evaluation_templates").insert({...b,organization_id:a}).select().single();if(e)throw e;if(c.length>0){let a=c.map((a,b)=>({...a,template_id:d.id,order_index:a.order_index??b+1})),{error:b}=await this.supabase.from("evaluation_template_questions").insert(a);if(b)throw b}let f=await this.getTemplateById(d.id);if(!f)throw Error("Erreur lors de la récupération du modèle créé");return f}async updateTemplate(a,b,c){let{error:d}=await this.supabase.from("evaluation_templates").update(b).eq("id",a);if(d)throw d;if(void 0!==c){let{error:b}=await this.supabase.from("evaluation_template_questions").delete().eq("template_id",a);if(b)throw b;if(c.length>0){let b=c.map((b,c)=>({...b,template_id:a,order_index:b.order_index??c+1})),{error:d}=await this.supabase.from("evaluation_template_questions").insert(b);if(d)throw d}}let e=await this.getTemplateById(a);if(!e)throw Error("Erreur lors de la récupération du modèle mis à jour");return e}async deleteTemplate(a){let{error:b}=await this.supabase.from("evaluation_templates").delete().eq("id",a);if(b)throw b}async createInstance(a,b,c){let{data:d,error:e}=await this.supabase.from("evaluation_template_instances").insert({grade_id:a,template_id:b,max_score:c?.max_score,time_limit_minutes:c?.time_limit_minutes}).select().single();if(e)throw e;return d}async getInstanceByGradeId(a){try{let{data:b,error:c}=await this.supabase.from("evaluation_template_instances").select(`
          *,
          template:evaluation_templates(
            *,
            questions:evaluation_template_questions(*)
          ),
          grade:grades(*)
        `).eq("grade_id",a).single();if(c){if("PGRST116"===c.code)return null;throw c}return b}catch{return null}}async getResponses(a,b){let c=this.supabase.from("evaluation_responses").select("*").eq("instance_id",a);b&&(c=c.eq("student_id",b));let{data:d,error:e}=await c.order("created_at",{ascending:!0});return e?(console.error("Erreur récupération réponses:",e),[]):d||[]}async saveResponse(a,b,c,d){let{data:e,error:f}=await this.supabase.from("evaluation_responses").upsert({instance_id:a,question_id:b,student_id:c,answer_text:d.answer_text,answer_choice:d.answer_choice,answer_boolean:d.answer_boolean},{onConflict:"instance_id,question_id,student_id"}).select().single();if(f)throw f;return e}async autoCorrectResponses(a){let{data:b,error:c}=await this.supabase.rpc("auto_correct_evaluation_responses",{p_instance_id:a});if(c)throw c;return b||0}async calculateScore(a){let{data:b,error:c}=await this.supabase.rpc("calculate_evaluation_score",{p_instance_id:a});return c?(console.error("Erreur calcul score:",c),null):b&&0!==b.length?{total_score:Number(b[0].total_score)||0,max_score:Number(b[0].max_score)||0,percentage:Number(b[0].percentage)||0,correct_count:Number(b[0].correct_count)||0,total_questions:Number(b[0].total_questions)||0}:null}async updateGradeFromScore(a,b){let c=await this.calculateScore(b);if(!c)return;let{error:d}=await this.supabase.from("grades").update({score:c.total_score,max_score:c.max_score}).eq("id",a);if(d)throw d}};a.s(["evaluationTemplateService",0,c])}];

//# sourceMappingURL=_e496155e._.js.map