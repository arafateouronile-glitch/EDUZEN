module.exports=[400210,a=>{"use strict";let b=(0,a.i(170106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],400210)},114548,a=>{"use strict";let b=(0,a.i(170106).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);a.s(["Save",()=>b],114548)},992258,a=>{"use strict";let b=(0,a.i(170106).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);a.s(["Mail",()=>b],992258)},491829,a=>{"use strict";var b=a.i(187924),c=a.i(913216),d=a.i(50944),e=a.i(572131);let f=(0,a.i(170106).default)("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);var g=a.i(340695),h=a.i(703130),i=a.i(238246);function j({children:a,allowedRoles:j,fallback:k,redirectTo:l="/dashboard"}){let{user:m,isLoading:n}=(0,c.useAuth)(),o=(0,d.useRouter)(),[p,q]=(0,e.useState)(null);return((0,e.useEffect)(()=>{if(!n&&m){let a=m.role||"",b=j.includes(a);q(b),b||!l||k||o.push(l)}},[m,n,j,l,o,k]),n||null===p)?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[200px]",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-blue"})}):p?(0,b.jsx)(b.Fragment,{children:a}):k?(0,b.jsx)(b.Fragment,{children:k}):(0,b.jsx)("div",{className:"container mx-auto py-16 px-4",children:(0,b.jsx)(h.Card,{className:"max-w-md mx-auto",children:(0,b.jsxs)(h.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,b.jsx)(f,{className:"h-8 w-8 text-red-600"})}),(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Accès non autorisé"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"Vous n'avez pas les permissions nécessaires pour accéder à cette page."}),(0,b.jsx)(i.default,{href:"/dashboard",children:(0,b.jsx)(g.Button,{children:"Retour au tableau de bord"})})]})})})}a.s(["ADMIN_ROLES",0,["super_admin","admin","secretary","accountant"],"FINANCE_ROLES",0,["super_admin","admin","secretary","accountant"],"FORMATION_MANAGEMENT_ROLES",0,["super_admin","admin","secretary"],"RoleGuard",()=>j],491829)},963519,a=>{"use strict";let b=(0,a.i(170106).default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);a.s(["Phone",()=>b],963519)},723187,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(50944),e=a.i(433217),f=a.i(370025),g=a.i(937927),h=a.i(913216),i=a.i(269240),j=a.i(340695),k=a.i(703130),l=a.i(205522),m=a.i(917171),n=a.i(864037),o=a.i(491829),p=a.i(400210),q=a.i(546842),r=a.i(992258),s=a.i(963519),t=a.i(603314),u=a.i(114548),v=a.i(669520);let w=(0,a.i(170106).default)("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);var x=a.i(238246);let y=[{value:"admin",label:"Administrateur"},{value:"teacher",label:"Enseignant"},{value:"secretary",label:"Secrétaire"},{value:"accountant",label:"Comptable"},{value:"parent",label:"Parent"},{value:"student",label:"Étudiant"}];function z(){let a=(0,d.useRouter)(),o=(0,d.useParams)().id,{user:z}=(0,h.useAuth)(),A=(0,i.createClient)(),{addToast:B}=(0,n.useToast)(),C=(0,g.useQueryClient)(),[D,E]=(0,c.useState)({email:"",full_name:"",phone:"",role:"teacher",is_active:!0}),{data:F,isLoading:G}=(0,e.useQuery)({queryKey:["user",o],queryFn:async()=>{let{data:a,error:b}=await A.from("users").select("id, email, full_name, phone, role, is_active, organization_id").eq("id",o).single();if(b)throw b;return a},enabled:!!o});(0,c.useEffect)(()=>{F&&E({email:F.email||"",full_name:F.full_name||"",phone:F.phone||"",role:F.role||"teacher",is_active:F.is_active??!0})},[F]);let H=(0,f.useMutation)({mutationFn:async a=>{let{error:b}=await A.from("users").update({email:a.email,full_name:a.full_name,phone:a.phone||null,role:a.role,is_active:a.is_active}).eq("id",o);if(b)throw b},onSuccess:()=>{C.invalidateQueries({queryKey:["organization-users"]}),C.invalidateQueries({queryKey:["user",o]}),B({type:"success",title:"Succès",description:"L'utilisateur a été mis à jour avec succès"}),setTimeout(()=>{a.push("/dashboard/settings/users")},300)},onError:a=>{console.error("❌ [UPDATE USER] Erreur:",a),B({type:"error",title:"Erreur",description:a.message||"Une erreur est survenue lors de la mise à jour"})}});return G?(0,b.jsx)("div",{className:"container mx-auto py-8 px-4 max-w-3xl",children:(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)(v.RefreshCw,{className:"h-8 w-8 animate-spin text-brand-blue"})})}):F?(0,b.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-3xl",children:[(0,b.jsxs)("div",{className:"mb-8",children:[(0,b.jsxs)(x.default,{href:"/dashboard/settings/users",className:"inline-flex items-center text-sm text-muted-foreground hover:text-foreground mb-4",children:[(0,b.jsx)(p.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Retour à la liste des utilisateurs"]}),(0,b.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,b.jsx)(w,{className:"h-8 w-8 text-brand-blue"}),"Modifier l'utilisateur"]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Modifiez les informations de l'utilisateur"})]}),(0,b.jsxs)(k.Card,{children:[(0,b.jsxs)(k.CardHeader,{children:[(0,b.jsx)(k.CardTitle,{children:"Informations de l'utilisateur"}),(0,b.jsx)(k.CardDescription,{children:"Modifiez les informations de l'utilisateur"})]}),(0,b.jsx)(k.CardContent,{children:(0,b.jsxs)("form",{onSubmit:a=>{(a.preventDefault(),D.email&&D.full_name)?H.mutate(D):B({type:"error",title:"Erreur",description:"Veuillez remplir tous les champs obligatoires"})},className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(m.Label,{htmlFor:"full_name",children:[(0,b.jsx)(q.User,{className:"h-4 w-4 inline mr-2"}),"Nom complet ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(l.Input,{id:"full_name",type:"text",value:D.full_name,onChange:a=>E({...D,full_name:a.target.value}),placeholder:"Jean Dupont",required:!0,className:"mt-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(m.Label,{htmlFor:"email",children:[(0,b.jsx)(r.Mail,{className:"h-4 w-4 inline mr-2"}),"Email ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(l.Input,{id:"email",type:"email",value:D.email,onChange:a=>E({...D,email:a.target.value}),placeholder:"jean.dupont@example.com",required:!0,className:"mt-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(m.Label,{htmlFor:"phone",children:[(0,b.jsx)(s.Phone,{className:"h-4 w-4 inline mr-2"}),"Téléphone"]}),(0,b.jsx)(l.Input,{id:"phone",type:"tel",value:D.phone,onChange:a=>E({...D,phone:a.target.value}),placeholder:"+221 77 123 45 67",className:"mt-2"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(m.Label,{htmlFor:"role",children:[(0,b.jsx)(t.Shield,{className:"h-4 w-4 inline mr-2"}),"Rôle ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("select",{id:"role",value:D.role,onChange:a=>E({...D,role:a.target.value}),className:"mt-2 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",required:!0,children:y.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("input",{type:"checkbox",id:"is_active",checked:D.is_active,onChange:a=>E({...D,is_active:a.target.checked}),className:"h-4 w-4 rounded border-gray-300 text-brand-blue focus:ring-brand-blue"}),(0,b.jsx)(m.Label,{htmlFor:"is_active",className:"cursor-pointer",children:"Utilisateur actif"})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-4 pt-4",children:[(0,b.jsx)(j.Button,{type:"button",variant:"outline",onClick:()=>a.push("/dashboard/settings/users"),disabled:H.isPending,children:"Annuler"}),(0,b.jsx)(j.Button,{type:"submit",disabled:H.isPending,children:H.isPending?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.RefreshCw,{className:"h-4 w-4 mr-2 animate-spin"}),"Enregistrement..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.Save,{className:"h-4 w-4 mr-2"}),"Enregistrer les modifications"]})})]})]})})]})]}):(0,b.jsx)("div",{className:"container mx-auto py-8 px-4 max-w-3xl",children:(0,b.jsx)(k.Card,{children:(0,b.jsx)(k.CardContent,{className:"pt-6",children:(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(q.User,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:"Utilisateur introuvable"}),(0,b.jsx)(j.Button,{asChild:!0,children:(0,b.jsx)(x.default,{href:"/dashboard/settings/users",children:"Retour à la liste"})})]})})})})}function A(){return(0,b.jsx)(o.RoleGuard,{allowedRoles:o.ADMIN_ROLES,children:(0,b.jsx)(z,{})})}a.s(["default",()=>A],723187)}];

//# sourceMappingURL=_f146432f._.js.map