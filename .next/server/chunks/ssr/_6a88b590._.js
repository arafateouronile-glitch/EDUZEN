module.exports=[400210,a=>{"use strict";let b=(0,a.i(170106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],400210)},280281,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);let e=c.forwardRef(({checked:a,onCheckedChange:c,disabled:e,className:f,...g},h)=>(0,b.jsx)("button",{type:"button",role:"switch","aria-checked":a,ref:h,disabled:e,onClick:()=>c?.(!a),className:(0,d.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",a?"bg-brand-blue":"bg-input",f),...g,children:(0,b.jsx)("span",{className:(0,d.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform",a?"translate-x-5":"translate-x-0")})}));e.displayName="Switch",a.s(["Switch",0,e])},56341,a=>{"use strict";var b=a.i(187924),c=a.i(703130),d=a.i(340695),e=a.i(205522),f=a.i(917171),g=a.i(280281),h=a.i(864037),i=a.i(400210),j=a.i(469769),k=a.i(797063),l=a.i(238246),m=a.i(572131),n=a.i(913216),o=a.i(269240),p=a.i(433217),q=a.i(370025),r=a.i(937927);function s(){let{user:a}=(0,n.useAuth)(),{addToast:s}=(0,h.useToast)(),t=(0,r.useQueryClient)(),u=(0,o.createClient)(),[v,w]=(0,m.useState)({provider:"moodle",api_url:"",api_key:"",is_active:!1,auto_sync:!1,sync_frequency:"daily"}),{data:x,isLoading:y}=(0,p.useQuery)({queryKey:["lms-config",a?.organization_id],queryFn:async()=>{if(!a?.organization_id)return null;try{let{data:b,error:c}=await u.from("lms_configurations").select("*").eq("organization_id",a.organization_id).single();if(c){if("PGRST116"===c.code||"406"===c.code||"PGRST200"===c.code||c.message?.includes("does not exist"))return null;throw c}return b}catch(a){if(a?.code==="PGRST200"||a?.message?.includes("does not exist")||a?.message?.includes("schema cache"))return null;return console.error("Error fetching LMS configuration:",a.message),null}},enabled:!!a?.organization_id});(0,m.useEffect)(()=>{x&&w({provider:x.provider||"moodle",api_url:x.api_url||"",api_key:x.api_key||"",is_active:x.is_active||!1,auto_sync:x.auto_sync||!1,sync_frequency:x.sync_frequency||"daily"})},[x]);let z=(0,q.useMutation)({mutationFn:async b=>{if(!a?.organization_id)throw Error("Organization ID is missing.");if(x?.id){let{data:a,error:c}=await u.from("lms_configurations").update(b).eq("id",x.id).select().single();if(c)throw c;return a}{let{data:c,error:d}=await u.from("lms_configurations").insert({...b,organization_id:a.organization_id}).select().single();if(d)throw d;return c}},onSuccess:()=>{s({type:"success",title:"Configuration LMS enregistrée",description:"Les paramètres LMS ont été mis à jour avec succès."}),t.invalidateQueries({queryKey:["lms-config"]})},onError:a=>{s({type:"error",title:"Erreur lors de l'enregistrement",description:a?.message||"Veuillez vérifier les informations saisies."})}});return y?(0,b.jsx)("div",{className:"container mx-auto py-8 px-4",children:(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("p",{className:"text-gray-500",children:"Chargement de la configuration LMS..."})})})}):(0,b.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,b.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(l.default,{href:"/dashboard/settings",children:(0,b.jsx)(d.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(i.ArrowLeft,{className:"h-5 w-5"})})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold mb-1 flex items-center gap-2",children:[(0,b.jsx)(j.GraduationCap,{className:"h-8 w-8 text-brand-blue"}),"Configuration LMS"]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Paramétrez l'intégration avec votre plateforme d'apprentissage en ligne"})]})]}),(0,b.jsx)(d.Button,{onClick:()=>{z.mutate(v)},disabled:z.isPending,children:z.isPending?"Enregistrement...":"Enregistrer"})]}),(0,b.jsxs)(c.Card,{children:[(0,b.jsxs)(c.CardHeader,{children:[(0,b.jsx)(c.CardTitle,{children:"Paramètres de connexion"}),(0,b.jsx)(c.CardDescription,{children:"Configurez la connexion à votre plateforme LMS (Moodle, Canvas, etc.)"})]}),(0,b.jsxs)(c.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(f.Label,{htmlFor:"provider",children:"Plateforme LMS"}),(0,b.jsxs)("select",{id:"provider",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-blue",value:v.provider,onChange:a=>w({...v,provider:a.target.value}),children:[(0,b.jsx)("option",{value:"moodle",children:"Moodle"}),(0,b.jsx)("option",{value:"canvas",children:"Canvas"}),(0,b.jsx)("option",{value:"blackboard",children:"Blackboard"}),(0,b.jsx)("option",{value:"other",children:"Autre"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(f.Label,{htmlFor:"api_url",children:"URL de l'API"}),(0,b.jsx)(e.Input,{id:"api_url",value:v.api_url,onChange:a=>w({...v,api_url:a.target.value}),placeholder:"Ex: https://lms.example.com/api"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(f.Label,{htmlFor:"api_key",children:"Clé API"}),(0,b.jsx)(e.Input,{id:"api_key",type:"password",value:v.api_key,onChange:a=>w({...v,api_key:a.target.value}),placeholder:"Votre clé API sécurisée"})]})]})]}),(0,b.jsxs)(c.Card,{className:"mt-6",children:[(0,b.jsxs)(c.CardHeader,{children:[(0,b.jsx)(c.CardTitle,{children:"Paramètres de synchronisation"}),(0,b.jsx)(c.CardDescription,{children:"Gérez la synchronisation automatique des données avec votre LMS"})]}),(0,b.jsxs)(c.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(g.Switch,{checked:v.is_active,onCheckedChange:a=>w({...v,is_active:a})}),(0,b.jsx)(f.Label,{htmlFor:"is_active",children:"Activer l'intégration LMS"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(g.Switch,{checked:v.auto_sync,onCheckedChange:a=>w({...v,auto_sync:a}),disabled:!v.is_active}),(0,b.jsx)(f.Label,{htmlFor:"auto_sync",children:"Synchronisation automatique"})]}),v.auto_sync&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(f.Label,{htmlFor:"sync_frequency",children:"Fréquence de synchronisation"}),(0,b.jsxs)("select",{id:"sync_frequency",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-blue",value:v.sync_frequency,onChange:a=>w({...v,sync_frequency:a.target.value}),children:[(0,b.jsx)("option",{value:"hourly",children:"Horaire"}),(0,b.jsx)("option",{value:"daily",children:"Quotidienne"}),(0,b.jsx)("option",{value:"weekly",children:"Hebdomadaire"}),(0,b.jsx)("option",{value:"manual",children:"Manuelle"})]})]})]})]}),(0,b.jsxs)(c.Card,{className:"mt-6",children:[(0,b.jsx)(c.CardHeader,{children:(0,b.jsxs)(c.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Info,{className:"h-5 w-5 text-brand-blue"}),"Informations"]})}),(0,b.jsx)(c.CardContent,{children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"La configuration LMS permet de synchroniser automatiquement les données entre votre plateforme d'apprentissage en ligne et EDUZEN. Les cours, les inscriptions et les notes peuvent être synchronisés selon la fréquence configurée."})})]})]})}a.s(["default",()=>s])}];

//# sourceMappingURL=_6a88b590._.js.map