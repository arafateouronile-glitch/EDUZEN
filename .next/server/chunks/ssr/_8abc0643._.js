module.exports=[915618,a=>{"use strict";let b=(0,a.i(170106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],915618)},219897,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);a.i(460355);var e=a.i(346271);let f=c.forwardRef(({className:a,variant:c="default",hoverable:f=!1,glow:g=!1,glowColor:h="rgba(51, 90, 207, 0.3)",...i},j)=>(0,b.jsxs)(e.motion.div,{ref:j,className:(0,d.cn)("relative rounded-2xl border backdrop-blur-xl transition-all duration-300",{"bg-white/70 dark:bg-gray-900/70 border-white/20 dark:border-gray-700/30 shadow-lg":"default"===c,"bg-white/80 dark:bg-gray-900/80 border-white/30 dark:border-gray-700/40 shadow-xl":"premium"===c,"bg-white/50 dark:bg-gray-900/50 border-white/10 dark:border-gray-700/20 shadow-md":"subtle"===c,"cursor-pointer":f,"hover:shadow-2xl hover:scale-[1.02]":f,"hover:bg-white/90 dark:hover:bg-gray-900/90":f},a),whileHover:f?{scale:1.02,y:-2}:void 0,transition:{type:"spring",stiffness:300,damping:30},...i,children:[g&&(0,b.jsx)(e.motion.div,{className:"absolute inset-0 rounded-2xl opacity-0 blur-xl",style:{background:`radial-gradient(circle, ${h} 0%, transparent 70%)`},animate:{opacity:[0,.5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"}}),(0,b.jsx)("div",{className:"relative z-10",children:i.children})]}));f.displayName="GlassCard",a.s(["GlassCard",()=>f])},495756,a=>{"use strict";let b=(0,a.i(170106).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],495756)},724669,a=>{"use strict";let b=(0,a.i(170106).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);a.s(["TrendingUp",()=>b],724669)},790166,a=>{"use strict";let b=(0,a.i(170106).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);a.s(["DollarSign",()=>b],790166)},491829,a=>{"use strict";var b=a.i(187924),c=a.i(913216),d=a.i(50944),e=a.i(572131);let f=(0,a.i(170106).default)("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);var g=a.i(340695),h=a.i(703130),i=a.i(238246);function j({children:a,allowedRoles:j,fallback:k,redirectTo:l="/dashboard"}){let{user:m,isLoading:n}=(0,c.useAuth)(),o=(0,d.useRouter)(),[p,q]=(0,e.useState)(null);return((0,e.useEffect)(()=>{if(!n&&m){let a=m.role||"",b=j.includes(a);q(b),b||!l||k||o.push(l)}},[m,n,j,l,o,k]),n||null===p)?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[200px]",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-blue"})}):p?(0,b.jsx)(b.Fragment,{children:a}):k?(0,b.jsx)(b.Fragment,{children:k}):(0,b.jsx)("div",{className:"container mx-auto py-16 px-4",children:(0,b.jsx)(h.Card,{className:"max-w-md mx-auto",children:(0,b.jsxs)(h.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,b.jsx)(f,{className:"h-8 w-8 text-red-600"})}),(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Accès non autorisé"}),(0,b.jsx)("p",{className:"text-gray-600 mb-6",children:"Vous n'avez pas les permissions nécessaires pour accéder à cette page."}),(0,b.jsx)(i.default,{href:"/dashboard",children:(0,b.jsx)(g.Button,{children:"Retour au tableau de bord"})})]})})})}a.s(["ADMIN_ROLES",0,["super_admin","admin","secretary","accountant"],"FINANCE_ROLES",0,["super_admin","admin","secretary","accountant"],"FORMATION_MANAGEMENT_ROLES",0,["super_admin","admin","secretary"],"RoleGuard",()=>j],491829)},482520,(a,b,c)=>{"use strict";b.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},324560,(a,b,c)=>{"use strict";var d=a.r(482520);function e(){}function f(){}f.resetWarningCache=e,b.exports=function(){function a(a,b,c,e,f,g){if(g!==d){var h=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}function b(){return a}a.isRequired=a;var c={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:b,element:a,elementType:a,instanceOf:b,node:a,objectOf:b,oneOf:b,oneOfType:b,shape:b,exact:b,checkPropTypes:f,resetWarningCache:e};return c.PropTypes=c,c}},341212,(a,b,c)=>{b.exports=a.r(324560)()},651442,a=>{"use strict";let{getOwnPropertyNames:b,getOwnPropertySymbols:c}=Object,{hasOwnProperty:d}=Object.prototype;function e(a,b){return function(c,d,e){return a(c,d,e)&&b(c,d,e)}}function f(a){return function(b,c,d){if(!b||!c||"object"!=typeof b||"object"!=typeof c)return a(b,c,d);let{cache:e}=d,f=e.get(b),g=e.get(c);if(f&&g)return f===c&&g===b;e.set(b,c),e.set(c,b);let h=a(b,c,d);return e.delete(b),e.delete(c),h}}function g(a){return b(a).concat(c(a))}let h=Object.hasOwn||((a,b)=>d.call(a,b));function i(a,b){return a===b||!a&&!b&&a!=a&&b!=b}let{getOwnPropertyDescriptor:j,keys:k}=Object;function l(a,b){return a.byteLength===b.byteLength&&x(new Uint8Array(a),new Uint8Array(b))}function m(a,b,c){let d=a.length;if(b.length!==d)return!1;for(;d-- >0;)if(!c.equals(a[d],b[d],d,d,a,b,c))return!1;return!0}function n(a,b){return a.byteLength===b.byteLength&&x(new Uint8Array(a.buffer,a.byteOffset,a.byteLength),new Uint8Array(b.buffer,b.byteOffset,b.byteLength))}function o(a,b){return i(a.getTime(),b.getTime())}function p(a,b){return a.name===b.name&&a.message===b.message&&a.cause===b.cause&&a.stack===b.stack}function q(a,b){return a===b}function r(a,b,c){let d,e,f=a.size;if(f!==b.size)return!1;if(!f)return!0;let g=Array(f),h=a.entries(),i=0;for(;(d=h.next())&&!d.done;){let f=b.entries(),h=!1,j=0;for(;(e=f.next())&&!e.done;){if(g[j]){j++;continue}let f=d.value,k=e.value;if(c.equals(f[0],k[0],i,j,a,b,c)&&c.equals(f[1],k[1],f[0],k[0],a,b,c)){h=g[j]=!0;break}j++}if(!h)return!1;i++}return!0}function s(a,b,c){let d=k(a),e=d.length;if(k(b).length!==e)return!1;for(;e-- >0;)if(!z(a,b,c,d[e]))return!1;return!0}function t(a,b,c){let d,e,f,h=g(a),i=h.length;if(g(b).length!==i)return!1;for(;i-- >0;)if(!z(a,b,c,d=h[i])||(e=j(a,d),f=j(b,d),(e||f)&&(!e||!f||e.configurable!==f.configurable||e.enumerable!==f.enumerable||e.writable!==f.writable)))return!1;return!0}function u(a,b){return i(a.valueOf(),b.valueOf())}function v(a,b){return a.source===b.source&&a.flags===b.flags}function w(a,b,c){let d,e,f=a.size;if(f!==b.size)return!1;if(!f)return!0;let g=Array(f),h=a.values();for(;(d=h.next())&&!d.done;){let f=b.values(),h=!1,i=0;for(;(e=f.next())&&!e.done;){if(!g[i]&&c.equals(d.value,e.value,d.value,e.value,a,b,c)){h=g[i]=!0;break}i++}if(!h)return!1}return!0}function x(a,b){let c=a.byteLength;if(b.byteLength!==c||a.byteOffset!==b.byteOffset)return!1;for(;c-- >0;)if(a[c]!==b[c])return!1;return!0}function y(a,b){return a.hostname===b.hostname&&a.pathname===b.pathname&&a.protocol===b.protocol&&a.port===b.port&&a.hash===b.hash&&a.username===b.username&&a.password===b.password}function z(a,b,c,d){return("_owner"===d||"__o"===d||"__v"===d)&&(!!a.$$typeof||!!b.$$typeof)||h(b,d)&&c.equals(a[d],b[d],d,d,a,b,c)}let A={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},B=Object.prototype.toString,C=D();function D(a={}){let{circular:b=!1,createInternalComparator:c,createState:d,strict:g=!1}=a,h=function({areArrayBuffersEqual:a,areArraysEqual:b,areDataViewsEqual:c,areDatesEqual:d,areErrorsEqual:e,areFunctionsEqual:f,areMapsEqual:g,areNumbersEqual:h,areObjectsEqual:i,arePrimitiveWrappersEqual:j,areRegExpsEqual:k,areSetsEqual:l,areTypedArraysEqual:m,areUrlsEqual:n,unknownTagComparators:o}){return function(p,q,r){if(p===q)return!0;if(null==p||null==q)return!1;let s=typeof p;if(s!==typeof q)return!1;if("object"!==s)return"number"===s?h(p,q,r):"function"===s&&f(p,q,r);let t=p.constructor;if(t!==q.constructor)return!1;if(t===Object)return i(p,q,r);if(Array.isArray(p))return b(p,q,r);if(t===Date)return d(p,q,r);if(t===RegExp)return k(p,q,r);if(t===Map)return g(p,q,r);if(t===Set)return l(p,q,r);let u=B.call(p);if("[object Date]"===u)return d(p,q,r);if("[object RegExp]"===u)return k(p,q,r);if("[object Map]"===u)return g(p,q,r);if("[object Set]"===u)return l(p,q,r);if("[object Object]"===u)return"function"!=typeof p.then&&"function"!=typeof q.then&&i(p,q,r);if("[object URL]"===u)return n(p,q,r);if("[object Error]"===u)return e(p,q,r);if("[object Arguments]"===u)return i(p,q,r);if(A[u])return m(p,q,r);if("[object ArrayBuffer]"===u)return a(p,q,r);if("[object DataView]"===u)return c(p,q,r);if("[object Boolean]"===u||"[object Number]"===u||"[object String]"===u)return j(p,q,r);if(o){let a=o[u];if(!a){let b=null!=p?p[Symbol.toStringTag]:void 0;b&&(a=o[b])}if(a)return a(p,q,r)}return!1}}(function({circular:a,createCustomConfig:b,strict:c}){let d={areArrayBuffersEqual:l,areArraysEqual:c?t:m,areDataViewsEqual:n,areDatesEqual:o,areErrorsEqual:p,areFunctionsEqual:q,areMapsEqual:c?e(r,t):r,areNumbersEqual:i,areObjectsEqual:c?t:s,arePrimitiveWrappersEqual:u,areRegExpsEqual:v,areSetsEqual:c?e(w,t):w,areTypedArraysEqual:c?e(x,t):x,areUrlsEqual:y,unknownTagComparators:void 0};if(b&&(d=Object.assign({},d,b(d))),a){let a=f(d.areArraysEqual),b=f(d.areMapsEqual),c=f(d.areObjectsEqual),e=f(d.areSetsEqual);d=Object.assign({},d,{areArraysEqual:a,areMapsEqual:b,areObjectsEqual:c,areSetsEqual:e})}return d}(a)),j=c?c(h):function(a,b,c,d,e,f,g){return h(a,b,g)};return function({circular:a,comparator:b,createState:c,equals:d,strict:e}){if(c)return function(f,g){let{cache:h=a?new WeakMap:void 0,meta:i}=c();return b(f,g,{cache:h,equals:d,meta:i,strict:e})};if(a)return function(a,c){return b(a,c,{cache:new WeakMap,equals:d,meta:void 0,strict:e})};let f={cache:void 0,equals:d,meta:void 0,strict:e};return function(a,c){return b(a,c,f)}}({circular:b,comparator:h,createState:d,equals:j,strict:g})}D({strict:!0}),D({circular:!0}),D({circular:!0,strict:!0}),D({createInternalComparator:()=>i}),D({strict:!0,createInternalComparator:()=>i}),D({circular:!0,createInternalComparator:()=>i}),D({circular:!0,createInternalComparator:()=>i,strict:!0}),a.s(["deepEqual",()=>C])},806368,a=>{"use strict";var b=a.i(187924),c=a.i(572131),d=a.i(497895);a.i(460355);var e=a.i(346271);let f=c.forwardRef(({className:a,columns:c=4,gap:e="md",children:f,...g},h)=>(0,b.jsx)("div",{ref:h,className:(0,d.cn)("grid",{1:"grid-cols-1",2:"grid-cols-1 md:grid-cols-2",3:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3",4:"grid-cols-1 md:grid-cols-2 lg:grid-cols-4"}[c],{sm:"gap-4",md:"gap-6",lg:"gap-8"}[e],a),...g,children:f}));f.displayName="BentoGrid";let g=c.forwardRef(({className:a,span:c=1,rowSpan:f=1,children:g,...h},i)=>(0,b.jsx)(e.motion.div,{ref:i,className:(0,d.cn)({1:"col-span-1",2:"col-span-1 md:col-span-2",3:"col-span-1 md:col-span-2 lg:col-span-3",4:"col-span-1 md:col-span-2 lg:col-span-4"}[c],{1:"row-span-1",2:"row-span-1 md:row-span-2",3:"row-span-1 md:row-span-3"}[f],a),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:[.16,1,.3,1]},...h,children:g}));g.displayName="BentoCard",a.s(["BentoCard",()=>g,"BentoGrid",()=>f])},501199,a=>{"use strict";let b=(0,a.i(170106).default)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);a.s(["Receipt",()=>b],501199)},767552,a=>{"use strict";let b=(0,a.i(170106).default)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);a.s(["ChevronUp",()=>b],767552)},452218,571907,a=>{"use strict";var b,c,d=a.i(325383),e=((b={}).AUTH_REQUIRED="AUTH_1001",b.AUTH_INVALID_CREDENTIALS="AUTH_1002",b.AUTH_SESSION_EXPIRED="AUTH_1003",b.AUTH_INSUFFICIENT_PERMISSIONS="AUTH_1004",b.AUTH_2FA_REQUIRED="AUTH_1005",b.AUTH_2FA_INVALID="AUTH_1006",b.VALIDATION_ERROR="VALID_2001",b.VALIDATION_REQUIRED_FIELD="VALID_2002",b.VALIDATION_INVALID_FORMAT="VALID_2003",b.VALIDATION_UNIQUE_CONSTRAINT="VALID_2004",b.DB_CONNECTION_ERROR="DB_3001",b.DB_QUERY_ERROR="DB_3002",b.DB_NOT_FOUND="DB_3003",b.DB_CONSTRAINT_VIOLATION="DB_3004",b.DB_FOREIGN_KEY_CONSTRAINT="DB_3006",b.DB_RLS_POLICY_VIOLATION="DB_3005",b.NETWORK_ERROR="NET_4001",b.API_TIMEOUT="NET_4002",b.API_RATE_LIMIT="NET_4003",b.API_SERVER_ERROR="NET_4004",b.API_NOT_FOUND="NET_4005",b.API_BAD_REQUEST="NET_4006",b.BUSINESS_LOGIC_ERROR="BIZ_5001",b.RESOURCE_LOCKED="BIZ_5002",b.OPERATION_NOT_ALLOWED="BIZ_5003",b.QUOTA_EXCEEDED="BIZ_5004",b.INTERNAL_ERROR="SYS_6001",b.CONFIGURATION_ERROR="SYS_6002",b.SERVICE_UNAVAILABLE="SYS_6003",b);(c={}).LOW="low",c.MEDIUM="medium",c.HIGH="high",c.CRITICAL="critical";class f extends Error{code;severity;userMessage;retryable;context;originalError;constructor(a,b="SYS_6001",c="medium",d={},e){super(a),this.name="AppError",this.code=b,this.severity=c,this.userMessage=d.userMessage||this.getDefaultUserMessage(b),this.retryable=d.retryable??this.isRetryable(b),this.context={...d,code:b,severity:c,timestamp:new Date().toISOString()},this.originalError=e,Error.captureStackTrace&&Error.captureStackTrace(this,f)}getDefaultUserMessage(a){return({AUTH_1001:"Vous devez être connecté pour effectuer cette action.",AUTH_1002:"Email ou mot de passe incorrect.",AUTH_1003:"Votre session a expiré. Veuillez vous reconnecter.",AUTH_1004:"Vous n'avez pas les permissions nécessaires.",AUTH_1005:"Authentification à deux facteurs requise.",AUTH_1006:"Code d'authentification invalide.",VALID_2001:"Les données fournies ne sont pas valides.",VALID_2002:"Certains champs obligatoires sont manquants.",VALID_2003:"Le format des données est incorrect.",VALID_2004:"Cette valeur existe déjà.",DB_3001:"Impossible de se connecter à la base de données.",DB_3002:"Erreur lors de l'exécution de la requête.",DB_3003:"Ressource introuvable.",DB_3004:"Cette opération viole une contrainte de la base de données.",DB_3006:"Cette opération viole une contrainte de clé étrangère.",DB_3005:"Vous n'avez pas accès à cette ressource.",NET_4001:"Erreur de connexion réseau. Vérifiez votre connexion internet.",NET_4002:"La requête a pris trop de temps. Veuillez réessayer.",NET_4003:"Trop de requêtes. Veuillez patienter quelques instants.",NET_4004:"Erreur serveur. Veuillez réessayer plus tard.",NET_4005:"Ressource introuvable.",NET_4006:"Requête invalide.",BIZ_5001:"Cette opération n'est pas autorisée dans le contexte actuel.",BIZ_5002:"Cette ressource est actuellement verrouillée.",BIZ_5003:"Cette opération n'est pas autorisée.",BIZ_5004:"Vous avez atteint la limite autorisée.",SYS_6001:"Une erreur interne est survenue. Veuillez réessayer.",SYS_6002:"Erreur de configuration du système.",SYS_6003:"Service temporairement indisponible."})[a]||"Une erreur inattendue est survenue."}isRetryable(a){return["NET_4001","NET_4002","NET_4004","DB_3001","SYS_6003"].includes(a)}toJSON(){return{name:this.name,message:this.message,code:this.code,severity:this.severity,userMessage:this.userMessage,retryable:this.retryable,context:this.context,stack:this.stack,originalError:this.originalError instanceof Error?{name:this.originalError.name,message:this.originalError.message,stack:this.originalError.stack}:this.originalError}}}let g=new class{handleError(a,b={}){if(a instanceof f)return this.logError(a),a;if(a instanceof Error)return this.handleStandardError(a,b);if(this.isSupabaseError(a))return this.handleSupabaseError(a,b);let c=new f("Une erreur inattendue est survenue.","SYS_6001","high",b,a);return this.logError(c),c}handleStandardError(a,b){let c=a.message.toLowerCase(),d="SYS_6001",e="medium";c.includes("network")||c.includes("fetch")?(d="NET_4001",e="medium"):c.includes("timeout")?(d="NET_4002",e="medium"):c.includes("unauthorized")||c.includes("401")?(d="AUTH_1001",e="high"):c.includes("forbidden")||c.includes("403")?(d="AUTH_1004",e="high"):c.includes("not found")||c.includes("404")?(d="DB_3003",e="low"):(c.includes("validation")||c.includes("invalid"))&&(d="VALID_2001",e="low");let g=new f(a.message,d,e,b,a);return this.logError(g),g}handleSupabaseError(a,b){let c=a.code||a.status,d=a.message||"Erreur Supabase",e=b.code||"DB_3002",g="medium";if(!b.code)switch(c){case"PGRST116":case"42P01":e="DB_3003",g="low";break;case"42501":e="DB_3005",g="high";break;case"23505":e="VALID_2004",g="low";break;case"23503":e="DB_3004",g="medium";break;case"PGRST301":case"400":e="NET_4006",g="low";break;case"401":e="AUTH_1001",g="high";break;case"403":e="AUTH_1004",g="high";break;case"404":e="NET_4005",g="low";break;case"500":e="NET_4004",g="high"}"DB_3006"===e&&(g="medium");let h=new f(d,e,g,b,a);return this.logError(h),h}isSupabaseError(a){return a&&(a.code||a.status||a.message)&&("string"==typeof a.code||"number"==typeof a.status)}logError(a){let b={...a.context,code:a.code,severity:a.severity,retryable:a.retryable};switch(a.severity){case"critical":case"high":d.logger.error(a.message,a.originalError||a,b);break;case"medium":d.logger.warn(a.message,b);break;case"low":d.logger.info(`Error: ${a.message}`,b)}}createValidationError(a,b){return new f(a,"VALID_2001","low",{field:b,userMessage:a})}createAuthError(a,b){return new f(b||"Erreur d'authentification",a,"high")}createDatabaseError(a,b){return new f(a,"DB_3002","medium",{},b)}createNotFoundError(a,b){return new f(a,"DB_3003","low",b)}};a.s(["AppError",()=>f,"ErrorCode",()=>e,"errorHandler",0,g],571907),a.s([],452218)},49492,a=>{"use strict";a.i(452218);var b=a.i(571907);async function c(a,c,d,e){try{let f=a.from(c).select(e?.select||"*").eq("organization_id",d);e?.filters&&Object.entries(e.filters).forEach(([a,b])=>{null!=b&&(f=f.eq(a,b))}),e?.search&&(f=f.ilike(e.search.field,`%${e.search.value}%`)),f=e?.orderBy?f.order(e.orderBy.column,{ascending:e.orderBy.ascending??!1}):f.order("created_at",{ascending:!1});let{data:g,error:h}=await f;if(h)throw b.errorHandler.handleError(h,{organizationId:d,operation:"getAllByOrganization",table:c});return g||[]}catch(a){if(a instanceof b.AppError)throw a;throw b.errorHandler.handleError(a,{organizationId:d,operation:"getAllByOrganization",table:c})}}async function d(a,c,d,e){try{let{data:f,error:g}=await a.from(c).select(e||"*").eq("id",d).single();if(g){if("PGRST116"===g.code||"42P01"===g.code)throw b.errorHandler.handleError(g,{code:b.ErrorCode.DB_NOT_FOUND,operation:"getById",id:d,table:c});throw b.errorHandler.handleError(g,{operation:"getById",id:d,table:c})}if(!f)throw b.errorHandler.createDatabaseError(`Enregistrement avec l'ID ${d} introuvable dans ${c}`,{id:d,table:c});return f}catch(a){if(a instanceof b.AppError)throw a;throw b.errorHandler.handleError(a,{operation:"getById",id:d,table:c})}}a.s(["getAllByOrganization",()=>c,"getById",()=>d])},697662,a=>{"use strict";a.i(452218);var b=a.i(571907);function c(a,c){for(let d of c)if(!a[d])throw b.errorHandler.createValidationError(`Le champ ${String(d)} est obligatoire`,String(d))}a.s(["validateRequired",()=>c])},908403,a=>{"use strict";var b=a.i(269240);a.i(452218);var c=a.i(571907),d=a.i(325383),e=a.i(49492),f=a.i(697662);let g=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getAll(a,b){try{let c={};return b?.studentId&&(c.student_id=b.studentId),b?.status&&(c.status=b.status),b?.documentType&&(c.document_type=b.documentType),(0,e.getAllByOrganization)(this.supabase,"invoices",a,{select:"*, students(id, first_name, last_name, student_number), payments(id, amount, status, paid_at)",filters:c,search:b?.search?{field:"invoice_number",value:b.search}:void 0,orderBy:{column:"issue_date",ascending:!1}})}catch(b){if(b instanceof c.AppError)throw b;throw c.errorHandler.handleError(b,{organizationId:a,operation:"getAll"})}}async getById(a){try{return(0,e.getById)(this.supabase,"invoices",a,"*, students(*), enrollments(*), payments(*)")}catch(b){if(b instanceof c.AppError)throw b;throw c.errorHandler.handleError(b,{operation:"getById",id:a})}}async generateInvoiceNumber(a,b="invoice"){let c=new Date().getFullYear().toString(),{data:d}=await this.supabase.from("invoices").select("invoice_number").eq("organization_id",a).eq("document_type",b).like("invoice_number",`${c}-%`).order("invoice_number",{ascending:!1}).limit(1).maybeSingle(),e=1;if(d?.invoice_number){let a=d.invoice_number.split("-");a.length>=2&&a[0]===c&&(e=parseInt(a[1]||"0",10)+1)}return`${c}-${String(e).padStart(3,"0")}`}async create(a){try{(0,f.validateRequired)(a,["organization_id","student_id"]);let b=a.invoice_number;if(!b||""===b.trim()){let d=a.organization_id;if(!d)throw c.errorHandler.createValidationError("Organization ID is required to create an invoice.");b=await this.generateInvoiceNumber(d,a.document_type||"invoice")}let{data:e,error:g}=await this.supabase.from("invoices").insert({...a,invoice_number:b}).select().single();if(g){if("23505"===g.code)throw c.errorHandler.handleError(g,{code:c.ErrorCode.VALIDATION_UNIQUE_CONSTRAINT,operation:"create",field:"invoice_number"});if("42501"===g.code)throw c.errorHandler.handleError(g,{code:c.ErrorCode.DB_RLS_POLICY_VIOLATION,operation:"create"});throw c.errorHandler.handleError(g,{operation:"create",invoice:a})}return d.logger.info("Facture créée avec succès",{id:e?.id,organizationId:a.organization_id||void 0,invoiceNumber:e?.invoice_number}),e}catch(b){if(b instanceof c.AppError)throw b;throw c.errorHandler.handleError(b,{operation:"create",invoice:a})}}async update(a,b){try{let{data:e,error:f}=await this.supabase.from("invoices").update(b).eq("id",a).select().single();if(f){if("PGRST116"===f.code||"42P01"===f.code)throw c.errorHandler.handleError(f,{code:c.ErrorCode.DB_NOT_FOUND,operation:"update",id:a});if("42501"===f.code)throw c.errorHandler.handleError(f,{code:c.ErrorCode.DB_RLS_POLICY_VIOLATION,operation:"update",id:a});throw c.errorHandler.handleError(f,{operation:"update",id:a,updates:b})}if(!e)throw c.errorHandler.createDatabaseError(`Facture avec l'ID ${a} introuvable pour la mise \xe0 jour`,{id:a});return d.logger.info("Facture mise à jour avec succès",{id:a,updates:b}),e}catch(d){if(d instanceof c.AppError)throw d;throw c.errorHandler.handleError(d,{operation:"update",id:a,updates:b})}}async generateForClass(a,b,e,f,g,h="tuition"){let{data:i,error:j}=await this.supabase.from("students").select("id").eq("organization_id",a).eq("class_id",b).eq("status","active");if(j)throw c.errorHandler.handleError(j,{operation:"generateForClass",organizationId:a,classId:b,step:"fetchStudents"});if(!i||0===i.length)throw c.errorHandler.createValidationError("Aucun élève actif dans cette classe","classId");let{data:k}=await this.supabase.from("organizations").select("code").eq("id",a).single(),l=k?.code||"ORG",m=new Date().getFullYear().toString().slice(-2),{data:n}=await this.supabase.from("invoices").select("invoice_number").eq("organization_id",a).like("invoice_number",`FAC-${l}-${m}-%`).order("invoice_number",{ascending:!1}).limit(1).maybeSingle(),o=1;if(n?.invoice_number){let a=n.invoice_number.split("-");o=parseInt(a[a.length-1]||"0")+1}let p=i.map((b,c)=>({organization_id:a,student_id:b.id,invoice_number:`FAC-${l}-${m}-${String(o+c).padStart(6,"0")}`,type:h,document_type:"invoice",issue_date:new Date().toISOString().split("T")[0],due_date:g,amount:e,tax_amount:0,total_amount:e,currency:f,status:"draft",items:[]})),{data:q,error:r}=await this.supabase.from("invoices").insert(p).select();if(r)throw c.errorHandler.handleError(r,{operation:"generateForClass",organizationId:a,classId:b,count:p.length});return d.logger.info("Factures générées en masse avec succès",{organizationId:a,classId:b,count:q?.length||0}),q||[]}async getOverdue(a){let b=new Date().toISOString().split("T")[0];try{let{data:d,error:e}=await this.supabase.from("invoices").select("*, students(id, first_name, last_name, student_number)").eq("organization_id",a).eq("document_type","invoice").in("status",["sent","partial"]).lt("due_date",b).order("due_date",{ascending:!0});if(e)throw c.errorHandler.handleError(e,{operation:"getOverdue",organizationId:a});return d||[]}catch(b){if(b instanceof c.AppError)throw b;throw c.errorHandler.handleError(b,{operation:"getOverdue",organizationId:a})}}async convertQuoteToInvoice(a){try{let{data:b,error:e}=await this.supabase.from("invoices").select("*").eq("id",a).eq("document_type","quote").single();if(e){if("PGRST116"===e.code||"42P01"===e.code)throw c.errorHandler.handleError(e,{code:c.ErrorCode.DB_NOT_FOUND,operation:"convertQuoteToInvoice",quoteId:a});throw c.errorHandler.handleError(e,{operation:"convertQuoteToInvoice",quoteId:a,step:"fetchQuote"})}if(!b)throw c.errorHandler.createDatabaseError(`Devis avec l'ID ${a} introuvable`,{quoteId:a});let{data:f,error:g}=await this.supabase.from("invoices").update({document_type:"invoice",status:"draft",issue_date:b.issue_date||new Date().toISOString().split("T")[0]}).eq("id",a).select().single();if(g)throw c.errorHandler.handleError(g,{operation:"convertQuoteToInvoice",quoteId:a,step:"updateInvoice"});return d.logger.info("Devis converti en facture avec succès",{quoteId:a,invoiceId:f?.id}),f}catch(b){if(b instanceof c.AppError)throw b;throw c.errorHandler.handleError(b,{operation:"convertQuoteToInvoice",quoteId:a})}}};a.s(["invoiceService",0,g])},922520,a=>{"use strict";let b=(0,a.i(170106).default)("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);a.s(["ArrowUpRight",()=>b],922520)},172162,a=>{"use strict";let b=(0,a.i(170106).default)("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);a.s(["SlidersHorizontal",()=>b],172162)},457431,677924,a=>{"use strict";var b=a.i(424231),c=a.i(572131),d=a.i(517615),e=a.i(425496),f=a.i(216575),g=a.i(966217),h=a.i(298621),i=a.i(813667),j=a.i(825428),k=a.i(488949),l=a.i(736319),m=a.i(66235),n=a.i(768932),o=a.i(137082),p=a.i(902321),q=a.i(747838),r=["type","layout","connectNulls","ref"],s=["key"];function t(a){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function u(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c={};for(var d in a)if(Object.prototype.hasOwnProperty.call(a,d)){if(b.indexOf(d)>=0)continue;c[d]=a[d]}return c}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(b.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}function v(){return(v=Object.assign.bind()).apply(this,arguments)}function w(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function x(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?w(Object(c),!0).forEach(function(b){E(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):w(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function y(a){return function(a){if(Array.isArray(a))return z(a)}(a)||function(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}(a)||function(a,b){if(a){if("string"==typeof a)return z(a,void 0);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c)return Array.from(a);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return z(a,void 0)}}(a)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function A(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,F(d.key),d)}}function B(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(B=function(){return!!a})()}function C(a){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function D(a,b){return(D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a})(a,b)}function E(a,b,c){return(b=F(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function F(a){var b=function(a,b){if("object"!=t(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=t(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==t(b)?b:b+""}var G=function(a){var b,p;function w(){var a,b,c;if(!(this instanceof w))throw TypeError("Cannot call a class as a function");for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return b=w,c=[].concat(e),b=C(b),E(a=function(a,b){if(b&&("object"===t(b)||"function"==typeof b))return b;if(void 0!==b)throw TypeError("Derived constructors may only return object or undefined");var c=a;if(void 0===c)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(this,B()?Reflect.construct(b,c||[],C(this).constructor):b.apply(this,c)),"state",{isAnimationFinished:!0,totalLength:0}),E(a,"generateSimpleStrokeDasharray",function(a,b){return"".concat(b,"px ").concat(a-b,"px")}),E(a,"getStrokeDasharray",function(b,c,d){var e=d.reduce(function(a,b){return a+b});if(!e)return a.generateSimpleStrokeDasharray(c,b);for(var f=Math.floor(b/e),g=b%e,h=c-b,i=[],j=0,k=0;j<d.length;k+=d[j],++j)if(k+d[j]>g){i=[].concat(y(d.slice(0,j)),[g-k]);break}var l=i.length%2==0?[0,h]:[h];return[].concat(y(w.repeat(d,f)),y(i),l).map(function(a){return"".concat(a,"px")}).join(", ")}),E(a,"id",(0,n.uniqueId)("recharts-line-")),E(a,"pathRef",function(b){a.mainCurve=b}),E(a,"handleAnimationEnd",function(){a.setState({isAnimationFinished:!0}),a.props.onAnimationEnd&&a.props.onAnimationEnd()}),E(a,"handleAnimationStart",function(){a.setState({isAnimationFinished:!1}),a.props.onAnimationStart&&a.props.onAnimationStart()}),a}if("function"!=typeof a&&null!==a)throw TypeError("Super expression must either be null or a function");return w.prototype=Object.create(a&&a.prototype,{constructor:{value:w,writable:!0,configurable:!0}}),Object.defineProperty(w,"prototype",{writable:!1}),a&&D(w,a),b=[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var a=this.getTotalLength();this.setState({totalLength:a})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var a=this.getTotalLength();a!==this.state.totalLength&&this.setState({totalLength:a})}}},{key:"getTotalLength",value:function(){var a=this.mainCurve;try{return a&&a.getTotalLength&&a.getTotalLength()||0}catch(a){return 0}}},{key:"renderErrorBar",value:function(a,b){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var d=this.props,e=d.points,f=d.xAxis,g=d.yAxis,h=d.layout,i=d.children,j=(0,o.findAllByType)(i,m.ErrorBar);if(!j)return null;var l=function(a,b){return{x:a.x,y:a.y,value:a.value,errorVal:(0,q.getValueByDataKey)(a.payload,b)}};return c.default.createElement(k.Layer,{clipPath:a?"url(#clipPath-".concat(b,")"):null},j.map(function(a){return c.default.cloneElement(a,{key:"bar-".concat(a.props.dataKey),data:e,xAxis:f,yAxis:g,layout:h,dataPointFormatter:l})}))}},{key:"renderDots",value:function(a,b,d){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var e=this.props,f=e.dot,g=e.points,h=e.dataKey,i=(0,o.filterProps)(this.props,!1),j=(0,o.filterProps)(f,!0),l=g.map(function(a,b){var c=x(x(x({key:"dot-".concat(b),r:3},i),j),{},{index:b,cx:a.x,cy:a.y,value:a.value,dataKey:h,payload:a.payload,points:g});return w.renderDotItem(f,c)}),m={clipPath:a?"url(#clipPath-".concat(b?"":"dots-").concat(d,")"):null};return c.default.createElement(k.Layer,v({className:"recharts-line-dots",key:"dots"},m),l)}},{key:"renderCurveStatically",value:function(a,b,d,e){var f=this.props,g=f.type,h=f.layout,j=f.connectNulls,k=(f.ref,u(f,r)),l=x(x(x({},(0,o.filterProps)(k,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:b?"url(#clipPath-".concat(d,")"):null,points:a},e),{},{type:g,layout:h,connectNulls:j});return c.default.createElement(i.Curve,v({},l,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(a,b){var e=this,f=this.props,g=f.points,h=f.strokeDasharray,i=f.isAnimationActive,j=f.animationBegin,k=f.animationDuration,l=f.animationEasing,m=f.animationId,o=f.animateNewValues,p=f.width,q=f.height,r=this.state,s=r.prevPoints,t=r.totalLength;return c.default.createElement(d.default,{begin:j,duration:k,isActive:i,easing:l,from:{t:0},to:{t:1},key:"line-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(c){var d,f=c.t;if(s){var i=s.length/g.length,j=g.map(function(a,b){var c=Math.floor(b*i);if(s[c]){var d=s[c],e=(0,n.interpolateNumber)(d.x,a.x),g=(0,n.interpolateNumber)(d.y,a.y);return x(x({},a),{},{x:e(f),y:g(f)})}if(o){var h=(0,n.interpolateNumber)(2*p,a.x),j=(0,n.interpolateNumber)(q/2,a.y);return x(x({},a),{},{x:h(f),y:j(f)})}return x(x({},a),{},{x:a.x,y:a.y})});return e.renderCurveStatically(j,a,b)}var k=(0,n.interpolateNumber)(0,t)(f);if(h){var l="".concat(h).split(/[,\s]+/gim).map(function(a){return parseFloat(a)});d=e.getStrokeDasharray(k,t,l)}else d=e.generateSimpleStrokeDasharray(t,k);return e.renderCurveStatically(g,a,b,{strokeDasharray:d})})}},{key:"renderCurve",value:function(a,b){var c=this.props,d=c.points,e=c.isAnimationActive,f=this.state,h=f.prevPoints,i=f.totalLength;return e&&d&&d.length&&(!h&&i>0||!(0,g.default)(h,d))?this.renderCurveWithAnimation(a,b):this.renderCurveStatically(d,a,b)}},{key:"render",value:function(){var a,b=this.props,d=b.hide,e=b.dot,g=b.points,i=b.className,j=b.xAxis,m=b.yAxis,n=b.top,p=b.left,q=b.width,r=b.height,s=b.isAnimationActive,t=b.id;if(d||!g||!g.length)return null;var u=this.state.isAnimationFinished,v=1===g.length,w=(0,h.default)("recharts-line",i),x=j&&j.allowDataOverflow,y=m&&m.allowDataOverflow,z=x||y,A=(0,f.default)(t)?this.id:t,B=null!=(a=(0,o.filterProps)(e,!1))?a:{r:3,strokeWidth:2},C=B.r,D=B.strokeWidth,E=((0,o.hasClipDot)(e)?e:{}).clipDot,F=void 0===E||E,G=2*(void 0===C?3:C)+(void 0===D?2:D);return c.default.createElement(k.Layer,{className:w},x||y?c.default.createElement("defs",null,c.default.createElement("clipPath",{id:"clipPath-".concat(A)},c.default.createElement("rect",{x:x?p:p-q/2,y:y?n:n-r/2,width:x?q:2*q,height:y?r:2*r})),!F&&c.default.createElement("clipPath",{id:"clipPath-dots-".concat(A)},c.default.createElement("rect",{x:p-G/2,y:n-G/2,width:q+G,height:r+G}))):null,!v&&this.renderCurve(z,A),this.renderErrorBar(z,A),(v||e)&&this.renderDots(z,F,A),(!s||u)&&l.LabelList.renderCallByParent(this.props,g))}}],p=[{key:"getDerivedStateFromProps",value:function(a,b){return a.animationId!==b.prevAnimationId?{prevAnimationId:a.animationId,curPoints:a.points,prevPoints:b.curPoints}:a.points!==b.curPoints?{curPoints:a.points}:null}},{key:"repeat",value:function(a,b){for(var c=a.length%2!=0?[].concat(y(a),[0]):a,d=[],e=0;e<b;++e)d=[].concat(y(d),y(c));return d}},{key:"renderDotItem",value:function(a,b){var d;if(c.default.isValidElement(a))d=c.default.cloneElement(a,b);else if((0,e.default)(a))d=a(b);else{var f=b.key,g=u(b,s),i=(0,h.default)("recharts-line-dot","boolean"!=typeof a?a.className:"");d=c.default.createElement(j.Dot,v({key:f},g,{className:i}))}return d}}],b&&A(w.prototype,b),p&&A(w,p),Object.defineProperty(w,"prototype",{writable:!1}),w}(c.PureComponent);E(G,"displayName","Line"),E(G,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!p.Global.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1}),E(G,"getComposedData",function(a){var b=a.props,c=a.xAxis,d=a.yAxis,e=a.xAxisTicks,g=a.yAxisTicks,h=a.dataKey,i=a.bandSize,j=a.displayedData,k=a.offset,l=b.layout;return x({points:j.map(function(a,b){var j=(0,q.getValueByDataKey)(a,h);return"horizontal"===l?{x:(0,q.getCateCoordinateOfLine)({axis:c,ticks:e,bandSize:i,entry:a,index:b}),y:(0,f.default)(j)?null:d.scale(j),value:j,payload:a}:{x:(0,f.default)(j)?null:c.scale(j),y:(0,q.getCateCoordinateOfLine)({axis:d,ticks:g,bandSize:i,entry:a,index:b}),value:j,payload:a}}),layout:l},k)}),a.s(["Line",()=>G],677924);var H=a.i(758042),I=a.i(994222),J=a.i(199738),K=(0,b.generateCategoricalChart)({chartName:"LineChart",GraphicalChild:G,axisComponents:[{axisType:"xAxis",AxisComp:H.XAxis},{axisType:"yAxis",AxisComp:I.YAxis}],formatAxisMap:J.formatAxisMap});a.s(["LineChart",()=>K],457431)},371791,653277,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getCategories(a){let{data:b,error:c}=await this.supabase.from("charge_categories").select("*").eq("organization_id",a).eq("is_active",!0).order("name",{ascending:!0});return c?(console.error("Erreur récupération catégories:",c),[]):b||[]}async createCategory(a,b){let{data:c,error:d}=await this.supabase.from("charge_categories").insert({...b,organization_id:a}).select().single();if(d)throw d;return c}async initDefaultCategories(a){let{error:b}=await this.supabase.rpc("init_default_charge_categories",{p_organization_id:a});if(b)throw b}async getBySession(a){let{data:b,error:c}=await this.supabase.from("session_charges").select(`
        *,
        charge_categories(*)
      `).eq("session_id",a).order("charge_date",{ascending:!1});return c?(console.error("Erreur récupération charges:",c),[]):b||[]}async getAll(a,b){let c=this.supabase.from("session_charges").select(`
        *,
        charge_categories(*),
        sessions(id, name)
      `).eq("organization_id",a);b?.sessionId&&(c=c.eq("session_id",b.sessionId)),b?.categoryId&&(c=c.eq("category_id",b.categoryId)),b?.paymentStatus&&(c=c.eq("payment_status",b.paymentStatus)),b?.startDate&&(c=c.gte("charge_date",b.startDate)),b?.endDate&&(c=c.lte("charge_date",b.endDate));let{data:d,error:e}=await c.order("charge_date",{ascending:!1});return e?(console.error("Erreur récupération charges:",e),[]):d||[]}async getById(a){let{data:b,error:c}=await this.supabase.from("session_charges").select(`
        *,
        charge_categories(*),
        sessions(id, name)
      `).eq("id",a).single();if(c){if("PGRST116"===c.code)return null;throw c}return b}async create(a,b,c){let{data:d,error:e}=await this.supabase.from("session_charges").insert({...c,organization_id:a,session_id:b}).select(`
        *,
        charge_categories(*)
      `).single();if(e)throw e;return d}async update(a,b){let{data:c,error:d}=await this.supabase.from("session_charges").update(b).eq("id",a).select(`
        *,
        charge_categories(*)
      `).single();if(d)throw d;return c}async delete(a){let{error:b}=await this.supabase.from("session_charges").delete().eq("id",a);if(b)throw b}async getSessionSummary(a){let{data:b,error:c}=await this.supabase.rpc("calculate_session_charges_total",{p_session_id:a});return c?(console.error("Erreur calcul résumé charges:",c),null):b&&0!==b.length?{total_amount:Number(b[0].total_amount)||0,paid_amount:Number(b[0].paid_amount)||0,pending_amount:Number(b[0].pending_amount)||0,charge_count:Number(b[0].charge_count)||0}:{total_amount:0,paid_amount:0,pending_amount:0,charge_count:0}}};a.s(["sessionChargesService",0,c],371791);let d=(0,a.i(170106).default)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);a.s(["TrendingDown",()=>d],653277)}];

//# sourceMappingURL=_8abc0643._.js.map