module.exports=[400210,a=>{"use strict";let b=(0,a.i(170106).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],400210)},641710,a=>{"use strict";let b=(0,a.i(170106).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],641710)},495756,a=>{"use strict";let b=(0,a.i(170106).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],495756)},54018,a=>{"use strict";let b=(0,a.i(170106).default)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],54018)},692759,a=>{"use strict";let b=(0,a.i(170106).default)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);a.s(["Send",()=>b],692759)},821374,a=>{"use strict";let b=(0,a.i(170106).default)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);a.s(["Star",()=>b],821374)},146673,a=>{"use strict";var b=a.i(269240);let c=new class{supabase;constructor(a){this.supabase=a||(0,b.createClient)()}async getCategories(a){let{data:b,error:c}=await this.supabase.from("support_categories").select("*").eq("organization_id",a).eq("is_active",!0).order("order_index",{ascending:!0});if(c){if("PGRST116"===c.code||"42P01"===c.code||"PGRST301"===c.code||404===c.status||"404"===c.code||c.message?.includes("relation")||c.message?.includes("relationship")||c.message?.includes("does not exist")||c.message?.includes("schema cache"))return console.warn("Table support_categories does not exist yet or invalid query:",c?.message),[];throw c}return b||[]}async createCategory(a){let{data:b,error:c}=await this.supabase.from("support_categories").insert(a).select().single();if(c)throw c;return b}async updateCategory(a,b){let{data:c,error:d}=await this.supabase.from("support_categories").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteCategory(a){let{error:b}=await this.supabase.from("support_categories").delete().eq("id",a);if(b)throw b}async getTickets(a,b){let c=this.supabase.from("support_tickets").select(`
        *,
        user:users(id, full_name, email),
        assigned_user:users!support_tickets_assigned_to_fkey(id, full_name, email),
        category:support_categories(*)
      `).eq("organization_id",a);b?.userId&&(c=c.eq("user_id",b.userId)),b?.status&&(c=c.eq("status",b.status)),b?.priority&&(c=c.eq("priority",b.priority)),b?.categoryId&&(c=c.eq("category_id",b.categoryId)),b?.assignedTo&&(c=c.eq("assigned_to",b.assignedTo));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e){if("PGRST116"===e.code||"42P01"===e.code||"PGRST301"===e.code||404===e.status||400===e.status||"404"===e.code||"400"===e.code||e.message?.includes("relation")||e.message?.includes("relationship")||e.message?.includes("does not exist")||e.message?.includes("schema cache")||e.message?.includes("Could not find a relationship"))return[];throw e}return d||[]}async getTicketById(a){let{data:b,error:c}=await this.supabase.from("support_tickets").select(`
        *,
        user:users(id, full_name, email),
        assigned_user:users!support_tickets_assigned_to_fkey(id, full_name, email),
        category:support_categories(*)
      `).eq("id",a).single();if(c)throw c;return b}async createTicket(a){let{data:b,error:c}=await this.supabase.from("support_tickets").insert(a).select().single();if(c)throw c;return b}async updateTicket(a,b){let{data:c,error:d}=await this.supabase.from("support_tickets").update(b).eq("id",a).select().single();if(d)throw d;return c}async assignTicket(a,b){return this.updateTicket(a,{assigned_to:b,assigned_at:new Date().toISOString(),status:"in_progress"})}async resolveTicket(a){return this.updateTicket(a,{status:"resolved",resolved_at:new Date().toISOString()})}async closeTicket(a){return this.updateTicket(a,{status:"closed",closed_at:new Date().toISOString()})}async getTicketMessages(a){let{data:b,error:c}=await this.supabase.from("support_ticket_messages").select(`
        *,
        user:users(id, full_name, email)
      `).eq("ticket_id",a).order("created_at",{ascending:!0});if(c)throw c;return b}async createMessage(a){let{data:b,error:c}=await this.supabase.from("support_ticket_messages").insert(a).select(`
        *,
        user:users(id, full_name, email)
      `).single();if(c)throw c;return b}async markMessageAsRead(a){let{data:b,error:c}=await this.supabase.from("support_ticket_messages").update({is_read:!0,read_at:new Date().toISOString()}).eq("id",a).select().single();if(c)throw c;return b}async getTicketNotes(a){let{data:b,error:c}=await this.supabase.from("support_ticket_notes").select(`
        *,
        user:users(id, full_name, email)
      `).eq("ticket_id",a).order("created_at",{ascending:!1});if(c)throw c;return b}async createNote(a){let{data:b,error:c}=await this.supabase.from("support_ticket_notes").insert(a).select(`
        *,
        user:users(id, full_name, email)
      `).single();if(c)throw c;return b}async updateNote(a,b){let{data:c,error:d}=await this.supabase.from("support_ticket_notes").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteNote(a){let{error:b}=await this.supabase.from("support_ticket_notes").delete().eq("id",a);if(b)throw b}async createRating(a){let{data:b,error:c}=await this.supabase.from("support_ticket_ratings").insert(a).select().single();if(c)throw c;return b}async getTicketRating(a){let{data:b,error:c}=await this.supabase.from("support_ticket_ratings").select("*").eq("ticket_id",a).maybeSingle();if(c)throw c;return b}async getTemplates(a){let{data:b,error:c}=await this.supabase.from("support_response_templates").select("*").eq("organization_id",a).eq("is_active",!0).order("name",{ascending:!0});if(c)throw c;return b}async createTemplate(a){let{data:b,error:c}=await this.supabase.from("support_response_templates").insert(a).select().single();if(c)throw c;return b}async updateTemplate(a,b){let{data:c,error:d}=await this.supabase.from("support_response_templates").update(b).eq("id",a).select().single();if(d)throw d;return c}async deleteTemplate(a){let{error:b}=await this.supabase.from("support_response_templates").delete().eq("id",a);if(b)throw b}async getStatistics(a,b){let c=this.supabase.from("support_tickets").select("status, priority, created_at, resolved_at, first_response_at").eq("organization_id",a);b?.startDate&&(c=c.gte("created_at",b.startDate)),b?.endDate&&(c=c.lte("created_at",b.endDate));let{data:d,error:e}=await c;if(e)throw e;let f=d||[],g={total:f.length,byStatus:{open:0,in_progress:0,waiting_customer:0,resolved:0,closed:0},byPriority:{low:0,medium:0,high:0,urgent:0},averageResponseTime:0,averageResolutionTime:0,resolutionRate:0},h=0,i=0,j=0,k=0,l=0;return f.forEach(a=>{if(a.status&&a.status in g.byStatus&&g.byStatus[a.status]++,a.priority&&a.priority in g.byPriority&&g.byPriority[a.priority]++,a.first_response_at&&a.created_at){let b=new Date(a.first_response_at).getTime()-new Date(a.created_at).getTime();h+=b,i++}if(a.resolved_at&&a.created_at){let b=new Date(a.resolved_at).getTime()-new Date(a.created_at).getTime();j+=b,k++}("resolved"===a.status||"closed"===a.status)&&l++}),i>0&&(g.averageResponseTime=h/i/6e4),k>0&&(g.averageResolutionTime=j/k/36e5),d.length>0&&(g.resolutionRate=l/d.length*100),g}};a.s(["supportService",0,c])}];

//# sourceMappingURL=_449761ee._.js.map