{"version":3,"sources":["../../../node_modules/next/src/server/route-modules/app-page/vendored/rsc/react-server-dom-turbopack-server.ts","../../../lib/supabase/client.ts/__nextjs-internal-proxy.mjs","../../../lib/utils/logger.ts","../../../lib/errors/error-handler.ts","../../../lib/services/email.service.ts","../../../lib/utils/supabase-helpers.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-rsc']!.ReactServerDOMTurbopackServer\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const createClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call createClient() from the server but createClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/lib/supabase/client.ts\",\n    \"createClient\",\n);\n","/**\n * Logger centralis√© pour l'application Eduzen\n * \n * Fournit une interface unifi√©e pour le logging avec :\n * - Niveaux de log (error, warn, info, debug)\n * - Support pour services externes (Sentry, LogRocket)\n * - Formatage coh√©rent\n * - Mode d√©veloppement vs production\n */\n\ntype LogLevel = 'error' | 'warn' | 'info' | 'debug'\n\ninterface LogContext {\n  userId?: string\n  organizationId?: string\n  sessionId?: string\n  [key: string]: unknown\n}\n\nclass Logger {\n  private isDevelopment = process.env.NODE_ENV === 'development'\n  private isProduction = process.env.NODE_ENV === 'production'\n  private sentryEnabled = !!process.env.NEXT_PUBLIC_SENTRY_DSN\n\n  /**\n   * Initialise Sentry si disponible\n   */\n  private initSentry() {\n    if (this.sentryEnabled && typeof window !== 'undefined') {\n      // Lazy load Sentry pour √©viter d'augmenter la taille du bundle\n      import('@sentry/nextjs').then((Sentry) => {\n        try {\n          // V√©rifier si Sentry est d√©j√† initialis√© en essayant d'acc√©der au client\n          // Si ce n'est pas le cas, l'initialiser\n          Sentry.init({\n            dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,\n            environment: process.env.NODE_ENV,\n            tracesSampleRate: 0.1, // 10% des transactions\n            beforeSend(event) {\n              // Filtrer les erreurs sensibles\n              if (event.request?.headers) {\n                delete event.request.headers['authorization']\n                delete event.request.headers['cookie']\n              }\n              return event\n            },\n          })\n        } catch (e) {\n          // Sentry d√©j√† initialis√© ou erreur, continuer sans\n        }\n      }).catch(() => {\n        // Sentry non disponible, continuer sans\n      })\n    }\n  }\n\n  constructor() {\n    if (this.sentryEnabled) {\n      this.initSentry()\n    }\n  }\n\n  /**\n   * Log une erreur avec contexte optionnel\n   */\n  error(message: string, error?: Error | unknown, context?: LogContext) {\n    const logData = {\n      message,\n      error: error instanceof Error ? {\n        name: error.name,\n        message: error.message,\n        stack: error.stack,\n      } : error,\n      context,\n      timestamp: new Date().toISOString(),\n      level: 'error' as LogLevel,\n    }\n\n    // En production, envoyer vers Sentry si disponible\n    if (this.isProduction && this.sentryEnabled && typeof window !== 'undefined') {\n      import('@sentry/nextjs').then((Sentry) => {\n        if (error instanceof Error) {\n          Sentry.captureException(error, {\n            extra: {\n              message,\n              context,\n            },\n            tags: {\n              source: 'logger',\n            },\n          })\n        } else {\n          Sentry.captureMessage(message, {\n            level: 'error',\n            extra: {\n              error,\n              context,\n            },\n          })\n        }\n      }).catch(() => {\n        // Sentry non disponible, continuer sans\n      })\n    }\n\n    // Envoyer une alerte pour les erreurs critiques (en production uniquement)\n    if (this.isProduction && message.includes('[CRITICAL]')) {\n      // Import dynamique pour √©viter les d√©pendances circulaires\n      import('@/lib/services/alert.service').then(({ alertService }) => {\n        const errorObj = error instanceof Error ? error : new Error(message)\n        alertService.sendCriticalError(errorObj, {\n          context,\n          timestamp: logData.timestamp,\n        }).catch((err) => {\n          // Ne pas logger l'erreur d'alerte pour √©viter les boucles infinies\n          if (this.isDevelopment) {\n            console.error('Failed to send critical alert:', err)\n          }\n        })\n      }).catch(() => {\n        // Service d'alertes non disponible, continuer sans\n      })\n    }\n\n    // Toujours logger en console pour le d√©veloppement\n    if (this.isDevelopment || !this.isProduction) {\n      console.error('‚ùå [ERROR]', message, {\n        error,\n        context,\n        timestamp: logData.timestamp,\n      })\n    }\n  }\n\n  /**\n   * Log un avertissement\n   */\n  warn(message: string, context?: LogContext) {\n    const logData = {\n      message,\n      context,\n      timestamp: new Date().toISOString(),\n      level: 'warn' as LogLevel,\n    }\n\n    if (this.isDevelopment) {\n      console.warn('‚ö†Ô∏è [WARN]', message, { context, timestamp: logData.timestamp })\n    }\n  }\n\n  /**\n   * Log une information\n   */\n  info(message: string, context?: LogContext) {\n    const logData = {\n      message,\n      context,\n      timestamp: new Date().toISOString(),\n      level: 'info' as LogLevel,\n    }\n\n    if (this.isDevelopment) {\n      console.info('‚ÑπÔ∏è [INFO]', message, { context, timestamp: logData.timestamp })\n    }\n  }\n\n  /**\n   * Log pour le d√©bogage (uniquement en d√©veloppement)\n   */\n  debug(message: string, context?: LogContext) {\n    if (!this.isDevelopment) return\n\n    console.debug('üêõ [DEBUG]', message, {\n      context,\n      timestamp: new Date().toISOString(),\n    })\n  }\n\n  /**\n   * Helper pour logger les erreurs de requ√™te API\n   */\n  apiError(endpoint: string, error: Error | unknown, context?: LogContext) {\n    this.error(`API Error: ${endpoint}`, error, {\n      ...context,\n      endpoint,\n    })\n  }\n\n  /**\n   * Helper pour logger les erreurs de mutation\n   */\n  mutationError(mutationName: string, error: Error | unknown, context?: LogContext) {\n    this.error(`Mutation Error: ${mutationName}`, error, {\n      ...context,\n      mutationName,\n    })\n  }\n\n  /**\n   * Helper pour logger les erreurs de query\n   */\n  queryError(queryKey: string, error: Error | unknown, context?: LogContext) {\n    this.error(`Query Error: ${queryKey}`, error, {\n      ...context,\n      queryKey,\n    })\n  }\n}\n\n// Export d'une instance singleton\nexport const logger = new Logger()\n\n// Export du type pour utilisation dans d'autres fichiers\nexport type { LogContext, LogLevel }\n\n/**\n * Utilitaires pour sanitiser les donn√©es sensibles dans les logs\n */\n\n/**\n * Masque un email (garde 2 premiers caract√®res + domaine)\n */\nexport function maskEmail(email: string | null | undefined): string {\n  if (!email) return '[NO_EMAIL]'\n  const [local, domain] = email.split('@')\n  if (!domain) return '[INVALID_EMAIL]'\n  return `${local.substring(0, 2)}***@${domain}`\n}\n\n/**\n * Masque un ID (garde 8 premiers caract√®res)\n */\nexport function maskId(id: string | null | undefined): string {\n  if (!id) return '[NO_ID]'\n  return id.substring(0, 8) + '...'\n}\n\n/**\n * Masque un token (retourne juste un indicateur)\n */\nexport function maskToken(token: string | null | undefined): string {\n  if (!token) return '[NO_TOKEN]'\n  return '[REDACTED]'\n}\n\n/**\n * Masque un num√©ro de t√©l√©phone (garde 4 derniers chiffres)\n */\nexport function maskPhone(phone: string | null | undefined): string {\n  if (!phone) return '[NO_PHONE]'\n  if (phone.length < 4) return '***'\n  return '***' + phone.slice(-4)\n}\n\n/**\n * Sanitise un objet erreur pour √©viter d'exposer des informations sensibles\n */\nexport function sanitizeError(error: any): Record<string, any> {\n  if (!error) return {}\n\n  return {\n    message: error.message,\n    code: error.code,\n    name: error.name,\n    // Ne pas inclure stack traces en production\n    ...(process.env.NODE_ENV === 'development' ? { stack: error.stack } : {}),\n  }\n}\n\n/**\n * Sanitise un objet utilisateur pour les logs\n */\nexport function sanitizeUser(user: any): Record<string, any> {\n  if (!user) return {}\n\n  return {\n    id: maskId(user.id),\n    email: maskEmail(user.email),\n    role: user.role,\n    organizationId: maskId(user.organization_id),\n  }\n}\n\n/**\n * Sanitise un objet √©tudiant pour les logs\n */\nexport function sanitizeStudent(student: any): Record<string, any> {\n  if (!student) return {}\n\n  return {\n    id: maskId(student.id),\n    email: maskEmail(student.email),\n    firstName: student.first_name ? student.first_name.charAt(0) + '***' : '[NO_NAME]',\n    lastName: student.last_name ? student.last_name.charAt(0) + '***' : '[NO_NAME]',\n  }\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","/**\n * ErrorHandler Global - Gestion centralis√©e des erreurs\n * \n * Fournit :\n * - Types d'erreurs personnalis√©s\n * - Classification automatique des erreurs\n * - Messages utilisateur traduits\n * - Logging automatique\n * - Formatage coh√©rent\n */\n\nimport { logger } from '@/lib/utils/logger'\nimport type { LogContext } from '@/lib/utils/logger'\n\n// ============================================================================\n// TYPES D'ERREURS PERSONNALIS√âS\n// ============================================================================\n\nexport enum ErrorCode {\n  // Erreurs d'authentification (1000-1999)\n  AUTH_REQUIRED = 'AUTH_1001',\n  AUTH_INVALID_CREDENTIALS = 'AUTH_1002',\n  AUTH_SESSION_EXPIRED = 'AUTH_1003',\n  AUTH_INSUFFICIENT_PERMISSIONS = 'AUTH_1004',\n  AUTH_2FA_REQUIRED = 'AUTH_1005',\n  AUTH_2FA_INVALID = 'AUTH_1006',\n\n  // Erreurs de validation (2000-2999)\n  VALIDATION_ERROR = 'VALID_2001',\n  VALIDATION_REQUIRED_FIELD = 'VALID_2002',\n  VALIDATION_INVALID_FORMAT = 'VALID_2003',\n  VALIDATION_UNIQUE_CONSTRAINT = 'VALID_2004',\n\n  // Erreurs de base de donn√©es (3000-3999)\n  DB_CONNECTION_ERROR = 'DB_3001',\n  DB_QUERY_ERROR = 'DB_3002',\n  DB_NOT_FOUND = 'DB_3003',\n  DB_CONSTRAINT_VIOLATION = 'DB_3004',\n  DB_FOREIGN_KEY_CONSTRAINT = 'DB_3006',\n  DB_RLS_POLICY_VIOLATION = 'DB_3005',\n\n  // Erreurs r√©seau/API (4000-4999)\n  NETWORK_ERROR = 'NET_4001',\n  API_TIMEOUT = 'NET_4002',\n  API_RATE_LIMIT = 'NET_4003',\n  API_SERVER_ERROR = 'NET_4004',\n  API_NOT_FOUND = 'NET_4005',\n  API_BAD_REQUEST = 'NET_4006',\n\n  // Erreurs m√©tier (5000-5999)\n  BUSINESS_LOGIC_ERROR = 'BIZ_5001',\n  RESOURCE_LOCKED = 'BIZ_5002',\n  OPERATION_NOT_ALLOWED = 'BIZ_5003',\n  QUOTA_EXCEEDED = 'BIZ_5004',\n\n  // Erreurs syst√®me (6000-6999)\n  INTERNAL_ERROR = 'SYS_6001',\n  CONFIGURATION_ERROR = 'SYS_6002',\n  SERVICE_UNAVAILABLE = 'SYS_6003',\n}\n\nexport enum ErrorSeverity {\n  LOW = 'low',\n  MEDIUM = 'medium',\n  HIGH = 'high',\n  CRITICAL = 'critical',\n}\n\nexport interface AppErrorContext extends LogContext {\n  code?: ErrorCode\n  severity?: ErrorSeverity\n  userMessage?: string\n  retryable?: boolean\n  timestamp?: string\n}\n\n/**\n * Classe d'erreur personnalis√©e pour l'application\n */\nexport class AppError extends Error {\n  public readonly code: ErrorCode\n  public readonly severity: ErrorSeverity\n  public readonly userMessage: string\n  public readonly retryable: boolean\n  public readonly context: AppErrorContext\n  public readonly originalError?: Error | unknown\n\n  constructor(\n    message: string,\n    code: ErrorCode = ErrorCode.INTERNAL_ERROR,\n    severity: ErrorSeverity = ErrorSeverity.MEDIUM,\n    context: AppErrorContext = {},\n    originalError?: Error | unknown\n  ) {\n    super(message)\n    this.name = 'AppError'\n    this.code = code\n    this.severity = severity\n    this.userMessage = context.userMessage || this.getDefaultUserMessage(code)\n    this.retryable = context.retryable ?? this.isRetryable(code)\n    this.context = {\n      ...context,\n      code,\n      severity,\n      timestamp: new Date().toISOString(),\n    }\n    this.originalError = originalError\n\n    // Maintenir la stack trace\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, AppError)\n    }\n  }\n\n  /**\n   * Messages utilisateur par d√©faut selon le code d'erreur\n   */\n  private getDefaultUserMessage(code: ErrorCode): string {\n    const messages: Record<ErrorCode, string> = {\n      // Auth\n      [ErrorCode.AUTH_REQUIRED]: 'Vous devez √™tre connect√© pour effectuer cette action.',\n      [ErrorCode.AUTH_INVALID_CREDENTIALS]: 'Email ou mot de passe incorrect.',\n      [ErrorCode.AUTH_SESSION_EXPIRED]: 'Votre session a expir√©. Veuillez vous reconnecter.',\n      [ErrorCode.AUTH_INSUFFICIENT_PERMISSIONS]: \"Vous n'avez pas les permissions n√©cessaires.\",\n      [ErrorCode.AUTH_2FA_REQUIRED]: 'Authentification √† deux facteurs requise.',\n      [ErrorCode.AUTH_2FA_INVALID]: 'Code d\\'authentification invalide.',\n\n      // Validation\n      [ErrorCode.VALIDATION_ERROR]: 'Les donn√©es fournies ne sont pas valides.',\n      [ErrorCode.VALIDATION_REQUIRED_FIELD]: 'Certains champs obligatoires sont manquants.',\n      [ErrorCode.VALIDATION_INVALID_FORMAT]: 'Le format des donn√©es est incorrect.',\n      [ErrorCode.VALIDATION_UNIQUE_CONSTRAINT]: 'Cette valeur existe d√©j√†.',\n\n      // Database\n      [ErrorCode.DB_CONNECTION_ERROR]: 'Impossible de se connecter √† la base de donn√©es.',\n      [ErrorCode.DB_QUERY_ERROR]: 'Erreur lors de l\\'ex√©cution de la requ√™te.',\n      [ErrorCode.DB_NOT_FOUND]: 'Ressource introuvable.',\n      [ErrorCode.DB_CONSTRAINT_VIOLATION]: 'Cette op√©ration viole une contrainte de la base de donn√©es.',\n      [ErrorCode.DB_FOREIGN_KEY_CONSTRAINT]: 'Cette op√©ration viole une contrainte de cl√© √©trang√®re.',\n      [ErrorCode.DB_RLS_POLICY_VIOLATION]: 'Vous n\\'avez pas acc√®s √† cette ressource.',\n\n      // Network\n      [ErrorCode.NETWORK_ERROR]: 'Erreur de connexion r√©seau. V√©rifiez votre connexion internet.',\n      [ErrorCode.API_TIMEOUT]: 'La requ√™te a pris trop de temps. Veuillez r√©essayer.',\n      [ErrorCode.API_RATE_LIMIT]: 'Trop de requ√™tes. Veuillez patienter quelques instants.',\n      [ErrorCode.API_SERVER_ERROR]: 'Erreur serveur. Veuillez r√©essayer plus tard.',\n      [ErrorCode.API_NOT_FOUND]: 'Ressource introuvable.',\n      [ErrorCode.API_BAD_REQUEST]: 'Requ√™te invalide.',\n\n      // Business\n      [ErrorCode.BUSINESS_LOGIC_ERROR]: 'Cette op√©ration n\\'est pas autoris√©e dans le contexte actuel.',\n      [ErrorCode.RESOURCE_LOCKED]: 'Cette ressource est actuellement verrouill√©e.',\n      [ErrorCode.OPERATION_NOT_ALLOWED]: 'Cette op√©ration n\\'est pas autoris√©e.',\n      [ErrorCode.QUOTA_EXCEEDED]: 'Vous avez atteint la limite autoris√©e.',\n\n      // System\n      [ErrorCode.INTERNAL_ERROR]: 'Une erreur interne est survenue. Veuillez r√©essayer.',\n      [ErrorCode.CONFIGURATION_ERROR]: 'Erreur de configuration du syst√®me.',\n      [ErrorCode.SERVICE_UNAVAILABLE]: 'Service temporairement indisponible.',\n    }\n\n    return messages[code] || 'Une erreur inattendue est survenue.'\n  }\n\n  /**\n   * D√©termine si une erreur est retryable selon son code\n   */\n  private isRetryable(code: ErrorCode): boolean {\n    const retryableCodes = [\n      ErrorCode.NETWORK_ERROR,\n      ErrorCode.API_TIMEOUT,\n      ErrorCode.API_SERVER_ERROR,\n      ErrorCode.DB_CONNECTION_ERROR,\n      ErrorCode.SERVICE_UNAVAILABLE,\n    ]\n    return retryableCodes.includes(code)\n  }\n\n  /**\n   * Convertit l'erreur en objet JSON pour logging\n   */\n  toJSON() {\n    return {\n      name: this.name,\n      message: this.message,\n      code: this.code,\n      severity: this.severity,\n      userMessage: this.userMessage,\n      retryable: this.retryable,\n      context: this.context,\n      stack: this.stack,\n      originalError: this.originalError instanceof Error\n        ? {\n            name: this.originalError.name,\n            message: this.originalError.message,\n            stack: this.originalError.stack,\n          }\n        : this.originalError,\n    }\n  }\n}\n\n// ============================================================================\n// ERROR HANDLER PRINCIPAL\n// ============================================================================\n\nexport class ErrorHandler {\n  /**\n   * Analyse et classe une erreur inconnue\n   */\n  handleError(error: unknown, context: AppErrorContext = {}): AppError {\n    // Si c'est d√©j√† une AppError, la retourner telle quelle\n    if (error instanceof AppError) {\n      this.logError(error)\n      return error\n    }\n\n    // Si c'est une Error standard, la convertir\n    if (error instanceof Error) {\n      return this.handleStandardError(error, context)\n    }\n\n    // Si c'est une erreur Supabase\n    if (this.isSupabaseError(error)) {\n      return this.handleSupabaseError(error, context)\n    }\n\n    // Erreur inconnue\n    const appError = new AppError(\n      'Une erreur inattendue est survenue.',\n      ErrorCode.INTERNAL_ERROR,\n      ErrorSeverity.HIGH,\n      context,\n      error\n    )\n    this.logError(appError)\n    return appError\n  }\n\n  /**\n   * G√®re les erreurs Error standard\n   */\n  private handleStandardError(error: Error, context: AppErrorContext): AppError {\n    const message = error.message.toLowerCase()\n\n    // D√©tection par message\n    let code = ErrorCode.INTERNAL_ERROR\n    let severity = ErrorSeverity.MEDIUM\n\n    if (message.includes('network') || message.includes('fetch')) {\n      code = ErrorCode.NETWORK_ERROR\n      severity = ErrorSeverity.MEDIUM\n    } else if (message.includes('timeout')) {\n      code = ErrorCode.API_TIMEOUT\n      severity = ErrorSeverity.MEDIUM\n    } else if (message.includes('unauthorized') || message.includes('401')) {\n      code = ErrorCode.AUTH_REQUIRED\n      severity = ErrorSeverity.HIGH\n    } else if (message.includes('forbidden') || message.includes('403')) {\n      code = ErrorCode.AUTH_INSUFFICIENT_PERMISSIONS\n      severity = ErrorSeverity.HIGH\n    } else if (message.includes('not found') || message.includes('404')) {\n      code = ErrorCode.DB_NOT_FOUND\n      severity = ErrorSeverity.LOW\n    } else if (message.includes('validation') || message.includes('invalid')) {\n      code = ErrorCode.VALIDATION_ERROR\n      severity = ErrorSeverity.LOW\n    }\n\n    const appError = new AppError(error.message, code, severity, context, error)\n    this.logError(appError)\n    return appError\n  }\n\n  /**\n   * G√®re les erreurs Supabase\n   */\n  private handleSupabaseError(error: any, context: AppErrorContext): AppError {\n    const code = error.code || error.status\n    const message = error.message || 'Erreur Supabase'\n\n    // Si un code d'erreur est fourni dans le contexte, l'utiliser en priorit√©\n    let errorCode = context.code || ErrorCode.DB_QUERY_ERROR\n    let severity = ErrorSeverity.MEDIUM\n\n    // Classification par code Supabase (seulement si pas de code dans le contexte)\n    if (!context.code) {\n      switch (code) {\n        case 'PGRST116':\n        case '42P01':\n          errorCode = ErrorCode.DB_NOT_FOUND\n          severity = ErrorSeverity.LOW\n          break\n        case '42501':\n          errorCode = ErrorCode.DB_RLS_POLICY_VIOLATION\n          severity = ErrorSeverity.HIGH\n          break\n        case '23505':\n          errorCode = ErrorCode.VALIDATION_UNIQUE_CONSTRAINT\n          severity = ErrorSeverity.LOW\n          break\n        case '23503':\n          errorCode = ErrorCode.DB_CONSTRAINT_VIOLATION\n          severity = ErrorSeverity.MEDIUM\n          break\n        case 'PGRST301':\n        case '400':\n          errorCode = ErrorCode.API_BAD_REQUEST\n          severity = ErrorSeverity.LOW\n          break\n        case '401':\n          errorCode = ErrorCode.AUTH_REQUIRED\n          severity = ErrorSeverity.HIGH\n          break\n        case '403':\n          errorCode = ErrorCode.AUTH_INSUFFICIENT_PERMISSIONS\n          severity = ErrorSeverity.HIGH\n          break\n        case '404':\n          errorCode = ErrorCode.API_NOT_FOUND\n          severity = ErrorSeverity.LOW\n          break\n        case '500':\n          errorCode = ErrorCode.API_SERVER_ERROR\n          severity = ErrorSeverity.HIGH\n          break\n      }\n    }\n\n    // Ajuster la s√©v√©rit√© selon le code d'erreur\n    if (errorCode === ErrorCode.DB_FOREIGN_KEY_CONSTRAINT) {\n      severity = ErrorSeverity.MEDIUM\n    }\n\n    const appError = new AppError(message, errorCode, severity, context, error)\n    this.logError(appError)\n    return appError\n  }\n\n  /**\n   * V√©rifie si une erreur est une erreur Supabase\n   */\n  private isSupabaseError(error: any): boolean {\n    return (\n      error &&\n      (error.code || error.status || error.message) &&\n      (typeof error.code === 'string' || typeof error.status === 'number')\n    )\n  }\n\n  /**\n   * Log l'erreur selon sa s√©v√©rit√©\n   */\n  private logError(error: AppError) {\n    const logContext: LogContext = {\n      ...error.context,\n      code: error.code,\n      severity: error.severity,\n      retryable: error.retryable,\n    }\n\n    switch (error.severity) {\n      case ErrorSeverity.CRITICAL:\n      case ErrorSeverity.HIGH:\n        logger.error(error.message, error.originalError || error, logContext)\n        break\n      case ErrorSeverity.MEDIUM:\n        logger.warn(error.message, logContext)\n        break\n      case ErrorSeverity.LOW:\n        logger.info(`Error: ${error.message}`, logContext)\n        break\n    }\n  }\n\n  /**\n   * Cr√©e une erreur de validation\n   */\n  createValidationError(message: string, field?: string): AppError {\n    return new AppError(\n      message,\n      ErrorCode.VALIDATION_ERROR,\n      ErrorSeverity.LOW,\n      { field, userMessage: message }\n    )\n  }\n\n  /**\n   * Cr√©e une erreur d'authentification\n   */\n  createAuthError(code: ErrorCode, message?: string): AppError {\n    return new AppError(\n      message || 'Erreur d\\'authentification',\n      code,\n      ErrorSeverity.HIGH\n    )\n  }\n\n  /**\n   * Cr√©e une erreur de base de donn√©es\n   */\n  createDatabaseError(message: string, originalError?: unknown): AppError {\n    return new AppError(\n      message,\n      ErrorCode.DB_QUERY_ERROR,\n      ErrorSeverity.MEDIUM,\n      {},\n      originalError\n    )\n  }\n\n  /**\n   * Cr√©e une erreur \"Not Found\"\n   */\n  createNotFoundError(message: string, context?: AppErrorContext): AppError {\n    return new AppError(\n      message,\n      ErrorCode.DB_NOT_FOUND,\n      ErrorSeverity.LOW,\n      context\n    )\n  }\n}\n\n// Export d'une instance singleton\nexport const errorHandler = new ErrorHandler()\n\n// Export de fonctions helper pour faciliter l'utilisation\nexport const handleError = (error: unknown, context?: AppErrorContext) =>\n  errorHandler.handleError(error, context)\n\nexport const createValidationError = (message: string, field?: string) =>\n  errorHandler.createValidationError(message, field)\n\nexport const createAuthError = (code: ErrorCode, message?: string) =>\n  errorHandler.createAuthError(code, message)\n\nexport const createDatabaseError = (message: string, originalError?: unknown) =>\n  errorHandler.createDatabaseError(message, originalError)\n\nexport const createNotFoundError = (message: string, context?: AppErrorContext) =>\n  errorHandler.createNotFoundError(message, context)\n\n// Alias pour NotFoundError (compatibilit√©)\nexport const NotFoundError = createNotFoundError\n\n","/**\n * Service d'envoi d'emails\n * \n * Ce service permet d'envoyer des emails avec pi√®ces jointes depuis l'application.\n * \n * Configuration requise :\n * - Installer Resend : npm install resend\n * - Ajouter RESEND_API_KEY dans .env.local\n * - Ou utiliser un autre service d'email (SendGrid, etc.)\n */\n\ninterface EmailAttachment {\n  filename: string\n  content: Blob | ArrayBuffer | string // Base64 ou Blob\n  contentType: string\n}\n\ninterface SendEmailOptions {\n  to: string | string[]\n  subject: string\n  html?: string\n  text?: string\n  attachments?: EmailAttachment[]\n  cc?: string | string[]\n  bcc?: string | string[]\n  replyTo?: string\n}\n\nexport class EmailService {\n  /**\n   * Convertit un Blob en base64\n   */\n  private async blobToBase64(blob: Blob): Promise<string> {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader()\n      reader.onloadend = () => {\n        const base64 = (reader.result as string).split(',')[1]\n        resolve(base64)\n      }\n      reader.onerror = reject\n      reader.readAsDataURL(blob)\n    })\n  }\n\n  /**\n   * Envoie un email avec pi√®ces jointes\n   */\n  async sendEmail(options: SendEmailOptions): Promise<{ success: boolean; message: string }> {\n    try {\n      // Convertir les pi√®ces jointes en base64 si n√©cessaire\n      const attachments = options.attachments\n        ? await Promise.all(\n            options.attachments.map(async (att) => {\n              let content: string\n              if (att.content instanceof Blob) {\n                content = await this.blobToBase64(att.content)\n              } else if (att.content instanceof ArrayBuffer) {\n                const blob = new Blob([att.content], { type: att.contentType })\n                content = await this.blobToBase64(blob)\n              } else {\n                content = att.content\n              }\n\n              return {\n                filename: att.filename,\n                content,\n                contentType: att.contentType,\n              }\n            })\n          )\n        : undefined\n\n      const response = await fetch('/api/email/send', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        credentials: 'include', // Inclure les cookies pour l'authentification\n        body: JSON.stringify({\n          to: options.to,\n          subject: options.subject,\n          html: options.html,\n          text: options.text,\n          attachments,\n          cc: options.cc,\n          bcc: options.bcc,\n          replyTo: options.replyTo,\n        }),\n      })\n\n      if (!response.ok) {\n        const error = await response.json()\n        throw new Error(error.message || 'Erreur lors de l\\'envoi de l\\'email')\n      }\n\n      const data = await response.json()\n      return { success: true, message: data.message || 'Email envoy√© avec succ√®s' }\n    } catch (error) {\n      throw new Error(\n        error instanceof Error\n          ? error.message\n          : 'Erreur lors de l\\'envoi de l\\'email'\n      )\n    }\n  }\n\n  /**\n   * Envoie un document PDF par email\n   */\n  async sendDocument(\n    to: string | string[],\n    subject: string,\n    pdfBlob: Blob,\n    filename: string,\n    htmlBody?: string,\n    textBody?: string\n  ): Promise<{ success: boolean; message: string }> {\n    return this.sendEmail({\n      to,\n      subject,\n      html: htmlBody,\n      text: textBody,\n      attachments: [\n        {\n          filename,\n          content: pdfBlob,\n          contentType: 'application/pdf',\n        },\n      ],\n    })\n  }\n\n  /**\n   * Envoie plusieurs documents par email\n   */\n  async sendMultipleDocuments(\n    to: string | string[],\n    subject: string,\n    documents: Array<{ blob: Blob; filename: string }>,\n    htmlBody?: string,\n    textBody?: string\n  ): Promise<{ success: boolean; message: string }> {\n    return this.sendEmail({\n      to,\n      subject,\n      html: htmlBody,\n      text: textBody,\n      attachments: documents.map((doc) => ({\n        filename: doc.filename,\n        content: doc.blob,\n        contentType: 'application/pdf',\n      })),\n    })\n  }\n}\n\nexport const emailService = new EmailService()\n","/**\n * Helpers r√©utilisables pour les requ√™tes Supabase\n * \n * R√©duit la duplication de code dans les services\n */\n\nimport { SupabaseClient } from '@supabase/supabase-js'\nimport { errorHandler, AppError, ErrorCode } from '@/lib/errors'\n\nexport interface GetAllByOrganizationOptions {\n  filters?: Record<string, unknown>\n  orderBy?: { column: string; ascending?: boolean }\n  select?: string\n  search?: { field: string; value: string }\n}\n\n/**\n * R√©cup√®re tous les enregistrements d'une organisation avec options\n */\nexport async function getAllByOrganization<T>(\n  supabase: SupabaseClient,\n  table: string,\n  organizationId: string,\n  options?: GetAllByOrganizationOptions\n): Promise<T[]> {\n  try {\n    let query = supabase\n      .from(table)\n      .select(options?.select || '*')\n      .eq('organization_id', organizationId)\n\n    // Appliquer les filtres\n    if (options?.filters) {\n      Object.entries(options.filters).forEach(([key, value]) => {\n        if (value !== undefined && value !== null) {\n          query = query.eq(key, value)\n        }\n      })\n    }\n\n    // Appliquer la recherche\n    if (options?.search) {\n      query = query.ilike(options.search.field, `%${options.search.value}%`)\n    }\n\n    // Appliquer le tri\n    if (options?.orderBy) {\n      query = query.order(options.orderBy.column, {\n        ascending: options.orderBy.ascending ?? false,\n      })\n    } else {\n      query = query.order('created_at', { ascending: false })\n    }\n\n    const { data, error } = await query\n\n    if (error) {\n      throw errorHandler.handleError(error, {\n        organizationId,\n        operation: 'getAllByOrganization',\n        table,\n      })\n    }\n\n    return (data || []) as T[]\n  } catch (error) {\n    if (error instanceof AppError) {\n      throw error\n    }\n    throw errorHandler.handleError(error, {\n      organizationId,\n      operation: 'getAllByOrganization',\n      table,\n    })\n  }\n}\n\n/**\n * R√©cup√®re un enregistrement par ID avec gestion d'erreur\n */\nexport async function getById<T>(\n  supabase: SupabaseClient,\n  table: string,\n  id: string,\n  select?: string\n): Promise<T> {\n  try {\n    const { data, error } = await supabase\n      .from(table)\n      .select(select || '*')\n      .eq('id', id)\n      .single()\n\n    if (error) {\n      if (error.code === 'PGRST116' || error.code === '42P01') {\n        throw errorHandler.handleError(error, {\n          code: ErrorCode.DB_NOT_FOUND,\n          operation: 'getById',\n          id,\n          table,\n        })\n      }\n      throw errorHandler.handleError(error, {\n        operation: 'getById',\n        id,\n        table,\n      })\n    }\n\n    if (!data) {\n      throw errorHandler.createDatabaseError(\n        `Enregistrement avec l'ID ${id} introuvable dans ${table}`,\n        { id, table }\n      )\n    }\n\n    return data as T\n  } catch (error) {\n    if (error instanceof AppError) {\n      throw error\n    }\n    throw errorHandler.handleError(error, {\n      operation: 'getById',\n      id,\n      table,\n    })\n  }\n}\n\n"],"names":["module","exports","require","vendored","ReactServerDOMTurbopackServer"],"mappings":"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","ignoreList":[0,1]}