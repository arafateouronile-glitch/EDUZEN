(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,107233,e=>{"use strict";let t=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],107233)},871689,e=>{"use strict";let t=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],871689)},356909,e=>{"use strict";let t=(0,e.i(475254).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);e.s(["Save",()=>t],356909)},569074,e=>{"use strict";let t=(0,e.i(475254).default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);e.s(["Upload",()=>t],569074)},319036,e=>{"use strict";var t=e.i(843476),i=e.i(271645),a=e.i(647163);let r=i.forwardRef(({checked:e,onCheckedChange:i,disabled:r,className:l,...s},n)=>(0,t.jsx)("button",{type:"button",role:"switch","aria-checked":e,ref:n,disabled:r,onClick:()=>i?.(!e),className:(0,a.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",e?"bg-brand-blue":"bg-input",l),...s,children:(0,t.jsx)("span",{className:(0,a.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform",e?"translate-x-5":"translate-x-0")})}));r.displayName="Switch",e.s(["Switch",0,r])},870273,e=>{"use strict";let t=(0,e.i(475254).default)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);e.s(["Star",()=>t],870273)},655900,e=>{"use strict";let t=(0,e.i(475254).default)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);e.s(["ChevronUp",()=>t],655900)},771649,e=>{"use strict";let t=(0,e.i(475254).default)("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);e.s(["Type",()=>t],771649)},750570,e=>{"use strict";let t=(0,e.i(475254).default)("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);e.s(["GripVertical",()=>t],750570)},370956,e=>{"use strict";let t=(0,e.i(475254).default)("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);e.s(["List",()=>t],370956)},684428,e=>{"use strict";let t=(0,e.i(475254).default)("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);e.s(["AlignLeft",()=>t],684428)},88081,878265,e=>{"use strict";var t=e.i(475254);let i=(0,t.default)("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);e.s(["Hash",()=>i],88081);let a=(0,t.default)("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);e.s(["CheckSquare",()=>a],878265)},959868,e=>{"use strict";var t=e.i(843476),i=e.i(271645),a=e.i(618566),r=e.i(954616),l=e.i(266027),s=e.i(325715),n=e.i(920755);let o=new class{supabase;constructor(e){this.supabase=e||(0,n.createClient)()}async getTemplates(e){let{data:t,error:i}=await this.supabase.from("learning_portfolio_templates").select("*").or(`organization_id.eq.${e},organization_id.is.null`).eq("is_active",!0).order("is_default",{ascending:!1}).order("created_at",{ascending:!1});return i?(console.error("Erreur récupération templates:",i),[]):t||[]}async getTemplateById(e){let{data:t,error:i}=await this.supabase.from("learning_portfolio_templates").select("*").eq("id",e).single();return i?(console.error("Erreur récupération template:",i),null):t}async createTemplate(e){let{data:t,error:i}=await this.supabase.from("learning_portfolio_templates").insert(e).select().single();if(i)throw console.error("Erreur création template:",i),i;return t}async updateTemplate(e,t){let{data:i,error:a}=await this.supabase.from("learning_portfolio_templates").update({...t,version:t.version?t.version+1:1}).eq("id",e).select().single();if(a)throw console.error("Erreur mise à jour template:",a),a;return i}async deleteTemplate(e){let{error:t}=await this.supabase.from("learning_portfolio_templates").update({is_active:!1}).eq("id",e);return!t||(console.error("Erreur suppression template:",t),!1)}async getPortfolios(e,t){let i=this.supabase.from("learning_portfolios").select(`
        *,
        template:learning_portfolio_templates(*),
        student:students(id, first_name, last_name, email, photo_url),
        session:sessions(id, name, start_date, end_date)
      `).eq("organization_id",e).order("updated_at",{ascending:!1});t?.studentId&&(i=i.eq("student_id",t.studentId)),t?.sessionId&&(i=i.eq("session_id",t.sessionId)),t?.status&&(i=i.eq("status",t.status)),t?.templateId&&(i=i.eq("template_id",t.templateId));let{data:a,error:r}=await i;return r?(console.error("Erreur récupération portfolios:",r),[]):a||[]}async getPortfolioById(e){let{data:t,error:i}=await this.supabase.from("learning_portfolios").select(`
        *,
        template:learning_portfolio_templates(*),
        student:students(id, first_name, last_name, email, photo_url, phone),
        session:sessions(id, name, start_date, end_date, formations(id, title))
      `).eq("id",e).single();return i?(console.error("Erreur récupération portfolio:",i),null):t}async getStudentPortfolios(e){let{data:t,error:i}=await this.supabase.from("learning_portfolios").select(`
        *,
        template:learning_portfolio_templates(id, name, description, primary_color),
        session:sessions(id, name, formations(id, title))
      `).eq("student_id",e).eq("is_visible_to_student",!0).order("updated_at",{ascending:!1});return i?(console.error("Erreur récupération portfolios étudiant:",i),[]):t||[]}async createPortfolio(e){let{data:t,error:i}=await this.supabase.from("learning_portfolios").insert({...e,status:"draft",progress_percentage:0,started_at:new Date().toISOString()}).select().single();if(i)throw console.error("Erreur création portfolio:",i),i;return t}async updatePortfolio(e,t,i){let{data:a,error:r}=await this.supabase.from("learning_portfolios").update({...t,last_modified_by:i}).eq("id",e).select().single();if(r)throw console.error("Erreur mise à jour portfolio:",r),r;return a}async validatePortfolio(e,t){let{data:i,error:a}=await this.supabase.from("learning_portfolios").update({status:"validated",validated_at:new Date().toISOString(),validated_by:t,is_visible_to_student:!0}).eq("id",e).select().single();if(a)throw console.error("Erreur validation portfolio:",a),a;return i}async getPortfolioEntries(e){let{data:t,error:i}=await this.supabase.from("learning_portfolio_entries").select("*").eq("portfolio_id",e).order("created_at",{ascending:!0});return i?(console.error("Erreur récupération entries:",i),[]):t||[]}async upsertEntry(e){let{data:t,error:i}=await this.supabase.from("learning_portfolio_entries").upsert({...e,evaluated_at:new Date().toISOString()},{onConflict:"portfolio_id,section_id,field_id"}).select().single();if(i)throw console.error("Erreur upsert entry:",i),i;return t}async bulkUpsertEntries(e){let{error:t}=await this.supabase.from("learning_portfolio_entries").upsert(e.map(e=>({...e,evaluated_at:new Date().toISOString()})),{onConflict:"portfolio_id,section_id,field_id"});if(t)throw console.error("Erreur bulk upsert entries:",t),t;return!0}async addSignature(e){let{error:t}=await this.supabase.from("learning_portfolio_signatures").insert({...e,signed_at:new Date().toISOString()});if(t)throw console.error("Erreur ajout signature:",t),t;return!0}async getSignatures(e){let{data:t,error:i}=await this.supabase.from("learning_portfolio_signatures").select("*").eq("portfolio_id",e).order("signed_at",{ascending:!0});return i?(console.error("Erreur récupération signatures:",i),[]):t||[]}getDefaultTemplateStructure(){return[{id:"page_garde",title:"Page de garde",description:"Informations générales sur le livret",icon:"file-text",fields:[{id:"formation_title",label:"Intitulé de la formation",type:"text",required:!0,placeholder:"Ex: CAP Menuisier"},{id:"formation_code",label:"Code formation / RNCP",type:"text",required:!1,placeholder:"Ex: RNCP34567"},{id:"formation_duration",label:"Durée totale de la formation",type:"text",required:!0,placeholder:"Ex: 1200 heures"},{id:"training_period_start",label:"Date de début de formation",type:"date",required:!0},{id:"training_period_end",label:"Date de fin de formation",type:"date",required:!0}]},{id:"identification_apprenant",title:"Identification de l'apprenant",description:"Coordonnées et informations personnelles de l'apprenant",icon:"user",fields:[{id:"learner_civility",label:"Civilité",type:"select",required:!0,options:["M.","Mme","Autre"]},{id:"learner_last_name",label:"Nom de famille",type:"text",required:!0},{id:"learner_first_name",label:"Prénom",type:"text",required:!0},{id:"learner_birth_date",label:"Date de naissance",type:"date",required:!0},{id:"learner_birth_place",label:"Lieu de naissance",type:"text",required:!1},{id:"learner_address",label:"Adresse",type:"textarea",required:!1,placeholder:"Adresse complète"},{id:"learner_phone",label:"Téléphone",type:"text",required:!1},{id:"learner_email",label:"Email",type:"text",required:!1},{id:"learner_photo",label:"Photo d'identité",type:"file",required:!1}]},{id:"organisme_formation",title:"Organisme de formation",description:"Informations sur l'organisme de formation (CFA / OF)",icon:"building",fields:[{id:"of_name",label:"Nom de l'organisme",type:"text",required:!0},{id:"of_address",label:"Adresse",type:"textarea",required:!1},{id:"of_phone",label:"Téléphone",type:"text",required:!1},{id:"of_email",label:"Email",type:"text",required:!1},{id:"of_siret",label:"N° SIRET",type:"text",required:!1},{id:"of_nda",label:"N° de déclaration d'activité",type:"text",required:!1},{id:"referent_pedagogique",label:"Référent pédagogique",type:"text",required:!0},{id:"referent_phone",label:"Téléphone du référent",type:"text",required:!1},{id:"referent_email",label:"Email du référent",type:"text",required:!1}]},{id:"entreprise_accueil",title:"Entreprise d'accueil",description:"Informations sur l'entreprise d'accueil pour l'alternance",icon:"briefcase",fields:[{id:"company_name",label:"Raison sociale",type:"text",required:!0},{id:"company_address",label:"Adresse",type:"textarea",required:!1},{id:"company_phone",label:"Téléphone",type:"text",required:!1},{id:"company_email",label:"Email",type:"text",required:!1},{id:"company_siret",label:"N° SIRET",type:"text",required:!1},{id:"company_activity",label:"Activité principale",type:"text",required:!1},{id:"company_size",label:"Effectif",type:"select",required:!1,options:["1-10","11-50","51-250","251-500","500+"]},{id:"tutor_name",label:"Maître d'apprentissage / Tuteur",type:"text",required:!0},{id:"tutor_function",label:"Fonction du tuteur",type:"text",required:!1},{id:"tutor_phone",label:"Téléphone du tuteur",type:"text",required:!1},{id:"tutor_email",label:"Email du tuteur",type:"text",required:!1}]},{id:"calendrier_alternance",title:"Calendrier de l'alternance",description:"Planning des périodes en entreprise et en formation",icon:"calendar",fields:[{id:"alternance_rhythm",label:"Rythme de l'alternance",type:"text",required:!0,placeholder:"Ex: 2 semaines entreprise / 1 semaine CFA"},{id:"total_hours_company",label:"Heures totales en entreprise",type:"number",required:!1,min:0},{id:"total_hours_training",label:"Heures totales en formation",type:"number",required:!1,min:0},{id:"calendar_notes",label:"Remarques sur le calendrier",type:"textarea",required:!1}]},{id:"objectifs_formation",title:"Objectifs de la formation",description:"Objectifs pédagogiques et professionnels visés",icon:"target",fields:[{id:"main_objectives",label:"Objectifs principaux de la formation",type:"textarea",required:!0,placeholder:"Décrire les objectifs généraux..."},{id:"professional_profile",label:"Profil professionnel visé",type:"textarea",required:!1,placeholder:"Métiers / fonctions visés..."},{id:"specific_objectives",label:"Objectifs spécifiques",type:"textarea",required:!1}]},{id:"referentiel_competences",title:"Référentiel de compétences",description:"Blocs de compétences et capacités à acquérir",icon:"book-open",fields:[{id:"bloc1_title",label:"Bloc 1 - Intitulé",type:"text",required:!0,placeholder:"Ex: Préparation et organisation du chantier"},{id:"bloc1_c1",label:"Bloc 1 - Compétence 1",type:"competency",required:!0,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc1_c2",label:"Bloc 1 - Compétence 2",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc1_c3",label:"Bloc 1 - Compétence 3",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc1_c4",label:"Bloc 1 - Compétence 4",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc2_title",label:"Bloc 2 - Intitulé",type:"text",required:!1,placeholder:"Ex: Réalisation des travaux"},{id:"bloc2_c1",label:"Bloc 2 - Compétence 1",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc2_c2",label:"Bloc 2 - Compétence 2",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc2_c3",label:"Bloc 2 - Compétence 3",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc2_c4",label:"Bloc 2 - Compétence 4",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc3_title",label:"Bloc 3 - Intitulé",type:"text",required:!1,placeholder:"Ex: Contrôle et suivi de la qualité"},{id:"bloc3_c1",label:"Bloc 3 - Compétence 1",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc3_c2",label:"Bloc 3 - Compétence 2",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc3_c3",label:"Bloc 3 - Compétence 3",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]},{id:"bloc3_c4",label:"Bloc 3 - Compétence 4",type:"competency",required:!1,competencyLevels:["Non évalué","Non acquis","En cours","Acquis","Maîtrisé"]}]},{id:"suivi_periodes_entreprise",title:"Suivi des périodes en entreprise",description:"Bilans des périodes réalisées en entreprise",icon:"clipboard-list",fields:[{id:"period1_dates",label:"Période 1 - Dates",type:"text",required:!1,placeholder:"Du ... au ..."},{id:"period1_tasks",label:"Période 1 - Activités réalisées",type:"textarea",required:!1},{id:"period1_evaluation",label:"Période 1 - Évaluation tuteur",type:"rating",required:!1,min:1,max:5},{id:"period1_comments",label:"Période 1 - Observations",type:"textarea",required:!1},{id:"period2_dates",label:"Période 2 - Dates",type:"text",required:!1,placeholder:"Du ... au ..."},{id:"period2_tasks",label:"Période 2 - Activités réalisées",type:"textarea",required:!1},{id:"period2_evaluation",label:"Période 2 - Évaluation tuteur",type:"rating",required:!1,min:1,max:5},{id:"period2_comments",label:"Période 2 - Observations",type:"textarea",required:!1},{id:"period3_dates",label:"Période 3 - Dates",type:"text",required:!1,placeholder:"Du ... au ..."},{id:"period3_tasks",label:"Période 3 - Activités réalisées",type:"textarea",required:!1},{id:"period3_evaluation",label:"Période 3 - Évaluation tuteur",type:"rating",required:!1,min:1,max:5},{id:"period3_comments",label:"Période 3 - Observations",type:"textarea",required:!1}]},{id:"bilans_intermediaires",title:"Bilans intermédiaires",description:"Points d'étape avec l'apprenant, le tuteur et le formateur",icon:"users",fields:[{id:"bilan1_date",label:"Bilan 1 - Date",type:"date",required:!1},{id:"bilan1_progress",label:"Bilan 1 - Progression globale",type:"rating",required:!1,min:1,max:5},{id:"bilan1_strong_points",label:"Bilan 1 - Points forts",type:"textarea",required:!1},{id:"bilan1_improvements",label:"Bilan 1 - Axes d'amélioration",type:"textarea",required:!1},{id:"bilan1_objectives",label:"Bilan 1 - Objectifs pour la prochaine période",type:"textarea",required:!1},{id:"bilan2_date",label:"Bilan 2 - Date",type:"date",required:!1},{id:"bilan2_progress",label:"Bilan 2 - Progression globale",type:"rating",required:!1,min:1,max:5},{id:"bilan2_strong_points",label:"Bilan 2 - Points forts",type:"textarea",required:!1},{id:"bilan2_improvements",label:"Bilan 2 - Axes d'amélioration",type:"textarea",required:!1},{id:"bilan2_objectives",label:"Bilan 2 - Objectifs pour la prochaine période",type:"textarea",required:!1},{id:"bilan3_date",label:"Bilan 3 - Date",type:"date",required:!1},{id:"bilan3_progress",label:"Bilan 3 - Progression globale",type:"rating",required:!1,min:1,max:5},{id:"bilan3_strong_points",label:"Bilan 3 - Points forts",type:"textarea",required:!1},{id:"bilan3_improvements",label:"Bilan 3 - Axes d'amélioration",type:"textarea",required:!1},{id:"bilan3_objectives",label:"Bilan 3 - Objectifs finaux",type:"textarea",required:!1}]},{id:"competences_transversales",title:"Compétences transversales",description:"Savoir-être et compétences transférables",icon:"star",fields:[{id:"punctuality",label:"Ponctualité / Assiduité",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"autonomy",label:"Autonomie",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"initiative",label:"Prise d'initiative",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"teamwork",label:"Travail en équipe",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"communication",label:"Communication",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"adaptability",label:"Adaptabilité",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"safety_rules",label:"Respect des règles de sécurité",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]},{id:"professionalism",label:"Professionnalisme",type:"competency",required:!1,competencyLevels:["Insuffisant","À améliorer","Satisfaisant","Très bien","Excellent"]}]},{id:"evaluations_centre",title:"Évaluations en centre de formation",description:"Résultats des évaluations réalisées au CFA / OF",icon:"file-check",fields:[{id:"eval_general_knowledge",label:"Enseignement général",type:"rating",required:!1,min:0,max:20},{id:"eval_professional",label:"Enseignement professionnel",type:"rating",required:!1,min:0,max:20},{id:"eval_practical",label:"Travaux pratiques",type:"rating",required:!1,min:0,max:20},{id:"eval_project",label:"Projet / Chef-d'œuvre",type:"rating",required:!1,min:0,max:20},{id:"eval_average",label:"Moyenne générale",type:"number",required:!1,min:0,max:20},{id:"eval_comments",label:"Appréciations du conseil pédagogique",type:"textarea",required:!1}]},{id:"bilan_final",title:"Bilan final de la formation",description:"Synthèse et conclusion de la formation",icon:"award",fields:[{id:"final_overall_assessment",label:"Appréciation globale",type:"textarea",required:!0,placeholder:"Synthèse de la formation..."},{id:"final_skills_acquired",label:"Compétences acquises",type:"textarea",required:!1},{id:"final_skills_to_develop",label:"Compétences à approfondir",type:"textarea",required:!1},{id:"final_overall_rating",label:"Évaluation finale globale",type:"rating",required:!1,min:1,max:5},{id:"final_recommendation",label:"Recommandation de poursuite",type:"textarea",required:!1,placeholder:"Recommandations pour la suite..."},{id:"training_result",label:"Résultat de la formation",type:"select",required:!0,options:["Formation validée","Formation partiellement validée","Formation non validée","Abandon"]},{id:"certification_obtained",label:"Certification / Diplôme obtenu",type:"checkbox",required:!1},{id:"certification_date",label:"Date d'obtention",type:"date",required:!1}]},{id:"attestations_documents",title:"Attestations et documents",description:"Documents annexes (habilitations, attestations, etc.)",icon:"folder",fields:[{id:"sst_certificate",label:"Attestation SST (Sauveteur Secouriste du Travail)",type:"checkbox",required:!1},{id:"sst_date",label:"Date d'obtention SST",type:"date",required:!1},{id:"habilitation_electrique",label:"Habilitation électrique",type:"text",required:!1,placeholder:"Ex: B1V, BR..."},{id:"habilitation_date",label:"Date d'obtention habilitation",type:"date",required:!1},{id:"caces",label:"CACES obtenu(s)",type:"text",required:!1,placeholder:"Ex: R489 cat. 3"},{id:"caces_date",label:"Date d'obtention CACES",type:"date",required:!1},{id:"other_certifications",label:"Autres certifications / attestations",type:"textarea",required:!1},{id:"attached_documents",label:"Documents joints",type:"file",required:!1}]},{id:"signatures",title:"Signatures",description:"Validation par les différentes parties",icon:"pen-tool",fields:[{id:"learner_signature_date",label:"Date de signature apprenant",type:"date",required:!1},{id:"learner_signature_comment",label:"Observations de l'apprenant",type:"textarea",required:!1},{id:"tutor_signature_date",label:"Date de signature tuteur entreprise",type:"date",required:!1},{id:"tutor_signature_comment",label:"Observations du tuteur",type:"textarea",required:!1},{id:"trainer_signature_date",label:"Date de signature formateur",type:"date",required:!1},{id:"trainer_signature_comment",label:"Observations du formateur",type:"textarea",required:!1},{id:"manager_signature_date",label:"Date de signature responsable formation",type:"date",required:!1},{id:"manager_signature_comment",label:"Observations du responsable",type:"textarea",required:!1}]}]}};var d=e.i(970065),c=e.i(167881),u=e.i(23750),p=e.i(10708),m=e.i(184762),y=e.i(319036),f=e.i(6799),b=e.i(871689),x=e.i(356909),h=e.i(107233),g=e.i(727612),_=e.i(750570),v=e.i(664659),q=e.i(655900),j=e.i(178583),N=e.i(771649),C=e.i(684428),w=e.i(88081),k=e.i(370956),E=e.i(878265),A=e.i(87316),S=e.i(569074),B=e.i(870273),L=e.i(842009),P=e.i(239616),T=e.i(522016);e.i(882205);var I=e.i(846932),D=e.i(88653);let M=[{value:"text",label:"Texte court",icon:N.Type},{value:"textarea",label:"Texte long",icon:C.AlignLeft},{value:"number",label:"Nombre",icon:w.Hash},{value:"select",label:"Liste déroulante",icon:k.List},{value:"checkbox",label:"Case à cocher",icon:E.CheckSquare},{value:"date",label:"Date",icon:A.Calendar},{value:"file",label:"Fichier",icon:S.Upload},{value:"rating",label:"Note (étoiles)",icon:B.Star},{value:"competency",label:"Compétence",icon:L.Award}];function O(){let e=(0,a.useRouter)(),{user:N}=(0,s.useAuth)(),C=(0,n.createClient)(),{addToast:w}=(0,f.useToast)(),[k,E]=(0,i.useState)({name:"",description:"",primary_color:"#335ACF",secondary_color:"#34B9EE",formation_id:"",is_default:!1}),[A,S]=(0,i.useState)([]),[B,L]=(0,i.useState)([]),{data:O}=(0,l.useQuery)({queryKey:["formations-select",N?.organization_id],queryFn:async()=>{if(!N?.organization_id)return[];let{data:e,error:t}=await C.from("formations").select("id, name").eq("organization_id",N.organization_id).eq("is_active",!0);return t?[]:e||[]},enabled:!!N?.organization_id}),z=(0,r.useMutation)({mutationFn:async()=>{let{data:e,error:t}=await C.from("learning_portfolio_templates").insert({organization_id:N?.organization_id,name:k.name,description:k.description,template_structure:A,primary_color:k.primary_color,secondary_color:k.secondary_color,formation_id:k.formation_id||null,is_default:k.is_default,created_by:N?.id}).select().single();if(t)throw t;return e},onSuccess:()=>{w({type:"success",title:"Modèle créé",description:"Le modèle de livret a été créé avec succès."}),e.push("/dashboard/evaluations/portfolios/templates")},onError:e=>{w({type:"error",title:"Erreur",description:e.message||"Impossible de créer le modèle."})}}),F=()=>{let e={id:`section_${Date.now()}`,title:"Nouvelle section",description:"",fields:[]};S([...A,e]),L([...B,e.id])},R=(e,t)=>{S(A.map(i=>i.id===e?{...i,...t}:i))},H=(e,t,i)=>{S(A.map(a=>a.id===e?{...a,fields:a.fields.map(e=>e.id===t?{...e,...i}:e)}:a))},U=()=>{let e=o.getDefaultTemplateStructure();S(e),L(e.map(e=>e.id)),w({type:"info",title:"Modèle chargé",description:"Le modèle par défaut a été chargé."})};return(0,t.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-5xl",children:[(0,t.jsx)(I.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,t.jsx)(T.default,{href:"/dashboard/evaluations/portfolios/templates",children:(0,t.jsx)(c.Button,{variant:"ghost",size:"icon",children:(0,t.jsx)(b.ArrowLeft,{className:"h-5 w-5"})})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Nouveau modèle de livret"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Créez un modèle de livret d'apprentissage personnalisé"})]}),(0,t.jsxs)(c.Button,{variant:"outline",onClick:U,children:[(0,t.jsx)(j.FileText,{className:"h-4 w-4 mr-2"}),"Charger modèle par défaut"]})]})}),(0,t.jsx)("form",{onSubmit:e=>{(e.preventDefault(),k.name)?0===A.length?w({type:"error",title:"Erreur",description:"Ajoutez au moins une section."}):z.mutate():w({type:"error",title:"Erreur",description:"Le nom du modèle est requis."})},children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)(d.Card,{className:"sticky top-4",children:[(0,t.jsx)(d.CardHeader,{children:(0,t.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(P.Settings,{className:"h-5 w-5"}),"Paramètres"]})}),(0,t.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(p.Label,{htmlFor:"name",children:"Nom du modèle *"}),(0,t.jsx)(u.Input,{id:"name",value:k.name,onChange:e=>E({...k,name:e.target.value}),placeholder:"Ex: Livret de suivi formation",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(p.Label,{htmlFor:"description",children:"Description"}),(0,t.jsx)(m.Textarea,{id:"description",value:k.description,onChange:e=>E({...k,description:e.target.value}),placeholder:"Description du modèle...",rows:3})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(p.Label,{htmlFor:"formation",children:"Formation associée (optionnel)"}),(0,t.jsxs)("select",{id:"formation",value:k.formation_id,onChange:e=>E({...k,formation_id:e.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-blue",children:[(0,t.jsx)("option",{value:"",children:"Aucune (modèle générique)"}),O?.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(p.Label,{htmlFor:"primary_color",children:"Couleur principale"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"color",id:"primary_color",value:k.primary_color,onChange:e=>E({...k,primary_color:e.target.value}),className:"w-10 h-10 rounded cursor-pointer"}),(0,t.jsx)(u.Input,{value:k.primary_color,onChange:e=>E({...k,primary_color:e.target.value}),className:"flex-1"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(p.Label,{htmlFor:"secondary_color",children:"Couleur secondaire"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"color",id:"secondary_color",value:k.secondary_color,onChange:e=>E({...k,secondary_color:e.target.value}),className:"w-10 h-10 rounded cursor-pointer"}),(0,t.jsx)(u.Input,{value:k.secondary_color,onChange:e=>E({...k,secondary_color:e.target.value}),className:"flex-1"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(p.Label,{htmlFor:"is_default",children:"Modèle par défaut"}),(0,t.jsx)(y.Switch,{checked:k.is_default,onCheckedChange:e=>E({...k,is_default:e})})]}),(0,t.jsx)("div",{className:"pt-4 border-t",children:(0,t.jsxs)(c.Button,{type:"submit",className:"w-full",disabled:z.isPending,children:[(0,t.jsx)(x.Save,{className:"h-4 w-4 mr-2"}),z.isPending?"Création...":"Créer le modèle"]})})]})]})}),(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Structure du livret (",A.length," section",A.length>1?"s":"",")"]}),(0,t.jsxs)(c.Button,{type:"button",onClick:F,children:[(0,t.jsx)(h.Plus,{className:"h-4 w-4 mr-2"}),"Ajouter une section"]})]}),0===A.length?(0,t.jsx)(d.Card,{children:(0,t.jsxs)(d.CardContent,{className:"py-12 text-center",children:[(0,t.jsx)(j.FileText,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune section"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Ajoutez des sections pour structurer votre livret d'apprentissage."}),(0,t.jsxs)("div",{className:"flex justify-center gap-3",children:[(0,t.jsxs)(c.Button,{type:"button",onClick:F,children:[(0,t.jsx)(h.Plus,{className:"h-4 w-4 mr-2"}),"Ajouter une section"]}),(0,t.jsx)(c.Button,{type:"button",variant:"outline",onClick:U,children:"Charger modèle par défaut"})]})]})}):(0,t.jsx)(D.AnimatePresence,{children:A.map((e,i)=>(0,t.jsx)(I.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:.05*i},children:(0,t.jsxs)(d.Card,{className:"border-l-4",style:{borderLeftColor:k.primary_color},children:[(0,t.jsx)(d.CardHeader,{className:"py-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(_.GripVertical,{className:"h-5 w-5 text-gray-400 cursor-move"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(u.Input,{value:e.title,onChange:t=>R(e.id,{title:t.target.value}),className:"font-semibold text-lg border-none p-0 h-auto focus:ring-0",placeholder:"Titre de la section"}),(0,t.jsx)(u.Input,{value:e.description||"",onChange:t=>R(e.id,{description:t.target.value}),className:"text-sm text-gray-500 border-none p-0 h-auto focus:ring-0 mt-1",placeholder:"Description (optionnel)"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:[e.fields.length," champ",e.fields.length>1?"s":""]}),(0,t.jsx)(c.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>{var t;return t=e.id,void L(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},children:B.includes(e.id)?(0,t.jsx)(q.ChevronUp,{className:"h-4 w-4"}):(0,t.jsx)(v.ChevronDown,{className:"h-4 w-4"})}),(0,t.jsx)(c.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>{var t;return t=e.id,void S(A.filter(e=>e.id!==t))},className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,t.jsx)(g.Trash2,{className:"h-4 w-4"})})]})]})}),(0,t.jsx)(D.AnimatePresence,{children:B.includes(e.id)&&(0,t.jsx)(I.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},children:(0,t.jsxs)(d.CardContent,{className:"pt-0",children:[(0,t.jsx)("div",{className:"space-y-3",children:e.fields.map((i,a)=>(0,t.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg border",children:[(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-3",children:[(0,t.jsxs)("div",{className:"col-span-5",children:[(0,t.jsx)(p.Label,{className:"text-xs",children:"Label"}),(0,t.jsx)(u.Input,{value:i.label,onChange:t=>H(e.id,i.id,{label:t.target.value}),placeholder:"Nom du champ"})]}),(0,t.jsxs)("div",{className:"col-span-4",children:[(0,t.jsx)(p.Label,{className:"text-xs",children:"Type"}),(0,t.jsx)("select",{value:i.type,onChange:t=>H(e.id,i.id,{type:t.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-brand-blue text-sm",children:M.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)("div",{className:"col-span-2 flex items-end justify-center",children:(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("input",{type:"checkbox",checked:i.required,onChange:t=>H(e.id,i.id,{required:t.target.checked}),className:"rounded"}),"Requis"]})}),(0,t.jsx)("div",{className:"col-span-1 flex items-end justify-end",children:(0,t.jsx)(c.Button,{type:"button",variant:"ghost",size:"sm",onClick:()=>{var t,a;return t=e.id,a=i.id,void S(A.map(e=>e.id===t?{...e,fields:e.fields.filter(e=>e.id!==a)}:e))},className:"text-red-600 hover:text-red-700",children:(0,t.jsx)(g.Trash2,{className:"h-4 w-4"})})})]}),("select"===i.type||"competency"===i.type)&&(0,t.jsxs)("div",{className:"mt-3",children:[(0,t.jsxs)(p.Label,{className:"text-xs",children:["competency"===i.type?"Niveaux de compétence":"Options"," (séparées par des virgules)"]}),(0,t.jsx)(u.Input,{value:"competency"===i.type?(i.competencyLevels||["Non acquis","En cours","Acquis","Maîtrisé"]).join(", "):(i.options||[]).join(", "),onChange:t=>{let a=t.target.value.split(",").map(e=>e.trim());"competency"===i.type?H(e.id,i.id,{competencyLevels:a}):H(e.id,i.id,{options:a})},placeholder:"competency"===i.type?"Non acquis, En cours, Acquis, Maîtrisé":"Option 1, Option 2, Option 3"})]}),"rating"===i.type&&(0,t.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(p.Label,{className:"text-xs",children:"Note min"}),(0,t.jsx)(u.Input,{type:"number",value:i.min||1,onChange:t=>H(e.id,i.id,{min:parseInt(t.target.value)})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(p.Label,{className:"text-xs",children:"Note max"}),(0,t.jsx)(u.Input,{type:"number",value:i.max||5,onChange:t=>H(e.id,i.id,{max:parseInt(t.target.value)})})]})]})]},i.id))}),(0,t.jsxs)(c.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{var t;let i;return t=e.id,i={id:`field_${Date.now()}`,label:"Nouveau champ",type:"text",required:!1},void S(A.map(e=>e.id===t?{...e,fields:[...e.fields,i]}:e))},className:"mt-3 w-full",children:[(0,t.jsx)(h.Plus,{className:"h-4 w-4 mr-2"}),"Ajouter un champ"]})]})})})]})},e.id))})]})]})})]})}e.s(["default",()=>O],959868)}]);