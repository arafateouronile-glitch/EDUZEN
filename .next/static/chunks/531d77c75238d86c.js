(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,605631,e=>{"use strict";let t=(0,e.i(475254).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],605631)},356909,e=>{"use strict";let t=(0,e.i(475254).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);e.s(["Save",()=>t],356909)},286536,e=>{"use strict";let t=(0,e.i(475254).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],286536)},319036,e=>{"use strict";var t=e.i(843476),s=e.i(271645),a=e.i(647163);let i=s.forwardRef(({checked:e,onCheckedChange:s,disabled:i,className:n,...r},l)=>(0,t.jsx)("button",{type:"button",role:"switch","aria-checked":e,ref:l,disabled:i,onClick:()=>s?.(!e),className:(0,a.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",e?"bg-brand-blue":"bg-input",n),...r,children:(0,t.jsx)("span",{className:(0,a.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform",e?"translate-x-5":"translate-x-0")})}));i.displayName="Switch",e.s(["Switch",0,i])},77705,e=>{"use strict";let t=(0,e.i(475254).default)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);e.s(["EyeOff",()=>t],77705)},436321,e=>{"use strict";var t=e.i(920755);let s=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getTodos(e,t){let s=this.supabase.from("calendar_todos").select("*").eq("organization_id",e).order("due_date",{ascending:!0});t?.startDate&&(s=s.gte("due_date",t.startDate)),t?.endDate&&(s=s.lte("due_date",t.endDate)),t?.status&&(s=Array.isArray(t.status)?s.in("status",t.status):s.eq("status",t.status)),t?.category&&(s=s.eq("category",t.category)),t?.priority&&(s=s.eq("priority",t.priority)),t?.assignedTo&&(s=s.eq("assigned_to",t.assignedTo)),t?.createdBy&&(s=s.eq("created_by",t.createdBy)),t?.search&&(s=s.or(`title.ilike.%${t.search}%,description.ilike.%${t.search}%`));let{data:a,error:i}=await s;if(i){if("PGRST116"===i.code||"42P01"===i.code||i.message?.includes("does not exist"))return[];throw i}return a||[]}async getTodoById(e){let{data:t,error:s}=await this.supabase.from("calendar_todos").select("*").eq("id",e).single();if(s){if("PGRST116"===s.code||"42P01"===s.code||s.message?.includes("does not exist"))return null;throw s}return t}async createTodo(e){let{data:t,error:s}=await this.supabase.from("calendar_todos").insert(e).select().single();if(s)throw s;return!1!==e.reminder_enabled&&await this.supabase.rpc("create_todo_reminder_notification",{todo_id:t.id}),t}async updateTodo(e,t){let{data:s,error:a}=await this.supabase.from("calendar_todos").update(t).eq("id",e).select().single();if(a)throw a;return s}async deleteTodo(e){let{error:t}=await this.supabase.from("calendar_todos").delete().eq("id",e);if(t)throw t}async completeTodo(e){return this.updateTodo(e,{status:"completed"})}async completeTodos(e){let{error:t}=await this.supabase.from("calendar_todos").update({status:"completed"}).in("id",e);if(t)throw t}async getCalendarEvents(e,t,s,a){try{let i={p_organization_id:e,p_start_date:t,p_end_date:s};a&&(i.p_user_id=a);let{data:n,error:r}=await this.supabase.rpc("get_calendar_events",i);if(r){if("42883"===r.code||"PGRST116"===r.code||"42P01"===r.code||"400"===r.code||r.message?.includes("does not exist")||r.message?.includes("function")||r.message?.includes("does not exist"))return this.getCalendarEventsManual(e,t,s,a);throw r}return n||[]}catch(i){return this.getCalendarEventsManual(e,t,s,a)}}async getCalendarEventsManual(e,t,s,a){let i=[];try{let a=await this.getTodos(e,{startDate:t,endDate:s});i.push(...a.map(e=>({event_id:e.id,event_type:"todo",title:e.title,description:e.description,start_date:e.start_date||e.due_date,start_time:e.start_time,end_date:e.due_date,end_time:e.due_time,all_day:e.all_day,status:e.status,color:e.color,category:e.category,priority:e.priority,linked_id:e.linked_session_id||e.linked_formation_id||null})))}catch(e){}try{let n,r=this.supabase.from("sessions").select("id, name, start_date, end_date, start_time, end_time, location, status, formation_id, organization_id, formations(id, name)").eq("organization_id",e);if(a){let{data:e}=await this.supabase.from("users").select("role").eq("id",a).maybeSingle();if(e?.role==="teacher"){let{data:e}=await this.supabase.from("session_teachers").select("session_id").eq("teacher_id",a);if(e&&e.length>0){let t=e.map(e=>e.session_id);r=r.in("id",t)}else{let{data:e,error:t}=await r.limit(0);t&&t.code,n=[]}}}let l=null;if(void 0===n){let{data:e,error:t}=await r;if(n=e,l=t)throw l}if(l)throw l;if(n){let e=new Date(t),a=new Date(s),r=n.filter(t=>{if(!t.start_date)return!1;let s=new Date(t.start_date),i=t.end_date?new Date(t.end_date):null;return s>=e&&s<=a||i&&i>=e&&i<=a||s<=e&&(!i||i>=e)||s<=e&&i&&i>=a}).map(e=>{let t=e.start_date?"string"==typeof e.start_date?e.start_date.split("T")[0]:new Date(e.start_date).toISOString().split("T")[0]:null,s=e.end_date?"string"==typeof e.end_date?e.end_date.split("T")[0]:new Date(e.end_date).toISOString().split("T")[0]:null,a=[];if(e.start_time){let t=e.start_time.slice(0,5),s=e.end_time?e.end_time.slice(0,5):null;s?a.push(`ðŸ• ${t} - ${s}`):a.push(`ðŸ• ${t}`)}return e.location&&a.push(`ðŸ“ ${e.location}`),e.formations?.name&&a.push(`ðŸ“š ${e.formations.name}`),{event_id:e.id,event_type:"session",title:e.name,description:a.length>0?a.join(" â€¢ "):null,start_date:t||"",start_time:e.start_time,end_date:s||t||"",end_time:e.end_time,all_day:!1,status:e.status,color:"#10B981",category:"session",priority:"medium",linked_id:e.formation_id,location:e.location||null,formation_name:e.formations?.name||null}});i.push(...r)}}catch(e){}try{let n=this.supabase.from("formations").select("*, sessions(id, start_date, end_date)").eq("organization_id",e);if(a){let{data:e}=await this.supabase.from("users").select("role").eq("id",a).maybeSingle();if(e?.role==="teacher"){let{data:e}=await this.supabase.from("session_teachers").select("session_id").eq("teacher_id",a);if(!e||!(e.length>0))return i;{let t=e.map(e=>e.session_id),{data:s}=await this.supabase.from("sessions").select("formation_id").in("id",t);if(!s||!(s.length>0))return i;{let e=[...new Set(s.map(e=>e.formation_id).filter(e=>!!e))];if(!(e.length>0))return i;n=n.in("id",e)}}}}let{data:r,error:l}=await n;if(l)throw l;if(r){let e=new Date(t),a=new Date(s),n=r.map(e=>{let t=e.sessions||[];if(0===t.length)return null;let s=t.filter(e=>e.start_date).map(e=>({start:new Date(e.start_date),end:e.end_date?new Date(e.end_date):null}));if(0===s.length)return null;let a=new Date(Math.min(...s.map(e=>e.start.getTime()))),i=s.map(e=>e.end).filter(e=>null!==e),n=i.length>0?new Date(Math.max(...i.map(e=>e.getTime()))):null;return{formation:e,start_date:a,end_date:n}}).filter(e=>null!==e).filter(({start_date:t,end_date:s})=>t>=e&&t<=a||s&&s>=e&&s<=a||t<=e&&(!s||s>=e)||t<=e&&s&&s>=a).map(({formation:e,start_date:t,end_date:s})=>({event_id:e.id,event_type:"formation",title:e.name,description:e.description,start_date:t.toISOString().split("T")[0],start_time:null,end_date:s?s.toISOString().split("T")[0]:t.toISOString().split("T")[0],end_time:null,all_day:!0,status:e.is_active?"active":"inactive",color:"#8B5CF6",category:"formation",priority:"medium",linked_id:e.program_id}));i.push(...n)}}catch(e){}return i}async getNotifications(e,t){let s=this.supabase.from("calendar_notifications").select("*").eq("user_id",e).order("scheduled_at",{ascending:!1});t?.status&&(s=s.eq("status",t.status)),t?.unreadOnly&&(s=s.in("status",["pending","sent"])),t?.limit&&(s=s.limit(t.limit));let{data:a,error:i}=await s;if(i){if("PGRST116"===i.code||"42P01"===i.code||i.message?.includes("does not exist"))return[];throw i}return a||[]}async markNotificationAsRead(e){let{error:t}=await this.supabase.from("calendar_notifications").update({status:"read",read_at:new Date().toISOString()}).eq("id",e);if(t)throw t}async markAllNotificationsAsRead(e){let{error:t}=await this.supabase.from("calendar_notifications").update({status:"read",read_at:new Date().toISOString()}).eq("user_id",e).in("status",["pending","sent"]);if(t)throw t}async dismissNotification(e){let{error:t}=await this.supabase.from("calendar_notifications").update({status:"dismissed"}).eq("id",e);if(t)throw t}async countUnreadNotifications(e){let{count:t,error:s}=await this.supabase.from("calendar_notifications").select("*",{count:"exact",head:!0}).eq("user_id",e).in("status",["pending","sent"]);if(s){if("PGRST116"===s.code||"42P01"===s.code||s.message?.includes("does not exist"))return 0;throw s}return t||0}async getUserPreferences(e,t){let{data:s,error:a}=await this.supabase.from("calendar_user_preferences").select("*").eq("user_id",e).eq("organization_id",t).single();if(a){if("PGRST116"===a.code||"42P01"===a.code||a.message?.includes("does not exist"))return null;throw a}return s}async upsertUserPreferences(e,t,s){let{data:a,error:i}=await this.supabase.from("calendar_user_preferences").upsert({user_id:e,organization_id:t,...s},{onConflict:"user_id,organization_id"}).select().single();if(i)throw i;return a}async getUpcomingTodosWithReminder(e,t=60){let s=new Date,a=new Date(s.getTime()+60*t*1e3),{data:i,error:n}=await this.supabase.from("calendar_todos").select("*").eq("organization_id",e).eq("reminder_enabled",!0).eq("reminder_sent",!1).in("status",["pending","in_progress"]).gte("due_date",s.toISOString().split("T")[0]).lte("due_date",a.toISOString().split("T")[0]);if(n)throw n;return i||[]}async getCalendarStats(e){let t=new Date().toISOString().split("T")[0],{data:s,error:a}=await this.supabase.from("calendar_todos").select("id, status, due_date").eq("organization_id",e);if(a){if("PGRST116"===a.code||"42P01"===a.code||a.message?.includes("does not exist"))return{totalTodos:0,pendingTodos:0,completedTodos:0,overdueTodos:0,todayTodos:0,upcomingTodos:0};throw a}let i=s||[],n=i.length,r=i.filter(e=>"pending"===e.status).length,l=i.filter(e=>"completed"===e.status).length,d=i.filter(e=>"completed"!==e.status&&"cancelled"!==e.status&&e.due_date<t).length;return{totalTodos:n,pendingTodos:r,completedTodos:l,overdueTodos:d,todayTodos:i.filter(e=>e.due_date===t).length,upcomingTodos:i.filter(e=>"completed"!==e.status&&"cancelled"!==e.status&&e.due_date>t).length}}async getConfig(e,t){return null}async upsertConfig(e,t,s){return{organization_id:e,provider:t,...s}}};e.s(["calendarService",0,s])},909634,e=>{"use strict";var t=e.i(843476),s=e.i(271645),a=e.i(266027),i=e.i(954616),n=e.i(912598),r=e.i(325715),l=e.i(436321),d=e.i(167881),o=e.i(970065),c=e.i(23750),u=e.i(10708),m=e.i(319036),h=e.i(6799),_=e.i(87316),p=e.i(356909),f=e.i(605631),g=e.i(898791),x=e.i(286536),y=e.i(77705),v=e.i(952571),b=e.i(16715),j=e.i(778917);let w=[{value:"google",label:"Google Calendar",color:"bg-blue-500",docs:"https://developers.google.com/calendar/api"},{value:"outlook",label:"Microsoft Outlook",color:"bg-orange-500",docs:"https://learn.microsoft.com/en-us/graph/api/resources/calendar"}];function C(){let{user:e}=(0,r.useAuth)(),C=(0,n.useQueryClient)(),{addToast:k}=(0,h.useToast)(),[N,S]=(0,s.useState)("google"),[T,q]=(0,s.useState)({}),[$,I]=(0,s.useState)(!1),[z,D]=(0,s.useState)({google:{api_key:"",api_secret:"",sync_sessions:!0,sync_attendance:!1,auto_sync:!1,sync_frequency:"realtime",create_events_for_sessions:!0,include_students_in_events:!1,include_location:!0,send_reminders:!1,reminder_minutes:15,is_test_mode:!0},outlook:{api_key:"",api_secret:"",sync_sessions:!0,sync_attendance:!1,auto_sync:!1,sync_frequency:"realtime",create_events_for_sessions:!0,include_students_in_events:!1,include_location:!0,send_reminders:!1,reminder_minutes:15,is_test_mode:!0}}),{data:P,isLoading:A}=(0,a.useQuery)({queryKey:["calendar-configs",e?.organization_id],queryFn:async()=>{if(!e?.organization_id)return{};let t={};for(let s of["google","outlook"]){let a=await l.calendarService.getConfig(e.organization_id,s);a&&(t[s]=a,D(e=>({...e,[s]:{api_key:a.api_key||"",api_secret:a.api_secret||"",sync_sessions:a.sync_sessions,sync_attendance:a.sync_attendance,auto_sync:a.auto_sync,sync_frequency:a.sync_frequency,create_events_for_sessions:a.create_events_for_sessions,include_students_in_events:a.include_students_in_events,include_location:a.include_location,send_reminders:a.send_reminders,reminder_minutes:a.reminder_minutes||15,is_test_mode:a.is_test_mode}})))}return t},enabled:!!e?.organization_id}),E=(0,i.useMutation)({mutationFn:async t=>{if(!e?.organization_id)throw Error("Organization ID manquant");return l.calendarService.upsertConfig(e.organization_id,t,z[t])},onSuccess:(e,t)=>{C.invalidateQueries({queryKey:["calendar-configs"]}),k({type:"success",title:"Configuration sauvegardÃ©e",description:`La configuration ${w.find(e=>e.value===t)?.label} a \xe9t\xe9 sauvegard\xe9e.`})},onError:e=>{k({type:"error",title:"Erreur",description:e.message||"Une erreur est survenue lors de la sauvegarde."})}}),O=(0,i.useMutation)({mutationFn:async e=>{let t=await fetch(`/api/calendar/authenticate/${e}`);if(!t.ok)throw Error((await t.json()).error||"Erreur lors de l'authentification");let s=await t.json();s.auth_url&&(window.location.href=s.auth_url)},onError:e=>{k({type:"error",title:"Erreur",description:e.message||"Une erreur est survenue lors de l'authentification."}),I(!1)}}),F=(e,t,s)=>{D(a=>({...a,[e]:{...a[e],[t]:s}}))},M=e=>{q(t=>({...t,[e]:!t[e]}))};if(A)return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("div",{className:"text-muted-foreground",children:"Chargement..."})})});let R=P?.[N];return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[(0,t.jsx)(_.Calendar,{className:"mr-3 h-8 w-8 text-primary"}),"IntÃ©grations Calendrier"]}),(0,t.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Synchronisez vos sessions avec Google Calendar ou Microsoft Outlook"})]}),(0,t.jsx)("div",{className:"flex space-x-4",children:w.map(e=>{let s=P?.[e.value],a=s?.is_active||!1;return(0,t.jsx)("button",{onClick:()=>S(e.value),className:`flex-1 p-4 border-2 rounded-lg transition-all ${N===e.value?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"}`,children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:`w-3 h-3 rounded-full ${e.color}`}),(0,t.jsx)("span",{className:"font-semibold",children:e.label})]}),a&&(0,t.jsx)(f.CheckCircle,{className:"h-5 w-5 text-green-600"})]})},e.value)})}),N&&(0,t.jsxs)(o.Card,{children:[(0,t.jsxs)(o.CardHeader,{children:[(0,t.jsxs)(o.CardTitle,{children:["Configuration ",w.find(e=>e.value===N)?.label]}),(0,t.jsxs)(o.CardDescription,{children:["Configurez les paramÃ¨tres d'API pour ",w.find(e=>e.value===N)?.label]})]}),(0,t.jsxs)(o.CardContent,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{htmlFor:`test-mode-${N}`,children:"Mode test"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Activez le mode test pour tester les intÃ©grations sans impact sur vos calendriers rÃ©els"})]}),(0,t.jsx)(m.Switch,{checked:z[N].is_test_mode,onCheckedChange:e=>F(N,"is_test_mode",e)})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{htmlFor:`api-key-${N}`,children:"ClÃ© API (Client ID)"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(c.Input,{id:`api-key-${N}`,type:T[`${N}-api-key`]?"text":"password",value:z[N].api_key,onChange:e=>F(N,"api_key",e.target.value),placeholder:"Votre clÃ© API"}),(0,t.jsx)("button",{type:"button",onClick:()=>M(`${N}-api-key`),className:"absolute right-3 top-1/2 -translate-y-1/2",children:T[`${N}-api-key`]?(0,t.jsx)(y.EyeOff,{className:"h-4 w-4 text-gray-400"}):(0,t.jsx)(x.Eye,{className:"h-4 w-4 text-gray-400"})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{htmlFor:`api-secret-${N}`,children:"Secret API (Client Secret)"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(c.Input,{id:`api-secret-${N}`,type:T[`${N}-api-secret`]?"text":"password",value:z[N].api_secret,onChange:e=>F(N,"api_secret",e.target.value),placeholder:"Votre secret API"}),(0,t.jsx)("button",{type:"button",onClick:()=>M(`${N}-api-secret`),className:"absolute right-3 top-1/2 -translate-y-1/2",children:T[`${N}-api-secret`]?(0,t.jsx)(y.EyeOff,{className:"h-4 w-4 text-gray-400"}):(0,t.jsx)(x.Eye,{className:"h-4 w-4 text-gray-400"})})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold",children:"Options de synchronisation"}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{htmlFor:`sync-sessions-${N}`,children:"Synchroniser les sessions"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"CrÃ©er automatiquement des Ã©vÃ©nements calendrier pour chaque session"})]}),(0,t.jsx)(m.Switch,{checked:z[N].sync_sessions,onCheckedChange:e=>F(N,"sync_sessions",e)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{htmlFor:`create-events-${N}`,children:"CrÃ©er des Ã©vÃ©nements pour les sessions"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"CrÃ©er automatiquement un Ã©vÃ©nement lors de la crÃ©ation d'une session"})]}),(0,t.jsx)(m.Switch,{checked:z[N].create_events_for_sessions,onCheckedChange:e=>F(N,"create_events_for_sessions",e)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{htmlFor:`include-students-${N}`,children:"Inclure les Ã©tudiants dans les Ã©vÃ©nements"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Ajouter les Ã©tudiants comme participants aux Ã©vÃ©nements calendrier"})]}),(0,t.jsx)(m.Switch,{checked:z[N].include_students_in_events,onCheckedChange:e=>F(N,"include_students_in_events",e)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{htmlFor:`include-location-${N}`,children:"Inclure le lieu"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Ajouter le lieu de la session dans l'Ã©vÃ©nement calendrier"})]}),(0,t.jsx)(m.Switch,{checked:z[N].include_location,onCheckedChange:e=>F(N,"include_location",e)})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{htmlFor:`send-reminders-${N}`,children:"Envoyer des rappels"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Activer les rappels pour les Ã©vÃ©nements calendrier"})]}),(0,t.jsx)(m.Switch,{checked:z[N].send_reminders,onCheckedChange:e=>F(N,"send_reminders",e)})]}),z[N].send_reminders&&(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{htmlFor:`reminder-minutes-${N}`,children:"Minutes avant l'Ã©vÃ©nement"}),(0,t.jsx)(c.Input,{id:`reminder-minutes-${N}`,type:"number",min:"0",max:"20160",value:z[N].reminder_minutes,onChange:e=>F(N,"reminder_minutes",parseInt(e.target.value)||15),className:"mt-2"})]})]}),R?.is_active&&(0,t.jsx)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-green-800",children:"ConnectÃ©"}),R.default_calendar_name&&(0,t.jsxs)("p",{className:"text-sm text-green-600",children:["Calendrier: ",R.default_calendar_name]}),R.last_sync_at&&(0,t.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:["DerniÃ¨re synchronisation: ",new Date(R.last_sync_at).toLocaleString("fr-FR")]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:["success"===R.last_sync_status&&(0,t.jsx)(f.CheckCircle,{className:"h-5 w-5 text-green-600"}),"failed"===R.last_sync_status&&(0,t.jsx)(g.AlertCircle,{className:"h-5 w-5 text-red-600"})]})]})}),(0,t.jsx)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,t.jsx)(v.Info,{className:"h-5 w-5 text-blue-600 mt-0.5"}),(0,t.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,t.jsx)("p",{className:"font-semibold mb-1",children:"Comment obtenir vos identifiants API ?"}),(0,t.jsxs)("p",{className:"mb-2",children:["Consultez la documentation de ",w.find(e=>e.value===N)?.label," pour crÃ©er une application et obtenir vos identifiants."]}),(0,t.jsxs)("a",{href:w.find(e=>e.value===N)?.docs,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center space-x-1",children:[(0,t.jsx)("span",{children:"Documentation"}),(0,t.jsx)(j.ExternalLink,{className:"h-3 w-3"})]})]})]})}),(0,t.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,t.jsxs)(d.Button,{variant:"outline",onClick:()=>{E.mutate(N)},disabled:E.isPending,children:[(0,t.jsx)(p.Save,{className:"h-4 w-4 mr-2"}),"Sauvegarder"]}),R?.api_key&&R?.api_secret&&(0,t.jsx)(t.Fragment,{children:R.is_active?(0,t.jsxs)(d.Button,{variant:"outline",onClick:()=>{k({type:"info",title:"Synchronisation",description:"La synchronisation se fait automatiquement lors de la crÃ©ation/modification de sessions."})},children:[(0,t.jsx)(b.RefreshCw,{className:"h-4 w-4 mr-2"}),"Info Sync"]}):(0,t.jsx)(d.Button,{onClick:()=>{I(!0),O.mutate(N)},disabled:$||O.isPending,children:$?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.RefreshCw,{className:"h-4 w-4 mr-2 animate-spin"}),"Authentification..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(j.ExternalLink,{className:"h-4 w-4 mr-2"}),"Connecter"]})})})]})]})]})]})}e.s(["default",()=>C])}]);