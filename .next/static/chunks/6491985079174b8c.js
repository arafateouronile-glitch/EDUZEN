(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,871689,e=>{"use strict";let t=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],871689)},286536,e=>{"use strict";let t=(0,e.i(475254).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],286536)},527985,e=>{"use strict";var t=e.i(920755);let a=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getCategories(e,t=!0){let a=this.supabase.from("documentation_categories").select("*").order("order_index",{ascending:!0});e?a=a.or(`organization_id.eq.${e},is_public.eq.true`):t&&(a=a.eq("is_public",!0));let{data:i,error:s}=await a;if(s)throw s;return i}async getCategoryBySlug(e,t){let a=this.supabase.from("documentation_categories").select("*").eq("slug",e).single();a=t?a.or(`organization_id.eq.${t},is_public.eq.true`):a.eq("is_public",!0);let{data:i,error:s}=await a;if(s)throw s;return i}async createCategory(e){let{data:t,error:a}=await this.supabase.from("documentation_categories").insert(e).select().single();if(a)throw a;return t}async updateCategory(e,t){let{data:a,error:i}=await this.supabase.from("documentation_categories").update(t).eq("id",e).select().single();if(i)throw i;return a}async deleteCategory(e){let{error:t}=await this.supabase.from("documentation_categories").delete().eq("id",e);if(t)throw t}async getArticlesByCategory(e,t="published"){let{data:a,error:i}=await this.supabase.from("documentation_articles").select("*, author:users(id, full_name, email)").eq("category_id",e).eq("status",t).order("order_index",{ascending:!0}).order("published_at",{ascending:!1});if(i)throw i;return a}async getArticleBySlug(e,t){let{data:a,error:i}=await this.supabase.from("documentation_articles").select(`
        *,
        category:documentation_categories(*),
        sections:documentation_sections(*),
        author:users(id, full_name, email)
      `).eq("slug",e).eq("category.slug",t).eq("status","published").single();if(i)throw i;return a&&await this.supabase.rpc("increment_article_view_count",{article_uuid:a.id}),a}async searchArticles(e,t){let a=this.supabase.from("documentation_articles").select("*, category:documentation_categories(*), author:users(id, full_name)").eq("status","published").or(`title.ilike.%${e}%,content.ilike.%${e}%,excerpt.ilike.%${e}%`);a=t?a.or(`organization_id.eq.${t},category.is_public.eq.true`):a.eq("category.is_public",!0);let{data:i,error:s}=await a.order("view_count",{ascending:!1}).limit(50);if(s)throw s;return i}async getPopularArticles(e=10,t){let a=this.supabase.from("documentation_articles").select("*, category:documentation_categories(*), author:users(id, full_name)").eq("status","published").order("view_count",{ascending:!1}).limit(e);a=t?a.or(`organization_id.eq.${t},category.is_public.eq.true`):a.eq("category.is_public",!0);let{data:i,error:s}=await a;if(s)throw s;return i}async getRecentArticles(e=10,t){let a=this.supabase.from("documentation_articles").select("*, category:documentation_categories(*), author:users(id, full_name)").eq("status","published").order("published_at",{ascending:!1}).limit(e);a=t?a.or(`organization_id.eq.${t},category.is_public.eq.true`):a.eq("category.is_public",!0);let{data:i,error:s}=await a;if(s)throw s;return i}async getFeaturedArticles(e=5,t){let a=this.supabase.from("documentation_articles").select("*, category:documentation_categories(*), author:users(id, full_name)").eq("status","published").eq("is_featured",!0).order("published_at",{ascending:!1}).limit(e);a=t?a.or(`organization_id.eq.${t},category.is_public.eq.true`):a.eq("category.is_public",!0);let{data:i,error:s}=await a;if(s)throw s;return i}async createArticle(e){let{data:t,error:a}=await this.supabase.from("documentation_articles").insert(e).select().single();if(a)throw a;return t}async updateArticle(e,t){let{data:a,error:i}=await this.supabase.from("documentation_articles").update(t).eq("id",e).select().single();if(i)throw i;return a}async deleteArticle(e){let{error:t}=await this.supabase.from("documentation_articles").delete().eq("id",e);if(t)throw t}async getArticleSections(e){let{data:t,error:a}=await this.supabase.from("documentation_sections").select("*").eq("article_id",e).order("order_index",{ascending:!0});if(a)throw a;return t}async createSection(e){let{data:t,error:a}=await this.supabase.from("documentation_sections").insert(e).select().single();if(a)throw a;return t}async updateSection(e,t){let{data:a,error:i}=await this.supabase.from("documentation_sections").update(t).eq("id",e).select().single();if(i)throw i;return a}async deleteSection(e){let{error:t}=await this.supabase.from("documentation_sections").delete().eq("id",e);if(t)throw t}async getUserFavorites(e){let{data:t,error:a}=await this.supabase.from("documentation_favorites").select("*, article:documentation_articles(*, category:documentation_categories(*))").eq("user_id",e).order("created_at",{ascending:!1});if(a)throw a;return t}async addFavorite(e,t){let{data:a,error:i}=await this.supabase.from("documentation_favorites").insert({user_id:e,article_id:t}).select().single();if(i)throw i;return a}async removeFavorite(e,t){let{error:a}=await this.supabase.from("documentation_favorites").delete().eq("user_id",e).eq("article_id",t);if(a)throw a}async isFavorite(e,t){let{data:a,error:i}=await this.supabase.from("documentation_favorites").select("id").eq("user_id",e).eq("article_id",t).maybeSingle();if(i)throw i;return!!a}async getUserNotes(e,t){let{data:a,error:i}=await this.supabase.from("documentation_notes").select("*").eq("user_id",e).eq("article_id",t).order("created_at",{ascending:!1}).maybeSingle();if(i)throw i;return a}async upsertNote(e,t,a){let i=await this.getUserNotes(e,t);if(i){let{data:e,error:t}=await this.supabase.from("documentation_notes").update({content:a}).eq("id",i.id).select().single();if(t)throw t;return e}{let{data:i,error:s}=await this.supabase.from("documentation_notes").insert({user_id:e,article_id:t,content:a}).select().single();if(s)throw s;return i}}async deleteNote(e,t){let{error:a}=await this.supabase.from("documentation_notes").delete().eq("user_id",e).eq("article_id",t);if(a)throw a}async createFeedback(e){let{data:t,error:a}=await this.supabase.from("documentation_feedback").insert(e).select().single();if(a)throw a;return t}async getArticleFeedback(e){let{data:t,error:a}=await this.supabase.from("documentation_feedback").select("*, user:users(id, full_name)").eq("article_id",e).order("created_at",{ascending:!1});if(a)throw a;return t}async getArticleFeedbackStats(e){let{data:t,error:a}=await this.supabase.from("documentation_feedback").select("rating, is_helpful").eq("article_id",e);if(a)throw a;let i={total:t.length,averageRating:0,helpfulCount:0,notHelpfulCount:0,ratings:{1:0,2:0,3:0,4:0,5:0}};if(t.length>0){let e=t.filter(e=>e.rating).map(e=>e.rating);e.length>0&&(i.averageRating=e.reduce((e,t)=>e+t,0)/e.length),t.forEach(e=>{e.rating&&i.ratings[e.rating]++,!0===e.is_helpful&&i.helpfulCount++,!1===e.is_helpful&&i.notHelpfulCount++})}return i}async recordSearch(e,t,a){let{error:i}=await this.supabase.from("documentation_search_history").insert({user_id:e,query:t,results_count:a});if(i)throw i}async getSearchHistory(e,t=10){let{data:a,error:i}=await this.supabase.from("documentation_search_history").select("*").eq("user_id",e).order("created_at",{ascending:!1}).limit(t);if(i)throw i;return a}async clearSearchHistory(e){let{error:t}=await this.supabase.from("documentation_search_history").delete().eq("user_id",e);if(t)throw t}};e.s(["documentationService",0,a])},548496,e=>{"use strict";var t=e.i(843476),a=e.i(618566),i=e.i(266027),s=e.i(325715),r=e.i(527985),n=e.i(970065),o=e.i(167881),c=e.i(871689),l=e.i(178583),u=e.i(286536),d=e.i(522016);function h(){let e=(0,a.useParams)().slug,{user:h}=(0,s.useAuth)(),{data:m}=(0,i.useQuery)({queryKey:["documentation-category",e,h?.organization_id],queryFn:async()=>await r.documentationService.getCategoryBySlug(e,h?.organization_id||""),enabled:!!e&&!!h?.organization_id}),{data:g}=(0,i.useQuery)({queryKey:["documentation-articles",e,h?.organization_id],queryFn:()=>r.documentationService.getArticlesByCategory(m?.id||"","published"),enabled:!!m?.id});return(0,t.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-5xl",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)(d.default,{href:"/dashboard/documentation",children:(0,t.jsxs)(o.Button,{variant:"ghost",size:"sm",className:"mb-4",children:[(0,t.jsx)(c.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Retour à la documentation"]})}),m&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold mb-2",children:m.name}),m.description&&(0,t.jsx)("p",{className:"text-muted-foreground",children:m.description})]})]}),g&&g.length>0?(0,t.jsx)("div",{className:"space-y-4",children:g.map(a=>(0,t.jsx)(n.Card,{className:"hover:shadow-lg transition-shadow cursor-pointer",children:(0,t.jsxs)(d.default,{href:`/dashboard/documentation/${e}/${a.slug}`,children:[(0,t.jsxs)(n.CardHeader,{children:[(0,t.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(l.FileText,{className:"h-5 w-5 text-primary"}),a.title]}),a.excerpt&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:a.excerpt})]}),(0,t.jsx)(n.CardContent,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(u.Eye,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:[a.view_count," vues"]})]}),a.author&&(0,t.jsxs)("span",{children:["Par ",a.author.full_name||a.author.email]})]})})]})},a.id))}):(0,t.jsx)(n.Card,{children:(0,t.jsx)(n.CardContent,{className:"pt-6 text-center text-muted-foreground",children:"Aucun article disponible dans cette catégorie"})})]})}e.s(["default",()=>h])}]);