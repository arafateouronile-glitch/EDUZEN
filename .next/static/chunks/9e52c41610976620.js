(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,871689,e=>{"use strict";let s=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>s],871689)},356909,e=>{"use strict";let s=(0,e.i(475254).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);e.s(["Save",()=>s],356909)},263488,e=>{"use strict";let s=(0,e.i(475254).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);e.s(["Mail",()=>s],263488)},238491,e=>{"use strict";let s=(0,e.i(475254).default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);e.s(["Phone",()=>s],238491)},879002,e=>{"use strict";let s=(0,e.i(475254).default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);e.s(["UserPlus",()=>s],879002)},245423,e=>{"use strict";var s=e.i(843476),r=e.i(271645),a=e.i(618566),t=e.i(954616),l=e.i(912598),i=e.i(325715),n=e.i(167881),o=e.i(970065),d=e.i(23750),u=e.i(10708),c=e.i(6799),m=e.i(871689),h=e.i(879002),p=e.i(263488),x=e.i(238491),f=e.i(284614),v=e.i(98919),j=e.i(356909),g=e.i(16715),b=e.i(522016);let y=[{value:"admin",label:"Administrateur"},{value:"teacher",label:"Enseignant"},{value:"secretary",label:"Secrétaire"},{value:"accountant",label:"Comptable"},{value:"parent",label:"Parent"},{value:"student",label:"Étudiant"}];function w(){let e=(0,a.useRouter)(),{user:w}=(0,i.useAuth)(),{addToast:N}=(0,c.useToast)(),C=(0,l.useQueryClient)(),[E,k]=(0,r.useState)({email:"",password:"",confirmPassword:"",full_name:"",phone:"",role:"teacher",is_active:!0}),P=(0,t.useMutation)({mutationFn:async e=>{let s=await fetch("/api/users/create",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e.email,password:e.password,full_name:e.full_name,phone:e.phone||null,role:e.role,is_active:e.is_active,organization_id:w?.organization_id})});if(!s.ok){let e="Erreur lors de la création de l'utilisateur",r=null;try{let a=await s.json();e=a.error||e,r=a.details||a.code||null,console.error("❌ [CREATE USER] Erreur API:",a),r&&console.error("❌ [CREATE USER] Détails:",r)}catch(r){console.error("❌ [CREATE USER] Erreur lors de la lecture de la réponse:",r),e=`Erreur ${s.status}: ${s.statusText}`}throw Error(r?`${e} (${r})`:e)}return s.json()},onSuccess:()=>{C.invalidateQueries({queryKey:["organization-users"]}),C.refetchQueries({queryKey:["organization-users"]}),N({type:"success",title:"Succès",description:"L'utilisateur a été créé avec succès"}),setTimeout(()=>{e.push("/dashboard/settings/users")},300)},onError:e=>{console.error("❌ [CREATE USER] Erreur:",e),N({type:"error",title:"Erreur",description:e.message||"Une erreur est survenue lors de la création"})}});return(0,s.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-3xl",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)(b.default,{href:"/dashboard/settings/users",className:"inline-flex items-center text-sm text-muted-foreground hover:text-foreground mb-4",children:[(0,s.jsx)(m.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Retour à la liste des utilisateurs"]}),(0,s.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,s.jsx)(h.UserPlus,{className:"h-8 w-8 text-brand-blue"}),"Créer un nouvel utilisateur"]}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Ajoutez un nouvel utilisateur à votre organisation"})]}),(0,s.jsxs)(o.Card,{children:[(0,s.jsxs)(o.CardHeader,{children:[(0,s.jsx)(o.CardTitle,{children:"Informations de l'utilisateur"}),(0,s.jsx)(o.CardDescription,{children:"Remplissez les informations pour créer un nouvel utilisateur"})]}),(0,s.jsx)(o.CardContent,{children:(0,s.jsxs)("form",{onSubmit:e=>{(e.preventDefault(),E.email&&E.password&&E.full_name)?E.password.length<8?N({type:"error",title:"Erreur",description:"Le mot de passe doit contenir au moins 8 caractères"}):E.password!==E.confirmPassword?N({type:"error",title:"Erreur",description:"Les mots de passe ne correspondent pas"}):P.mutate(E):N({type:"error",title:"Erreur",description:"Veuillez remplir tous les champs obligatoires"})},className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(u.Label,{htmlFor:"full_name",children:[(0,s.jsx)(f.User,{className:"h-4 w-4 inline mr-2"}),"Nom complet ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(d.Input,{id:"full_name",type:"text",value:E.full_name,onChange:e=>k({...E,full_name:e.target.value}),placeholder:"Jean Dupont",required:!0,className:"mt-2"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(u.Label,{htmlFor:"email",children:[(0,s.jsx)(p.Mail,{className:"h-4 w-4 inline mr-2"}),"Email ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(d.Input,{id:"email",type:"email",value:E.email,onChange:e=>k({...E,email:e.target.value}),placeholder:"jean.dupont@example.com",required:!0,className:"mt-2"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(u.Label,{htmlFor:"phone",children:[(0,s.jsx)(x.Phone,{className:"h-4 w-4 inline mr-2"}),"Téléphone"]}),(0,s.jsx)(d.Input,{id:"phone",type:"tel",value:E.phone,onChange:e=>k({...E,phone:e.target.value}),placeholder:"+221 77 123 45 67",className:"mt-2"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(u.Label,{htmlFor:"role",children:[(0,s.jsx)(v.Shield,{className:"h-4 w-4 inline mr-2"}),"Rôle ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("select",{id:"role",value:E.role,onChange:e=>k({...E,role:e.target.value}),className:"mt-2 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",required:!0,children:y.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(u.Label,{htmlFor:"password",children:["Mot de passe ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(d.Input,{id:"password",type:"password",value:E.password,onChange:e=>k({...E,password:e.target.value}),placeholder:"Minimum 8 caractères",required:!0,minLength:8,className:"mt-2"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Le mot de passe doit contenir au moins 8 caractères"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(u.Label,{htmlFor:"confirmPassword",children:["Confirmer le mot de passe ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(d.Input,{id:"confirmPassword",type:"password",value:E.confirmPassword,onChange:e=>k({...E,confirmPassword:e.target.value}),placeholder:"Répétez le mot de passe",required:!0,className:"mt-2"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",id:"is_active",checked:E.is_active,onChange:e=>k({...E,is_active:e.target.checked}),className:"h-4 w-4 rounded border-gray-300 text-brand-blue focus:ring-brand-blue"}),(0,s.jsx)(u.Label,{htmlFor:"is_active",className:"cursor-pointer",children:"Activer l'utilisateur immédiatement"})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-4 pt-4",children:[(0,s.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>e.push("/dashboard/settings/users"),disabled:P.isPending,children:"Annuler"}),(0,s.jsx)(n.Button,{type:"submit",disabled:P.isPending,children:P.isPending?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.RefreshCw,{className:"h-4 w-4 mr-2 animate-spin"}),"Création..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.Save,{className:"h-4 w-4 mr-2"}),"Créer l'utilisateur"]})})]})]})})]})]})}e.s(["default",()=>w])}]);