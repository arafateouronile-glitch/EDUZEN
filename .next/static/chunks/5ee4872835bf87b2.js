(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,107233,e=>{"use strict";let r=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>r],107233)},263488,e=>{"use strict";let r=(0,e.i(475254).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);e.s(["Mail",()=>r],263488)},238491,e=>{"use strict";let r=(0,e.i(475254).default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);e.s(["Phone",()=>r],238491)},785817,e=>{"use strict";var r=e.i(843476),t=e.i(271645),s=e.i(647163);e.i(882205);var a=e.i(846932);let i=t.forwardRef(({className:e,columns:t=4,gap:a="md",children:i,...n},l)=>(0,r.jsx)("div",{ref:l,className:(0,s.cn)("grid",{1:"grid-cols-1",2:"grid-cols-1 md:grid-cols-2",3:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3",4:"grid-cols-1 md:grid-cols-2 lg:grid-cols-4"}[t],{sm:"gap-4",md:"gap-6",lg:"gap-8"}[a],e),...n,children:i}));i.displayName="BentoGrid";let n=t.forwardRef(({className:e,span:t=1,rowSpan:i=1,children:n,...l},o)=>(0,r.jsx)(a.motion.div,{ref:o,className:(0,s.cn)({1:"col-span-1",2:"col-span-1 md:col-span-2",3:"col-span-1 md:col-span-2 lg:col-span-3",4:"col-span-1 md:col-span-2 lg:col-span-4"}[t],{1:"row-span-1",2:"row-span-1 md:row-span-2",3:"row-span-1 md:row-span-3"}[i],e),initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:[.16,1,.3,1]},...l,children:n}));n.displayName="BentoCard",e.s(["BentoCard",()=>n,"BentoGrid",()=>i])},879002,e=>{"use strict";let r=(0,e.i(475254).default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);e.s(["UserPlus",()=>r],879002)},246704,779478,e=>{"use strict";var r,t,s=e.i(790224),a=((r={}).AUTH_REQUIRED="AUTH_1001",r.AUTH_INVALID_CREDENTIALS="AUTH_1002",r.AUTH_SESSION_EXPIRED="AUTH_1003",r.AUTH_INSUFFICIENT_PERMISSIONS="AUTH_1004",r.AUTH_2FA_REQUIRED="AUTH_1005",r.AUTH_2FA_INVALID="AUTH_1006",r.VALIDATION_ERROR="VALID_2001",r.VALIDATION_REQUIRED_FIELD="VALID_2002",r.VALIDATION_INVALID_FORMAT="VALID_2003",r.VALIDATION_UNIQUE_CONSTRAINT="VALID_2004",r.DB_CONNECTION_ERROR="DB_3001",r.DB_QUERY_ERROR="DB_3002",r.DB_NOT_FOUND="DB_3003",r.DB_CONSTRAINT_VIOLATION="DB_3004",r.DB_FOREIGN_KEY_CONSTRAINT="DB_3006",r.DB_RLS_POLICY_VIOLATION="DB_3005",r.NETWORK_ERROR="NET_4001",r.API_TIMEOUT="NET_4002",r.API_RATE_LIMIT="NET_4003",r.API_SERVER_ERROR="NET_4004",r.API_NOT_FOUND="NET_4005",r.API_BAD_REQUEST="NET_4006",r.BUSINESS_LOGIC_ERROR="BIZ_5001",r.RESOURCE_LOCKED="BIZ_5002",r.OPERATION_NOT_ALLOWED="BIZ_5003",r.QUOTA_EXCEEDED="BIZ_5004",r.INTERNAL_ERROR="SYS_6001",r.CONFIGURATION_ERROR="SYS_6002",r.SERVICE_UNAVAILABLE="SYS_6003",r);(t={}).LOW="low",t.MEDIUM="medium",t.HIGH="high",t.CRITICAL="critical";class i extends Error{code;severity;userMessage;retryable;context;originalError;constructor(e,r="SYS_6001",t="medium",s={},a){super(e),this.name="AppError",this.code=r,this.severity=t,this.userMessage=s.userMessage||this.getDefaultUserMessage(r),this.retryable=s.retryable??this.isRetryable(r),this.context={...s,code:r,severity:t,timestamp:new Date().toISOString()},this.originalError=a,Error.captureStackTrace&&Error.captureStackTrace(this,i)}getDefaultUserMessage(e){return({AUTH_1001:"Vous devez être connecté pour effectuer cette action.",AUTH_1002:"Email ou mot de passe incorrect.",AUTH_1003:"Votre session a expiré. Veuillez vous reconnecter.",AUTH_1004:"Vous n'avez pas les permissions nécessaires.",AUTH_1005:"Authentification à deux facteurs requise.",AUTH_1006:"Code d'authentification invalide.",VALID_2001:"Les données fournies ne sont pas valides.",VALID_2002:"Certains champs obligatoires sont manquants.",VALID_2003:"Le format des données est incorrect.",VALID_2004:"Cette valeur existe déjà.",DB_3001:"Impossible de se connecter à la base de données.",DB_3002:"Erreur lors de l'exécution de la requête.",DB_3003:"Ressource introuvable.",DB_3004:"Cette opération viole une contrainte de la base de données.",DB_3006:"Cette opération viole une contrainte de clé étrangère.",DB_3005:"Vous n'avez pas accès à cette ressource.",NET_4001:"Erreur de connexion réseau. Vérifiez votre connexion internet.",NET_4002:"La requête a pris trop de temps. Veuillez réessayer.",NET_4003:"Trop de requêtes. Veuillez patienter quelques instants.",NET_4004:"Erreur serveur. Veuillez réessayer plus tard.",NET_4005:"Ressource introuvable.",NET_4006:"Requête invalide.",BIZ_5001:"Cette opération n'est pas autorisée dans le contexte actuel.",BIZ_5002:"Cette ressource est actuellement verrouillée.",BIZ_5003:"Cette opération n'est pas autorisée.",BIZ_5004:"Vous avez atteint la limite autorisée.",SYS_6001:"Une erreur interne est survenue. Veuillez réessayer.",SYS_6002:"Erreur de configuration du système.",SYS_6003:"Service temporairement indisponible."})[e]||"Une erreur inattendue est survenue."}isRetryable(e){return["NET_4001","NET_4002","NET_4004","DB_3001","SYS_6003"].includes(e)}toJSON(){return{name:this.name,message:this.message,code:this.code,severity:this.severity,userMessage:this.userMessage,retryable:this.retryable,context:this.context,stack:this.stack,originalError:this.originalError instanceof Error?{name:this.originalError.name,message:this.originalError.message,stack:this.originalError.stack}:this.originalError}}}let n=new class{handleError(e,r={}){if(e instanceof i)return this.logError(e),e;if(e instanceof Error)return this.handleStandardError(e,r);if(this.isSupabaseError(e))return this.handleSupabaseError(e,r);let t=new i("Une erreur inattendue est survenue.","SYS_6001","high",r,e);return this.logError(t),t}handleStandardError(e,r){let t=e.message.toLowerCase(),s="SYS_6001",a="medium";t.includes("network")||t.includes("fetch")?(s="NET_4001",a="medium"):t.includes("timeout")?(s="NET_4002",a="medium"):t.includes("unauthorized")||t.includes("401")?(s="AUTH_1001",a="high"):t.includes("forbidden")||t.includes("403")?(s="AUTH_1004",a="high"):t.includes("not found")||t.includes("404")?(s="DB_3003",a="low"):(t.includes("validation")||t.includes("invalid"))&&(s="VALID_2001",a="low");let n=new i(e.message,s,a,r,e);return this.logError(n),n}handleSupabaseError(e,r){let t=e.code||e.status,s=e.message||"Erreur Supabase",a=r.code||"DB_3002",n="medium";if(!r.code)switch(t){case"PGRST116":case"42P01":a="DB_3003",n="low";break;case"42501":a="DB_3005",n="high";break;case"23505":a="VALID_2004",n="low";break;case"23503":a="DB_3004",n="medium";break;case"PGRST301":case"400":a="NET_4006",n="low";break;case"401":a="AUTH_1001",n="high";break;case"403":a="AUTH_1004",n="high";break;case"404":a="NET_4005",n="low";break;case"500":a="NET_4004",n="high"}"DB_3006"===a&&(n="medium");let l=new i(s,a,n,r,e);return this.logError(l),l}isSupabaseError(e){return e&&(e.code||e.status||e.message)&&("string"==typeof e.code||"number"==typeof e.status)}logError(e){let r={...e.context,code:e.code,severity:e.severity,retryable:e.retryable};switch(e.severity){case"critical":case"high":s.logger.error(e.message,e.originalError||e,r);break;case"medium":s.logger.warn(e.message,r);break;case"low":s.logger.info(`Error: ${e.message}`,r)}}createValidationError(e,r){return new i(e,"VALID_2001","low",{field:r,userMessage:e})}createAuthError(e,r){return new i(r||"Erreur d'authentification",e,"high")}createDatabaseError(e,r){return new i(e,"DB_3002","medium",{},r)}createNotFoundError(e,r){return new i(e,"DB_3003","low",r)}};e.s(["AppError",()=>i,"ErrorCode",()=>a,"errorHandler",0,n],779478),e.s([],246704)},627404,e=>{"use strict";e.i(246704);var r=e.i(779478);async function t(e,t,s,a){try{let i=e.from(t).select(a?.select||"*").eq("organization_id",s);a?.filters&&Object.entries(a.filters).forEach(([e,r])=>{null!=r&&(i=i.eq(e,r))}),a?.search&&(i=i.ilike(a.search.field,`%${a.search.value}%`)),i=a?.orderBy?i.order(a.orderBy.column,{ascending:a.orderBy.ascending??!1}):i.order("created_at",{ascending:!1});let{data:n,error:l}=await i;if(l)throw r.errorHandler.handleError(l,{organizationId:s,operation:"getAllByOrganization",table:t});return n||[]}catch(e){if(e instanceof r.AppError)throw e;throw r.errorHandler.handleError(e,{organizationId:s,operation:"getAllByOrganization",table:t})}}async function s(e,t,s,a){try{let{data:i,error:n}=await e.from(t).select(a||"*").eq("id",s).single();if(n){if("PGRST116"===n.code||"42P01"===n.code)throw r.errorHandler.handleError(n,{code:r.ErrorCode.DB_NOT_FOUND,operation:"getById",id:s,table:t});throw r.errorHandler.handleError(n,{operation:"getById",id:s,table:t})}if(!i)throw r.errorHandler.createDatabaseError(`Enregistrement avec l'ID ${s} introuvable dans ${t}`,{id:s,table:t});return i}catch(e){if(e instanceof r.AppError)throw e;throw r.errorHandler.handleError(e,{operation:"getById",id:s,table:t})}}e.s(["getAllByOrganization",()=>t,"getById",()=>s])},34458,e=>{"use strict";e.i(246704);var r=e.i(779478);function t(e,t){for(let s of t)if(!e[s])throw r.errorHandler.createValidationError(`Le champ ${String(s)} est obligatoire`,String(s))}e.s(["validateRequired",()=>t])},163454,e=>{"use strict";var r=e.i(920755);e.i(246704);var t=e.i(779478),s=e.i(790224),a=e.i(627404);async function i(e,r,s,a){try{let i=a.year||new Date().getFullYear().toString().slice(-2),n=a.padding||6,l=a.fieldName||"number",o=`${a.prefix}-${a.orgCode}-${i}-%`,{data:d,error:c}=await e.from(r).select(l).eq("organization_id",s).like(l,o).order(l,{ascending:!1}).limit(1).maybeSingle();if(c&&"PGRST116"!==c.code&&"42P01"!==c.code)throw t.errorHandler.handleError(c,{operation:"generateUniqueNumber",table:r,organizationId:s});let u=1;if(d&&d[l]){let e=String(d[l]).split("-");u=parseInt(e[e.length-1]||"0",10)+1}return`${a.prefix}-${a.orgCode}-${i}-${String(u).padStart(n,"0")}`}catch(e){throw t.errorHandler.handleError(e,{operation:"generateUniqueNumber",table:r,organizationId:s})}}var n=e.i(34458);let l=new class{supabase;constructor(e){this.supabase=e||(0,r.createClient)()}async getAll(e,r){try{let s=r?.page||1,a=r?.limit||50,i=(s-1)*a;if(r?.search){let n=this.supabase.from("students").select("*, classes(id, name, level)",{count:"exact"}).eq("organization_id",e).or(`first_name.ilike.%${r.search}%,last_name.ilike.%${r.search}%,student_number.ilike.%${r.search}%`);r?.classId&&(n=n.eq("class_id",r.classId)),r?.status&&(n=n.eq("status",r.status));let{data:l,error:o,count:d}=await n.order("last_name",{ascending:!0}).range(i,i+a-1);if(o)throw t.errorHandler.handleError(o,{organizationId:e,operation:"getAll",filters:r});return{data:l||[],total:d||0,page:s,limit:a,totalPages:Math.ceil((d||0)/a)}}let n=this.supabase.from("students").select("*, classes(id, name, level)",{count:"exact"}).eq("organization_id",e);r?.classId&&(n=n.eq("class_id",r.classId)),r?.status&&(n=n.eq("status",r.status));let{data:l,error:o,count:d}=await n.order("last_name",{ascending:!0}).range(i,i+a-1);if(o)throw t.errorHandler.handleError(o,{organizationId:e,operation:"getAll",filters:r});return{data:l||[],total:d||0,page:s,limit:a,totalPages:Math.ceil((d||0)/a)}}catch(r){if(r instanceof t.AppError)throw r;throw t.errorHandler.handleError(r,{organizationId:e,operation:"getAll"})}}async getById(e){try{return(0,a.getById)(this.supabase,"students",e,"*, classes(id, name, level)")}catch(r){if(r instanceof t.AppError)throw r;throw t.errorHandler.handleError(r,{operation:"getById",id:e})}}async getByNumber(e,r){try{let{data:s,error:a}=await this.supabase.from("students").select("*").eq("organization_id",e).eq("student_number",r).single();if(a){if("PGRST116"===a.code||"42P01"===a.code)throw t.errorHandler.handleError(a,{code:t.ErrorCode.DB_NOT_FOUND,operation:"getByNumber",organizationId:e,studentNumber:r});throw t.errorHandler.handleError(a,{operation:"getByNumber",organizationId:e,studentNumber:r})}return s}catch(s){if(s instanceof t.AppError)throw s;throw t.errorHandler.handleError(s,{operation:"getByNumber",organizationId:e,studentNumber:r})}}async create(e){try{(0,n.validateRequired)(e,["first_name","last_name","organization_id"]);let r=e.student_number;if(!r||""===r.trim()){let t=e.organization_id;if(!t)throw Error("organization_id is required");let{data:s}=await this.supabase.from("organizations").select("code").eq("id",t).single(),a=s?.code||"ORG",n=new Date().getFullYear().toString().slice(-2);r=await i(this.supabase,"students",t,{prefix:"EDU",orgCode:a,year:n,padding:6,fieldName:"student_number"})}let a={...e,student_number:r},{data:l,error:o}=await this.supabase.from("students").insert(a).select().single();if(o){if("23505"===o.code)throw t.errorHandler.handleError(o,{code:t.ErrorCode.VALIDATION_UNIQUE_CONSTRAINT,operation:"create",field:"student_number"});if("42501"===o.code)throw t.errorHandler.handleError(o,{code:t.ErrorCode.DB_RLS_POLICY_VIOLATION,operation:"create"});throw t.errorHandler.handleError(o,{operation:"create",student:e})}return s.logger.info("Étudiant créé avec succès",{id:l?.id,organizationId:e.organization_id||void 0,studentNumber:l?.student_number}),l}catch(r){if(r instanceof t.AppError)throw r;throw t.errorHandler.handleError(r,{operation:"create",student:e})}}async update(e,r){try{let a={...r};if("class_id"in a)if(""!==a.class_id&&a.class_id){let{data:e,error:r}=await this.supabase.from("classes").select("id").eq("id",a.class_id).maybeSingle();e||r||(a.class_id=null)}else a.class_id=null;let{data:i,error:n}=await this.supabase.from("students").update(a).eq("id",e).select().single();if(n){if("PGRST116"===n.code||"42P01"===n.code)throw t.errorHandler.handleError(n,{code:t.ErrorCode.DB_NOT_FOUND,operation:"update",id:e});if("42501"===n.code)throw t.errorHandler.handleError(n,{code:t.ErrorCode.DB_RLS_POLICY_VIOLATION,operation:"update",id:e});throw t.errorHandler.handleError(n,{operation:"update",id:e,updates:r})}if(!i)throw t.errorHandler.createDatabaseError(`\xc9tudiant avec l'ID ${e} introuvable pour la mise \xe0 jour`,{id:e});return s.logger.info("Étudiant mis à jour avec succès",{id:e,updates:r}),i}catch(s){if(s instanceof t.AppError)throw s;throw t.errorHandler.handleError(s,{operation:"update",id:e,updates:r})}}async delete(e){return this.update(e,{status:"inactive"})}async import(e,r){try{if(!r||0===r.length)throw t.errorHandler.createValidationError("Aucun étudiant à importer","students");let{data:a}=await this.supabase.from("organizations").select("code").eq("id",e).single(),n=a?.code||"ORG",l=new Date().getFullYear().toString().slice(-2),o=await Promise.all(r.map(async r=>{if(r.student_number&&""!==r.student_number.trim())return r;let t=await i(this.supabase,"students",e,{prefix:"EDU",orgCode:n,year:l,padding:6,fieldName:"student_number"});return{...r,student_number:t}})),{data:d,error:c}=await this.supabase.from("students").insert(o).select();if(c){if("23505"===c.code)throw t.errorHandler.handleError(c,{code:t.ErrorCode.VALIDATION_UNIQUE_CONSTRAINT,operation:"import",field:"student_number"});throw t.errorHandler.handleError(c,{operation:"import",organizationId:e,count:r.length})}return s.logger.info("Étudiants importés avec succès",{organizationId:e,count:d?.length||0}),d||[]}catch(r){if(r instanceof t.AppError)throw r;throw t.errorHandler.handleError(r,{operation:"import",organizationId:e})}}};e.s(["studentService",0,l],163454)},304488,e=>{"use strict";var r=e.i(843476),t=e.i(271645),s=e.i(266027),a=e.i(912598);e.i(882205);var i=e.i(846932),n=e.i(88653),l=e.i(761911),o=e.i(879002),d=e.i(555436),c=e.i(465286),u=e.i(898791),m=e.i(107233),h=e.i(37727),p=e.i(284614),x=e.i(263488),g=e.i(238491),f=e.i(212426),_=e.i(629377),N=e.i(325715),b=e.i(920755),y=e.i(163454),j=e.i(6799),v=e.i(167881),w=e.i(23750),E=e.i(10708),I=e.i(645760),A=e.i(785817),T=e.i(994179),C=e.i(63270),S=e.i(647163),D=e.i(209372);function B({sessionId:e,formationId:B,enrollments:R=[],students:O=[],enrollmentForm:U,onEnrollmentFormChange:L,onCreateEnrollment:H,createEnrollmentMutation:P,formationPrice:k}){let{user:z}=(0,N.useAuth)(),{addToast:V}=(0,j.useToast)();(0,a.useQueryClient)();let q=(0,b.createClient)(),[M,F]=(0,t.useState)(""),[G,$]=(0,t.useState)(!1),[Y,Q]=(0,t.useState)(!1),{data:Z}=(0,s.useQuery)({queryKey:["formation-candidates",B,z?.organization_id],queryFn:async()=>{if(!B||!z?.organization_id)return[];let{data:r}=await q.from("sessions").select("id").eq("formation_id",B).eq("organization_id",z.organization_id).neq("id",e);if(!r||0===r.length)return[];let t=r.map(e=>e.id),{data:s}=await q.from("enrollments").select("student_id").in("session_id",t).in("status",["confirmed","pending"]);if(!s||0===s.length)return[];let a=[...new Set(s.map(e=>e.student_id).filter(e=>null!==e))],{data:i}=await q.from("students").select(`
          id,
          first_name,
          last_name,
          student_number,
          email,
          phone,
          photo_url,
          date_of_birth,
          gender,
          address,
          city,
          status,
          organization_id
        `).in("id",a.filter(e=>null!==e)).eq("organization_id",z.organization_id).eq("status","active").order("last_name",{ascending:!0});return i||[]},enabled:!!B&&!!z?.organization_id&&!!e}),{data:K}=(0,s.useQuery)({queryKey:["all-students",z?.organization_id],queryFn:async()=>z?.organization_id?y.studentService.getAll(z.organization_id,{status:"active"}):{data:[],total:0,page:1,limit:50,totalPages:0},enabled:!!z?.organization_id}),W=K?.data||[],X=(0,t.useMemo)(()=>{if(!Z)return[];if(!M)return Z;let e=M.toLowerCase();return Z.filter(r=>r.first_name?.toLowerCase().includes(e)||r.last_name?.toLowerCase().includes(e)||r.student_number?.toLowerCase().includes(e)||r.email?.toLowerCase().includes(e))},[Z,M]),J=(0,t.useMemo)(()=>{if(!W||!Array.isArray(W))return[];if(!M)return W;let e=M.toLowerCase();return W.filter(r=>r.first_name?.toLowerCase().includes(e)||r.last_name?.toLowerCase().includes(e)||r.student_number?.toLowerCase().includes(e)||r.email?.toLowerCase().includes(e))},[W,M]),ee=(0,t.useMemo)(()=>new Set(R?.map(e=>e.student_id)||[]),[R]),er=(0,t.useMemo)(()=>X.filter(e=>!ee.has(e.id)),[X,ee]),et=(0,t.useMemo)(()=>Array.isArray(J)?J.filter(e=>!ee.has(e.id)&&!Z?.some(r=>r.id===e.id)):[],[J,ee,Z]),es=e=>{L({...U,student_id:e,enrollment_date:new Date().toISOString().split("T")[0],total_amount:k?.toString()||U.total_amount||"0"}),$(!0)},ea=async()=>{try{D.enrollmentSchema.parse({...U,session_id:e}),H()}catch(e){(e instanceof Error||e.errors)&&V({type:"error",title:"Erreur de validation",description:(e.errors||[]).map(e=>`${e.path.join(".")}: ${e.message}`).join(", ")})}},ei=(0,t.useMemo)(()=>{let e=R?.length||0;return{enrolled:e,candidates:Z?.length||0,available:er.length}},[R,Z,er]);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(A.BentoGrid,{columns:3,gap:"md",children:[(0,r.jsx)(A.BentoCard,{span:1,children:(0,r.jsxs)(I.GlassCard,{variant:"premium",hoverable:!0,className:"h-full p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"p-2 bg-brand-blue-ghost rounded-xl",children:(0,r.jsx)(l.Users,{className:"h-4 w-4 text-brand-blue"})}),(0,r.jsx)("span",{className:"text-2xl font-bold text-brand-blue",children:ei.enrolled})]}),(0,r.jsx)("p",{className:"text-xs font-medium text-gray-600",children:"Inscrits à la session"})]})}),(0,r.jsx)(A.BentoCard,{span:1,children:(0,r.jsxs)(I.GlassCard,{variant:"premium",hoverable:!0,className:"h-full p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"p-2 bg-purple-50 rounded-xl",children:(0,r.jsx)(o.UserPlus,{className:"h-4 w-4 text-purple-600"})}),(0,r.jsx)("span",{className:"text-2xl font-bold text-purple-600",children:ei.candidates})]}),(0,r.jsx)("p",{className:"text-xs font-medium text-gray-600",children:"Candidats de la formation"})]})}),(0,r.jsx)(A.BentoCard,{span:1,children:(0,r.jsxs)(I.GlassCard,{variant:"premium",hoverable:!0,className:"h-full p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("div",{className:"p-2 bg-green-50 rounded-xl",children:(0,r.jsx)(c.CheckCircle2,{className:"h-4 w-4 text-green-600"})}),(0,r.jsx)("span",{className:"text-2xl font-bold text-green-600",children:ei.available})]}),(0,r.jsx)("p",{className:"text-xs font-medium text-gray-600",children:"Disponibles"})]})})]}),(0,r.jsx)(I.GlassCard,{variant:"default",className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(d.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)(w.Input,{placeholder:"Rechercher un candidat ou étudiant...",value:M,onChange:e=>F(e.target.value),className:"pl-10"})]}),(0,r.jsxs)(v.Button,{onClick:()=>{Q(!0)},className:"shadow-lg shadow-brand-blue/20",children:[(0,r.jsx)(m.Plus,{className:"h-4 w-4 mr-2"}),"Nouvel étudiant"]})]})}),B&&(0,r.jsxs)(I.GlassCard,{variant:"premium",className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[(0,r.jsx)(o.UserPlus,{className:"h-5 w-5 text-purple-600"}),"Candidats de la formation"]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Étudiants inscrits à d'autres sessions de cette formation"})]}),(0,r.jsxs)(T.Badge,{variant:"outline",className:"text-purple-600 border-purple-200",children:[er.length," disponible",er.length>1?"s":""]})]}),0===er.length?(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)(o.UserPlus,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),(0,r.jsx)("p",{className:"text-sm",children:M?"Aucun candidat trouvé avec ce critère":"Aucun candidat disponible pour cette formation"})]}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:er.map(e=>{let t=e.first_name||"",s=e.last_name||"",a=e.student_number||"",n=e.email||"",l=e.phone||"";return(0,r.jsx)(i.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-4 rounded-lg border border-gray-200 hover:border-purple-300 hover:shadow-md transition-all bg-white",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(C.Avatar,{fallback:`${t[0]||""}${s[0]||""}`,userId:e.id,size:"md",src:e.photo_url||void 0}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("p",{className:"font-medium text-gray-900 truncate",children:[t," ",s]}),a&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5 font-mono",children:["#",a]})]}),(0,r.jsx)(T.Badge,{variant:"outline",className:"text-xs border-purple-200 text-purple-600 flex-shrink-0",children:"Candidat"})]}),(0,r.jsxs)("div",{className:"mt-2 space-y-1",children:[n&&(0,r.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[(0,r.jsx)(x.Mail,{className:"h-3 w-3 flex-shrink-0"}),(0,r.jsx)("span",{className:"truncate",children:n})]}),l&&(0,r.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[(0,r.jsx)(g.Phone,{className:"h-3 w-3 flex-shrink-0"}),(0,r.jsx)("span",{children:l})]})]}),(0,r.jsxs)(v.Button,{size:"sm",className:"w-full mt-3",onClick:()=>es(e.id),disabled:P.isPending,children:[(0,r.jsx)(o.UserPlus,{className:"h-3 w-3 mr-1"}),"Inscrire"]})]})]})},e.id)})})]}),et.length>0&&(0,r.jsxs)(I.GlassCard,{variant:"default",className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[(0,r.jsx)(l.Users,{className:"h-5 w-5 text-brand-blue"}),"Autres étudiants disponibles"]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Étudiants actifs de l'organisation"})]}),(0,r.jsxs)(T.Badge,{variant:"outline",className:"text-brand-blue border-brand-blue-200",children:[et.length," disponible",et.length>1?"s":""]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:et.slice(0,12).map(e=>{let t=e.first_name||"",s=e.last_name||"",a=e.student_number||"",n=e.email||"",l=e.phone||"";return(0,r.jsx)(i.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-4 rounded-lg border border-gray-200 hover:border-brand-blue-300 hover:shadow-md transition-all bg-white",children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)(C.Avatar,{fallback:`${t[0]||""}${s[0]||""}`,userId:e.id,size:"md",src:e.photo_url||void 0}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("div",{className:"flex items-start justify-between gap-2",children:(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("p",{className:"font-medium text-gray-900 truncate",children:[t," ",s]}),a&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5 font-mono",children:["#",a]})]})}),(0,r.jsxs)("div",{className:"mt-2 space-y-1",children:[n&&(0,r.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[(0,r.jsx)(x.Mail,{className:"h-3 w-3 flex-shrink-0"}),(0,r.jsx)("span",{className:"truncate",children:n})]}),l&&(0,r.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[(0,r.jsx)(g.Phone,{className:"h-3 w-3 flex-shrink-0"}),(0,r.jsx)("span",{children:l})]})]}),(0,r.jsxs)(v.Button,{size:"sm",variant:"outline",className:"w-full mt-3",onClick:()=>es(e.id),disabled:P.isPending,children:[(0,r.jsx)(o.UserPlus,{className:"h-3 w-3 mr-1"}),"Inscrire"]})]})]})},e.id)})}),et.length>12&&(0,r.jsxs)("p",{className:"text-center text-sm text-gray-500 mt-4",children:["+ ",et.length-12," autre",et.length-12>1?"s":""," étudiant",et.length-12>1?"s":""]})]}),R&&R.length>0&&(0,r.jsxs)(I.GlassCard,{variant:"premium",className:"p-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[(0,r.jsx)(c.CheckCircle2,{className:"h-5 w-5 text-green-600"}),"Apprenants inscrits"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[R.length," apprenant",R.length>1?"s":""," déjà inscrit",R.length>1?"s":""," à cette session"]})]})}),(0,r.jsx)("div",{className:"space-y-2",children:R.map(e=>{let t=e.students||null;if(!t)return(0,r.jsxs)(i.motion.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"flex items-center justify-between p-3 rounded-lg bg-amber-50/50 border border-amber-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"h-10 w-10 rounded-full bg-amber-200 flex items-center justify-center",children:(0,r.jsx)(p.User,{className:"h-5 w-5 text-amber-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-medium text-gray-900",children:["Étudiant ID: ",e.student_id]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:["Inscrit le ",(0,S.formatDate)(e.enrollment_date||"")]}),(0,r.jsx)(T.Badge,{variant:"confirmed"===e.status?"default":"pending"===e.status?"outline":"secondary",className:"text-xs",children:"confirmed"===e.status?"Confirmé":"pending"===e.status?"En attente":e.status})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.total_amount&&parseFloat(String(e.total_amount))>0&&(0,r.jsx)(T.Badge,{variant:"outline",className:"text-xs",children:(0,S.formatCurrency)(parseFloat(String(e.total_amount)))}),(0,r.jsx)(u.AlertCircle,{className:"h-5 w-5 text-amber-600"})]})]},e.id);let s=t.first_name||"",a=t.last_name||"",n=t.student_number||"",l=t.email||"",o=t.phone||"";return(0,r.jsxs)(i.motion.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"flex items-center justify-between p-3 rounded-lg bg-green-50/50 border border-green-200 hover:bg-green-50 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,r.jsx)(C.Avatar,{fallback:`${s[0]||""}${a[0]||""}`,userId:t.id,size:"sm",src:t.photo_url||void 0}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("p",{className:"font-medium text-gray-900 truncate",children:[s," ",a]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 mt-1 text-xs text-gray-500 flex-wrap",children:[n&&(0,r.jsxs)("span",{className:"font-mono",children:["#",n]}),(0,r.jsxs)("span",{children:["Inscrit le ",(0,S.formatDate)(e.enrollment_date||"")]}),(0,r.jsx)(T.Badge,{variant:"confirmed"===e.status?"default":"pending"===e.status?"outline":"secondary",className:"text-xs",children:"confirmed"===e.status?"Confirmé":"pending"===e.status?"En attente":e.status})]}),(l||o)&&(0,r.jsxs)("div",{className:"flex items-center gap-3 mt-1.5 text-xs text-gray-500",children:[l&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(x.Mail,{className:"h-3 w-3"}),(0,r.jsx)("span",{className:"truncate",children:l})]}),o&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(g.Phone,{className:"h-3 w-3"}),(0,r.jsx)("span",{children:o})]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[e.total_amount&&parseFloat(String(e.total_amount))>0&&(0,r.jsx)(T.Badge,{variant:"outline",className:"text-xs whitespace-nowrap",children:(0,S.formatCurrency)(parseFloat(String(e.total_amount)))}),(0,r.jsx)(c.CheckCircle2,{className:"h-5 w-5 text-green-600 flex-shrink-0"})]})]},e.id)})})]}),(!R||0===R.length)&&(0,r.jsx)(I.GlassCard,{variant:"default",className:"p-6",children:(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(l.Users,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),(0,r.jsx)("p",{className:"text-gray-600 font-medium mb-2",children:"Aucun apprenant inscrit"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Inscrivez des candidats ou des étudiants à cette session pour commencer."})]})}),(0,r.jsx)(n.AnimatePresence,{children:G&&(0,r.jsx)(i.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},children:(0,r.jsxs)(I.GlassCard,{variant:"premium",className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Inscrire un apprenant"}),(0,r.jsx)(v.Button,{variant:"ghost",size:"icon",onClick:()=>{$(!1),L({student_id:"",enrollment_date:new Date().toISOString().split("T")[0],status:"confirmed",payment_status:"pending",total_amount:k?.toString()||"0",paid_amount:"0"})},children:(0,r.jsx)(h.X,{className:"h-4 w-4"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(E.Label,{htmlFor:"enrollment_date",children:"Date d'inscription *"}),(0,r.jsx)(w.Input,{id:"enrollment_date",type:"date",value:U.enrollment_date,onChange:e=>L({...U,enrollment_date:e.target.value})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(E.Label,{htmlFor:"status",children:"Statut *"}),(0,r.jsxs)("select",{id:"status",value:U.status||"pending",onChange:e=>L({...U,status:e.target.value}),className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-brand-blue/20 focus:border-brand-blue text-sm",children:[(0,r.jsx)("option",{value:"pending",children:"En attente"}),(0,r.jsx)("option",{value:"confirmed",children:"Confirmé"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(E.Label,{htmlFor:"total_amount",children:"Montant total"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(f.DollarSign,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)(w.Input,{id:"total_amount",type:"number",step:"0.01",value:U.total_amount,onChange:e=>L({...U,total_amount:e.target.value}),className:"pl-10",placeholder:"0.00"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(E.Label,{htmlFor:"paid_amount",children:"Montant payé"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(f.DollarSign,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)(w.Input,{id:"paid_amount",type:"number",step:"0.01",value:U.paid_amount,onChange:e=>L({...U,paid_amount:e.target.value}),className:"pl-10",placeholder:"0.00"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(E.Label,{htmlFor:"payment_status",children:"Statut de paiement"}),(0,r.jsxs)("select",{id:"payment_status",value:U.payment_status||"pending",onChange:e=>L({...U,payment_status:e.target.value}),className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-brand-blue/20 focus:border-brand-blue text-sm",children:[(0,r.jsx)("option",{value:"pending",children:"En attente"}),(0,r.jsx)("option",{value:"partial",children:"Partiel"}),(0,r.jsx)("option",{value:"paid",children:"Payé"})]})]}),P.error&&(0,r.jsxs)("div",{className:"p-3 rounded-lg bg-red-50 border border-red-200 flex items-start gap-2",children:[(0,r.jsx)(u.AlertCircle,{className:"h-4 w-4 text-red-600 mt-0.5"}),(0,r.jsx)("p",{className:"text-sm text-red-600",children:P.error instanceof Error?P.error.message:"Une erreur est survenue"})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(v.Button,{variant:"outline",onClick:()=>{$(!1),L({student_id:"",enrollment_date:new Date().toISOString().split("T")[0],status:"confirmed",payment_status:"pending",total_amount:k?.toString()||"0",paid_amount:"0"})},children:"Annuler"}),(0,r.jsx)(v.Button,{onClick:ea,disabled:P.isPending||!U.student_id,className:"shadow-lg shadow-brand-blue/20",children:P.isPending?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(_.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Inscription..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.UserPlus,{className:"h-4 w-4 mr-2"}),"Inscrire"]})})]})]})]})})}),!B&&(0,r.jsx)(I.GlassCard,{variant:"default",className:"p-6",children:(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(u.AlertCircle,{className:"h-12 w-12 mx-auto mb-3 text-amber-500"}),(0,r.jsx)("p",{className:"text-gray-600 font-medium mb-2",children:"Aucune formation sélectionnée"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Veuillez d'abord sélectionner une formation dans l'onglet \"Programme\" pour voir les candidats."})]})})]})}e.s(["ConfigApprenants",()=>B])}]);