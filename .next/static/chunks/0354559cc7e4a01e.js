(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,645760,e=>{"use strict";var s=e.i(843476),a=e.i(271645),t=e.i(647163);e.i(882205);var r=e.i(846932);let i=a.forwardRef(({className:e,variant:a="default",hoverable:i=!1,glow:n=!1,glowColor:l="rgba(51, 90, 207, 0.3)",...d},c)=>(0,s.jsxs)(r.motion.div,{ref:c,className:(0,t.cn)("relative rounded-2xl border backdrop-blur-xl transition-all duration-300",{"bg-white/70 dark:bg-gray-900/70 border-white/20 dark:border-gray-700/30 shadow-lg":"default"===a,"bg-white/80 dark:bg-gray-900/80 border-white/30 dark:border-gray-700/40 shadow-xl":"premium"===a,"bg-white/50 dark:bg-gray-900/50 border-white/10 dark:border-gray-700/20 shadow-md":"subtle"===a,"cursor-pointer":i,"hover:shadow-2xl hover:scale-[1.02]":i,"hover:bg-white/90 dark:hover:bg-gray-900/90":i},e),whileHover:i?{scale:1.02,y:-2}:void 0,transition:{type:"spring",stiffness:300,damping:30},...d,children:[n&&(0,s.jsx)(r.motion.div,{className:"absolute inset-0 rounded-2xl opacity-0 blur-xl",style:{background:`radial-gradient(circle, ${l} 0%, transparent 70%)`},animate:{opacity:[0,.5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"}}),(0,s.jsx)("div",{className:"relative z-10",children:d.children})]}));i.displayName="GlassCard",e.s(["GlassCard",()=>i])},263488,e=>{"use strict";let s=(0,e.i(475254).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);e.s(["Mail",()=>s],263488)},286536,e=>{"use strict";let s=(0,e.i(475254).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],286536)},338456,e=>{"use strict";let s=(0,e.i(475254).default)("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);e.s(["PlayCircle",()=>s],338456)},238491,e=>{"use strict";let s=(0,e.i(475254).default)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);e.s(["Phone",()=>s],238491)},698903,e=>{"use strict";var s=e.i(843476),a=e.i(266027),t=e.i(920755),r=e.i(325715),i=e.i(970065),n=e.i(645760),l=e.i(167881),d=e.i(23750),c=e.i(994179),o=e.i(761911),m=e.i(555436),u=e.i(263488),x=e.i(238491),h=e.i(32095),p=e.i(191741),g=e.i(286536),y=e.i(465286),j=e.i(810980),f=e.i(338456),b=e.i(522016),v=e.i(271645);e.i(882205);var N=e.i(846932),w=e.i(647163),_=e.i(779700);function C(){let e=(0,t.createClient)(),{user:C}=(0,r.useAuth)(),k=(0,_.useVocabulary)(),[q,E]=(0,v.useState)(""),{data:L,isLoading:O}=(0,a.useQuery)({queryKey:["teacher-sessions",C?.id],queryFn:async()=>{if(!C?.id)return[];let{data:s,error:a}=await e.from("session_teachers").select(`
          session_id,
          sessions (
            id,
            name,
            start_date,
            end_date,
            status,
            formation_id,
            formations (
              id,
              name
            )
          )
        `).eq("teacher_id",C.id);return a?(console.error("Erreur récupération sessions enseignant:",a),[]):s||[]},enabled:!!C?.id}),{data:P,isLoading:$}=(0,a.useQuery)({queryKey:["my-students",C?.id,L],queryFn:async()=>{if(!C?.id||!L||0===L.length)return[];let s=L.map(e=>e.session_id),{data:a,error:t}=await e.from("enrollments").select(`
          id,
          status,
          enrolled_at,
          session_id,
          sessions (
            id,
            name,
            start_date,
            end_date,
            formations (
              id,
              name
            )
          ),
          students (
            id,
            first_name,
            last_name,
            email,
            phone,
            status,
            photo_url
          )
        `).in("session_id",s).eq("status","active");return t?(console.error("Erreur récupération apprenants:",t),[]):a||[]},enabled:!!C?.id&&L&&L.length>0}),{data:z}=(0,a.useQuery)({queryKey:["attendance-stats",C?.id,P],queryFn:async()=>{if(!P||0===P.length)return{};let s=P.map(e=>e.students?.id).filter(Boolean),{data:a,error:t}=await e.from("attendance").select("student_id, status").in("student_id",s);if(t)return console.error("Erreur récupération émargements:",t),{};let r={};return a?.forEach(e=>{r[e.student_id]||(r[e.student_id]={present:0,absent:0,late:0,total:0}),r[e.student_id].total++,"present"===e.status?r[e.student_id].present++:"absent"===e.status?r[e.student_id].absent++:"late"===e.status&&r[e.student_id].late++}),r},enabled:!!P&&P.length>0}),A=P?.filter(e=>{let s=e.students;if(!s)return!1;let a=`${s.first_name} ${s.last_name}`.toLowerCase(),t=s.email?.toLowerCase()||"",r=q.toLowerCase();return a.includes(r)||t.includes(r)}),B={};return(A?.forEach(e=>{let s=e.session_id;B[s]||(B[s]=[]),B[s].push(e)}),O||$)?(0,s.jsx)("div",{className:"container mx-auto py-8 px-4",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-blue"})})}):(0,s.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,s.jsxs)(N.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 mb-2 flex items-center gap-3",children:[(0,s.jsx)(o.Users,{className:"h-8 w-8 text-brand-blue"}),"Mes ",k.students]}),(0,s.jsx)("p",{className:"text-gray-600",children:"Gérez les apprenants qui vous sont assignés dans vos sessions de formation"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[(0,s.jsx)(n.GlassCard,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 bg-brand-blue/10 rounded-lg",children:(0,s.jsx)(o.Users,{className:"h-5 w-5 text-brand-blue"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Total apprenants"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:P?.length||0})]})]})}),(0,s.jsx)(n.GlassCard,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 bg-purple-100 rounded-lg",children:(0,s.jsx)(j.BookOpen,{className:"h-5 w-5 text-purple-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Sessions actives"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:L?.filter(e=>e.sessions?.status==="active"||e.sessions?.status==="in_progress").length||0})]})]})}),(0,s.jsx)(n.GlassCard,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,s.jsx)(y.CheckCircle2,{className:"h-5 w-5 text-green-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Taux présence moyen"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:z&&Object.keys(z).length>0?Math.round(Object.values(z).reduce((e,s)=>e+(s.total>0?s.present/s.total*100:0),0)/Object.keys(z).length)+"%":"N/A"})]})]})})]}),(0,s.jsxs)("div",{className:"mb-6 flex flex-col md:flex-row gap-4 items-start md:items-center justify-between",children:[(0,s.jsxs)("div",{className:"relative max-w-md flex-1",children:[(0,s.jsx)(m.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,s.jsx)(d.Input,{type:"text",placeholder:"Rechercher un apprenant...",value:q,onChange:e=>E(e.target.value),className:"pl-10"})]}),(0,s.jsx)(b.default,{href:"/dashboard/my-students/elearning",children:(0,s.jsxs)(l.Button,{variant:"outline",className:"gap-2",children:[(0,s.jsx)(f.PlayCircle,{className:"h-4 w-4 text-purple-600"}),"Suivi E-Learning"]})})]}),0===Object.keys(B).length?(0,s.jsx)(i.Card,{children:(0,s.jsxs)(i.CardContent,{className:"py-12 text-center",children:[(0,s.jsx)(o.Users,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun apprenant assigné"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Vous n'avez pas encore d'apprenants dans vos sessions de formation."})]})}):(0,s.jsx)("div",{className:"space-y-6",children:Object.entries(B).map(([e,a],t)=>{let r=a[0]?.sessions,n=r?.formations;return(0,s.jsx)(N.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},children:(0,s.jsxs)(i.Card,{children:[(0,s.jsx)(i.CardHeader,{className:"border-b",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(h.GraduationCap,{className:"h-5 w-5 text-brand-blue"}),r?.name||"Session"]}),(0,s.jsxs)(i.CardDescription,{className:"mt-1",children:[n?.name," • ",(0,w.formatDate)(r?.start_date)," - ",(0,w.formatDate)(r?.end_date)]})]}),(0,s.jsx)(c.Badge,{variant:r?.status==="active"||r?.status==="in_progress"?"default":"secondary",children:r?.status==="active"||r?.status==="in_progress"?"En cours":r?.status})]})}),(0,s.jsx)(i.CardContent,{className:"p-0",children:(0,s.jsx)("div",{className:"divide-y",children:a.map(a=>{var t;let r,i=a.students;if(!i)return null;let n=(t=i.id,(r=z?.[t])&&0!==r.total?Math.round(r.present/r.total*100):null);return(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-brand-blue/10 flex items-center justify-center",children:i.photo_url?(0,s.jsx)("img",{src:i.photo_url,alt:`${i.first_name} ${i.last_name}`,className:"w-10 h-10 rounded-full object-cover"}):(0,s.jsxs)("span",{className:"text-brand-blue font-medium",children:[i.first_name?.[0],i.last_name?.[0]]})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-medium text-gray-900",children:[i.first_name," ",i.last_name]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[i.email&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(u.Mail,{className:"h-3 w-3"}),i.email]}),i.phone&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(x.Phone,{className:"h-3 w-3"}),i.phone]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Présence"}),(0,s.jsx)("p",{className:(0,w.cn)("font-medium",null===n?"text-gray-400":n>=80?"text-green-600":n>=60?"text-yellow-600":"text-red-600"),children:null!==n?`${n}%`:"N/A"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(b.default,{href:`/dashboard/attendance?student=${i.id}&session=${e}`,children:(0,s.jsxs)(l.Button,{variant:"ghost",size:"sm",children:[(0,s.jsx)(p.ClipboardList,{className:"h-4 w-4 mr-1"}),"Émargement"]})}),(0,s.jsx)(b.default,{href:`/dashboard/students/${i.id}`,children:(0,s.jsx)(l.Button,{variant:"ghost",size:"sm",children:(0,s.jsx)(g.Eye,{className:"h-4 w-4"})})})]})]})]},a.id)})})})]})},e)})})]})}e.s(["default",()=>C])}]);