(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,107233,e=>{"use strict";let s=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],107233)},871689,e=>{"use strict";let s=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>s],871689)},503116,e=>{"use strict";let s=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>s],503116)},879002,e=>{"use strict";let s=(0,e.i(475254).default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);e.s(["UserPlus",()=>s],879002)},2034,e=>{"use strict";var s=e.i(920755);let t=async(e,s)=>(console.warn("videoconferenceService.createMeetingForSession not implemented"),null),a=new class{supabase;constructor(e){this.supabase=e||(0,s.createClient)()}async getAllSessions(e,s){let t=this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",e);s?.formationId&&(t=t.eq("formation_id",s.formationId)),s?.status&&(t=t.eq("status",s.status)),s?.startDate&&(t=t.gte("start_date",s.startDate)),s?.endDate&&(t=t.lte("end_date",s.endDate)),s?.search&&(t=t.ilike("name",`%${s.search}%`));let{data:a,error:r}=await t.order("start_date",{ascending:!0});if(r)throw r;return a}async getSessionById(e){let{data:s,error:t}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("id",e).single();if(t)throw t;let{data:a,error:r}=await this.supabase.from("session_programs").select(`
        program_id,
        programs(*)
      `).eq("session_id",e);if(r)throw r;return{...s,session_programs:a?.map(e=>e.programs).filter(Boolean)||[]}}async createSession(e,s,t){if(e.formation_id){let{data:s,error:t}=await this.supabase.from("formations").select("id, organization_id").eq("id",e.formation_id).single();if(t)throw console.error("Erreur lors de la vérification de la formation:",t),Error(`Formation non trouv\xe9e: ${t.message}`);if(!s)throw Error("Formation non trouvée");console.log("Formation trouvée:",s)}let{data:a,error:r}=await this.supabase.from("sessions").insert(e).select().single();if(r)throw console.error("Erreur RLS lors de la création de la session:",{code:r.code,message:r.message,details:r.details,hint:r.hint,formation_id:e.formation_id}),r;if(s&&s.length>0&&a){let{data:e}=await this.supabase.from("formations").select("organization_id").eq("id",a.formation_id).single();if(e){let t=s.map(s=>({session_id:a.id,program_id:s,organization_id:e.organization_id})),{error:r}=await this.supabase.from("session_programs").insert(t);r&&console.error("Erreur lors de la création des associations session-programme:",r),e.organization_id&&await this.syncWithCalendars(a.id,e.organization_id,"create").catch(e=>{console.error("Erreur lors de la synchronisation calendrier:",e)}),e.organization_id&&await this.createVideoconferenceMeeting(a.id,e.organization_id).catch(e=>{console.error("Erreur lors de la création de la réunion visioconférence:",e)})}}return console.log("Session créée avec succès:",a),a}async updateSessionPrograms(e,s,t){let{error:a}=await this.supabase.from("session_programs").delete().eq("session_id",e);if(a)throw a;if(s.length>0){let a=s.map(s=>({session_id:e,program_id:s,organization_id:t})),{error:r}=await this.supabase.from("session_programs").insert(a);if(r)throw r}return!0}async getSessionPrograms(e){let{data:s,error:t}=await this.supabase.from("session_programs").select(`
        program_id,
        programs(*)
      `).eq("session_id",e);if(t)throw t;return s?.map(e=>e.programs).filter(Boolean)||[]}async updateSession(e,s){let{data:t}=await this.supabase.from("sessions").select("formation_id, formations(organization_id)").eq("id",e).single(),{data:a,error:r}=await this.supabase.from("sessions").update(s).eq("id",e).select().single();if(r)throw r;let i=t?.formations;return t&&i?.organization_id&&await this.syncWithCalendars(e,i.organization_id,"update").catch(e=>{console.error("Erreur lors de la synchronisation calendrier:",e)}),a}async deleteSession(e){let{data:s}=await this.supabase.from("sessions").select("formation_id, formations(organization_id)").eq("id",e).single(),t=s?.formations;s&&t?.organization_id&&await this.syncWithCalendars(e,t.organization_id,"delete").catch(e=>{console.error("Erreur lors de la suppression de l'événement calendrier:",e)});let{error:a}=await this.supabase.from("sessions").delete().eq("id",e);if(a)throw a}async createVideoconferenceMeeting(e,s){let{data:a}=await this.supabase.from("videoconference_integrations").select("*").eq("organization_id",s).eq("is_active",!0).eq("auto_create_meetings",!0);if(a&&0!==a.length)for(let r of a)try{await t(e,{organizationId:s,provider:r.provider})}catch(e){console.error(`Erreur lors de la cr\xe9ation de r\xe9union avec ${r.provider}:`,e)}}async syncWithCalendars(e,s,t){let{data:a}=await this.supabase.from("calendar_integrations").select("*").eq("organization_id",s).eq("is_active",!0).eq("sync_sessions",!0).eq("create_events_for_sessions",!0);if(a&&0!==a.length)for(let e of a)try{console.warn(`Calendar sync for ${t} not implemented yet for provider ${e.provider}`)}catch(s){console.error(`Erreur lors de la synchronisation avec ${e.provider}:`,s)}}async getUpcomingSessions(e,s=10){let t=new Date().toISOString().split("T")[0],{data:a,error:r}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",e).gte("start_date",t).eq("status","planned").order("start_date",{ascending:!0}).limit(s);if(r)throw r;return a}async getOngoingSessions(e){let s=new Date().toISOString().split("T")[0],{data:t,error:a}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",e).lte("start_date",s).gte("end_date",s).eq("status","ongoing").order("start_date",{ascending:!0});if(a)throw a;return t}async addSessionToFormations(e,s,t){let a=s.map((s,a)=>({session_id:e,formation_id:s,organization_id:t,order_index:a})),{data:r,error:i}=await this.supabase.from("formation_sessions").insert(a).select();if(i)throw i;return r}async removeSessionFromFormation(e,s){let{error:t}=await this.supabase.from("formation_sessions").delete().eq("session_id",e).eq("formation_id",s);if(t)throw t;return!0}async updateSessionFormations(e,s,t){let{error:a}=await this.supabase.from("formation_sessions").delete().eq("session_id",e);if(a)throw a;return s.length>0?this.addSessionToFormations(e,s,t):[]}async getSessionFormations(e){let{data:s,error:t}=await this.supabase.from("formation_sessions").select(`
        formation_id,
        order_index,
        formations(*)
      `).eq("session_id",e).order("order_index",{ascending:!0});if(t)throw t;return s?.map(e=>e.formations).filter(Boolean)||[]}async getFormationSessions(e){let{data:s,error:t}=await this.supabase.from("formation_sessions").select(`
        session_id,
        order_index,
        sessions(*)
      `).eq("formation_id",e).order("order_index",{ascending:!0});if(t)throw t;return s?.map(e=>e.sessions).filter(Boolean)||[]}async createIndependentSession(e,s,t){let{data:a,error:r}=await this.supabase.from("sessions").insert({...e,formation_id:null}).select().single();if(r)throw r;return s&&s.length>0&&a&&await this.updateSessionPrograms(a.id,s,e.organization_id),t&&t.length>0&&a&&await this.addSessionToFormations(a.id,t,e.organization_id),a}};e.s(["sessionService",0,a],2034)},1262,e=>{"use strict";var s=e.i(920755);let t=new class{supabase;constructor(e){this.supabase=e||(0,s.createClient)()}async getAllFormations(e,s){let t=this.supabase.from("formations").select(`
        *,
        programs(*)
      `).eq("organization_id",e);s?.programId&&(t=t.eq("program_id",s.programId)),s?.isActive!==void 0&&(t=t.eq("is_active",s.isActive)),s?.search&&(t=t.or(`name.ilike.%${s.search}%,code.ilike.%${s.search}%,description.ilike.%${s.search}%`));let{data:a,error:r}=await t.order("created_at",{ascending:!1});if(r)throw r;return a}async getFormationById(e){let{data:s,error:t}=await this.supabase.from("formations").select(`
        *,
        programs(*),
        sessions(*)
      `).eq("id",e).single();if(t)throw t;return s}async createFormation(e){let{data:s,error:t}=await this.supabase.from("formations").insert(e).select().single();if(t)throw t;return s}async updateFormation(e,s){let{data:t,error:a}=await this.supabase.from("formations").update(s).eq("id",e).select().single();if(a)throw a;return t}async deleteFormation(e){return this.updateFormation(e,{is_active:!1})}async getSessionsByFormation(e){let{data:s,error:t}=await this.supabase.from("sessions").select("*").eq("formation_id",e).order("start_date",{ascending:!0});if(t)throw t;return s}async getAllSessionsForFormation(e){let{data:s,error:t}=await this.supabase.from("formation_sessions").select(`
        session_id,
        order_index,
        sessions(*)
      `).eq("formation_id",e).order("order_index",{ascending:!0});if(t)throw t;let{data:a,error:r}=await this.supabase.from("sessions").select("*").eq("formation_id",e).order("start_date",{ascending:!0});if(r)throw r;let i=s?.map(e=>e.sessions).filter(Boolean)||[],n=[...i],o=new Set(i.map(e=>e.id));for(let e of a||[])o.has(e.id)||n.push(e);return n}async addSessionsToFormation(e,s,t){let a=s.map((s,a)=>({formation_id:e,session_id:s,organization_id:t,order_index:a})),{data:r,error:i}=await this.supabase.from("formation_sessions").insert(a).select();if(i)throw i;return r}async removeSessionFromFormation(e,s){let{error:t}=await this.supabase.from("formation_sessions").delete().eq("formation_id",e).eq("session_id",s);if(t)throw t;return!0}async updateFormationSessions(e,s,t){let{error:a}=await this.supabase.from("formation_sessions").delete().eq("formation_id",e);if(a)throw a;return s.length>0?this.addSessionsToFormation(e,s,t):[]}async getFormationWithAllSessions(e){let s=await this.getFormationById(e);if(!s)return null;let t=await this.getAllSessionsForFormation(e);return{...s,all_sessions:t}}};e.s(["formationService",0,t])},520934,e=>{"use strict";var s=e.i(843476),t=e.i(271645),a=e.i(618566),r=e.i(266027),i=e.i(954616),n=e.i(912598),o=e.i(920755),l=e.i(1262),d=e.i(2034),c=e.i(325715),m=e.i(167881),u=e.i(970065),f=e.i(871689),p=e.i(107233),h=e.i(87316),g=e.i(503116),x=e.i(346897),_=e.i(761911),y=e.i(37727),b=e.i(879002),v=e.i(522016),w=e.i(647163);function j(){let e=(0,a.useParams)();(0,a.useRouter)();let j=e.id,N=(0,o.createClient)(),q=(0,n.useQueryClient)(),{user:S}=(0,c.useAuth)(),[C,F]=(0,t.useState)(!1),[k,z]=(0,t.useState)(null),[E,B]=(0,t.useState)({student_id:"",enrollment_date:new Date().toISOString().split("T")[0],status:"confirmed",payment_status:"pending",total_amount:"",paid_amount:"0"}),{data:P}=(0,r.useQuery)({queryKey:["formation",j],queryFn:()=>l.formationService.getFormationById(j)}),{data:A,isLoading:I,refetch:T}=(0,r.useQuery)({queryKey:["formation-sessions",j],queryFn:()=>l.formationService.getSessionsByFormation(j)}),{data:D}=(0,r.useQuery)({queryKey:["teachers"],queryFn:async()=>{let{data:e,error:s}=await N.from("users").select("id, full_name").eq("role","teacher").eq("is_active",!0);if(s)throw s;return e||[]}}),{data:M}=(0,r.useQuery)({queryKey:["students",S?.organization_id],queryFn:async()=>{if(!S?.organization_id)return[];let{data:e,error:s}=await N.from("students").select("id, first_name, last_name, student_number, email").eq("organization_id",S.organization_id).eq("status","active").order("last_name",{ascending:!0});if(s)throw s;return e||[]},enabled:!!S?.organization_id}),{data:$}=(0,r.useQuery)({queryKey:["enrollments-for-session",k],queryFn:async()=>{if(!k)return[];let{data:e,error:s}=await N.from("enrollments").select("student_id").eq("session_id",k);if(s)throw s;return e||[]},enabled:!!k&&C}),K=M?.filter(e=>!$?.some(s=>s.student_id===e.id))||[],[Q,U]=(0,t.useState)(!1),[H,O]=(0,t.useState)({name:"",start_date:"",end_date:"",start_time:"",end_time:"",teacher_id:"",location:"",capacity_max:""}),L=(0,i.useMutation)({mutationFn:async()=>{try{return await d.sessionService.createSession({formation_id:j,name:H.name,start_date:H.start_date,end_date:H.end_date,start_time:H.start_time||null,end_time:H.end_time||null,teacher_id:H.teacher_id||null,location:H.location||null,capacity_max:H.capacity_max?parseInt(H.capacity_max):null,status:"planned"})}catch(e){throw console.error("Erreur lors de la création de la session:",e),e}},onSuccess:()=>{U(!1),O({name:"",start_date:"",end_date:"",start_time:"",end_time:"",teacher_id:"",location:"",capacity_max:""}),q.invalidateQueries({queryKey:["formation-sessions",j]}),T()}}),W=(0,i.useMutation)({mutationFn:async()=>{if(!k||!E.student_id)throw Error("Session et élève sont requis");let{data:e}=await N.from("enrollments").select("id").eq("session_id",k).eq("student_id",E.student_id).maybeSingle();if(e)throw Error("Cet élève est déjà inscrit à cette session");let{data:s,error:t}=await N.from("enrollments").insert({student_id:E.student_id,session_id:k,enrollment_date:E.enrollment_date,status:E.status,payment_status:E.payment_status,total_amount:parseFloat(E.total_amount)||0,paid_amount:parseFloat(E.paid_amount)||0}).select().single();if(t){if("23505"===t.code)throw Error("Cet élève est déjà inscrit à cette session");throw t}return s},onSuccess:()=>{q.invalidateQueries({queryKey:["enrollments-for-session",k]}),q.invalidateQueries({queryKey:["session-enrollments",k]}),F(!1),z(null)}});return I?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("p",{children:"Chargement..."})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(v.default,{href:`/dashboard/formations/${j}`,children:(0,s.jsx)(m.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(f.ArrowLeft,{className:"h-4 w-4"})})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:["Sessions - ",P?.name||"Formation"]}),(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Gérez les sessions de cette formation"})]})]}),(0,s.jsxs)(m.Button,{onClick:()=>U(!0),children:[(0,s.jsx)(p.Plus,{className:"mr-2 h-4 w-4"}),"Nouvelle session"]})]}),Q&&(0,s.jsxs)(u.Card,{children:[(0,s.jsx)(u.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(u.CardTitle,{children:"Nouvelle session"}),(0,s.jsx)(m.Button,{variant:"ghost",size:"icon",onClick:()=>U(!1),children:(0,s.jsx)(y.X,{className:"h-4 w-4"})})]})}),(0,s.jsx)(u.CardContent,{children:(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),L.mutate()},className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Nom de la session *"}),(0,s.jsx)("input",{type:"text",required:!0,value:H.name,onChange:e=>O({...H,name:e.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Ex: Session Hiver 2024"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Lieu"}),(0,s.jsx)("input",{type:"text",value:H.location,onChange:e=>O({...H,location:e.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Ex: Salle A1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Date de début *"}),(0,s.jsx)("input",{type:"date",required:!0,value:H.start_date,onChange:e=>O({...H,start_date:e.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Date de fin *"}),(0,s.jsx)("input",{type:"date",required:!0,value:H.end_date,onChange:e=>O({...H,end_date:e.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Heure de début"}),(0,s.jsx)("input",{type:"time",value:H.start_time,onChange:e=>O({...H,start_time:e.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Heure de fin"}),(0,s.jsx)("input",{type:"time",value:H.end_time,onChange:e=>O({...H,end_time:e.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Enseignant"}),(0,s.jsxs)("select",{value:H.teacher_id,onChange:e=>O({...H,teacher_id:e.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Sélectionner un enseignant"}),D?.map(e=>(0,s.jsx)("option",{value:e.id,children:e.full_name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Capacité maximale"}),(0,s.jsx)("input",{type:"number",value:H.capacity_max,onChange:e=>O({...H,capacity_max:e.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Ex: 30"})]})]}),L.error&&(0,s.jsx)("div",{className:"bg-red-50 text-red-800 px-4 py-3 rounded-lg text-sm",children:L.error instanceof Error?L.error.message:"Une erreur est survenue"}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,s.jsx)(m.Button,{type:"button",variant:"outline",onClick:()=>U(!1),children:"Annuler"}),(0,s.jsx)(m.Button,{type:"submit",disabled:L.isPending,children:L.isPending?"Création...":"Créer la session"})]})]})})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:A&&A.length>0?A.map(e=>(0,s.jsxs)(u.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,s.jsx)(u.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(u.CardTitle,{className:"text-lg",children:e.name}),(0,s.jsxs)("div",{className:"flex items-center mt-2 space-x-2 text-sm text-muted-foreground",children:[(0,s.jsx)(h.Calendar,{className:"h-4 w-4"}),(0,s.jsxs)("span",{children:[(0,w.formatDate)(e.start_date)," - ",(0,w.formatDate)(e.end_date)]})]})]}),(0,s.jsx)("span",{className:`px-2 py-1 rounded text-xs ${(e=>{switch(e){case"planned":return"bg-blue-100 text-blue-800";case"ongoing":return"bg-success-bg text-success-primary";case"completed":default:return"bg-gray-100 text-gray-800";case"cancelled":return"bg-red-100 text-red-800"}})(e.status)}`,children:(e=>{switch(e){case"planned":return"Planifiée";case"ongoing":return"En cours";case"completed":return"Terminée";case"cancelled":return"Annulée";default:return e}})(e.status)})]})}),(0,s.jsxs)(u.CardContent,{className:"space-y-3",children:[e.location&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,s.jsx)(x.MapPin,{className:"mr-2 h-4 w-4"}),e.location]}),e.start_time&&e.end_time&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,s.jsx)(g.Clock,{className:"mr-2 h-4 w-4"}),e.start_time," - ",e.end_time]}),e.capacity_max&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,s.jsx)(_.Users,{className:"mr-2 h-4 w-4"}),"Capacité: ",e.capacity_max]}),(0,s.jsxs)("div",{className:"flex space-x-2 pt-2",children:[(0,s.jsx)(v.default,{href:`/dashboard/sessions/${e.id}`,className:"flex-1",children:(0,s.jsx)(m.Button,{variant:"outline",className:"w-full",size:"sm",children:"Voir détails"})}),(0,s.jsxs)(m.Button,{variant:"default",className:"flex-1",size:"sm",onClick:()=>{z(e.id),B({student_id:"",enrollment_date:new Date().toISOString().split("T")[0],status:"confirmed",payment_status:"pending",total_amount:P?.price?.toString()||"0",paid_amount:"0"}),F(!0)},children:[(0,s.jsx)(b.UserPlus,{className:"mr-1 h-4 w-4"}),"Inscrire élève"]})]})]})]},e.id)):(0,s.jsxs)("div",{className:"col-span-full text-center py-12 text-muted-foreground",children:[(0,s.jsx)(h.Calendar,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("p",{children:"Aucune session pour le moment"})]})}),C&&(0,s.jsxs)(u.Card,{children:[(0,s.jsx)(u.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(u.CardTitle,{children:"Inscrire un élève à la session"}),(0,s.jsx)(m.Button,{variant:"ghost",size:"icon",onClick:()=>F(!1),children:(0,s.jsx)(y.X,{className:"h-4 w-4"})})]})}),(0,s.jsx)(u.CardContent,{children:(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),W.mutate()},className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Élève *"}),(0,s.jsxs)("select",{required:!0,value:E.student_id,onChange:e=>B({...E,student_id:e.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",children:[(0,s.jsx)("option",{value:"",children:"Sélectionner un élève"}),K.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.first_name," ",e.last_name," (",e.student_number,")"]},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Date d'inscription *"}),(0,s.jsx)("input",{type:"date",required:!0,value:E.enrollment_date,onChange:e=>B({...E,enrollment_date:e.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Statut *"}),(0,s.jsxs)("select",{required:!0,value:E.status,onChange:e=>{let s=e.target.value||"pending",t="failed"===s||"completed"===s||"confirmed"===s||"pending"===s||"cancelled"===s?s:"pending";B({...E,status:t})},className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",children:[(0,s.jsx)("option",{value:"pending",children:"En attente"}),(0,s.jsx)("option",{value:"confirmed",children:"Confirmé"}),(0,s.jsx)("option",{value:"completed",children:"Terminé"}),(0,s.jsx)("option",{value:"cancelled",children:"Annulé"}),(0,s.jsx)("option",{value:"failed",children:"Échoué"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Montant total *"}),(0,s.jsx)("input",{type:"number",required:!0,step:"0.01",value:E.total_amount,onChange:e=>B({...E,total_amount:e.target.value}),className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Montant payé"}),(0,s.jsx)("input",{type:"number",step:"0.01",value:E.paid_amount,onChange:e=>{let s=parseFloat(e.target.value)||0,t=parseFloat(E.total_amount)||0;B({...E,paid_amount:e.target.value,payment_status:0===s?"pending":s>=t?"paid":"partial"})},className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Statut de paiement"}),(0,s.jsx)("input",{type:"text",value:"pending"===E.payment_status?"En attente":"partial"===E.payment_status?"Partiel":"paid"===E.payment_status?"Payé":"En retard",disabled:!0,className:"w-full px-4 py-2 border rounded-lg bg-gray-50"})]})]}),W.error&&(0,s.jsx)("div",{className:"bg-red-50 text-red-800 px-4 py-3 rounded-lg text-sm",children:W.error instanceof Error?W.error.message:"Une erreur est survenue"}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,s.jsx)(m.Button,{type:"button",variant:"outline",onClick:()=>F(!1),children:"Annuler"}),(0,s.jsx)(m.Button,{type:"submit",disabled:W.isPending,children:W.isPending?"Inscription...":"Inscrire l'élève"})]})]})})]})]})}e.s(["default",()=>j])}]);