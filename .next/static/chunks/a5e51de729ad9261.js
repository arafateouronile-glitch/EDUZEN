(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,871689,e=>{"use strict";let i=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>i],871689)},319036,e=>{"use strict";var i=e.i(843476),s=e.i(271645),r=e.i(647163);let n=s.forwardRef(({checked:e,onCheckedChange:s,disabled:n,className:a,...t},l)=>(0,i.jsx)("button",{type:"button",role:"switch","aria-checked":e,ref:l,disabled:n,onClick:()=>s?.(!e),className:(0,r.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",e?"bg-brand-blue":"bg-input",a),...t,children:(0,i.jsx)("span",{className:(0,r.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform",e?"translate-x-5":"translate-x-0")})}));n.displayName="Switch",e.s(["Switch",0,n])},435534,e=>{"use strict";var i=e.i(843476),s=e.i(970065),r=e.i(167881),n=e.i(23750),a=e.i(10708),t=e.i(319036),l=e.i(6799),o=e.i(871689),c=e.i(32095),d=e.i(952571),u=e.i(522016),h=e.i(271645),m=e.i(325715),x=e.i(920755),p=e.i(266027),f=e.i(954616),g=e.i(912598);function y(){let{user:e}=(0,m.useAuth)(),{addToast:y}=(0,l.useToast)(),v=(0,g.useQueryClient)(),j=(0,x.createClient)(),[b,_]=(0,h.useState)({provider:"moodle",api_url:"",api_key:"",is_active:!1,auto_sync:!1,sync_frequency:"daily"}),{data:C,isLoading:N}=(0,p.useQuery)({queryKey:["lms-config",e?.organization_id],queryFn:async()=>{if(!e?.organization_id)return null;try{let{data:i,error:s}=await j.from("lms_configurations").select("*").eq("organization_id",e.organization_id).single();if(s){if("PGRST116"===s.code||"406"===s.code||"PGRST200"===s.code||s.message?.includes("does not exist"))return null;throw s}return i}catch(e){if(e?.code==="PGRST200"||e?.message?.includes("does not exist")||e?.message?.includes("schema cache"))return null;return console.error("Error fetching LMS configuration:",e.message),null}},enabled:!!e?.organization_id});(0,h.useEffect)(()=>{C&&_({provider:C.provider||"moodle",api_url:C.api_url||"",api_key:C.api_key||"",is_active:C.is_active||!1,auto_sync:C.auto_sync||!1,sync_frequency:C.sync_frequency||"daily"})},[C]);let w=(0,f.useMutation)({mutationFn:async i=>{if(!e?.organization_id)throw Error("Organization ID is missing.");if(C?.id){let{data:e,error:s}=await j.from("lms_configurations").update(i).eq("id",C.id).select().single();if(s)throw s;return e}{let{data:s,error:r}=await j.from("lms_configurations").insert({...i,organization_id:e.organization_id}).select().single();if(r)throw r;return s}},onSuccess:()=>{y({type:"success",title:"Configuration LMS enregistrée",description:"Les paramètres LMS ont été mis à jour avec succès."}),v.invalidateQueries({queryKey:["lms-config"]})},onError:e=>{y({type:"error",title:"Erreur lors de l'enregistrement",description:e?.message||"Veuillez vérifier les informations saisies."})}});return N?(0,i.jsx)("div",{className:"container mx-auto py-8 px-4",children:(0,i.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,i.jsx)("div",{className:"text-center",children:(0,i.jsx)("p",{className:"text-gray-500",children:"Chargement de la configuration LMS..."})})})}):(0,i.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,i.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[(0,i.jsx)(u.default,{href:"/dashboard/settings",children:(0,i.jsx)(r.Button,{variant:"ghost",size:"icon",children:(0,i.jsx)(o.ArrowLeft,{className:"h-5 w-5"})})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("h1",{className:"text-3xl font-bold mb-1 flex items-center gap-2",children:[(0,i.jsx)(c.GraduationCap,{className:"h-8 w-8 text-brand-blue"}),"Configuration LMS"]}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"Paramétrez l'intégration avec votre plateforme d'apprentissage en ligne"})]})]}),(0,i.jsx)(r.Button,{onClick:()=>{w.mutate(b)},disabled:w.isPending,children:w.isPending?"Enregistrement...":"Enregistrer"})]}),(0,i.jsxs)(s.Card,{children:[(0,i.jsxs)(s.CardHeader,{children:[(0,i.jsx)(s.CardTitle,{children:"Paramètres de connexion"}),(0,i.jsx)(s.CardDescription,{children:"Configurez la connexion à votre plateforme LMS (Moodle, Canvas, etc.)"})]}),(0,i.jsxs)(s.CardContent,{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(a.Label,{htmlFor:"provider",children:"Plateforme LMS"}),(0,i.jsxs)("select",{id:"provider",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-blue",value:b.provider,onChange:e=>_({...b,provider:e.target.value}),children:[(0,i.jsx)("option",{value:"moodle",children:"Moodle"}),(0,i.jsx)("option",{value:"canvas",children:"Canvas"}),(0,i.jsx)("option",{value:"blackboard",children:"Blackboard"}),(0,i.jsx)("option",{value:"other",children:"Autre"})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(a.Label,{htmlFor:"api_url",children:"URL de l'API"}),(0,i.jsx)(n.Input,{id:"api_url",value:b.api_url,onChange:e=>_({...b,api_url:e.target.value}),placeholder:"Ex: https://lms.example.com/api"})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(a.Label,{htmlFor:"api_key",children:"Clé API"}),(0,i.jsx)(n.Input,{id:"api_key",type:"password",value:b.api_key,onChange:e=>_({...b,api_key:e.target.value}),placeholder:"Votre clé API sécurisée"})]})]})]}),(0,i.jsxs)(s.Card,{className:"mt-6",children:[(0,i.jsxs)(s.CardHeader,{children:[(0,i.jsx)(s.CardTitle,{children:"Paramètres de synchronisation"}),(0,i.jsx)(s.CardDescription,{children:"Gérez la synchronisation automatique des données avec votre LMS"})]}),(0,i.jsxs)(s.CardContent,{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(t.Switch,{checked:b.is_active,onCheckedChange:e=>_({...b,is_active:e})}),(0,i.jsx)(a.Label,{htmlFor:"is_active",children:"Activer l'intégration LMS"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(t.Switch,{checked:b.auto_sync,onCheckedChange:e=>_({...b,auto_sync:e}),disabled:!b.is_active}),(0,i.jsx)(a.Label,{htmlFor:"auto_sync",children:"Synchronisation automatique"})]}),b.auto_sync&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(a.Label,{htmlFor:"sync_frequency",children:"Fréquence de synchronisation"}),(0,i.jsxs)("select",{id:"sync_frequency",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-blue",value:b.sync_frequency,onChange:e=>_({...b,sync_frequency:e.target.value}),children:[(0,i.jsx)("option",{value:"hourly",children:"Horaire"}),(0,i.jsx)("option",{value:"daily",children:"Quotidienne"}),(0,i.jsx)("option",{value:"weekly",children:"Hebdomadaire"}),(0,i.jsx)("option",{value:"manual",children:"Manuelle"})]})]})]})]}),(0,i.jsxs)(s.Card,{className:"mt-6",children:[(0,i.jsx)(s.CardHeader,{children:(0,i.jsxs)(s.CardTitle,{className:"flex items-center gap-2",children:[(0,i.jsx)(d.Info,{className:"h-5 w-5 text-brand-blue"}),"Informations"]})}),(0,i.jsx)(s.CardContent,{children:(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:"La configuration LMS permet de synchroniser automatiquement les données entre votre plateforme d'apprentissage en ligne et EDUZEN. Les cours, les inscriptions et les notes peuvent être synchronisés selon la fréquence configurée."})})]})]})}e.s(["default",()=>y])}]);