(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,107233,e=>{"use strict";let t=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],107233)},871689,e=>{"use strict";let t=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],871689)},605631,e=>{"use strict";let t=(0,e.i(475254).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],605631)},356909,e=>{"use strict";let t=(0,e.i(475254).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);e.s(["Save",()=>t],356909)},569074,e=>{"use strict";let t=(0,e.i(475254).default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);e.s(["Upload",()=>t],569074)},127341,e=>{"use strict";var t=e.i(843476),i=e.i(271645),s=e.i(647163);let a=i.createContext(void 0);function n({value:e,defaultValue:n,onValueChange:r,children:o,className:c}){let l=void 0!==e,[d,u]=i.useState(n??"");i.useEffect(()=>{l||void 0===n||u(n)},[n]);let m=l?e:d,_=i.useCallback(e=>{l||u(e),r?.(e)},[l,r]);return(0,t.jsx)(a.Provider,{value:{value:m,onValueChange:_},children:(0,t.jsx)("div",{className:(0,s.cn)("w-full",c),children:o})})}function r(){let e=i.useContext(a);if(!e)throw Error("Tabs components must be used within a Tabs component");return e}function o({children:e,className:i}){return(0,t.jsx)("div",{className:(0,s.cn)("inline-flex h-10 items-center justify-center rounded-lg bg-bg-gray-100 p-1 text-text-tertiary",i),children:e})}function c({value:e,children:i,className:a}){let{value:n,onValueChange:o}=r(),c=n===e;return(0,t.jsx)("button",{type:"button",onClick:()=>o(e),className:(0,s.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-outline-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",c?"bg-white text-text-primary shadow-sm":"text-text-tertiary hover:text-text-primary",a),children:i})}function l({value:e,children:i,className:a}){let{value:n}=r();return n!==e?null:(0,t.jsx)("div",{className:(0,s.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),children:i})}e.s(["Tabs",()=>n,"TabsContent",()=>l,"TabsList",()=>o,"TabsTrigger",()=>c])},625959,e=>{"use strict";var t=e.i(843476),i=e.i(271645),s=e.i(647163),a=e.i(643531);let n=i.forwardRef(({className:e,checked:i,onCheckedChange:n,...r},o)=>(0,t.jsxs)("div",{className:"relative inline-flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",ref:o,checked:i,onChange:e=>n?.(e.target.checked),className:(0,s.cn)("peer h-4 w-4 shrink-0 rounded border border-gray-300","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-blue focus-visible:ring-offset-2","disabled:cursor-not-allowed disabled:opacity-50","cursor-pointer",i&&"border-brand-blue bg-brand-blue",e),...r}),i&&(0,t.jsx)(a.Check,{className:"absolute h-3 w-3 text-white pointer-events-none left-0.5 top-0.5"})]}));n.displayName="Checkbox",e.s(["Checkbox",()=>n])},373375,e=>{"use strict";let t=(0,e.i(475254).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],373375)},318216,e=>{"use strict";let t=(0,e.i(475254).default)("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);e.s(["MoreVertical",()=>t],318216)},794008,e=>{"use strict";let t=(0,e.i(475254).default)("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]);e.s(["File",()=>t],794008)},287336,e=>{"use strict";var t=e.i(843476),i=e.i(271645),s=e.i(647163);let a=i.forwardRef(({className:e,value:i=0,max:a=100,indicatorClassName:n,...r},o)=>{let c=Math.min(Math.max(i/a*100,0),100);return(0,t.jsx)("div",{ref:o,role:"progressbar","aria-valuemin":0,"aria-valuemax":a,"aria-valuenow":i,className:(0,s.cn)("relative h-2 w-full overflow-hidden rounded-full bg-gray-100",e),...r,children:(0,t.jsx)("div",{className:(0,s.cn)("h-full bg-brand-blue transition-all duration-300 ease-in-out",n),style:{width:`${c}%`}})})});a.displayName="Progress",e.s(["Progress",()=>a])},845691,e=>{"use strict";var t=e.i(920755);let i=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getConfiguration(e){try{let{data:t,error:i}=await this.supabase.from("accessibility_configurations").select("*").eq("organization_id",e).maybeSingle();if(i){if("PGRST116"===i.code||"42P01"===i.code||"PGRST301"===i.code||404===i.status||i.message?.includes("relation")||i.message?.includes("does not exist"))return console.warn("Table accessibility_configurations does not exist yet:",i?.message),null;throw i}return t}catch(e){if(e?.status===404||e?.message?.toLowerCase().includes("not found"))return null;throw e}}async updateConfiguration(e,t){var i;let s=await this.getConfiguration(e),a={...t};if(delete a.id,delete a.created_at,delete a.updated_at,delete a.organization_id,null===a.referent_user_id||void 0===a.referent_user_id||""!==a.referent_user_id&&(i=a.referent_user_id)&&""!==i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(i)||(a.referent_user_id=null),(""===a.referent_training_date||null===a.referent_training_date)&&(a.referent_training_date=null),""===a.referent_training_certificate&&(a.referent_training_certificate=null),""===a.accessibility_policy&&(a.accessibility_policy=null),""===a.physical_accessibility_statement&&(a.physical_accessibility_statement=null),""===a.digital_accessibility_statement&&(a.digital_accessibility_statement=null),s){let{data:t,error:i}=await this.supabase.from("accessibility_configurations").update(a).eq("organization_id",e).select().single();if(i)throw console.error("[AccessibilityService] Erreur lors de la mise à jour de la configuration:",{error:i,code:i.code,message:i.message,details:i.details,hint:i.hint,cleanData:a,organizationId:e}),i;return t}{let t={organization_id:e,partner_agefiph:!1,partner_cap_emploi:!1,partner_fiphfp:!1,partner_other:[],...a},{data:i,error:s}=await this.supabase.from("accessibility_configurations").insert(t).select().single();if(s)throw console.error("[AccessibilityService] Erreur lors de la création de la configuration:",{error:s,code:s.code,message:s.message,details:s.details,hint:s.hint,insertData:t}),s;return i}}async setReferent(e,t,i,s){await this.updateConfiguration(e,{referent_user_id:t,referent_training_date:i||null,referent_training_certificate:s||null})}async getDisabilityTypes(){try{let{data:e,error:t}=await this.supabase.from("accessibility_disability_types").select("*").order("name_fr",{ascending:!0});if(t){if("PGRST116"===t.code||"42P01"===t.code||404===t.status||t.message?.includes("relation")||t.message?.includes("does not exist"))return console.warn("Table accessibility_disability_types does not exist yet"),[];throw t}return e||[]}catch(e){if(e?.status===404)return[];throw e}}async getStudentNeeds(e,t){try{let i=this.supabase.from("accessibility_student_needs").select("*").eq("organization_id",e);t?.status&&(i=i.eq("status",t.status)),t?.has_disability!==void 0&&(i=i.eq("has_disability",t.has_disability));let{data:s,error:a}=await i.order("created_at",{ascending:!1});if(a){if("PGRST116"===a.code||"42P01"===a.code||404===a.status||a.message?.includes("relation")||a.message?.includes("does not exist"))return console.warn("Table accessibility_student_needs does not exist yet"),[];throw a}return s||[]}catch(e){if(e?.status===404)return[];throw e}}async getStudentNeedByStudentId(e){try{let{data:t,error:i}=await this.supabase.from("accessibility_student_needs").select("*").eq("student_id",e).maybeSingle();if(i){if("PGRST116"===i.code||"42P01"===i.code||404===i.status||i.message?.includes("relation")||i.message?.includes("does not exist"))return null;throw i}return t}catch(e){if(e?.status===404)return null;throw e}}async createStudentNeed(e){let{data:t,error:i}=await this.supabase.from("accessibility_student_needs").insert(e).select().single();if(i)throw i;return t}async updateStudentNeed(e,t){let{data:i,error:s}=await this.supabase.from("accessibility_student_needs").update(t).eq("id",e).select().single();if(s)throw s;return i}async reviewStudentNeed(e,t,i){return this.updateStudentNeed(e,{status:"reviewed",reviewed_by_user_id:t,reviewed_at:new Date().toISOString(),notes:i||null})}async getAccommodations(e,t){try{let i=this.supabase.from("accessibility_accommodations").select("*").eq("organization_id",e);t?.student_id&&(i=i.eq("student_id",t.student_id)),t?.status&&(i=i.eq("status",t.status)),t?.type&&(i=i.eq("accommodation_type",t.type));let{data:s,error:a}=await i.order("created_at",{ascending:!1});if(a){if("PGRST116"===a.code||"42P01"===a.code||404===a.status||a.message?.includes("relation")||a.message?.includes("does not exist"))return console.warn("Table accessibility_accommodations does not exist yet"),[];throw a}return s||[]}catch(e){if(e?.status===404)return[];throw e}}async getStudentAccommodations(e){return this.getAccommodations("",{student_id:e})}async createAccommodation(e){let{data:t,error:i}=await this.supabase.from("accessibility_accommodations").insert(e).select().single();if(i)throw i;return t}async updateAccommodation(e,t){let{data:i,error:s}=await this.supabase.from("accessibility_accommodations").update(t).eq("id",e).select().single();if(s)throw s;return i}async archiveAccommodation(e){await this.updateAccommodation(e,{status:"inactive"})}async getEquipment(e,t){try{let i=this.supabase.from("accessibility_equipment").select("*").eq("organization_id",e);t?.status&&(i=i.eq("status",t.status)),t?.category&&(i=i.eq("category",t.category));let{data:s,error:a}=await i.order("name",{ascending:!0});if(a){if("PGRST116"===a.code||"42P01"===a.code||404===a.status||a.message?.includes("relation")||a.message?.includes("does not exist"))return console.warn("Table accessibility_equipment does not exist yet"),[];throw a}return s||[]}catch(e){if(e?.status===404)return[];throw e}}async createEquipment(e){let{data:t,error:i}=await this.supabase.from("accessibility_equipment").insert(e).select().single();if(i)throw i;return t}async updateEquipment(e,t){let{data:i,error:s}=await this.supabase.from("accessibility_equipment").update(t).eq("id",e).select().single();if(s)throw s;return i}async assignEquipment(e,t,i){let{data:s,error:a}=await this.supabase.from("accessibility_equipment").select("*").eq("id",e).single();if(a)throw a;if(s.quantity_available<=0)throw Error("Équipement non disponible");let{data:n,error:r}=await this.supabase.from("accessibility_equipment_assignments").insert({equipment_id:e,student_id:t,organization_id:s.organization_id,...i}).select().single();if(r)throw r;return await this.updateEquipment(e,{quantity_available:s.quantity_available-1,status:s.quantity_available-1==0?"in_use":s.status}),n}async returnEquipment(e,t){let{data:i,error:s}=await this.supabase.from("accessibility_equipment_assignments").select("*, accessibility_equipment(*)").eq("id",e).single();if(s)throw s;if(await this.supabase.from("accessibility_equipment_assignments").update({status:"returned",actual_return_date:new Date().toISOString().split("T")[0],condition_on_return:t}).eq("id",e),"lost"!==t&&"damaged"!==t){let e=i.accessibility_equipment;await this.updateEquipment(i.equipment_id,{quantity_available:e.quantity_available+1,status:"available"})}}async getEquipmentAssignments(e){try{let{data:t,error:i}=await this.supabase.from("accessibility_equipment_assignments").select("*").eq("equipment_id",e).order("assigned_date",{ascending:!1});if(i){if("PGRST116"===i.code||"42P01"===i.code||404===i.status||i.message?.includes("relation")||i.message?.includes("does not exist"))return console.warn("Table accessibility_equipment_assignments does not exist yet"),[];throw i}return t||[]}catch(e){if(e?.status===404)return[];throw e}}async getDocuments(e,t){try{let i=this.supabase.from("accessibility_documents").select("*").eq("organization_id",e);t&&(i=i.eq("student_id",t));let{data:s,error:a}=await i.order("created_at",{ascending:!1});if(a){if("PGRST116"===a.code||"42P01"===a.code||404===a.status||a.message?.includes("relation")||a.message?.includes("does not exist"))return console.warn("Table accessibility_documents does not exist yet"),[];throw a}return s||[]}catch(e){if(e?.status===404)return[];throw e}}async uploadDocument(e){let{data:t,error:i}=await this.supabase.from("accessibility_documents").insert(e).select().single();if(i)throw i;return t}async deleteDocument(e){let{error:t}=await this.supabase.from("accessibility_documents").delete().eq("id",e);if(t)throw t}async verifyDocument(e,t){await this.supabase.from("accessibility_documents").update({verified:!0,verified_by_user_id:t,verified_at:new Date().toISOString()}).eq("id",e)}async getStats(e){let[t,i,s,a]=await Promise.all([this.getStudentNeeds(e,{has_disability:!0}),this.getAccommodations(e,{status:"active"}),this.getEquipment(e,{status:"available"}),this.calculateComplianceRate(e)]),n=new Map;t.forEach(e=>{e.disability_type_ids.forEach(e=>{n.set(e,(n.get(e)||0)+1)})});let r=new Map;return i.forEach(e=>{r.set(e.accommodation_type,(r.get(e.accommodation_type)||0)+1)}),{total_students_with_needs:t.length,active_accommodations:i.length,available_equipment:s.reduce((e,t)=>e+t.quantity_available,0),compliance_rate:a,students_by_disability_type:Array.from(n.entries()).map(([e,t])=>({type:e,count:t})),accommodations_by_type:Array.from(r.entries()).map(([e,t])=>({type:e,count:t})),pending_reviews:t.filter(e=>"pending"===e.status).length}}async calculateComplianceRate(e){try{let{data:t,error:i}=await this.supabase.rpc("calculate_accessibility_compliance_rate",{org_id:e});if(i){if("PGRST116"===i.code||"42883"===i.code||404===i.status||i.message?.toLowerCase().includes("function")||i.message?.toLowerCase().includes("does not exist"))return 0;throw i}return t||0}catch(e){if(e?.status===404||e?.message?.toLowerCase().includes("not found"))return 0;throw e}}async generateComplianceReport(e,t,i,s){let a=await this.getStats(e),n=await this.getConfiguration(e),r={organization_id:e,report_type:"annual",title:`Rapport de conformit\xe9 accessibilit\xe9 ${new Date().getFullYear()}`,period_start:t,period_end:i,total_students:0,students_with_disabilities:a.total_students_with_needs,accommodations_requested:a.total_students_with_needs,accommodations_implemented:a.active_accommodations,equipment_used:0,referent_training_up_to_date:!!n?.referent_training_date,physical_accessibility_compliant:!!n?.physical_accessibility_statement,digital_accessibility_compliant:!!n?.digital_accessibility_statement,partner_collaborations:+!!n?.partner_agefiph+ +!!n?.partner_cap_emploi+ +!!n?.partner_fiphfp,compliance_rate:a.compliance_rate,findings:[],recommendations:[],generated_by_user_id:s},{data:o,error:c}=await this.supabase.from("accessibility_compliance_reports").insert(r).select().single();if(c)throw c;return o}};e.s(["accessibilityService",0,i])},488844,e=>{"use strict";let t=(0,e.i(475254).default)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);e.s(["Package",()=>t],488844)}]);