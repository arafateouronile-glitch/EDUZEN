(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,901701,e=>{"use strict";e.i(247167);var t=e.i(843476),a=e.i(271645),r=e.i(522016),i=e.i(618566),s=e.i(647163),n=e.i(779700),o=e.i(729788),l=e.i(861745);function d(e,t){return(...e)=>{try{return t(...e)}catch{throw Error(void 0)}}}let c=d(0,l.useTranslations);d(0,l.useFormatter);var u=e.i(260289),m=e.i(686311),h=e.i(761911),g=e.i(810980),p=e.i(561659),x=e.i(178583),f=e.i(191741),b=e.i(239616),y=e.i(292270),v=e.i(32095),w=e.i(626912),j=e.i(664659),N=e.i(68787),k=e.i(87316),_=e.i(283086),C=e.i(101523),S=e.i(520958),E=e.i(98919),L=e.i(327025),P=e.i(607486),z=e.i(842009),D=e.i(270756),q=e.i(475254);let A=(0,q.default)("BookOpenCheck",[["path",{d:"M8 3H2v15h7c1.7 0 3 1.3 3 3V7c0-2.2-1.8-4-4-4Z",key:"1i8u0n"}],["path",{d:"m16 12 2 2 4-4",key:"mdajum"}],["path",{d:"M22 6V3h-6c-2.2 0-4 1.8-4 4v14c0-1.7 1.3-3 3-3h7v-2.3",key:"jb5l51"}]]),M=(0,q.default)("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);var T=e.i(278716),B=e.i(21218),I=e.i(27365),R=e.i(482751),F=e.i(248256),W=e.i(346897);let O=(0,q.default)("Badge",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]]);var H=e.i(325715);e.i(882205);var $=e.i(846932),U=e.i(88653);let K=["super_admin","admin","secretary","accountant"],Q=["super_admin","admin","secretary","accountant"],V=["super_admin","admin","secretary"];function G(){var e;let l=(0,i.usePathname)(),{logout:d,user:q}=(0,H.useAuth)(),G=(0,n.useVocabulary)()||(0,o.getVocabulary)("school"),X=c(),[Z,J]=(0,a.useState)(!1),[Y,ee]=(0,a.useState)(null),[et,ea]=(0,a.useState)([]);(0,a.useEffect)(()=>{J(!0),ee(l||null)},[l]),(0,a.useEffect)(()=>{Z&&Y?ea((()=>{if(!Z||!Y)return[];let e=[];return(Y.startsWith("/dashboard/programs")||Y.startsWith("/dashboard/formations")||Y.startsWith("/dashboard/sessions")||Y.startsWith("/dashboard/elearning")||Y.startsWith("/dashboard/catalog"))&&e.push(X("navigation.pedagogy")),(Y.startsWith("/dashboard/attendance")||Y.startsWith("/dashboard/evaluations"))&&e.push(X("navigation.tracking")),(Y.startsWith("/dashboard/payments")||Y.startsWith("/dashboard/financial-reports")||Y.startsWith("/dashboard/bpf"))&&e.push(X("navigation.finances")),(Y.startsWith("/dashboard/qualiopi")||Y.startsWith("/dashboard/cpf")||Y.startsWith("/dashboard/certifications")||Y.startsWith("/dashboard/opco")||Y.startsWith("/dashboard/gdpr")||Y.startsWith("/dashboard/compliance")||Y.startsWith("/dashboard/accessibility")||Y.startsWith("/dashboard/admin"))&&e.push(X("navigation.qualityRegulation")),(Y.startsWith("/dashboard/tutorials")||Y.startsWith("/dashboard/documentation")||Y.startsWith("/dashboard/knowledge-base")||Y.startsWith("/dashboard/support"))&&e.push(X("navigation.helpCenter")),e})()):ea([])},[Y,Z]);let er=[{title:X("navigation.main"),items:[{name:X("common.dashboard"),href:"/dashboard",icon:u.LayoutDashboard},{name:X("navigation.calendar"),href:"/dashboard/calendar",icon:k.Calendar},{name:X("common.messages"),href:"/dashboard/messages",icon:m.MessageSquare}]},{title:X("navigation.pedagogy"),items:[{name:G.students,href:"/dashboard/students",icon:h.Users,allowedRoles:K},{name:X("navigation.myStudents"),href:"/dashboard/my-students",icon:h.Users,allowedRoles:["teacher"]},{name:X("navigation.pedagogy"),icon:N.BookMarked,allowedRoles:V,children:[{name:X("common.programs"),href:"/dashboard/programs",icon:g.BookOpen},{name:X("common.sessions"),href:"/dashboard/sessions",icon:k.Calendar},{name:X("common.formations"),href:"/dashboard/formations",icon:N.BookMarked},{name:X("navigation.elearning"),href:"/dashboard/elearning",icon:v.GraduationCap},{name:"Catalogue Public",href:"/dashboard/catalog",icon:F.Globe},{name:X("navigation.resources"),href:"/dashboard/resources",icon:L.Folder}]},{name:X("navigation.tracking"),icon:f.ClipboardList,children:[{name:G.attendance,href:"/dashboard/attendance",icon:f.ClipboardList},{name:G.evaluations,href:"/dashboard/evaluations",icon:w.FileCheck},{name:X("navigation.learningPortfolios"),href:"/dashboard/evaluations/portfolios",icon:N.BookMarked},{name:"Rapports & Analytics",href:"/dashboard/reports",icon:C.BarChart3}]}]},{title:X("navigation.management"),allowedRoles:K,items:[{name:X("navigation.finances"),icon:p.CreditCard,allowedRoles:Q,children:[{name:G.payments,href:"/dashboard/payments",icon:p.CreditCard},{name:X("navigation.financialReports"),href:"/dashboard/financial-reports",icon:C.BarChart3},{name:"Bilan P√©dagogique Financier",href:"/dashboard/bpf",icon:C.BarChart3}]},{name:X("navigation.documents"),href:"/dashboard/documents",icon:x.FileText},{name:"Sites et Antennes",href:"/dashboard/sites",icon:W.MapPin}]},{title:X("navigation.compliance"),allowedRoles:K,items:[{name:X("navigation.qualityRegulation"),icon:E.Shield,children:[{name:X("navigation.qualiopi"),href:"/dashboard/qualiopi",icon:z.Award},{name:"Accessibilit√© Handicap",href:"/dashboard/accessibility",icon:R.Accessibility},{name:X("navigation.cpf"),href:"/dashboard/cpf",icon:v.GraduationCap},{name:"Certifications RNCP/RS",href:"/dashboard/certifications",icon:O},{name:X("navigation.opco"),href:"/dashboard/opco",icon:P.Building2},{name:X("navigation.gdpr"),href:"/dashboard/gdpr",icon:D.Lock},{name:X("navigation.compliance"),href:"/dashboard/compliance",icon:E.Shield},{name:X("navigation.admin"),icon:E.Shield,allowedRoles:K,children:[{name:X("navigation.systemHealth"),href:"/dashboard/admin/health",icon:B.Activity},{name:X("navigation.exportHistory"),href:"/dashboard/admin/exports",icon:I.FileDown}]}]}]},{title:X("navigation.help"),items:[{name:X("navigation.helpCenter"),icon:S.HelpCircle,children:[{name:X("navigation.videoTutorials"),href:"/dashboard/tutorials",icon:T.Video},{name:X("navigation.documentation"),href:"/dashboard/documentation",icon:A},{name:X("navigation.knowledgeBase"),href:"/dashboard/knowledge-base",icon:g.BookOpen},{name:X("navigation.support"),href:"/dashboard/support",icon:M}]}]}],ei=Z&&q?.role?(e=q.role)?er.filter(t=>!t.allowedRoles||!!t.allowedRoles.includes(e)).map(t=>({...t,items:t.items.filter(t=>!t.allowedRoles||!!t.allowedRoles.includes(e)).map(t=>({...t,children:t.children?.filter(t=>!t.allowedRoles||!!t.allowedRoles.includes(e))}))})).filter(e=>e.items.length>0):er:er;return(0,t.jsx)("div",{className:"hidden md:flex md:flex-shrink-0",children:(0,t.jsx)("div",{className:"flex flex-col w-72",children:(0,t.jsxs)($.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,ease:[.16,1,.3,1]},className:"relative flex flex-col flex-grow bg-gradient-to-b from-white via-gray-50/50 to-white backdrop-blur-xl border-r-2 border-gray-200/50 pt-8 pb-6 overflow-y-auto shadow-2xl shadow-gray-900/5",style:{background:"linear-gradient(to bottom, rgba(255,255,255,0.98), rgba(249,250,251,0.95), rgba(255,255,255,0.98))",backdropFilter:"blur(20px)"},children:[(0,t.jsx)($.motion.div,{className:"absolute inset-0 bg-gradient-to-b from-brand-blue/[0.02] via-transparent to-brand-cyan/[0.02] pointer-events-none",animate:{opacity:[.3,.5,.3]},transition:{duration:4,repeat:1/0,ease:"easeInOut"}}),(0,t.jsx)($.motion.div,{initial:{scale:.8,opacity:0,y:-20},animate:{scale:1,opacity:1,y:0},transition:{delay:.2,type:"spring",stiffness:400,damping:20},className:"relative flex items-center flex-shrink-0 px-6 mb-8",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 group cursor-pointer",children:[(0,t.jsxs)($.motion.div,{className:"relative",whileHover:{scale:1.1,rotate:5},transition:{type:"spring",stiffness:500,damping:15},children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-brand-blue to-brand-cyan blur-2xl opacity-40 rounded-full animate-pulse"}),(0,t.jsx)("div",{className:"relative p-2.5 bg-gradient-to-br from-brand-blue to-brand-cyan rounded-2xl shadow-xl shadow-brand-blue/30",children:(0,t.jsx)(_.Sparkles,{className:"h-6 w-6 text-white"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-display font-bold text-transparent bg-clip-text bg-gradient-to-r from-brand-blue via-brand-cyan to-brand-blue tracking-tight",children:"eduzen"}),(0,t.jsx)("p",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest",children:"Premium LMS"})]})]})}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col overflow-y-auto relative z-10",children:[(0,t.jsx)("nav",{className:"flex-1 px-4 space-y-8",children:ei.map((e,a)=>(0,t.jsxs)("div",{children:[(0,t.jsx)($.motion.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.08*a+.3,duration:.4,ease:[.16,1,.3,1]},className:"px-3 mb-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)($.motion.div,{className:"h-1 w-1 rounded-full bg-gradient-to-r from-brand-blue to-brand-cyan shadow-sm",animate:{scale:[1,1.3,1],opacity:[.5,1,.5]},transition:{duration:2,repeat:1/0,delay:.2*a}}),(0,t.jsx)("h3",{className:"text-[11px] font-bold text-gray-500 uppercase tracking-widest",children:e.title})]})}),(0,t.jsx)("div",{className:"space-y-1",children:e.items.map((e,i)=>{if(e.children){var n,o;let d=!!(n=e.children)&&n.some(e=>l===e.href||l?.startsWith(e.href+"/")),c=(o=e.name,!!Z&&et.includes(o));return(0,t.jsxs)($.motion.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},transition:{delay:.1*a+.04*i,duration:.4,ease:[.16,1,.3,1]},whileHover:{x:4},children:[(0,t.jsxs)($.motion.button,{onClick:()=>{var t;return t=e.name,void ea(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},whileHover:{scale:1.02},whileTap:{scale:.98},className:(0,s.cn)("group relative flex items-center justify-between w-full px-4 py-3 text-sm font-semibold rounded-xl overflow-hidden","transition-all duration-300 ease-out",d?"bg-gradient-to-br from-brand-blue to-brand-cyan text-white shadow-xl shadow-brand-blue/30":"text-gray-700 hover:bg-white hover:text-gray-900 hover:shadow-lg"),children:[(0,t.jsx)($.motion.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.6,ease:"easeInOut"}}),(0,t.jsxs)("div",{className:"flex items-center relative z-10",children:[(0,t.jsx)($.motion.div,{className:(0,s.cn)("p-1.5 rounded-lg mr-3",d?"bg-white/20":"bg-gray-100 group-hover:bg-brand-blue/10"),whileHover:{rotate:5,scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:(0,t.jsx)(e.icon,{className:(0,s.cn)("flex-shrink-0 h-4 w-4 transition-colors",d?"text-white":"text-gray-500 group-hover:text-brand-blue")})}),(0,t.jsx)("span",{className:"tracking-tight",children:e.name})]}),(0,t.jsx)($.motion.div,{animate:{rotate:180*!!c},transition:{duration:.3,type:"spring",stiffness:400,damping:20},className:"relative z-10",children:(0,t.jsx)(j.ChevronDown,{className:(0,s.cn)("h-4 w-4 flex-shrink-0 transition-colors",d?"text-white/90":"text-gray-400 group-hover:text-gray-600")})}),d&&(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-brand-blue/20 to-brand-cyan/20 blur-xl opacity-50"})]}),(0,t.jsx)(U.AnimatePresence,{children:c&&(0,t.jsx)($.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:[.16,1,.3,1]},className:"overflow-hidden",children:(0,t.jsx)("div",{className:"ml-4 mt-2 space-y-1 pl-4 border-l-2 border-gradient-to-b from-brand-blue/30 to-brand-cyan/30",children:e.children.map((a,i)=>{if(!a.href)return null;let n=l===a.href||l?.startsWith(a.href+"/");return(0,t.jsx)($.motion.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.05*i,duration:.3,ease:[.16,1,.3,1]},whileHover:{x:4},children:(0,t.jsxs)(r.default,{href:a.href,className:(0,s.cn)("group relative flex items-center px-3 py-2.5 text-sm font-medium rounded-lg overflow-hidden","transition-all duration-300",n?"bg-gradient-to-r from-brand-blue/10 to-brand-cyan/10 text-brand-blue shadow-md":"text-gray-600 hover:bg-white/80 hover:text-gray-900 hover:shadow-sm"),children:[!n&&(0,t.jsx)($.motion.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.5}}),(0,t.jsx)($.motion.div,{className:(0,s.cn)("p-1 rounded-md mr-3 relative z-10",n?"bg-brand-blue/10":"bg-gray-100 group-hover:bg-brand-blue/5"),whileHover:{rotate:8,scale:1.1},transition:{type:"spring",stiffness:500,damping:15},children:(0,t.jsx)(a.icon,{className:(0,s.cn)("flex-shrink-0 h-3.5 w-3.5 transition-colors",n?"text-brand-blue":"text-gray-400 group-hover:text-brand-cyan")})}),(0,t.jsx)("span",{className:"relative z-10 tracking-tight",children:a.name}),n&&(0,t.jsx)($.motion.div,{layoutId:`activeChild-${e.name}`,className:"absolute left-0 top-1/2 -translate-y-1/2 w-1 h-4 bg-gradient-to-b from-brand-blue to-brand-cyan rounded-r-full",transition:{type:"spring",stiffness:500,damping:30}})]})},a.name)})})})})]},e.name)}if(e.href){let n=l===e.href||l?.startsWith(e.href+"/");return(0,t.jsx)($.motion.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},transition:{delay:.1*a+.04*i,duration:.4,ease:[.16,1,.3,1]},whileHover:{x:4},children:(0,t.jsxs)(r.default,{href:e.href,className:(0,s.cn)("group relative flex items-center px-4 py-3 text-sm font-semibold rounded-xl overflow-hidden","transition-all duration-300 ease-out",n?"bg-gradient-to-br from-brand-blue to-brand-cyan text-white shadow-xl shadow-brand-blue/30":"text-gray-700 hover:bg-white hover:text-gray-900 hover:shadow-lg"),children:[(0,t.jsx)($.motion.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.6,ease:"easeInOut"}}),(0,t.jsx)($.motion.div,{className:(0,s.cn)("p-1.5 rounded-lg mr-3 relative z-10",n?"bg-white/20":"bg-gray-100 group-hover:bg-brand-blue/10"),whileHover:{rotate:5,scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:(0,t.jsx)(e.icon,{className:(0,s.cn)("flex-shrink-0 h-4 w-4 transition-colors",n?"text-white":"text-gray-500 group-hover:text-brand-blue")})}),(0,t.jsx)("span",{className:"relative z-10 tracking-tight",children:e.name}),n&&(0,t.jsx)($.motion.div,{layoutId:"activeSidebarItem",className:"absolute left-0 top-1/2 -translate-y-1/2 w-1 h-8 bg-white/40 rounded-r-full shadow-lg",transition:{type:"spring",stiffness:500,damping:30}}),n&&(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-brand-blue/20 to-brand-cyan/20 blur-xl opacity-50"})]})},e.name)}return null})})]},e.title))}),(0,t.jsxs)($.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5,ease:[.16,1,.3,1]},className:"relative z-10 px-4 mt-auto pt-6 space-y-2",children:[(0,t.jsxs)("div",{className:"relative mb-4",children:[(0,t.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,t.jsx)("div",{className:"w-full border-t-2 border-gradient-to-r from-transparent via-gray-200 to-transparent"})}),(0,t.jsx)("div",{className:"relative flex justify-center",children:(0,t.jsx)($.motion.div,{className:"px-3 bg-gradient-to-r from-brand-blue to-brand-cyan rounded-full p-0.5",animate:{scale:[1,1.05,1]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:(0,t.jsx)("div",{className:"bg-white px-2 py-0.5 rounded-full",children:(0,t.jsx)("span",{className:"text-[9px] font-bold text-transparent bg-clip-text bg-gradient-to-r from-brand-blue to-brand-cyan uppercase tracking-widest",children:"Syst√®me"})})})})]}),(0,t.jsx)($.motion.div,{whileHover:{x:4},children:(0,t.jsxs)(r.default,{href:"/dashboard/settings",className:(0,s.cn)("group relative flex items-center px-4 py-3 text-sm font-semibold rounded-xl overflow-hidden","transition-all duration-300",l?.startsWith("/dashboard/settings")?"bg-gradient-to-br from-gray-700 to-gray-800 text-white shadow-xl shadow-gray-700/30":"text-gray-700 hover:bg-white hover:text-gray-900 hover:shadow-lg"),children:[(0,t.jsx)($.motion.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.6,ease:"easeInOut"}}),(0,t.jsx)($.motion.div,{className:(0,s.cn)("p-1.5 rounded-lg mr-3 relative z-10",l?.startsWith("/dashboard/settings")?"bg-white/20":"bg-gray-100 group-hover:bg-gray-200"),whileHover:{rotate:90,scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:(0,t.jsx)(b.Settings,{className:(0,s.cn)("flex-shrink-0 h-4 w-4 transition-colors",l?.startsWith("/dashboard/settings")?"text-white":"text-gray-500 group-hover:text-gray-700")})}),(0,t.jsx)("span",{className:"relative z-10 tracking-tight",children:X("common.settings")})]})}),(0,t.jsx)($.motion.div,{whileHover:{x:4},children:(0,t.jsxs)($.motion.button,{onClick:()=>d(),whileHover:{scale:1.02},whileTap:{scale:.98},className:"group relative flex items-center w-full px-4 py-3 text-sm font-semibold text-gray-700 rounded-xl hover:bg-gradient-to-br hover:from-red-50 hover:to-red-100 hover:text-red-600 hover:shadow-lg transition-all duration-300 overflow-hidden",children:[(0,t.jsx)($.motion.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent",initial:{x:"-100%"},whileHover:{x:"100%"},transition:{duration:.6,ease:"easeInOut"}}),(0,t.jsx)($.motion.div,{className:"p-1.5 rounded-lg mr-3 bg-gray-100 group-hover:bg-red-100 transition-colors relative z-10",whileHover:{rotate:-15,scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:(0,t.jsx)(y.LogOut,{className:"flex-shrink-0 h-4 w-4 text-gray-500 group-hover:text-red-500 transition-colors"})}),(0,t.jsx)("span",{className:"relative z-10 tracking-tight",children:X("common.logout")})]})})]})]})]})})})}var X=e.i(284614),Z=e.i(492161),J=e.i(167881),Y=e.i(63270),ee=e.i(707866),et=e.i(37727);let ea=[{name:"Dashboard",href:"/dashboard",icon:u.LayoutDashboard},{name:"√âl√®ves",href:"/dashboard/students",icon:h.Users},{name:"Biblioth√®que",icon:ee.Library,children:[{name:"Programmes",href:"/dashboard/programs",icon:g.BookOpen},{name:"Formations",href:"/dashboard/formations",icon:N.BookMarked},{name:"Sessions",href:"/dashboard/sessions",icon:k.Calendar},{name:"E-learning",href:"/dashboard/elearning",icon:v.GraduationCap},{name:"√âvaluations",href:"/dashboard/evaluations",icon:w.FileCheck}]},{name:"Paiements",href:"/dashboard/payments",icon:p.CreditCard},{name:"√âmargement",href:"/dashboard/attendance",icon:f.ClipboardList},{name:"Documents",href:"/dashboard/documents",icon:x.FileText},{name:"Param√®tres",href:"/dashboard/settings",icon:b.Settings}];function er({isOpen:e,onClose:n}){let o=(0,i.usePathname)(),{logout:l,user:d}=(0,H.useAuth)(),[c,u]=(0,a.useState)(()=>o?.startsWith("/dashboard/programs")||o?.startsWith("/dashboard/formations")||o?.startsWith("/dashboard/sessions")||o?.startsWith("/dashboard/elearning")||o?.startsWith("/dashboard/evaluations")?["Biblioth√®que"]:[]);(0,a.useEffect)(()=>{n()},[o,n]),(0,a.useEffect)(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]);let m=e=>o===e||o?.startsWith(e+"/");return(0,t.jsx)(U.AnimatePresence,{children:e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40 md:hidden",onClick:n}),(0,t.jsxs)($.motion.div,{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-2xl md:hidden flex flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-primary/20 blur-xl rounded-full"}),(0,t.jsx)(_.Sparkles,{className:"h-6 w-6 text-primary relative z-10"})]}),(0,t.jsx)("h1",{className:"text-xl font-bold bg-gradient-to-r from-primary via-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"eduzen"})]}),(0,t.jsx)(J.Button,{variant:"ghost",size:"icon",onClick:n,className:"h-10 w-10 rounded-full",children:(0,t.jsx)(et.X,{className:"h-5 w-5"})})]}),(0,t.jsx)("nav",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:ea.map((e,a)=>{if("children"in e&&e.children){var i;let a,n=!!(i=e.children)&&i.some(e=>"href"in e&&m(e.href)),o=(a=e.name,c.includes(a));return(0,t.jsxs)("div",{children:[(0,t.jsxs)("button",{onClick:()=>{var t;return t=e.name,void u(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},className:(0,s.cn)("w-full flex items-center justify-between px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200",n?"bg-gradient-to-r from-primary to-blue-600 text-white shadow-lg shadow-primary/25":"text-gray-700 hover:bg-gray-100 active:bg-gray-200"),children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(e.icon,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:e.name})]}),(0,t.jsx)($.motion.div,{animate:{rotate:180*!!o},transition:{duration:.2},children:(0,t.jsx)(j.ChevronDown,{className:"h-4 w-4"})})]}),(0,t.jsx)(U.AnimatePresence,{children:o&&(0,t.jsx)($.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,t.jsx)("div",{className:"pl-4 mt-2 space-y-1",children:e.children.map(e=>(0,t.jsxs)(r.default,{href:e.href,className:(0,s.cn)("flex items-center space-x-3 px-4 py-2.5 rounded-lg text-sm transition-all duration-200",m(e.href)?"bg-primary/10 text-primary font-medium":"text-gray-600 hover:bg-gray-50 active:bg-gray-100"),children:[(0,t.jsx)(e.icon,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:e.name})]},e.href))})})})]},e.name)}return"href"in e?(0,t.jsxs)(r.default,{href:e.href,className:(0,s.cn)("flex items-center space-x-3 px-4 py-3 rounded-xl text-sm font-medium transition-all duration-200",m(e.href)?"bg-gradient-to-r from-primary to-blue-600 text-white shadow-lg shadow-primary/25":"text-gray-700 hover:bg-gray-100 active:bg-gray-200"),children:[(0,t.jsx)(e.icon,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:e.name})]},e.href):null})}),(0,t.jsxs)("div",{className:"p-4 border-t border-gray-200 space-y-2",children:[d&&(0,t.jsx)("div",{className:"px-4 py-2 text-sm text-gray-600",children:(0,t.jsx)("p",{className:"font-medium",children:d.email})}),(0,t.jsxs)(J.Button,{variant:"ghost",onClick:()=>{l(),n()},className:"w-full justify-start text-gray-700 hover:bg-gray-100 hover:text-gray-900",children:[(0,t.jsx)(y.LogOut,{className:"mr-3 h-4 w-4"}),"D√©connexion"]})]})]})]})})}var ei=e.i(991799),es=e.i(897250);let en=(0,q.default)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);var eo=e.i(920755),el=e.i(172431),ed=e.i(463415);function ec(){let{theme:e,resolvedTheme:r,setTheme:i,toggleTheme:s}=function(){let[e,t]=function(e,t){let[r,i]=(0,a.useState)(()=>{try{let a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(a){return console.error(`Error reading localStorage key "${e}":`,a),t}}),s=(0,a.useCallback)(t=>{try{let a=t instanceof Function?t(r):t;i(a),window.localStorage.setItem(e,JSON.stringify(a)),window.dispatchEvent(new CustomEvent("localStorageChange",{detail:{key:e,value:a}}))}catch(t){console.error(`Error setting localStorage key "${e}":`,t)}},[e,r]),n=(0,a.useCallback)(()=>{try{i(t),window.localStorage.removeItem(e),window.dispatchEvent(new CustomEvent("localStorageChange",{detail:{key:e,value:null}}))}catch(t){console.error(`Error removing localStorage key "${e}":`,t)}},[e,t]);return(0,a.useEffect)(()=>{let t=t=>{if(t instanceof StorageEvent){if(t.key===e&&t.newValue)try{i(JSON.parse(t.newValue))}catch(t){console.error(`Error parsing localStorage value for key "${e}":`,t)}}else t instanceof CustomEvent&&t.detail?.key===e&&i(t.detail.value)};return window.addEventListener("storage",t),window.addEventListener("localStorageChange",t),()=>{window.removeEventListener("storage",t),window.removeEventListener("localStorageChange",t)}},[e]),[r,s,n]}("theme","system"),[r,i]=(0,a.useState)("light"),s=(0,eo.createClient)(),{user:n}=(0,H.useAuth)(),o=async e=>{if(n?.id)try{await s.from("users").update({theme_preference:e}).eq("id",n.id)}catch(e){console.error("Error saving theme preference:",e)}};(0,a.useEffect)(()=>{n?.id&&(async()=>{try{let{data:e}=await s.from("users").select("theme_preference").eq("id",n.id).single();e?.theme_preference&&t(e.theme_preference)}catch(e){console.error("Error loading theme preference:",e)}})()},[n?.id,t,s]),(0,a.useEffect)(()=>{let t=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",a="system"===e?t:e;i(a);let r=document.documentElement;"dark"===a?r.classList.add("dark"):r.classList.remove("dark");let s=window.matchMedia("(prefers-color-scheme: dark)"),n=t=>{if("system"===e){let e=t.matches?"dark":"light";i(e),"dark"===e?r.classList.add("dark"):r.classList.remove("dark")}};return s.addEventListener("change",n),()=>s.removeEventListener("change",n)},[e]);let l=e=>{t(e),o(e),el.analytics.theme.changed(e),"system"===e?i(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"):i(e);let a=document.documentElement;"system"===e?"dark"==(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")?a.classList.add("dark"):a.classList.remove("dark"):"dark"===e?a.classList.add("dark"):a.classList.remove("dark")};return{theme:e,resolvedTheme:r,setTheme:l,toggleTheme:()=>{l("dark"===r?"light":"dark")}}}();return(0,t.jsxs)(ed.DropdownMenu,{children:[(0,t.jsx)(ed.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(J.Button,{variant:"ghost",size:"icon",className:"h-10 w-10 rounded-xl min-touch-target touch-manipulation",children:[(0,t.jsx)($.motion.div,{animate:{rotate:180*("dark"===r)},transition:{duration:.3},children:"dark"===r?(0,t.jsx)(ei.Moon,{className:"h-5 w-5"}):(0,t.jsx)(es.Sun,{className:"h-5 w-5"})}),(0,t.jsx)("span",{className:"sr-only",children:"Changer le th√®me"})]})}),(0,t.jsxs)(ed.DropdownMenuContent,{align:"end",className:"w-40",children:[(0,t.jsxs)(ed.DropdownMenuItem,{onClick:()=>i("light"),className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)(es.Sun,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Clair"}),"light"===e&&(0,t.jsx)($.motion.span,{initial:{scale:0},animate:{scale:1},className:"ml-auto h-2 w-2 rounded-full bg-primary"})]}),(0,t.jsxs)(ed.DropdownMenuItem,{onClick:()=>i("dark"),className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)(ei.Moon,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Sombre"}),"dark"===e&&(0,t.jsx)($.motion.span,{initial:{scale:0},animate:{scale:1},className:"ml-auto h-2 w-2 rounded-full bg-primary"})]}),(0,t.jsxs)(ed.DropdownMenuItem,{onClick:()=>i("system"),className:"flex items-center gap-2 cursor-pointer",children:[(0,t.jsx)(en,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Syst√®me"}),"system"===e&&(0,t.jsx)($.motion.span,{initial:{scale:0},animate:{scale:1},className:"ml-auto h-2 w-2 rounded-full bg-primary"})]})]})]})}var eu=e.i(266027),em=e.i(555436),eh=e.i(629377);let eg=new class{supabase;constructor(e){this.supabase=e||(0,eo.createClient)()}async searchGlobal(e,t,a){if(!e||e.trim().length<2)return[];let r=e.trim().toLowerCase(),i=[],[s,n,o,l]=await Promise.all([this.searchStudents(r,t),this.searchSessions(r,t),this.searchDocuments(r,t),a?this.searchConversations(r,t,a):Promise.resolve([])]);return i.push(...s,...n,...o,...l),i.sort((e,t)=>{let a=+!!e.title.toLowerCase().startsWith(r);return!!t.title.toLowerCase().startsWith(r)-a})}async searchStudents(e,t){let{data:a,error:r}=await this.supabase.from("students").select("id, first_name, last_name, student_number, email").eq("organization_id",t).or(`first_name.ilike.%${e}%,last_name.ilike.%${e}%,student_number.ilike.%${e}%,email.ilike.%${e}%`).limit(10);return r||!a?[]:a.map(e=>({type:"student",id:e.id,title:`${e.first_name||""} ${e.last_name||""}`.trim()||e.student_number||"√âtudiant",description:e.student_number||e.email||void 0,url:`/dashboard/students/${e.id}`,metadata:{student_number:e.student_number,email:e.email}}))}async searchSessions(e,t){let{data:a,error:r}=await this.supabase.from("sessions").select("id, name, start_date, end_date").eq("organization_id",t).ilike("name",`%${e}%`).limit(10);return r||!a?[]:a.map(e=>({type:"session",id:e.id,title:e.name||"Session",description:e.start_date?`Du ${new Date(e.start_date).toLocaleDateString("fr-FR")}`:void 0,url:`/dashboard/sessions/${e.id}`,metadata:{start_date:e.start_date,end_date:e.end_date}}))}async searchDocuments(e,t){let{data:a,error:r}=await this.supabase.from("documents").select("id, title, type, created_at").eq("organization_id",t).ilike("title",`%${e}%`).limit(10);return r||!a?[]:a.map(e=>({type:"document",id:e.id,title:e.title||"Document",description:e.type||void 0,url:"/dashboard/documents",metadata:{type:e.type,created_at:e.created_at}}))}async searchConversations(e,t,a){let{data:r,error:i}=await this.supabase.from("conversations").select("id, name, conversation_type").eq("organization_id",t).ilike("name",`%${e}%`).limit(5);if(i||!r)return[];let s=r.map(e=>e.id),{data:n}=await this.supabase.from("conversation_participants").select("conversation_id").in("conversation_id",s).eq("user_id",a),o=new Set(n?.map(e=>e.conversation_id)||[]);return r.filter(e=>o.has(e.id)).map(e=>({type:"message",id:e.id,title:e.name||"Conversation",description:"group"===e.conversation_type?"Groupe":"Direct",url:`/dashboard/messages/${e.id}`,metadata:{conversation_type:e.conversation_type}}))}};function ep(e,t){if(!t||!e)return[{text:e,highlight:!1}];let a=e.toLowerCase(),r=t.toLowerCase(),i=[],s=0,n=a.indexOf(r,s);for(;-1!==n;)n>s&&i.push({text:e.substring(s,n),highlight:!1}),i.push({text:e.substring(n,n+t.length),highlight:!0}),s=n+t.length,n=a.indexOf(r,s);return s<e.length&&i.push({text:e.substring(s),highlight:!1}),i.length>0?i:[{text:e,highlight:!1}]}let ex={student:h.Users,session:g.BookOpen,document:x.FileText,message:m.MessageSquare},ef={student:"√âtudiant",session:"Session",document:"Document",message:"Message"};function eb({className:e}){let{user:r}=(0,H.useAuth)(),n=(0,i.useRouter)(),[o,l]=(0,a.useState)(""),[d,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),h=function(e,t=300){let[r,i]=(0,a.useState)(e);return(0,a.useEffect)(()=>{let a=setTimeout(()=>{i(e)},t);return()=>{clearTimeout(a)}},[e,t]),r}(o,300),g=(0,a.useRef)(null);!function(e,t=!0){let r=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(!t)return;let a=t=>{r.current&&!r.current.contains(t.target)&&e()};return document.addEventListener("mousedown",a),document.addEventListener("touchstart",a),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("touchstart",a)}},[e,t])}(g,()=>c(!1));let{data:p,isLoading:x}=(0,eu.useQuery)({queryKey:["global-search",h,r?.organization_id,r?.id],queryFn:async()=>{if(!h||h.length<2||!r?.organization_id)return[];let e=await eg.searchGlobal(h,r.organization_id,r.id);return e.length>0&&el.analytics.search.performed(h,e.length),e},enabled:h.length>=2&&!!r?.organization_id,staleTime:3e4});(0,a.useEffect)(()=>{o.length>=2&&u?c(!0):0===o.length&&c(!1)},[o,u]);let f=e=>{n.push(e.url),l(""),c(!1),m(!1)};return(0,t.jsxs)("div",{ref:g,className:(0,s.cn)("relative flex-1 max-w-xl",e),children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"absolute left-3 md:left-4 top-1/2 -translate-y-1/2 pointer-events-none",children:x?(0,t.jsx)(eh.Loader2,{className:"h-4 w-4 md:h-5 md:w-5 animate-spin text-text-tertiary"}):(0,t.jsx)(em.Search,{className:"h-4 w-4 md:h-5 md:w-5 text-text-tertiary"})}),(0,t.jsx)("input",{type:"text",placeholder:"Rechercher des √©tudiants, sessions, documents...",value:o,onChange:e=>l(e.target.value),onFocus:()=>m(!0),onBlur:()=>{setTimeout(()=>m(!1),200)},onKeyDown:e=>{"Escape"===e.key?(c(!1),m(!1)):"Enter"===e.key&&p&&p.length>0&&f(p[0])},className:(0,s.cn)("w-full pl-10 md:pl-12 pr-10 py-2.5 md:py-3 rounded-xl border-2 transition-all duration-300 text-sm md:text-base","focus:outline-none focus:ring-2 focus:ring-brand-cyan/30","bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm text-text-primary placeholder:text-text-placeholder",u||d?"border-brand-cyan shadow-lg shadow-brand-cyan/20 bg-white dark:bg-gray-800":"border-white/30 dark:border-gray-700/30 hover:border-white/50 dark:hover:border-gray-700/50")}),o&&(0,t.jsx)("button",{onClick:()=>{l(""),c(!1)},className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:(0,t.jsx)(et.X,{className:"h-4 w-4 text-text-tertiary"})})]}),(0,t.jsx)(U.AnimatePresence,{children:d&&p&&p.length>0&&(0,t.jsx)($.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute top-full mt-2 w-full bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 max-h-96 overflow-y-auto z-50",children:p.map(e=>{let a=ex[e.type],r=ep(e.title,h),i=e.description?ep(e.description,h):null;return(0,t.jsxs)("button",{onClick:()=>f(e),className:"w-full px-4 py-3 flex items-start gap-3 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-left first:rounded-t-xl last:rounded-b-xl",children:[(0,t.jsx)(a,{className:"h-5 w-5 text-brand-cyan mt-0.5 flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"font-medium text-text-primary truncate",children:r.map((e,a)=>e.highlight?(0,t.jsx)("mark",{className:"bg-brand-cyan/20 text-brand-cyan dark:bg-brand-cyan/30 dark:text-brand-cyan font-semibold px-0.5 rounded",children:e.text},a):(0,t.jsx)("span",{children:e.text},a))}),(0,t.jsx)("span",{className:"text-xs text-text-tertiary bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded flex-shrink-0",children:ef[e.type]})]}),i&&(0,t.jsx)("p",{className:"text-sm text-text-tertiary mt-1 truncate",children:i.map((e,a)=>e.highlight?(0,t.jsx)("mark",{className:"bg-brand-cyan/20 text-brand-cyan dark:bg-brand-cyan/30 dark:text-brand-cyan font-semibold px-0.5 rounded",children:e.text},a):(0,t.jsx)("span",{children:e.text},a))})]})]},`${e.type}-${e.id}`)})})}),d&&o.length>=2&&!x&&(!p||0===p.length)&&(0,t.jsx)($.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute top-full mt-2 w-full bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 p-4 z-50",children:(0,t.jsxs)("p",{className:"text-sm text-text-tertiary text-center",children:['Aucun r√©sultat trouv√© pour "',o,'"']})})]})}var ey=e.i(954616);let ev=new class{supabase;constructor(e){this.supabase=e||(0,eo.createClient)()}async create(e){let{data:t,error:a}=await this.supabase.from("user_feedback").insert({organization_id:e.organizationId,user_id:e.userId,student_id:e.studentId,feedback_type:e.feedbackType,category:e.category,title:e.title,description:e.description,page_url:e.pageUrl,user_agent:e.userAgent,screenshot_url:e.screenshotUrl,priority:e.priority||"medium",status:"pending"}).select().single();if(a)throw a;return t}async getByOrganization(e,t){let a=t?.page||1,r=t?.limit||50,i=(a-1)*r,s=this.supabase.from("user_feedback").select("*, users(id, full_name, email), students(id, first_name, last_name, email), assigned_user:users!assigned_to(id, full_name, email)",{count:"exact"}).eq("organization_id",e).order("created_at",{ascending:!1});t?.userId&&(s=s.eq("user_id",t.userId)),t?.status&&(s=s.eq("status",t.status)),t?.feedbackType&&(s=s.eq("feedback_type",t.feedbackType)),t?.priority&&(s=s.eq("priority",t.priority)),t?.assignedTo&&(s=s.eq("assigned_to",t.assignedTo));let{data:n,error:o,count:l}=await s.range(i,i+r-1);if(o)throw o;return{data:n||[],total:l||0,page:a,limit:r,totalPages:Math.ceil((l||0)/r)}}async getById(e){let{data:t,error:a}=await this.supabase.from("user_feedback").select("*, users(id, full_name, email), students(id, first_name, last_name, email), assigned_user:users!assigned_to(id, full_name, email)").eq("id",e).single();if(a)throw a;return t}async update(e,t){let{data:a,error:r}=await this.supabase.from("user_feedback").update(t).eq("id",e).select().single();if(r)throw r;return a}async assign(e,t){return this.update(e,{assigned_to:t,status:"reviewing"})}async updateStatus(e,t,a){let r={status:t,resolved_at:"resolved"===t?new Date().toISOString():null,resolution_notes:a};return this.update(e,r)}async getStats(e){let{data:t,error:a}=await this.supabase.from("user_feedback").select("status, feedback_type, priority").eq("organization_id",e);if(a)throw a;let r={total:t?.length||0,byStatus:{},byType:{},byPriority:{},pending:0,resolved:0};return t?.forEach(e=>{r.byStatus[e.status]=(r.byStatus[e.status]||0)+1,r.byType[e.feedback_type]=(r.byType[e.feedback_type]||0)+1,r.byPriority[e.priority]=(r.byPriority[e.priority]||0)+1,"pending"===e.status&&r.pending++,"resolved"===e.status&&r.resolved++}),r}async delete(e){let{error:t}=await this.supabase.from("user_feedback").delete().eq("id",e);if(t)throw t}};var ew=e.i(6799),ej=e.i(630374),eN=e.i(23750),ek=e.i(10708),e_=e.i(184762),eC=e.i(716158),eS=e.i(473708);function eE({variant:e="outline",size:r="default",className:i}){let{user:s}=(0,H.useAuth)(),{addToast:n}=(0,ew.useToast)(),[o,l]=(0,a.useState)(!1),[d,c]=(0,a.useState)("improvement"),[u,h]=(0,a.useState)(""),[g,p]=(0,a.useState)(""),[x,f]=(0,a.useState)(""),[b,y]=(0,a.useState)(null),[v,w]=(0,a.useState)(null),j=(0,eo.createClient)(),N=(0,ey.useMutation)({mutationFn:async()=>{if(!s?.organization_id)throw Error("Organisation non trouv√©e");let e=null;if(b){let t=b.name.split(".").pop(),a=`feedback-${Date.now()}.${t}`,r=`feedback/${s.organization_id}/${a}`,{data:i,error:n}=await j.storage.from("documents").upload(r,b,{cacheControl:"3600",upsert:!1});if(n)console.error("Erreur upload screenshot:",n);else{let{data:t}=j.storage.from("documents").getPublicUrl(r);e=t.publicUrl}}return ev.create({organizationId:s.organization_id,userId:s.id,feedbackType:d,category:x||void 0,title:u,description:g,pageUrl:window.location.href,userAgent:window.navigator.userAgent,screenshotUrl:e||void 0})},onSuccess:()=>{n({type:"success",title:"Feedback envoy√©",description:"Merci pour votre retour ! Nous examinerons votre demande rapidement."}),l(!1),h(""),p(""),f(""),y(null),w(null)},onError:e=>{n({type:"error",title:"Erreur",description:e.message||"Une erreur est survenue lors de l'envoi du feedback."})}});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(J.Button,{variant:e,size:r,onClick:()=>l(!0),className:i,children:[(0,t.jsx)(m.MessageSquare,{className:"mr-2 h-4 w-4"}),"Feedback"]}),(0,t.jsx)(ej.Dialog,{open:o,onOpenChange:l,children:(0,t.jsxs)(ej.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(ej.DialogHeader,{children:[(0,t.jsx)(ej.DialogTitle,{children:"Envoyer un feedback"}),(0,t.jsx)(ej.DialogDescription,{children:"Partagez vos id√©es, signalez un bug ou posez une question. Votre avis nous aide √† am√©liorer l'application."})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(ek.Label,{htmlFor:"feedback-type",children:"Type de feedback"}),(0,t.jsxs)(eC.Select,{value:d,onValueChange:e=>c(e),children:[(0,t.jsx)(eC.SelectTrigger,{id:"feedback-type",children:(0,t.jsx)(eC.SelectValue,{})}),(0,t.jsxs)(eC.SelectContent,{children:[(0,t.jsx)(eC.SelectItem,{value:"bug",children:"üêõ Bug / Probl√®me"}),(0,t.jsx)(eC.SelectItem,{value:"feature_request",children:"‚ú® Demande de fonctionnalit√©"}),(0,t.jsx)(eC.SelectItem,{value:"improvement",children:"üí° Am√©lioration"}),(0,t.jsx)(eC.SelectItem,{value:"question",children:"‚ùì Question"}),(0,t.jsx)(eC.SelectItem,{value:"other",children:"üìù Autre"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(ek.Label,{htmlFor:"category",children:"Cat√©gorie (optionnel)"}),(0,t.jsx)(eN.Input,{id:"category",placeholder:"Ex: Messagerie, Paiements, Documents...",value:x,onChange:e=>f(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(ek.Label,{htmlFor:"title",children:"Titre *"}),(0,t.jsx)(eN.Input,{id:"title",placeholder:"R√©sum√© court de votre feedback",value:u,onChange:e=>h(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(ek.Label,{htmlFor:"description",children:"Description *"}),(0,t.jsx)(e_.Textarea,{id:"description",placeholder:"D√©crivez en d√©tail votre feedback, bug ou demande...",value:g,onChange:e=>p(e.target.value),rows:6,required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(ek.Label,{htmlFor:"screenshot",children:"Capture d'√©cran (optionnel)"}),v?(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("img",{src:v,alt:"Screenshot preview",className:"w-full rounded-lg border border-gray-200 max-h-64 object-contain"}),(0,t.jsx)(J.Button,{variant:"ghost",size:"icon",onClick:()=>{y(null),w(null)},className:"absolute top-2 right-2",children:(0,t.jsx)(et.X,{className:"h-4 w-4"})})]}):(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eN.Input,{id:"screenshot",type:"file",accept:"image/*",onChange:e=>{let t=e.target.files?.[0];if(t){if(t.size>5242880)return void n({type:"warning",title:"Fichier trop volumineux",description:"La capture d'√©cran ne doit pas d√©passer 5 MB."});y(t);let e=new FileReader;e.onloadend=()=>{w(e.result)},e.readAsDataURL(t)}},className:"hidden"}),(0,t.jsxs)(ek.Label,{htmlFor:"screenshot",className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,t.jsx)(eS.Image,{className:"h-4 w-4"}),"Ajouter une capture d'√©cran"]})]})]})]}),(0,t.jsxs)(ej.DialogFooter,{children:[(0,t.jsx)(J.Button,{variant:"outline",onClick:()=>l(!1),children:"Annuler"}),(0,t.jsx)(J.Button,{onClick:()=>N.mutate(),disabled:!u||!g||N.isPending,children:N.isPending?"Envoi...":"Envoyer le feedback"})]})]})})]})}var eL=e.i(226691),eP=e.i(912598),ez=e.i(790224);class eD{supabase;constructor(e){this.supabase=e||(0,eo.createClient)()}channels=new Map;async create(e){try{let{data:t,error:a}=await this.supabase.rpc("create_notification",{p_user_id:e.user_id,p_organization_id:e.organization_id,p_type:e.type,p_title:e.title,p_message:e.message,p_data:e.data||{},p_link:e.link||null,p_expires_at:e.expires_at||null});if(a)throw a;let{data:r,error:i}=await this.supabase.from("notifications").select("*").eq("id",t).single();if(i)throw i;return r}catch(t){throw ez.logger.error("Error creating notification",t,{params:e}),t}}async createForUsers(e,t,a,r,i,s,n){try{if(0===e.length)return[];let{data:o,error:l}=await this.supabase.from("notifications").insert(e.map(e=>({user_id:e,organization_id:t,type:a,title:r,message:i,data:s||{},link:n||null}))).select();if(l)throw ez.logger.error("Error creating batch notifications",l,{userCount:e.length,organizationId:t,type:a}),l;return ez.logger.info("Batch notifications created successfully",{count:o.length,organizationId:t,type:a}),o}catch(e){throw ez.logger.error("Error in createForUsers",e),e}}async getByUser(e,t){try{let a=this.supabase.from("notifications").select("*").eq("user_id",e).order("created_at",{ascending:!1});t?.unread_only&&(a=a.is("read_at",null)),t?.limit&&(a=a.limit(t.limit)),t?.offset&&(a=a.range(t.offset,t.offset+(t.limit||50)-1));let{data:r,error:i}=await a;if(i)throw i;return r||[]}catch(a){throw ez.logger.error("Error fetching notifications",a,{user_id:e,options:t}),a}}async getUnreadCount(e){try{if(!e)return 0;let{count:t,error:a}=await this.supabase.from("notifications").select("*",{count:"exact",head:!0}).eq("user_id",e).is("read_at",null);if(a)return ez.logger.warn("Error getting unread count, returning 0",{error:a,user_id:e,errorCode:a.code,errorMessage:a.message}),0;return t||0}catch(t){return ez.logger.error("Exception in getUnreadCount, returning 0",t,{user_id:e}),0}}async markAsRead(e){try{let{data:t,error:a}=await this.supabase.rpc("mark_notification_read",{p_notification_id:e});if(a)throw a;return t||!1}catch(t){throw ez.logger.error("Error marking notification as read",t,{notification_id:e}),t}}async markAllAsRead(e){try{let{data:t,error:a}=await this.supabase.rpc("mark_all_notifications_read",{p_user_id:e});if(a)throw a;return t||0}catch(t){throw ez.logger.error("Error marking all notifications as read",t,{user_id:e}),t}}async delete(e){try{let{error:t}=await this.supabase.from("notifications").delete().eq("id",e);if(t)throw t;return!0}catch(t){throw ez.logger.error("Error deleting notification",t,{notification_id:e}),t}}subscribeToNotifications(e,t){let a=`notifications:${e}`;this.channels.has(a)&&this.unsubscribeFromNotifications(e);let r=this.supabase.channel(a).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${e}`},e=>{t(e.new)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"notifications",filter:`user_id=eq.${e}`},e=>{t(e.new)}).subscribe();return this.channels.set(a,r),()=>{this.unsubscribeFromNotifications(e)}}unsubscribeFromNotifications(e){let t=`notifications:${e}`,a=this.channels.get(t);a&&(this.supabase.removeChannel(a),this.channels.delete(t))}cleanup(){this.channels.forEach(e=>{this.supabase.removeChannel(e)}),this.channels.clear()}}let eq=new eD;function eA({onClick:e,className:r,showCount:i=!0}){let n=function(){let{user:e}=(0,H.useAuth)(),t=(0,eP.useQueryClient)(),{data:r=0}=(0,eu.useQuery)({queryKey:["notifications","unread-count",e?.id],queryFn:()=>e?.id?eq.getUnreadCount(e.id):Promise.resolve(0),enabled:!!e?.id,refetchInterval:1e4});return(0,a.useEffect)(()=>{if(e?.id)return eq.subscribeToNotifications(e.id,()=>{t.invalidateQueries({queryKey:["notifications","unread-count",e.id]})})},[e?.id,t]),r}();return(0,t.jsxs)(J.Button,{variant:"ghost",size:"icon",onClick:e,className:(0,s.cn)("relative",r),"aria-label":`Notifications${n>0?` (${n} non lues)`:""}`,children:[(0,t.jsx)(eL.Bell,{className:"h-5 w-5"}),i&&n>0&&(0,t.jsx)("span",{className:"absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs font-bold text-white",children:n>99?"99+":n})]})}let eM=(0,q.default)("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);var eT=e.i(727612),eB=e.i(778917);let eI=a.forwardRef(({className:e,children:a,...r},i)=>(0,t.jsx)("div",{ref:i,className:(0,s.cn)("relative overflow-auto",e),...r,children:a}));eI.displayName="ScrollArea";var eR=e.i(994179),eF=e.i(377545);let eW={info:"bg-blue-500",success:"bg-green-500",warning:"bg-yellow-500",error:"bg-red-500",message:"bg-purple-500",payment:"bg-indigo-500",attendance:"bg-teal-500",grade:"bg-pink-500",document:"bg-orange-500",system:"bg-gray-500"},eO={info:"Information",success:"Succ√®s",warning:"Avertissement",error:"Erreur",message:"Message",payment:"Paiement",attendance:"Pr√©sence",grade:"Note",document:"Document",system:"Syst√®me"};function eH({open:e,onOpenChange:i}){let{notifications:n,unreadCount:o,isLoading:l,markAsRead:d,markAllAsRead:c,deleteNotification:u,isMarkingAllAsRead:m}=function(e){let{user:t}=(0,H.useAuth)(),r=(0,eP.useQueryClient)(),{addToast:i}=(0,ew.useToast)(),[s,n]=(0,a.useState)([]),{data:o=[],isLoading:l,error:d,refetch:c}=(0,eu.useQuery)({queryKey:["notifications",t?.id,e?.unread_only,e?.limit],queryFn:()=>eq.getByUser(t.id,{limit:e?.limit||50,unread_only:e?.unread_only}),enabled:!!t?.id,refetchInterval:!!e?.auto_refresh&&3e4}),{data:u=0}=(0,eu.useQuery)({queryKey:["notifications","unread-count",t?.id],queryFn:()=>t?.id?eq.getUnreadCount(t.id):Promise.resolve(0),enabled:!!t?.id,refetchInterval:1e4});(0,a.useEffect)(()=>{if(!t?.id)return;let e=eq.subscribeToNotifications(t.id,e=>{n(t=>[e,...t]),r.invalidateQueries({queryKey:["notifications",t.id]}),r.invalidateQueries({queryKey:["notifications","unread-count",t.id]}),"system"!==e.type&&i({type:"error"===e.type?"error":"info",title:e.title,description:e.message,duration:5e3})});return()=>{e()}},[t?.id,r,i]);let m=(0,ey.useMutation)({mutationFn:e=>eq.markAsRead(e),onSuccess:()=>{r.invalidateQueries({queryKey:["notifications",t?.id]}),r.invalidateQueries({queryKey:["notifications","unread-count",t?.id]})}}),h=(0,ey.useMutation)({mutationFn:()=>eq.markAllAsRead(t.id),onSuccess:e=>{r.invalidateQueries({queryKey:["notifications",t?.id]}),r.invalidateQueries({queryKey:["notifications","unread-count",t?.id]}),i({type:"success",title:"Notifications marqu√©es comme lues",description:`${e} notification(s) marqu\xe9e(s) comme lue(s).`})}}),g=(0,ey.useMutation)({mutationFn:e=>eq.delete(e),onSuccess:()=>{r.invalidateQueries({queryKey:["notifications",t?.id]}),r.invalidateQueries({queryKey:["notifications","unread-count",t?.id]})}});return{notifications:[...s,...o].filter((e,t,a)=>t===a.findIndex(t=>t.id===e.id)),unreadCount:u,isLoading:l,error:d,refetch:c,markAsRead:m.mutate,markAllAsRead:h.mutate,deleteNotification:g.mutate,isMarkingAsRead:m.isPending,isMarkingAllAsRead:h.isPending,isDeleting:g.isPending}}({limit:50}),[h,g]=(0,a.useState)("all"),p=n.filter(e=>"unread"!==h||!e.read_at);return(0,t.jsx)(ej.Dialog,{open:e,onOpenChange:i,children:(0,t.jsxs)(ej.DialogContent,{className:"sm:max-w-[500px]",children:[(0,t.jsx)(ej.DialogHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(ej.DialogTitle,{children:"Notifications"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[o>0&&(0,t.jsxs)(J.Button,{variant:"ghost",size:"sm",onClick:()=>{c()},disabled:m,className:"text-xs",children:[(0,t.jsx)(eM,{className:"mr-1 h-3 w-3"}),"Tout marquer comme lu"]}),(0,t.jsx)(J.Button,{variant:"ghost",size:"icon",onClick:()=>i(!1),className:"h-6 w-6",children:(0,t.jsx)(et.X,{className:"h-4 w-4"})})]})]})}),(0,t.jsxs)("div",{className:"flex gap-2 border-b pb-2",children:[(0,t.jsxs)(J.Button,{variant:"all"===h?"default":"ghost",size:"sm",onClick:()=>g("all"),className:"text-xs",children:["Toutes (",n.length,")"]}),(0,t.jsxs)(J.Button,{variant:"unread"===h?"default":"ghost",size:"sm",onClick:()=>g("unread"),className:"text-xs",children:["Non lues (",o,")"]})]}),(0,t.jsx)(eI,{className:"h-[500px]",children:l?(0,t.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Chargement..."})}):0===p.length?(0,t.jsx)("div",{className:"flex flex-col items-center justify-center py-8",children:(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"unread"===h?"Aucune notification non lue":"Aucune notification"})}):(0,t.jsx)("div",{className:"space-y-1",children:p.map(e=>(0,t.jsx)("div",{className:(0,s.cn)("group relative rounded-lg border p-3 transition-colors hover:bg-accent",!e.read_at&&"bg-accent/50"),onClick:()=>{e.read_at||d(e.id)},children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:(0,s.cn)("mt-1 h-2 w-2 rounded-full",eW[e.type])}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h4",{className:"text-sm font-medium",children:e.title}),(0,t.jsx)(eR.Badge,{variant:"outline",className:"text-xs",children:eO[e.type]})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.message})]}),(0,t.jsx)(J.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100",onClick:t=>{var a;return a=e.id,void(t.stopPropagation(),u(a))},children:(0,t.jsx)(eT.Trash2,{className:"h-3 w-3"})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,t.jsx)("span",{children:(0,eF.formatRelativeTime)(e.created_at)}),e.link&&(0,t.jsxs)(r.default,{href:e.link,onClick:e=>e.stopPropagation(),className:"flex items-center gap-1 text-primary hover:underline",children:["Voir ",(0,t.jsx)(eB.ExternalLink,{className:"h-3 w-3"})]})]})]}),!e.read_at&&(0,t.jsx)("div",{className:"absolute right-2 top-2",children:(0,t.jsx)("div",{className:"h-2 w-2 rounded-full bg-primary"})})]})},e.id))})})]})})}var e$=a["use".trim()],eU=e.i(549092),eK=e.i(77105),eQ=e.i(489790),eV=e.i(33165);let{Link:eG,redirect:eX,usePathname:eZ,useRouter:eJ}=function(e){let{Link:r,config:s,getPathname:n,...o}=function(e,r){var s,n,o;let l={...s=r||{},localePrefix:"object"==typeof(o=s.localePrefix)?o:{mode:o||"always"},localeCookie:!!((n=s.localeCookie)??1)&&{name:"NEXT_LOCALE",sameSite:"lax",..."object"==typeof n&&n},localeDetection:s.localeDetection??!0,alternateLinks:s.alternateLinks??!0},d=l.pathnames,c=(0,a.forwardRef)(function({href:a,locale:r,...i},s){let n,o;"object"==typeof a?(n=a.pathname,o=a.params):n=a;let c=(0,eU.isLocalizableHref)(a),m=e(),h=(0,eU.isPromise)(m)?e$(m):m,g=c?u({locale:r||h,href:null==d?n:{pathname:n,params:o},forcePrefix:null!=r||void 0}):n;return(0,t.jsx)(eK.default,{ref:s,href:"object"==typeof a?{...a,pathname:g}:g,locale:r,localeCookie:l.localeCookie,...i})});function u(e){let t,{forcePrefix:a,href:r,locale:i}=e;return null==d?"object"==typeof r?(t=r.pathname,r.query&&(t+=(0,eQ.serializeSearchParams)(r.query))):t=r:t=(0,eQ.compileLocalizedPathname)({locale:i,...(0,eQ.normalizeNameOrNameWithParams)(r),pathnames:l.pathnames}),(0,eQ.applyPathnamePrefix)(t,i,l,a)}function m(e){return function(t,...a){return e(u(t),...a)}}return{config:l,Link:c,redirect:m(i.redirect),permanentRedirect:m(i.permanentRedirect),getPathname:u}}(l.useLocale,e);return{...o,Link:r,usePathname:function(){let e,t,r=(e=(0,i.usePathname)(),t=(0,l.useLocale)(),(0,a.useMemo)(()=>{if(!e)return e;let a=e,r=(0,eU.getLocalePrefix)(t,s.localePrefix);if((0,eU.hasPathnamePrefixed)(r,e))a=(0,eU.unprefixPathname)(e,r);else if("never"!==s.localePrefix.mode&&s.localePrefix.prefixes){let r=(0,eU.getLocaleAsPrefix)(t);(0,eU.hasPathnamePrefixed)(r,e)&&(a=(0,eU.unprefixPathname)(e,r))}return a},[s.localePrefix,t,e])),n=(0,l.useLocale)();return(0,a.useMemo)(()=>r&&s.pathnames?(0,eQ.getRoute)(n,r,s.pathnames):r,[n,r])},useRouter:function(){let e=(0,i.useRouter)(),t=(0,l.useLocale)(),r=(0,i.usePathname)();return(0,a.useMemo)(()=>{function a(e){return function(a,i){let{locale:o,...l}=i||{},d=[n({href:a,locale:o||t,forcePrefix:null!=o||void 0})];Object.keys(l).length>0&&d.push(l),(0,eV.default)(s.localeCookie,r,t,o),e(...d)}}return{...e,push:a(e.push),replace:a(e.replace),prefetch:a(e.prefetch)}},[t,r,e])},getPathname:n}}({locales:["fr","en"],defaultLocale:"fr",localePrefix:"never"}),eY=[{code:"fr",label:"Fran√ßais",flag:"üá´üá∑"},{code:"en",label:"English",flag:"üá¨üáß"}];function e0(){let e=(0,l.useLocale)(),r=eJ(),i=eZ(),[s,n]=(0,a.useState)(!1),o=eY.find(t=>t.code===e)||eY[0];return(0,t.jsxs)(ed.DropdownMenu,{children:[(0,t.jsx)(ed.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(J.Button,{variant:"ghost",size:"sm",className:"gap-2",disabled:s,children:[(0,t.jsx)(F.Globe,{className:"h-4 w-4"}),(0,t.jsxs)("span",{className:"hidden sm:inline",children:[o.flag," ",o.label]}),(0,t.jsx)("span",{className:"sm:hidden",children:o.flag})]})}),(0,t.jsx)(ed.DropdownMenuContent,{align:"end",children:eY.map(a=>(0,t.jsxs)(ed.DropdownMenuItem,{onClick:()=>{var t;(t=a.code)===e||s||(n(!0),r.replace(i,{locale:t}),setTimeout(()=>{n(!1)},500))},disabled:a.code===e||s,className:"cursor-pointer",children:[(0,t.jsx)("span",{className:"mr-2",children:a.flag}),a.label,a.code===e&&(0,t.jsx)("span",{className:"ml-auto text-xs text-muted-foreground",children:"‚úì"})]},a.code))})]})}function e1({onMenuClick:e}){let{user:r,logout:i}=(0,H.useAuth)(),[n,o]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)(!1),m=(0,a.useRef)(null);return(0,a.useEffect)(()=>{function e(e){m.current&&!m.current.contains(e.target)&&o(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,t.jsxs)(a.default.Fragment,{children:[(0,t.jsx)(er,{isOpen:l,onClose:()=>d(!1)}),(0,t.jsx)(eH,{open:c,onOpenChange:u}),(0,t.jsx)($.motion.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-bg-gray-50 border-b border-bg-gray-200 px-4 md:px-6 py-3 md:py-4 sticky top-0 z-30 shadow-sm",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsx)(J.Button,{variant:"ghost",size:"icon",onClick:()=>d(!0),className:"md:hidden h-10 w-10 rounded-xl",children:(0,t.jsx)(Z.Menu,{className:"h-5 w-5"})}),(0,t.jsx)(eb,{}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 md:space-x-4",children:[(0,t.jsx)(eE,{variant:"ghost",size:"icon",className:"hidden md:flex"}),(0,t.jsx)(e0,{}),(0,t.jsx)(ec,{}),(0,t.jsx)(eA,{onClick:()=>u(!0)}),(0,t.jsxs)("div",{className:"relative",ref:m,children:[(0,t.jsxs)($.motion.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>o(!n),className:"flex items-center space-x-3 px-3 py-2 rounded-xl hover:bg-bg-gray-100 transition-colors duration-200 min-touch-target touch-manipulation group",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(Y.Avatar,{fallback:r?.full_name||"Utilisateur",userId:r?.id||"default",size:"md",variant:"auto",className:"shadow-lg group-hover:shadow-xl transition-shadow duration-300 rounded-xl border-2 border-bg-gray-200"}),(0,t.jsxs)("div",{className:"text-right hidden md:block",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-text-primary",children:r?.full_name||"Utilisateur"}),(0,t.jsx)("p",{className:"text-xs text-text-tertiary",children:r?.role||"R√¥le"})]})]}),(0,t.jsx)(j.ChevronDown,{className:(0,s.cn)("h-4 w-4 text-text-tertiary transition-transform duration-200 hidden md:block",n&&"rotate-180")})]}),(0,t.jsx)(U.AnimatePresence,{children:n&&(0,t.jsxs)($.motion.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute right-0 mt-2 w-56 rounded-xl bg-white shadow-xl border border-bg-gray-200 backdrop-blur-md overflow-hidden z-50",children:[(0,t.jsxs)("div",{className:"px-4 py-3 bg-gradient-to-r from-brand-blue-ghost to-transparent border-b border-bg-gray-200",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-text-primary",children:r?.full_name||"Utilisateur"}),(0,t.jsx)("p",{className:"text-xs text-text-tertiary mt-0.5",children:r?.email||""})]}),(0,t.jsxs)("div",{className:"py-2",children:[(0,t.jsxs)($.motion.button,{whileHover:{x:4},className:"w-full flex items-center px-4 py-2.5 text-sm text-text-secondary hover:bg-bg-gray-100 transition-colors duration-200",children:[(0,t.jsx)(X.User,{className:"h-4 w-4 mr-3 text-text-tertiary"}),"Mon profil"]}),(0,t.jsxs)($.motion.button,{whileHover:{x:4},className:"w-full flex items-center px-4 py-2.5 text-sm text-text-secondary hover:bg-bg-gray-100 transition-colors duration-200",children:[(0,t.jsx)(b.Settings,{className:"h-4 w-4 mr-3 text-text-tertiary"}),"Param√®tres"]}),(0,t.jsx)("div",{className:"border-t border-bg-gray-200 my-2"}),(0,t.jsxs)($.motion.button,{whileHover:{x:4},onClick:()=>i(),className:"w-full flex items-center px-4 py-2.5 text-sm text-danger-primary hover:bg-danger-bg transition-colors duration-200",children:[(0,t.jsx)(y.LogOut,{className:"h-4 w-4 mr-3"}),"D√©connexion"]})]})]})})]})]})]})})]})}function e2({children:e}){let a=(0,i.usePathname)();return(0,t.jsx)(U.AnimatePresence,{mode:"wait",children:(0,t.jsx)($.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,ease:[.16,1,.3,1]},className:"w-full",children:e},a)})}var e4=e.i(440160);let e5=(0,q.default)("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);function e3(){let{isInstallable:e,isInstalled:r,install:i}=function(){let[e,t]=(0,a.useState)(null),[r,i]=(0,a.useState)(!1),[s,n]=(0,a.useState)(!1),[o,l]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{window.matchMedia("(display-mode: standalone)").matches&&(n(!0),l(!0));let e=e=>{e.preventDefault(),t(e),i(!0)};window.addEventListener("beforeinstallprompt",e);let a=()=>{n(!0),i(!1),t(null)};return window.addEventListener("appinstalled",a),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",a)}},[]),{isInstallable:r,isInstalled:s,isStandalone:o,install:async()=>{if(!e)return!1;try{await e.prompt();let{outcome:a}=await e.userChoice;if("accepted"===a)return i(!1),t(null),!0;return!1}catch(e){return console.error("Error installing PWA:",e),!1}}}}(),[s,n]=(0,a.useState)(!1),[o,l]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(r||o)return;let t=localStorage.getItem("pwa-install-dismissed");if(t){let e=new Date(t);if((Date.now()-e.getTime())/864e5<7)return}if(e){let e=setTimeout(()=>{n(!0)},3e3);return()=>clearTimeout(e)}},[e,r,o]);let d=async()=>{await i()&&n(!1)};return!s||r?null:(0,t.jsx)(ej.Dialog,{open:s,onOpenChange:n,children:(0,t.jsxs)(ej.DialogContent,{children:[(0,t.jsxs)(ej.DialogHeader,{children:[(0,t.jsxs)(ej.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(e5,{className:"h-5 w-5"}),"Installer EDUZEN"]}),(0,t.jsx)(ej.DialogDescription,{children:"Installez EDUZEN sur votre appareil pour un acc√®s rapide et une meilleure exp√©rience."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2 text-sm text-muted-foreground",children:[(0,t.jsx)("p",{children:"‚úì Acc√®s rapide depuis l'√©cran d'accueil"}),(0,t.jsx)("p",{children:"‚úì Fonctionne hors ligne"}),(0,t.jsx)("p",{children:"‚úì Notifications push"}),(0,t.jsx)("p",{children:"‚úì Exp√©rience optimis√©e"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(J.Button,{onClick:d,className:"flex-1",children:[(0,t.jsx)(e4.Download,{className:"h-4 w-4 mr-2"}),"Installer"]}),(0,t.jsx)(J.Button,{onClick:()=>{n(!1),l(!0),localStorage.setItem("pwa-install-dismissed",new Date().toISOString())},variant:"outline",children:(0,t.jsx)(et.X,{className:"h-4 w-4"})})]})]})]})})}function e6({children:e}){return(0,a.useEffect)(()=>{let e=e=>{if(e.filename?.includes("frame.js")||e.filename?.includes("operationBanner")||e.filename?.includes("chrome-extension://")||e.filename?.includes("moz-extension://")||e.filename?.includes("safari-extension://"))return e.preventDefault(),!1},t=e=>{let t=e.reason?.message||String(e.reason);if(t.includes("sendMessage")||t.includes("frame.js")||t.includes("operationBanner"))return e.preventDefault(),!1};return window.addEventListener("error",e),window.addEventListener("unhandledrejection",t),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",t)}},[]),(0,a.useEffect)(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(e=>{console.log("Service Worker registered:",e)}).catch(e=>{console.error("Service Worker registration failed:",e)})},[]),(0,a.useEffect)(()=>{},[]),(0,t.jsxs)("div",{className:"min-h-screen bg-bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)(G,{}),(0,t.jsxs)("div",{className:"flex flex-col flex-1 overflow-hidden w-0 min-w-0",children:[(0,t.jsx)(e1,{}),(0,t.jsx)("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 smooth-scroll-premium",children:(0,t.jsx)(e2,{children:e})})]})]}),(0,t.jsx)(e3,{})]})}e.s(["default",()=>e6],901701)}]);