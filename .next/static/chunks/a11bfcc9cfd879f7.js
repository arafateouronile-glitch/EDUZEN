(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,107233,e=>{"use strict";let s=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],107233)},503116,e=>{"use strict";let s=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>s],503116)},605631,e=>{"use strict";let s=(0,e.i(475254).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>s],605631)},286536,e=>{"use strict";let s=(0,e.i(475254).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],286536)},127341,e=>{"use strict";var s=e.i(843476),t=e.i(271645),a=e.i(647163);let i=t.createContext(void 0);function r({value:e,defaultValue:r,onValueChange:n,children:l,className:d}){let o=void 0!==e,[c,u]=t.useState(r??"");t.useEffect(()=>{o||void 0===r||u(r)},[r]);let m=o?e:c,h=t.useCallback(e=>{o||u(e),n?.(e)},[o,n]);return(0,s.jsx)(i.Provider,{value:{value:m,onValueChange:h},children:(0,s.jsx)("div",{className:(0,a.cn)("w-full",d),children:l})})}function n(){let e=t.useContext(i);if(!e)throw Error("Tabs components must be used within a Tabs component");return e}function l({children:e,className:t}){return(0,s.jsx)("div",{className:(0,a.cn)("inline-flex h-10 items-center justify-center rounded-lg bg-bg-gray-100 p-1 text-text-tertiary",t),children:e})}function d({value:e,children:t,className:i}){let{value:r,onValueChange:l}=n(),d=r===e;return(0,s.jsx)("button",{type:"button",onClick:()=>l(e),className:(0,a.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-outline-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",d?"bg-white text-text-primary shadow-sm":"text-text-tertiary hover:text-text-primary",i),children:t})}function o({value:e,children:t,className:i}){let{value:r}=n();return r!==e?null:(0,s.jsx)("div",{className:(0,a.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",i),children:t})}e.s(["Tabs",()=>r,"TabsContent",()=>o,"TabsList",()=>l,"TabsTrigger",()=>d])},174886,e=>{"use strict";let s=(0,e.i(475254).default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);e.s(["Copy",()=>s],174886)},77705,e=>{"use strict";let s=(0,e.i(475254).default)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);e.s(["EyeOff",()=>s],77705)},834161,e=>{"use strict";let s=(0,e.i(475254).default)("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);e.s(["Key",()=>s],834161)},694889,e=>{"use strict";e.i(247167);var s=e.i(843476),t=e.i(271645),a=e.i(266027),i=e.i(954616),r=e.i(912598),n=e.i(325715),l=e.i(920755),d=e.i(586914);let o=new class{supabase;constructor(e){this.supabase=e||(0,l.createClient)()}generateAPIKey(){let e=`eduz_${d.default.randomBytes(32).toString("hex")}`,s=d.default.createHash("sha256").update(e).digest("hex"),t=e.substring(0,12)+"...";return{key:e,hash:s,prefix:t}}async verifyAPIKey(e){let s=d.default.createHash("sha256").update(e).digest("hex"),{data:t,error:a}=await this.supabase.from("api_keys").select("*").eq("key_hash",s).eq("is_active",!0).maybeSingle();if(a)throw a;return t}async createAPIKey(e,s,t,a){let{key:i,hash:r,prefix:n}=this.generateAPIKey();await this.ensureQuotaExists(e);let{data:l,error:d}=await this.supabase.from("api_keys").insert({organization_id:e,user_id:s,name:t,key_hash:r,key_prefix:n,description:a?.description,scopes:a?.scopes||[],allowed_ips:a?.allowedIPs||[],allowed_origins:a?.allowedOrigins||[],rate_limit_per_minute:a?.rateLimitPerMinute||60,rate_limit_per_hour:a?.rateLimitPerHour||1e3,rate_limit_per_day:a?.rateLimitPerDay||1e4,expires_at:a?.expiresAt?.toISOString()}).select().single();if(d)throw d;return{...l,key:i}}async getAPIKeys(e){let{data:s,error:t}=await this.supabase.from("api_keys").select("*").eq("organization_id",e).order("created_at",{ascending:!1});if(t)throw t;return s}async updateAPIKey(e,s){let{data:t,error:a}=await this.supabase.from("api_keys").update(s).eq("id",e).select().single();if(a)throw a;return t}async revokeAPIKey(e){return this.updateAPIKey(e,{is_active:!1})}async deleteAPIKey(e){let{error:s}=await this.supabase.from("api_keys").delete().eq("id",e);if(s)throw s}async checkRateLimit(e,s){let t=await this.checkKeyRateLimit(e.id);if(!t.allowed)return t;let a=await this.checkQuotaRateLimit(s);return a.allowed?{allowed:!0,remaining:Math.min(t.remaining,a.remaining),resetAt:a.resetAt}:a}async checkKeyRateLimit(e){let{data:s}=await this.supabase.from("api_keys").select("rate_limit_per_minute, rate_limit_per_hour, rate_limit_per_day").eq("id",e).single();if(!s)return{allowed:!1,remaining:0,resetAt:new Date};let t=new Date,a=new Date(t.getTime()-6e4),i=new Date(t.getTime()-36e5),r=new Date(t.getTime()-864e5),{count:n}=await this.supabase.from("api_requests").select("*",{count:"exact",head:!0}).eq("api_key_id",e).gte("created_at",a.toISOString()),{count:l}=await this.supabase.from("api_requests").select("*",{count:"exact",head:!0}).eq("api_key_id",e).gte("created_at",i.toISOString()),{count:d}=await this.supabase.from("api_requests").select("*",{count:"exact",head:!0}).eq("api_key_id",e).gte("created_at",r.toISOString());return n&&n>=(s.rate_limit_per_minute||60)?{allowed:!1,remaining:0,resetAt:new Date(t.getTime()+6e4)}:l&&l>=(s.rate_limit_per_hour||1e3)?{allowed:!1,remaining:0,resetAt:new Date(t.getTime()+36e5)}:d&&d>=(s.rate_limit_per_day||1e4)?{allowed:!1,remaining:0,resetAt:new Date(t.getTime()+864e5)}:{allowed:!0,remaining:Math.min((s.rate_limit_per_minute||60)-(n||0),(s.rate_limit_per_hour||1e3)-(l||0),(s.rate_limit_per_day||1e4)-(d||0)),resetAt:new Date(t.getTime()+6e4)}}async checkQuotaRateLimit(e){let{data:s}=await this.supabase.from("api_quotas").select("*").eq("organization_id",e).single();return s?s.requests_used_minute>=(s.requests_per_minute||60)||s.requests_used_hour>=(s.requests_per_hour||1e3)||s.requests_used_day>=(s.requests_per_day||1e4)?{allowed:!1,remaining:0,resetAt:new Date}:{allowed:!0,remaining:Math.min((s.requests_per_minute||60)-s.requests_used_minute,(s.requests_per_hour||1e3)-s.requests_used_hour,(s.requests_per_day||1e4)-s.requests_used_day),resetAt:new Date}:(await this.ensureQuotaExists(e),{allowed:!0,remaining:1e4,resetAt:new Date})}async logAPIRequest(e,s,t,a,i,r,n,l,d,o){let{data:c,error:u}=await this.supabase.from("api_requests").insert({api_key_id:e,organization_id:s,method:t,endpoint:a,path:i,status_code:r,response_time_ms:n,ip_address:l,user_agent:d,query_params:o}).select().single();if(u)throw u;return c}async getAPIUsageStats(e,s,t){let a=this.supabase.from("api_requests").select("method, endpoint, status_code, response_time_ms").eq("organization_id",e);s&&(a=a.gte("created_at",s.toISOString())),t&&(a=a.lte("created_at",t.toISOString()));let{data:i,error:r}=await a;if(r)throw r;let n={total_requests:i?.length||0,by_method:{},by_endpoint:{},by_status:{},average_response_time:0,error_rate:0};if(i&&i.length>0){let e=0,s=0;i.forEach(t=>{n.by_method[t.method]=(n.by_method[t.method]||0)+1;let a=t.endpoint;n.by_endpoint[a]=(n.by_endpoint[a]||0)+1;let i=t.status_code||0,r=100*Math.floor(i/100);n.by_status[r]=(n.by_status[r]||0)+1;let l=t.response_time_ms||0;l&&(e+=l),i>=400&&s++}),n.average_response_time=e/i.length,n.error_rate=s/i.length*100}return n}async ensureQuotaExists(e){let{data:s}=await this.supabase.from("api_quotas").select("id").eq("organization_id",e).maybeSingle();if(!s){let{error:s}=await this.supabase.from("api_quotas").insert({organization_id:e});if(s)throw s}}async getQuota(e){let{data:s,error:t}=await this.supabase.from("api_quotas").select("*").eq("organization_id",e).single();if(t)throw t;return s}async updateQuota(e,s){let{data:t,error:a}=await this.supabase.from("api_quotas").update(s).eq("organization_id",e).select().single();if(a)throw a;return t}async createWebhook(e){let s=d.default.randomBytes(32).toString("hex"),{data:t,error:a}=await this.supabase.from("webhooks").insert({...e,secret:s}).select().single();if(a)throw a;return{...t,secret:s}}async getWebhooks(e){let{data:s,error:t}=await this.supabase.from("webhooks").select("*").eq("organization_id",e).order("created_at",{ascending:!1});if(t)throw t;return s}async updateWebhook(e,s){let{data:t,error:a}=await this.supabase.from("webhooks").update(s).eq("id",e).select().single();if(a)throw a;return t}async deleteWebhook(e){let{error:s}=await this.supabase.from("webhooks").delete().eq("id",e);if(s)throw s}async triggerWebhook(e,s,t){let{data:a}=await this.supabase.from("webhooks").select("*").eq("id",e).eq("is_active",!0).single();if(!a)throw Error("Webhook non trouvé ou inactif");if(!a.events.includes(s))return null;let{data:i,error:r}=await this.supabase.from("webhook_deliveries").insert({webhook_id:e,event_type:s,event_data:t,status:"pending"}).select().single();if(r)throw r;return i}async sendWebhook(e){let{data:s}=await this.supabase.from("webhook_deliveries").select("*, webhook:webhooks(*)").eq("id",e).single();if(!s||!s.webhook)throw Error("Livraison non trouvée");let t=s.webhook,a=JSON.stringify({event:s.event_type,data:s.event_data,timestamp:new Date().toISOString()}),i=t.secret||"",r=d.default.createHmac("sha256",i).update(a).digest("hex");try{let i=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json","X-Webhook-Signature":r,"X-Webhook-Event":s.event_type},body:a,signal:AbortSignal.timeout(1e3*(t.timeout_seconds||30))}),n=await i.text();return await this.supabase.from("webhook_deliveries").update({status:i.ok?"success":"failed",response_status_code:i.status,response_body:n,delivered_at:new Date().toISOString()}).eq("id",e),await this.supabase.from("webhooks").update({success_count:i.ok?(t.success_count||0)+1:t.success_count||0,failure_count:i.ok?t.failure_count||0:(t.failure_count||0)+1,last_triggered_at:new Date().toISOString()}).eq("id",t.id),{success:i.ok,status:i.status}}catch(a){let t=a instanceof Error?a.message:"Erreur inconnue";throw await this.supabase.from("webhook_deliveries").update({status:"failed",error_message:t,attempt_number:s.attempt_number+1,next_retry_at:s.attempt_number<s.max_attempts?new Date(Date.now()+3e5).toISOString():null}).eq("id",e),a}}async getWebhookDeliveries(e){let{data:s,error:t}=await this.supabase.from("webhook_deliveries").select("*").eq("webhook_id",e).order("created_at",{ascending:!1}).limit(100);if(t)throw t;return s}};var c=e.i(970065),u=e.i(167881),m=e.i(23750),h=e.i(10708),x=e.i(184762),p=e.i(127341),g=e.i(630374),f=e.i(834161),_=e.i(107233),y=e.i(727612),j=e.i(174886),b=e.i(286536),v=e.i(77705),w=e.i(778917),N=e.i(898791),k=e.i(605631),C=e.i(503116),q=e.i(647163),A=e.i(6799);function P(){let{user:e}=(0,n.useAuth)(),l=(0,r.useQueryClient)(),{addToast:d}=(0,A.useToast)(),P=e=>{d({title:e.title,description:e.description,type:e.type||e.variant||"success"})},[I,D]=(0,t.useState)(""),[z,T]=(0,t.useState)(""),[S,K]=(0,t.useState)([]),[L,E]=(0,t.useState)(null),[O,Q]=(0,t.useState)(!1),{data:M}=(0,a.useQuery)({queryKey:["api-keys",e?.organization_id],queryFn:()=>o.getAPIKeys(e?.organization_id||""),enabled:!!e?.organization_id}),{data:W}=(0,a.useQuery)({queryKey:["webhooks",e?.organization_id],queryFn:()=>o.getWebhooks(e?.organization_id||""),enabled:!!e?.organization_id}),{data:B}=(0,a.useQuery)({queryKey:["api-quota",e?.organization_id],queryFn:()=>o.getQuota(e?.organization_id||""),enabled:!!e?.organization_id}),R=(0,i.useMutation)({mutationFn:()=>o.createAPIKey(e?.organization_id||"",e?.id||"",I,{description:z,scopes:S}),onSuccess:e=>{E(e.key),l.invalidateQueries({queryKey:["api-keys"]}),D(""),T(""),K([]),P({title:"Clé API créée",description:"Votre clé API a été créée avec succès. Copiez-la maintenant, elle ne sera plus affichée."})}}),H=(0,i.useMutation)({mutationFn:e=>o.revokeAPIKey(e),onSuccess:()=>{l.invalidateQueries({queryKey:["api-keys"]}),P({title:"Clé API révoquée",description:"La clé API a été révoquée avec succès."})}}),F=e=>{navigator.clipboard.writeText(e),P({title:"Copié",description:"La clé API a été copiée dans le presse-papiers."})},U=[{value:"read:students",label:"Lire les étudiants"},{value:"write:students",label:"Créer/modifier les étudiants"},{value:"read:documents",label:"Lire les documents"},{value:"write:documents",label:"Créer/modifier les documents"},{value:"read:payments",label:"Lire les paiements"},{value:"write:payments",label:"Créer/modifier les paiements"},{value:"*",label:"Tous les accès"}];return(0,s.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,s.jsx)(f.Key,{className:"h-8 w-8"}),"Gestion de l'API"]}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Gérez vos clés API et webhooks pour intégrer EDUZEN avec vos applications"})]}),(0,s.jsxs)(p.Tabs,{defaultValue:"keys",className:"space-y-6",children:[(0,s.jsxs)(p.TabsList,{children:[(0,s.jsx)(p.TabsTrigger,{value:"keys",children:"Clés API"}),(0,s.jsx)(p.TabsTrigger,{value:"webhooks",children:"Webhooks"}),(0,s.jsx)(p.TabsTrigger,{value:"quota",children:"Quotas"}),(0,s.jsx)(p.TabsTrigger,{value:"docs",children:"Documentation"})]}),(0,s.jsx)(p.TabsContent,{value:"keys",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold",children:"Clés API"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Créez et gérez vos clés API pour accéder à l'API publique"})]}),(0,s.jsxs)(g.Dialog,{children:[(0,s.jsx)(g.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(u.Button,{children:[(0,s.jsx)(_.Plus,{className:"h-4 w-4 mr-2"}),"Nouvelle clé API"]})}),(0,s.jsxs)(g.DialogContent,{children:[(0,s.jsxs)(g.DialogHeader,{children:[(0,s.jsx)(g.DialogTitle,{children:"Créer une nouvelle clé API"}),(0,s.jsx)(g.DialogDescription,{children:"Créez une clé API pour accéder à l'API publique. Vous pourrez copier la clé une seule fois."})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Label,{htmlFor:"key-name",children:"Nom"}),(0,s.jsx)(m.Input,{id:"key-name",value:I,onChange:e=>D(e.target.value),placeholder:"Ex: Production API, Development"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Label,{htmlFor:"key-description",children:"Description"}),(0,s.jsx)(x.Textarea,{id:"key-description",value:z,onChange:e=>T(e.target.value),placeholder:"Description de l'utilisation de cette clé"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(h.Label,{children:"Permissions (Scopes)"}),(0,s.jsx)("div",{className:"space-y-2 mt-2",children:U.map(e=>(0,s.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:S.includes(e.value),onChange:s=>{s.target.checked?K([...S,e.value]):K(S.filter(s=>s!==e.value))}}),(0,s.jsx)("span",{className:"text-sm",children:e.label})]},e.value))})]}),(0,s.jsx)(u.Button,{onClick:()=>R.mutate(),disabled:!I||R.isPending,className:"w-full",children:"Créer la clé API"})]})]})]}),L&&(0,s.jsx)(g.Dialog,{open:!!L,onOpenChange:()=>E(null),children:(0,s.jsxs)(g.DialogContent,{children:[(0,s.jsxs)(g.DialogHeader,{children:[(0,s.jsx)(g.DialogTitle,{children:"Clé API créée"}),(0,s.jsx)(g.DialogDescription,{children:"Copiez cette clé maintenant. Elle ne sera plus affichée après la fermeture de cette fenêtre."})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(m.Input,{value:L,readOnly:!0,type:O?"text":"password",className:"font-mono"}),(0,s.jsx)(u.Button,{variant:"outline",size:"icon",onClick:()=>Q(!O),children:O?(0,s.jsx)(v.EyeOff,{className:"h-4 w-4"}):(0,s.jsx)(b.Eye,{className:"h-4 w-4"})}),(0,s.jsx)(u.Button,{variant:"outline",size:"icon",onClick:()=>F(L),children:(0,s.jsx)(j.Copy,{className:"h-4 w-4"})})]}),(0,s.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-start gap-2",children:[(0,s.jsx)(N.AlertCircle,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),(0,s.jsxs)("p",{className:"text-sm text-yellow-800",children:[(0,s.jsx)("strong",{children:"Important :"})," Cette clé ne sera affichée qu'une seule fois. Assurez-vous de la copier et de la stocker en sécurité."]})]})]})]})})]}),M&&M.length>0?(0,s.jsx)("div",{className:"space-y-4",children:M.map(e=>(0,s.jsxs)(c.Card,{children:[(0,s.jsx)(c.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.CardTitle,{className:"text-lg",children:e.name}),e.description&&(0,s.jsx)(c.CardDescription,{className:"mt-1",children:e.description})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:e.is_active?(0,s.jsxs)("span",{className:"flex items-center gap-1 text-sm text-green-600",children:[(0,s.jsx)(k.CheckCircle,{className:"h-4 w-4"}),"Active"]}):(0,s.jsxs)("span",{className:"flex items-center gap-1 text-sm text-gray-500",children:[(0,s.jsx)(C.Clock,{className:"h-4 w-4"}),"Révoquée"]})})]})}),(0,s.jsx)(c.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-sm font-mono text-muted-foreground",children:e.key_prefix}),(0,s.jsx)(u.Button,{variant:"ghost",size:"sm",onClick:()=>F(e.key_prefix),children:(0,s.jsx)(j.Copy,{className:"h-3 w-3"})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Créée le"}),(0,s.jsx)("p",{className:"font-medium",children:(0,q.formatDate)(e.created_at)})]}),e.last_used_at&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Dernière utilisation"}),(0,s.jsx)("p",{className:"font-medium",children:(0,q.formatDate)(e.last_used_at)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Requêtes"}),(0,s.jsx)("p",{className:"font-medium",children:e.request_count||0})]}),e.expires_at&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Expire le"}),(0,s.jsx)("p",{className:"font-medium",children:(0,q.formatDate)(e.expires_at)})]})]}),e.scopes&&e.scopes.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Permissions :"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:e.scopes.map(e=>(0,s.jsx)("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-800 rounded",children:U.find(s=>s.value===e)?.label||e},e))})]}),(0,s.jsx)("div",{className:"flex items-center gap-2 pt-2 border-t",children:e.is_active&&(0,s.jsxs)(u.Button,{variant:"destructive",size:"sm",onClick:()=>H.mutate(e.id),children:[(0,s.jsx)(y.Trash2,{className:"h-4 w-4 mr-2"}),"Révoquer"]})})]})})]},e.id))}):(0,s.jsx)(c.Card,{children:(0,s.jsx)(c.CardContent,{className:"pt-6 text-center text-muted-foreground",children:"Aucune clé API. Créez-en une pour commencer à utiliser l'API."})})]})}),(0,s.jsx)(p.TabsContent,{value:"webhooks",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold",children:"Webhooks"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Configurez des webhooks pour recevoir des notifications d'événements"})]}),(0,s.jsxs)(u.Button,{children:[(0,s.jsx)(_.Plus,{className:"h-4 w-4 mr-2"}),"Nouveau webhook"]})]}),W&&W.length>0?(0,s.jsx)("div",{className:"space-y-4",children:W.map(e=>(0,s.jsxs)(c.Card,{children:[(0,s.jsx)(c.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(c.CardTitle,{className:"text-lg",children:e.name}),(0,s.jsx)(c.CardDescription,{className:"mt-1 font-mono text-xs",children:e.url})]}),e.is_active?(0,s.jsxs)("span",{className:"flex items-center gap-1 text-sm text-green-600",children:[(0,s.jsx)(k.CheckCircle,{className:"h-4 w-4"}),"Actif"]}):(0,s.jsxs)("span",{className:"flex items-center gap-1 text-sm text-gray-500",children:[(0,s.jsx)(C.Clock,{className:"h-4 w-4"}),"Inactif"]})]})}),(0,s.jsx)(c.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[e.events&&e.events.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Événements :"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:e.events.map(e=>(0,s.jsx)("span",{className:"text-xs px-2 py-1 bg-purple-100 text-purple-800 rounded",children:e},e))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Succès"}),(0,s.jsx)("p",{className:"font-medium",children:e.success_count||0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Échecs"}),(0,s.jsx)("p",{className:"font-medium",children:e.failure_count||0})]}),e.last_triggered_at&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Dernier déclenchement"}),(0,s.jsx)("p",{className:"font-medium",children:(0,q.formatDate)(e.last_triggered_at)})]})]})]})})]},e.id))}):(0,s.jsx)(c.Card,{children:(0,s.jsx)(c.CardContent,{className:"pt-6 text-center text-muted-foreground",children:"Aucun webhook configuré. Créez-en un pour recevoir des notifications."})})]})}),(0,s.jsx)(p.TabsContent,{value:"quota",children:(0,s.jsxs)(c.Card,{children:[(0,s.jsxs)(c.CardHeader,{children:[(0,s.jsx)(c.CardTitle,{children:"Quotas API"}),(0,s.jsx)(c.CardDescription,{children:"Limites d'utilisation de l'API pour votre organisation"})]}),(0,s.jsx)(c.CardContent,{children:B?(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Par minute"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[B.requests_used_minute||0," / ",B.requests_per_minute||60]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all",style:{width:`${(B.requests_used_minute||0)/(B.requests_per_minute||60)*100}%`}})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Par heure"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[B.requests_used_hour||0," / ",B.requests_per_hour||1e3]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all",style:{width:`${(B.requests_used_hour||0)/(B.requests_per_hour||1e3)*100}%`}})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Par jour"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[B.requests_used_day||0," / ",B.requests_per_day||1e4]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all",style:{width:`${(B.requests_used_day||0)/(B.requests_per_day||1e4)*100}%`}})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Par mois"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[B.requests_used_month||0," / ",B.requests_per_month||1e5]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all",style:{width:`${(B.requests_used_month||0)/(B.requests_per_month||1e5)*100}%`}})})]})]})}):(0,s.jsx)("div",{className:"text-center text-muted-foreground",children:"Chargement des quotas..."})})]})}),(0,s.jsx)(p.TabsContent,{value:"docs",children:(0,s.jsxs)(c.Card,{children:[(0,s.jsxs)(c.CardHeader,{children:[(0,s.jsx)(c.CardTitle,{children:"Documentation API"}),(0,s.jsx)(c.CardDescription,{children:"Accédez à la documentation complète de l'API publique"})]}),(0,s.jsx)(c.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:"La documentation OpenAPI/Swagger de l'API est disponible à l'adresse suivante :"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("code",{className:"px-3 py-2 bg-gray-100 rounded text-sm",children:["http://localhost:3000","/api/v1/docs"]}),(0,s.jsxs)(u.Button,{variant:"outline",size:"sm",onClick:()=>window.open("http://localhost:3000/api/v1/docs","_blank"),children:[(0,s.jsx)(w.ExternalLink,{className:"h-4 w-4 mr-2"}),"Ouvrir"]})]}),(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Utilisation de l'API"}),(0,s.jsxs)("ol",{className:"list-decimal list-inside space-y-2 text-sm text-muted-foreground",children:[(0,s.jsx)("li",{children:'Créez une clé API dans l\'onglet "Clés API"'}),(0,s.jsxs)("li",{children:["Utilisez cette clé dans l'en-tête ",(0,s.jsx)("code",{children:"X-API-Key"})," de vos requêtes"]}),(0,s.jsx)("li",{children:"Consultez la documentation pour voir tous les endpoints disponibles"}),(0,s.jsx)("li",{children:"Respectez les limites de rate limiting configurées"})]})]})]})})]})})]})]})}e.s(["default",()=>P],694889)}]);