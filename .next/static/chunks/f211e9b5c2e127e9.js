(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,503116,e=>{"use strict";let s=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>s],503116)},645760,e=>{"use strict";var s=e.i(843476),r=e.i(271645),t=e.i(647163);e.i(882205);var a=e.i(846932);let i=r.forwardRef(({className:e,variant:r="default",hoverable:i=!1,glow:l=!1,glowColor:n="rgba(51, 90, 207, 0.3)",...o},d)=>(0,s.jsxs)(a.motion.div,{ref:d,className:(0,t.cn)("relative rounded-2xl border backdrop-blur-xl transition-all duration-300",{"bg-white/70 dark:bg-gray-900/70 border-white/20 dark:border-gray-700/30 shadow-lg":"default"===r,"bg-white/80 dark:bg-gray-900/80 border-white/30 dark:border-gray-700/40 shadow-xl":"premium"===r,"bg-white/50 dark:bg-gray-900/50 border-white/10 dark:border-gray-700/20 shadow-md":"subtle"===r,"cursor-pointer":i,"hover:shadow-2xl hover:scale-[1.02]":i,"hover:bg-white/90 dark:hover:bg-gray-900/90":i},e),whileHover:i?{scale:1.02,y:-2}:void 0,transition:{type:"spring",stiffness:300,damping:30},...o,children:[l&&(0,s.jsx)(a.motion.div,{className:"absolute inset-0 rounded-2xl opacity-0 blur-xl",style:{background:`radial-gradient(circle, ${n} 0%, transparent 70%)`},animate:{opacity:[0,.5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"}}),(0,s.jsx)("div",{className:"relative z-10",children:o.children})]}));i.displayName="GlassCard",e.s(["GlassCard",()=>i])},225913,e=>{"use strict";var s=e.i(207670);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,t=s.clsx;e.s(["cva",0,(e,s)=>a=>{var i;if((null==s?void 0:s.variants)==null)return t(e,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:l,defaultVariants:n}=s,o=Object.keys(l).map(e=>{let s=null==a?void 0:a[e],t=null==n?void 0:n[e];if(null===s)return null;let i=r(s)||r(t);return l[e][i]}),d=a&&Object.entries(a).reduce((e,s)=>{let[r,t]=s;return void 0===t||(e[r]=t),e},{});return t(e,o,null==s||null==(i=s.compoundVariants)?void 0:i.reduce((e,s)=>{let{class:r,className:t,...a}=s;return Object.entries(a).every(e=>{let[s,r]=e;return Array.isArray(r)?r.includes({...n,...d}[s]):({...n,...d})[s]===r})?[...e,r,t]:e},[]),null==a?void 0:a.class,null==a?void 0:a.className)}])},994179,e=>{"use strict";var s=e.i(843476),r=e.i(225913),t=e.i(647163);let a=(0,r.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground border-border hover:bg-accent hover:text-accent-foreground",success:"border-transparent bg-success-primary text-white shadow hover:bg-brand-blue-dark",warning:"border-transparent bg-warning-primary text-white shadow hover:bg-brand-cyan-dark",premium:"border-transparent bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 text-white shadow-lg shadow-purple-500/50 hover:shadow-xl hover:shadow-purple-500/60",glass:"border-white/20 bg-white/10 backdrop-blur-md text-foreground shadow-lg"},size:{default:"px-2.5 py-0.5 text-xs",sm:"px-2 py-0.5 text-xs",lg:"px-3 py-1 text-sm"}},defaultVariants:{variant:"default",size:"default"}});function i({className:e,variant:r,size:i,dot:l,pulse:n,children:o,...d}){return(0,s.jsxs)("div",{className:(0,t.cn)(a({variant:r,size:i}),e),...d,children:[l&&(0,s.jsx)("span",{className:(0,t.cn)("mr-1.5 h-1.5 w-1.5 rounded-full","success"===r&&"bg-white/80","warning"===r&&"bg-white/80","default"===r&&"bg-white/80",n&&"animate-pulse")}),o]})}e.s(["Badge",()=>i])},810980,e=>{"use strict";let s=(0,e.i(475254).default)("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);e.s(["BookOpen",()=>s],810980)},25652,e=>{"use strict";let s=(0,e.i(475254).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);e.s(["TrendingUp",()=>s],25652)},127341,e=>{"use strict";var s=e.i(843476),r=e.i(271645),t=e.i(647163);let a=r.createContext(void 0);function i({value:e,defaultValue:i,onValueChange:l,children:n,className:o}){let d=void 0!==e,[c,u]=r.useState(i??"");r.useEffect(()=>{d||void 0===i||u(i)},[i]);let m=d?e:c,g=r.useCallback(e=>{d||u(e),l?.(e)},[d,l]);return(0,s.jsx)(a.Provider,{value:{value:m,onValueChange:g},children:(0,s.jsx)("div",{className:(0,t.cn)("w-full",o),children:n})})}function l(){let e=r.useContext(a);if(!e)throw Error("Tabs components must be used within a Tabs component");return e}function n({children:e,className:r}){return(0,s.jsx)("div",{className:(0,t.cn)("inline-flex h-10 items-center justify-center rounded-lg bg-bg-gray-100 p-1 text-text-tertiary",r),children:e})}function o({value:e,children:r,className:a}){let{value:i,onValueChange:n}=l(),o=i===e;return(0,s.jsx)("button",{type:"button",onClick:()=>n(e),className:(0,t.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-outline-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",o?"bg-white text-text-primary shadow-sm":"text-text-tertiary hover:text-text-primary",a),children:r})}function d({value:e,children:r,className:a}){let{value:i}=l();return i!==e?null:(0,s.jsx)("div",{className:(0,t.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),children:r})}e.s(["Tabs",()=>i,"TabsContent",()=>d,"TabsList",()=>n,"TabsTrigger",()=>o])},431343,e=>{"use strict";let s=(0,e.i(475254).default)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);e.s(["Play",()=>s],431343)},852008,e=>{"use strict";let s=(0,e.i(475254).default)("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);e.s(["Layers",()=>s],852008)},195665,e=>{"use strict";var s=e.i(843476),r=e.i(266027),t=e.i(383801),a=e.i(267824),i=e.i(645760),l=e.i(167881),n=e.i(994179),o=e.i(23750),d=e.i(127341);e.i(882205);var c=e.i(846932),u=e.i(338456),m=e.i(810980),g=e.i(503116),x=e.i(465286),h=e.i(555436),b=e.i(431343),p=e.i(25652),v=e.i(852008),f=e.i(522016),y=e.i(271645),j=e.i(790224);function N(){let{student:e,studentId:N}=(0,t.useLearnerContext)(),w=(0,y.useMemo)(()=>N?(0,a.createLearnerClient)(N):null,[N]),[_,k]=(0,y.useState)(""),{data:C,isLoading:T}=(0,r.useQuery)({queryKey:["learner-session-courses",N],queryFn:async()=>{if(!N||!w)return[];try{let{data:e,error:s}=await w.from("session_courses").select(`
            *,
            course:courses(
              id, title, slug, short_description, description,
              difficulty_level, estimated_duration_hours, thumbnail_url, is_published
            )
          `).order("assigned_at",{ascending:!1});if(s){if("PGRST116"===s.code||"42P01"===s.code||s.message?.includes("does not exist"))return[];throw s}return e||[]}catch(e){return j.logger.warn("Error fetching session courses",{studentId:(0,j.maskId)(N),error:(0,j.sanitizeError)(e)}),[]}},enabled:!!N}),{data:z}=(0,r.useQuery)({queryKey:["learner-lesson-progress",N,C?.map(e=>e.course_id)],queryFn:async()=>{if(!N||!C?.length||!w)return{};let e=C.map(e=>e.course_id);try{let{data:s,error:r}=await w.from("lesson_progress").select("*, lessons(course_id)").eq("student_id",N);if(r)return j.logger.warn("Error fetching lesson progress",{studentId:(0,j.maskId)(N),error:(0,j.sanitizeError)(r)}),{};let{data:t}=await w.from("lessons").select("id, course_id").in("course_id",e),a={};for(let r of e){let e=t?.filter(e=>e.course_id===r)||[],i=(s||[]).filter(e=>e.lessons?.course_id===r&&e.is_completed).length,l=e.length,n=l>0?Math.round(i/l*100):0;a[r]={completed:i,total:l,percentage:n}}return a}catch(e){return j.logger.warn("Error calculating progress",{studentId:(0,j.maskId)(N),error:(0,j.sanitizeError)(e)}),{}}},enabled:!!N&&!!C?.length}),q=(C||[]).map(e=>({id:e.id,course_id:e.course_id,courses:e.course,session:null,progress_percentage:z?.[e.course_id]?.percentage||0,completed_lessons:z?.[e.course_id]?.completed||0,total_lessons:z?.[e.course_id]?.total||0,status:(z?.[e.course_id]?.percentage??0)===100?"completed":(z?.[e.course_id]?.percentage??0)>0?"in_progress":"not_started",is_required:e.is_required,due_date:e.due_date})),{data:P}=(0,r.useQuery)({queryKey:["learner-available-courses",e?.id,e?.organization_id],queryFn:async()=>{if(!e?.id)return[];let s=q?.map(e=>e.course_id)||[];try{if(!w||!e.organization_id)return[];let r=w.from("courses").select("*").eq("is_published",!0).eq("organization_id",e.organization_id);s.length>0&&(r=r.not("id","in",`(${s.join(",")})`));let{data:t,error:a}=await r.order("created_at",{ascending:!1});if(a){if("PGRST116"===a.code||"42P01"===a.code||"PGRST301"===a.code||400===a.status||"400"===a.code||a.message?.includes("relation")||a.message?.includes("relationship")||a.message?.includes("does not exist")||a.message?.includes("schema cache"))return j.logger.warn("Courses table does not exist yet or invalid query",{studentId:(0,j.maskId)(e.id),error:(0,j.sanitizeError)(a)}),[];throw a}return t||[]}catch(s){if(s?.code==="PGRST116"||s?.code==="42P01"||s?.code==="PGRST301"||s?.status===400||s?.code==="400"||s?.message?.includes("relation")||s?.message?.includes("relationship")||s?.message?.includes("does not exist")||s?.message?.includes("schema cache"))return j.logger.warn("Courses table does not exist yet or invalid query",{studentId:(0,j.maskId)(e.id),error:(0,j.sanitizeError)(s)}),[];throw s}},enabled:!!e?.id&&!!e?.organization_id}),B=q?.filter(e=>"in_progress"===e.status)||[],L=q?.filter(e=>"completed"===e.status)||[],G=_.trim().toLowerCase(),E=q?.filter(e=>!G||(e.courses?.title||"").toLowerCase().includes(G))||[],I=({enrollment:e,isAvailable:r=!1})=>{var t;let a=r?e:e.courses,o=e.progress_percentage||0;return a?.slug?(0,s.jsx)(f.default,{href:`/learner/elearning/${a?.slug}`,className:"block",children:(0,s.jsxs)(i.GlassCard,{className:"overflow-hidden hover:shadow-lg transition-all duration-300 group",children:[(0,s.jsxs)("div",{className:"relative h-40 bg-gradient-to-br from-brand-blue/20 to-indigo-100",children:[a?.thumbnail_url?(0,s.jsx)("img",{src:a.thumbnail_url,alt:a.title,className:"w-full h-full object-cover"}):(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)(m.BookOpen,{className:"h-16 w-16 text-brand-blue/30"})}),(0,s.jsx)("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-white/90 flex items-center justify-center",children:(0,s.jsx)(b.Play,{className:"h-8 w-8 text-brand-blue ml-1"})})}),!r&&(0,s.jsxs)("div",{className:"absolute top-3 right-3 flex flex-col gap-1 items-end",children:["completed"===e.status?(0,s.jsxs)(n.Badge,{className:"bg-green-500 text-white",children:[(0,s.jsx)(x.CheckCircle2,{className:"h-3 w-3 mr-1"}),"Terminé"]}):o>0?(0,s.jsx)(n.Badge,{className:"bg-brand-blue text-white",children:"En cours"}):null,e.is_required&&(0,s.jsx)(n.Badge,{variant:"secondary",className:"text-xs",children:"Obligatoire"})]}),!r&&e.session?.name&&(0,s.jsx)("div",{className:"absolute bottom-3 left-3",children:(0,s.jsx)(n.Badge,{variant:"outline",className:"bg-white/90 text-xs",children:e.session.name})})]}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("div",{className:"flex items-start justify-between gap-2 mb-2",children:(0,s.jsx)("h3",{className:"font-semibold text-gray-900 line-clamp-2 group-hover:text-brand-blue transition-colors",children:a?.title})}),(a?.description||a?.short_description)&&(0,s.jsx)("p",{className:"text-sm text-gray-500 line-clamp-2 mb-3",children:a.short_description||a.description}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-sm text-gray-500 mb-3",children:[e.total_lessons>0&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(v.Layers,{className:"h-4 w-4"}),e.total_lessons," leçons"]}),a?.estimated_duration_hours&&(0,s.jsxs)("span",{className:"flex items-center gap-1",children:[(0,s.jsx)(g.Clock,{className:"h-4 w-4"}),a.estimated_duration_hours,"h"]}),a?.difficulty_level&&(t=a.difficulty_level,(0,s.jsx)(n.Badge,{className:`${{beginner:"bg-green-100 text-green-700",intermediate:"bg-amber-100 text-amber-700",advanced:"bg-red-100 text-red-700"}[t]||"bg-gray-100 text-gray-700"}`,children:{beginner:"Débutant",intermediate:"Intermédiaire",advanced:"Avancé"}[t]||t}))]}),!r&&e.due_date&&(0,s.jsxs)("div",{className:"text-xs text-amber-600 mb-2 flex items-center gap-1",children:[(0,s.jsx)(g.Clock,{className:"h-3 w-3"}),"Échéance: ",new Date(e.due_date).toLocaleDateString("fr-FR")]}),!r&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsxs)("span",{className:"text-gray-500",children:[e.completed_lessons,"/",e.total_lessons," leçons"]}),(0,s.jsxs)("span",{className:"font-semibold text-brand-blue",children:[o,"%"]})]}),(0,s.jsx)("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-gradient-to-r from-brand-blue to-indigo-500 rounded-full transition-all duration-500",style:{width:`${o}%`}})})]}),r&&(0,s.jsx)(l.Button,{className:"w-full mt-2",variant:"outline",children:"Commencer le cours"})]})]})}):(0,s.jsx)(i.GlassCard,{className:"overflow-hidden border border-amber-200 bg-amber-50/40",children:(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 line-clamp-2",children:"Cours assigné (détails indisponibles)"}),(0,s.jsx)(n.Badge,{className:"bg-amber-500 text-white",children:"Configuration"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Ce cours a été assigné à votre session, mais ses informations ne sont pas encore accessibles. Réessayez dans quelques secondes (ou contactez l’administrateur pour appliquer les règles d’accès apprenant)."})]})})},O={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};return(0,s.jsxs)(c.motion.div,{className:"space-y-6 pb-24 lg:pb-8",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"visible",children:[(0,s.jsx)(c.motion.div,{variants:O,children:(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)("div",{className:"p-2 bg-purple-100 rounded-xl",children:(0,s.jsx)(u.PlayCircle,{className:"h-8 w-8 text-purple-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"E-Learning"}),(0,s.jsx)("p",{className:"text-gray-500",children:"Apprenez à votre rythme avec nos cours en ligne"})]})]})}),(0,s.jsxs)(c.motion.div,{variants:O,className:"grid grid-cols-3 gap-4",children:[(0,s.jsxs)(i.GlassCard,{className:"p-4 text-center",children:[(0,s.jsx)(u.PlayCircle,{className:"h-6 w-6 text-purple-600 mx-auto mb-2"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:B.length}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"En cours"})]}),(0,s.jsxs)(i.GlassCard,{className:"p-4 text-center",children:[(0,s.jsx)(x.CheckCircle2,{className:"h-6 w-6 text-green-600 mx-auto mb-2"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:L.length}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Terminés"})]}),(0,s.jsxs)(i.GlassCard,{className:"p-4 text-center",children:[(0,s.jsx)(p.TrendingUp,{className:"h-6 w-6 text-brand-blue mx-auto mb-2"}),(0,s.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[q?.reduce((e,s)=>e+(s.progress_percentage||0),0)/(q?.length||1)||0,"%"]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Progression moyenne"})]})]}),(0,s.jsx)(c.motion.div,{variants:O,children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(h.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,s.jsx)(o.Input,{type:"search",placeholder:"Rechercher un cours...",value:_,onChange:e=>k(e.target.value),className:"pl-10"})]})}),(0,s.jsx)(c.motion.div,{variants:O,children:(0,s.jsxs)(d.Tabs,{defaultValue:"my-courses",className:"space-y-6",children:[(0,s.jsxs)(d.TabsList,{className:"bg-white/50 backdrop-blur-sm border border-gray-200/50 p-1 rounded-xl",children:[(0,s.jsxs)(d.TabsTrigger,{value:"my-courses",className:"rounded-lg data-[state=active]:bg-brand-blue data-[state=active]:text-white",children:[(0,s.jsx)(m.BookOpen,{className:"h-4 w-4 mr-2"}),"Mes cours (",q?.length||0,")"]}),(0,s.jsxs)(d.TabsTrigger,{value:"available",className:"rounded-lg data-[state=active]:bg-brand-blue data-[state=active]:text-white",children:[(0,s.jsx)(u.PlayCircle,{className:"h-4 w-4 mr-2"}),"Disponibles (",P?.length||0,")"]})]}),(0,s.jsx)(d.TabsContent,{value:"my-courses",children:T?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(e=>(0,s.jsx)("div",{className:"h-80 bg-gray-100 rounded-2xl animate-pulse"},e))}):E.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map(e=>(0,s.jsx)(I,{enrollment:e},e.id))}):(0,s.jsxs)(i.GlassCard,{className:"p-12 text-center",children:[(0,s.jsx)(m.BookOpen,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Aucun cours"}),(0,s.jsx)("p",{className:"text-gray-500 mb-4",children:"Vous n'êtes inscrit à aucun cours pour le moment"}),(0,s.jsx)(l.Button,{variant:"outline",children:"Découvrir les cours disponibles"})]})}),(0,s.jsx)(d.TabsContent,{value:"available",children:P&&P.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:P.map(e=>(0,s.jsx)(I,{enrollment:e,isAvailable:!0},e.id))}):(0,s.jsxs)(i.GlassCard,{className:"p-12 text-center",children:[(0,s.jsx)(u.PlayCircle,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Tous les cours sont déjà attribués"}),(0,s.jsx)("p",{className:"text-gray-500",children:"Vous avez accès à tous les cours disponibles"})]})})]})})]})}e.s(["default",()=>N])}]);