(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,107233,e=>{"use strict";let s=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],107233)},286536,e=>{"use strict";let s=(0,e.i(475254).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],286536)},127341,e=>{"use strict";var s=e.i(843476),t=e.i(271645),r=e.i(647163);let a=t.createContext(void 0);function i({value:e,defaultValue:i,onValueChange:l,children:c,className:o}){let n=void 0!==e,[d,u]=t.useState(i??"");t.useEffect(()=>{n||void 0===i||u(i)},[i]);let h=n?e:d,m=t.useCallback(e=>{n||u(e),l?.(e)},[n,l]);return(0,s.jsx)(a.Provider,{value:{value:h,onValueChange:m},children:(0,s.jsx)("div",{className:(0,r.cn)("w-full",o),children:c})})}function l(){let e=t.useContext(a);if(!e)throw Error("Tabs components must be used within a Tabs component");return e}function c({children:e,className:t}){return(0,s.jsx)("div",{className:(0,r.cn)("inline-flex h-10 items-center justify-center rounded-lg bg-bg-gray-100 p-1 text-text-tertiary",t),children:e})}function o({value:e,children:t,className:a}){let{value:i,onValueChange:c}=l(),o=i===e;return(0,s.jsx)("button",{type:"button",onClick:()=>c(e),className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-outline-none focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",o?"bg-white text-text-primary shadow-sm":"text-text-tertiary hover:text-text-primary",a),children:t})}function n({value:e,children:t,className:a}){let{value:i}=l();return i!==e?null:(0,s.jsx)("div",{className:(0,r.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),children:t})}e.s(["Tabs",()=>i,"TabsContent",()=>n,"TabsList",()=>c,"TabsTrigger",()=>o])},870273,e=>{"use strict";let s=(0,e.i(475254).default)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);e.s(["Star",()=>s],870273)},221345,e=>{"use strict";let s=(0,e.i(475254).default)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);e.s(["Link",()=>s],221345)},790597,e=>{"use strict";let s=(0,e.i(475254).default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);e.s(["Heart",()=>s],790597)},653339,e=>{"use strict";let s=(0,e.i(475254).default)("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);e.s(["Music",()=>s],653339)},941095,e=>{"use strict";var s=e.i(920755);let t=new class{supabase;constructor(e){this.supabase=e||(0,s.createClient)()}async getCategories(e){let{data:s,error:t}=await this.supabase.from("resource_categories").select("*").eq("organization_id",e).eq("is_active",!0).order("order_index",{ascending:!0});if(t)throw t;return s}async createCategory(e){let{data:s,error:t}=await this.supabase.from("resource_categories").insert(e).select().single();if(t)throw t;return s}async updateCategory(e,s){let{data:t,error:r}=await this.supabase.from("resource_categories").update(s).eq("id",e).select().single();if(r)throw r;return t}async deleteCategory(e){let{error:s}=await this.supabase.from("resource_categories").delete().eq("id",e);if(s)throw s}async getResources(e,s){try{let t=this.supabase.from("educational_resources").select(`
          *,
          category:resource_categories(*),
          author:users!author_id(id, full_name, email)
        `).eq("organization_id",e).eq("status","published");s?.categoryId&&(t=t.eq("category_id",s.categoryId)),s?.resourceType&&(t=t.eq("resource_type",s.resourceType)),s?.search&&(t=t.or(`title.ilike.%${s.search}%,description.ilike.%${s.search}%`)),s?.featured&&(t=t.eq("is_featured",!0)),s?.tags&&s.tags.length>0&&(t=t.contains("tags",s.tags));let{data:r,error:a}=await t.order("created_at",{ascending:!1});if(a){if("PGRST116"===a.code||"PGRST200"===a.code||"42P01"===a.code||"PGRST301"===a.code||400===a.status||"400"===a.code||a.message?.includes("relation")||a.message?.includes("relationship")||a.message?.includes("does not exist")||a.message?.includes("schema cache"))return[];throw a}return r||[]}catch(e){if(e?.code==="PGRST116"||e?.code==="PGRST200"||e?.code==="42P01"||e?.code==="PGRST301"||e?.status===400||e?.code==="400"||e?.message?.includes("relation")||e?.message?.includes("relationship")||e?.message?.includes("does not exist")||e?.message?.includes("schema cache"))return console.warn("Table educational_resources does not exist yet or invalid query:",e?.message||String(e)),[];throw e}}async getResourceBySlug(e,s){try{let{data:t,error:r}=await this.supabase.from("educational_resources").select(`
          *,
          category:resource_categories(*),
          author:users!author_id(id, full_name, email),
          versions:resource_versions(*)
      `).eq("slug",e).eq("organization_id",s).eq("status","published").single();if(r)throw r;return await this.recordView(t.id),t}catch(e){throw(e?.code==="PGRST116"||e?.code==="42P01")&&console.warn("Table educational_resources does not exist yet:",e?.message||String(e)),e}}async createResource(e){let{data:s,error:t}=await this.supabase.from("educational_resources").insert(e).select().single();if(t)throw t;return s}async updateResource(e,s){let{data:t,error:r}=await this.supabase.from("educational_resources").update(s).eq("id",e).select().single();if(r)throw r;return t}async deleteResource(e){let{error:s}=await this.supabase.from("educational_resources").delete().eq("id",e);if(s)throw s}async addToFavorites(e,s){let{data:t,error:r}=await this.supabase.from("resource_favorites").insert({user_id:e,resource_id:s}).select().single();if(r)throw r;try{await this.supabase.rpc("increment",{table_name:"educational_resources",column_name:"favorite_count",row_id:s})}catch(e){console.warn("RPC increment not available, skipping favorite_count increment")}return t}async removeFromFavorites(e,s){let{error:t}=await this.supabase.from("resource_favorites").delete().eq("user_id",e).eq("resource_id",s);if(t)throw t;let{data:r}=await this.supabase.from("educational_resources").select("favorite_count").eq("id",s).single();r&&(r.favorite_count??0)>0&&await this.supabase.from("educational_resources").update({favorite_count:(r.favorite_count??0)-1}).eq("id",s)}async isFavorite(e,s){let{data:t,error:r}=await this.supabase.from("resource_favorites").select("id").eq("user_id",e).eq("resource_id",s).maybeSingle();if(r)throw r;return!!t}async getUserFavorites(e){let{data:s,error:t}=await this.supabase.from("resource_favorites").select("*, resource:educational_resources(*, category:resource_categories(*))").eq("user_id",e).order("created_at",{ascending:!1});if(t)throw t;return s}async recordDownload(e,s,t,r){let{data:a,error:i}=await this.supabase.from("resource_downloads").insert({resource_id:e,user_id:s,ip_address:t,user_agent:r}).select().single();if(i)throw i;return a}async getResourceDownloads(e){let{data:s,error:t}=await this.supabase.from("resource_downloads").select("*, user:users(id, full_name, email)").eq("resource_id",e).order("downloaded_at",{ascending:!1});if(t)throw t;return s}async recordView(e,s,t,r,a){let{data:i,error:l}=await this.supabase.from("resource_views").insert({resource_id:e,user_id:s,view_duration_seconds:t,ip_address:r,user_agent:a}).select().single();if(l)throw l;return i}async getCollections(e,s){let t=this.supabase.from("resource_collections").select("*, user:users(id, full_name, email)").eq("organization_id",e);s?.userId&&(t=t.eq("user_id",s.userId)),s?.isPublic!==void 0&&(t=t.eq("is_public",s.isPublic)),s?.isFeatured&&(t=t.eq("is_featured",!0));let{data:r,error:a}=await t.order("created_at",{ascending:!1});if(a)throw a;return r}async getCollectionById(e){let{data:s,error:t}=await this.supabase.from("resource_collections").select(`
        *,
        user:users(id, full_name, email),
        resources:collection_resources(*, resource:educational_resources(*, category:resource_categories(*)))
      `).eq("id",e).single();if(t)throw t;return s}async createCollection(e){let{data:s,error:t}=await this.supabase.from("resource_collections").insert(e).select().single();if(t)throw t;return s}async addResourceToCollection(e,s,t){let{data:r,error:a}=await this.supabase.from("collection_resources").insert({collection_id:e,resource_id:s,added_by:t}).select().single();if(a)throw a;return r}async removeResourceFromCollection(e,s){let{error:t}=await this.supabase.from("collection_resources").delete().eq("collection_id",e).eq("resource_id",s);if(t)throw t}async getResourceComments(e){let{data:s,error:t}=await this.supabase.from("resource_comments").select("*, user:users(id, full_name, email), replies:resource_comments(*)").eq("resource_id",e).is("parent_id",null).order("created_at",{ascending:!1});if(t)throw t;return s}async createComment(e){let{data:s,error:t}=await this.supabase.from("resource_comments").insert(e).select(`
        *,
        user:users(id, full_name, email)
      `).single();if(t)throw t;return s}async updateComment(e,s){let{data:t,error:r}=await this.supabase.from("resource_comments").update({content:s,is_edited:!0}).eq("id",e).select().single();if(r)throw r;return t}async deleteComment(e){let{error:s}=await this.supabase.from("resource_comments").delete().eq("id",e);if(s)throw s}async createRating(e){let{data:s,error:t}=await this.supabase.from("resource_ratings").insert(e).select().single();if(t)throw t;return s}async updateRating(e,s,t){let{data:r,error:a}=await this.supabase.from("resource_ratings").update({rating:s,comment:t}).eq("id",e).select().single();if(a)throw a;return r}async getResourceRatings(e){let{data:s,error:t}=await this.supabase.from("resource_ratings").select("*, user:users(id, full_name, email)").eq("resource_id",e).order("created_at",{ascending:!1});if(t)throw t;return s}async getResourceRatingStats(e){let{data:s,error:t}=await this.supabase.from("resource_ratings").select("rating").eq("resource_id",e);if(t)throw t;let r={total:s.length,average:0,distribution:{1:0,2:0,3:0,4:0,5:0}};if(s.length>0){let e=s.map(e=>e.rating).filter(Boolean);r.average=e.reduce((e,s)=>e+s,0)/e.length,e.forEach(e=>{r.distribution[e]++})}return r}async getResourceVersions(e){let{data:s,error:t}=await this.supabase.from("resource_versions").select("*, created_by_user:users(id, full_name)").eq("resource_id",e).order("created_at",{ascending:!1});if(t)throw t;return s}async createVersion(e){let{data:s,error:t}=await this.supabase.from("resource_versions").insert(e).select().single();if(t)throw t;return s}};e.s(["educationalResourcesService",0,t])},283033,e=>{"use strict";var s=e.i(843476),t=e.i(271645),r=e.i(266027),a=e.i(325715),i=e.i(941095),l=e.i(970065),c=e.i(167881),o=e.i(23750),n=e.i(127341),d=e.i(555436),u=e.i(810980),h=e.i(278716),m=e.i(178583),g=e.i(473708),f=e.i(221345),x=e.i(653339),p=e.i(870273),_=e.i(440160),v=e.i(286536),w=e.i(790597),y=e.i(707866),b=e.i(107233),j=e.i(522016);let N={document:m.FileText,video:h.Video,audio:x.Music,image:g.Image,link:f.Link,interactive:u.BookOpen,other:m.FileText},C={document:"Document",video:"Vidéo",audio:"Audio",image:"Image",link:"Lien",interactive:"Interactif",other:"Autre"};function q(){let{user:e}=(0,a.useAuth)(),[u,h]=(0,t.useState)(""),[g,f]=(0,t.useState)(),[x,q]=(0,t.useState)(),[T,R]=(0,t.useState)("all"),{data:k}=(0,r.useQuery)({queryKey:["resource-categories",e?.organization_id],queryFn:()=>i.educationalResourcesService.getCategories(e?.organization_id||""),enabled:!!e?.organization_id}),{data:S}=(0,r.useQuery)({queryKey:["educational-resources",e?.organization_id,u,g,x],queryFn:()=>i.educationalResourcesService.getResources(e?.organization_id||"",{categoryId:g,resourceType:x,search:u||void 0}),enabled:!!e?.organization_id}),{data:F}=(0,r.useQuery)({queryKey:["featured-resources",e?.organization_id],queryFn:()=>i.educationalResourcesService.getResources(e?.organization_id||"",{featured:!0}),enabled:!!e?.organization_id}),{data:P}=(0,r.useQuery)({queryKey:["user-favorites",e?.id],queryFn:()=>i.educationalResourcesService.getUserFavorites(e?.id||""),enabled:!!e?.id});return(0,s.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,s.jsxs)("div",{className:"mb-8 flex items-start justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,s.jsx)(y.Library,{className:"h-8 w-8"}),"Bibliothèque de ressources"]}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Accédez à une vaste collection de ressources pédagogiques"})]}),(0,s.jsx)(j.default,{href:"/dashboard/resources/new",children:(0,s.jsxs)(c.Button,{className:"bg-brand-blue hover:bg-brand-blue/90 text-white shadow-lg shadow-brand-blue/20",children:[(0,s.jsx)(b.Plus,{className:"h-4 w-4 mr-2"}),"Nouvelle ressource"]})})]}),(0,s.jsx)(l.Card,{className:"mb-8",children:(0,s.jsx)(l.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(d.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,s.jsx)(o.Input,{type:"text",placeholder:"Rechercher une ressource...",value:u,onChange:e=>h(e.target.value),className:"pl-10"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsxs)("select",{value:g||"",onChange:e=>f(e.target.value||void 0),className:"px-3 py-2 border rounded-md text-sm",children:[(0,s.jsx)("option",{value:"",children:"Toutes les catégories"}),k?.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsxs)("select",{value:x||"",onChange:e=>q(e.target.value||void 0),className:"px-3 py-2 border rounded-md text-sm",children:[(0,s.jsx)("option",{value:"",children:"Tous les types"}),Object.entries(C).map(([e,t])=>(0,s.jsx)("option",{value:e,children:t},e))]})]})]})})}),(0,s.jsxs)(n.Tabs,{value:T,onValueChange:R,children:[(0,s.jsxs)(n.TabsList,{className:"mb-6",children:[(0,s.jsx)(n.TabsTrigger,{value:"all",children:"Toutes les ressources"}),(0,s.jsx)(n.TabsTrigger,{value:"featured",children:"En vedette"}),(0,s.jsx)(n.TabsTrigger,{value:"favorites",children:"Mes favoris"})]}),(0,s.jsx)(n.TabsContent,{value:"all",children:S&&S.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.map(e=>{var t;let r=N[e.resource_type]||m.FileText;return(0,s.jsx)(l.Card,{className:"hover:shadow-lg transition-shadow",children:(0,s.jsxs)(j.default,{href:`/dashboard/resources/${e.slug}`,children:[e.thumbnail_url&&(0,s.jsxs)("div",{className:"relative h-48 w-full overflow-hidden rounded-t-lg",children:[(0,s.jsx)("img",{src:e.thumbnail_url,alt:e.title,className:"w-full h-full object-cover"}),e.is_featured&&(0,s.jsx)("div",{className:"absolute top-2 right-2",children:(0,s.jsx)(p.Star,{className:"h-5 w-5 text-yellow-500 fill-yellow-500"})})]}),(0,s.jsx)(l.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(r,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(l.CardTitle,{className:"text-lg line-clamp-2",children:e.title}),e.category&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:e.category.name})]})]})}),(0,s.jsxs)(l.CardContent,{children:[e.description&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-3",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(v.Eye,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.view_count||0})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(_.Download,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.download_count||0})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(w.Heart,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.favorite_count||0})]})]}),e.file_size_bytes&&(0,s.jsx)("span",{children:(t=e.file_size_bytes)?t<1024?`${t} B`:t<1048576?`${(t/1024).toFixed(1)} KB`:`${(t/1048576).toFixed(1)} MB`:"N/A"})]}),e.duration_minutes&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Durée: ",e.duration_minutes," min"]})]})]})},e.id)})}):(0,s.jsx)(l.Card,{children:(0,s.jsx)(l.CardContent,{className:"pt-6 text-center text-muted-foreground",children:"Aucune ressource disponible"})})}),(0,s.jsx)(n.TabsContent,{value:"featured",children:F&&F.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:F.map(e=>{let t=N[e.resource_type]||m.FileText;return(0,s.jsx)(l.Card,{className:"hover:shadow-lg transition-shadow",children:(0,s.jsxs)(j.default,{href:`/dashboard/resources/${e.slug}`,children:[e.thumbnail_url&&(0,s.jsxs)("div",{className:"relative h-48 w-full overflow-hidden rounded-t-lg",children:[(0,s.jsx)("img",{src:e.thumbnail_url,alt:e.title,className:"w-full h-full object-cover"}),(0,s.jsx)("div",{className:"absolute top-2 right-2",children:(0,s.jsx)(p.Star,{className:"h-5 w-5 text-yellow-500 fill-yellow-500"})})]}),(0,s.jsx)(l.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(t,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5"}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(l.CardTitle,{className:"text-lg line-clamp-2",children:e.title})})]})}),(0,s.jsxs)(l.CardContent,{children:[e.description&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-3",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(v.Eye,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.view_count||0})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(_.Download,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.download_count||0})]})]})]})]})},e.id)})}):(0,s.jsx)(l.Card,{children:(0,s.jsx)(l.CardContent,{className:"pt-6 text-center text-muted-foreground",children:"Aucune ressource en vedette"})})}),(0,s.jsx)(n.TabsContent,{value:"favorites",children:P&&P.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:P.map(e=>{let t=e.resource;if(!t)return null;let r=N[t.resource_type]||m.FileText;return(0,s.jsx)(l.Card,{className:"hover:shadow-lg transition-shadow",children:(0,s.jsxs)(j.default,{href:`/dashboard/resources/${t.slug}`,children:[t.thumbnail_url&&(0,s.jsx)("div",{className:"relative h-48 w-full overflow-hidden rounded-t-lg",children:(0,s.jsx)("img",{src:t.thumbnail_url,alt:t.title,className:"w-full h-full object-cover"})}),(0,s.jsx)(l.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(r,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5"}),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(l.CardTitle,{className:"text-lg line-clamp-2",children:t.title})})]})}),(0,s.jsxs)(l.CardContent,{children:[t.description&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-3",children:t.description}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(v.Eye,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:t.view_count||0})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(_.Download,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:t.download_count||0})]})]})]})]})},e.id)})}):(0,s.jsx)(l.Card,{children:(0,s.jsx)(l.CardContent,{className:"pt-6 text-center text-muted-foreground",children:"Aucun favori pour le moment"})})})]})]})}e.s(["default",()=>q])}]);