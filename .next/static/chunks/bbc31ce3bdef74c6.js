(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,871689,e=>{"use strict";let t=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],871689)},286536,e=>{"use strict";let t=(0,e.i(475254).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],286536)},660724,e=>{"use strict";var t=e.i(920755);let s=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getFAQCategories(e){let{data:t,error:s}=await this.supabase.from("faq_categories").select("*").eq("organization_id",e).eq("is_active",!0).order("order_index",{ascending:!0});if(s)throw s;return t}async createFAQCategory(e){let{data:t,error:s}=await this.supabase.from("faq_categories").insert(e).select().single();if(s)throw s;return t}async updateFAQCategory(e,t){let{data:s,error:a}=await this.supabase.from("faq_categories").update(t).eq("id",e).select().single();if(a)throw a;return s}async deleteFAQCategory(e){let{error:t}=await this.supabase.from("faq_categories").delete().eq("id",e);if(t)throw t}async getFAQItems(e,t){let s=this.supabase.from("faq_items").select("*, category:faq_categories(*)").eq("organization_id",e).eq("is_active",!0);t?.categoryId&&(s=s.eq("category_id",t.categoryId)),t?.search&&(s=s.or(`question.ilike.%${t.search}%,answer.ilike.%${t.search}%`)),t?.featured&&(s=s.eq("is_featured",!0));let{data:a,error:i}=await s.order("order_index",{ascending:!0}).order("view_count",{ascending:!1});if(i)throw i;return a}async getFAQItemById(e){let{data:t,error:s}=await this.supabase.from("faq_items").select("*, category:faq_categories(*)").eq("id",e).single();if(s)throw s;return t&&await this.supabase.rpc("increment_faq_view_count",{faq_uuid:t.id}),t}async createFAQItem(e){let{data:t,error:s}=await this.supabase.from("faq_items").insert(e).select().single();if(s)throw s;return t}async updateFAQItem(e,t){let{data:s,error:a}=await this.supabase.from("faq_items").update(t).eq("id",e).select().single();if(a)throw a;return s}async deleteFAQItem(e){let{error:t}=await this.supabase.from("faq_items").delete().eq("id",e);if(t)throw t}async createFAQFeedback(e,t,s,a){let{data:i,error:r}=await this.supabase.from("faq_feedback").insert({faq_id:e,user_id:t,is_helpful:s,comment:a}).select().single();if(r)throw r;return i}async getGuides(e,t){let s=this.supabase.from("guides").select("*, author:users(id, full_name, email)").eq("organization_id",e).eq("is_active",!0);t?.category&&(s=s.eq("category",t.category)),t?.difficulty&&(s=s.eq("difficulty",t.difficulty)),t?.search&&(s=s.or(`title.ilike.%${t.search}%,description.ilike.%${t.search}%,content.ilike.%${t.search}%`)),t?.featured&&(s=s.eq("is_featured",!0));let{data:a,error:i}=await s.order("published_at",{ascending:!1}).order("view_count",{ascending:!1});if(i)throw i;return a}async getGuideBySlug(e,t){let{data:s,error:a}=await this.supabase.from("guides").select("*, author:users(id, full_name, email), steps:guide_steps(*)").eq("slug",e).eq("organization_id",t).eq("is_active",!0).single();if(a)throw a;return s&&await this.supabase.rpc("increment_guide_view_count",{guide_uuid:s.id}),s}async createGuide(e){let{data:t,error:s}=await this.supabase.from("guides").insert(e).select().single();if(s)throw s;return t}async updateGuide(e,t){let{data:s,error:a}=await this.supabase.from("guides").update(t).eq("id",e).select().single();if(a)throw a;return s}async deleteGuide(e){let{error:t}=await this.supabase.from("guides").delete().eq("id",e);if(t)throw t}async getGuideSteps(e){let{data:t,error:s}=await this.supabase.from("guide_steps").select("*").eq("guide_id",e).order("step_number",{ascending:!0});if(s)throw s;return t}async createGuideStep(e){let{data:t,error:s}=await this.supabase.from("guide_steps").insert(e).select().single();if(s)throw s;return t}async updateGuideStep(e,t){let{data:s,error:a}=await this.supabase.from("guide_steps").update(t).eq("id",e).select().single();if(a)throw a;return s}async deleteGuideStep(e){let{error:t}=await this.supabase.from("guide_steps").delete().eq("id",e);if(t)throw t}async addGuideToFavorites(e,t){let{data:s,error:a}=await this.supabase.from("guide_favorites").insert({user_id:e,guide_id:t}).select().single();if(a)throw a;return s}async removeGuideFromFavorites(e,t){let{error:s}=await this.supabase.from("guide_favorites").delete().eq("user_id",e).eq("guide_id",t);if(s)throw s}async isGuideFavorite(e,t){let{data:s,error:a}=await this.supabase.from("guide_favorites").select("id").eq("user_id",e).eq("guide_id",t).maybeSingle();if(a)throw a;return!!s}async getUserFavoriteGuides(e){let{data:t,error:s}=await this.supabase.from("guide_favorites").select("*, guide:guides(*, author:users(id, full_name))").eq("user_id",e).order("created_at",{ascending:!1});if(s)throw s;return t}async getGuideProgress(e,t){let{data:s,error:a}=await this.supabase.from("guide_progress").select("*").eq("user_id",e).eq("guide_id",t).maybeSingle();if(a)throw a;return s}async updateGuideProgress(e,t,s,a){let i=await this.getGuideProgress(e,t),r=await this.getGuideSteps(t),d=a.length===r.length;if(i){let{data:e,error:t}=await this.supabase.from("guide_progress").update({current_step:s,completed_steps:a,is_completed:d,completed_at:d?new Date().toISOString():null}).eq("id",i.id).select().single();if(t)throw t;return e}{let{data:i,error:r}=await this.supabase.from("guide_progress").insert({user_id:e,guide_id:t,current_step:s,completed_steps:a,is_completed:d,completed_at:d?new Date().toISOString():null}).select().single();if(r)throw r;return i}}async markStepAsCompleted(e,t,s){let a=await this.getGuideProgress(e,t),i=a?.completed_steps||[];return i.includes(s)||i.push(s),this.updateGuideProgress(e,t,s,i)}};e.s(["knowledgeBaseService",0,s])},400417,e=>{"use strict";let t=(0,e.i(475254).default)("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);e.s(["ThumbsUp",()=>t],400417)},365582,e=>{"use strict";let t=(0,e.i(475254).default)("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z",key:"s6e0r"}]]);e.s(["ThumbsDown",()=>t],365582)},673635,e=>{"use strict";var t=e.i(843476),s=e.i(271645),a=e.i(618566),i=e.i(266027),r=e.i(954616),d=e.i(912598),n=e.i(325715),l=e.i(660724),u=e.i(970065),c=e.i(167881),o=e.i(184762),h=e.i(10708),m=e.i(871689),g=e.i(400417),f=e.i(365582),p=e.i(520958),w=e.i(286536),_=e.i(522016),y=e.i(918789);function x(){let e=(0,a.useParams)();(0,a.useRouter)();let x=e.id,{user:b}=(0,n.useAuth)(),q=(0,d.useQueryClient)(),[v,j]=(0,s.useState)(""),[N,k]=(0,s.useState)(!1),{data:C}=(0,i.useQuery)({queryKey:["faq-item",x],queryFn:()=>l.knowledgeBaseService.getFAQItemById(x),enabled:!!x}),A=(0,r.useMutation)({mutationFn:async e=>{if(!b?.id)throw Error("Non authentifié");return l.knowledgeBaseService.createFAQFeedback(x,b.id,e,v||void 0)},onSuccess:()=>{k(!0),j(""),q.invalidateQueries({queryKey:["faq-item"]})}}),F=e=>{N||A.mutate(e)};return C?(0,t.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:[(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)(_.default,{href:"/dashboard/knowledge-base",children:(0,t.jsxs)(c.Button,{variant:"ghost",size:"sm",className:"mb-4",children:[(0,t.jsx)(m.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Retour à la base de connaissances"]})})}),(0,t.jsxs)(u.Card,{className:"mb-6",children:[(0,t.jsx)(u.CardHeader,{children:(0,t.jsx)("div",{className:"flex items-start justify-between",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(p.HelpCircle,{className:"h-5 w-5 text-primary"}),(0,t.jsx)(u.CardTitle,{className:"text-2xl",children:C.question})]}),C.category&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:C.category.name})]})})}),(0,t.jsxs)(u.CardContent,{children:[(0,t.jsx)("div",{className:"prose prose-sm max-w-none mb-6",children:(0,t.jsx)(y.default,{children:C.answer})}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(w.Eye,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:[C.view_count," vues"]})]}),C.helpful_count>0&&(0,t.jsxs)("span",{className:"text-green-600",children:[C.helpful_count," personne",C.helpful_count>1?"s":""," ont trouvé cela utile"]})]}),!N&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground mr-2",children:"Cette réponse vous a-t-elle été utile ?"}),(0,t.jsxs)(c.Button,{variant:"outline",size:"sm",onClick:()=>F(!0),disabled:A.isPending,children:[(0,t.jsx)(g.ThumbsUp,{className:"h-4 w-4 mr-2"}),"Oui"]}),(0,t.jsxs)(c.Button,{variant:"outline",size:"sm",onClick:()=>F(!1),disabled:A.isPending,children:[(0,t.jsx)(f.ThumbsDown,{className:"h-4 w-4 mr-2"}),"Non"]})]}),N&&(0,t.jsx)("div",{className:"text-sm text-green-600",children:"Merci pour votre retour !"})]}),!N&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)(h.Label,{children:"Commentaire (optionnel)"}),(0,t.jsx)(o.Textarea,{value:v,onChange:e=>j(e.target.value),placeholder:"Partagez vos commentaires...",rows:3,className:"mt-2"})]})]})]}),C.category&&(0,t.jsxs)(u.Card,{children:[(0,t.jsx)(u.CardHeader,{children:(0,t.jsx)(u.CardTitle,{children:"Questions similaires"})}),(0,t.jsxs)(u.CardContent,{children:[(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Découvrez d'autres questions dans la catégorie \"",C.category.name,'"']}),(0,t.jsx)(_.default,{href:`/dashboard/knowledge-base/faq/category/${C.category.slug}`,children:(0,t.jsx)(c.Button,{variant:"outline",className:"mt-4",children:"Voir toutes les questions de cette catégorie"})})]})]})]}):(0,t.jsx)("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:(0,t.jsx)("div",{className:"text-center py-12",children:"Chargement..."})})}e.s(["default",()=>x])}]);