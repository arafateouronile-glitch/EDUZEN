(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,503116,e=>{"use strict";let s=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>s],503116)},738308,e=>{"use strict";let s=(0,e.i(475254).default)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>s],738308)},212426,e=>{"use strict";let s=(0,e.i(475254).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>s],212426)},671428,e=>{"use strict";var s=e.i(843476),t=e.i(647163);function r({className:e,...r}){return(0,s.jsx)("div",{className:(0,t.cn)("animate-pulse rounded-md bg-gray-200",e),...r})}function a(){return(0,s.jsxs)("div",{className:"rounded-2xl p-6 border-2 border-gray-200 bg-white",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsx)(r,{className:"h-12 w-12 rounded-2xl"}),(0,s.jsx)(r,{className:"h-6 w-20"})]}),(0,s.jsx)(r,{className:"h-8 w-24 mb-2"}),(0,s.jsx)(r,{className:"h-4 w-32"})]})}function i(){return(0,s.jsxs)("div",{className:"rounded-2xl p-6 border-2 border-gray-200 bg-white",children:[(0,s.jsx)(r,{className:"h-6 w-48 mb-4"}),(0,s.jsx)(r,{className:"h-64 w-full"})]})}function n({count:e=3}){return(0,s.jsx)("div",{className:"space-y-3",children:Array.from({length:e}).map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-4 p-4 border rounded-lg",children:[(0,s.jsx)(r,{className:"h-12 w-12 rounded-full"}),(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsx)(r,{className:"h-4 w-3/4"}),(0,s.jsx)(r,{className:"h-3 w-1/2"})]}),(0,s.jsx)(r,{className:"h-8 w-20"})]},t))})}function l({count:e=3}){return(0,s.jsx)(n,{count:e})}function c({items:e=4}){return(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:e}).map((e,t)=>(0,s.jsx)(a,{},t))})}e.s(["ChartSkeleton",()=>i,"Skeleton",()=>r,"SkeletonBentoGrid",()=>c,"SkeletonList",()=>l,"StatsCardSkeleton",()=>a])},658041,e=>{"use strict";let s=(0,e.i(475254).default)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);e.s(["Database",()=>s],658041)},529253,e=>{"use strict";let s=new class{metrics=[];maxMetrics=1e3;async measure(e,s,t){let r=performance.now();try{let a=await s(),i=performance.now()-r;return this.recordMetric({name:e,value:i,unit:"ms",timestamp:new Date().toISOString(),context:t}),a}catch(a){let s=performance.now()-r;throw this.recordMetric({name:e,value:s,unit:"ms",timestamp:new Date().toISOString(),context:{...t,error:a instanceof Error?a.message:"Unknown error"}}),a}}recordMetric(e){this.metrics.push(e),this.metrics.length>this.maxMetrics&&(this.metrics=this.metrics.slice(-this.maxMetrics))}getMetrics(e,s=100){return this.metrics.filter(s=>s.name===e).slice(-s)}getStats(e){let s=this.getMetrics(e);if(0===s.length)return null;let t=s.map(e=>e.value),r=t.reduce((e,s)=>e+s,0)/t.length,a=Math.min(...t),i=Math.max(...t),n=[...t].sort((e,s)=>e-s),l=n[Math.floor(n.length/2)],c=n[Math.floor(.95*n.length)],d=n[Math.floor(.99*n.length)];return{count:s.length,avg:r,min:a,max:i,median:l,p95:c,p99:d}}getAllMetrics(){return[...this.metrics]}clear(){this.metrics=[]}getMetricsByGroup(){let e={};for(let s of this.metrics)e[s.name]||(e[s.name]=[]),e[s.name].push(s);return e}};e.s(["performanceMonitor",0,s])},465414,e=>{"use strict";var s=e.i(247167),t=e.i(843476),r=e.i(266027),a=e.i(920755),i=e.i(970065),n=e.i(994179),l=e.i(465286),c=e.i(738308),d=e.i(898791),o=e.i(503116),m=e.i(658041);let x=(0,e.i(475254).default)("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);var h=e.i(21218),u=e.i(761911),g=e.i(178583),p=e.i(212426),j=e.i(647163),f=e.i(671428);e.i(882205);var y=e.i(846932),N=e.i(529253),b=e.i(271645);function v(){let e=(0,a.createClient)(),[v,w]=(0,b.useState)({});(0,b.useEffect)(()=>{let e={};for(let[s,t]of Object.entries(N.performanceMonitor.getMetricsByGroup())){let t=N.performanceMonitor.getStats(s);t&&(e[s]=t)}w(e);let s=setInterval(()=>{let e={};for(let[s,t]of Object.entries(N.performanceMonitor.getMetricsByGroup())){let t=N.performanceMonitor.getStats(s);t&&(e[s]=t)}w(e)},3e4);return()=>clearInterval(s)},[]);let{data:C,isLoading:S}=(0,r.useQuery)({queryKey:["health-db"],queryFn:async()=>{let s=Date.now();try{let{data:t,error:r}=await e.from("organizations").select("id").limit(1),a=Date.now()-s;return{status:r?"error":"healthy",responseTime:a,error:r?.message,timestamp:new Date().toISOString()}}catch(e){return{status:"error",responseTime:Date.now()-s,error:e instanceof Error?e.message:"Unknown error",timestamp:new Date().toISOString()}}},refetchInterval:3e4}),{data:k,isLoading:M}=(0,r.useQuery)({queryKey:["health-stats"],queryFn:async()=>{let[s,t,r,a,i]=await Promise.all([e.from("organizations").select("id",{count:"exact",head:!0}),e.from("users").select("id",{count:"exact",head:!0}),e.from("students").select("id",{count:"exact",head:!0}),e.from("documents").select("id",{count:"exact",head:!0}),e.from("payments").select("id",{count:"exact",head:!0}).eq("status","completed")]);return{organizations:s.count||0,users:t.count||0,students:r.count||0,documents:a.count||0,completedPayments:i.count||0,timestamp:new Date().toISOString()}},refetchInterval:6e4}),{data:D,isLoading:B}=(0,r.useQuery)({queryKey:["health-performance"],queryFn:async()=>{let s=[{name:"Organizations",query:e.from("organizations").select("id").limit(10)},{name:"Users",query:e.from("users").select("id").limit(10)},{name:"Students",query:e.from("students").select("id").limit(10)},{name:"Sessions",query:e.from("sessions").select("id").limit(10)}];return await Promise.all(s.map(async({name:e,query:s})=>{let t=Date.now();try{let{error:r}=await s,a=Date.now()-t;return{name:e,status:r?"error":"success",responseTime:a,error:r?.message}}catch(s){return{name:e,status:"error",responseTime:Date.now()-t,error:s instanceof Error?s.message:"Unknown error"}}}))},refetchInterval:12e4}),T=e=>{switch(e){case"healthy":case"success":return(0,t.jsx)(l.CheckCircle2,{className:"h-5 w-5 text-emerald-500"});case"error":return(0,t.jsx)(c.XCircle,{className:"h-5 w-5 text-red-500"});default:return(0,t.jsx)(d.AlertCircle,{className:"h-5 w-5 text-yellow-500"})}},q=e=>{switch(e){case"healthy":case"success":return(0,t.jsx)(n.Badge,{className:"bg-emerald-100 text-emerald-700",children:"Healthy"});case"error":return(0,t.jsx)(n.Badge,{className:"bg-red-100 text-red-700",children:"Error"});default:return(0,t.jsx)(n.Badge,{className:"bg-yellow-100 text-yellow-700",children:"Warning"})}};return(0,t.jsxs)("div",{className:"space-y-6 p-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Dashboard de Santé"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2",children:"Surveillance de l'état de l'application et des performances"})]}),(0,t.jsxs)(i.Card,{children:[(0,t.jsxs)(i.CardHeader,{children:[(0,t.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(m.Database,{className:"h-5 w-5"}),"Connexion Base de Données"]}),(0,t.jsx)(i.CardDescription,{children:"État de la connexion à Supabase"})]}),(0,t.jsx)(i.CardContent,{children:S?(0,t.jsx)(f.Skeleton,{className:"h-20 w-full"}):C?(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[T(C.status),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:"Base de données"}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Temps de réponse: ",C.responseTime,"ms"]}),C.error&&(0,t.jsx)("div",{className:"text-sm text-red-600 mt-1",children:C.error})]})]}),q(C.status)]}):null})]}),(0,t.jsxs)(i.Card,{children:[(0,t.jsxs)(i.CardHeader,{children:[(0,t.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Activity,{className:"h-5 w-5"}),"Statistiques Générales"]}),(0,t.jsx)(i.CardDescription,{children:"Données agrégées de l'application"})]}),(0,t.jsx)(i.CardContent,{children:M?(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,t.jsx)(f.Skeleton,{className:"h-20 w-full"},s))}):k?(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,t.jsxs)(y.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-4 rounded-lg bg-blue-50 border border-blue-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(x,{className:"h-4 w-4 text-blue-600"}),(0,t.jsx)("p",{className:"text-sm text-blue-600 font-medium",children:"Organisations"})]}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:k.organizations})]}),(0,t.jsxs)(y.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"p-4 rounded-lg bg-purple-50 border border-purple-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(u.Users,{className:"h-4 w-4 text-purple-600"}),(0,t.jsx)("p",{className:"text-sm text-purple-600 font-medium",children:"Utilisateurs"})]}),(0,t.jsx)("p",{className:"text-2xl font-bold text-purple-900",children:k.users})]}),(0,t.jsxs)(y.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"p-4 rounded-lg bg-green-50 border border-green-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(u.Users,{className:"h-4 w-4 text-green-600"}),(0,t.jsx)("p",{className:"text-sm text-green-600 font-medium",children:"Étudiants"})]}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-900",children:k.students})]}),(0,t.jsxs)(y.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"p-4 rounded-lg bg-orange-50 border border-orange-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(g.FileText,{className:"h-4 w-4 text-orange-600"}),(0,t.jsx)("p",{className:"text-sm text-orange-600 font-medium",children:"Documents"})]}),(0,t.jsx)("p",{className:"text-2xl font-bold text-orange-900",children:k.documents})]}),(0,t.jsxs)(y.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"p-4 rounded-lg bg-emerald-50 border border-emerald-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(p.DollarSign,{className:"h-4 w-4 text-emerald-600"}),(0,t.jsx)("p",{className:"text-sm text-emerald-600 font-medium",children:"Paiements"})]}),(0,t.jsx)("p",{className:"text-2xl font-bold text-emerald-900",children:k.completedPayments})]})]}):null})]}),(0,t.jsxs)(i.Card,{children:[(0,t.jsxs)(i.CardHeader,{children:[(0,t.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(o.Clock,{className:"h-5 w-5"}),"Performances des Requêtes"]}),(0,t.jsx)(i.CardDescription,{children:"Temps de réponse par table"})]}),(0,t.jsx)(i.CardContent,{children:B?(0,t.jsx)(f.Skeleton,{className:"h-40 w-full"}):D?(0,t.jsx)("div",{className:"space-y-3",children:D.map((e,s)=>(0,t.jsxs)(y.motion.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*s},className:"flex items-center justify-between p-4 rounded-lg border",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[T(e.status),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.name}),e.error&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:e.error})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Temps de réponse"}),(0,t.jsxs)("p",{className:`font-bold ${e.responseTime>1e3?"text-red-600":e.responseTime>500?"text-yellow-600":"text-emerald-600"}`,children:[e.responseTime,"ms"]})]}),q(e.status)]})]},e.name))}):null})]}),Object.keys(v).length>0&&(0,t.jsxs)(i.Card,{children:[(0,t.jsxs)(i.CardHeader,{children:[(0,t.jsxs)(i.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(h.Activity,{className:"h-5 w-5"}),"Métriques de Performance"]}),(0,t.jsx)(i.CardDescription,{children:"Statistiques des temps d'exécution"})]}),(0,t.jsx)(i.CardContent,{children:(0,t.jsx)("div",{className:"space-y-4",children:Object.entries(v).map(([e,s])=>(0,t.jsxs)(y.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-4 rounded-lg border bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("p",{className:"font-medium",children:e}),(0,t.jsxs)(n.Badge,{className:"bg-blue-100 text-blue-700",children:[s.count," mesures"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Moyenne"}),(0,t.jsxs)("p",{className:"font-bold text-blue-600",children:[Math.round(s.avg),"ms"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Médiane"}),(0,t.jsxs)("p",{className:"font-bold",children:[Math.round(s.median),"ms"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"P95"}),(0,t.jsxs)("p",{className:"font-bold text-yellow-600",children:[Math.round(s.p95),"ms"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"P99"}),(0,t.jsxs)("p",{className:"font-bold text-red-600",children:[Math.round(s.p99),"ms"]})]})]})]},e))})})]}),(0,t.jsxs)(i.Card,{children:[(0,t.jsxs)(i.CardHeader,{children:[(0,t.jsx)(i.CardTitle,{children:"Informations Système"}),(0,t.jsx)(i.CardDescription,{children:"Détails de l'environnement et configuration"})]}),(0,t.jsx)(i.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Environnement"}),(0,t.jsx)("p",{className:"font-medium",children:(0,t.jsx)(n.Badge,{className:"bg-green-100 text-green-700",children:"production"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Dernière mise à jour"}),(0,t.jsx)("p",{className:"font-medium",children:k?.timestamp?(0,j.formatDate)(k.timestamp):"N/A"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Sentry"}),(0,t.jsx)("p",{className:"font-medium",children:(0,t.jsx)(n.Badge,{className:"bg-green-100 text-green-700",children:"Activé"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Analytics"}),(0,t.jsx)("p",{className:"font-medium",children:s.default.env.NEXT_PUBLIC_PLAUSIBLE_DOMAIN||s.default.env.NEXT_PUBLIC_GA_ID?(0,t.jsx)(n.Badge,{className:"bg-green-100 text-green-700",children:"Activé"}):(0,t.jsx)(n.Badge,{className:"bg-gray-100 text-gray-700",children:"Désactivé"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Version"}),(0,t.jsx)("p",{className:"font-medium",children:"1.0.0"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Base de données"}),(0,t.jsx)("p",{className:"font-medium",children:C?.status==="healthy"?(0,t.jsx)(n.Badge,{className:"bg-green-100 text-green-700",children:"Connectée"}):(0,t.jsx)(n.Badge,{className:"bg-red-100 text-red-700",children:"Erreur"})})]})]})})]})]})}e.s(["default",()=>v],465414)}]);