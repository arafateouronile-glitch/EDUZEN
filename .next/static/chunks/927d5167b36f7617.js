(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,871689,e=>{"use strict";let r=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>r],871689)},683909,e=>{"use strict";var r=e.i(920755);let i=new class{supabase;constructor(e){this.supabase=e||(0,r.createClient)()}async getAllPrograms(e,r){let i=this.supabase.from("programs").select("*").eq("organization_id",e);r?.isActive!==void 0&&(i=i.eq("is_active",r.isActive)),r?.search&&(i=i.or(`name.ilike.%${r.search}%,code.ilike.%${r.search}%,description.ilike.%${r.search}%`));let{data:t,error:a}=await i.order("created_at",{ascending:!1});if(a)throw a;return t}async getProgramById(e){let{data:r,error:i}=await this.supabase.from("programs").select(`
        *,
        formations(*)
      `).eq("id",e).single();if(i)throw i;return r}async createProgram(e){let{data:r,error:i}=await this.supabase.from("programs").insert(e).select().single();if(i)throw i;return r}async updateProgram(e,r){let{data:i,error:t}=await this.supabase.from("programs").update(r).eq("id",e).select().single();if(t)throw t;return i}async deleteProgram(e){return this.updateProgram(e,{is_active:!1})}async getFormationsByProgram(e){let{data:r,error:i}=await this.supabase.from("formations").select("*").eq("program_id",e).order("created_at",{ascending:!1});if(i)throw i;return r}async getGlobalStats(e){let{data:r,error:i}=await this.supabase.from("programs").select("id, is_active, created_at").eq("organization_id",e);if(i)throw i;let t=r||[],a=t.length,s=t.filter(e=>e.is_active).length,o=t.filter(e=>!e.is_active).length,n=0,l=t.map(e=>e.id);if(l.length>0){let{count:e,error:r}=await this.supabase.from("formations").select("*",{count:"exact",head:!0}).in("program_id",l);if(r)throw r;n=e||0}let d=0;if(l.length>0){let{data:e,error:r}=await this.supabase.from("formations").select("id").in("program_id",l);if(r)throw r;let i=e?.map(e=>e.id)||[];if(i.length>0){let{count:e,error:r}=await this.supabase.from("sessions").select("*",{count:"exact",head:!0}).in("formation_id",i);if(r)throw r;d=e||0}}let c=0;if(l.length>0){let{data:e,error:r}=await this.supabase.from("formations").select("id").in("program_id",l);if(r)throw r;let i=e?.map(e=>e.id)||[];if(i.length>0){let{data:e,error:r}=await this.supabase.from("sessions").select("id").in("formation_id",i);if(r)throw r;let t=e?.map(e=>e.id)||[];if(t.length>0){let{count:e,error:r}=await this.supabase.from("enrollments").select("*",{count:"exact",head:!0}).in("session_id",t);if(r)throw r;c=e||0}}}let m=[{name:"Actifs",value:s,color:"#335ACF"},{name:"Inactifs",value:o,color:"#6B7280"}].filter(e=>e.value>0),u={};return t.forEach(e=>{if(e.created_at){let r=new Date(e.created_at),i=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`;u[i]=(u[i]||0)+1}}),{total:a,active:s,inactive:o,totalFormations:n,totalSessions:d,totalEnrollments:c,statusData:m,monthlyData:Object.entries(u).sort(([e],[r])=>e.localeCompare(r)).slice(-6).map(([e,r])=>({month:new Date(e+"-01").toLocaleDateString("fr-FR",{month:"short",year:"numeric"}),programmes:r}))}}};e.s(["programService",0,i])},209372,e=>{"use strict";var r=e.i(50270);let i=r.z.object({first_name:r.z.string().min(1,"Le prénom est requis").max(100,"Le prénom est trop long"),last_name:r.z.string().min(1,"Le nom est requis").max(100,"Le nom est trop long"),date_of_birth:r.z.string().optional().or(r.z.literal("")),gender:r.z.enum(["male","female","other"]).optional().or(r.z.literal("")),email:r.z.string().email("Email invalide").optional().or(r.z.literal("")),phone:r.z.string().optional().or(r.z.literal("")),address:r.z.string().optional().or(r.z.literal("")),city:r.z.string().optional().or(r.z.literal("")),class_id:r.z.string().optional().or(r.z.literal("")),enrollment_date:r.z.string().min(1,"La date d'inscription est requise"),guardian_first_name:r.z.string().min(1,"Le prénom du tuteur est requis"),guardian_last_name:r.z.string().min(1,"Le nom du tuteur est requis"),guardian_relationship:r.z.enum(["parent","guardian","other"]).default("parent"),guardian_phone_primary:r.z.string().min(1,"Le téléphone principal du tuteur est requis"),guardian_phone_secondary:r.z.string().optional().or(r.z.literal("")),guardian_email:r.z.string().email("Email invalide").optional().or(r.z.literal("")),guardian_address:r.z.string().optional().or(r.z.literal(""))});r.z.object({first_name:r.z.string().min(1,"Le prénom est requis").max(100,"Le prénom est trop long"),last_name:r.z.string().min(1,"Le nom est requis").max(100,"Le nom est trop long"),date_of_birth:r.z.string().optional().or(r.z.literal("")),gender:r.z.enum(["male","female","other"]).optional().or(r.z.literal("")),email:r.z.string().email("Email invalide").optional().or(r.z.literal("")),phone:r.z.string().optional().or(r.z.literal("")),address:r.z.string().optional().or(r.z.literal("")),city:r.z.string().optional().or(r.z.literal("")),class_id:r.z.string().optional().or(r.z.literal("")),enrollment_date:r.z.string().min(1,"La date d'inscription est requise"),status:r.z.enum(["active","inactive","graduated"]).default("active")});let t=r.z.object({code:r.z.string().min(1,"Le code est requis").max(50,"Le code est trop long"),name:r.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),subtitle:r.z.string().optional().or(r.z.literal("")),description:r.z.string().optional().or(r.z.literal("")),category:r.z.string().optional().or(r.z.literal("")),program_version:r.z.string().optional().or(r.z.literal("")),version_date:r.z.string().optional().or(r.z.literal("")),duration_hours:r.z.string().optional().or(r.z.literal("")),duration_days:r.z.string().optional().or(r.z.literal("")),photo_url:r.z.string().url("URL invalide").optional().or(r.z.literal("")),price:r.z.string().optional().or(r.z.literal("")),price_enterprise:r.z.string().optional().or(r.z.literal("")),price_individual:r.z.string().optional().or(r.z.literal("")),price_freelance:r.z.string().optional().or(r.z.literal("")),currency:r.z.string().default("XOF"),payment_plan:r.z.enum(["full","installment","free"]).default("full"),published_online:r.z.boolean().default(!1),is_public:r.z.boolean().default(!1),eligible_cpf:r.z.boolean().default(!1),cpf_code:r.z.string().optional().or(r.z.literal("")),modalities:r.z.string().optional().or(r.z.literal("")),training_action_type:r.z.string().optional().or(r.z.literal("")),pedagogical_objectives:r.z.string().optional().or(r.z.literal("")),learner_profile:r.z.string().optional().or(r.z.literal("")),training_content:r.z.string().optional().or(r.z.literal("")),execution_follow_up:r.z.string().optional().or(r.z.literal("")),certification_modalities:r.z.string().optional().or(r.z.literal("")),quality:r.z.string().optional().or(r.z.literal("")),accounting_product_config:r.z.string().optional().or(r.z.literal("")),edof_export_fields:r.z.string().optional().or(r.z.literal("")),competence_domains:r.z.string().optional().or(r.z.literal("")),prerequisites:r.z.string().optional().or(r.z.literal("")),capacity_max:r.z.string().optional().or(r.z.literal("")),age_min:r.z.string().optional().or(r.z.literal("")),age_max:r.z.string().optional().or(r.z.literal("")),certification_issued:r.z.boolean().default(!1),is_active:r.z.boolean().default(!0)}),a=r.z.object({program_id:r.z.string().min(1,"Le programme est requis"),code:r.z.string().min(1,"Le code est requis").max(50,"Le code est trop long"),name:r.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),subtitle:r.z.string().optional().or(r.z.literal("")),photo_url:r.z.string().url("URL invalide").optional().or(r.z.literal("")),category:r.z.string().optional().or(r.z.literal("")),description:r.z.string().optional().or(r.z.literal("")),program_version:r.z.string().optional().or(r.z.literal("")),version_date:r.z.string().optional().or(r.z.literal("")),duration_hours:r.z.string().optional().or(r.z.literal("")),duration_days:r.z.string().optional().or(r.z.literal("")),duration_unit:r.z.enum(["hours","days"]).default("hours"),price:r.z.string().optional().or(r.z.literal("")),currency:r.z.string().default("XOF"),payment_plan:r.z.enum(["full","installment","free"]).default("full"),published_online:r.z.boolean().default(!1),eligible_cpf:r.z.boolean().default(!1),cpf_code:r.z.string().optional().or(r.z.literal("")),modalities:r.z.string().optional().or(r.z.literal("")),training_action_type:r.z.string().optional().or(r.z.literal("")),pedagogical_objectives:r.z.string().optional().or(r.z.literal("")),learner_profile:r.z.string().optional().or(r.z.literal("")),training_content:r.z.string().optional().or(r.z.literal("")),execution_follow_up:r.z.string().optional().or(r.z.literal("")),certification_modalities:r.z.string().optional().or(r.z.literal("")),quality:r.z.string().optional().or(r.z.literal("")),accounting_product_config:r.z.string().optional().or(r.z.literal("")),edof_export_fields:r.z.string().optional().or(r.z.literal("")),competence_domains:r.z.string().optional().or(r.z.literal("")),prerequisites:r.z.string().optional().or(r.z.literal("")),capacity_max:r.z.string().optional().or(r.z.literal("")),age_min:r.z.string().optional().or(r.z.literal("")),age_max:r.z.string().optional().or(r.z.literal("")),certification_issued:r.z.boolean().default(!1),is_active:r.z.boolean().default(!0)}),s=r.z.object({formation_id:r.z.string().min(1,"La formation est requise"),name:r.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),code:r.z.string().optional().or(r.z.literal("")),start_date:r.z.string().min(1,"La date de début est requise"),end_date:r.z.string().min(1,"La date de fin est requise"),start_time:r.z.string().optional().or(r.z.literal("")),end_time:r.z.string().optional().or(r.z.literal("")),location:r.z.string().optional().or(r.z.literal("")),capacity_max:r.z.string().optional().or(r.z.literal("")).refine(e=>{if(!e)return!0;let r=parseInt(e);return!isNaN(r)&&r>0},"La capacité maximale doit être un nombre entier positif"),currency:r.z.string().default("XOF"),status:r.z.enum(["planned","ongoing","completed","cancelled"]).default("planned"),teacher_id:r.z.string().optional().or(r.z.literal("")),manager1_id:r.z.string().optional().or(r.z.literal("")),manager2_id:r.z.string().optional().or(r.z.literal("")),inter_entreprise:r.z.boolean().default(!0),sous_traitance:r.z.boolean().default(!1),timezone:r.z.string().default("Europe/Paris"),program_ids:r.z.array(r.z.string()).default([])}).refine(e=>!e.start_date||!e.end_date||new Date(e.end_date)>=new Date(e.start_date),{message:"La date de fin doit être postérieure à la date de début",path:["end_date"]}),o=r.z.object({student_id:r.z.string().min(1,"L'étudiant est requis"),session_id:r.z.string().optional().or(r.z.literal("")),subject:r.z.string().min(1,"Le sujet est requis").max(200,"Le sujet est trop long"),assessment_type:r.z.enum(["pre_formation","hot","cold","manager","instructor","funder","quiz","exam","project","other"]).default("quiz"),score:r.z.string().min(1,"La note est requise").refine(e=>{let r=parseFloat(e);return!isNaN(r)&&r>=0},"La note doit être un nombre valide"),max_score:r.z.string().optional().or(r.z.literal("")).refine(e=>{if(!e)return!0;let r=parseFloat(e);return!isNaN(r)&&r>0},"La note maximale doit être un nombre valide supérieur à 0"),notes:r.z.string().optional().or(r.z.literal("")),graded_at:r.z.string().min(1,"La date d'évaluation est requise"),coefficient:r.z.string().optional().or(r.z.literal("")).refine(e=>{if(!e)return!0;let r=parseFloat(e);return!isNaN(r)&&r>0},"Le coefficient doit être un nombre valide supérieur à 0"),is_makeup:r.z.boolean().optional().default(!1),original_grade_id:r.z.string().optional().or(r.z.literal("")),appreciation:r.z.string().optional().or(r.z.literal("")),term_period:r.z.enum(["Q1","Q2","Q3","Q4","S1","S2","T1","T2","T3"]).optional().or(r.z.literal("")),academic_year_id:r.z.string().optional().or(r.z.literal(""))}).refine(e=>!e.max_score||!e.score||parseFloat(e.score)<=parseFloat(e.max_score),{message:"La note ne peut pas être supérieure à la note maximale",path:["score"]}),n=r.z.object({student_id:r.z.string().min(1,"L'étudiant est requis"),document_type:r.z.enum(["quote","invoice"]).default("invoice"),invoice_number:r.z.string().optional().or(r.z.literal("")),type:r.z.enum(["tuition","registration","other"]).default("tuition"),issue_date:r.z.string().min(1,"La date d'émission est requise"),due_date:r.z.string().min(1,"La date d'échéance est requise"),amount:r.z.string().min(1,"Le montant est requis").refine(e=>{let r=parseFloat(e);return!isNaN(r)&&r>=0},"Le montant doit être un nombre valide supérieur ou égal à 0"),tax_amount:r.z.string().optional().or(r.z.literal("")).refine(e=>{if(!e)return!0;let r=parseFloat(e);return!isNaN(r)&&r>=0},"Le montant de la taxe doit être un nombre valide supérieur ou égal à 0"),currency:r.z.string().default("XOF"),status:r.z.enum(["draft","sent","partial","paid","overdue","cancelled"]).default("draft"),notes:r.z.string().optional().or(r.z.literal("")),enrollment_id:r.z.string().optional().or(r.z.literal(""))}).refine(e=>!e.issue_date||!e.due_date||new Date(e.due_date)>=new Date(e.issue_date),{message:"La date d'échéance doit être postérieure à la date d'émission",path:["due_date"]});r.z.object({invoice_id:r.z.string().min(1,"La facture est requise"),student_id:r.z.string().min(1,"L'étudiant est requis"),amount:r.z.string().min(1,"Le montant est requis").refine(e=>{let r=parseFloat(e);return!isNaN(r)&&r>0},"Le montant doit être un nombre valide supérieur à 0"),currency:r.z.string().default("XOF"),payment_method:r.z.enum(["cash","mobile_money","card","bank_transfer"]).default("cash"),payment_provider:r.z.enum(["mtn","orange","airtel","wave"]).optional().or(r.z.literal("")),transaction_id:r.z.string().optional().or(r.z.literal("")),paid_at:r.z.string().optional().or(r.z.literal("")),notes:r.z.string().optional().or(r.z.literal(""))});let l=r.z.object({student_id:r.z.string().min(1,"L'étudiant est requis"),session_id:r.z.string().min(1,"La session est requise"),enrollment_date:r.z.string().min(1,"La date d'inscription est requise"),status:r.z.enum(["pending","confirmed","completed","cancelled","failed"]).default("confirmed"),payment_status:r.z.enum(["pending","partial","paid","overdue"]).default("pending"),total_amount:r.z.string().optional().or(r.z.literal("")).refine(e=>{if(!e)return!0;let r=parseFloat(e);return!isNaN(r)&&r>=0},"Le montant total doit être un nombre valide supérieur ou égal à 0"),paid_amount:r.z.string().optional().or(r.z.literal("")).refine(e=>{if(!e)return!0;let r=parseFloat(e);return!isNaN(r)&&r>=0},"Le montant payé doit être un nombre valide supérieur ou égal à 0")}).refine(e=>{if(e.total_amount&&e.paid_amount){let r=parseFloat(e.total_amount),i=parseFloat(e.paid_amount);if(!isNaN(r)&&!isNaN(i)&&i>r)return!1}return!0},{message:"Le montant payé ne peut pas dépasser le montant total",path:["paid_amount"]});e.s(["enrollmentSchema",0,l,"evaluationSchema",0,o,"formationSchema",0,a,"invoiceSchema",0,n,"programSchema",0,t,"sessionSchema",0,s,"studentSchema",0,i])},2034,e=>{"use strict";var r=e.i(920755);let i=async(e,r)=>(console.warn("videoconferenceService.createMeetingForSession not implemented"),null),t=new class{supabase;constructor(e){this.supabase=e||(0,r.createClient)()}async getAllSessions(e,r){let i=this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",e);r?.formationId&&(i=i.eq("formation_id",r.formationId)),r?.status&&(i=i.eq("status",r.status)),r?.startDate&&(i=i.gte("start_date",r.startDate)),r?.endDate&&(i=i.lte("end_date",r.endDate)),r?.search&&(i=i.ilike("name",`%${r.search}%`));let{data:t,error:a}=await i.order("start_date",{ascending:!0});if(a)throw a;return t}async getSessionById(e){let{data:r,error:i}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("id",e).single();if(i)throw i;let{data:t,error:a}=await this.supabase.from("session_programs").select(`
        program_id,
        programs(*)
      `).eq("session_id",e);if(a)throw a;return{...r,session_programs:t?.map(e=>e.programs).filter(Boolean)||[]}}async createSession(e,r,i){if(e.formation_id){let{data:r,error:i}=await this.supabase.from("formations").select("id, organization_id").eq("id",e.formation_id).single();if(i)throw console.error("Erreur lors de la vérification de la formation:",i),Error(`Formation non trouv\xe9e: ${i.message}`);if(!r)throw Error("Formation non trouvée");console.log("Formation trouvée:",r)}let{data:t,error:a}=await this.supabase.from("sessions").insert(e).select().single();if(a)throw console.error("Erreur RLS lors de la création de la session:",{code:a.code,message:a.message,details:a.details,hint:a.hint,formation_id:e.formation_id}),a;if(r&&r.length>0&&t){let{data:e}=await this.supabase.from("formations").select("organization_id").eq("id",t.formation_id).single();if(e){let i=r.map(r=>({session_id:t.id,program_id:r,organization_id:e.organization_id})),{error:a}=await this.supabase.from("session_programs").insert(i);a&&console.error("Erreur lors de la création des associations session-programme:",a),e.organization_id&&await this.syncWithCalendars(t.id,e.organization_id,"create").catch(e=>{console.error("Erreur lors de la synchronisation calendrier:",e)}),e.organization_id&&await this.createVideoconferenceMeeting(t.id,e.organization_id).catch(e=>{console.error("Erreur lors de la création de la réunion visioconférence:",e)})}}return console.log("Session créée avec succès:",t),t}async updateSessionPrograms(e,r,i){let{error:t}=await this.supabase.from("session_programs").delete().eq("session_id",e);if(t)throw t;if(r.length>0){let t=r.map(r=>({session_id:e,program_id:r,organization_id:i})),{error:a}=await this.supabase.from("session_programs").insert(t);if(a)throw a}return!0}async getSessionPrograms(e){let{data:r,error:i}=await this.supabase.from("session_programs").select(`
        program_id,
        programs(*)
      `).eq("session_id",e);if(i)throw i;return r?.map(e=>e.programs).filter(Boolean)||[]}async updateSession(e,r){let{data:i}=await this.supabase.from("sessions").select("formation_id, formations(organization_id)").eq("id",e).single(),{data:t,error:a}=await this.supabase.from("sessions").update(r).eq("id",e).select().single();if(a)throw a;let s=i?.formations;return i&&s?.organization_id&&await this.syncWithCalendars(e,s.organization_id,"update").catch(e=>{console.error("Erreur lors de la synchronisation calendrier:",e)}),t}async deleteSession(e){let{data:r}=await this.supabase.from("sessions").select("formation_id, formations(organization_id)").eq("id",e).single(),i=r?.formations;r&&i?.organization_id&&await this.syncWithCalendars(e,i.organization_id,"delete").catch(e=>{console.error("Erreur lors de la suppression de l'événement calendrier:",e)});let{error:t}=await this.supabase.from("sessions").delete().eq("id",e);if(t)throw t}async createVideoconferenceMeeting(e,r){let{data:t}=await this.supabase.from("videoconference_integrations").select("*").eq("organization_id",r).eq("is_active",!0).eq("auto_create_meetings",!0);if(t&&0!==t.length)for(let a of t)try{await i(e,{organizationId:r,provider:a.provider})}catch(e){console.error(`Erreur lors de la cr\xe9ation de r\xe9union avec ${a.provider}:`,e)}}async syncWithCalendars(e,r,i){let{data:t}=await this.supabase.from("calendar_integrations").select("*").eq("organization_id",r).eq("is_active",!0).eq("sync_sessions",!0).eq("create_events_for_sessions",!0);if(t&&0!==t.length)for(let e of t)try{console.warn(`Calendar sync for ${i} not implemented yet for provider ${e.provider}`)}catch(r){console.error(`Erreur lors de la synchronisation avec ${e.provider}:`,r)}}async getUpcomingSessions(e,r=10){let i=new Date().toISOString().split("T")[0],{data:t,error:a}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",e).gte("start_date",i).eq("status","planned").order("start_date",{ascending:!0}).limit(r);if(a)throw a;return t}async getOngoingSessions(e){let r=new Date().toISOString().split("T")[0],{data:i,error:t}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",e).lte("start_date",r).gte("end_date",r).eq("status","ongoing").order("start_date",{ascending:!0});if(t)throw t;return i}async addSessionToFormations(e,r,i){let t=r.map((r,t)=>({session_id:e,formation_id:r,organization_id:i,order_index:t})),{data:a,error:s}=await this.supabase.from("formation_sessions").insert(t).select();if(s)throw s;return a}async removeSessionFromFormation(e,r){let{error:i}=await this.supabase.from("formation_sessions").delete().eq("session_id",e).eq("formation_id",r);if(i)throw i;return!0}async updateSessionFormations(e,r,i){let{error:t}=await this.supabase.from("formation_sessions").delete().eq("session_id",e);if(t)throw t;return r.length>0?this.addSessionToFormations(e,r,i):[]}async getSessionFormations(e){let{data:r,error:i}=await this.supabase.from("formation_sessions").select(`
        formation_id,
        order_index,
        formations(*)
      `).eq("session_id",e).order("order_index",{ascending:!0});if(i)throw i;return r?.map(e=>e.formations).filter(Boolean)||[]}async getFormationSessions(e){let{data:r,error:i}=await this.supabase.from("formation_sessions").select(`
        session_id,
        order_index,
        sessions(*)
      `).eq("formation_id",e).order("order_index",{ascending:!0});if(i)throw i;return r?.map(e=>e.sessions).filter(Boolean)||[]}async createIndependentSession(e,r,i){let{data:t,error:a}=await this.supabase.from("sessions").insert({...e,formation_id:null}).select().single();if(a)throw a;return r&&r.length>0&&t&&await this.updateSessionPrograms(t.id,r,e.organization_id),i&&i.length>0&&t&&await this.addSessionToFormations(t.id,i,e.organization_id),t}};e.s(["sessionService",0,t],2034)},1262,e=>{"use strict";var r=e.i(920755);let i=new class{supabase;constructor(e){this.supabase=e||(0,r.createClient)()}async getAllFormations(e,r){let i=this.supabase.from("formations").select(`
        *,
        programs(*)
      `).eq("organization_id",e);r?.programId&&(i=i.eq("program_id",r.programId)),r?.isActive!==void 0&&(i=i.eq("is_active",r.isActive)),r?.search&&(i=i.or(`name.ilike.%${r.search}%,code.ilike.%${r.search}%,description.ilike.%${r.search}%`));let{data:t,error:a}=await i.order("created_at",{ascending:!1});if(a)throw a;return t}async getFormationById(e){let{data:r,error:i}=await this.supabase.from("formations").select(`
        *,
        programs(*),
        sessions(*)
      `).eq("id",e).single();if(i)throw i;return r}async createFormation(e){let{data:r,error:i}=await this.supabase.from("formations").insert(e).select().single();if(i)throw i;return r}async updateFormation(e,r){let{data:i,error:t}=await this.supabase.from("formations").update(r).eq("id",e).select().single();if(t)throw t;return i}async deleteFormation(e){return this.updateFormation(e,{is_active:!1})}async getSessionsByFormation(e){let{data:r,error:i}=await this.supabase.from("sessions").select("*").eq("formation_id",e).order("start_date",{ascending:!0});if(i)throw i;return r}async getAllSessionsForFormation(e){let{data:r,error:i}=await this.supabase.from("formation_sessions").select(`
        session_id,
        order_index,
        sessions(*)
      `).eq("formation_id",e).order("order_index",{ascending:!0});if(i)throw i;let{data:t,error:a}=await this.supabase.from("sessions").select("*").eq("formation_id",e).order("start_date",{ascending:!0});if(a)throw a;let s=r?.map(e=>e.sessions).filter(Boolean)||[],o=[...s],n=new Set(s.map(e=>e.id));for(let e of t||[])n.has(e.id)||o.push(e);return o}async addSessionsToFormation(e,r,i){let t=r.map((r,t)=>({formation_id:e,session_id:r,organization_id:i,order_index:t})),{data:a,error:s}=await this.supabase.from("formation_sessions").insert(t).select();if(s)throw s;return a}async removeSessionFromFormation(e,r){let{error:i}=await this.supabase.from("formation_sessions").delete().eq("formation_id",e).eq("session_id",r);if(i)throw i;return!0}async updateFormationSessions(e,r,i){let{error:t}=await this.supabase.from("formation_sessions").delete().eq("formation_id",e);if(t)throw t;return r.length>0?this.addSessionsToFormation(e,r,i):[]}async getFormationWithAllSessions(e){let r=await this.getFormationById(e);if(!r)return null;let i=await this.getAllSessionsForFormation(e);return{...r,all_sessions:i}}};e.s(["formationService",0,i])},586007,e=>{"use strict";var r=e.i(843476),i=e.i(271645),t=e.i(37727);let a=(0,e.i(475254).default)("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);var s=e.i(643531),o=e.i(647163),n=e.i(167881),l=e.i(463415),d=e.i(994179);function c({options:e,selected:c,onChange:m,placeholder:u="Sélectionner...",className:p}){let[g,f]=i.useState(!1);return(0,r.jsx)("div",{className:(0,o.cn)("flex flex-col gap-2",p),children:(0,r.jsxs)(l.DropdownMenu,{open:g,onOpenChange:f,children:[(0,r.jsx)(l.DropdownMenuTrigger,{asChild:!0,children:(0,r.jsxs)(n.Button,{variant:"outline",role:"combobox","aria-expanded":g,className:"w-full justify-between text-left font-normal h-auto min-h-[42px] py-2 px-3 bg-white border-gray-200 hover:bg-gray-50",children:[(0,r.jsxs)("div",{className:"flex flex-wrap gap-1.5 w-full items-center",children:[0===c.length&&(0,r.jsx)("span",{className:"text-muted-foreground text-sm",children:u}),c.length>0&&c.map(i=>{let a=e.find(e=>e.value===i);return(0,r.jsxs)(d.Badge,{variant:"secondary",className:"mr-0.5 rounded-md px-1.5 py-0.5 text-xs font-medium bg-brand-blue-ghost text-brand-blue hover:bg-brand-blue/20 border-brand-blue/10 transition-colors flex items-center gap-1",onClick:e=>{e.stopPropagation(),m(c.filter(e=>e!==i))},children:[a?.label||i,(0,r.jsx)("div",{className:"ml-0.5 rounded-full p-0.5 hover:bg-brand-blue/20 cursor-pointer",children:(0,r.jsx)(t.X,{className:"h-3 w-3"})})]},i)})]}),(0,r.jsx)(a,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,r.jsxs)(l.DropdownMenuContent,{align:"start",className:"w-[var(--radix-dropdown-menu-trigger-width)] p-1 max-h-60 overflow-y-auto",children:[e.map(e=>(0,r.jsxs)("div",{className:(0,o.cn)("relative flex cursor-pointer select-none items-center rounded-sm py-2 pl-8 pr-2 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",c.includes(e.value)?"bg-accent/50 font-medium":""),onClick:r=>{var i;r.preventDefault(),i=e.value,c.includes(i)?m(c.filter(e=>e!==i)):m([...c,i])},children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.includes(e.value)&&(0,r.jsx)(s.Check,{className:"h-4 w-4 text-brand-blue"})}),e.label]},e.value)),0===e.length&&(0,r.jsx)("div",{className:"py-3 px-2 text-center text-sm text-muted-foreground",children:"Aucune option disponible"})]})]})})}e.s(["MultiSelect",()=>c],586007)},55269,e=>{"use strict";var r=e.i(843476),i=e.i(271645),t=e.i(618566),a=e.i(266027),s=e.i(954616),o=e.i(653145),n=e.i(994814),l=e.i(325715),d=e.i(1262),c=e.i(683909),m=e.i(2034),u=e.i(167881),p=e.i(970065),g=e.i(586007),f=e.i(871689),h=e.i(522016),x=e.i(209372);function _(){let e=(0,t.useRouter)(),{user:_,isLoading:b}=(0,l.useAuth)(),[z,y]=(0,i.useState)([]),{data:j}=(0,a.useQuery)({queryKey:["programs",_?.organization_id],queryFn:async()=>_?.organization_id?c.programService.getAllPrograms(_.organization_id,{isActive:!0}):[],enabled:!!_?.organization_id&&!b}),{data:v}=(0,a.useQuery)({queryKey:["sessions",_?.organization_id],queryFn:async()=>_?.organization_id?m.sessionService.getAllSessions(_.organization_id):[],enabled:!!_?.organization_id&&!b}),{register:w,handleSubmit:N,formState:{errors:q},watch:C,setValue:F}=(0,o.useForm)({resolver:(0,n.zodResolver)(x.formationSchema),mode:"onChange",defaultValues:{program_id:"",code:"",name:"",subtitle:"",photo_url:"",category:"",description:"",program_version:"",version_date:"",duration_hours:"",duration_days:"",duration_unit:"hours",price:"",currency:"XOF",payment_plan:"full",prerequisites:"",capacity_max:"",age_min:"",age_max:"",published_online:!1,eligible_cpf:!1,cpf_code:"",modalities:"",training_action_type:"",pedagogical_objectives:"",learner_profile:"",training_content:"",execution_follow_up:"",certification_modalities:"",quality:"",accounting_product_config:"",edof_export_fields:"",competence_domains:"",certification_issued:!1,is_active:!0}}),S=C(),L=(0,s.useMutation)({mutationFn:async e=>{if(!_?.organization_id)throw Error("Organization ID manquant");return d.formationService.createFormation({organization_id:_.organization_id,program_id:e.program_id||null,code:e.code,name:e.name,subtitle:e.subtitle||null,photo_url:e.photo_url||null,category:e.category||null,description:e.description||null,program_version:e.program_version||null,version_date:e.version_date||null,duration_hours:e.duration_hours?parseInt(e.duration_hours):null,duration_days:e.duration_days?parseInt(e.duration_days):null,duration_unit:e.duration_unit,price:e.price&&parseFloat(e.price)||0,currency:e.currency||"XOF",payment_plan:e.payment_plan,prerequisites:e.prerequisites||null,capacity_max:e.capacity_max?parseInt(e.capacity_max):null,age_min:e.age_min?parseInt(e.age_min):null,age_max:e.age_max?parseInt(e.age_max):null,published_online:e.published_online,eligible_cpf:e.eligible_cpf,cpf_code:e.cpf_code||null,modalities:e.modalities||null,training_action_type:e.training_action_type||null,pedagogical_objectives:e.pedagogical_objectives||null,learner_profile:e.learner_profile||null,training_content:e.training_content||null,execution_follow_up:e.execution_follow_up||null,certification_modalities:e.certification_modalities||null,quality:e.quality||null,accounting_product_config:e.accounting_product_config||null,edof_export_fields:e.edof_export_fields?JSON.parse(e.edof_export_fields):null,competence_domains:e.competence_domains||null,certification_issued:e.certification_issued,is_active:e.is_active??!0})},onSuccess:async r=>{if(z.length>0&&_?.organization_id&&r?.id)try{await d.formationService.addSessionsToFormation(r.id,z,_.organization_id)}catch(e){console.error("Erreur lors de l'ajout des sessions:",e)}r?.id&&e.push(`/dashboard/formations/${r.id}`)}}),k=N(e=>{L.mutate(e)});if(b)return(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("p",{children:"Chargement..."})});if(!_||!_.organization_id)return(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Organisation manquante"}),(0,r.jsx)("p",{className:"text-red-700",children:"Votre compte n'est pas associé à une organisation."})]})});let D=v?.map(e=>({label:e.name,value:e.id}))||[];return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(h.default,{href:"/dashboard/formations",children:(0,r.jsx)(u.Button,{variant:"ghost",size:"icon",children:(0,r.jsx)(f.ArrowLeft,{className:"h-4 w-4"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Nouvelle formation"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Créez une nouvelle formation (une formation appartient à un programme et contient plusieurs sessions)"})]})]}),(0,r.jsxs)("form",{onSubmit:k,className:"space-y-6",children:[(0,r.jsxs)(p.Card,{children:[(0,r.jsx)(p.CardHeader,{children:(0,r.jsx)(p.CardTitle,{children:"Informations de base"})}),(0,r.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Programme (Optionnel - Legacy)"}),(0,r.jsxs)("select",{...w("program_id"),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target ${q.program_id?"border-danger-primary":""}`,children:[(0,r.jsx)("option",{value:"",children:"Aucun programme"}),j?.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]}),q.program_id&&(0,r.jsx)("p",{className:"text-sm text-danger-primary mt-1",children:q.program_id.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Sessions associées (Nouveau - Multiples)"}),(0,r.jsx)(g.MultiSelect,{options:D,selected:z,onChange:y,placeholder:"Sélectionner des sessions existantes..."}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Vous pourrez également créer de nouvelles sessions plus tard."})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Code *"}),(0,r.jsx)("input",{type:"text",...w("code"),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target ${q.code?"border-danger-primary":""}`,placeholder:"Ex: FORM-001"}),q.code&&(0,r.jsx)("p",{className:"text-sm text-danger-primary mt-1",children:q.code.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Titre de la formation *"}),(0,r.jsx)("input",{type:"text",...w("name"),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target ${q.name?"border-danger-primary":""}`,placeholder:"Ex: Formation en Informatique"}),q.name&&(0,r.jsx)("p",{className:"text-sm text-danger-primary mt-1",children:q.name.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Sous-titre"}),(0,r.jsx)("input",{type:"text",...w("subtitle"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Sous-titre de la formation"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Catégorie"}),(0,r.jsx)("input",{type:"text",...w("category"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Ex: Informatique, Management..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Photo de la formation (URL)"}),(0,r.jsx)("input",{type:"url",...w("photo_url"),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target ${q.photo_url?"border-danger-primary":""}`,placeholder:"https://..."}),q.photo_url&&(0,r.jsx)("p",{className:"text-sm text-danger-primary mt-1",children:q.photo_url.message})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Description de la formation"}),(0,r.jsx)("textarea",{...w("description"),rows:4,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Description détaillée de la formation..."})]})]})]}),(0,r.jsxs)(p.Card,{children:[(0,r.jsx)(p.CardHeader,{children:(0,r.jsx)(p.CardTitle,{children:"Version de la formation"})}),(0,r.jsx)(p.CardContent,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Version de la formation"}),(0,r.jsx)("input",{type:"text",...w("program_version"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Ex: 1.0"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Date de la version"}),(0,r.jsx)("input",{type:"date",...w("version_date"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target"})]})]})})]}),(0,r.jsxs)(p.Card,{children:[(0,r.jsx)(p.CardHeader,{children:(0,r.jsx)(p.CardTitle,{children:"Durée de la formation"})}),(0,r.jsx)(p.CardContent,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Durée (heures)"}),(0,r.jsx)("input",{type:"number",...w("duration_hours"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Ex: 120"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Durée (jours)"}),(0,r.jsx)("input",{type:"number",...w("duration_days"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Ex: 15"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Unité de durée"}),(0,r.jsxs)("select",{...w("duration_unit"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",children:[(0,r.jsx)("option",{value:"hours",children:"Heure(s)"}),(0,r.jsx)("option",{value:"days",children:"Jour(s)"})]})]})]})})]}),(0,r.jsxs)(p.Card,{children:[(0,r.jsx)(p.CardHeader,{children:(0,r.jsx)(p.CardTitle,{children:"Tarification"})}),(0,r.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Prix"}),(0,r.jsx)("input",{type:"number",step:"0.01",...w("price"),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target ${q.price?"border-danger-primary":""}`,placeholder:"0.00"}),q.price&&(0,r.jsx)("p",{className:"text-sm text-danger-primary mt-1",children:q.price.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Devise"}),(0,r.jsxs)("select",{...w("currency"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",children:[(0,r.jsx)("option",{value:"XOF",children:"XOF (Franc CFA Ouest)"}),(0,r.jsx)("option",{value:"XAF",children:"XAF (Franc CFA Centre)"}),(0,r.jsx)("option",{value:"EUR",children:"EUR (Euro)"}),(0,r.jsx)("option",{value:"USD",children:"USD (Dollar)"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Plan de paiement"}),(0,r.jsxs)("select",{...w("payment_plan"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",children:[(0,r.jsx)("option",{value:"full",children:"Paiement unique"}),(0,r.jsx)("option",{value:"installment",children:"Échelonné"}),(0,r.jsx)("option",{value:"free",children:"Gratuit"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Configuration comptable du produit"}),(0,r.jsx)("textarea",{...w("accounting_product_config"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Configuration comptable..."})]})]})]}),(0,r.jsxs)(p.Card,{children:[(0,r.jsx)(p.CardHeader,{children:(0,r.jsx)(p.CardTitle,{children:"Catalogue en ligne et CPF"})}),(0,r.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"published_online",...w("published_online"),className:"rounded border-gray-300 text-primary focus:ring-primary"}),(0,r.jsx)("label",{htmlFor:"published_online",className:"text-sm font-medium",children:"Publier sur le catalogue en ligne"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"eligible_cpf",...w("eligible_cpf"),className:"rounded border-gray-300 text-primary focus:ring-primary"}),(0,r.jsx)("label",{htmlFor:"eligible_cpf",className:"text-sm font-medium",children:"Eligible CPF (Compte Personnel Formation)"})]}),S.eligible_cpf&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Code CPF"}),(0,r.jsx)("input",{type:"text",...w("cpf_code"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Ex: 236631"})]})]})]}),(0,r.jsxs)(p.Card,{children:[(0,r.jsx)(p.CardHeader,{children:(0,r.jsx)(p.CardTitle,{children:"Détails de la formation"})}),(0,r.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Modalités"}),(0,r.jsx)("textarea",{...w("modalities"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Modalités de la formation..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Type d'action de formation"}),(0,r.jsx)("input",{type:"text",...w("training_action_type"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target",placeholder:"Type d'action de formation..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Objectifs pédagogiques"}),(0,r.jsx)("textarea",{...w("pedagogical_objectives"),rows:4,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Objectifs pédagogiques..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Profil des apprenants"}),(0,r.jsx)("textarea",{...w("learner_profile"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Profil des apprenants..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Contenu de la formation (progression pédagogique)"}),(0,r.jsx)("textarea",{...w("training_content"),rows:6,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Contenu de la formation..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Suivi de l'exécution"}),(0,r.jsx)("textarea",{...w("execution_follow_up"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Suivi de l'exécution..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Modalités de certification"}),(0,r.jsx)("textarea",{...w("certification_modalities"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Modalités de certification..."})]})]})]}),(0,r.jsxs)(p.Card,{children:[(0,r.jsx)(p.CardHeader,{children:(0,r.jsx)(p.CardTitle,{children:"Public cible"})}),(0,r.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Prérequis"}),(0,r.jsx)("textarea",{...w("prerequisites"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Prérequis pour suivre cette formation..."})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Âge minimum"}),(0,r.jsx)("input",{type:"number",...w("age_min"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Âge maximum"}),(0,r.jsx)("input",{type:"number",...w("age_max"),className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Capacité maximale"}),(0,r.jsx)("input",{type:"number",...w("capacity_max"),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent min-touch-target ${q.capacity_max?"border-danger-primary":""}`,placeholder:"Ex: 30"}),q.capacity_max&&(0,r.jsx)("p",{className:"text-sm text-danger-primary mt-1",children:q.capacity_max.message})]})]})]})]}),(0,r.jsxs)(p.Card,{children:[(0,r.jsx)(p.CardHeader,{children:(0,r.jsx)(p.CardTitle,{children:"Qualité et export"})}),(0,r.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Qualité"}),(0,r.jsx)("textarea",{...w("quality"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Informations qualité..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Champs pour l'export EDOF (JSON)"}),(0,r.jsx)("textarea",{...w("edof_export_fields"),rows:4,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent font-mono text-sm",placeholder:'{"field1": "value1", "field2": "value2"}'})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Domaines de compétences"}),(0,r.jsx)("textarea",{...w("competence_domains"),rows:3,className:"w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Domaines de compétences..."})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"certification",...w("certification_issued"),className:"rounded border-gray-300 text-primary focus:ring-primary"}),(0,r.jsx)("label",{htmlFor:"certification",className:"text-sm font-medium",children:"Certificat délivré à l'issue de la formation"})]})]})]}),Object.keys(q).length>0&&(0,r.jsxs)("div",{className:"bg-warning-bg border border-warning-border rounded-lg p-4",children:[(0,r.jsx)("p",{className:"text-sm text-warning-primary font-medium mb-2",children:"Veuillez corriger les erreurs suivantes :"}),(0,r.jsxs)("ul",{className:"list-disc list-inside text-sm text-warning-primary space-y-1",children:[q.program_id&&(0,r.jsx)("li",{children:q.program_id.message}),q.code&&(0,r.jsx)("li",{children:q.code.message}),q.name&&(0,r.jsx)("li",{children:q.name.message}),q.photo_url&&(0,r.jsx)("li",{children:q.photo_url.message}),q.price&&(0,r.jsx)("li",{children:q.price.message}),q.capacity_max&&(0,r.jsx)("li",{children:q.capacity_max.message})]})]}),L.error&&(0,r.jsx)("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-lg text-sm",children:L.error instanceof Error?L.error.message:"Une erreur est survenue"}),(0,r.jsxs)("div",{className:"flex justify-end space-x-4 pt-4",children:[(0,r.jsx)(h.default,{href:"/dashboard/formations",children:(0,r.jsx)(u.Button,{type:"button",variant:"outline",children:"Annuler"})}),(0,r.jsx)(u.Button,{type:"submit",disabled:L.isPending,children:L.isPending?"Création...":"Créer la formation"})]})]})]})}e.s(["default",()=>_])}]);