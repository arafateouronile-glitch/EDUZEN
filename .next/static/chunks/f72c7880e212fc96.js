(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,107233,e=>{"use strict";let s=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],107233)},871689,e=>{"use strict";let s=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>s],871689)},645760,e=>{"use strict";var s=e.i(843476),t=e.i(271645),r=e.i(647163);e.i(882205);var i=e.i(846932);let a=t.forwardRef(({className:e,variant:t="default",hoverable:a=!1,glow:n=!1,glowColor:l="rgba(51, 90, 207, 0.3)",...o},d)=>(0,s.jsxs)(i.motion.div,{ref:d,className:(0,r.cn)("relative rounded-2xl border backdrop-blur-xl transition-all duration-300",{"bg-white/70 dark:bg-gray-900/70 border-white/20 dark:border-gray-700/30 shadow-lg":"default"===t,"bg-white/80 dark:bg-gray-900/80 border-white/30 dark:border-gray-700/40 shadow-xl":"premium"===t,"bg-white/50 dark:bg-gray-900/50 border-white/10 dark:border-gray-700/20 shadow-md":"subtle"===t,"cursor-pointer":a,"hover:shadow-2xl hover:scale-[1.02]":a,"hover:bg-white/90 dark:hover:bg-gray-900/90":a},e),whileHover:a?{scale:1.02,y:-2}:void 0,transition:{type:"spring",stiffness:300,damping:30},...o,children:[n&&(0,s.jsx)(i.motion.div,{className:"absolute inset-0 rounded-2xl opacity-0 blur-xl",style:{background:`radial-gradient(circle, ${l} 0%, transparent 70%)`},animate:{opacity:[0,.5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"}}),(0,s.jsx)("div",{className:"relative z-10",children:o.children})]}));a.displayName="GlassCard",e.s(["GlassCard",()=>a])},356909,e=>{"use strict";let s=(0,e.i(475254).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);e.s(["Save",()=>s],356909)},569074,e=>{"use strict";let s=(0,e.i(475254).default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);e.s(["Upload",()=>s],569074)},186156,e=>{"use strict";var s=e.i(920755);let t=new class{supabase;constructor(e){this.supabase=e||(0,s.createClient)()}async getCourses(e,s){try{let t=this.supabase.from("courses").select("*, instructor:users(id, full_name, email), formation:formations(*)").eq("organization_id",e);s?.instructorId&&(t=t.eq("instructor_id",s.instructorId)),s?.isPublished!==void 0&&(t=t.eq("is_published",s.isPublished)),s?.isFeatured&&(t=t.eq("is_featured",!0)),s?.difficulty&&(t=t.eq("difficulty_level",s.difficulty)),s?.search&&(t=t.or(`title.ilike.%${s.search}%,description.ilike.%${s.search}%`));let{data:r,error:i}=await t.order("created_at",{ascending:!1});if(i){if("PGRST116"===i.code||"42P01"===i.code||"PGRST301"===i.code||400===i.status||"400"===i.code||i.message?.includes("relation")||i.message?.includes("relationship")||i.message?.includes("does not exist")||i.message?.includes("schema cache"))return console.warn("Table courses does not exist yet or invalid query:",i.message),[];throw i}return r||[]}catch(e){if(e?.code==="PGRST116"||e?.code==="42P01"||e?.code==="PGRST301"||e?.status===400||e?.code==="400"||e?.message?.includes("relation")||e?.message?.includes("relationship")||e?.message?.includes("does not exist")||e?.message?.includes("schema cache"))return console.warn("Table courses does not exist yet or invalid query:",e?.message||String(e)),[];throw e}}async getCourseBySlug(e,s){try{let t=this.supabase.from("courses").select(`
          *,
          instructor:users(id, full_name, email),
          formation:formations(*),
          sections:course_sections(*),
          lessons:lessons(*)
        `).eq("slug",e).eq("organization_id",s),{data:r,error:i}=await t.maybeSingle();if(i){if("PGRST116"===i.code||"42P01"===i.code||"PGRST301"===i.code||400===i.status||"400"===i.code||i.message?.includes("relation")||i.message?.includes("relationship")||i.message?.includes("does not exist")||i.message?.includes("schema cache"))return console.warn("Table courses or relations do not exist yet or invalid query:",i.message),null;throw i}return r}catch(e){if(e?.code==="PGRST116"||e?.code==="42P01"||e?.code==="PGRST301"||e?.status===400||e?.code==="400"||e?.message?.includes("relation")||e?.message?.includes("relationship")||e?.message?.includes("does not exist")||e?.message?.includes("schema cache"))return console.warn("Table courses or relations do not exist yet or invalid query:",e?.message),null;throw e}}async createCourse(e){let{data:s,error:t}=await this.supabase.from("courses").insert(e).select().single();if(t)throw t;return s}async updateCourse(e,s){let{data:t,error:r}=await this.supabase.from("courses").update(s).eq("id",e).select().single();if(r)throw r;return t}async deleteCourse(e){let{error:s}=await this.supabase.from("courses").delete().eq("id",e);if(s)throw s}async getCourseSections(e){let{data:s,error:t}=await this.supabase.from("course_sections").select("*").eq("course_id",e).order("order_index",{ascending:!0});if(t)throw t;return s}async createSection(e){let{data:s,error:t}=await this.supabase.from("course_sections").insert(e).select().single();if(t)throw t;return s}async updateSection(e,s){let{data:t,error:r}=await this.supabase.from("course_sections").update(s).eq("id",e).select().single();if(r)throw r;return t}async deleteSection(e){let{error:s}=await this.supabase.from("lessons").update({section_id:null}).eq("section_id",e);if(s)throw s;let{error:t}=await this.supabase.from("course_sections").delete().eq("id",e);if(t)throw t}async getCourseLessons(e){let{data:s,error:t}=await this.supabase.from("lessons").select("*").eq("course_id",e).order("order_index",{ascending:!0});if(t)throw t;return s}async getLessonById(e){let{data:s,error:t}=await this.supabase.from("lessons").select("*, course:courses(*), section:course_sections(*)").eq("id",e).single();if(t)throw t;return s}async getLessonBySlug(e,s){let{data:t,error:r}=await this.supabase.from("lessons").select("*, course:courses(*), section:course_sections(*)").eq("slug",e).eq("course_id",s).single();if(r)throw r;return t}async createLesson(e){let{data:s,error:t}=await this.supabase.from("lessons").insert(e).select().single();if(t)throw t;return await this.updateCourseLessonCount(e.course_id),s}async updateLesson(e,s){let{data:t,error:r}=await this.supabase.from("lessons").update(s).eq("id",e).select().single();if(r)throw r;return t}async deleteLesson(e){let{data:s}=await this.supabase.from("lessons").select("course_id").eq("id",e).single(),{error:t}=await this.supabase.from("lessons").delete().eq("id",e);if(t)throw t;s&&await this.updateCourseLessonCount(s.course_id)}async updateCourseLessonCount(e){let{count:s}=await this.supabase.from("lessons").select("*",{count:"exact",head:!0}).eq("course_id",e);await this.supabase.from("courses").update({total_lessons:s||0}).eq("id",e)}async enrollInCourse(e,s){let{data:t,error:r}=await this.supabase.from("course_enrollments").insert({course_id:e,student_id:s,enrollment_status:"enrolled"}).select().single();if(r)throw r;return await this.incrementCourseStudentCount(e),t}async getStudentEnrollments(e){try{let{data:s,error:t}=await this.supabase.from("course_enrollments").select(`
          *,
          course:courses(*, instructor:users(id, full_name, email))
        `).eq("student_id",e).order("enrolled_at",{ascending:!1});if(t){if("PGRST116"===t.code||"42P01"===t.code||"PGRST301"===t.code||400===t.status||"400"===t.code||t.message?.includes("relation")||t.message?.includes("relationship")||t.message?.includes("does not exist")||t.message?.includes("schema cache"))return console.warn("Table course_enrollments does not exist yet or invalid query:",t.message),[];throw t}return s||[]}catch(e){if(e?.code==="PGRST116"||e?.code==="42P01"||e?.code==="PGRST301"||e?.status===400||e?.code==="400"||e?.message?.includes("relation")||e?.message?.includes("relationship")||e?.message?.includes("does not exist")||e?.message?.includes("schema cache"))return console.warn("Table course_enrollments does not exist yet or invalid query:",e?.message||String(e)),[];throw e}}async getCourseEnrollments(e){let{data:s,error:t}=await this.supabase.from("course_enrollments").select(`
        *,
        student:users(id, full_name, email)
      `).eq("course_id",e).order("enrolled_at",{ascending:!1});if(t)throw t;return s}async updateEnrollment(e,s){let{data:t,error:r}=await this.supabase.from("course_enrollments").update(s).eq("id",e).select().single();if(r)throw r;return t}async incrementCourseStudentCount(e){let{data:s}=await this.supabase.from("courses").select("total_students").eq("id",e).single();s&&await this.supabase.from("courses").update({total_students:(s.total_students||0)+1}).eq("id",e)}async getLessonProgress(e,s){let{data:t,error:r}=await this.supabase.from("lesson_progress").select("*").eq("lesson_id",e).eq("student_id",s).maybeSingle();if(r)throw r;return t}async updateLessonProgress(e,s,t){let r=await this.getLessonProgress(e,s);if(r){let{data:e,error:s}=await this.supabase.from("lesson_progress").update({...t,last_accessed_at:new Date().toISOString()}).eq("id",r.id).select().single();if(s)throw s;return e}{let{data:r,error:i}=await this.supabase.from("lesson_progress").insert({lesson_id:e,student_id:s,...t,started_at:new Date().toISOString(),last_accessed_at:new Date().toISOString()}).select().single();if(i)throw i;return r}}async markLessonAsCompleted(e,s){return this.updateLessonProgress(e,s,{is_completed:!0,completion_percentage:100,completed_at:new Date().toISOString()})}async getQuiz(e){let{data:s,error:t}=await this.supabase.from("quizzes").select("*, questions:quiz_questions(*)").eq("id",e).single();if(t)throw t;return s}async createQuiz(e){let{data:s,error:t}=await this.supabase.from("quizzes").insert(e).select().single();if(t)throw t;return s}async createQuizQuestion(e){let{data:s,error:t}=await this.supabase.from("quiz_questions").insert(e).select().single();if(t)throw t;return s}async submitQuizAttempt(e){let s=await this.getQuiz(e.quiz_id);if(!s||!s.questions)throw Error("Quiz non trouvé");let t=s.questions,r=e.answers,i=0,a=t.length;t.forEach(e=>{let s=r[e.id],t={question_type:e.question_type,options:e.options,correct_answer:e.correct_answer};this.isAnswerCorrect(t,s)&&i++});let n=a>0?i/a*100:0,l=n>=(s.passing_score||70),{data:o,error:d}=await this.supabase.from("quiz_attempts").insert({...e,score:n,total_questions:a,correct_answers:i,is_passed:l,completed_at:new Date().toISOString()}).select().single();if(d)throw d;return o}isAnswerCorrect(e,s){switch(e.question_type){case"multiple_choice":let t=e.options,r=t?.find(e=>e.is_correct);return s===r?.text;case"true_false":return s===e.correct_answer;case"short_answer":return String(s||"").toLowerCase().trim()===String(e.correct_answer||"").toLowerCase().trim();default:return!1}}async getStudentQuizAttempts(e,s){let{data:t,error:r}=await this.supabase.from("quiz_attempts").select("*").eq("quiz_id",e).eq("student_id",s).order("started_at",{ascending:!1});if(r)throw r;return t}async getCourseAssignments(e){let{data:s,error:t}=await this.supabase.from("assignments").select("*").eq("course_id",e).order("created_at",{ascending:!1});if(t)throw t;return s}async createAssignment(e){let{data:s,error:t}=await this.supabase.from("assignments").insert(e).select().single();if(t)throw t;return s}async submitAssignment(e){let{data:s,error:t}=await this.supabase.from("assignment_submissions").insert(e).select().single();if(t)throw t;return s}async gradeAssignment(e,s,t,r){let{data:i,error:a}=await this.supabase.from("assignment_submissions").update({score:s,feedback:t,graded_by:r,graded_at:new Date().toISOString(),status:"graded"}).eq("id",e).select().single();if(a)throw a;return i}async generateCertificate(e,s){let{data:t}=await this.supabase.from("course_enrollments").select("*").eq("course_id",e).eq("student_id",s).eq("enrollment_status","completed").maybeSingle();if(!t)throw Error("Le cours doit être complété pour générer un certificat");let{data:r}=await this.supabase.from("course_certificates").select("*").eq("course_id",e).eq("student_id",s).maybeSingle();if(r)return r;let{data:i,error:a}=await this.supabase.from("course_certificates").insert({course_id:e,student_id:s,enrollment_id:t.id,certificate_number:""}).select().single();if(a)throw a;return i}async getStudentCertificates(e){let{data:s,error:t}=await this.supabase.from("course_certificates").select("*, course:courses(*)").eq("student_id",e).order("issued_at",{ascending:!1});if(t)throw t;return s}async createReview(e){let{data:s,error:t}=await this.supabase.from("course_reviews").insert(e).select().single();if(t)throw t;return s}async getCourseReviews(e){let{data:s,error:t}=await this.supabase.from("course_reviews").select("*, student:users(id, full_name, email)").eq("course_id",e).order("created_at",{ascending:!1});if(t)throw t;return s}async getCourseRatingStats(e){let{data:s,error:t}=await this.supabase.from("course_reviews").select("rating").eq("course_id",e);if(t)throw t;let r={total:s.length,average:0,distribution:{1:0,2:0,3:0,4:0,5:0}};if(s.length>0){let e=s.map(e=>e.rating).filter(Boolean);r.average=e.reduce((e,s)=>e+s,0)/e.length,e.forEach(e=>{r.distribution[e]++})}return r}};e.s(["elearningService",0,t])},788699,e=>{"use strict";let s=(0,e.i(475254).default)("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);e.s(["Pencil",()=>s],788699)},892696,e=>{"use strict";var s=e.i(843476),t=e.i(271645),r=e.i(618566),i=e.i(954616),a=e.i(266027),n=e.i(912598),l=e.i(653145),o=e.i(994814),d=e.i(50270),c=e.i(325715),u=e.i(186156),m=e.i(920755),h=e.i(167881),p=e.i(645760),g=e.i(630374),x=e.i(23750),b=e.i(184762),f=e.i(10708),y=e.i(871689),w=e.i(32095),j=e.i(356909),_=e.i(569074),v=e.i(37727),N=e.i(107233),q=e.i(788699),S=e.i(727612),C=e.i(810980),z=e.i(778917),k=e.i(522016),P=e.i(6799);e.i(882205);var L=e.i(846932),D=e.i(647163);let T=d.z.object({title:d.z.string().min(3,"Le titre doit contenir au moins 3 caractères"),slug:d.z.string().min(3,"Le slug doit contenir au moins 3 caractères").regex(/^[a-z0-9-]+$/,"Le slug ne peut contenir que des lettres minuscules, chiffres et tirets"),short_description:d.z.string().optional(),description:d.z.string().optional(),difficulty_level:d.z.enum(["beginner","intermediate","advanced"]).default("beginner"),estimated_duration_hours:d.z.number().min(0).optional(),price:d.z.number().min(0).optional(),currency:d.z.string().default("XOF"),is_published:d.z.boolean().default(!1),is_featured:d.z.boolean().default(!1),instructor_id:d.z.string().optional(),formation_id:d.z.string().optional()});function E(){let e=(0,r.useParams)(),d=(0,r.useRouter)(),E=e.slug,{user:A}=(0,c.useAuth)(),{addToast:F}=(0,P.useToast)(),B=(0,n.useQueryClient)(),R=(0,m.createClient)(),[I,O]=(0,t.useState)(null),[$,G]=(0,t.useState)(null),[M,U]=(0,t.useState)(!1),[Q,H]=(0,t.useState)(!1),[K,X]=(0,t.useState)({id:"",title:"",description:"",order_index:0}),{data:V,isLoading:J}=(0,a.useQuery)({queryKey:["course",E,A?.organization_id],queryFn:async()=>await u.elearningService.getCourseBySlug(E,A?.organization_id||""),enabled:!!E&&!!A?.organization_id}),Z=async()=>{await B.invalidateQueries({queryKey:["course",E,A?.organization_id]})},{data:W}=(0,a.useQuery)({queryKey:["teachers",A?.organization_id],queryFn:async()=>{let{data:e,error:s}=await R.from("users").select("id, full_name, email").eq("organization_id",A?.organization_id||"").eq("role","teacher").eq("is_active",!0);if(s)throw s;return e||[]},enabled:!!A?.organization_id}),{data:Y}=(0,a.useQuery)({queryKey:["formations",A?.organization_id],queryFn:async()=>{let{data:e,error:s}=await R.from("formations").select("id, name, code").eq("organization_id",A?.organization_id||"").eq("is_active",!0);if(s)throw s;return e||[]},enabled:!!A?.organization_id}),{register:ee,handleSubmit:es,formState:{errors:et},watch:er,setValue:ei,reset:ea}=(0,l.useForm)({resolver:(0,o.zodResolver)(T),mode:"onChange",defaultValues:{difficulty_level:"beginner",currency:"XOF",is_published:!1,is_featured:!1}});(0,t.useEffect)(()=>{V&&(ea({title:V.title||"",slug:V.slug||"",short_description:V.short_description||"",description:V.description||"",difficulty_level:V.difficulty_level||"beginner",estimated_duration_hours:V.estimated_duration_hours?Number(V.estimated_duration_hours):void 0,price:V.price?Number(V.price):0,currency:V.currency||"XOF",is_published:!!V.is_published,is_featured:!!V.is_featured,instructor_id:V.instructor_id||void 0,formation_id:V.formation_id||void 0}),V.thumbnail_url&&G(V.thumbnail_url))},[V,ea]);let en=(0,i.useMutation)({mutationFn:async e=>{if(!A?.organization_id)throw Error("Organization ID manquant");if(!V?.id)throw Error("Course ID manquant");let s=V.thumbnail_url||null;if(I){let e=I.name.split(".").pop(),t=`${A.organization_id}/courses/thumbnails/${Date.now()}.${e}`,r=null;for(let e of["course-thumbnails","elearning-media","course-media"]){let{error:i}=await R.storage.from(e).upload(t,I,{cacheControl:"3600",upsert:!1});if(!i){let{data:i}=R.storage.from(e).getPublicUrl(t);s=i.publicUrl,r=null;break}r=i}if(r)throw console.error("Erreur upload miniature (storage):",r),Error(r?.message||"Erreur lors de l'upload de la miniature (bucket course-thumbnails/elearning-media/course-media).")}let t=e.is_published?V.published_at||new Date().toISOString():null;return u.elearningService.updateCourse(V.id,{title:e.title,slug:e.slug,short_description:e.short_description||null,description:e.description||null,difficulty_level:e.difficulty_level,estimated_duration_hours:e.estimated_duration_hours||null,price:e.price||0,currency:e.currency,is_published:e.is_published,is_featured:e.is_featured,instructor_id:e.instructor_id||A.id,formation_id:e.formation_id||null,thumbnail_url:s,published_at:t})},onSuccess:async e=>{F({type:"success",title:"Séquence mise à jour",description:"La séquence a été mise à jour avec succès."}),await Z(),e?.slug&&e.slug!==E&&d.replace(`/dashboard/elearning/courses/${e.slug}/edit`)},onError:e=>{F({type:"error",title:"Erreur",description:e.message||"Une erreur est survenue lors de la mise à jour"})}}),el=(0,i.useMutation)({mutationFn:async()=>{if(!V?.id)throw Error("Course ID manquant");let e=Math.max(0,...(V.sections||[]).map(e=>Number(e.order_index??0)))+1;return u.elearningService.createSection({course_id:V.id,title:K.title,description:K.description||null,order_index:K.order_index??e})},onSuccess:async()=>{F({type:"success",title:"Section créée",description:"La section a été créée."}),U(!1),X({id:"",title:"",description:"",order_index:0}),await Z()},onError:e=>{F({type:"error",title:"Erreur",description:e?.message||"Impossible de créer la section."})}}),eo=(0,i.useMutation)({mutationFn:async()=>{if(!K.id)throw Error("Section ID manquant");return u.elearningService.updateSection(K.id,{title:K.title,description:K.description||null,order_index:K.order_index})},onSuccess:async()=>{F({type:"success",title:"Section mise à jour",description:"La section a été mise à jour."}),H(!1),X({id:"",title:"",description:"",order_index:0}),await Z()},onError:e=>{F({type:"error",title:"Erreur",description:e?.message||"Impossible de mettre à jour la section."})}}),ed=(0,i.useMutation)({mutationFn:async e=>{await u.elearningService.deleteSection(e)},onSuccess:async()=>{F({type:"success",title:"Section supprimée",description:"La section a été supprimée."}),await Z()},onError:e=>{F({type:"error",title:"Erreur",description:e?.message||"Impossible de supprimer la section."})}}),ec=(0,i.useMutation)({mutationFn:async e=>{await u.elearningService.deleteLesson(e)},onSuccess:async()=>{F({type:"success",title:"Leçon supprimée",description:"La leçon a été supprimée."}),await Z()},onError:e=>{F({type:"error",title:"Erreur",description:e?.message||"Impossible de supprimer la leçon."})}});if(J||!V)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[300px]",children:(0,s.jsx)("p",{children:"Chargement..."})});let eu=[...V.sections||[]].sort((e,s)=>Number(e.order_index??0)-Number(s.order_index??0)),em=[...V.lessons||[]].sort((e,s)=>Number(e.order_index??0)-Number(s.order_index??0)),eh=em.reduce((e,s)=>{let t=s.section_id||"no-section";return e[t]=e[t]||[],e[t].push(s),e},{});return(0,s.jsxs)(L.motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-8 pb-8 max-w-5xl mx-auto p-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(k.default,{href:`/dashboard/elearning/courses/${V.slug}`,children:(0,s.jsx)(h.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(y.ArrowLeft,{className:"h-4 w-4"})})}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 bg-brand-blue-ghost rounded-xl",children:(0,s.jsx)(w.GraduationCap,{className:"h-6 w-6 text-brand-blue"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Modifier la séquence"}),(0,s.jsx)("p",{className:"text-gray-500 mt-1",children:V.title})]})]})]}),(0,s.jsxs)("form",{onSubmit:es(e=>en.mutate(e)),className:"space-y-6",children:[(0,s.jsxs)(p.GlassCard,{variant:"premium",className:"p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Informations principales"}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Titre de la séquence *"}),(0,s.jsx)("input",{type:"text",...ee("title"),onChange:e=>{let s=e.target.value;ei("title",s),s&&ei("slug",s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""))},className:(0,D.cn)("w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all",et.title?"border-red-500":"border-gray-200"),placeholder:"Ex: Introduction à React"}),et.title&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:et.title.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slug (URL) *"}),(0,s.jsx)("input",{type:"text",...ee("slug"),className:(0,D.cn)("w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all bg-gray-50",et.slug?"border-red-500":"border-gray-200"),placeholder:"introduction-a-react"}),et.slug&&(0,s.jsx)("p",{className:"text-sm text-red-600 mt-1",children:et.slug.message}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"URL : /courses/[slug]"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description courte"}),(0,s.jsx)("textarea",{...ee("short_description"),rows:2,className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all resize-none"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description complète"}),(0,s.jsx)("textarea",{...ee("description"),rows:6,className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all resize-none"})]})]})]}),(0,s.jsxs)(p.GlassCard,{variant:"premium",className:"p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Paramètres"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Niveau de difficulté"}),(0,s.jsxs)("select",{...ee("difficulty_level"),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all",children:[(0,s.jsx)("option",{value:"beginner",children:"Débutant"}),(0,s.jsx)("option",{value:"intermediate",children:"Intermédiaire"}),(0,s.jsx)("option",{value:"advanced",children:"Avancé"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Durée estimée (heures)"}),(0,s.jsx)("input",{type:"number",...ee("estimated_duration_hours",{valueAsNumber:!0}),min:"0",step:"0.5",className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"number",...ee("price",{valueAsNumber:!0}),min:"0",step:"0.01",className:"flex-1 px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all"}),(0,s.jsxs)("select",{...ee("currency"),className:"w-24 px-3 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all",children:[(0,s.jsx)("option",{value:"XOF",children:"XOF"}),(0,s.jsx)("option",{value:"EUR",children:"EUR"}),(0,s.jsx)("option",{value:"USD",children:"USD"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enseignant"}),(0,s.jsxs)("select",{...ee("instructor_id"),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all",children:[(0,s.jsx)("option",{value:"",children:"Moi-même"}),W?.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.full_name," (",e.email,")"]},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Formation associée (optionnel)"}),(0,s.jsxs)("select",{...ee("formation_id"),className:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-brand-blue focus:border-transparent transition-all",children:[(0,s.jsx)("option",{value:"",children:"Aucune"}),Y?.map(e=>(0,s.jsxs)("option",{value:e.id,children:[e.name," (",e.code,")"]},e.id))]})]})]})]}),(0,s.jsxs)(p.GlassCard,{variant:"premium",className:"p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Miniature"}),(0,s.jsx)("div",{className:"space-y-4",children:$?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:$,alt:"Aperçu",className:"w-full h-64 object-cover rounded-lg border border-gray-200"}),(0,s.jsx)("button",{type:"button",onClick:()=>{O(null),G(null)},className:"absolute top-2 right-2 p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",children:(0,s.jsx)(v.X,{className:"h-4 w-4"})})]}):(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-12 text-center hover:border-brand-blue transition-colors",children:[(0,s.jsx)(_.Upload,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600 mb-2",children:"Cliquez pour télécharger une miniature"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"PNG, JPG jusqu'à 5MB"}),(0,s.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{let s=e.target.files?.[0];if(s){O(s);let e=new FileReader;e.onloadend=()=>G(e.result),e.readAsDataURL(s)}},className:"hidden",id:"thumbnail-upload"}),(0,s.jsx)("label",{htmlFor:"thumbnail-upload",className:"mt-4 inline-block px-4 py-2 bg-brand-blue text-white rounded-lg hover:bg-brand-blue/90 transition-colors cursor-pointer",children:"Choisir un fichier"})]})})]}),(0,s.jsxs)(p.GlassCard,{variant:"premium",className:"p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Options de publication"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",...ee("is_published"),className:"w-5 h-5 text-brand-blue border-gray-300 rounded focus:ring-brand-blue"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-gray-900",children:"Visible pour les apprenants"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Publier la séquence sur le catalogue apprenant"})]})]}),(0,s.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",...ee("is_featured"),className:"w-5 h-5 text-brand-blue border-gray-300 rounded focus:ring-brand-blue"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium text-gray-900",children:"Mettre en vedette"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Afficher dans la sélection du moment"})]})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,s.jsx)(k.default,{href:`/dashboard/elearning/courses/${V.slug}`,children:(0,s.jsx)(h.Button,{variant:"ghost",type:"button",children:"Annuler"})}),(0,s.jsx)(h.Button,{type:"submit",disabled:en.isPending,className:"bg-brand-blue hover:bg-brand-blue/90 text-white shadow-lg shadow-brand-blue/20",children:en.isPending?(0,s.jsx)(s.Fragment,{children:"Enregistrement..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.Save,{className:"h-4 w-4 mr-2"}),"Enregistrer"]})})]})]}),(0,s.jsxs)(p.GlassCard,{variant:"premium",className:"p-6",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3 mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Contenu de la séquence"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Gérez les sections et les leçons en défilant sur cette même page."})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsxs)(h.Button,{type:"button",variant:"outline",onClick:()=>U(!0),children:[(0,s.jsx)(N.Plus,{className:"h-4 w-4 mr-2"}),"Nouvelle section"]}),(0,s.jsx)(k.default,{href:`/dashboard/elearning/courses/${V.slug}/lessons/new`,children:(0,s.jsxs)(h.Button,{type:"button",className:"bg-brand-blue hover:bg-brand-blue/90 text-white",children:[(0,s.jsx)(N.Plus,{className:"h-4 w-4 mr-2"}),"Nouvelle leçon"]})})]})]}),(0,s.jsx)("div",{className:"space-y-6",children:0===eu.length&&0===em.length?(0,s.jsxs)("div",{className:"text-center py-10 border-2 border-dashed border-gray-200 rounded-xl",children:[(0,s.jsx)(C.BookOpen,{className:"h-10 w-10 text-gray-300 mx-auto mb-3"}),(0,s.jsx)("p",{className:"text-gray-600 font-medium",children:"Aucune section / leçon pour le moment"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Crée une section puis ajoute des leçons."})]}):(0,s.jsxs)(s.Fragment,{children:[eu.map(e=>{let t=eh[e.id]||[];return(0,s.jsxs)("div",{className:"border border-gray-200 rounded-xl bg-white",children:[(0,s.jsxs)("div",{className:"p-4 flex flex-col md:flex-row md:items-center justify-between gap-3 border-b border-gray-100",children:[(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("p",{className:"font-semibold text-gray-900 truncate",children:e.title}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:"•"}),(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:[t.length," leçon(s)"]})]}),e.description?(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1 line-clamp-2",children:e.description}):null]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsxs)(h.Button,{type:"button",variant:"outline",onClick:()=>{X({id:e.id,title:e.title||"",description:e.description||"",order_index:Number(e.order_index??0)}),H(!0)},children:[(0,s.jsx)(q.Pencil,{className:"h-4 w-4 mr-2"}),"Modifier"]}),(0,s.jsx)(k.default,{href:`/dashboard/elearning/courses/${V.slug}/lessons/new`,children:(0,s.jsxs)(h.Button,{type:"button",variant:"outline",children:[(0,s.jsx)(N.Plus,{className:"h-4 w-4 mr-2"}),"Ajouter une leçon"]})}),(0,s.jsxs)(h.Button,{type:"button",variant:"outline",className:"border-red-200 text-red-700 hover:bg-red-50",onClick:()=>{window.confirm(`Supprimer la section "${e.title}" ? Les le\xe7ons seront conserv\xe9es (sans section).`)&&ed.mutate(e.id)},disabled:ed.isPending,children:[(0,s.jsx)(S.Trash2,{className:"h-4 w-4 mr-2"}),"Supprimer"]})]})]}),(0,s.jsx)("div",{className:"p-4 space-y-2",children:0===t.length?(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Aucune leçon dans cette section."}):t.map(e=>(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-2 p-3 border rounded-lg",children:[(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("p",{className:"font-medium text-gray-900 truncate",children:e.title}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:["Type: ",e.lesson_type||"text"," • Ordre: ",e.order_index??0]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)(k.default,{href:`/dashboard/elearning/courses/${V.slug}/lessons/${e.slug}`,children:(0,s.jsxs)(h.Button,{type:"button",variant:"outline",size:"sm",children:[(0,s.jsx)(z.ExternalLink,{className:"h-4 w-4 mr-2"}),"Ouvrir"]})}),(0,s.jsx)(k.default,{href:`/dashboard/elearning/courses/${V.slug}/lessons/${e.slug}/edit`,children:(0,s.jsxs)(h.Button,{type:"button",variant:"outline",size:"sm",children:[(0,s.jsx)(q.Pencil,{className:"h-4 w-4 mr-2"}),"Modifier la leçon"]})}),(0,s.jsxs)(h.Button,{type:"button",variant:"outline",size:"sm",className:"border-red-200 text-red-700 hover:bg-red-50",onClick:()=>{window.confirm(`Supprimer la le\xe7on "${e.title}" ?`)&&ec.mutate(e.id)},disabled:ec.isPending,children:[(0,s.jsx)(S.Trash2,{className:"h-4 w-4 mr-2"}),"Supprimer"]})]})]},e.id))})]},e.id)}),eh["no-section"]?.length?(0,s.jsxs)("div",{className:"border border-gray-200 rounded-xl bg-white",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-gray-100",children:[(0,s.jsx)("p",{className:"font-semibold text-gray-900",children:"Sans section"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Leçons non rattachées à une section."})]}),(0,s.jsx)("div",{className:"p-4 space-y-2",children:eh["no-section"].map(e=>(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-2 p-3 border rounded-lg",children:[(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("p",{className:"font-medium text-gray-900 truncate",children:e.title}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-0.5",children:["Type: ",e.lesson_type||"text"," • Ordre: ",e.order_index??0]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)(k.default,{href:`/dashboard/elearning/courses/${V.slug}/lessons/${e.slug}`,children:(0,s.jsxs)(h.Button,{type:"button",variant:"outline",size:"sm",children:[(0,s.jsx)(z.ExternalLink,{className:"h-4 w-4 mr-2"}),"Ouvrir"]})}),(0,s.jsx)(k.default,{href:`/dashboard/elearning/courses/${V.slug}/lessons/${e.slug}/edit`,children:(0,s.jsxs)(h.Button,{type:"button",variant:"outline",size:"sm",children:[(0,s.jsx)(q.Pencil,{className:"h-4 w-4 mr-2"}),"Modifier la leçon"]})}),(0,s.jsxs)(h.Button,{type:"button",variant:"outline",size:"sm",className:"border-red-200 text-red-700 hover:bg-red-50",onClick:()=>{window.confirm(`Supprimer la le\xe7on "${e.title}" ?`)&&ec.mutate(e.id)},disabled:ec.isPending,children:[(0,s.jsx)(S.Trash2,{className:"h-4 w-4 mr-2"}),"Supprimer"]})]})]},e.id))})]}):null]})})]}),(0,s.jsx)(g.Dialog,{open:M,onOpenChange:U,children:(0,s.jsxs)(g.DialogContent,{className:"sm:max-w-[520px]",children:[(0,s.jsxs)(g.DialogHeader,{children:[(0,s.jsx)(g.DialogTitle,{children:"Nouvelle section"}),(0,s.jsx)(g.DialogDescription,{children:"Ajoute une section pour organiser les leçons."})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"section-title",children:"Titre *"}),(0,s.jsx)(x.Input,{id:"section-title",value:K.title,onChange:e=>X(s=>({...s,title:e.target.value})),placeholder:"Ex: Module 1"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"section-desc",children:"Description"}),(0,s.jsx)(b.Textarea,{id:"section-desc",value:K.description,onChange:e=>X(s=>({...s,description:e.target.value})),placeholder:"Description de la section..."})]})]}),(0,s.jsxs)(g.DialogFooter,{children:[(0,s.jsx)(h.Button,{type:"button",variant:"outline",onClick:()=>U(!1),children:"Annuler"}),(0,s.jsx)(h.Button,{type:"button",onClick:()=>{K.title.trim()?el.mutate():F({type:"error",title:"Titre requis",description:"Veuillez saisir un titre."})},disabled:el.isPending,children:el.isPending?"Création...":"Créer"})]})]})}),(0,s.jsx)(g.Dialog,{open:Q,onOpenChange:H,children:(0,s.jsxs)(g.DialogContent,{className:"sm:max-w-[520px]",children:[(0,s.jsxs)(g.DialogHeader,{children:[(0,s.jsx)(g.DialogTitle,{children:"Modifier la section"}),(0,s.jsx)(g.DialogDescription,{children:"Met à jour le titre et la description."})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"section-title-edit",children:"Titre *"}),(0,s.jsx)(x.Input,{id:"section-title-edit",value:K.title,onChange:e=>X(s=>({...s,title:e.target.value}))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"section-desc-edit",children:"Description"}),(0,s.jsx)(b.Textarea,{id:"section-desc-edit",value:K.description,onChange:e=>X(s=>({...s,description:e.target.value}))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"section-order",children:"Ordre"}),(0,s.jsx)(x.Input,{id:"section-order",type:"number",value:K.order_index,onChange:e=>X(s=>({...s,order_index:Number(e.target.value||0)}))})]})]}),(0,s.jsxs)(g.DialogFooter,{children:[(0,s.jsx)(h.Button,{type:"button",variant:"outline",onClick:()=>H(!1),children:"Annuler"}),(0,s.jsx)(h.Button,{type:"button",onClick:()=>{K.title.trim()?eo.mutate():F({type:"error",title:"Titre requis",description:"Veuillez saisir un titre."})},disabled:eo.isPending,children:eo.isPending?"Enregistrement...":"Enregistrer"})]})]})})]})}e.s(["default",()=>E])}]);