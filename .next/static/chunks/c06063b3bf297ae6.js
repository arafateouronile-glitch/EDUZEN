(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,503116,e=>{"use strict";let s=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>s],503116)},645760,e=>{"use strict";var s=e.i(843476),a=e.i(271645),t=e.i(647163);e.i(882205);var l=e.i(846932);let i=a.forwardRef(({className:e,variant:a="default",hoverable:i=!1,glow:r=!1,glowColor:d="rgba(51, 90, 207, 0.3)",...n},o)=>(0,s.jsxs)(l.motion.div,{ref:o,className:(0,t.cn)("relative rounded-2xl border backdrop-blur-xl transition-all duration-300",{"bg-white/70 dark:bg-gray-900/70 border-white/20 dark:border-gray-700/30 shadow-lg":"default"===a,"bg-white/80 dark:bg-gray-900/80 border-white/30 dark:border-gray-700/40 shadow-xl":"premium"===a,"bg-white/50 dark:bg-gray-900/50 border-white/10 dark:border-gray-700/20 shadow-md":"subtle"===a,"cursor-pointer":i,"hover:shadow-2xl hover:scale-[1.02]":i,"hover:bg-white/90 dark:hover:bg-gray-900/90":i},e),whileHover:i?{scale:1.02,y:-2}:void 0,transition:{type:"spring",stiffness:300,damping:30},...n,children:[r&&(0,s.jsx)(l.motion.div,{className:"absolute inset-0 rounded-2xl opacity-0 blur-xl",style:{background:`radial-gradient(circle, ${d} 0%, transparent 70%)`},animate:{opacity:[0,.5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"}}),(0,s.jsx)("div",{className:"relative z-10",children:n.children})]}));i.displayName="GlassCard",e.s(["GlassCard",()=>i])},810980,e=>{"use strict";let s=(0,e.i(475254).default)("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);e.s(["BookOpen",()=>s],810980)},356909,e=>{"use strict";let s=(0,e.i(475254).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);e.s(["Save",()=>s],356909)},10708,e=>{"use strict";var s=e.i(843476),a=e.i(271645),t=e.i(647163);let l=a.forwardRef(({className:e,...a},l)=>(0,s.jsx)("label",{ref:l,className:(0,t.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-text-primary",e),...a}));l.displayName="Label",e.s(["Label",0,l])},184762,e=>{"use strict";var s=e.i(843476),a=e.i(271645),t=e.i(647163);let l=a.forwardRef(({className:e,...a},l)=>(0,s.jsx)("textarea",{className:(0,t.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:l,...a}));l.displayName="Textarea",e.s(["Textarea",()=>l])},263488,e=>{"use strict";let s=(0,e.i(475254).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);e.s(["Mail",()=>s],263488)},98919,e=>{"use strict";let s=(0,e.i(475254).default)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);e.s(["Shield",()=>s],98919)},270756,e=>{"use strict";let s=(0,e.i(475254).default)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);e.s(["Lock",()=>s],270756)},344613,e=>{"use strict";var s=e.i(843476),a=e.i(266027),t=e.i(954616),l=e.i(912598),i=e.i(271645),r=e.i(383801),d=e.i(267824),n=e.i(645760),o=e.i(167881),c=e.i(23750),m=e.i(10708),x=e.i(184762),h=e.i(6799);e.i(882205);var u=e.i(846932),p=e.i(284614),b=e.i(263488),g=e.i(87316),f=e.i(475254);let y=(0,f.default)("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);var j=e.i(356909),v=e.i(37727);let N=(0,f.default)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var _=e.i(98919),w=e.i(226691),k=e.i(270756),C=e.i(842009),L=e.i(810980),S=e.i(503116),M=e.i(647163);function B(){let{student:e,studentId:f}=(0,r.useLearnerContext)(),B=(0,i.useMemo)(()=>f?(0,d.createLearnerClient)(f):null,[f]),I=(0,l.useQueryClient)(),{addToast:P}=(0,h.useToast)(),[G,q]=(0,i.useState)(!1),T=!e,[z,E]=(0,i.useState)({first_name:"",last_name:"",email:"",phone:"",address:"",city:"",postal_code:"",country:"",date_of_birth:"",bio:""});(0,i.useState)(()=>{e&&E({first_name:e.first_name||"",last_name:e.last_name||"",email:e.email||"",phone:e.phone||"",address:e.address||"",city:e.city||"",postal_code:e.postal_code||"",country:e.country||"",date_of_birth:e.date_of_birth||"",bio:e.bio||""})});let{data:A}=(0,a.useQuery)({queryKey:["learner-profile-stats",e?.id],queryFn:async()=>{if(!e?.id)return null;if(!B)return{enrollments:0,courses:0,certificates:0};let[s,a,t]=await Promise.all([B.from("enrollments").select("id, status").eq("student_id",e.id),Promise.resolve({data:[],error:null}),B.from("course_certificates").select("id").eq("student_id",e.id)]);return{totalSessions:s.data?.length||0,completedSessions:s.data?.filter(e=>"completed"===e.status).length||0,totalCourses:a.data?.length||0,completedCourses:a.data?.filter(e=>"completed"===e.status).length||0,certificates:t.data?.length||0}},enabled:!!e?.id}),O=(0,t.useMutation)({mutationFn:async s=>{if(!e?.id)throw Error("Student not found");if(!B)throw Error("Supabase client not available");let{error:a}=await B.from("students").update({first_name:s.first_name,last_name:s.last_name,phone:s.phone,address:s.address,city:s.city,postal_code:s.postal_code,country:s.country,date_of_birth:s.date_of_birth||null,bio:s.bio}).eq("id",e.id);if(a)throw a},onSuccess:()=>{I.invalidateQueries({queryKey:["learner-profile"]}),q(!1),P({type:"success",title:"Profil mis à jour",description:"Vos informations ont été enregistrées."})},onError:e=>{P({type:"error",title:"Erreur",description:"Impossible de mettre à jour le profil."})}}),R=e=>{e.preventDefault(),O.mutate(z)},V={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5}}};return T?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"h-48 bg-gray-100 rounded-2xl animate-pulse"}),(0,s.jsx)("div",{className:"h-96 bg-gray-100 rounded-2xl animate-pulse"})]}):(0,s.jsxs)(u.motion.div,{className:"space-y-6 pb-24 lg:pb-8",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},initial:"hidden",animate:"visible",children:[(0,s.jsx)(u.motion.div,{variants:V,children:(0,s.jsx)(n.GlassCard,{variant:"premium",className:"p-6 md:p-8 bg-gradient-to-r from-brand-blue/5 via-indigo-50/50 to-purple-50/30",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-24 h-24 md:w-32 md:h-32 rounded-full bg-gradient-to-br from-brand-blue to-indigo-600 flex items-center justify-center text-white text-3xl md:text-4xl font-bold shadow-xl",children:e?.photo_url?(0,s.jsx)("img",{src:e.photo_url,alt:"Photo",className:"w-full h-full rounded-full object-cover"}):(0,s.jsxs)(s.Fragment,{children:[e?.first_name?.[0],e?.last_name?.[0]]})}),(0,s.jsx)("button",{className:"absolute bottom-0 right-0 p-2 bg-white rounded-full shadow-lg hover:bg-gray-50 transition-colors",children:(0,s.jsx)(N,{className:"h-4 w-4 text-gray-600"})})]}),(0,s.jsxs)("div",{className:"text-center md:text-left flex-1",children:[(0,s.jsxs)("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:[e?.first_name," ",e?.last_name]}),(0,s.jsxs)("p",{className:"text-gray-500 mt-1",children:["N° ",e?.student_number]}),e?.email&&(0,s.jsxs)("p",{className:"text-gray-500 text-sm mt-2 flex items-center justify-center md:justify-start gap-2",children:[(0,s.jsx)(b.Mail,{className:"h-4 w-4"}),e.email]})]}),(0,s.jsx)("div",{children:G?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(o.Button,{variant:"outline",onClick:()=>q(!1),children:[(0,s.jsx)(v.X,{className:"h-4 w-4 mr-2"}),"Annuler"]}),(0,s.jsxs)(o.Button,{onClick:R,disabled:O.isPending,children:[(0,s.jsx)(j.Save,{className:"h-4 w-4 mr-2"}),O.isPending?"Enregistrement...":"Enregistrer"]})]}):(0,s.jsxs)(o.Button,{onClick:()=>{E({first_name:e?.first_name||"",last_name:e?.last_name||"",email:e?.email||"",phone:e?.phone||"",address:e?.address||"",city:e?.city||"",postal_code:e?.postal_code||"",country:e?.country||"",date_of_birth:e?.date_of_birth||"",bio:e.bio||""}),q(!0)},children:[(0,s.jsx)(y,{className:"h-4 w-4 mr-2"}),"Modifier"]})})]})})}),(0,s.jsxs)(u.motion.div,{variants:V,className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,s.jsxs)(n.GlassCard,{className:"p-4 text-center",children:[(0,s.jsx)(L.BookOpen,{className:"h-6 w-6 text-brand-blue mx-auto mb-2"}),(0,s.jsx)("div",{className:"text-xl font-bold text-gray-900",children:A?.totalSessions||0}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Sessions"})]}),(0,s.jsxs)(n.GlassCard,{className:"p-4 text-center",children:[(0,s.jsx)(L.BookOpen,{className:"h-6 w-6 text-purple-600 mx-auto mb-2"}),(0,s.jsx)("div",{className:"text-xl font-bold text-gray-900",children:A?.totalCourses||0}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Cours"})]}),(0,s.jsxs)(n.GlassCard,{className:"p-4 text-center",children:[(0,s.jsx)(C.Award,{className:"h-6 w-6 text-amber-600 mx-auto mb-2"}),(0,s.jsx)("div",{className:"text-xl font-bold text-gray-900",children:A?.certificates||0}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Certificats"})]}),(0,s.jsxs)(n.GlassCard,{className:"p-4 text-center",children:[(0,s.jsx)(S.Clock,{className:"h-6 w-6 text-green-600 mx-auto mb-2"}),(0,s.jsx)("div",{className:"text-xl font-bold text-gray-900",children:A?.completedSessions||0}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Terminées"})]}),(0,s.jsxs)(n.GlassCard,{className:"p-4 text-center",children:[(0,s.jsx)(g.Calendar,{className:"h-6 w-6 text-blue-600 mx-auto mb-2"}),(0,s.jsx)("div",{className:"text-xl font-bold text-gray-900",children:e?.created_at?(0,M.formatDate)(e.created_at).split("/")[2]:"-"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Membre depuis"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,s.jsx)(u.motion.div,{variants:V,className:"lg:col-span-2",children:(0,s.jsxs)(n.GlassCard,{className:"p-6",children:[(0,s.jsxs)("h2",{className:"text-lg font-bold text-gray-900 mb-6 flex items-center gap-2",children:[(0,s.jsx)(p.User,{className:"h-5 w-5 text-brand-blue"}),"Informations personnelles"]}),(0,s.jsxs)("form",{onSubmit:R,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{children:"Prénom"}),(0,s.jsx)(c.Input,{value:G?z.first_name:e?.first_name||"",onChange:e=>E({...z,first_name:e.target.value}),disabled:!G,className:"mt-1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{children:"Nom"}),(0,s.jsx)(c.Input,{value:G?z.last_name:e?.last_name||"",onChange:e=>E({...z,last_name:e.target.value}),disabled:!G,className:"mt-1"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{children:"Email"}),(0,s.jsx)(c.Input,{type:"email",value:e?.email||"",disabled:!0,className:"mt-1 bg-gray-50"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"L'email ne peut pas être modifié"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{children:"Téléphone"}),(0,s.jsx)(c.Input,{value:G?z.phone:e?.phone||"",onChange:e=>E({...z,phone:e.target.value}),disabled:!G,className:"mt-1"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{children:"Date de naissance"}),(0,s.jsx)(c.Input,{type:"date",value:G?z.date_of_birth:e?.date_of_birth||"",onChange:e=>E({...z,date_of_birth:e.target.value}),disabled:!G,className:"mt-1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{children:"Adresse"}),(0,s.jsx)(c.Input,{value:G?z.address:e?.address||"",onChange:e=>E({...z,address:e.target.value}),disabled:!G,className:"mt-1"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{children:"Ville"}),(0,s.jsx)(c.Input,{value:G?z.city:e?.city||"",onChange:e=>E({...z,city:e.target.value}),disabled:!G,className:"mt-1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{children:"Code postal"}),(0,s.jsx)(c.Input,{value:G?z.postal_code:e?.postal_code||"",onChange:e=>E({...z,postal_code:e.target.value}),disabled:!G,className:"mt-1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{children:"Pays"}),(0,s.jsx)(c.Input,{value:G?z.country:e?.country||"",onChange:e=>E({...z,country:e.target.value}),disabled:!G,className:"mt-1"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m.Label,{children:"Bio / À propos"}),(0,s.jsx)(x.Textarea,{value:G?z.bio:e?.bio||"",onChange:e=>E({...z,bio:e.target.value}),disabled:!G,className:"mt-1",rows:4,placeholder:"Parlez-nous de vous..."})]})]})]})}),(0,s.jsxs)(u.motion.div,{variants:V,className:"space-y-4",children:[(0,s.jsxs)(n.GlassCard,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[(0,s.jsx)(_.Shield,{className:"h-5 w-5 text-brand-blue"}),"Sécurité"]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)(o.Button,{variant:"outline",className:"w-full justify-start",children:[(0,s.jsx)(k.Lock,{className:"h-4 w-4 mr-2"}),"Changer le mot de passe"]}),(0,s.jsxs)(o.Button,{variant:"outline",className:"w-full justify-start",children:[(0,s.jsx)(_.Shield,{className:"h-4 w-4 mr-2"}),"Authentification 2FA"]})]})]}),(0,s.jsxs)(n.GlassCard,{className:"p-6",children:[(0,s.jsxs)("h3",{className:"font-bold text-gray-900 mb-4 flex items-center gap-2",children:[(0,s.jsx)(w.Bell,{className:"h-5 w-5 text-brand-blue"}),"Notifications"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Emails de rappel"}),(0,s.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Notifications push"}),(0,s.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:"Résumé hebdomadaire"}),(0,s.jsx)("input",{type:"checkbox",className:"rounded"})]})]})]})]})]})]})}e.s(["default",()=>B],344613)}]);