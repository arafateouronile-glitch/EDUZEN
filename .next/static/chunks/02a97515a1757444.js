(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,871689,e=>{"use strict";let r=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>r],871689)},356909,e=>{"use strict";let r=(0,e.i(475254).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);e.s(["Save",()=>r],356909)},263488,e=>{"use strict";let r=(0,e.i(475254).default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);e.s(["Mail",()=>r],263488)},569074,e=>{"use strict";let r=(0,e.i(475254).default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);e.s(["Upload",()=>r],569074)},246704,779478,e=>{"use strict";var r,t,a=e.i(790224),s=((r={}).AUTH_REQUIRED="AUTH_1001",r.AUTH_INVALID_CREDENTIALS="AUTH_1002",r.AUTH_SESSION_EXPIRED="AUTH_1003",r.AUTH_INSUFFICIENT_PERMISSIONS="AUTH_1004",r.AUTH_2FA_REQUIRED="AUTH_1005",r.AUTH_2FA_INVALID="AUTH_1006",r.VALIDATION_ERROR="VALID_2001",r.VALIDATION_REQUIRED_FIELD="VALID_2002",r.VALIDATION_INVALID_FORMAT="VALID_2003",r.VALIDATION_UNIQUE_CONSTRAINT="VALID_2004",r.DB_CONNECTION_ERROR="DB_3001",r.DB_QUERY_ERROR="DB_3002",r.DB_NOT_FOUND="DB_3003",r.DB_CONSTRAINT_VIOLATION="DB_3004",r.DB_FOREIGN_KEY_CONSTRAINT="DB_3006",r.DB_RLS_POLICY_VIOLATION="DB_3005",r.NETWORK_ERROR="NET_4001",r.API_TIMEOUT="NET_4002",r.API_RATE_LIMIT="NET_4003",r.API_SERVER_ERROR="NET_4004",r.API_NOT_FOUND="NET_4005",r.API_BAD_REQUEST="NET_4006",r.BUSINESS_LOGIC_ERROR="BIZ_5001",r.RESOURCE_LOCKED="BIZ_5002",r.OPERATION_NOT_ALLOWED="BIZ_5003",r.QUOTA_EXCEEDED="BIZ_5004",r.INTERNAL_ERROR="SYS_6001",r.CONFIGURATION_ERROR="SYS_6002",r.SERVICE_UNAVAILABLE="SYS_6003",r);(t={}).LOW="low",t.MEDIUM="medium",t.HIGH="high",t.CRITICAL="critical";class i extends Error{code;severity;userMessage;retryable;context;originalError;constructor(e,r="SYS_6001",t="medium",a={},s){super(e),this.name="AppError",this.code=r,this.severity=t,this.userMessage=a.userMessage||this.getDefaultUserMessage(r),this.retryable=a.retryable??this.isRetryable(r),this.context={...a,code:r,severity:t,timestamp:new Date().toISOString()},this.originalError=s,Error.captureStackTrace&&Error.captureStackTrace(this,i)}getDefaultUserMessage(e){return({AUTH_1001:"Vous devez être connecté pour effectuer cette action.",AUTH_1002:"Email ou mot de passe incorrect.",AUTH_1003:"Votre session a expiré. Veuillez vous reconnecter.",AUTH_1004:"Vous n'avez pas les permissions nécessaires.",AUTH_1005:"Authentification à deux facteurs requise.",AUTH_1006:"Code d'authentification invalide.",VALID_2001:"Les données fournies ne sont pas valides.",VALID_2002:"Certains champs obligatoires sont manquants.",VALID_2003:"Le format des données est incorrect.",VALID_2004:"Cette valeur existe déjà.",DB_3001:"Impossible de se connecter à la base de données.",DB_3002:"Erreur lors de l'exécution de la requête.",DB_3003:"Ressource introuvable.",DB_3004:"Cette opération viole une contrainte de la base de données.",DB_3006:"Cette opération viole une contrainte de clé étrangère.",DB_3005:"Vous n'avez pas accès à cette ressource.",NET_4001:"Erreur de connexion réseau. Vérifiez votre connexion internet.",NET_4002:"La requête a pris trop de temps. Veuillez réessayer.",NET_4003:"Trop de requêtes. Veuillez patienter quelques instants.",NET_4004:"Erreur serveur. Veuillez réessayer plus tard.",NET_4005:"Ressource introuvable.",NET_4006:"Requête invalide.",BIZ_5001:"Cette opération n'est pas autorisée dans le contexte actuel.",BIZ_5002:"Cette ressource est actuellement verrouillée.",BIZ_5003:"Cette opération n'est pas autorisée.",BIZ_5004:"Vous avez atteint la limite autorisée.",SYS_6001:"Une erreur interne est survenue. Veuillez réessayer.",SYS_6002:"Erreur de configuration du système.",SYS_6003:"Service temporairement indisponible."})[e]||"Une erreur inattendue est survenue."}isRetryable(e){return["NET_4001","NET_4002","NET_4004","DB_3001","SYS_6003"].includes(e)}toJSON(){return{name:this.name,message:this.message,code:this.code,severity:this.severity,userMessage:this.userMessage,retryable:this.retryable,context:this.context,stack:this.stack,originalError:this.originalError instanceof Error?{name:this.originalError.name,message:this.originalError.message,stack:this.originalError.stack}:this.originalError}}}let n=new class{handleError(e,r={}){if(e instanceof i)return this.logError(e),e;if(e instanceof Error)return this.handleStandardError(e,r);if(this.isSupabaseError(e))return this.handleSupabaseError(e,r);let t=new i("Une erreur inattendue est survenue.","SYS_6001","high",r,e);return this.logError(t),t}handleStandardError(e,r){let t=e.message.toLowerCase(),a="SYS_6001",s="medium";t.includes("network")||t.includes("fetch")?(a="NET_4001",s="medium"):t.includes("timeout")?(a="NET_4002",s="medium"):t.includes("unauthorized")||t.includes("401")?(a="AUTH_1001",s="high"):t.includes("forbidden")||t.includes("403")?(a="AUTH_1004",s="high"):t.includes("not found")||t.includes("404")?(a="DB_3003",s="low"):(t.includes("validation")||t.includes("invalid"))&&(a="VALID_2001",s="low");let n=new i(e.message,a,s,r,e);return this.logError(n),n}handleSupabaseError(e,r){let t=e.code||e.status,a=e.message||"Erreur Supabase",s=r.code||"DB_3002",n="medium";if(!r.code)switch(t){case"PGRST116":case"42P01":s="DB_3003",n="low";break;case"42501":s="DB_3005",n="high";break;case"23505":s="VALID_2004",n="low";break;case"23503":s="DB_3004",n="medium";break;case"PGRST301":case"400":s="NET_4006",n="low";break;case"401":s="AUTH_1001",n="high";break;case"403":s="AUTH_1004",n="high";break;case"404":s="NET_4005",n="low";break;case"500":s="NET_4004",n="high"}"DB_3006"===s&&(n="medium");let o=new i(a,s,n,r,e);return this.logError(o),o}isSupabaseError(e){return e&&(e.code||e.status||e.message)&&("string"==typeof e.code||"number"==typeof e.status)}logError(e){let r={...e.context,code:e.code,severity:e.severity,retryable:e.retryable};switch(e.severity){case"critical":case"high":a.logger.error(e.message,e.originalError||e,r);break;case"medium":a.logger.warn(e.message,r);break;case"low":a.logger.info(`Error: ${e.message}`,r)}}createValidationError(e,r){return new i(e,"VALID_2001","low",{field:r,userMessage:e})}createAuthError(e,r){return new i(r||"Erreur d'authentification",e,"high")}createDatabaseError(e,r){return new i(e,"DB_3002","medium",{},r)}createNotFoundError(e,r){return new i(e,"DB_3003","low",r)}};e.s(["AppError",()=>i,"ErrorCode",()=>s,"errorHandler",0,n],779478),e.s([],246704)},232189,(e,r,t)=>{"use strict";r.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},865156,(e,r,t)=>{"use strict";var a=e.r(232189);function s(){}function i(){}i.resetWarningCache=s,r.exports=function(){function e(e,r,t,s,i,n){if(n!==a){var o=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function r(){return e}e.isRequired=e;var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:r,element:e,elementType:e,instanceOf:r,node:e,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:i,resetWarningCache:s};return t.PropTypes=t,t}},745009,(e,r,t)=>{r.exports=e.r(865156)()},514764,e=>{"use strict";let r=(0,e.i(475254).default)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);e.s(["Send",()=>r],514764)},62870,e=>{"use strict";var r=e.i(843476),t=e.i(271645),a=e.i(647163);e.i(882205);var s=e.i(846932),i=e.i(88653),n=e.i(664659),o=e.i(898791);t.forwardRef(({className:e,label:l,error:d,helperText:c,variant:u="default",leftIcon:m,id:h,options:p,placeholder:g,value:f,...x},_)=>{let[E,b]=t.useState(!1),[y,N]=t.useState(!1),v=h||`select-${Math.random().toString(36).substr(2,9)}`,T=(0,a.cn)("flex w-full rounded-lg font-medium transition-all duration-300","appearance-none cursor-pointer","focus:outline-none focus:ring-2 focus:ring-primary/20","disabled:cursor-not-allowed disabled:opacity-50",{"border-2 border-input bg-background px-4 py-3 pr-11":"default"===u,"focus:border-primary focus:bg-white":"default"===u&&!d,"border-destructive focus:border-destructive focus:ring-destructive/20":d,"border-2 border-input bg-transparent px-4 py-3 pr-11":"outlined"===u,"focus:border-primary focus:shadow-md focus:shadow-primary/10":"outlined"===u&&!d,"border-0 border-b-2 border-input bg-muted/50 px-4 py-3 pr-11 rounded-b-none":"filled"===u,"focus:bg-muted focus:border-primary":"filled"===u&&!d,"focus:border-destructive bg-destructive/5":"filled"===u&&d},m&&"pl-11",e);return(0,r.jsxs)("div",{className:"w-full space-y-1.5",children:[l&&(0,r.jsxs)(s.motion.label,{htmlFor:v,initial:!1,animate:{color:d?"#EF4444":E?"rgb(37, 99, 235)":"rgb(107, 114, 128)"},className:(0,a.cn)("block text-sm font-medium transition-colors duration-200",d&&"text-destructive"),children:[l,x.required&&(0,r.jsx)("span",{className:"text-destructive ml-1",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[m&&(0,r.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground pointer-events-none z-10",children:m}),(0,r.jsxs)(s.motion.select,{ref:_,id:v,value:f,...x,onFocus:e=>{b(!0),x.onFocus?.(e)},onBlur:e=>{b(!1),N(!1),x.onBlur?.(e)},onMouseDown:()=>N(!y),className:T,animate:{scale:E?1.01:1,borderColor:d?"#EF4444":E?"rgb(37, 99, 235)":"rgb(226, 232, 240)"},transition:{duration:.2},children:[g&&(0,r.jsx)("option",{value:"",disabled:!0,children:g}),(p||[]).map(e=>(0,r.jsx)("option",{value:e.value,disabled:e.disabled,children:e.label},e.value))]}),(0,r.jsx)(s.motion.div,{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",animate:{rotate:180*!!y},transition:{duration:.2},children:(0,r.jsx)(n.ChevronDown,{className:"h-5 w-5"})}),d&&(0,r.jsx)(s.motion.div,{className:"absolute right-11 top-1/2 -translate-y-1/2 pointer-events-none",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:(0,r.jsx)(o.AlertCircle,{className:"h-5 w-5 text-destructive"})})]}),(0,r.jsx)(i.AnimatePresence,{mode:"wait",children:(d||c)&&(0,r.jsx)(s.motion.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},transition:{duration:.2},className:(0,a.cn)("text-xs transition-colors duration-200",d?"text-destructive":"text-muted-foreground"),children:d||c})})]})}).displayName="SelectNative";let l=t.createContext({}),d=t.forwardRef(({value:e,onValueChange:a,children:s},i)=>{let[n,o]=t.useState(!1);return(0,r.jsx)(l.Provider,{value:{value:e,onValueChange:a,open:n,setOpen:o},children:(0,r.jsx)("div",{className:"relative",ref:i,children:s})})});d.displayName="SelectRoot";let c=t.forwardRef(({children:e,className:s,...i},o)=>{let{open:d,setOpen:c}=t.useContext(l);return(0,r.jsxs)("button",{ref:o,type:"button",className:(0,a.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),onClick:()=>c?.(!d),...i,children:[e,(0,r.jsx)(n.ChevronDown,{className:(0,a.cn)("h-4 w-4 opacity-50 transition-transform",d&&"rotate-180")})]})});c.displayName="SelectTrigger";let u=t.forwardRef(({placeholder:e},a)=>{let{value:s}=t.useContext(l);return(0,r.jsx)("span",{ref:a,children:s||e})});u.displayName="SelectValue";let m=t.forwardRef(({children:e},a)=>{let s=t.useContext(l);return s?.open&&e?(0,r.jsx)("div",{ref:a,className:"absolute top-full left-0 z-50 mt-1 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md",children:(0,r.jsx)("div",{className:"p-1",children:e})}):null});m.displayName="SelectContent";let h=t.forwardRef(({value:e,children:s,className:i,...n},o)=>{let{value:d,onValueChange:c,setOpen:u}=t.useContext(l),m=d===e;return(0,r.jsx)("div",{ref:o,role:"option","aria-selected":m,className:(0,a.cn)("relative flex w-full cursor-pointer select-none items-center rounded-sm py-1.5 px-2 text-sm outline-none hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground",m&&"bg-accent text-accent-foreground",i),onClick:()=>{c?.(e),u?.(!1)},...n,children:s})});h.displayName="SelectItem",e.s(["Select",0,d,"SelectContent",0,m,"SelectItem",0,h,"SelectRoot",0,d,"SelectTrigger",0,c,"SelectValue",0,u])},598203,e=>{"use strict";var r=e.i(920755);e.i(246704);var t=e.i(779478),a=e.i(790224);let s=new class{supabase;constructor(e){this.supabase=e||(0,r.createClient)()}async getAll(e,r){try{let a=r?.page||1,s=r?.limit||50,i=(a-1)*s,n=this.supabase.from("documents").select("*, students(*)",{count:"exact"}).eq("organization_id",e);r?.studentId&&(n=n.eq("student_id",r.studentId)),r?.type&&(n=n.eq("type",r.type));let{data:o,error:l,count:d}=await n.order("created_at",{ascending:!1}).range(i,i+s-1);if(l)throw t.errorHandler.handleError(l,{operation:"getAll",organizationId:e,filters:r});return{data:o||[],total:d||0,page:a,limit:s,totalPages:Math.ceil((d||0)/s)}}catch(a){if(a instanceof t.AppError)throw a;throw t.errorHandler.handleError(a,{operation:"getAll",organizationId:e,filters:r})}}async getById(e){try{let{data:r,error:a}=await this.supabase.from("documents").select("*, students(*)").eq("id",e).single();if(a){if("PGRST116"===a.code)throw t.errorHandler.handleError(a,{code:t.ErrorCode.DB_NOT_FOUND,operation:"getById",id:e});throw t.errorHandler.handleError(a,{operation:"getById",id:e})}if(!r)throw t.errorHandler.createNotFoundError(`Document avec l'ID ${e} introuvable`,{id:e});return r}catch(r){if(r instanceof t.AppError)throw r;throw t.errorHandler.handleError(r,{operation:"getById",id:e})}}async create(e){try{if(!e.title)throw t.errorHandler.createValidationError("Le titre est obligatoire","title");if(!e.file_url)throw t.errorHandler.createValidationError("L'URL du fichier est obligatoire","file_url");let{data:r,error:s}=await this.supabase.from("documents").insert(e).select().single();if(s){if("23505"===s.code)throw t.errorHandler.handleError(s,{code:t.ErrorCode.VALIDATION_UNIQUE_CONSTRAINT,operation:"create",field:"title"});throw t.errorHandler.handleError(s,{operation:"create",document:e})}return a.logger.info("Document created successfully",{id:r?.id,organizationId:e.organization_id||void 0}),r}catch(r){if(r instanceof t.AppError)throw r;throw t.errorHandler.handleError(r,{operation:"create",document:e})}}async uploadFile(e,r){try{if(!e)throw t.errorHandler.createValidationError("Le fichier est obligatoire","file");if(!r)throw t.errorHandler.createValidationError("Le chemin est obligatoire","path");let{data:s,error:i}=await this.supabase.storage.from("documents").upload(r,e,{cacheControl:"3600",upsert:!1});if(i){if(i.message?.includes("already exists"))throw t.errorHandler.handleError(i,{code:t.ErrorCode.VALIDATION_UNIQUE_CONSTRAINT,operation:"uploadFile",path:r});throw t.errorHandler.handleError(i,{operation:"uploadFile",path:r,fileName:e.name})}return a.logger.info("File uploaded successfully",{path:r,fileName:e.name,size:e.size}),s}catch(a){if(a instanceof t.AppError)throw a;throw t.errorHandler.handleError(a,{operation:"uploadFile",path:r,fileName:e?.name})}}async getPublicUrl(e){let{data:r}=this.supabase.storage.from("documents").getPublicUrl(e);return r.publicUrl}async delete(e){try{if(!e)throw t.errorHandler.createValidationError("L'ID du document est obligatoire","id");let{error:r}=await this.supabase.from("documents").delete().eq("id",e);if(r){if("23503"===r.code)throw t.errorHandler.handleError(r,{code:t.ErrorCode.DB_FOREIGN_KEY_CONSTRAINT,operation:"delete",id:e});throw t.errorHandler.handleError(r,{operation:"delete",id:e})}a.logger.info("Document deleted successfully",{id:e})}catch(r){if(r instanceof t.AppError)throw r;throw t.errorHandler.handleError(r,{operation:"delete",id:e})}}};e.s(["documentService",0,s])},562290,e=>{"use strict";var r=e.i(843476),t=e.i(271645),a=e.i(618566),s=e.i(266027),i=e.i(954616),n=e.i(912598),o=e.i(325715),l=e.i(598203),d=e.i(51483);e.i(424403);var c=e.i(826609),u=e.i(167881),m=e.i(970065),h=e.i(10708),p=e.i(184762),g=e.i(6799),f=e.i(871689),x=e.i(356909),_=e.i(37727),E=e.i(522016),b=e.i(647163);function y(){let e=(0,a.useParams)(),y=(0,a.useRouter)(),{user:N}=(0,o.useAuth)(),v=(0,n.useQueryClient)(),{addToast:T}=(0,g.useToast)(),I=e.id,[S,w]=(0,t.useState)(null),[A,j]=(0,t.useState)(""),{data:C,isLoading:D}=(0,s.useQuery)({queryKey:["document",I],queryFn:()=>l.documentService.getById(I),enabled:!!I}),{data:R}=(0,s.useQuery)({queryKey:["document-signatures",I],queryFn:()=>d.signatureService.getSignaturesByDocument(I),enabled:!!I}),O=(0,i.useMutation)({mutationFn:async()=>{if(!S||!N?.organization_id||!N?.id)throw Error("Signature requise");return d.signatureService.createSignature({documentId:I,organizationId:N.organization_id,signerId:N.id,signatureData:S,signerName:N.full_name||N.email||"Utilisateur",signerEmail:N.email||void 0,signerRole:N.role||void 0,comment:A||void 0})},onSuccess:()=>{v.invalidateQueries({queryKey:["document-signatures",I]}),v.invalidateQueries({queryKey:["document",I]}),T({title:"Signature enregistrée",description:"Votre signature a été enregistrée avec succès.",type:"success"}),y.push(`/dashboard/documents/${I}`)},onError:e=>{T({type:"error",title:"Erreur",description:e.message||"Une erreur est survenue lors de l'enregistrement de la signature."})}});if(D)return(0,r.jsx)("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:(0,r.jsx)("div",{className:"text-center py-12",children:"Chargement..."})});if(!C)return(0,r.jsx)("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:(0,r.jsx)(m.Card,{children:(0,r.jsxs)(m.CardContent,{className:"pt-6 text-center",children:[(0,r.jsx)("p",{className:"text-muted-foreground",children:"Document introuvable"}),(0,r.jsx)(E.default,{href:"/dashboard/documents",children:(0,r.jsx)(u.Button,{variant:"outline",className:"mt-4",children:"Retour aux documents"})})]})})});let U=R?.some(e=>e.signer_id===N?.id&&"signed"===e.status);return(0,r.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-4xl",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)(E.default,{href:`/dashboard/documents/${I}`,children:(0,r.jsxs)(u.Button,{variant:"ghost",size:"sm",className:"mb-4",children:[(0,r.jsx)(f.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Retour au document"]})}),(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Signer le document"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:C.title||"Document sans titre"})]}),(0,r.jsxs)(m.Card,{className:"mb-6",children:[(0,r.jsx)(m.CardHeader,{children:(0,r.jsx)(m.CardTitle,{children:"Informations du document"})}),(0,r.jsxs)(m.CardContent,{className:"space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(h.Label,{className:"text-sm text-muted-foreground",children:"Type"}),(0,r.jsx)("p",{className:"font-medium",children:C.type||"Non spécifié"})]}),C.created_at&&(0,r.jsxs)("div",{children:[(0,r.jsx)(h.Label,{className:"text-sm text-muted-foreground",children:"Date de création"}),(0,r.jsx)("p",{className:"font-medium",children:(0,b.formatDate)(C.created_at)})]})]})]}),R&&R.length>0&&(0,r.jsxs)(m.Card,{className:"mb-6",children:[(0,r.jsxs)(m.CardHeader,{children:[(0,r.jsx)(m.CardTitle,{children:"Signatures existantes"}),(0,r.jsxs)(m.CardDescription,{children:[R.length," signature(s) déjà enregistrée(s)"]})]}),(0,r.jsx)(m.CardContent,{children:(0,r.jsx)("div",{className:"space-y-3",children:R.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-32 h-16 border rounded bg-white p-2",children:(0,r.jsx)("img",{src:e.signature_data,alt:"Signature",className:"w-full h-full object-contain"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:e.signer_name||e.signer?.full_name||"Signataire"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:e.signer_role||e.signer?.role||"Rôle non spécifié"}),e.signed_at&&(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,b.formatDate)(e.signed_at)})]})]}),e.signer_id===N?.id&&(0,r.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"Votre signature"})]},e.id))})})]}),U?(0,r.jsx)(m.Card,{children:(0,r.jsxs)(m.CardContent,{className:"pt-6 text-center",children:[(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"Vous avez déjà signé ce document."}),(0,r.jsx)(E.default,{href:`/dashboard/documents/${I}`,children:(0,r.jsx)(u.Button,{variant:"outline",children:"Retour au document"})})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(m.Card,{className:"mb-6",children:[(0,r.jsxs)(m.CardHeader,{children:[(0,r.jsx)(m.CardTitle,{children:"Votre signature"}),(0,r.jsx)(m.CardDescription,{children:"Signez dans la zone ci-dessous. Vous pouvez également importer une image de signature."})]}),(0,r.jsx)(m.CardContent,{children:(0,r.jsx)(c.SignaturePad,{onSave:e=>w(e),onClear:()=>w(null),width:600,height:200})})]}),(0,r.jsxs)(m.Card,{className:"mb-6",children:[(0,r.jsx)(m.CardHeader,{children:(0,r.jsx)(m.CardTitle,{children:"Commentaire (optionnel)"})}),(0,r.jsx)(m.CardContent,{children:(0,r.jsx)(p.Textarea,{value:A,onChange:e=>j(e.target.value),placeholder:"Ajouter un commentaire à votre signature...",rows:3})})]}),(0,r.jsxs)("div",{className:"flex gap-4 justify-end",children:[(0,r.jsx)(E.default,{href:`/dashboard/documents/${I}`,children:(0,r.jsxs)(u.Button,{variant:"outline",children:[(0,r.jsx)(_.X,{className:"h-4 w-4 mr-2"}),"Annuler"]})}),(0,r.jsxs)(u.Button,{onClick:()=>O.mutate(),disabled:!S||O.isPending,children:[(0,r.jsx)(x.Save,{className:"h-4 w-4 mr-2"}),O.isPending?"Enregistrement...":"Enregistrer la signature"]})]})]})]})}e.s(["default",()=>y])}]);