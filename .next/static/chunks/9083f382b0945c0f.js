(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,107233,e=>{"use strict";let s=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>s],107233)},871689,e=>{"use strict";let s=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>s],871689)},212426,e=>{"use strict";let s=(0,e.i(475254).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>s],212426)},683909,e=>{"use strict";var s=e.i(920755);let t=new class{supabase;constructor(e){this.supabase=e||(0,s.createClient)()}async getAllPrograms(e,s){let t=this.supabase.from("programs").select("*").eq("organization_id",e);s?.isActive!==void 0&&(t=t.eq("is_active",s.isActive)),s?.search&&(t=t.or(`name.ilike.%${s.search}%,code.ilike.%${s.search}%,description.ilike.%${s.search}%`));let{data:a,error:r}=await t.order("created_at",{ascending:!1});if(r)throw r;return a}async getProgramById(e){let{data:s,error:t}=await this.supabase.from("programs").select(`
        *,
        formations(*)
      `).eq("id",e).single();if(t)throw t;return s}async createProgram(e){let{data:s,error:t}=await this.supabase.from("programs").insert(e).select().single();if(t)throw t;return s}async updateProgram(e,s){let{data:t,error:a}=await this.supabase.from("programs").update(s).eq("id",e).select().single();if(a)throw a;return t}async deleteProgram(e){return this.updateProgram(e,{is_active:!1})}async getFormationsByProgram(e){let{data:s,error:t}=await this.supabase.from("formations").select("*").eq("program_id",e).order("created_at",{ascending:!1});if(t)throw t;return s}async getGlobalStats(e){let{data:s,error:t}=await this.supabase.from("programs").select("id, is_active, created_at").eq("organization_id",e);if(t)throw t;let a=s||[],r=a.length,i=a.filter(e=>e.is_active).length,l=a.filter(e=>!e.is_active).length,n=0,c=a.map(e=>e.id);if(c.length>0){let{count:e,error:s}=await this.supabase.from("formations").select("*",{count:"exact",head:!0}).in("program_id",c);if(s)throw s;n=e||0}let d=0;if(c.length>0){let{data:e,error:s}=await this.supabase.from("formations").select("id").in("program_id",c);if(s)throw s;let t=e?.map(e=>e.id)||[];if(t.length>0){let{count:e,error:s}=await this.supabase.from("sessions").select("*",{count:"exact",head:!0}).in("formation_id",t);if(s)throw s;d=e||0}}let o=0;if(c.length>0){let{data:e,error:s}=await this.supabase.from("formations").select("id").in("program_id",c);if(s)throw s;let t=e?.map(e=>e.id)||[];if(t.length>0){let{data:e,error:s}=await this.supabase.from("sessions").select("id").in("formation_id",t);if(s)throw s;let a=e?.map(e=>e.id)||[];if(a.length>0){let{count:e,error:s}=await this.supabase.from("enrollments").select("*",{count:"exact",head:!0}).in("session_id",a);if(s)throw s;o=e||0}}}let m=[{name:"Actifs",value:i,color:"#335ACF"},{name:"Inactifs",value:l,color:"#6B7280"}].filter(e=>e.value>0),h={};return a.forEach(e=>{if(e.created_at){let s=new Date(e.created_at),t=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`;h[t]=(h[t]||0)+1}}),{total:r,active:i,inactive:l,totalFormations:n,totalSessions:d,totalEnrollments:o,statusData:m,monthlyData:Object.entries(h).sort(([e],[s])=>e.localeCompare(s)).slice(-6).map(([e,s])=>({month:new Date(e+"-01").toLocaleDateString("fr-FR",{month:"short",year:"numeric"}),programmes:s}))}}};e.s(["programService",0,t])},249875,e=>{"use strict";var s=e.i(843476),t=e.i(271645),a=e.i(618566),r=e.i(266027),i=e.i(683909),l=e.i(167881),n=e.i(970065),c=e.i(871689),d=e.i(107233),o=e.i(555436),m=e.i(68787),h=e.i(87316),x=e.i(212426),u=e.i(761911),f=e.i(522016),g=e.i(647163);function p(){let e=(0,a.useParams)();(0,a.useRouter)();let p=e.id,[j,v]=(0,t.useState)(""),[y,N]=(0,t.useState)(!0),{data:w,isLoading:b}=(0,r.useQuery)({queryKey:["program",p],queryFn:()=>i.programService.getProgramById(p),enabled:!!p}),{data:C,isLoading:_}=(0,r.useQuery)({queryKey:["program-formations",p,j,y],queryFn:async()=>{let e=await i.programService.getFormationsByProgram(p)||[];if(y&&(e=e.filter(e=>e.is_active)),j){let s=j.toLowerCase();e=e.filter(e=>e.name?.toLowerCase().includes(s)||e.code?.toLowerCase().includes(s)||e.description?.toLowerCase().includes(s))}return e},enabled:!!p});if(b)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("div",{className:"text-muted-foreground",children:"Chargement..."})})});if(!w)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-muted-foreground",children:"Programme non trouvé"}),(0,s.jsx)(f.default,{href:"/dashboard/programs",children:(0,s.jsx)(l.Button,{className:"mt-4",children:"Retour à la liste"})})]})});let P=C||[];return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)(f.default,{href:`/dashboard/programs/${p}`,children:(0,s.jsx)(l.Button,{variant:"ghost",size:"icon",children:(0,s.jsx)(c.ArrowLeft,{className:"h-4 w-4"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Formations"}),(0,s.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Programme: ",(0,s.jsx)(f.default,{href:`/dashboard/programs/${p}`,className:"text-primary hover:underline",children:w.name})]})]})]}),(0,s.jsx)(f.default,{href:"/dashboard/formations/new",children:(0,s.jsxs)(l.Button,{children:[(0,s.jsx)(d.Plus,{className:"mr-2 h-4 w-4"}),"Nouvelle formation"]})})]}),(0,s.jsxs)(n.Card,{children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsx)("div",{className:"flex flex-col space-y-4",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-4",children:[(0,s.jsx)("div",{className:"flex-1 w-full",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(o.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Rechercher une formation...",value:j,onChange:e=>v(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",id:"activeOnly",checked:y,onChange:e=>N(e.target.checked),className:"rounded border-gray-300 text-primary focus:ring-primary"}),(0,s.jsx)("label",{htmlFor:"activeOnly",className:"text-sm text-gray-600",children:"Actives uniquement"})]})]})})}),(0,s.jsx)(n.CardContent,{children:_?(0,s.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:"Chargement..."}):P.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:P.map(e=>(0,s.jsxs)(n.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,s.jsx)(n.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(n.CardTitle,{className:"text-lg",children:e.name}),e.subtitle&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.subtitle}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Code: ",e.code]})]}),(0,s.jsx)("span",{className:`px-2 py-1 rounded text-xs ${e.is_active?"bg-success-bg text-success-primary":"bg-gray-100 text-gray-800"}`,children:e.is_active?"Active":"Inactive"})]})}),(0,s.jsxs)(n.CardContent,{className:"space-y-3",children:[e.description&&(0,s.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.duration_hours&&(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(h.Calendar,{className:"mr-1 h-4 w-4"}),e.duration_hours,"h"]}),e.price&&(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(x.DollarSign,{className:"mr-1 h-4 w-4"}),(0,g.formatCurrency)(Number(e.price),e.currency||"XOF")]})]}),e.capacity_max&&(0,s.jsxs)("div",{className:"flex items-center text-sm text-muted-foreground",children:[(0,s.jsx)(u.Users,{className:"mr-1 h-4 w-4"}),"Capacité: ",e.capacity_max," apprenants"]}),(0,s.jsxs)("div",{className:"flex space-x-2 pt-2",children:[(0,s.jsx)(f.default,{href:`/dashboard/formations/${e.id}`,className:"flex-1",children:(0,s.jsx)(l.Button,{variant:"outline",className:"w-full",size:"sm",children:"Voir détails"})}),(0,s.jsx)(f.default,{href:`/dashboard/formations/${e.id}/sessions`,className:"flex-1",children:(0,s.jsx)(l.Button,{variant:"default",className:"w-full",size:"sm",children:"Sessions"})})]})]})]},e.id))}):(0,s.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,s.jsx)(m.BookMarked,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("p",{children:"Aucune formation trouvée"}),j||y?(0,s.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,s.jsx)("p",{className:"text-sm",children:"Essayez de modifier vos filtres"}),(0,s.jsx)(l.Button,{variant:"outline",onClick:()=>{v(""),N(!1)},children:"Réinitialiser les filtres"})]}):(0,s.jsx)(f.default,{href:"/dashboard/formations/new",children:(0,s.jsx)(l.Button,{variant:"outline",className:"mt-4",children:"Créer une formation"})})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsx)(n.Card,{children:(0,s.jsx)(n.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:P.length}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total des formations"})]})})}),(0,s.jsx)(n.Card,{children:(0,s.jsx)(n.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-success-primary",children:P.filter(e=>e.is_active).length}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Formations actives"})]})})}),(0,s.jsx)(n.Card,{children:(0,s.jsx)(n.CardContent,{className:"pt-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-gray-600",children:P.filter(e=>!e.is_active).length}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Formations inactives"})]})})})]})]})}e.s(["default",()=>p])}]);