(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,503116,e=>{"use strict";let t=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],503116)},870273,e=>{"use strict";let t=(0,e.i(475254).default)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);e.s(["Star",()=>t],870273)},338456,e=>{"use strict";let t=(0,e.i(475254).default)("PlayCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);e.s(["PlayCircle",()=>t],338456)},555091,e=>{"use strict";var t=e.i(843476),s=e.i(271645),i=e.i(266027),a=e.i(325715),r=e.i(920755);let l=new class{supabase;constructor(e){this.supabase=e||(0,r.createClient)()}async getModules(){let{data:e,error:t}=await this.supabase.from("tutorial_modules").select("*").eq("is_active",!0).order("order_index",{ascending:!0});if(t)throw t;return e}async getModuleBySlug(e){let{data:t,error:s}=await this.supabase.from("tutorial_modules").select("*").eq("slug",e).eq("is_active",!0).single();if(s)throw s;return t}async getVideos(e){let t=this.supabase.from("tutorial_videos").select(`
        *,
        module:tutorial_modules(*)
      `);e?.moduleId&&(t=t.eq("module_id",e.moduleId)),e?.moduleSlug&&(t=t.eq("module:tutorial_modules.slug",e.moduleSlug)),e?.search&&(t=t.or(`title.ilike.%${e.search}%,description.ilike.%${e.search}%`)),e?.difficultyLevel&&(t=t.eq("difficulty_level",e.difficultyLevel)),t=e?.isPublished!==void 0?t.eq("is_published",e.isPublished):t.eq("is_published",!0);let{data:s,error:i}=await t.order("order_index",{ascending:!0});if(i)throw i;return s}async getVideoBySlug(e,t){let{data:s,error:i}=await this.supabase.from("tutorial_videos").select(`
        *,
        module:tutorial_modules(*)
      `).eq("slug",t).eq("module:tutorial_modules.slug",e).eq("is_published",!0).single();if(i)throw i;return s}async createVideo(e){let{data:t,error:s}=await this.supabase.from("tutorial_videos").insert(e).select().single();if(s)throw s;return t}async updateVideo(e,t){let{data:s,error:i}=await this.supabase.from("tutorial_videos").update(t).eq("id",e).select().single();if(i)throw i;return s}async deleteVideo(e){let{error:t}=await this.supabase.from("tutorial_videos").delete().eq("id",e);if(t)throw t}async getProgress(e,t){if(t){let{data:s,error:i}=await this.supabase.from("tutorial_progress").select("*, video:tutorial_videos(*)").eq("user_id",e).eq("video_id",t).maybeSingle();if(i)throw i;return s}let{data:s,error:i}=await this.supabase.from("tutorial_progress").select("*, video:tutorial_videos(*)").eq("user_id",e);if(i)throw i;return s}async updateProgress(e,t,s,i){if(!await this.getVideoById(t))throw Error("Video not found");let a=i>=90,{data:r,error:l}=await this.supabase.from("tutorial_progress").upsert({user_id:e,video_id:t,watched_seconds:s,completion_percentage:i,is_completed:a,completed_at:a?new Date().toISOString():null,last_watched_at:new Date().toISOString()},{onConflict:"user_id,video_id"}).select().single();if(l)throw l;return r}async getVideoById(e){let{data:t,error:s}=await this.supabase.from("tutorial_videos").select("*").eq("id",e).single();if(s)throw s;return t}async getUserProgress(e){let{data:t,error:s}=await this.supabase.from("tutorial_progress").select("*, video:tutorial_videos(*, module:tutorial_modules(*))").eq("user_id",e).order("last_watched_at",{ascending:!1});if(s)throw s;return t}async getCompletionStats(e){let t=await this.getUserProgress(e),s=await this.getVideos({isPublished:!0}),i=t||[],a=i.filter(e=>e.is_completed).length||0,r=(s||[]).length||0;return{completed:a,total:r,inProgress:i.filter(e=>!e.is_completed&&e.watched_seconds>0).length||0,completionRate:r>0?a/r*100:0}}async getNotes(e,t){let s=this.supabase.from("tutorial_notes").select("*, video:tutorial_videos(*)").eq("user_id",e);t&&(s=s.eq("video_id",t));let{data:i,error:a}=await s.order("created_at",{ascending:!1});if(a)throw a;return i}async createNote(e){let{data:t,error:s}=await this.supabase.from("tutorial_notes").insert(e).select().single();if(s)throw s;return t}async updateNote(e,t){let{data:s,error:i}=await this.supabase.from("tutorial_notes").update(t).eq("id",e).select().single();if(i)throw i;return s}async deleteNote(e){let{error:t}=await this.supabase.from("tutorial_notes").delete().eq("id",e);if(t)throw t}async addToFavorites(e,t){let{data:s,error:i}=await this.supabase.from("tutorial_favorites").insert({user_id:e,video_id:t}).select().single();if(i)throw i;return s}async removeFromFavorites(e,t){let{error:s}=await this.supabase.from("tutorial_favorites").delete().eq("user_id",e).eq("video_id",t);if(s)throw s}async isFavorite(e,t){let{data:s,error:i}=await this.supabase.from("tutorial_favorites").select("id").eq("user_id",e).eq("video_id",t).maybeSingle();if(i)throw i;return!!s}async getFavorites(e){let{data:t,error:s}=await this.supabase.from("tutorial_favorites").select("*, video:tutorial_videos(*, module:tutorial_modules(*))").eq("user_id",e).order("created_at",{ascending:!1});if(s)throw s;return t}async getPlaylists(e,t){let s=this.supabase.from("tutorial_playlists").select("*, user:users(id, full_name, email)");e&&(s=s.eq("user_id",e)),void 0!==t&&(s=s.eq("is_public",t));let{data:i,error:a}=await s.order("created_at",{ascending:!1});if(a)throw a;return i}async createPlaylist(e){let{data:t,error:s}=await this.supabase.from("tutorial_playlists").insert(e).select().single();if(s)throw s;return t}async addVideoToPlaylist(e,t){let{data:s,error:i}=await this.supabase.from("tutorial_playlist_videos").insert({playlist_id:e,video_id:t}).select().single();if(i)throw i;return s}async getComments(e){let{data:t,error:s}=await this.supabase.from("tutorial_comments").select("*, user:users(id, full_name, email), replies:tutorial_comments(*)").eq("video_id",e).eq("is_approved",!0).is("parent_id",null).order("created_at",{ascending:!1});if(s)throw s;return t}async createComment(e){let{data:t,error:s}=await this.supabase.from("tutorial_comments").insert(e).select().single();if(s)throw s;return t}};var o=e.i(970065),d=e.i(167881),n=e.i(23750),c=e.i(994179),u=e.i(338456),m=e.i(503116),h=e.i(465286),g=e.i(810980),x=e.i(555436),f=e.i(870273),p=e.i(522016);function y(){let{user:e}=(0,a.useAuth)(),[r,y]=(0,s.useState)(""),[v,_]=(0,s.useState)(null),{data:w}=(0,i.useQuery)({queryKey:["tutorial-modules"],queryFn:()=>l.getModules()}),{data:j}=(0,i.useQuery)({queryKey:["tutorial-videos",v,r],queryFn:()=>l.getVideos({moduleId:v||void 0,search:r||void 0})}),{data:b}=(0,i.useQuery)({queryKey:["tutorial-stats",e?.id],queryFn:()=>l.getCompletionStats(e?.id||""),enabled:!!e?.id}),N={beginner:"bg-green-100 text-green-800",intermediate:"bg-yellow-100 text-yellow-800",advanced:"bg-red-100 text-red-800"},C={beginner:"Débutant",intermediate:"Intermédiaire",advanced:"Avancé"};return(0,t.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,t.jsx)(u.PlayCircle,{className:"h-8 w-8"}),"Vidéos Tutoriels"]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Apprenez à utiliser EDUZEN avec nos tutoriels vidéo complets"})]}),b&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,t.jsx)(o.Card,{children:(0,t.jsx)(o.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Vidéos complétées"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:b.completed})]}),(0,t.jsx)(h.CheckCircle2,{className:"h-8 w-8 text-green-500"})]})})}),(0,t.jsx)(o.Card,{children:(0,t.jsx)(o.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"En cours"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:b.inProgress})]}),(0,t.jsx)(m.Clock,{className:"h-8 w-8 text-yellow-500"})]})})}),(0,t.jsx)(o.Card,{children:(0,t.jsx)(o.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:b.total})]}),(0,t.jsx)(g.BookOpen,{className:"h-8 w-8 text-blue-500"})]})})}),(0,t.jsx)(o.Card,{children:(0,t.jsx)(o.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Progression"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[Math.round(b.completionRate),"%"]})]}),(0,t.jsx)(f.Star,{className:"h-8 w-8 text-purple-500"})]})})})]}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(x.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,t.jsx)(n.Input,{placeholder:"Rechercher un tutoriel...",value:r,onChange:e=>y(e.target.value),className:"pl-10"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,t.jsx)("div",{className:"lg:col-span-1",children:(0,t.jsxs)(o.Card,{children:[(0,t.jsx)(o.CardHeader,{children:(0,t.jsx)(o.CardTitle,{children:"Modules"})}),(0,t.jsx)(o.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("button",{onClick:()=>_(null),className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${null===v?"bg-primary text-primary-foreground":"hover:bg-gray-100"}`,children:"Tous les modules"}),w?.map(e=>(0,t.jsx)("button",{onClick:()=>_(e.id),className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${v===e.id?"bg-primary text-primary-foreground":"hover:bg-gray-100"}`,children:e.name},e.id))]})})]})}),(0,t.jsx)("div",{className:"lg:col-span-3",children:j&&j.length>0?(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:j.map(e=>{var s;let i,a,r;return(0,t.jsxs)(o.Card,{className:"hover:shadow-lg transition-shadow",children:[(0,t.jsx)(o.CardHeader,{children:(0,t.jsx)("div",{className:"flex items-start justify-between",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(o.CardTitle,{className:"text-lg mb-2",children:e.title}),(0,t.jsx)(o.CardDescription,{className:"line-clamp-2",children:e.description})]})})}),(0,t.jsx)(o.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)(c.Badge,{className:N[e.difficulty_level]||"bg-gray-100 text-gray-800",children:C[e.difficulty_level]||e.difficulty_level}),e.duration_seconds&&(0,t.jsxs)("span",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[(0,t.jsx)(m.Clock,{className:"h-4 w-4"}),(i=Math.floor((s=e.duration_seconds)/3600),a=Math.floor(s%3600/60),r=s%60,i>0?`${i}h ${a}m`:a>0?`${a}m ${r}s`:`${r}s`)]}),e.module&&(0,t.jsx)(c.Badge,{variant:"outline",children:e.module.name})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.view_count||0," vues"]}),(0,t.jsx)(p.default,{href:`/dashboard/tutorials/${e.module?.slug}/${e.slug}`,children:(0,t.jsxs)(d.Button,{children:[(0,t.jsx)(u.PlayCircle,{className:"h-4 w-4 mr-2"}),"Regarder"]})})]})]})})]},e.id)})}):(0,t.jsx)(o.Card,{children:(0,t.jsxs)(o.CardContent,{className:"pt-6 text-center text-muted-foreground",children:["Aucune vidéo trouvée. ",r&&"Essayez une autre recherche."]})})})]})]})}e.s(["default",()=>y],555091)}]);