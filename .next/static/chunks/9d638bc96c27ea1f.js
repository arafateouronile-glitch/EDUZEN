(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,107233,e=>{"use strict";let t=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],107233)},503116,e=>{"use strict";let t=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],503116)},645760,e=>{"use strict";var t=e.i(843476),a=e.i(271645),i=e.i(647163);e.i(882205);var s=e.i(846932);let r=a.forwardRef(({className:e,variant:a="default",hoverable:r=!1,glow:n=!1,glowColor:d="rgba(51, 90, 207, 0.3)",...o},l)=>(0,t.jsxs)(s.motion.div,{ref:l,className:(0,i.cn)("relative rounded-2xl border backdrop-blur-xl transition-all duration-300",{"bg-white/70 dark:bg-gray-900/70 border-white/20 dark:border-gray-700/30 shadow-lg":"default"===a,"bg-white/80 dark:bg-gray-900/80 border-white/30 dark:border-gray-700/40 shadow-xl":"premium"===a,"bg-white/50 dark:bg-gray-900/50 border-white/10 dark:border-gray-700/20 shadow-md":"subtle"===a,"cursor-pointer":r,"hover:shadow-2xl hover:scale-[1.02]":r,"hover:bg-white/90 dark:hover:bg-gray-900/90":r},e),whileHover:r?{scale:1.02,y:-2}:void 0,transition:{type:"spring",stiffness:300,damping:30},...o,children:[n&&(0,t.jsx)(s.motion.div,{className:"absolute inset-0 rounded-2xl opacity-0 blur-xl",style:{background:`radial-gradient(circle, ${d} 0%, transparent 70%)`},animate:{opacity:[0,.5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"}}),(0,t.jsx)("div",{className:"relative z-10",children:o.children})]}));r.displayName="GlassCard",e.s(["GlassCard",()=>r])},605631,e=>{"use strict";let t=(0,e.i(475254).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],605631)},356909,e=>{"use strict";let t=(0,e.i(475254).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);e.s(["Save",()=>t],356909)},25652,e=>{"use strict";let t=(0,e.i(475254).default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);e.s(["TrendingUp",()=>t],25652)},797548,e=>{"use strict";let t=(0,e.i(475254).default)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);e.s(["Filter",()=>t],797548)},373375,e=>{"use strict";let t=(0,e.i(475254).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],373375)},370956,e=>{"use strict";let t=(0,e.i(475254).default)("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);e.s(["List",()=>t],370956)},751975,e=>{"use strict";let t=(0,e.i(475254).default)("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);e.s(["Tag",()=>t],751975)},489853,e=>{"use strict";let t=(0,e.i(475254).default)("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);e.s(["CalendarDays",()=>t],489853)},436321,e=>{"use strict";var t=e.i(920755);let a=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getTodos(e,t){let a=this.supabase.from("calendar_todos").select("*").eq("organization_id",e).order("due_date",{ascending:!0});t?.startDate&&(a=a.gte("due_date",t.startDate)),t?.endDate&&(a=a.lte("due_date",t.endDate)),t?.status&&(a=Array.isArray(t.status)?a.in("status",t.status):a.eq("status",t.status)),t?.category&&(a=a.eq("category",t.category)),t?.priority&&(a=a.eq("priority",t.priority)),t?.assignedTo&&(a=a.eq("assigned_to",t.assignedTo)),t?.createdBy&&(a=a.eq("created_by",t.createdBy)),t?.search&&(a=a.or(`title.ilike.%${t.search}%,description.ilike.%${t.search}%`));let{data:i,error:s}=await a;if(s){if("PGRST116"===s.code||"42P01"===s.code||s.message?.includes("does not exist"))return[];throw s}return i||[]}async getTodoById(e){let{data:t,error:a}=await this.supabase.from("calendar_todos").select("*").eq("id",e).single();if(a){if("PGRST116"===a.code||"42P01"===a.code||a.message?.includes("does not exist"))return null;throw a}return t}async createTodo(e){let{data:t,error:a}=await this.supabase.from("calendar_todos").insert(e).select().single();if(a)throw a;return!1!==e.reminder_enabled&&await this.supabase.rpc("create_todo_reminder_notification",{todo_id:t.id}),t}async updateTodo(e,t){let{data:a,error:i}=await this.supabase.from("calendar_todos").update(t).eq("id",e).select().single();if(i)throw i;return a}async deleteTodo(e){let{error:t}=await this.supabase.from("calendar_todos").delete().eq("id",e);if(t)throw t}async completeTodo(e){return this.updateTodo(e,{status:"completed"})}async completeTodos(e){let{error:t}=await this.supabase.from("calendar_todos").update({status:"completed"}).in("id",e);if(t)throw t}async getCalendarEvents(e,t,a,i){try{let s={p_organization_id:e,p_start_date:t,p_end_date:a};i&&(s.p_user_id=i);let{data:r,error:n}=await this.supabase.rpc("get_calendar_events",s);if(n){if("42883"===n.code||"PGRST116"===n.code||"42P01"===n.code||"400"===n.code||n.message?.includes("does not exist")||n.message?.includes("function")||n.message?.includes("does not exist"))return this.getCalendarEventsManual(e,t,a,i);throw n}return r||[]}catch(s){return this.getCalendarEventsManual(e,t,a,i)}}async getCalendarEventsManual(e,t,a,i){let s=[];try{let i=await this.getTodos(e,{startDate:t,endDate:a});s.push(...i.map(e=>({event_id:e.id,event_type:"todo",title:e.title,description:e.description,start_date:e.start_date||e.due_date,start_time:e.start_time,end_date:e.due_date,end_time:e.due_time,all_day:e.all_day,status:e.status,color:e.color,category:e.category,priority:e.priority,linked_id:e.linked_session_id||e.linked_formation_id||null})))}catch(e){}try{let r,n=this.supabase.from("sessions").select("id, name, start_date, end_date, start_time, end_time, location, status, formation_id, organization_id, formations(id, name)").eq("organization_id",e);if(i){let{data:e}=await this.supabase.from("users").select("role").eq("id",i).maybeSingle();if(e?.role==="teacher"){let{data:e}=await this.supabase.from("session_teachers").select("session_id").eq("teacher_id",i);if(e&&e.length>0){let t=e.map(e=>e.session_id);n=n.in("id",t)}else{let{data:e,error:t}=await n.limit(0);t&&t.code,r=[]}}}let d=null;if(void 0===r){let{data:e,error:t}=await n;if(r=e,d=t)throw d}if(d)throw d;if(r){let e=new Date(t),i=new Date(a),n=r.filter(t=>{if(!t.start_date)return!1;let a=new Date(t.start_date),s=t.end_date?new Date(t.end_date):null;return a>=e&&a<=i||s&&s>=e&&s<=i||a<=e&&(!s||s>=e)||a<=e&&s&&s>=i}).map(e=>{let t=e.start_date?"string"==typeof e.start_date?e.start_date.split("T")[0]:new Date(e.start_date).toISOString().split("T")[0]:null,a=e.end_date?"string"==typeof e.end_date?e.end_date.split("T")[0]:new Date(e.end_date).toISOString().split("T")[0]:null,i=[];if(e.start_time){let t=e.start_time.slice(0,5),a=e.end_time?e.end_time.slice(0,5):null;a?i.push(`ðŸ• ${t} - ${a}`):i.push(`ðŸ• ${t}`)}return e.location&&i.push(`ðŸ“ ${e.location}`),e.formations?.name&&i.push(`ðŸ“š ${e.formations.name}`),{event_id:e.id,event_type:"session",title:e.name,description:i.length>0?i.join(" â€¢ "):null,start_date:t||"",start_time:e.start_time,end_date:a||t||"",end_time:e.end_time,all_day:!1,status:e.status,color:"#10B981",category:"session",priority:"medium",linked_id:e.formation_id,location:e.location||null,formation_name:e.formations?.name||null}});s.push(...n)}}catch(e){}try{let r=this.supabase.from("formations").select("*, sessions(id, start_date, end_date)").eq("organization_id",e);if(i){let{data:e}=await this.supabase.from("users").select("role").eq("id",i).maybeSingle();if(e?.role==="teacher"){let{data:e}=await this.supabase.from("session_teachers").select("session_id").eq("teacher_id",i);if(!e||!(e.length>0))return s;{let t=e.map(e=>e.session_id),{data:a}=await this.supabase.from("sessions").select("formation_id").in("id",t);if(!a||!(a.length>0))return s;{let e=[...new Set(a.map(e=>e.formation_id).filter(e=>!!e))];if(!(e.length>0))return s;r=r.in("id",e)}}}}let{data:n,error:d}=await r;if(d)throw d;if(n){let e=new Date(t),i=new Date(a),r=n.map(e=>{let t=e.sessions||[];if(0===t.length)return null;let a=t.filter(e=>e.start_date).map(e=>({start:new Date(e.start_date),end:e.end_date?new Date(e.end_date):null}));if(0===a.length)return null;let i=new Date(Math.min(...a.map(e=>e.start.getTime()))),s=a.map(e=>e.end).filter(e=>null!==e),r=s.length>0?new Date(Math.max(...s.map(e=>e.getTime()))):null;return{formation:e,start_date:i,end_date:r}}).filter(e=>null!==e).filter(({start_date:t,end_date:a})=>t>=e&&t<=i||a&&a>=e&&a<=i||t<=e&&(!a||a>=e)||t<=e&&a&&a>=i).map(({formation:e,start_date:t,end_date:a})=>({event_id:e.id,event_type:"formation",title:e.name,description:e.description,start_date:t.toISOString().split("T")[0],start_time:null,end_date:a?a.toISOString().split("T")[0]:t.toISOString().split("T")[0],end_time:null,all_day:!0,status:e.is_active?"active":"inactive",color:"#8B5CF6",category:"formation",priority:"medium",linked_id:e.program_id}));s.push(...r)}}catch(e){}return s}async getNotifications(e,t){let a=this.supabase.from("calendar_notifications").select("*").eq("user_id",e).order("scheduled_at",{ascending:!1});t?.status&&(a=a.eq("status",t.status)),t?.unreadOnly&&(a=a.in("status",["pending","sent"])),t?.limit&&(a=a.limit(t.limit));let{data:i,error:s}=await a;if(s){if("PGRST116"===s.code||"42P01"===s.code||s.message?.includes("does not exist"))return[];throw s}return i||[]}async markNotificationAsRead(e){let{error:t}=await this.supabase.from("calendar_notifications").update({status:"read",read_at:new Date().toISOString()}).eq("id",e);if(t)throw t}async markAllNotificationsAsRead(e){let{error:t}=await this.supabase.from("calendar_notifications").update({status:"read",read_at:new Date().toISOString()}).eq("user_id",e).in("status",["pending","sent"]);if(t)throw t}async dismissNotification(e){let{error:t}=await this.supabase.from("calendar_notifications").update({status:"dismissed"}).eq("id",e);if(t)throw t}async countUnreadNotifications(e){let{count:t,error:a}=await this.supabase.from("calendar_notifications").select("*",{count:"exact",head:!0}).eq("user_id",e).in("status",["pending","sent"]);if(a){if("PGRST116"===a.code||"42P01"===a.code||a.message?.includes("does not exist"))return 0;throw a}return t||0}async getUserPreferences(e,t){let{data:a,error:i}=await this.supabase.from("calendar_user_preferences").select("*").eq("user_id",e).eq("organization_id",t).single();if(i){if("PGRST116"===i.code||"42P01"===i.code||i.message?.includes("does not exist"))return null;throw i}return a}async upsertUserPreferences(e,t,a){let{data:i,error:s}=await this.supabase.from("calendar_user_preferences").upsert({user_id:e,organization_id:t,...a},{onConflict:"user_id,organization_id"}).select().single();if(s)throw s;return i}async getUpcomingTodosWithReminder(e,t=60){let a=new Date,i=new Date(a.getTime()+60*t*1e3),{data:s,error:r}=await this.supabase.from("calendar_todos").select("*").eq("organization_id",e).eq("reminder_enabled",!0).eq("reminder_sent",!1).in("status",["pending","in_progress"]).gte("due_date",a.toISOString().split("T")[0]).lte("due_date",i.toISOString().split("T")[0]);if(r)throw r;return s||[]}async getCalendarStats(e){let t=new Date().toISOString().split("T")[0],{data:a,error:i}=await this.supabase.from("calendar_todos").select("id, status, due_date").eq("organization_id",e);if(i){if("PGRST116"===i.code||"42P01"===i.code||i.message?.includes("does not exist"))return{totalTodos:0,pendingTodos:0,completedTodos:0,overdueTodos:0,todayTodos:0,upcomingTodos:0};throw i}let s=a||[],r=s.length,n=s.filter(e=>"pending"===e.status).length,d=s.filter(e=>"completed"===e.status).length,o=s.filter(e=>"completed"!==e.status&&"cancelled"!==e.status&&e.due_date<t).length;return{totalTodos:r,pendingTodos:n,completedTodos:d,overdueTodos:o,todayTodos:s.filter(e=>e.due_date===t).length,upcomingTodos:s.filter(e=>"completed"!==e.status&&"cancelled"!==e.status&&e.due_date>t).length}}async getConfig(e,t){return null}async upsertConfig(e,t,a){return{organization_id:e,provider:t,...a}}};e.s(["calendarService",0,a])}]);