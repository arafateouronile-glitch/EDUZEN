(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,605631,e=>{"use strict";let s=(0,e.i(475254).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>s],605631)},356909,e=>{"use strict";let s=(0,e.i(475254).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);e.s(["Save",()=>s],356909)},286536,e=>{"use strict";let s=(0,e.i(475254).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],286536)},319036,e=>{"use strict";var s=e.i(843476),t=e.i(271645),r=e.i(647163);let i=t.forwardRef(({checked:e,onCheckedChange:t,disabled:i,className:a,...n},l)=>(0,s.jsx)("button",{type:"button",role:"switch","aria-checked":e,ref:l,disabled:i,onClick:()=>t?.(!e),className:(0,r.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",e?"bg-brand-blue":"bg-input",a),...n,children:(0,s.jsx)("span",{className:(0,r.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform",e?"translate-x-5":"translate-x-0")})}));i.displayName="Switch",e.s(["Switch",0,i])},77705,e=>{"use strict";let s=(0,e.i(475254).default)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);e.s(["EyeOff",()=>s],77705)},356786,e=>{"use strict";var s=e.i(247167),t=e.i(843476),r=e.i(271645),i=e.i(266027),a=e.i(954616),n=e.i(912598),l=e.i(325715),c=e.i(920755),o=e.i(167881),d=e.i(970065),u=e.i(23750),h=e.i(10708),p=e.i(319036),m=e.i(6799),x=e.i(561659),b=e.i(356909);let y=(0,e.i(475254).default)("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);var j=e.i(605631),f=e.i(898791),g=e.i(286536),k=e.i(77705),v=e.i(952571),_=e.i(778917),C=e.i(522016);function N(){let{user:e}=(0,l.useAuth)(),N=(0,n.useQueryClient)();(0,c.createClient)();let{addToast:w}=(0,m.useToast)(),[S,E]=(0,r.useState)(!1),[P,T]=(0,r.useState)({publishable_key:"",secret_key:"",webhook_secret:"",is_active:!1,is_test_mode:!0}),{data:z,isLoading:L}=(0,i.useQuery)({queryKey:["stripe-config",e?.organization_id],queryFn:async()=>e?.organization_id?{publishable_key:s.default.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY||"",secret_key:"",webhook_secret:"",is_active:!1,is_test_mode:!0}:null,enabled:!!e?.organization_id}),M=(0,a.useMutation)({mutationFn:async e=>(await new Promise(e=>setTimeout(e,500)),e),onSuccess:()=>{N.invalidateQueries({queryKey:["stripe-config"]}),w({title:"Configuration sauvegardée",description:"Les paramètres Stripe ont été enregistrés avec succès.",type:"success"})},onError:e=>{w({title:"Erreur",description:e.message||"Erreur lors de la sauvegarde",type:"error"})}}),A=(0,a.useMutation)({mutationFn:async()=>{let e=await fetch("/api/payments/stripe/test-connection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({publishable_key:P.publishable_key,secret_key:P.secret_key})});if(!e.ok)throw Error((await e.json()).message||"Erreur de connexion");return e.json()},onSuccess:()=>{w({title:"Connexion réussie",description:"La connexion à Stripe fonctionne correctement.",type:"success"})},onError:e=>{w({title:"Erreur de connexion",description:e.message||"Impossible de se connecter à Stripe",type:"error"})}});return L?(0,t.jsx)("div",{className:"container mx-auto py-8",children:(0,t.jsx)("div",{className:"text-center",children:"Chargement..."})}):(0,t.jsxs)("div",{className:"container mx-auto py-8 space-y-6 max-w-4xl",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,t.jsx)(x.CreditCard,{className:"h-8 w-8"}),"Configuration Stripe"]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Configurez les paiements par carte bancaire via Stripe"})]}),(0,t.jsxs)(d.Card,{children:[(0,t.jsx)(d.CardHeader,{children:(0,t.jsxs)(d.CardTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(v.Info,{className:"h-5 w-5"}),"Documentation"]})}),(0,t.jsxs)(d.CardContent,{children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Stripe permet d'accepter les paiements par carte bancaire (Visa, Mastercard, etc.) de manière sécurisée. Vous devez créer un compte Stripe et récupérer vos clés API."}),(0,t.jsx)(C.default,{href:"https://dashboard.stripe.com/apikeys",target:"_blank",rel:"noopener noreferrer",children:(0,t.jsxs)(o.Button,{variant:"outline",size:"sm",children:[(0,t.jsx)(_.ExternalLink,{className:"h-4 w-4 mr-2"}),"Obtenir les clés API Stripe"]})})]})]}),(0,t.jsxs)(d.Card,{children:[(0,t.jsxs)(d.CardHeader,{children:[(0,t.jsx)(d.CardTitle,{children:"Paramètres de connexion"}),(0,t.jsx)(d.CardDescription,{children:'Entrez vos clés API Stripe. Les clés de test commencent par "pk_test_" et "sk_test_"'})]}),(0,t.jsxs)(d.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(h.Label,{htmlFor:"publishable_key",children:"Clé publique (Publishable Key)"}),(0,t.jsx)(u.Input,{id:"publishable_key",type:"text",placeholder:"pk_test_...",value:P.publishable_key,onChange:e=>T({...P,publishable_key:e.target.value}),className:"mt-1"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Cette clé peut être exposée publiquement (utilisée côté client)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(h.Label,{htmlFor:"secret_key",children:"Clé secrète (Secret Key)"}),(0,t.jsxs)("div",{className:"relative mt-1",children:[(0,t.jsx)(u.Input,{id:"secret_key",type:S?"text":"password",placeholder:"sk_test_...",value:P.secret_key,onChange:e=>T({...P,secret_key:e.target.value}),className:"pr-10"}),(0,t.jsx)("button",{type:"button",onClick:()=>E(!S),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",children:S?(0,t.jsx)(k.EyeOff,{className:"h-4 w-4"}):(0,t.jsx)(g.Eye,{className:"h-4 w-4"})})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"⚠️ Cette clé doit rester secrète (utilisée uniquement côté serveur)"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(h.Label,{htmlFor:"webhook_secret",children:"Secret Webhook (optionnel)"}),(0,t.jsx)(u.Input,{id:"webhook_secret",type:"password",placeholder:"whsec_...",value:P.webhook_secret,onChange:e=>T({...P,webhook_secret:e.target.value}),className:"mt-1"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Utilisé pour valider les événements webhook de Stripe"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)(h.Label,{htmlFor:"is_test_mode",children:"Mode test"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Utilisez les clés de test pour les paiements de développement"})]}),(0,t.jsx)(p.Switch,{checked:P.is_test_mode,onCheckedChange:e=>T({...P,is_test_mode:e})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)(h.Label,{children:"Activer Stripe"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Activez les paiements Stripe pour votre organisation"})]}),(0,t.jsx)(p.Switch,{checked:P.is_active,onCheckedChange:e=>T({...P,is_active:e})})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)(o.Button,{onClick:()=>A.mutate(),variant:"outline",disabled:A.isPending||!P.publishable_key||!P.secret_key,children:[(0,t.jsx)(y,{className:"h-4 w-4 mr-2"}),A.isPending?"Test en cours...":"Tester la connexion"]}),(0,t.jsxs)(o.Button,{onClick:()=>M.mutate(P),disabled:M.isPending||!P.publishable_key||!P.secret_key,children:[(0,t.jsx)(b.Save,{className:"h-4 w-4 mr-2"}),M.isPending?"Sauvegarde...":"Sauvegarder"]})]}),A.isSuccess&&(0,t.jsx)(d.Card,{className:"border-green-200 bg-green-50",children:(0,t.jsx)(d.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-green-800",children:[(0,t.jsx)(j.CheckCircle,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-semibold",children:"Connexion réussie"})]})})}),A.isError&&(0,t.jsx)(d.Card,{className:"border-red-200 bg-red-50",children:(0,t.jsxs)(d.CardContent,{className:"pt-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-red-800",children:[(0,t.jsx)(f.AlertCircle,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"font-semibold",children:"Erreur de connexion"})]}),(0,t.jsx)("p",{className:"text-sm text-red-700 mt-2",children:A.error instanceof Error?A.error.message:"Erreur inconnue"})]})})]})}e.s(["default",()=>N],356786)}]);