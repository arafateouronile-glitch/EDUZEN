(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,871689,e=>{"use strict";let t=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],871689)},645760,e=>{"use strict";var t=e.i(843476),a=e.i(271645),i=e.i(647163);e.i(882205);var s=e.i(846932);let r=a.forwardRef(({className:e,variant:a="default",hoverable:r=!1,glow:o=!1,glowColor:n="rgba(51, 90, 207, 0.3)",...l},d)=>(0,t.jsxs)(s.motion.div,{ref:d,className:(0,i.cn)("relative rounded-2xl border backdrop-blur-xl transition-all duration-300",{"bg-white/70 dark:bg-gray-900/70 border-white/20 dark:border-gray-700/30 shadow-lg":"default"===a,"bg-white/80 dark:bg-gray-900/80 border-white/30 dark:border-gray-700/40 shadow-xl":"premium"===a,"bg-white/50 dark:bg-gray-900/50 border-white/10 dark:border-gray-700/20 shadow-md":"subtle"===a,"cursor-pointer":r,"hover:shadow-2xl hover:scale-[1.02]":r,"hover:bg-white/90 dark:hover:bg-gray-900/90":r},e),whileHover:r?{scale:1.02,y:-2}:void 0,transition:{type:"spring",stiffness:300,damping:30},...l,children:[o&&(0,t.jsx)(s.motion.div,{className:"absolute inset-0 rounded-2xl opacity-0 blur-xl",style:{background:`radial-gradient(circle, ${n} 0%, transparent 70%)`},animate:{opacity:[0,.5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"}}),(0,t.jsx)("div",{className:"relative z-10",children:l.children})]}));r.displayName="GlassCard",e.s(["GlassCard",()=>r])},605631,e=>{"use strict";let t=(0,e.i(475254).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],605631)},356909,e=>{"use strict";let t=(0,e.i(475254).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);e.s(["Save",()=>t],356909)},212426,e=>{"use strict";let t=(0,e.i(475254).default)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);e.s(["DollarSign",()=>t],212426)},683909,e=>{"use strict";var t=e.i(920755);let a=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getAllPrograms(e,t){let a=this.supabase.from("programs").select("*").eq("organization_id",e);t?.isActive!==void 0&&(a=a.eq("is_active",t.isActive)),t?.search&&(a=a.or(`name.ilike.%${t.search}%,code.ilike.%${t.search}%,description.ilike.%${t.search}%`));let{data:i,error:s}=await a.order("created_at",{ascending:!1});if(s)throw s;return i}async getProgramById(e){let{data:t,error:a}=await this.supabase.from("programs").select(`
        *,
        formations(*)
      `).eq("id",e).single();if(a)throw a;return t}async createProgram(e){let{data:t,error:a}=await this.supabase.from("programs").insert(e).select().single();if(a)throw a;return t}async updateProgram(e,t){let{data:a,error:i}=await this.supabase.from("programs").update(t).eq("id",e).select().single();if(i)throw i;return a}async deleteProgram(e){return this.updateProgram(e,{is_active:!1})}async getFormationsByProgram(e){let{data:t,error:a}=await this.supabase.from("formations").select("*").eq("program_id",e).order("created_at",{ascending:!1});if(a)throw a;return t}async getGlobalStats(e){let{data:t,error:a}=await this.supabase.from("programs").select("id, is_active, created_at").eq("organization_id",e);if(a)throw a;let i=t||[],s=i.length,r=i.filter(e=>e.is_active).length,o=i.filter(e=>!e.is_active).length,n=0,l=i.map(e=>e.id);if(l.length>0){let{count:e,error:t}=await this.supabase.from("formations").select("*",{count:"exact",head:!0}).in("program_id",l);if(t)throw t;n=e||0}let d=0;if(l.length>0){let{data:e,error:t}=await this.supabase.from("formations").select("id").in("program_id",l);if(t)throw t;let a=e?.map(e=>e.id)||[];if(a.length>0){let{count:e,error:t}=await this.supabase.from("sessions").select("*",{count:"exact",head:!0}).in("formation_id",a);if(t)throw t;d=e||0}}let c=0;if(l.length>0){let{data:e,error:t}=await this.supabase.from("formations").select("id").in("program_id",l);if(t)throw t;let a=e?.map(e=>e.id)||[];if(a.length>0){let{data:e,error:t}=await this.supabase.from("sessions").select("id").in("formation_id",a);if(t)throw t;let i=e?.map(e=>e.id)||[];if(i.length>0){let{count:e,error:t}=await this.supabase.from("enrollments").select("*",{count:"exact",head:!0}).in("session_id",i);if(t)throw t;c=e||0}}}let u=[{name:"Actifs",value:r,color:"#335ACF"},{name:"Inactifs",value:o,color:"#6B7280"}].filter(e=>e.value>0),m={};return i.forEach(e=>{if(e.created_at){let t=new Date(e.created_at),a=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`;m[a]=(m[a]||0)+1}}),{total:s,active:r,inactive:o,totalFormations:n,totalSessions:d,totalEnrollments:c,statusData:u,monthlyData:Object.entries(m).sort(([e],[t])=>e.localeCompare(t)).slice(-6).map(([e,t])=>({month:new Date(e+"-01").toLocaleDateString("fr-FR",{month:"short",year:"numeric"}),programmes:t}))}}};e.s(["programService",0,a])},174886,e=>{"use strict";let t=(0,e.i(475254).default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);e.s(["Copy",()=>t],174886)},209372,e=>{"use strict";var t=e.i(50270);let a=t.z.object({first_name:t.z.string().min(1,"Le prénom est requis").max(100,"Le prénom est trop long"),last_name:t.z.string().min(1,"Le nom est requis").max(100,"Le nom est trop long"),date_of_birth:t.z.string().optional().or(t.z.literal("")),gender:t.z.enum(["male","female","other"]).optional().or(t.z.literal("")),email:t.z.string().email("Email invalide").optional().or(t.z.literal("")),phone:t.z.string().optional().or(t.z.literal("")),address:t.z.string().optional().or(t.z.literal("")),city:t.z.string().optional().or(t.z.literal("")),class_id:t.z.string().optional().or(t.z.literal("")),enrollment_date:t.z.string().min(1,"La date d'inscription est requise"),guardian_first_name:t.z.string().min(1,"Le prénom du tuteur est requis"),guardian_last_name:t.z.string().min(1,"Le nom du tuteur est requis"),guardian_relationship:t.z.enum(["parent","guardian","other"]).default("parent"),guardian_phone_primary:t.z.string().min(1,"Le téléphone principal du tuteur est requis"),guardian_phone_secondary:t.z.string().optional().or(t.z.literal("")),guardian_email:t.z.string().email("Email invalide").optional().or(t.z.literal("")),guardian_address:t.z.string().optional().or(t.z.literal(""))});t.z.object({first_name:t.z.string().min(1,"Le prénom est requis").max(100,"Le prénom est trop long"),last_name:t.z.string().min(1,"Le nom est requis").max(100,"Le nom est trop long"),date_of_birth:t.z.string().optional().or(t.z.literal("")),gender:t.z.enum(["male","female","other"]).optional().or(t.z.literal("")),email:t.z.string().email("Email invalide").optional().or(t.z.literal("")),phone:t.z.string().optional().or(t.z.literal("")),address:t.z.string().optional().or(t.z.literal("")),city:t.z.string().optional().or(t.z.literal("")),class_id:t.z.string().optional().or(t.z.literal("")),enrollment_date:t.z.string().min(1,"La date d'inscription est requise"),status:t.z.enum(["active","inactive","graduated"]).default("active")});let i=t.z.object({code:t.z.string().min(1,"Le code est requis").max(50,"Le code est trop long"),name:t.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),subtitle:t.z.string().optional().or(t.z.literal("")),description:t.z.string().optional().or(t.z.literal("")),category:t.z.string().optional().or(t.z.literal("")),program_version:t.z.string().optional().or(t.z.literal("")),version_date:t.z.string().optional().or(t.z.literal("")),duration_hours:t.z.string().optional().or(t.z.literal("")),duration_days:t.z.string().optional().or(t.z.literal("")),photo_url:t.z.string().url("URL invalide").optional().or(t.z.literal("")),price:t.z.string().optional().or(t.z.literal("")),price_enterprise:t.z.string().optional().or(t.z.literal("")),price_individual:t.z.string().optional().or(t.z.literal("")),price_freelance:t.z.string().optional().or(t.z.literal("")),currency:t.z.string().default("XOF"),payment_plan:t.z.enum(["full","installment","free"]).default("full"),published_online:t.z.boolean().default(!1),is_public:t.z.boolean().default(!1),eligible_cpf:t.z.boolean().default(!1),cpf_code:t.z.string().optional().or(t.z.literal("")),modalities:t.z.string().optional().or(t.z.literal("")),training_action_type:t.z.string().optional().or(t.z.literal("")),pedagogical_objectives:t.z.string().optional().or(t.z.literal("")),learner_profile:t.z.string().optional().or(t.z.literal("")),training_content:t.z.string().optional().or(t.z.literal("")),execution_follow_up:t.z.string().optional().or(t.z.literal("")),certification_modalities:t.z.string().optional().or(t.z.literal("")),quality:t.z.string().optional().or(t.z.literal("")),accounting_product_config:t.z.string().optional().or(t.z.literal("")),edof_export_fields:t.z.string().optional().or(t.z.literal("")),competence_domains:t.z.string().optional().or(t.z.literal("")),prerequisites:t.z.string().optional().or(t.z.literal("")),capacity_max:t.z.string().optional().or(t.z.literal("")),age_min:t.z.string().optional().or(t.z.literal("")),age_max:t.z.string().optional().or(t.z.literal("")),certification_issued:t.z.boolean().default(!1),is_active:t.z.boolean().default(!0)}),s=t.z.object({program_id:t.z.string().min(1,"Le programme est requis"),code:t.z.string().min(1,"Le code est requis").max(50,"Le code est trop long"),name:t.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),subtitle:t.z.string().optional().or(t.z.literal("")),photo_url:t.z.string().url("URL invalide").optional().or(t.z.literal("")),category:t.z.string().optional().or(t.z.literal("")),description:t.z.string().optional().or(t.z.literal("")),program_version:t.z.string().optional().or(t.z.literal("")),version_date:t.z.string().optional().or(t.z.literal("")),duration_hours:t.z.string().optional().or(t.z.literal("")),duration_days:t.z.string().optional().or(t.z.literal("")),duration_unit:t.z.enum(["hours","days"]).default("hours"),price:t.z.string().optional().or(t.z.literal("")),currency:t.z.string().default("XOF"),payment_plan:t.z.enum(["full","installment","free"]).default("full"),published_online:t.z.boolean().default(!1),eligible_cpf:t.z.boolean().default(!1),cpf_code:t.z.string().optional().or(t.z.literal("")),modalities:t.z.string().optional().or(t.z.literal("")),training_action_type:t.z.string().optional().or(t.z.literal("")),pedagogical_objectives:t.z.string().optional().or(t.z.literal("")),learner_profile:t.z.string().optional().or(t.z.literal("")),training_content:t.z.string().optional().or(t.z.literal("")),execution_follow_up:t.z.string().optional().or(t.z.literal("")),certification_modalities:t.z.string().optional().or(t.z.literal("")),quality:t.z.string().optional().or(t.z.literal("")),accounting_product_config:t.z.string().optional().or(t.z.literal("")),edof_export_fields:t.z.string().optional().or(t.z.literal("")),competence_domains:t.z.string().optional().or(t.z.literal("")),prerequisites:t.z.string().optional().or(t.z.literal("")),capacity_max:t.z.string().optional().or(t.z.literal("")),age_min:t.z.string().optional().or(t.z.literal("")),age_max:t.z.string().optional().or(t.z.literal("")),certification_issued:t.z.boolean().default(!1),is_active:t.z.boolean().default(!0)}),r=t.z.object({formation_id:t.z.string().min(1,"La formation est requise"),name:t.z.string().min(1,"Le nom est requis").max(200,"Le nom est trop long"),code:t.z.string().optional().or(t.z.literal("")),start_date:t.z.string().min(1,"La date de début est requise"),end_date:t.z.string().min(1,"La date de fin est requise"),start_time:t.z.string().optional().or(t.z.literal("")),end_time:t.z.string().optional().or(t.z.literal("")),location:t.z.string().optional().or(t.z.literal("")),capacity_max:t.z.string().optional().or(t.z.literal("")).refine(e=>{if(!e)return!0;let t=parseInt(e);return!isNaN(t)&&t>0},"La capacité maximale doit être un nombre entier positif"),currency:t.z.string().default("XOF"),status:t.z.enum(["planned","ongoing","completed","cancelled"]).default("planned"),teacher_id:t.z.string().optional().or(t.z.literal("")),manager1_id:t.z.string().optional().or(t.z.literal("")),manager2_id:t.z.string().optional().or(t.z.literal("")),inter_entreprise:t.z.boolean().default(!0),sous_traitance:t.z.boolean().default(!1),timezone:t.z.string().default("Europe/Paris"),program_ids:t.z.array(t.z.string()).default([])}).refine(e=>!e.start_date||!e.end_date||new Date(e.end_date)>=new Date(e.start_date),{message:"La date de fin doit être postérieure à la date de début",path:["end_date"]}),o=t.z.object({student_id:t.z.string().min(1,"L'étudiant est requis"),session_id:t.z.string().optional().or(t.z.literal("")),subject:t.z.string().min(1,"Le sujet est requis").max(200,"Le sujet est trop long"),assessment_type:t.z.enum(["pre_formation","hot","cold","manager","instructor","funder","quiz","exam","project","other"]).default("quiz"),score:t.z.string().min(1,"La note est requise").refine(e=>{let t=parseFloat(e);return!isNaN(t)&&t>=0},"La note doit être un nombre valide"),max_score:t.z.string().optional().or(t.z.literal("")).refine(e=>{if(!e)return!0;let t=parseFloat(e);return!isNaN(t)&&t>0},"La note maximale doit être un nombre valide supérieur à 0"),notes:t.z.string().optional().or(t.z.literal("")),graded_at:t.z.string().min(1,"La date d'évaluation est requise"),coefficient:t.z.string().optional().or(t.z.literal("")).refine(e=>{if(!e)return!0;let t=parseFloat(e);return!isNaN(t)&&t>0},"Le coefficient doit être un nombre valide supérieur à 0"),is_makeup:t.z.boolean().optional().default(!1),original_grade_id:t.z.string().optional().or(t.z.literal("")),appreciation:t.z.string().optional().or(t.z.literal("")),term_period:t.z.enum(["Q1","Q2","Q3","Q4","S1","S2","T1","T2","T3"]).optional().or(t.z.literal("")),academic_year_id:t.z.string().optional().or(t.z.literal(""))}).refine(e=>!e.max_score||!e.score||parseFloat(e.score)<=parseFloat(e.max_score),{message:"La note ne peut pas être supérieure à la note maximale",path:["score"]}),n=t.z.object({student_id:t.z.string().min(1,"L'étudiant est requis"),document_type:t.z.enum(["quote","invoice"]).default("invoice"),invoice_number:t.z.string().optional().or(t.z.literal("")),type:t.z.enum(["tuition","registration","other"]).default("tuition"),issue_date:t.z.string().min(1,"La date d'émission est requise"),due_date:t.z.string().min(1,"La date d'échéance est requise"),amount:t.z.string().min(1,"Le montant est requis").refine(e=>{let t=parseFloat(e);return!isNaN(t)&&t>=0},"Le montant doit être un nombre valide supérieur ou égal à 0"),tax_amount:t.z.string().optional().or(t.z.literal("")).refine(e=>{if(!e)return!0;let t=parseFloat(e);return!isNaN(t)&&t>=0},"Le montant de la taxe doit être un nombre valide supérieur ou égal à 0"),currency:t.z.string().default("XOF"),status:t.z.enum(["draft","sent","partial","paid","overdue","cancelled"]).default("draft"),notes:t.z.string().optional().or(t.z.literal("")),enrollment_id:t.z.string().optional().or(t.z.literal(""))}).refine(e=>!e.issue_date||!e.due_date||new Date(e.due_date)>=new Date(e.issue_date),{message:"La date d'échéance doit être postérieure à la date d'émission",path:["due_date"]});t.z.object({invoice_id:t.z.string().min(1,"La facture est requise"),student_id:t.z.string().min(1,"L'étudiant est requis"),amount:t.z.string().min(1,"Le montant est requis").refine(e=>{let t=parseFloat(e);return!isNaN(t)&&t>0},"Le montant doit être un nombre valide supérieur à 0"),currency:t.z.string().default("XOF"),payment_method:t.z.enum(["cash","mobile_money","card","bank_transfer"]).default("cash"),payment_provider:t.z.enum(["mtn","orange","airtel","wave"]).optional().or(t.z.literal("")),transaction_id:t.z.string().optional().or(t.z.literal("")),paid_at:t.z.string().optional().or(t.z.literal("")),notes:t.z.string().optional().or(t.z.literal(""))});let l=t.z.object({student_id:t.z.string().min(1,"L'étudiant est requis"),session_id:t.z.string().min(1,"La session est requise"),enrollment_date:t.z.string().min(1,"La date d'inscription est requise"),status:t.z.enum(["pending","confirmed","completed","cancelled","failed"]).default("confirmed"),payment_status:t.z.enum(["pending","partial","paid","overdue"]).default("pending"),total_amount:t.z.string().optional().or(t.z.literal("")).refine(e=>{if(!e)return!0;let t=parseFloat(e);return!isNaN(t)&&t>=0},"Le montant total doit être un nombre valide supérieur ou égal à 0"),paid_amount:t.z.string().optional().or(t.z.literal("")).refine(e=>{if(!e)return!0;let t=parseFloat(e);return!isNaN(t)&&t>=0},"Le montant payé doit être un nombre valide supérieur ou égal à 0")}).refine(e=>{if(e.total_amount&&e.paid_amount){let t=parseFloat(e.total_amount),a=parseFloat(e.paid_amount);if(!isNaN(t)&&!isNaN(a)&&a>t)return!1}return!0},{message:"Le montant payé ne peut pas dépasser le montant total",path:["paid_amount"]});e.s(["enrollmentSchema",0,l,"evaluationSchema",0,o,"formationSchema",0,s,"invoiceSchema",0,n,"programSchema",0,i,"sessionSchema",0,r,"studentSchema",0,a])},2034,e=>{"use strict";var t=e.i(920755);let a=async(e,t)=>(console.warn("videoconferenceService.createMeetingForSession not implemented"),null),i=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getAllSessions(e,t){let a=this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",e);t?.formationId&&(a=a.eq("formation_id",t.formationId)),t?.status&&(a=a.eq("status",t.status)),t?.startDate&&(a=a.gte("start_date",t.startDate)),t?.endDate&&(a=a.lte("end_date",t.endDate)),t?.search&&(a=a.ilike("name",`%${t.search}%`));let{data:i,error:s}=await a.order("start_date",{ascending:!0});if(s)throw s;return i}async getSessionById(e){let{data:t,error:a}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("id",e).single();if(a)throw a;let{data:i,error:s}=await this.supabase.from("session_programs").select(`
        program_id,
        programs(*)
      `).eq("session_id",e);if(s)throw s;return{...t,session_programs:i?.map(e=>e.programs).filter(Boolean)||[]}}async createSession(e,t,a){if(e.formation_id){let{data:t,error:a}=await this.supabase.from("formations").select("id, organization_id").eq("id",e.formation_id).single();if(a)throw console.error("Erreur lors de la vérification de la formation:",a),Error(`Formation non trouv\xe9e: ${a.message}`);if(!t)throw Error("Formation non trouvée");console.log("Formation trouvée:",t)}let{data:i,error:s}=await this.supabase.from("sessions").insert(e).select().single();if(s)throw console.error("Erreur RLS lors de la création de la session:",{code:s.code,message:s.message,details:s.details,hint:s.hint,formation_id:e.formation_id}),s;if(t&&t.length>0&&i){let{data:e}=await this.supabase.from("formations").select("organization_id").eq("id",i.formation_id).single();if(e){let a=t.map(t=>({session_id:i.id,program_id:t,organization_id:e.organization_id})),{error:s}=await this.supabase.from("session_programs").insert(a);s&&console.error("Erreur lors de la création des associations session-programme:",s),e.organization_id&&await this.syncWithCalendars(i.id,e.organization_id,"create").catch(e=>{console.error("Erreur lors de la synchronisation calendrier:",e)}),e.organization_id&&await this.createVideoconferenceMeeting(i.id,e.organization_id).catch(e=>{console.error("Erreur lors de la création de la réunion visioconférence:",e)})}}return console.log("Session créée avec succès:",i),i}async updateSessionPrograms(e,t,a){let{error:i}=await this.supabase.from("session_programs").delete().eq("session_id",e);if(i)throw i;if(t.length>0){let i=t.map(t=>({session_id:e,program_id:t,organization_id:a})),{error:s}=await this.supabase.from("session_programs").insert(i);if(s)throw s}return!0}async getSessionPrograms(e){let{data:t,error:a}=await this.supabase.from("session_programs").select(`
        program_id,
        programs(*)
      `).eq("session_id",e);if(a)throw a;return t?.map(e=>e.programs).filter(Boolean)||[]}async updateSession(e,t){let{data:a}=await this.supabase.from("sessions").select("formation_id, formations(organization_id)").eq("id",e).single(),{data:i,error:s}=await this.supabase.from("sessions").update(t).eq("id",e).select().single();if(s)throw s;let r=a?.formations;return a&&r?.organization_id&&await this.syncWithCalendars(e,r.organization_id,"update").catch(e=>{console.error("Erreur lors de la synchronisation calendrier:",e)}),i}async deleteSession(e){let{data:t}=await this.supabase.from("sessions").select("formation_id, formations(organization_id)").eq("id",e).single(),a=t?.formations;t&&a?.organization_id&&await this.syncWithCalendars(e,a.organization_id,"delete").catch(e=>{console.error("Erreur lors de la suppression de l'événement calendrier:",e)});let{error:i}=await this.supabase.from("sessions").delete().eq("id",e);if(i)throw i}async createVideoconferenceMeeting(e,t){let{data:i}=await this.supabase.from("videoconference_integrations").select("*").eq("organization_id",t).eq("is_active",!0).eq("auto_create_meetings",!0);if(i&&0!==i.length)for(let s of i)try{await a(e,{organizationId:t,provider:s.provider})}catch(e){console.error(`Erreur lors de la cr\xe9ation de r\xe9union avec ${s.provider}:`,e)}}async syncWithCalendars(e,t,a){let{data:i}=await this.supabase.from("calendar_integrations").select("*").eq("organization_id",t).eq("is_active",!0).eq("sync_sessions",!0).eq("create_events_for_sessions",!0);if(i&&0!==i.length)for(let e of i)try{console.warn(`Calendar sync for ${a} not implemented yet for provider ${e.provider}`)}catch(t){console.error(`Erreur lors de la synchronisation avec ${e.provider}:`,t)}}async getUpcomingSessions(e,t=10){let a=new Date().toISOString().split("T")[0],{data:i,error:s}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",e).gte("start_date",a).eq("status","planned").order("start_date",{ascending:!0}).limit(t);if(s)throw s;return i}async getOngoingSessions(e){let t=new Date().toISOString().split("T")[0],{data:a,error:i}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",e).lte("start_date",t).gte("end_date",t).eq("status","ongoing").order("start_date",{ascending:!0});if(i)throw i;return a}async addSessionToFormations(e,t,a){let i=t.map((t,i)=>({session_id:e,formation_id:t,organization_id:a,order_index:i})),{data:s,error:r}=await this.supabase.from("formation_sessions").insert(i).select();if(r)throw r;return s}async removeSessionFromFormation(e,t){let{error:a}=await this.supabase.from("formation_sessions").delete().eq("session_id",e).eq("formation_id",t);if(a)throw a;return!0}async updateSessionFormations(e,t,a){let{error:i}=await this.supabase.from("formation_sessions").delete().eq("session_id",e);if(i)throw i;return t.length>0?this.addSessionToFormations(e,t,a):[]}async getSessionFormations(e){let{data:t,error:a}=await this.supabase.from("formation_sessions").select(`
        formation_id,
        order_index,
        formations(*)
      `).eq("session_id",e).order("order_index",{ascending:!0});if(a)throw a;return t?.map(e=>e.formations).filter(Boolean)||[]}async getFormationSessions(e){let{data:t,error:a}=await this.supabase.from("formation_sessions").select(`
        session_id,
        order_index,
        sessions(*)
      `).eq("formation_id",e).order("order_index",{ascending:!0});if(a)throw a;return t?.map(e=>e.sessions).filter(Boolean)||[]}async createIndependentSession(e,t,a){let{data:i,error:s}=await this.supabase.from("sessions").insert({...e,formation_id:null}).select().single();if(s)throw s;return t&&t.length>0&&i&&await this.updateSessionPrograms(i.id,t,e.organization_id),a&&a.length>0&&i&&await this.addSessionToFormations(i.id,a,e.organization_id),i}};e.s(["sessionService",0,i],2034)},1262,e=>{"use strict";var t=e.i(920755);let a=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getAllFormations(e,t){let a=this.supabase.from("formations").select(`
        *,
        programs(*)
      `).eq("organization_id",e);t?.programId&&(a=a.eq("program_id",t.programId)),t?.isActive!==void 0&&(a=a.eq("is_active",t.isActive)),t?.search&&(a=a.or(`name.ilike.%${t.search}%,code.ilike.%${t.search}%,description.ilike.%${t.search}%`));let{data:i,error:s}=await a.order("created_at",{ascending:!1});if(s)throw s;return i}async getFormationById(e){let{data:t,error:a}=await this.supabase.from("formations").select(`
        *,
        programs(*),
        sessions(*)
      `).eq("id",e).single();if(a)throw a;return t}async createFormation(e){let{data:t,error:a}=await this.supabase.from("formations").insert(e).select().single();if(a)throw a;return t}async updateFormation(e,t){let{data:a,error:i}=await this.supabase.from("formations").update(t).eq("id",e).select().single();if(i)throw i;return a}async deleteFormation(e){return this.updateFormation(e,{is_active:!1})}async getSessionsByFormation(e){let{data:t,error:a}=await this.supabase.from("sessions").select("*").eq("formation_id",e).order("start_date",{ascending:!0});if(a)throw a;return t}async getAllSessionsForFormation(e){let{data:t,error:a}=await this.supabase.from("formation_sessions").select(`
        session_id,
        order_index,
        sessions(*)
      `).eq("formation_id",e).order("order_index",{ascending:!0});if(a)throw a;let{data:i,error:s}=await this.supabase.from("sessions").select("*").eq("formation_id",e).order("start_date",{ascending:!0});if(s)throw s;let r=t?.map(e=>e.sessions).filter(Boolean)||[],o=[...r],n=new Set(r.map(e=>e.id));for(let e of i||[])n.has(e.id)||o.push(e);return o}async addSessionsToFormation(e,t,a){let i=t.map((t,i)=>({formation_id:e,session_id:t,organization_id:a,order_index:i})),{data:s,error:r}=await this.supabase.from("formation_sessions").insert(i).select();if(r)throw r;return s}async removeSessionFromFormation(e,t){let{error:a}=await this.supabase.from("formation_sessions").delete().eq("formation_id",e).eq("session_id",t);if(a)throw a;return!0}async updateFormationSessions(e,t,a){let{error:i}=await this.supabase.from("formation_sessions").delete().eq("formation_id",e);if(i)throw i;return t.length>0?this.addSessionsToFormation(e,t,a):[]}async getFormationWithAllSessions(e){let t=await this.getFormationById(e);if(!t)return null;let a=await this.getAllSessionsForFormation(e);return{...t,all_sessions:a}}};e.s(["formationService",0,a])},39312,e=>{"use strict";let t=(0,e.i(475254).default)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);e.s(["Zap",()=>t],39312)},3251,e=>{"use strict";var t=e.i(920755);let a=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getBySessionId(e){let{data:t,error:a}=await this.supabase.from("session_slots").select("*").eq("session_id",e).order("date",{ascending:!0}).order("start_time",{ascending:!0});if(a)throw a;return t||[]}async getById(e){let{data:t,error:a}=await this.supabase.from("session_slots").select("*").eq("id",e).single();if(a)throw a;return t}async create(e){let{data:t,error:a}=await this.supabase.from("session_slots").insert(e).select().single();if(a)throw a;return t}async update(e,t){let{data:a,error:i}=await this.supabase.from("session_slots").update(t).eq("id",e).select().single();if(i)throw i;return a}async delete(e){let{error:t}=await this.supabase.from("session_slots").delete().eq("id",e);if(t)throw t}async generateSlots(e){let{sessionId:t,startDate:a,endDate:i,timeSlotType:s,morningStart:r,morningEnd:o,afternoonStart:n,afternoonEnd:l,location:d,teacherId:c,capacityMax:u}=e,m=r||"09:00",p=o||"12:00",g=n||"14:00",f=l||"17:00",_=[],h=new Date(a),z=new Date(i),b=new Date(h);for(;b<=z;){let e=b.getDay();0!==e&&6!==e&&_.push(b.toISOString().split("T")[0]),b.setDate(b.getDate()+1)}let y=[];for(let e of _)("morning"===s||"both"===s)&&y.push({session_id:t,date:e,time_slot:"morning",start_time:m,end_time:p,location:d||null,teacher_id:c||null,capacity_max:u||null}),("afternoon"===s||"both"===s)&&y.push({session_id:t,date:e,time_slot:"afternoon",start_time:g,end_time:f,location:d||null,teacher_id:c||null,capacity_max:u||null}),"full_day"===s&&y.push({session_id:t,date:e,time_slot:"full_day",start_time:m,end_time:f,location:d||null,teacher_id:c||null,capacity_max:u||null});let{error:w}=await this.supabase.from("session_slots").delete().eq("session_id",t);if(w)throw w;if(y.length>0){let{data:e,error:t}=await this.supabase.from("session_slots").insert(y).select();if(t)throw t;return e}return[]}async deleteBySessionId(e){let{error:t}=await this.supabase.from("session_slots").delete().eq("session_id",e);if(t)throw t}};e.s(["sessionSlotService",0,a])},178088,e=>{"use strict";var t=e.i(920755);let a=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getAll(e,t){let a=this.supabase.from("grades").select(`
        *,
        students(id, first_name, last_name, student_number),
        sessions(id, name, formations(name, programs(name))),
        users(id, full_name)
      `).eq("organization_id",e).order("graded_at",{ascending:!1});t?.sessionId&&(a=a.eq("session_id",t.sessionId)),t?.studentId&&(a=a.eq("student_id",t.studentId)),t?.subject&&(a=a.ilike("subject",`%${t.subject}%`)),t?.assessmentType&&(a=a.eq("assessment_type",t.assessmentType)),t?.startDate&&(a=a.gte("graded_at",t.startDate)),t?.endDate&&(a=a.lte("graded_at",t.endDate)),t?.termPeriod&&(a=a.eq("term_period",t.termPeriod)),t?.academicYearId&&(a=a.eq("academic_year_id",t.academicYearId)),t?.isMakeup!==void 0&&(a=a.eq("is_makeup",t.isMakeup));let{data:i,error:s}=await a;if(s&&("PGRST116"===s.code||s.message?.includes("relationship")||s.message?.includes("Could not find")||400===s.status)){let a=this.supabase.from("grades").select("*").eq("organization_id",e).order("graded_at",{ascending:!1});t?.sessionId&&(a=a.eq("session_id",t.sessionId)),t?.studentId&&(a=a.eq("student_id",t.studentId)),t?.subject&&(a=a.ilike("subject",`%${t.subject}%`)),t?.assessmentType&&(a=a.eq("assessment_type",t.assessmentType)),t?.startDate&&(a=a.gte("graded_at",t.startDate)),t?.endDate&&(a=a.lte("graded_at",t.endDate)),t?.termPeriod&&(a=a.eq("term_period",t.termPeriod)),t?.academicYearId&&(a=a.eq("academic_year_id",t.academicYearId)),t?.isMakeup!==void 0&&(a=a.eq("is_makeup",t.isMakeup));let{data:i,error:s}=await a;if(s)throw s;return i||[]}if(s)throw s;return i||[]}async getById(e){try{let{data:t,error:a}=await this.supabase.from("grades").select(`
          *,
          students(id, first_name, last_name, student_number),
          sessions(id, name, formations(name, programs(name))),
          users(id, full_name)
        `).eq("id",e).single();if(a){if("PGRST116"===a.code||a.message?.includes("relationship")||a.message?.includes("Could not find")||400===a.status){let{data:t,error:a}=await this.supabase.from("grades").select("*").eq("id",e).single();if(a)throw a;return t}throw a}return t}catch(e){throw e}}async create(e,t){let a=t.assessment_type,i={...t,organization_id:e,assessment_type:a,coefficient:t.coefficient??1,is_makeup:t.is_makeup??!1,graded_at:t.graded_at||new Date().toISOString()};delete i.percentage,Object.keys(i).forEach(e=>{void 0===i[e]&&(i[e]=null)});let s=["pre_formation","hot","cold","manager","instructor","funder","quiz","exam","project","other"];i.assessment_type&&!s.includes(i.assessment_type)&&(console.error("❌ [EVALUATION SERVICE] assessment_type invalide:",{received:i.assessment_type,validTypes:s}),i.assessment_type="other");let{data:r,error:o}=await this.supabase.from("grades").insert(i).select("id, subject, score, max_score, percentage, organization_id, session_id, student_id, teacher_id, assessment_type, notes, graded_at, created_at").single();if(o)throw console.error("Erreur insertion évaluation:",o),o;return r}async createMakeup(e,t,a){let i={...a,organization_id:e,coefficient:a.coefficient??1,is_makeup:!0,original_grade_id:t,graded_at:a.graded_at||new Date().toISOString()};delete i.percentage,Object.keys(i).forEach(e=>{void 0===i[e]&&(i[e]=null)});let{data:s,error:r}=await this.supabase.from("grades").insert(i).select("id, subject, score, max_score, percentage, organization_id, session_id, student_id, teacher_id, assessment_type, notes, graded_at, created_at").single();if(r)throw r;return s}async calculateWeightedAverage(e,t,a,i,s){let r=await this.getAll(e,{studentId:t,sessionId:a,termPeriod:i,academicYearId:s,isMakeup:!1});if(0===r.length)return null;let o=0,n=0;return(r.forEach(e=>{let t=e.coefficient||1,a=e.max_score||1,i=e.score;a>0&&null!=i&&(o+=i/a*20*t,n+=t)}),0===n)?null:Math.round(o/n*100)/100}async update(e,t){let a={...t,updated_at:new Date().toISOString()};delete a.percentage,Object.keys(a).forEach(e=>{void 0===a[e]&&delete a[e]});let{data:i,error:s}=await this.supabase.from("grades").update(a).eq("id",e).select("id, subject, score, max_score, percentage, organization_id, session_id, student_id, teacher_id, assessment_type, notes, graded_at, created_at, updated_at").single();if(s)throw s;return i}async delete(e){let{error:t}=await this.supabase.from("grades").delete().eq("id",e);if(t)throw t}async getStats(e,t){let a=await this.getAll(e,t),i={total:a.length,byType:{},averageScore:0,averagePercentage:0,bySubject:{}};if(0===a.length)return i;let s=0,r=0,o=0,n=0;return a.forEach(e=>{let t=e.assessment_type||"other";i.byType[t]=(i.byType[t]||0)+1;let a=e.subject;i.bySubject[a]||(i.bySubject[a]={count:0,average:0}),i.bySubject[a].count++,null!==e.score&&void 0!==e.score&&(s+=e.score),e.max_score&&(r+=e.max_score),null!==e.percentage&&void 0!==e.percentage&&(o+=e.percentage,n++)}),i.averageScore=r>0?s/a.length:0,i.averagePercentage=n>0?o/n:0,Object.keys(i.bySubject).forEach(e=>{let t=a.filter(t=>t.subject===e),s=t.reduce((e,t)=>e+(t.score||0),0);i.bySubject[e].average=s/t.length}),i}async createBulk(e,t){let a=t.map(t=>{let a={...t,organization_id:e,graded_at:t.graded_at||new Date().toISOString()};return delete a.percentage,Object.keys(a).forEach(e=>{void 0===a[e]&&(a[e]=null)}),a}),{data:i,error:s}=await this.supabase.from("grades").insert(a).select("*");if(s)throw s;if(!i||0===i.length)return[];try{let e=i.map(e=>e.id),{data:t,error:a}=await this.supabase.from("grades").select(`
          *,
          students(id, first_name, last_name, student_number),
          sessions(id, name),
          users(id, full_name)
        `).in("id",e);if(a)return i;return t||[]}catch{return i}}};e.s(["evaluationService",0,a])},260970,e=>{e.v(t=>Promise.all(["static/chunks/c08c8ee15db780a3.js"].map(t=>e.l(t))).then(()=>t(727545)))},637711,e=>{e.v(t=>Promise.all(["static/chunks/2cdae26eb0c82b85.js"].map(t=>e.l(t))).then(()=>t(972469)))},407155,e=>{e.v(t=>Promise.all(["static/chunks/51c2f9f9b1d8bcdd.js"].map(t=>e.l(t))).then(()=>t(469399)))},163882,e=>{e.v(t=>Promise.all(["static/chunks/f60aec59cfe25281.js"].map(t=>e.l(t))).then(()=>t(732894)))},97042,e=>{e.v(t=>Promise.all(["static/chunks/5ee4872835bf87b2.js"].map(t=>e.l(t))).then(()=>t(304488)))},500160,e=>{e.v(t=>Promise.all(["static/chunks/dc07597df03bc2a6.js","static/chunks/903ed9e7ed0922e9.js","static/chunks/10b78499cd8a9065.js","static/chunks/5300170f7be2fe9b.js","static/chunks/803f55d4d602e61a.js","static/chunks/2988bfaf82a45b76.js","static/chunks/43086a2a84e2a107.js"].map(t=>e.l(t))).then(()=>t(373578)))},815865,e=>{e.v(t=>Promise.all(["static/chunks/45f1009ee94bb983.js","static/chunks/903ed9e7ed0922e9.js","static/chunks/10b78499cd8a9065.js","static/chunks/803f55d4d602e61a.js","static/chunks/5300170f7be2fe9b.js","static/chunks/2988bfaf82a45b76.js","static/chunks/43086a2a84e2a107.js"].map(t=>e.l(t))).then(()=>t(233009)))},483325,e=>{e.v(t=>Promise.all(["static/chunks/fdf0b290d3e9e804.js"].map(t=>e.l(t))).then(()=>t(292364)))},280612,e=>{e.v(t=>Promise.all(["static/chunks/65b61fa741e49265.js","static/chunks/10b78499cd8a9065.js","static/chunks/163cc0e02fb9e71e.js","static/chunks/2988bfaf82a45b76.js","static/chunks/803f55d4d602e61a.js","static/chunks/1e360aeb641bc4dd.js","static/chunks/903ed9e7ed0922e9.js","static/chunks/5300170f7be2fe9b.js"].map(t=>e.l(t))).then(()=>t(698512)))},327362,e=>{e.v(t=>Promise.all(["static/chunks/91e36ffd63c17714.js","static/chunks/903ed9e7ed0922e9.js","static/chunks/10b78499cd8a9065.js","static/chunks/803f55d4d602e61a.js","static/chunks/5300170f7be2fe9b.js","static/chunks/2988bfaf82a45b76.js","static/chunks/43086a2a84e2a107.js"].map(t=>e.l(t))).then(()=>t(291871)))},362844,e=>{e.v(t=>Promise.all(["static/chunks/00f5ba31fa4890c1.js"].map(t=>e.l(t))).then(()=>t(368726)))},17409,e=>{e.v(t=>Promise.all(["static/chunks/c95f1ad73bb02b05.js","static/chunks/10b78499cd8a9065.js","static/chunks/43086a2a84e2a107.js","static/chunks/e355080f408210e6.js","static/chunks/803f55d4d602e61a.js","static/chunks/5300170f7be2fe9b.js","static/chunks/2988bfaf82a45b76.js","static/chunks/903ed9e7ed0922e9.js"].map(t=>e.l(t))).then(()=>t(486258)))},796136,e=>{e.v(t=>Promise.all(["static/chunks/35e9d40a3003c45b.js","static/chunks/10b78499cd8a9065.js","static/chunks/2988bfaf82a45b76.js","static/chunks/41086c9be2ebf101.js","static/chunks/41266bab88be07f1.js","static/chunks/803f55d4d602e61a.js","static/chunks/518ec66d848ebc0c.js","static/chunks/5300170f7be2fe9b.js","static/chunks/43086a2a84e2a107.js","static/chunks/903ed9e7ed0922e9.js"].map(t=>e.l(t))).then(()=>t(256221)))}]);