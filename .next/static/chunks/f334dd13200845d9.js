(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,107233,e=>{"use strict";let t=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],107233)},503116,e=>{"use strict";let t=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],503116)},286536,e=>{"use strict";let t=(0,e.i(475254).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],286536)},738308,e=>{"use strict";let t=(0,e.i(475254).default)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],738308)},436332,e=>{"use strict";let t=(0,e.i(475254).default)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);e.s(["Edit",()=>t],436332)},62870,e=>{"use strict";var t=e.i(843476),s=e.i(271645),i=e.i(647163);e.i(882205);var a=e.i(846932),r=e.i(88653),n=e.i(664659),l=e.i(898791);s.forwardRef(({className:e,label:o,error:c,helperText:d,variant:u="default",leftIcon:m,id:p,options:h,placeholder:g,value:x,...f},v)=>{let[_,y]=s.useState(!1),[j,w]=s.useState(!1),b=p||`select-${Math.random().toString(36).substr(2,9)}`,C=(0,i.cn)("flex w-full rounded-lg font-medium transition-all duration-300","appearance-none cursor-pointer","focus:outline-none focus:ring-2 focus:ring-primary/20","disabled:cursor-not-allowed disabled:opacity-50",{"border-2 border-input bg-background px-4 py-3 pr-11":"default"===u,"focus:border-primary focus:bg-white":"default"===u&&!c,"border-destructive focus:border-destructive focus:ring-destructive/20":c,"border-2 border-input bg-transparent px-4 py-3 pr-11":"outlined"===u,"focus:border-primary focus:shadow-md focus:shadow-primary/10":"outlined"===u&&!c,"border-0 border-b-2 border-input bg-muted/50 px-4 py-3 pr-11 rounded-b-none":"filled"===u,"focus:bg-muted focus:border-primary":"filled"===u&&!c,"focus:border-destructive bg-destructive/5":"filled"===u&&c},m&&"pl-11",e);return(0,t.jsxs)("div",{className:"w-full space-y-1.5",children:[o&&(0,t.jsxs)(a.motion.label,{htmlFor:b,initial:!1,animate:{color:c?"#EF4444":_?"rgb(37, 99, 235)":"rgb(107, 114, 128)"},className:(0,i.cn)("block text-sm font-medium transition-colors duration-200",c&&"text-destructive"),children:[o,f.required&&(0,t.jsx)("span",{className:"text-destructive ml-1",children:"*"})]}),(0,t.jsxs)("div",{className:"relative",children:[m&&(0,t.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground pointer-events-none z-10",children:m}),(0,t.jsxs)(a.motion.select,{ref:v,id:b,value:x,...f,onFocus:e=>{y(!0),f.onFocus?.(e)},onBlur:e=>{y(!1),w(!1),f.onBlur?.(e)},onMouseDown:()=>w(!j),className:C,animate:{scale:_?1.01:1,borderColor:c?"#EF4444":_?"rgb(37, 99, 235)":"rgb(226, 232, 240)"},transition:{duration:.2},children:[g&&(0,t.jsx)("option",{value:"",disabled:!0,children:g}),(h||[]).map(e=>(0,t.jsx)("option",{value:e.value,disabled:e.disabled,children:e.label},e.value))]}),(0,t.jsx)(a.motion.div,{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",animate:{rotate:180*!!j},transition:{duration:.2},children:(0,t.jsx)(n.ChevronDown,{className:"h-5 w-5"})}),c&&(0,t.jsx)(a.motion.div,{className:"absolute right-11 top-1/2 -translate-y-1/2 pointer-events-none",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:(0,t.jsx)(l.AlertCircle,{className:"h-5 w-5 text-destructive"})})]}),(0,t.jsx)(r.AnimatePresence,{mode:"wait",children:(c||d)&&(0,t.jsx)(a.motion.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},transition:{duration:.2},className:(0,i.cn)("text-xs transition-colors duration-200",c?"text-destructive":"text-muted-foreground"),children:c||d})})]})}).displayName="SelectNative";let o=s.createContext({}),c=s.forwardRef(({value:e,onValueChange:i,children:a},r)=>{let[n,l]=s.useState(!1);return(0,t.jsx)(o.Provider,{value:{value:e,onValueChange:i,open:n,setOpen:l},children:(0,t.jsx)("div",{className:"relative",ref:r,children:a})})});c.displayName="SelectRoot";let d=s.forwardRef(({children:e,className:a,...r},l)=>{let{open:c,setOpen:d}=s.useContext(o);return(0,t.jsxs)("button",{ref:l,type:"button",className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),onClick:()=>d?.(!c),...r,children:[e,(0,t.jsx)(n.ChevronDown,{className:(0,i.cn)("h-4 w-4 opacity-50 transition-transform",c&&"rotate-180")})]})});d.displayName="SelectTrigger";let u=s.forwardRef(({placeholder:e},i)=>{let{value:a}=s.useContext(o);return(0,t.jsx)("span",{ref:i,children:a||e})});u.displayName="SelectValue";let m=s.forwardRef(({children:e},i)=>{let a=s.useContext(o);return a?.open&&e?(0,t.jsx)("div",{ref:i,className:"absolute top-full left-0 z-50 mt-1 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md",children:(0,t.jsx)("div",{className:"p-1",children:e})}):null});m.displayName="SelectContent";let p=s.forwardRef(({value:e,children:a,className:r,...n},l)=>{let{value:c,onValueChange:d,setOpen:u}=s.useContext(o),m=c===e;return(0,t.jsx)("div",{ref:l,role:"option","aria-selected":m,className:(0,i.cn)("relative flex w-full cursor-pointer select-none items-center rounded-sm py-1.5 px-2 text-sm outline-none hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground",m&&"bg-accent text-accent-foreground",r),onClick:()=>{d?.(e),u?.(!1)},...n,children:a})});p.displayName="SelectItem",e.s(["Select",0,c,"SelectContent",0,m,"SelectItem",0,p,"SelectRoot",0,c,"SelectTrigger",0,d,"SelectValue",0,u])},240078,e=>{"use strict";var t=e.i(920755);let s=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getPolicies(e,t){let s=this.supabase.from("security_policies").select("*, approved_by_user:users!security_policies_approved_by_fkey(id, full_name, email)").or(`organization_id.eq.${e},organization_id.is.null`);t?.status&&(s=s.eq("status",t.status)),t?.category&&(s=s.eq("category",t.category));let{data:i,error:a}=await s.order("created_at",{ascending:!1});if(a)throw a;return i}async createPolicy(e){let{data:t,error:s}=await this.supabase.from("security_policies").insert(e).select().single();if(s)throw s;return t}async updatePolicy(e,t){let{data:s,error:i}=await this.supabase.from("security_policies").update(t).eq("id",e).select().single();if(i)throw i;return s}async approvePolicy(e,t){return this.updatePolicy(e,{approval_status:"approved",approved_by:t,approved_at:new Date().toISOString(),status:"active"})}async getControls(e,t){let s=this.supabase.from("security_controls").select("*").eq("organization_id",e);t?.framework&&(s=s.eq("framework",t.framework)),t?.status&&(s=s.eq("implementation_status",t.status));let{data:i,error:a}=await s.order("control_id",{ascending:!0});if(a)throw a;return i}async createControl(e){let{data:t,error:s}=await this.supabase.from("security_controls").insert(e).select().single();if(s)throw s;return t}async updateControl(e,t){let{data:s,error:i}=await this.supabase.from("security_controls").update(t).eq("id",e).select().single();if(i)throw i;return s}async getControlComplianceStats(e,t){let s=await this.getControls(e,{framework:t}),i={total:s.length,implemented:s.filter(e=>"implemented"===e.implementation_status).length,partial:s.filter(e=>"partial"===e.implementation_status).length,not_implemented:s.filter(e=>"not_implemented"===e.implementation_status).length,compliant:s.filter(e=>"compliant"===e.compliance_status).length,partially_compliant:s.filter(e=>"partially_compliant"===e.compliance_status).length,non_compliant:s.filter(e=>"non_compliant"===e.compliance_status).length,compliance_percentage:0};return i.total>0&&(i.compliance_percentage=i.compliant/i.total*100),i}async getEvidence(e){let{data:t,error:s}=await this.supabase.from("compliance_evidence").select("*, collected_by_user:users!compliance_evidence_collected_by_fkey(id, full_name, email), verified_by_user:users!compliance_evidence_verified_by_fkey(id, full_name, email)").eq("control_id",e).order("collected_at",{ascending:!1});if(s)throw s;return t}async createEvidence(e){let{data:t,error:s}=await this.supabase.from("compliance_evidence").insert(e).select().single();if(s)throw s;return t}async verifyEvidence(e,t){let{data:s,error:i}=await this.supabase.from("compliance_evidence").update({verified_by:t,verified_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;return s}async getRisks(e,t){let s=this.supabase.from("risk_assessments").select("*, owner:users(id, full_name, email)").eq("organization_id",e);t?.treatmentStatus&&(s=s.eq("treatment_status",t.treatmentStatus)),t?.riskLevel&&(s=s.eq("risk_level",t.riskLevel));let{data:i,error:a}=await s.order("risk_level",{ascending:!1});if(a){if("PGRST200"===a.code||404===a.status||400===a.status||a.message?.includes("does not exist"))return[];throw a}return i||[]}async createRisk(e){let{data:t,error:s}=await this.supabase.from("risk_assessments").insert(e).select().single();if(s)throw s;return t}async updateRisk(e,t){let{data:s,error:i}=await this.supabase.from("risk_assessments").update(t).eq("id",e).select().single();if(i)throw i;return s}async getCriticalRisks(e){return this.getRisks(e,{riskLevel:"critical",treatmentStatus:"open"})}async getIncidents(e,t){let s=this.supabase.from("security_incidents").select("*, reported_by_user:users(id, full_name, email), assigned_to_user:users(id, full_name, email)").eq("organization_id",e);t?.status&&(s=s.eq("status",t.status)),t?.severity&&(s=s.eq("severity",t.severity));let{data:i,error:a}=await s.order("created_at",{ascending:!1});if(a){if("PGRST200"===a.code||404===a.status||400===a.status||a.message?.includes("does not exist"))return[];throw a}return i||[]}async createIncident(e){let t=`INC-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,{data:s,error:i}=await this.supabase.from("security_incidents").insert({...e,incident_id:t}).select().single();if(i)throw i;return s}async updateIncident(e,t){let{data:s,error:i}=await this.supabase.from("security_incidents").update(t).eq("id",e).select().single();if(i)throw i;return s}async resolveIncident(e,t,s){return this.updateIncident(e,{status:"resolved",resolution:t,root_cause:s,resolved_at:new Date().toISOString()})}async getAudits(e,t){let s=this.supabase.from("security_audits").select("*").eq("organization_id",e);t?.status&&(s=s.eq("status",t.status)),t?.framework&&(s=s.eq("framework",t.framework));let{data:i,error:a}=await s.order("start_date",{ascending:!1});if(a)throw a;return i}async createAudit(e){let t=`AUDIT-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,{data:s,error:i}=await this.supabase.from("security_audits").insert({...e,audit_id:t}).select().single();if(i)throw i;return s}async getAuditFindings(e){let{data:t,error:s}=await this.supabase.from("audit_findings").select("*, assigned_to_user:users!audit_findings_assigned_to_fkey(id, full_name, email), control:security_controls(*)").eq("audit_id",e).order("severity",{ascending:!1});if(s)throw s;return t}async createAuditFinding(e){let{data:t,error:s}=await this.supabase.from("audit_findings").insert(e).select().single();if(s)throw s;return t}async getTrainings(e){let{data:t,error:s}=await this.supabase.from("security_training").select("*").eq("organization_id",e).eq("is_active",!0).order("created_at",{ascending:!1});if(s)throw s;return t}async getTrainingRecords(e){let{data:t,error:s}=await this.supabase.from("security_training_records").select("*, training:security_training(*)").eq("user_id",e).order("created_at",{ascending:!1});if(s)throw s;return t}async createTrainingRecord(e){let{data:t,error:s}=await this.supabase.from("security_training_records").insert(e).select().single();if(s)throw s;return t}async completeTraining(e,t){let{data:s,error:i}=await this.supabase.from("security_training_records").update({status:"completed",completion_percentage:100,score:t,completed_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;return s}async logAccess(e){let{data:t,error:s}=await this.supabase.from("access_logs").insert(e).select().single();if(s)throw s;return t}async getAccessLogs(e,t){let s=this.supabase.from("access_logs").select("*, user:users(id, full_name, email)").eq("organization_id",e);t?.userId&&(s=s.eq("user_id",t.userId)),t?.action&&(s=s.eq("action",t.action)),t?.startDate&&(s=s.gte("created_at",t.startDate.toISOString())),t?.endDate&&(s=s.lte("created_at",t.endDate.toISOString()));let{data:i,error:a}=await s.order("created_at",{ascending:!1}).limit(1e3);if(a)throw a;return i}async generateComplianceReport(e,t){await this.getControls(e,{framework:t});let s=await this.getRisks(e),i=await this.getIncidents(e),a=await this.getAudits(e,{framework:t}),r=await this.getControlComplianceStats(e,t),n=s.filter(e=>"critical"===e.risk_level&&"open"===e.treatment_status),l=i.filter(e=>"resolved"!==e.status&&"closed"!==e.status),o=a.filter(e=>{let t=new Date(e.start_date),s=new Date;return s.setMonth(s.getMonth()-6),t>=s});return{framework:t||"all",generated_at:new Date().toISOString(),controls:{total:r.total,compliance_percentage:r.compliance_percentage,implemented:r.implemented,partial:r.partial,not_implemented:r.not_implemented,compliant:r.compliant,partially_compliant:r.partially_compliant,non_compliant:r.non_compliant},risks:{total:s.length,critical:n.length,high:s.filter(e=>"high"===e.risk_level&&"open"===e.treatment_status).length,medium:s.filter(e=>"medium"===e.risk_level&&"open"===e.treatment_status).length,low:s.filter(e=>"low"===e.risk_level&&"open"===e.treatment_status).length,mitigated:s.filter(e=>"mitigated"===e.treatment_status).length},incidents:{total:i.length,open:l.length,critical:i.filter(e=>"critical"===e.severity&&"resolved"!==e.status).length,data_breaches:i.filter(e=>e.data_breach).length},audits:{total:a.length,recent:o.length,average_score:a.length>0?a.reduce((e,t)=>e+(t.overall_score||0),0)/a.length:0,average_compliance:a.length>0?a.reduce((e,t)=>e+(t.compliance_percentage||0),0)/a.length:0},recommendations:this.generateRecommendations(r,n,l)}}generateRecommendations(e,t,s){let i=[];return e.compliance_percentage<80&&i.push(`Le pourcentage de conformit\xe9 est de ${e.compliance_percentage.toFixed(1)}%. Il est recommand\xe9 d'am\xe9liorer l'impl\xe9mentation des contr\xf4les.`),t.length>0&&i.push(`${t.length} risque(s) critique(s) ouvert(s) n\xe9cessitent une attention imm\xe9diate.`),s.filter(e=>"critical"===e.severity).length>0&&i.push("Des incidents critiques sont en cours. Une intervention immédiate est requise."),e.not_implemented>0&&i.push(`${e.not_implemented} contr\xf4le(s) ne sont pas encore impl\xe9ment\xe9s.`),0===i.length&&i.push("Aucune recommandation urgente. La conformité est bonne."),i}};e.s(["complianceService",0,s])},863449,e=>{"use strict";var t=e.i(843476),s=e.i(271645),i=e.i(266027),a=e.i(954616),r=e.i(912598),n=e.i(325715),l=e.i(240078),o=e.i(970065),c=e.i(167881),d=e.i(23750),u=e.i(10708),m=e.i(184762),p=e.i(994179),h=e.i(630374),g=e.i(62870),x=e.i(178583),f=e.i(107233),v=e.i(555436),_=e.i(465286),y=e.i(503116),j=e.i(286536),w=e.i(738308),b=e.i(436332),C=e.i(522016),S=e.i(647163);function N(){let{user:e}=(0,n.useAuth)(),N=(0,r.useQueryClient)(),[k,q]=(0,s.useState)(""),[I,D]=(0,s.useState)("all"),[R,T]=(0,s.useState)("all"),[A,z]=(0,s.useState)(!1),[P,L]=(0,s.useState)({code:"",title:"",category:"access_control",description:"",content:"",version:"1.0",iso27001_control:"",soc2_control:""}),{data:B}=(0,i.useQuery)({queryKey:["security-policies",e?.organization_id,I,R],queryFn:()=>l.complianceService.getPolicies(e?.organization_id||"",{status:"all"===I?void 0:I,category:"all"===R?void 0:R}),enabled:!!e?.organization_id}),E=B?.filter(e=>!k||!!e.title.toLowerCase().includes(k.toLowerCase())||!!e.code.toLowerCase().includes(k.toLowerCase())),O=(0,a.useMutation)({mutationFn:()=>l.complianceService.createPolicy({...P,organization_id:e?.organization_id||""}),onSuccess:()=>{N.invalidateQueries({queryKey:["security-policies"]}),z(!1),L({code:"",title:"",category:"access_control",description:"",content:"",version:"1.0",iso27001_control:"",soc2_control:""})}}),M={draft:"bg-gray-100 text-gray-800",active:"bg-green-100 text-green-800",archived:"bg-red-100 text-red-800"},F={pending:"bg-yellow-100 text-yellow-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},V={access_control:"Contrôle d'accès",data_protection:"Protection des données",incident_response:"Réponse aux incidents",business_continuity:"Continuité d'activité",encryption:"Chiffrement",network_security:"Sécurité réseau",physical_security:"Sécurité physique",vendor_management:"Gestion des fournisseurs",other:"Autre"};return(0,t.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,t.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,t.jsx)(x.FileText,{className:"h-8 w-8"}),"Politiques de sécurité"]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Documentation et gestion des politiques de sécurité"})]}),(0,t.jsxs)(h.Dialog,{open:A,onOpenChange:z,children:[(0,t.jsx)(h.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(c.Button,{children:[(0,t.jsx)(f.Plus,{className:"h-4 w-4 mr-2"}),"Nouvelle politique"]})}),(0,t.jsxs)(h.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(h.DialogHeader,{children:[(0,t.jsx)(h.DialogTitle,{children:"Créer une nouvelle politique"}),(0,t.jsx)(h.DialogDescription,{children:"Documentez une politique de sécurité pour votre organisation"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Code"}),(0,t.jsx)(d.Input,{value:P.code,onChange:e=>L({...P,code:e.target.value}),placeholder:"Ex: POL-001"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Version"}),(0,t.jsx)(d.Input,{value:P.version,onChange:e=>L({...P,version:e.target.value}),placeholder:"1.0"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Titre"}),(0,t.jsx)(d.Input,{value:P.title,onChange:e=>L({...P,title:e.target.value}),placeholder:"Titre de la politique"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Catégorie"}),(0,t.jsxs)(g.Select,{value:P.category,onValueChange:e=>L({...P,category:e}),children:[(0,t.jsx)(g.SelectTrigger,{children:(0,t.jsx)(g.SelectValue,{})}),(0,t.jsxs)(g.SelectContent,{children:[(0,t.jsx)(g.SelectItem,{value:"access_control",children:"Contrôle d'accès"}),(0,t.jsx)(g.SelectItem,{value:"data_protection",children:"Protection des données"}),(0,t.jsx)(g.SelectItem,{value:"incident_response",children:"Réponse aux incidents"}),(0,t.jsx)(g.SelectItem,{value:"business_continuity",children:"Continuité d'activité"}),(0,t.jsx)(g.SelectItem,{value:"encryption",children:"Chiffrement"}),(0,t.jsx)(g.SelectItem,{value:"network_security",children:"Sécurité réseau"}),(0,t.jsx)(g.SelectItem,{value:"physical_security",children:"Sécurité physique"}),(0,t.jsx)(g.SelectItem,{value:"vendor_management",children:"Gestion des fournisseurs"}),(0,t.jsx)(g.SelectItem,{value:"other",children:"Autre"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Description"}),(0,t.jsx)(m.Textarea,{value:P.description,onChange:e=>L({...P,description:e.target.value}),placeholder:"Description de la politique",rows:2})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Contenu"}),(0,t.jsx)(m.Textarea,{value:P.content,onChange:e=>L({...P,content:e.target.value}),placeholder:"Contenu complet de la politique",rows:8})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Contrôle ISO 27001 (optionnel)"}),(0,t.jsx)(d.Input,{value:P.iso27001_control,onChange:e=>L({...P,iso27001_control:e.target.value}),placeholder:"Ex: A.9.2.1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Contrôle SOC 2 (optionnel)"}),(0,t.jsx)(d.Input,{value:P.soc2_control,onChange:e=>L({...P,soc2_control:e.target.value}),placeholder:"Ex: CC6.1"})]})]}),(0,t.jsx)(c.Button,{onClick:()=>O.mutate(),disabled:!P.code||!P.title||!P.content,className:"w-full",children:"Créer la politique"})]})]})]})]}),(0,t.jsxs)("div",{className:"mb-6 flex gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)(v.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,t.jsx)(d.Input,{placeholder:"Rechercher une politique...",value:k,onChange:e=>q(e.target.value),className:"pl-10"})]}),(0,t.jsxs)(g.Select,{value:I,onValueChange:D,children:[(0,t.jsx)(g.SelectTrigger,{className:"w-48",children:(0,t.jsx)(g.SelectValue,{})}),(0,t.jsxs)(g.SelectContent,{children:[(0,t.jsx)(g.SelectItem,{value:"all",children:"Tous les statuts"}),(0,t.jsx)(g.SelectItem,{value:"draft",children:"Brouillon"}),(0,t.jsx)(g.SelectItem,{value:"active",children:"Active"}),(0,t.jsx)(g.SelectItem,{value:"archived",children:"Archivée"})]})]}),(0,t.jsxs)(g.Select,{value:R,onValueChange:T,children:[(0,t.jsx)(g.SelectTrigger,{className:"w-56",children:(0,t.jsx)(g.SelectValue,{})}),(0,t.jsxs)(g.SelectContent,{children:[(0,t.jsx)(g.SelectItem,{value:"all",children:"Toutes les catégories"}),(0,t.jsx)(g.SelectItem,{value:"access_control",children:"Contrôle d'accès"}),(0,t.jsx)(g.SelectItem,{value:"data_protection",children:"Protection des données"}),(0,t.jsx)(g.SelectItem,{value:"incident_response",children:"Réponse aux incidents"}),(0,t.jsx)(g.SelectItem,{value:"business_continuity",children:"Continuité d'activité"}),(0,t.jsx)(g.SelectItem,{value:"encryption",children:"Chiffrement"}),(0,t.jsx)(g.SelectItem,{value:"network_security",children:"Sécurité réseau"}),(0,t.jsx)(g.SelectItem,{value:"physical_security",children:"Sécurité physique"}),(0,t.jsx)(g.SelectItem,{value:"vendor_management",children:"Gestion des fournisseurs"})]})]})]}),E&&E.length>0?(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4",children:E.map(e=>(0,t.jsxs)(o.Card,{children:[(0,t.jsx)(o.CardHeader,{children:(0,t.jsx)("div",{className:"flex items-start justify-between",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(o.CardTitle,{className:"text-lg",children:e.title}),(0,t.jsx)(p.Badge,{variant:"outline",children:e.code}),(0,t.jsxs)(p.Badge,{children:["v",e.version]}),(0,t.jsxs)(p.Badge,{className:M[e.status]||"bg-gray-100 text-gray-800",children:["draft"===e.status?(0,t.jsx)(b.Edit,{className:"h-3 w-3 mr-1"}):"active"===e.status?(0,t.jsx)(_.CheckCircle2,{className:"h-3 w-3 mr-1"}):(0,t.jsx)(w.XCircle,{className:"h-3 w-3 mr-1"}),"draft"===e.status?"Brouillon":"active"===e.status?"Active":"Archivée"]}),(0,t.jsxs)(p.Badge,{className:F[e.approval_status]||"bg-gray-100 text-gray-800",children:["pending"===e.approval_status?(0,t.jsx)(y.Clock,{className:"h-3 w-3 mr-1"}):"approved"===e.approval_status?(0,t.jsx)(_.CheckCircle2,{className:"h-3 w-3 mr-1"}):(0,t.jsx)(w.XCircle,{className:"h-3 w-3 mr-1"}),"pending"===e.approval_status?"En attente":"approved"===e.approval_status?"Approuvée":"Rejetée"]})]}),e.description&&(0,t.jsx)(o.CardDescription,{className:"mt-2",children:e.description})]})})}),(0,t.jsx)(o.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Catégorie: "}),(0,t.jsx)(p.Badge,{variant:"outline",children:V[e.category]||e.category})]}),e.iso27001_control&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"ISO 27001: "}),(0,t.jsx)(p.Badge,{variant:"outline",children:e.iso27001_control})]}),e.soc2_control&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"SOC 2: "}),(0,t.jsx)(p.Badge,{variant:"outline",children:e.soc2_control})]}),e.effective_date&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"En vigueur depuis: "}),(0,t.jsx)("span",{className:"text-sm",children:(0,S.formatDate)(e.effective_date)})]})]}),e.approved_by_user&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Approuvée par: "}),(0,t.jsx)("span",{className:"text-sm",children:e.approved_by_user.full_name||e.approved_by_user.email}),e.approved_at&&(0,t.jsxs)("span",{className:"text-sm text-muted-foreground ml-2",children:["le ",(0,S.formatDate)(e.approved_at)]})]}),(0,t.jsx)("div",{className:"flex items-center gap-2 pt-2",children:(0,t.jsx)(C.default,{href:`/dashboard/compliance/policies/${e.id}`,children:(0,t.jsxs)(c.Button,{variant:"outline",size:"sm",children:[(0,t.jsx)(j.Eye,{className:"h-4 w-4 mr-2"}),"Voir les détails"]})})})]})})]},e.id))}):(0,t.jsx)(o.Card,{children:(0,t.jsxs)(o.CardContent,{className:"pt-6 text-center text-muted-foreground",children:["Aucune politique trouvée. ",k&&"Essayez une autre recherche."]})})]})}e.s(["default",()=>N])}]);