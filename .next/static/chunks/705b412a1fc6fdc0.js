(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,107233,e=>{"use strict";let t=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],107233)},871689,e=>{"use strict";let t=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],871689)},356909,e=>{"use strict";let t=(0,e.i(475254).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);e.s(["Save",()=>t],356909)},845691,e=>{"use strict";var t=e.i(920755);let a=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getConfiguration(e){try{let{data:t,error:a}=await this.supabase.from("accessibility_configurations").select("*").eq("organization_id",e).maybeSingle();if(a){if("PGRST116"===a.code||"42P01"===a.code||"PGRST301"===a.code||404===a.status||a.message?.includes("relation")||a.message?.includes("does not exist"))return console.warn("Table accessibility_configurations does not exist yet:",a?.message),null;throw a}return t}catch(e){if(e?.status===404||e?.message?.toLowerCase().includes("not found"))return null;throw e}}async updateConfiguration(e,t){var a;let i=await this.getConfiguration(e),s={...t};if(delete s.id,delete s.created_at,delete s.updated_at,delete s.organization_id,null===s.referent_user_id||void 0===s.referent_user_id||""!==s.referent_user_id&&(a=s.referent_user_id)&&""!==a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(a)||(s.referent_user_id=null),(""===s.referent_training_date||null===s.referent_training_date)&&(s.referent_training_date=null),""===s.referent_training_certificate&&(s.referent_training_certificate=null),""===s.accessibility_policy&&(s.accessibility_policy=null),""===s.physical_accessibility_statement&&(s.physical_accessibility_statement=null),""===s.digital_accessibility_statement&&(s.digital_accessibility_statement=null),i){let{data:t,error:a}=await this.supabase.from("accessibility_configurations").update(s).eq("organization_id",e).select().single();if(a)throw console.error("[AccessibilityService] Erreur lors de la mise à jour de la configuration:",{error:a,code:a.code,message:a.message,details:a.details,hint:a.hint,cleanData:s,organizationId:e}),a;return t}{let t={organization_id:e,partner_agefiph:!1,partner_cap_emploi:!1,partner_fiphfp:!1,partner_other:[],...s},{data:a,error:i}=await this.supabase.from("accessibility_configurations").insert(t).select().single();if(i)throw console.error("[AccessibilityService] Erreur lors de la création de la configuration:",{error:i,code:i.code,message:i.message,details:i.details,hint:i.hint,insertData:t}),i;return a}}async setReferent(e,t,a,i){await this.updateConfiguration(e,{referent_user_id:t,referent_training_date:a||null,referent_training_certificate:i||null})}async getDisabilityTypes(){try{let{data:e,error:t}=await this.supabase.from("accessibility_disability_types").select("*").order("name_fr",{ascending:!0});if(t){if("PGRST116"===t.code||"42P01"===t.code||404===t.status||t.message?.includes("relation")||t.message?.includes("does not exist"))return console.warn("Table accessibility_disability_types does not exist yet"),[];throw t}return e||[]}catch(e){if(e?.status===404)return[];throw e}}async getStudentNeeds(e,t){try{let a=this.supabase.from("accessibility_student_needs").select("*").eq("organization_id",e);t?.status&&(a=a.eq("status",t.status)),t?.has_disability!==void 0&&(a=a.eq("has_disability",t.has_disability));let{data:i,error:s}=await a.order("created_at",{ascending:!1});if(s){if("PGRST116"===s.code||"42P01"===s.code||404===s.status||s.message?.includes("relation")||s.message?.includes("does not exist"))return console.warn("Table accessibility_student_needs does not exist yet"),[];throw s}return i||[]}catch(e){if(e?.status===404)return[];throw e}}async getStudentNeedByStudentId(e){try{let{data:t,error:a}=await this.supabase.from("accessibility_student_needs").select("*").eq("student_id",e).maybeSingle();if(a){if("PGRST116"===a.code||"42P01"===a.code||404===a.status||a.message?.includes("relation")||a.message?.includes("does not exist"))return null;throw a}return t}catch(e){if(e?.status===404)return null;throw e}}async createStudentNeed(e){let{data:t,error:a}=await this.supabase.from("accessibility_student_needs").insert(e).select().single();if(a)throw a;return t}async updateStudentNeed(e,t){let{data:a,error:i}=await this.supabase.from("accessibility_student_needs").update(t).eq("id",e).select().single();if(i)throw i;return a}async reviewStudentNeed(e,t,a){return this.updateStudentNeed(e,{status:"reviewed",reviewed_by_user_id:t,reviewed_at:new Date().toISOString(),notes:a||null})}async getAccommodations(e,t){try{let a=this.supabase.from("accessibility_accommodations").select("*").eq("organization_id",e);t?.student_id&&(a=a.eq("student_id",t.student_id)),t?.status&&(a=a.eq("status",t.status)),t?.type&&(a=a.eq("accommodation_type",t.type));let{data:i,error:s}=await a.order("created_at",{ascending:!1});if(s){if("PGRST116"===s.code||"42P01"===s.code||404===s.status||s.message?.includes("relation")||s.message?.includes("does not exist"))return console.warn("Table accessibility_accommodations does not exist yet"),[];throw s}return i||[]}catch(e){if(e?.status===404)return[];throw e}}async getStudentAccommodations(e){return this.getAccommodations("",{student_id:e})}async createAccommodation(e){let{data:t,error:a}=await this.supabase.from("accessibility_accommodations").insert(e).select().single();if(a)throw a;return t}async updateAccommodation(e,t){let{data:a,error:i}=await this.supabase.from("accessibility_accommodations").update(t).eq("id",e).select().single();if(i)throw i;return a}async archiveAccommodation(e){await this.updateAccommodation(e,{status:"inactive"})}async getEquipment(e,t){try{let a=this.supabase.from("accessibility_equipment").select("*").eq("organization_id",e);t?.status&&(a=a.eq("status",t.status)),t?.category&&(a=a.eq("category",t.category));let{data:i,error:s}=await a.order("name",{ascending:!0});if(s){if("PGRST116"===s.code||"42P01"===s.code||404===s.status||s.message?.includes("relation")||s.message?.includes("does not exist"))return console.warn("Table accessibility_equipment does not exist yet"),[];throw s}return i||[]}catch(e){if(e?.status===404)return[];throw e}}async createEquipment(e){let{data:t,error:a}=await this.supabase.from("accessibility_equipment").insert(e).select().single();if(a)throw a;return t}async updateEquipment(e,t){let{data:a,error:i}=await this.supabase.from("accessibility_equipment").update(t).eq("id",e).select().single();if(i)throw i;return a}async assignEquipment(e,t,a){let{data:i,error:s}=await this.supabase.from("accessibility_equipment").select("*").eq("id",e).single();if(s)throw s;if(i.quantity_available<=0)throw Error("Équipement non disponible");let{data:n,error:l}=await this.supabase.from("accessibility_equipment_assignments").insert({equipment_id:e,student_id:t,organization_id:i.organization_id,...a}).select().single();if(l)throw l;return await this.updateEquipment(e,{quantity_available:i.quantity_available-1,status:i.quantity_available-1==0?"in_use":i.status}),n}async returnEquipment(e,t){let{data:a,error:i}=await this.supabase.from("accessibility_equipment_assignments").select("*, accessibility_equipment(*)").eq("id",e).single();if(i)throw i;if(await this.supabase.from("accessibility_equipment_assignments").update({status:"returned",actual_return_date:new Date().toISOString().split("T")[0],condition_on_return:t}).eq("id",e),"lost"!==t&&"damaged"!==t){let e=a.accessibility_equipment;await this.updateEquipment(a.equipment_id,{quantity_available:e.quantity_available+1,status:"available"})}}async getEquipmentAssignments(e){try{let{data:t,error:a}=await this.supabase.from("accessibility_equipment_assignments").select("*").eq("equipment_id",e).order("assigned_date",{ascending:!1});if(a){if("PGRST116"===a.code||"42P01"===a.code||404===a.status||a.message?.includes("relation")||a.message?.includes("does not exist"))return console.warn("Table accessibility_equipment_assignments does not exist yet"),[];throw a}return t||[]}catch(e){if(e?.status===404)return[];throw e}}async getDocuments(e,t){try{let a=this.supabase.from("accessibility_documents").select("*").eq("organization_id",e);t&&(a=a.eq("student_id",t));let{data:i,error:s}=await a.order("created_at",{ascending:!1});if(s){if("PGRST116"===s.code||"42P01"===s.code||404===s.status||s.message?.includes("relation")||s.message?.includes("does not exist"))return console.warn("Table accessibility_documents does not exist yet"),[];throw s}return i||[]}catch(e){if(e?.status===404)return[];throw e}}async uploadDocument(e){let{data:t,error:a}=await this.supabase.from("accessibility_documents").insert(e).select().single();if(a)throw a;return t}async deleteDocument(e){let{error:t}=await this.supabase.from("accessibility_documents").delete().eq("id",e);if(t)throw t}async verifyDocument(e,t){await this.supabase.from("accessibility_documents").update({verified:!0,verified_by_user_id:t,verified_at:new Date().toISOString()}).eq("id",e)}async getStats(e){let[t,a,i,s]=await Promise.all([this.getStudentNeeds(e,{has_disability:!0}),this.getAccommodations(e,{status:"active"}),this.getEquipment(e,{status:"available"}),this.calculateComplianceRate(e)]),n=new Map;t.forEach(e=>{e.disability_type_ids.forEach(e=>{n.set(e,(n.get(e)||0)+1)})});let l=new Map;return a.forEach(e=>{l.set(e.accommodation_type,(l.get(e.accommodation_type)||0)+1)}),{total_students_with_needs:t.length,active_accommodations:a.length,available_equipment:i.reduce((e,t)=>e+t.quantity_available,0),compliance_rate:s,students_by_disability_type:Array.from(n.entries()).map(([e,t])=>({type:e,count:t})),accommodations_by_type:Array.from(l.entries()).map(([e,t])=>({type:e,count:t})),pending_reviews:t.filter(e=>"pending"===e.status).length}}async calculateComplianceRate(e){try{let{data:t,error:a}=await this.supabase.rpc("calculate_accessibility_compliance_rate",{org_id:e});if(a){if("PGRST116"===a.code||"42883"===a.code||404===a.status||a.message?.toLowerCase().includes("function")||a.message?.toLowerCase().includes("does not exist"))return 0;throw a}return t||0}catch(e){if(e?.status===404||e?.message?.toLowerCase().includes("not found"))return 0;throw e}}async generateComplianceReport(e,t,a,i){let s=await this.getStats(e),n=await this.getConfiguration(e),l={organization_id:e,report_type:"annual",title:`Rapport de conformit\xe9 accessibilit\xe9 ${new Date().getFullYear()}`,period_start:t,period_end:a,total_students:0,students_with_disabilities:s.total_students_with_needs,accommodations_requested:s.total_students_with_needs,accommodations_implemented:s.active_accommodations,equipment_used:0,referent_training_up_to_date:!!n?.referent_training_date,physical_accessibility_compliant:!!n?.physical_accessibility_statement,digital_accessibility_compliant:!!n?.digital_accessibility_statement,partner_collaborations:+!!n?.partner_agefiph+ +!!n?.partner_cap_emploi+ +!!n?.partner_fiphfp,compliance_rate:s.compliance_rate,findings:[],recommendations:[],generated_by_user_id:i},{data:r,error:c}=await this.supabase.from("accessibility_compliance_reports").insert(l).select().single();if(c)throw c;return r}};e.s(["accessibilityService",0,a])},488844,e=>{"use strict";let t=(0,e.i(475254).default)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);e.s(["Package",()=>t],488844)},703526,e=>{"use strict";var t=e.i(843476),a=e.i(271645),i=e.i(266027),s=e.i(325715),n=e.i(845691),l=e.i(970065),r=e.i(167881),c=e.i(23750),o=e.i(994179),d=e.i(488844),u=e.i(346897),m=e.i(87316),h=e.i(898791);let p={mobility:"Mobilité",visual:"Visuel",auditory:"Auditif",ergonomic:"Ergonomique",software:"Logiciel",other:"Autre"},_={available:"bg-green-100 text-green-800",in_use:"bg-blue-100 text-blue-800",maintenance:"bg-yellow-100 text-yellow-800",retired:"bg-gray-100 text-gray-800"},x={available:"Disponible",in_use:"En utilisation",maintenance:"Maintenance",retired:"Retiré"};function g({equipment:e,onAssign:a,onEdit:i,showActions:s=!0}){let n="available"===e.status&&e.quantity_available>0,c=e.next_maintenance_date&&new Date(e.next_maintenance_date)<new Date;return(0,t.jsxs)(l.Card,{className:`${n?"border-green-200":""} hover:shadow-md transition-shadow`,children:[(0,t.jsx)(l.CardHeader,{children:(0,t.jsx)("div",{className:"flex items-start justify-between",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)(l.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,t.jsx)(d.Package,{className:"h-4 w-4"}),e.name]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[e.category&&(0,t.jsx)(o.Badge,{variant:"outline",className:"text-xs",children:p[e.category]||e.category}),(0,t.jsx)(o.Badge,{className:`${_[e.status]} text-xs`,children:x[e.status]})]})]})})}),(0,t.jsxs)(l.CardContent,{className:"space-y-3",children:[e.description&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Disponibilité"}),(0,t.jsxs)("span",{className:`text-sm font-medium ${n?"text-green-600":"text-gray-600"}`,children:[e.quantity_available," / ",e.quantity_total]})]}),e.location&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,t.jsx)(u.MapPin,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:e.location})]}),e.next_maintenance_date&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,t.jsx)(m.Calendar,{className:"h-3 w-3"}),(0,t.jsxs)("span",{children:["Prochaine maintenance : ",new Date(e.next_maintenance_date).toLocaleDateString("fr-FR")]})]}),c&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs text-yellow-600 font-medium",children:[(0,t.jsx)(h.AlertCircle,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"Maintenance requise"})]}),s&&(0,t.jsxs)("div",{className:"flex gap-2 pt-2",children:[n&&a&&(0,t.jsx)(r.Button,{onClick:a,size:"sm",className:"flex-1",children:"Attribuer"}),i&&(0,t.jsx)(r.Button,{onClick:i,variant:"outline",size:"sm",className:n?"":"flex-1",children:"Modifier"})]})]})]})}var y=e.i(954616),b=e.i(912598),f=e.i(10708),v=e.i(184762),j=e.i(6799),w=e.i(356909),q=e.i(37727);let N=[{value:"mobility",label:"Mobilité"},{value:"visual",label:"Visuel"},{value:"auditory",label:"Auditif"},{value:"ergonomic",label:"Ergonomique"},{value:"software",label:"Logiciel"},{value:"other",label:"Autre"}],C=[{value:"available",label:"Disponible"},{value:"in_use",label:"En utilisation"},{value:"maintenance",label:"Maintenance"},{value:"retired",label:"Retiré"}],S=[{value:"none",label:"Aucune"},{value:"monthly",label:"Mensuelle"},{value:"quarterly",label:"Trimestrielle"},{value:"biannual",label:"Semestrielle"},{value:"annual",label:"Annuelle"}];function A({organizationId:e,equipmentId:i,initialData:s,onSuccess:o,onCancel:d}){let u=(0,b.useQueryClient)(),{addToast:m}=(0,j.useToast)(),[h,p]=(0,a.useState)({name:s?.name||"",category:s?.category||"mobility",description:s?.description||"",location:s?.location||"",quantity_total:s?.quantity_total||1,quantity_available:s?.quantity_available||1,status:s?.status||"available",purchase_date:s?.purchase_date||"",warranty_expiry_date:s?.warranty_expiry_date||"",maintenance_schedule:s?.maintenance_schedule||"none",last_maintenance_date:s?.last_maintenance_date||"",next_maintenance_date:s?.next_maintenance_date||"",notes:s?.notes||"",metadata:s?.metadata||{}}),_=(0,y.useMutation)({mutationFn:async()=>{let t={organization_id:e,...h,purchase_date:h.purchase_date||null,warranty_expiry_date:h.warranty_expiry_date||null,last_maintenance_date:h.last_maintenance_date||null,next_maintenance_date:h.next_maintenance_date||null};return i?await n.accessibilityService.updateEquipment(i,t):await n.accessibilityService.createEquipment(t)},onSuccess:()=>{u.invalidateQueries({queryKey:["accessibility-equipment"]}),u.invalidateQueries({queryKey:["accessibility-stats"]}),m({type:"success",title:i?"Équipement mis à jour":"Équipement créé",description:`L'\xe9quipement a \xe9t\xe9 ${i?"mis à jour":"créé"} avec succ\xe8s.`}),o?.()},onError:e=>{m({type:"error",title:"Erreur",description:e?.message||"Impossible de sauvegarder l'équipement."})}}),x=(e,t)=>{p(a=>({...a,[e]:t}))};return(0,t.jsxs)(l.Card,{children:[(0,t.jsx)(l.CardHeader,{children:(0,t.jsx)(l.CardTitle,{children:i?"Modifier l'équipement":"Nouvel équipement"})}),(0,t.jsx)(l.CardContent,{children:(0,t.jsxs)("form",{onSubmit:e=>{(e.preventDefault(),h.name&&h.category)?h.quantity_available>h.quantity_total?m({type:"error",title:"Validation échouée",description:"La quantité disponible ne peut pas dépasser la quantité totale."}):_.mutate():m({type:"error",title:"Validation échouée",description:"Veuillez remplir tous les champs obligatoires."})},className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Label,{htmlFor:"name",children:"Nom de l'équipement *"}),(0,t.jsx)(c.Input,{id:"name",value:h.name,onChange:e=>x("name",e.target.value),placeholder:"Ex: Fauteuil roulant électrique",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Label,{htmlFor:"category",children:"Catégorie *"}),(0,t.jsx)("select",{id:"category",value:h.category,onChange:e=>x("category",e.target.value),className:"w-full px-4 py-3 border-2 border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",required:!0,children:N.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Label,{htmlFor:"description",children:"Description"}),(0,t.jsx)(v.Textarea,{id:"description",value:h.description,onChange:e=>x("description",e.target.value),placeholder:"Caractéristiques techniques, modèle, etc.",rows:3})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Label,{htmlFor:"location",children:"Localisation"}),(0,t.jsx)(c.Input,{id:"location",value:h.location,onChange:e=>x("location",e.target.value),placeholder:"Ex: Salle A12, Bâtiment B"})]})]}),(0,t.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,t.jsx)("h3",{className:"font-medium",children:"Disponibilité"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Label,{htmlFor:"quantity_total",children:"Quantité totale *"}),(0,t.jsx)(c.Input,{id:"quantity_total",type:"number",min:"1",value:h.quantity_total,onChange:e=>{var t;return t=parseInt(e.target.value)||1,void p(e=>({...e,quantity_total:t,quantity_available:i?e.quantity_available:t}))},required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Label,{htmlFor:"quantity_available",children:"Quantité disponible *"}),(0,t.jsx)(c.Input,{id:"quantity_available",type:"number",min:"0",max:h.quantity_total,value:h.quantity_available,onChange:e=>x("quantity_available",parseInt(e.target.value)||0),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Label,{htmlFor:"status",children:"Statut"}),(0,t.jsx)("select",{id:"status",value:h.status,onChange:e=>x("status",e.target.value),className:"w-full px-4 py-3 border-2 border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",children:C.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,t.jsx)("h3",{className:"font-medium",children:"Achat et garantie"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Label,{htmlFor:"purchase_date",children:"Date d'achat"}),(0,t.jsx)(c.Input,{id:"purchase_date",type:"date",value:h.purchase_date,onChange:e=>x("purchase_date",e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Label,{htmlFor:"warranty_expiry_date",children:"Fin de garantie"}),(0,t.jsx)(c.Input,{id:"warranty_expiry_date",type:"date",value:h.warranty_expiry_date,onChange:e=>x("warranty_expiry_date",e.target.value)})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[(0,t.jsx)("h3",{className:"font-medium",children:"Maintenance"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Label,{htmlFor:"maintenance_schedule",children:"Fréquence de maintenance"}),(0,t.jsx)("select",{id:"maintenance_schedule",value:h.maintenance_schedule,onChange:e=>x("maintenance_schedule",e.target.value),className:"w-full px-4 py-3 border-2 border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",children:S.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),"none"!==h.maintenance_schedule&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Label,{htmlFor:"last_maintenance_date",children:"Dernière maintenance"}),(0,t.jsx)(c.Input,{id:"last_maintenance_date",type:"date",value:h.last_maintenance_date,onChange:e=>x("last_maintenance_date",e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Label,{htmlFor:"next_maintenance_date",children:"Prochaine maintenance"}),(0,t.jsx)(c.Input,{id:"next_maintenance_date",type:"date",value:h.next_maintenance_date,onChange:e=>x("next_maintenance_date",e.target.value)})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(f.Label,{htmlFor:"notes",children:"Notes internes"}),(0,t.jsx)(v.Textarea,{id:"notes",value:h.notes,onChange:e=>x("notes",e.target.value),placeholder:"Informations complémentaires, remarques...",rows:3})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[d&&(0,t.jsxs)(r.Button,{type:"button",variant:"outline",onClick:d,children:[(0,t.jsx)(q.X,{className:"h-4 w-4 mr-2"}),"Annuler"]}),(0,t.jsxs)(r.Button,{type:"submit",disabled:_.isPending,children:[(0,t.jsx)(w.Save,{className:"h-4 w-4 mr-2"}),_.isPending?"Enregistrement...":"Enregistrer"]})]})]})})]})}var T=e.i(107233),P=e.i(555436),E=e.i(871689),L=e.i(522016),D=e.i(630374);function z(){let{user:e}=(0,s.useAuth)(),[u,m]=(0,a.useState)(""),[h,p]=(0,a.useState)(""),[_,x]=(0,a.useState)(""),[y,b]=(0,a.useState)(!1),[f,v]=(0,a.useState)(null),{data:j=[],isLoading:w}=(0,i.useQuery)({queryKey:["accessibility-equipment",e?.organization_id,h,_],queryFn:async()=>e?.organization_id?await n.accessibilityService.getEquipment(e.organization_id,{category:h||void 0,status:_||void 0}):[],enabled:!!e?.organization_id,retry:!1}),q=j.filter(e=>{if(!u)return!0;let t=u.toLowerCase();return e.name?.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t)||e.location?.toLowerCase().includes(t)}),N={total:j.length,available:j.filter(e=>"available"===e.status&&e.quantity_available>0).length,in_use:j.filter(e=>"in_use"===e.status).length,maintenance:j.filter(e=>"maintenance"===e.status).length,total_capacity:j.reduce((e,t)=>e+(t.quantity_total||0),0),total_available:j.reduce((e,t)=>e+(t.quantity_available||0),0)},C=[{value:"",label:"Toutes catégories"},{value:"mobility",label:"Mobilité"},{value:"visual",label:"Visuel"},{value:"auditory",label:"Auditif"},{value:"ergonomic",label:"Ergonomique"},{value:"software",label:"Logiciel"},{value:"other",label:"Autre"}],S=[{value:"",label:"Tous statuts"},{value:"available",label:"Disponible"},{value:"in_use",label:"En utilisation"},{value:"maintenance",label:"Maintenance"},{value:"retired",label:"Retiré"}],z=()=>{b(!1),v(null)};return e?(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(L.default,{href:"/dashboard/accessibility",children:(0,t.jsxs)(r.Button,{variant:"ghost",size:"sm",children:[(0,t.jsx)(E.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Retour"]})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[(0,t.jsx)(d.Package,{className:"h-8 w-8 text-primary"}),"Gestion des Équipements"]}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1",children:"Inventaire et suivi des équipements adaptés"})]})]}),(0,t.jsxs)(r.Button,{onClick:()=>b(!0),children:[(0,t.jsx)(T.Plus,{className:"h-4 w-4 mr-2"}),"Ajouter un équipement"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,t.jsxs)(l.Card,{children:[(0,t.jsx)(l.CardHeader,{className:"pb-3",children:(0,t.jsx)(l.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Total équipements"})}),(0,t.jsx)(l.CardContent,{children:(0,t.jsx)("p",{className:"text-2xl font-bold",children:N.total})})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsx)(l.CardHeader,{className:"pb-3",children:(0,t.jsx)(l.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Disponibles"})}),(0,t.jsx)(l.CardContent,{children:(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:N.available})})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsx)(l.CardHeader,{className:"pb-3",children:(0,t.jsx)(l.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"En utilisation"})}),(0,t.jsx)(l.CardContent,{children:(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:N.in_use})})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsx)(l.CardHeader,{className:"pb-3",children:(0,t.jsx)(l.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Maintenance"})}),(0,t.jsx)(l.CardContent,{children:(0,t.jsx)("p",{className:"text-2xl font-bold text-amber-600",children:N.maintenance})})]}),(0,t.jsxs)(l.Card,{children:[(0,t.jsx)(l.CardHeader,{className:"pb-3",children:(0,t.jsx)(l.CardTitle,{className:"text-sm font-medium text-muted-foreground",children:"Capacité totale"})}),(0,t.jsx)(l.CardContent,{children:(0,t.jsxs)("p",{className:"text-2xl font-bold",children:[N.total_available," / ",N.total_capacity]})})]})]}),(0,t.jsx)(l.Card,{children:(0,t.jsxs)(l.CardContent,{className:"pt-6",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(P.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(c.Input,{placeholder:"Rechercher par nom, description ou localisation...",value:u,onChange:e=>m(e.target.value),className:"pl-10"})]})}),(0,t.jsx)("div",{className:"w-full md:w-48",children:(0,t.jsx)("select",{value:h,onChange:e=>p(e.target.value),className:"w-full px-4 py-2 border-2 border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",children:C.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})}),(0,t.jsx)("div",{className:"w-full md:w-48",children:(0,t.jsx)("select",{value:_,onChange:e=>x(e.target.value),className:"w-full px-4 py-2 border-2 border-input rounded-lg focus:ring-2 focus:ring-primary focus:border-primary transition-colors",children:S.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})})]}),(u||h||_)&&(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-4",children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Filtres actifs:"}),u&&(0,t.jsxs)(o.Badge,{variant:"outline",children:["Recherche: ",u,(0,t.jsx)("button",{onClick:()=>m(""),className:"ml-2",children:"×"})]}),h&&(0,t.jsxs)(o.Badge,{variant:"outline",children:[C.find(e=>e.value===h)?.label,(0,t.jsx)("button",{onClick:()=>p(""),className:"ml-2",children:"×"})]}),_&&(0,t.jsxs)(o.Badge,{variant:"outline",children:[S.find(e=>e.value===_)?.label,(0,t.jsx)("button",{onClick:()=>x(""),className:"ml-2",children:"×"})]})]})]})}),w?(0,t.jsx)(l.Card,{children:(0,t.jsx)(l.CardContent,{className:"p-6",children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Chargement des équipements..."})})}):0===q.length?(0,t.jsx)(l.Card,{children:(0,t.jsxs)(l.CardContent,{className:"p-12 text-center",children:[(0,t.jsx)(d.Package,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Aucun équipement trouvé"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:0===j.length?"Commencez par ajouter votre premier équipement adapté":"Aucun équipement ne correspond à vos critères de recherche"}),0===j.length&&(0,t.jsxs)(r.Button,{onClick:()=>b(!0),children:[(0,t.jsx)(T.Plus,{className:"h-4 w-4 mr-2"}),"Ajouter un équipement"]})]})}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:q.map(e=>(0,t.jsx)(g,{equipment:e,onEdit:()=>{v(e),b(!0)},showActions:!0},e.id))}),(0,t.jsx)(D.Dialog,{open:y,onOpenChange:b,children:(0,t.jsxs)(D.DialogContent,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(D.DialogHeader,{children:[(0,t.jsx)(D.DialogTitle,{children:f?"Modifier l'équipement":"Nouvel équipement"}),(0,t.jsx)(D.DialogDescription,{children:f?"Modifiez les informations de l'équipement":"Ajoutez un nouvel équipement adapté à votre inventaire"})]}),(0,t.jsx)(A,{organizationId:e.organization_id||"",equipmentId:f?.id,initialData:f,onSuccess:z,onCancel:z})]})})]}):(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Chargement..."})})}e.s(["default",()=>z],703526)}]);