(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,107233,e=>{"use strict";let t=(0,e.i(475254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],107233)},503116,e=>{"use strict";let t=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],503116)},286536,e=>{"use strict";let t=(0,e.i(475254).default)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],286536)},62870,e=>{"use strict";var t=e.i(843476),s=e.i(271645),i=e.i(647163);e.i(882205);var a=e.i(846932),r=e.i(88653),n=e.i(664659),l=e.i(898791);s.forwardRef(({className:e,label:c,error:o,helperText:d,variant:u="default",leftIcon:m,id:g,options:h,placeholder:p,value:x,...f},v)=>{let[y,_]=s.useState(!1),[b,w]=s.useState(!1),j=g||`select-${Math.random().toString(36).substr(2,9)}`,S=(0,i.cn)("flex w-full rounded-lg font-medium transition-all duration-300","appearance-none cursor-pointer","focus:outline-none focus:ring-2 focus:ring-primary/20","disabled:cursor-not-allowed disabled:opacity-50",{"border-2 border-input bg-background px-4 py-3 pr-11":"default"===u,"focus:border-primary focus:bg-white":"default"===u&&!o,"border-destructive focus:border-destructive focus:ring-destructive/20":o,"border-2 border-input bg-transparent px-4 py-3 pr-11":"outlined"===u,"focus:border-primary focus:shadow-md focus:shadow-primary/10":"outlined"===u&&!o,"border-0 border-b-2 border-input bg-muted/50 px-4 py-3 pr-11 rounded-b-none":"filled"===u,"focus:bg-muted focus:border-primary":"filled"===u&&!o,"focus:border-destructive bg-destructive/5":"filled"===u&&o},m&&"pl-11",e);return(0,t.jsxs)("div",{className:"w-full space-y-1.5",children:[c&&(0,t.jsxs)(a.motion.label,{htmlFor:j,initial:!1,animate:{color:o?"#EF4444":y?"rgb(37, 99, 235)":"rgb(107, 114, 128)"},className:(0,i.cn)("block text-sm font-medium transition-colors duration-200",o&&"text-destructive"),children:[c,f.required&&(0,t.jsx)("span",{className:"text-destructive ml-1",children:"*"})]}),(0,t.jsxs)("div",{className:"relative",children:[m&&(0,t.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground pointer-events-none z-10",children:m}),(0,t.jsxs)(a.motion.select,{ref:v,id:j,value:x,...f,onFocus:e=>{_(!0),f.onFocus?.(e)},onBlur:e=>{_(!1),w(!1),f.onBlur?.(e)},onMouseDown:()=>w(!b),className:S,animate:{scale:y?1.01:1,borderColor:o?"#EF4444":y?"rgb(37, 99, 235)":"rgb(226, 232, 240)"},transition:{duration:.2},children:[p&&(0,t.jsx)("option",{value:"",disabled:!0,children:p}),(h||[]).map(e=>(0,t.jsx)("option",{value:e.value,disabled:e.disabled,children:e.label},e.value))]}),(0,t.jsx)(a.motion.div,{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-muted-foreground",animate:{rotate:180*!!b},transition:{duration:.2},children:(0,t.jsx)(n.ChevronDown,{className:"h-5 w-5"})}),o&&(0,t.jsx)(a.motion.div,{className:"absolute right-11 top-1/2 -translate-y-1/2 pointer-events-none",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:(0,t.jsx)(l.AlertCircle,{className:"h-5 w-5 text-destructive"})})]}),(0,t.jsx)(r.AnimatePresence,{mode:"wait",children:(o||d)&&(0,t.jsx)(a.motion.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},transition:{duration:.2},className:(0,i.cn)("text-xs transition-colors duration-200",o?"text-destructive":"text-muted-foreground"),children:o||d})})]})}).displayName="SelectNative";let c=s.createContext({}),o=s.forwardRef(({value:e,onValueChange:i,children:a},r)=>{let[n,l]=s.useState(!1);return(0,t.jsx)(c.Provider,{value:{value:e,onValueChange:i,open:n,setOpen:l},children:(0,t.jsx)("div",{className:"relative",ref:r,children:a})})});o.displayName="SelectRoot";let d=s.forwardRef(({children:e,className:a,...r},l)=>{let{open:o,setOpen:d}=s.useContext(c);return(0,t.jsxs)("button",{ref:l,type:"button",className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),onClick:()=>d?.(!o),...r,children:[e,(0,t.jsx)(n.ChevronDown,{className:(0,i.cn)("h-4 w-4 opacity-50 transition-transform",o&&"rotate-180")})]})});d.displayName="SelectTrigger";let u=s.forwardRef(({placeholder:e},i)=>{let{value:a}=s.useContext(c);return(0,t.jsx)("span",{ref:i,children:a||e})});u.displayName="SelectValue";let m=s.forwardRef(({children:e},i)=>{let a=s.useContext(c);return a?.open&&e?(0,t.jsx)("div",{ref:i,className:"absolute top-full left-0 z-50 mt-1 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md",children:(0,t.jsx)("div",{className:"p-1",children:e})}):null});m.displayName="SelectContent";let g=s.forwardRef(({value:e,children:a,className:r,...n},l)=>{let{value:o,onValueChange:d,setOpen:u}=s.useContext(c),m=o===e;return(0,t.jsx)("div",{ref:l,role:"option","aria-selected":m,className:(0,i.cn)("relative flex w-full cursor-pointer select-none items-center rounded-sm py-1.5 px-2 text-sm outline-none hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground",m&&"bg-accent text-accent-foreground",r),onClick:()=>{d?.(e),u?.(!1)},...n,children:a})});g.displayName="SelectItem",e.s(["Select",0,o,"SelectContent",0,m,"SelectItem",0,g,"SelectRoot",0,o,"SelectTrigger",0,d,"SelectValue",0,u])},240078,e=>{"use strict";var t=e.i(920755);let s=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getPolicies(e,t){let s=this.supabase.from("security_policies").select("*, approved_by_user:users!security_policies_approved_by_fkey(id, full_name, email)").or(`organization_id.eq.${e},organization_id.is.null`);t?.status&&(s=s.eq("status",t.status)),t?.category&&(s=s.eq("category",t.category));let{data:i,error:a}=await s.order("created_at",{ascending:!1});if(a)throw a;return i}async createPolicy(e){let{data:t,error:s}=await this.supabase.from("security_policies").insert(e).select().single();if(s)throw s;return t}async updatePolicy(e,t){let{data:s,error:i}=await this.supabase.from("security_policies").update(t).eq("id",e).select().single();if(i)throw i;return s}async approvePolicy(e,t){return this.updatePolicy(e,{approval_status:"approved",approved_by:t,approved_at:new Date().toISOString(),status:"active"})}async getControls(e,t){let s=this.supabase.from("security_controls").select("*").eq("organization_id",e);t?.framework&&(s=s.eq("framework",t.framework)),t?.status&&(s=s.eq("implementation_status",t.status));let{data:i,error:a}=await s.order("control_id",{ascending:!0});if(a)throw a;return i}async createControl(e){let{data:t,error:s}=await this.supabase.from("security_controls").insert(e).select().single();if(s)throw s;return t}async updateControl(e,t){let{data:s,error:i}=await this.supabase.from("security_controls").update(t).eq("id",e).select().single();if(i)throw i;return s}async getControlComplianceStats(e,t){let s=await this.getControls(e,{framework:t}),i={total:s.length,implemented:s.filter(e=>"implemented"===e.implementation_status).length,partial:s.filter(e=>"partial"===e.implementation_status).length,not_implemented:s.filter(e=>"not_implemented"===e.implementation_status).length,compliant:s.filter(e=>"compliant"===e.compliance_status).length,partially_compliant:s.filter(e=>"partially_compliant"===e.compliance_status).length,non_compliant:s.filter(e=>"non_compliant"===e.compliance_status).length,compliance_percentage:0};return i.total>0&&(i.compliance_percentage=i.compliant/i.total*100),i}async getEvidence(e){let{data:t,error:s}=await this.supabase.from("compliance_evidence").select("*, collected_by_user:users!compliance_evidence_collected_by_fkey(id, full_name, email), verified_by_user:users!compliance_evidence_verified_by_fkey(id, full_name, email)").eq("control_id",e).order("collected_at",{ascending:!1});if(s)throw s;return t}async createEvidence(e){let{data:t,error:s}=await this.supabase.from("compliance_evidence").insert(e).select().single();if(s)throw s;return t}async verifyEvidence(e,t){let{data:s,error:i}=await this.supabase.from("compliance_evidence").update({verified_by:t,verified_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;return s}async getRisks(e,t){let s=this.supabase.from("risk_assessments").select("*, owner:users(id, full_name, email)").eq("organization_id",e);t?.treatmentStatus&&(s=s.eq("treatment_status",t.treatmentStatus)),t?.riskLevel&&(s=s.eq("risk_level",t.riskLevel));let{data:i,error:a}=await s.order("risk_level",{ascending:!1});if(a){if("PGRST200"===a.code||404===a.status||400===a.status||a.message?.includes("does not exist"))return[];throw a}return i||[]}async createRisk(e){let{data:t,error:s}=await this.supabase.from("risk_assessments").insert(e).select().single();if(s)throw s;return t}async updateRisk(e,t){let{data:s,error:i}=await this.supabase.from("risk_assessments").update(t).eq("id",e).select().single();if(i)throw i;return s}async getCriticalRisks(e){return this.getRisks(e,{riskLevel:"critical",treatmentStatus:"open"})}async getIncidents(e,t){let s=this.supabase.from("security_incidents").select("*, reported_by_user:users(id, full_name, email), assigned_to_user:users(id, full_name, email)").eq("organization_id",e);t?.status&&(s=s.eq("status",t.status)),t?.severity&&(s=s.eq("severity",t.severity));let{data:i,error:a}=await s.order("created_at",{ascending:!1});if(a){if("PGRST200"===a.code||404===a.status||400===a.status||a.message?.includes("does not exist"))return[];throw a}return i||[]}async createIncident(e){let t=`INC-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,{data:s,error:i}=await this.supabase.from("security_incidents").insert({...e,incident_id:t}).select().single();if(i)throw i;return s}async updateIncident(e,t){let{data:s,error:i}=await this.supabase.from("security_incidents").update(t).eq("id",e).select().single();if(i)throw i;return s}async resolveIncident(e,t,s){return this.updateIncident(e,{status:"resolved",resolution:t,root_cause:s,resolved_at:new Date().toISOString()})}async getAudits(e,t){let s=this.supabase.from("security_audits").select("*").eq("organization_id",e);t?.status&&(s=s.eq("status",t.status)),t?.framework&&(s=s.eq("framework",t.framework));let{data:i,error:a}=await s.order("start_date",{ascending:!1});if(a)throw a;return i}async createAudit(e){let t=`AUDIT-${Date.now()}-${Math.random().toString(36).substr(2,9).toUpperCase()}`,{data:s,error:i}=await this.supabase.from("security_audits").insert({...e,audit_id:t}).select().single();if(i)throw i;return s}async getAuditFindings(e){let{data:t,error:s}=await this.supabase.from("audit_findings").select("*, assigned_to_user:users!audit_findings_assigned_to_fkey(id, full_name, email), control:security_controls(*)").eq("audit_id",e).order("severity",{ascending:!1});if(s)throw s;return t}async createAuditFinding(e){let{data:t,error:s}=await this.supabase.from("audit_findings").insert(e).select().single();if(s)throw s;return t}async getTrainings(e){let{data:t,error:s}=await this.supabase.from("security_training").select("*").eq("organization_id",e).eq("is_active",!0).order("created_at",{ascending:!1});if(s)throw s;return t}async getTrainingRecords(e){let{data:t,error:s}=await this.supabase.from("security_training_records").select("*, training:security_training(*)").eq("user_id",e).order("created_at",{ascending:!1});if(s)throw s;return t}async createTrainingRecord(e){let{data:t,error:s}=await this.supabase.from("security_training_records").insert(e).select().single();if(s)throw s;return t}async completeTraining(e,t){let{data:s,error:i}=await this.supabase.from("security_training_records").update({status:"completed",completion_percentage:100,score:t,completed_at:new Date().toISOString()}).eq("id",e).select().single();if(i)throw i;return s}async logAccess(e){let{data:t,error:s}=await this.supabase.from("access_logs").insert(e).select().single();if(s)throw s;return t}async getAccessLogs(e,t){let s=this.supabase.from("access_logs").select("*, user:users(id, full_name, email)").eq("organization_id",e);t?.userId&&(s=s.eq("user_id",t.userId)),t?.action&&(s=s.eq("action",t.action)),t?.startDate&&(s=s.gte("created_at",t.startDate.toISOString())),t?.endDate&&(s=s.lte("created_at",t.endDate.toISOString()));let{data:i,error:a}=await s.order("created_at",{ascending:!1}).limit(1e3);if(a)throw a;return i}async generateComplianceReport(e,t){await this.getControls(e,{framework:t});let s=await this.getRisks(e),i=await this.getIncidents(e),a=await this.getAudits(e,{framework:t}),r=await this.getControlComplianceStats(e,t),n=s.filter(e=>"critical"===e.risk_level&&"open"===e.treatment_status),l=i.filter(e=>"resolved"!==e.status&&"closed"!==e.status),c=a.filter(e=>{let t=new Date(e.start_date),s=new Date;return s.setMonth(s.getMonth()-6),t>=s});return{framework:t||"all",generated_at:new Date().toISOString(),controls:{total:r.total,compliance_percentage:r.compliance_percentage,implemented:r.implemented,partial:r.partial,not_implemented:r.not_implemented,compliant:r.compliant,partially_compliant:r.partially_compliant,non_compliant:r.non_compliant},risks:{total:s.length,critical:n.length,high:s.filter(e=>"high"===e.risk_level&&"open"===e.treatment_status).length,medium:s.filter(e=>"medium"===e.risk_level&&"open"===e.treatment_status).length,low:s.filter(e=>"low"===e.risk_level&&"open"===e.treatment_status).length,mitigated:s.filter(e=>"mitigated"===e.treatment_status).length},incidents:{total:i.length,open:l.length,critical:i.filter(e=>"critical"===e.severity&&"resolved"!==e.status).length,data_breaches:i.filter(e=>e.data_breach).length},audits:{total:a.length,recent:c.length,average_score:a.length>0?a.reduce((e,t)=>e+(t.overall_score||0),0)/a.length:0,average_compliance:a.length>0?a.reduce((e,t)=>e+(t.compliance_percentage||0),0)/a.length:0},recommendations:this.generateRecommendations(r,n,l)}}generateRecommendations(e,t,s){let i=[];return e.compliance_percentage<80&&i.push(`Le pourcentage de conformit\xe9 est de ${e.compliance_percentage.toFixed(1)}%. Il est recommand\xe9 d'am\xe9liorer l'impl\xe9mentation des contr\xf4les.`),t.length>0&&i.push(`${t.length} risque(s) critique(s) ouvert(s) n\xe9cessitent une attention imm\xe9diate.`),s.filter(e=>"critical"===e.severity).length>0&&i.push("Des incidents critiques sont en cours. Une intervention immédiate est requise."),e.not_implemented>0&&i.push(`${e.not_implemented} contr\xf4le(s) ne sont pas encore impl\xe9ment\xe9s.`),0===i.length&&i.push("Aucune recommandation urgente. La conformité est bonne."),i}};e.s(["complianceService",0,s])},169096,e=>{"use strict";var t=e.i(843476),s=e.i(271645),i=e.i(266027),a=e.i(954616),r=e.i(912598),n=e.i(325715),l=e.i(240078),c=e.i(970065),o=e.i(167881),d=e.i(23750),u=e.i(10708),m=e.i(184762),g=e.i(994179),h=e.i(630374),p=e.i(62870),x=e.i(898791),f=e.i(107233),v=e.i(555436),y=e.i(465286),_=e.i(503116),b=e.i(286536),w=e.i(98919),j=e.i(522016),S=e.i(647163);function C(){let{user:e}=(0,n.useAuth)(),C=(0,r.useQueryClient)(),[N,I]=(0,s.useState)(""),[k,q]=(0,s.useState)("all"),[D,T]=(0,s.useState)("all"),[R,z]=(0,s.useState)(!1),[A,M]=(0,s.useState)({title:"",description:"",category:"unauthorized_access",severity:"medium",detected_at:new Date().toISOString().split("T")[0]}),{data:P}=(0,i.useQuery)({queryKey:["security-incidents",e?.organization_id,k,D],queryFn:()=>l.complianceService.getIncidents(e?.organization_id||"",{status:"all"===k?void 0:k,severity:"all"===D?void 0:D}),enabled:!!e?.organization_id}),F=P?.filter(e=>!N||!!e.title.toLowerCase().includes(N.toLowerCase())||!!e.incident_id.toLowerCase().includes(N.toLowerCase())),L=(0,a.useMutation)({mutationFn:()=>l.complianceService.createIncident({...A,organization_id:e?.organization_id||"",reported_by:e?.id||"",detected_at:new Date(A.detected_at).toISOString()}),onSuccess:()=>{C.invalidateQueries({queryKey:["security-incidents"]}),z(!1),M({title:"",description:"",category:"unauthorized_access",severity:"medium",detected_at:new Date().toISOString().split("T")[0]})}}),O={low:"bg-gray-100 text-gray-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-orange-100 text-orange-800",critical:"bg-red-100 text-red-800"},V={open:"bg-red-100 text-red-800",investigating:"bg-yellow-100 text-yellow-800",contained:"bg-blue-100 text-blue-800",resolved:"bg-green-100 text-green-800",closed:"bg-gray-100 text-gray-800"},B={data_breach:"Violation de données",malware:"Malware",unauthorized_access:"Accès non autorisé",ddos:"DDoS",phishing:"Phishing",insider_threat:"Menace interne",physical_security:"Sécurité physique",other:"Autre"};return(0,t.jsxs)("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[(0,t.jsxs)("div",{className:"mb-8 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold mb-2 flex items-center gap-2",children:[(0,t.jsx)(x.AlertCircle,{className:"h-8 w-8"}),"Incidents de sécurité"]}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Gestion des incidents et violations de sécurité"})]}),(0,t.jsxs)(h.Dialog,{open:R,onOpenChange:z,children:[(0,t.jsx)(h.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(o.Button,{children:[(0,t.jsx)(f.Plus,{className:"h-4 w-4 mr-2"}),"Nouvel incident"]})}),(0,t.jsxs)(h.DialogContent,{className:"max-w-2xl",children:[(0,t.jsxs)(h.DialogHeader,{children:[(0,t.jsx)(h.DialogTitle,{children:"Signaler un incident de sécurité"}),(0,t.jsx)(h.DialogDescription,{children:"Enregistrez un nouvel incident de sécurité pour votre organisation"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Catégorie"}),(0,t.jsxs)(p.Select,{value:A.category,onValueChange:e=>M({...A,category:e}),children:[(0,t.jsx)(p.SelectTrigger,{children:(0,t.jsx)(p.SelectValue,{})}),(0,t.jsxs)(p.SelectContent,{children:[(0,t.jsx)(p.SelectItem,{value:"data_breach",children:"Violation de données"}),(0,t.jsx)(p.SelectItem,{value:"malware",children:"Malware"}),(0,t.jsx)(p.SelectItem,{value:"unauthorized_access",children:"Accès non autorisé"}),(0,t.jsx)(p.SelectItem,{value:"ddos",children:"DDoS"}),(0,t.jsx)(p.SelectItem,{value:"phishing",children:"Phishing"}),(0,t.jsx)(p.SelectItem,{value:"insider_threat",children:"Menace interne"}),(0,t.jsx)(p.SelectItem,{value:"physical_security",children:"Sécurité physique"}),(0,t.jsx)(p.SelectItem,{value:"other",children:"Autre"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Sévérité"}),(0,t.jsxs)(p.Select,{value:A.severity,onValueChange:e=>M({...A,severity:e}),children:[(0,t.jsx)(p.SelectTrigger,{children:(0,t.jsx)(p.SelectValue,{})}),(0,t.jsxs)(p.SelectContent,{children:[(0,t.jsx)(p.SelectItem,{value:"low",children:"Faible"}),(0,t.jsx)(p.SelectItem,{value:"medium",children:"Moyenne"}),(0,t.jsx)(p.SelectItem,{value:"high",children:"Élevée"}),(0,t.jsx)(p.SelectItem,{value:"critical",children:"Critique"})]})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Titre"}),(0,t.jsx)(d.Input,{value:A.title,onChange:e=>M({...A,title:e.target.value}),placeholder:"Titre de l'incident"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Description"}),(0,t.jsx)(m.Textarea,{value:A.description,onChange:e=>M({...A,description:e.target.value}),placeholder:"Description détaillée de l'incident",rows:4})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(u.Label,{children:"Date de détection"}),(0,t.jsx)(d.Input,{type:"date",value:A.detected_at,onChange:e=>M({...A,detected_at:e.target.value})})]}),(0,t.jsx)(o.Button,{onClick:()=>L.mutate(),disabled:!A.title,className:"w-full",children:"Signaler l'incident"})]})]})]})]}),(0,t.jsxs)("div",{className:"mb-6 flex gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)(v.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-muted-foreground"}),(0,t.jsx)(d.Input,{placeholder:"Rechercher un incident...",value:N,onChange:e=>I(e.target.value),className:"pl-10"})]}),(0,t.jsxs)(p.Select,{value:k,onValueChange:q,children:[(0,t.jsx)(p.SelectTrigger,{className:"w-48",children:(0,t.jsx)(p.SelectValue,{})}),(0,t.jsxs)(p.SelectContent,{children:[(0,t.jsx)(p.SelectItem,{value:"all",children:"Tous les statuts"}),(0,t.jsx)(p.SelectItem,{value:"open",children:"Ouvert"}),(0,t.jsx)(p.SelectItem,{value:"investigating",children:"En investigation"}),(0,t.jsx)(p.SelectItem,{value:"contained",children:"Contenu"}),(0,t.jsx)(p.SelectItem,{value:"resolved",children:"Résolu"}),(0,t.jsx)(p.SelectItem,{value:"closed",children:"Fermé"})]})]}),(0,t.jsxs)(p.Select,{value:D,onValueChange:T,children:[(0,t.jsx)(p.SelectTrigger,{className:"w-40",children:(0,t.jsx)(p.SelectValue,{})}),(0,t.jsxs)(p.SelectContent,{children:[(0,t.jsx)(p.SelectItem,{value:"all",children:"Toutes les sévérités"}),(0,t.jsx)(p.SelectItem,{value:"critical",children:"Critique"}),(0,t.jsx)(p.SelectItem,{value:"high",children:"Élevée"}),(0,t.jsx)(p.SelectItem,{value:"medium",children:"Moyenne"}),(0,t.jsx)(p.SelectItem,{value:"low",children:"Faible"})]})]})]}),F&&F.length>0?(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4",children:F.map(e=>(0,t.jsxs)(c.Card,{className:"critical"===e.severity?"border-red-200":"",children:[(0,t.jsx)(c.CardHeader,{children:(0,t.jsx)("div",{className:"flex items-start justify-between",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(c.CardTitle,{className:"text-lg",children:e.title}),(0,t.jsx)(g.Badge,{variant:"outline",children:e.incident_id}),(0,t.jsxs)(g.Badge,{className:O[e.severity]||"bg-gray-100 text-gray-800",children:[(0,t.jsx)(w.Shield,{className:"h-3 w-3 mr-1"}),"critical"===e.severity?"Critique":"high"===e.severity?"Élevée":"medium"===e.severity?"Moyenne":"Faible"]}),(0,t.jsxs)(g.Badge,{className:V[e.status]||"bg-gray-100 text-gray-800",children:["open"===e.status?(0,t.jsx)(_.Clock,{className:"h-3 w-3 mr-1"}):"resolved"===e.status?(0,t.jsx)(y.CheckCircle2,{className:"h-3 w-3 mr-1"}):(0,t.jsx)(_.Clock,{className:"h-3 w-3 mr-1"}),"open"===e.status?"Ouvert":"investigating"===e.status?"En investigation":"contained"===e.status?"Contenu":"resolved"===e.status?"Résolu":"Fermé"]})]}),e.description&&(0,t.jsx)(c.CardDescription,{className:"mt-2",children:e.description})]})})}),(0,t.jsx)(c.CardContent,{children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Catégorie: "}),(0,t.jsx)(g.Badge,{variant:"outline",children:B[e.category]||e.category})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Détecté le: "}),(0,t.jsx)("span",{className:"text-sm",children:(0,S.formatDate)(e.detected_at)})]}),e.data_breach&&(0,t.jsx)(g.Badge,{className:"bg-red-100 text-red-800",children:"Violation de données"}),e.personal_data_affected&&(0,t.jsx)(g.Badge,{className:"bg-orange-100 text-orange-800",children:"Données personnelles affectées"})]}),e.assigned_to_user&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Assigné à: "}),(0,t.jsx)("span",{className:"text-sm",children:e.assigned_to_user.full_name||e.assigned_to_user.email})]}),(0,t.jsx)("div",{className:"flex items-center gap-2 pt-2",children:(0,t.jsx)(j.default,{href:`/dashboard/compliance/incidents/${e.id}`,children:(0,t.jsxs)(o.Button,{variant:"outline",size:"sm",children:[(0,t.jsx)(b.Eye,{className:"h-4 w-4 mr-2"}),"Voir les détails"]})})})]})})]},e.id))}):(0,t.jsx)(c.Card,{children:(0,t.jsxs)(c.CardContent,{className:"pt-6 text-center text-muted-foreground",children:["Aucun incident trouvé. ",N&&"Essayez une autre recherche."]})})]})}e.s(["default",()=>C])}]);