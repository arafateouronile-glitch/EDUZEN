(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,871689,e=>{"use strict";let t=(0,e.i(475254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],871689)},503116,e=>{"use strict";let t=(0,e.i(475254).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);e.s(["Clock",()=>t],503116)},605631,e=>{"use strict";let t=(0,e.i(475254).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],605631)},356909,e=>{"use strict";let t=(0,e.i(475254).default)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);e.s(["Save",()=>t],356909)},738308,e=>{"use strict";let t=(0,e.i(475254).default)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>t],738308)},246704,779478,e=>{"use strict";var t,r,s=e.i(790224),a=((t={}).AUTH_REQUIRED="AUTH_1001",t.AUTH_INVALID_CREDENTIALS="AUTH_1002",t.AUTH_SESSION_EXPIRED="AUTH_1003",t.AUTH_INSUFFICIENT_PERMISSIONS="AUTH_1004",t.AUTH_2FA_REQUIRED="AUTH_1005",t.AUTH_2FA_INVALID="AUTH_1006",t.VALIDATION_ERROR="VALID_2001",t.VALIDATION_REQUIRED_FIELD="VALID_2002",t.VALIDATION_INVALID_FORMAT="VALID_2003",t.VALIDATION_UNIQUE_CONSTRAINT="VALID_2004",t.DB_CONNECTION_ERROR="DB_3001",t.DB_QUERY_ERROR="DB_3002",t.DB_NOT_FOUND="DB_3003",t.DB_CONSTRAINT_VIOLATION="DB_3004",t.DB_FOREIGN_KEY_CONSTRAINT="DB_3006",t.DB_RLS_POLICY_VIOLATION="DB_3005",t.NETWORK_ERROR="NET_4001",t.API_TIMEOUT="NET_4002",t.API_RATE_LIMIT="NET_4003",t.API_SERVER_ERROR="NET_4004",t.API_NOT_FOUND="NET_4005",t.API_BAD_REQUEST="NET_4006",t.BUSINESS_LOGIC_ERROR="BIZ_5001",t.RESOURCE_LOCKED="BIZ_5002",t.OPERATION_NOT_ALLOWED="BIZ_5003",t.QUOTA_EXCEEDED="BIZ_5004",t.INTERNAL_ERROR="SYS_6001",t.CONFIGURATION_ERROR="SYS_6002",t.SERVICE_UNAVAILABLE="SYS_6003",t);(r={}).LOW="low",r.MEDIUM="medium",r.HIGH="high",r.CRITICAL="critical";class i extends Error{code;severity;userMessage;retryable;context;originalError;constructor(e,t="SYS_6001",r="medium",s={},a){super(e),this.name="AppError",this.code=t,this.severity=r,this.userMessage=s.userMessage||this.getDefaultUserMessage(t),this.retryable=s.retryable??this.isRetryable(t),this.context={...s,code:t,severity:r,timestamp:new Date().toISOString()},this.originalError=a,Error.captureStackTrace&&Error.captureStackTrace(this,i)}getDefaultUserMessage(e){return({AUTH_1001:"Vous devez être connecté pour effectuer cette action.",AUTH_1002:"Email ou mot de passe incorrect.",AUTH_1003:"Votre session a expiré. Veuillez vous reconnecter.",AUTH_1004:"Vous n'avez pas les permissions nécessaires.",AUTH_1005:"Authentification à deux facteurs requise.",AUTH_1006:"Code d'authentification invalide.",VALID_2001:"Les données fournies ne sont pas valides.",VALID_2002:"Certains champs obligatoires sont manquants.",VALID_2003:"Le format des données est incorrect.",VALID_2004:"Cette valeur existe déjà.",DB_3001:"Impossible de se connecter à la base de données.",DB_3002:"Erreur lors de l'exécution de la requête.",DB_3003:"Ressource introuvable.",DB_3004:"Cette opération viole une contrainte de la base de données.",DB_3006:"Cette opération viole une contrainte de clé étrangère.",DB_3005:"Vous n'avez pas accès à cette ressource.",NET_4001:"Erreur de connexion réseau. Vérifiez votre connexion internet.",NET_4002:"La requête a pris trop de temps. Veuillez réessayer.",NET_4003:"Trop de requêtes. Veuillez patienter quelques instants.",NET_4004:"Erreur serveur. Veuillez réessayer plus tard.",NET_4005:"Ressource introuvable.",NET_4006:"Requête invalide.",BIZ_5001:"Cette opération n'est pas autorisée dans le contexte actuel.",BIZ_5002:"Cette ressource est actuellement verrouillée.",BIZ_5003:"Cette opération n'est pas autorisée.",BIZ_5004:"Vous avez atteint la limite autorisée.",SYS_6001:"Une erreur interne est survenue. Veuillez réessayer.",SYS_6002:"Erreur de configuration du système.",SYS_6003:"Service temporairement indisponible."})[e]||"Une erreur inattendue est survenue."}isRetryable(e){return["NET_4001","NET_4002","NET_4004","DB_3001","SYS_6003"].includes(e)}toJSON(){return{name:this.name,message:this.message,code:this.code,severity:this.severity,userMessage:this.userMessage,retryable:this.retryable,context:this.context,stack:this.stack,originalError:this.originalError instanceof Error?{name:this.originalError.name,message:this.originalError.message,stack:this.originalError.stack}:this.originalError}}}let n=new class{handleError(e,t={}){if(e instanceof i)return this.logError(e),e;if(e instanceof Error)return this.handleStandardError(e,t);if(this.isSupabaseError(e))return this.handleSupabaseError(e,t);let r=new i("Une erreur inattendue est survenue.","SYS_6001","high",t,e);return this.logError(r),r}handleStandardError(e,t){let r=e.message.toLowerCase(),s="SYS_6001",a="medium";r.includes("network")||r.includes("fetch")?(s="NET_4001",a="medium"):r.includes("timeout")?(s="NET_4002",a="medium"):r.includes("unauthorized")||r.includes("401")?(s="AUTH_1001",a="high"):r.includes("forbidden")||r.includes("403")?(s="AUTH_1004",a="high"):r.includes("not found")||r.includes("404")?(s="DB_3003",a="low"):(r.includes("validation")||r.includes("invalid"))&&(s="VALID_2001",a="low");let n=new i(e.message,s,a,t,e);return this.logError(n),n}handleSupabaseError(e,t){let r=e.code||e.status,s=e.message||"Erreur Supabase",a=t.code||"DB_3002",n="medium";if(!t.code)switch(r){case"PGRST116":case"42P01":a="DB_3003",n="low";break;case"42501":a="DB_3005",n="high";break;case"23505":a="VALID_2004",n="low";break;case"23503":a="DB_3004",n="medium";break;case"PGRST301":case"400":a="NET_4006",n="low";break;case"401":a="AUTH_1001",n="high";break;case"403":a="AUTH_1004",n="high";break;case"404":a="NET_4005",n="low";break;case"500":a="NET_4004",n="high"}"DB_3006"===a&&(n="medium");let o=new i(s,a,n,t,e);return this.logError(o),o}isSupabaseError(e){return e&&(e.code||e.status||e.message)&&("string"==typeof e.code||"number"==typeof e.status)}logError(e){let t={...e.context,code:e.code,severity:e.severity,retryable:e.retryable};switch(e.severity){case"critical":case"high":s.logger.error(e.message,e.originalError||e,t);break;case"medium":s.logger.warn(e.message,t);break;case"low":s.logger.info(`Error: ${e.message}`,t)}}createValidationError(e,t){return new i(e,"VALID_2001","low",{field:t,userMessage:e})}createAuthError(e,t){return new i(t||"Erreur d'authentification",e,"high")}createDatabaseError(e,t){return new i(e,"DB_3002","medium",{},t)}createNotFoundError(e,t){return new i(e,"DB_3003","low",t)}};e.s(["AppError",()=>i,"ErrorCode",()=>a,"errorHandler",0,n],779478),e.s([],246704)},627404,e=>{"use strict";e.i(246704);var t=e.i(779478);async function r(e,r,s,a){try{let i=e.from(r).select(a?.select||"*").eq("organization_id",s);a?.filters&&Object.entries(a.filters).forEach(([e,t])=>{null!=t&&(i=i.eq(e,t))}),a?.search&&(i=i.ilike(a.search.field,`%${a.search.value}%`)),i=a?.orderBy?i.order(a.orderBy.column,{ascending:a.orderBy.ascending??!1}):i.order("created_at",{ascending:!1});let{data:n,error:o}=await i;if(o)throw t.errorHandler.handleError(o,{organizationId:s,operation:"getAllByOrganization",table:r});return n||[]}catch(e){if(e instanceof t.AppError)throw e;throw t.errorHandler.handleError(e,{organizationId:s,operation:"getAllByOrganization",table:r})}}async function s(e,r,s,a){try{let{data:i,error:n}=await e.from(r).select(a||"*").eq("id",s).single();if(n){if("PGRST116"===n.code||"42P01"===n.code)throw t.errorHandler.handleError(n,{code:t.ErrorCode.DB_NOT_FOUND,operation:"getById",id:s,table:r});throw t.errorHandler.handleError(n,{operation:"getById",id:s,table:r})}if(!i)throw t.errorHandler.createDatabaseError(`Enregistrement avec l'ID ${s} introuvable dans ${r}`,{id:s,table:r});return i}catch(e){if(e instanceof t.AppError)throw e;throw t.errorHandler.handleError(e,{operation:"getById",id:s,table:r})}}e.s(["getAllByOrganization",()=>r,"getById",()=>s])},2034,e=>{"use strict";var t=e.i(920755);let r=async(e,t)=>(console.warn("videoconferenceService.createMeetingForSession not implemented"),null),s=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getAllSessions(e,t){let r=this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",e);t?.formationId&&(r=r.eq("formation_id",t.formationId)),t?.status&&(r=r.eq("status",t.status)),t?.startDate&&(r=r.gte("start_date",t.startDate)),t?.endDate&&(r=r.lte("end_date",t.endDate)),t?.search&&(r=r.ilike("name",`%${t.search}%`));let{data:s,error:a}=await r.order("start_date",{ascending:!0});if(a)throw a;return s}async getSessionById(e){let{data:t,error:r}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("id",e).single();if(r)throw r;let{data:s,error:a}=await this.supabase.from("session_programs").select(`
        program_id,
        programs(*)
      `).eq("session_id",e);if(a)throw a;return{...t,session_programs:s?.map(e=>e.programs).filter(Boolean)||[]}}async createSession(e,t,r){if(e.formation_id){let{data:t,error:r}=await this.supabase.from("formations").select("id, organization_id").eq("id",e.formation_id).single();if(r)throw console.error("Erreur lors de la vérification de la formation:",r),Error(`Formation non trouv\xe9e: ${r.message}`);if(!t)throw Error("Formation non trouvée");console.log("Formation trouvée:",t)}let{data:s,error:a}=await this.supabase.from("sessions").insert(e).select().single();if(a)throw console.error("Erreur RLS lors de la création de la session:",{code:a.code,message:a.message,details:a.details,hint:a.hint,formation_id:e.formation_id}),a;if(t&&t.length>0&&s){let{data:e}=await this.supabase.from("formations").select("organization_id").eq("id",s.formation_id).single();if(e){let r=t.map(t=>({session_id:s.id,program_id:t,organization_id:e.organization_id})),{error:a}=await this.supabase.from("session_programs").insert(r);a&&console.error("Erreur lors de la création des associations session-programme:",a),e.organization_id&&await this.syncWithCalendars(s.id,e.organization_id,"create").catch(e=>{console.error("Erreur lors de la synchronisation calendrier:",e)}),e.organization_id&&await this.createVideoconferenceMeeting(s.id,e.organization_id).catch(e=>{console.error("Erreur lors de la création de la réunion visioconférence:",e)})}}return console.log("Session créée avec succès:",s),s}async updateSessionPrograms(e,t,r){let{error:s}=await this.supabase.from("session_programs").delete().eq("session_id",e);if(s)throw s;if(t.length>0){let s=t.map(t=>({session_id:e,program_id:t,organization_id:r})),{error:a}=await this.supabase.from("session_programs").insert(s);if(a)throw a}return!0}async getSessionPrograms(e){let{data:t,error:r}=await this.supabase.from("session_programs").select(`
        program_id,
        programs(*)
      `).eq("session_id",e);if(r)throw r;return t?.map(e=>e.programs).filter(Boolean)||[]}async updateSession(e,t){let{data:r}=await this.supabase.from("sessions").select("formation_id, formations(organization_id)").eq("id",e).single(),{data:s,error:a}=await this.supabase.from("sessions").update(t).eq("id",e).select().single();if(a)throw a;let i=r?.formations;return r&&i?.organization_id&&await this.syncWithCalendars(e,i.organization_id,"update").catch(e=>{console.error("Erreur lors de la synchronisation calendrier:",e)}),s}async deleteSession(e){let{data:t}=await this.supabase.from("sessions").select("formation_id, formations(organization_id)").eq("id",e).single(),r=t?.formations;t&&r?.organization_id&&await this.syncWithCalendars(e,r.organization_id,"delete").catch(e=>{console.error("Erreur lors de la suppression de l'événement calendrier:",e)});let{error:s}=await this.supabase.from("sessions").delete().eq("id",e);if(s)throw s}async createVideoconferenceMeeting(e,t){let{data:s}=await this.supabase.from("videoconference_integrations").select("*").eq("organization_id",t).eq("is_active",!0).eq("auto_create_meetings",!0);if(s&&0!==s.length)for(let a of s)try{await r(e,{organizationId:t,provider:a.provider})}catch(e){console.error(`Erreur lors de la cr\xe9ation de r\xe9union avec ${a.provider}:`,e)}}async syncWithCalendars(e,t,r){let{data:s}=await this.supabase.from("calendar_integrations").select("*").eq("organization_id",t).eq("is_active",!0).eq("sync_sessions",!0).eq("create_events_for_sessions",!0);if(s&&0!==s.length)for(let e of s)try{console.warn(`Calendar sync for ${r} not implemented yet for provider ${e.provider}`)}catch(t){console.error(`Erreur lors de la synchronisation avec ${e.provider}:`,t)}}async getUpcomingSessions(e,t=10){let r=new Date().toISOString().split("T")[0],{data:s,error:a}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",e).gte("start_date",r).eq("status","planned").order("start_date",{ascending:!0}).limit(t);if(a)throw a;return s}async getOngoingSessions(e){let t=new Date().toISOString().split("T")[0],{data:r,error:s}=await this.supabase.from("sessions").select(`
        *,
        formations!inner(
          *,
          programs(*)
        )
      `).eq("formations.organization_id",e).lte("start_date",t).gte("end_date",t).eq("status","ongoing").order("start_date",{ascending:!0});if(s)throw s;return r}async addSessionToFormations(e,t,r){let s=t.map((t,s)=>({session_id:e,formation_id:t,organization_id:r,order_index:s})),{data:a,error:i}=await this.supabase.from("formation_sessions").insert(s).select();if(i)throw i;return a}async removeSessionFromFormation(e,t){let{error:r}=await this.supabase.from("formation_sessions").delete().eq("session_id",e).eq("formation_id",t);if(r)throw r;return!0}async updateSessionFormations(e,t,r){let{error:s}=await this.supabase.from("formation_sessions").delete().eq("session_id",e);if(s)throw s;return t.length>0?this.addSessionToFormations(e,t,r):[]}async getSessionFormations(e){let{data:t,error:r}=await this.supabase.from("formation_sessions").select(`
        formation_id,
        order_index,
        formations(*)
      `).eq("session_id",e).order("order_index",{ascending:!0});if(r)throw r;return t?.map(e=>e.formations).filter(Boolean)||[]}async getFormationSessions(e){let{data:t,error:r}=await this.supabase.from("formation_sessions").select(`
        session_id,
        order_index,
        sessions(*)
      `).eq("formation_id",e).order("order_index",{ascending:!0});if(r)throw r;return t?.map(e=>e.sessions).filter(Boolean)||[]}async createIndependentSession(e,t,r){let{data:s,error:a}=await this.supabase.from("sessions").insert({...e,formation_id:null}).select().single();if(a)throw a;return t&&t.length>0&&s&&await this.updateSessionPrograms(s.id,t,e.organization_id),r&&r.length>0&&s&&await this.addSessionToFormations(s.id,r,e.organization_id),s}};e.s(["sessionService",0,s],2034)},51483,e=>{"use strict";var t=e.i(920755);e.i(246704);var r=e.i(779478),s=e.i(790224);let a=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getSignaturesByDocument(e){try{let{data:t,error:r}=await this.supabase.from("document_signatures").select(`
          *,
          signer:users!document_signatures_signer_id_fkey(id, full_name, email, role)
        `).eq("document_id",e).eq("status","signed").order("signed_at",{ascending:!0});if(r)throw r;return t||[]}catch(t){if(t instanceof r.AppError)throw t;throw r.errorHandler.handleError(t,{operation:"getSignaturesByDocument",documentId:e})}}async getSignatureById(e){try{let{data:t,error:s}=await this.supabase.from("document_signatures").select(`
          *,
          signer:users!document_signatures_signer_id_fkey(id, full_name, email, role),
          document:documents(id, title, organization_id)
        `).eq("id",e).single();if(s){if("PGRST116"===s.code)throw r.errorHandler.createNotFoundError(`Signature avec l'ID ${e} introuvable`,{signatureId:e});throw s}return t}catch(t){if(t instanceof r.AppError)throw t;throw r.errorHandler.handleError(t,{operation:"getSignatureById",signatureId:e})}}async getSignaturesByUser(e,t){try{let{data:r,error:s}=await this.supabase.from("document_signatures").select(`
          *,
          document:documents(id, title, type, organization_id)
        `).eq("signer_id",e).eq("organization_id",t).order("signed_at",{ascending:!1});if(s)throw s;return r||[]}catch(s){if(s instanceof r.AppError)throw s;throw r.errorHandler.handleError(s,{operation:"getSignaturesByUser",userId:e,organizationId:t})}}async getSignaturesBySession(e,t){try{let{data:r,error:s}=await this.supabase.from("enrollments").select("student_id").eq("session_id",e).in("status",["confirmed","completed","active"]);if(s)throw s;if(!r||0===r.length)return[];let a=r.map(e=>e.student_id).filter(Boolean),{data:i,error:n}=await this.supabase.from("documents").select("id").eq("organization_id",t).in("student_id",a);if(n)throw n;if(!i||0===i.length)return[];let o=i.map(e=>e.id),{data:l,error:d}=await this.supabase.from("document_signatures").select(`
          *,
          signer:users!document_signatures_signer_id_fkey(id, full_name, email, role),
          document:documents(id, title, type, student_id, students(id, first_name, last_name))
        `).in("document_id",o).eq("organization_id",t).order("signed_at",{ascending:!1});if(d)throw d;return l||[]}catch(s){if(s instanceof r.AppError)throw s;throw r.errorHandler.handleError(s,{operation:"getSignaturesBySession",sessionId:e,organizationId:t})}}async createSignature(e){try{let{data:t}=await this.supabase.auth.getUser();if(!t.user)throw r.errorHandler.createAuthError(r.ErrorCode.AUTH_REQUIRED,"Utilisateur non authentifié");let a=this.generateValidationCode(),i=null;i=navigator.userAgent;let n={document_id:e.documentId,organization_id:e.organizationId,signer_id:e.signerId,signature_data:e.signatureData,signature_type:e.signatureType||"handwritten",signer_name:e.signerName||t.user.user_metadata?.full_name||"Utilisateur",signer_email:e.signerEmail||t.user.email||null,signer_role:e.signerRole||null,position_x:e.positionX||null,position_y:e.positionY||null,width:e.width||200,height:e.height||80,page_number:e.pageNumber||1,status:"signed",is_valid:!0,validation_code:a,comment:e.comment||null,ip_address:null,user_agent:i},{data:o,error:l}=await this.supabase.from("document_signatures").insert(n).select(`
          *,
          signer:users!document_signatures_signer_id_fkey(id, full_name, email, role)
        `).single();if(l)throw l;return s.logger.info("Signature créée",{signatureId:o.id,documentId:e.documentId,signerId:e.signerId}),o}catch(t){if(t instanceof r.AppError)throw t;throw r.errorHandler.handleError(t,{operation:"createSignature",documentId:e.documentId,signerId:e.signerId})}}async updateSignature(e,t){try{let{data:s,error:a}=await this.supabase.from("document_signatures").update(t).eq("id",e).select().single();if(a){if("PGRST116"===a.code)throw r.errorHandler.createNotFoundError(`Signature avec l'ID ${e} introuvable`,{signatureId:e});throw a}return s}catch(t){if(t instanceof r.AppError)throw t;throw r.errorHandler.handleError(t,{operation:"updateSignature",signatureId:e})}}async revokeSignature(e,t){try{return this.updateSignature(e,{status:"revoked",is_valid:!1,comment:t||"Signature révoquée"})}catch(t){if(t instanceof r.AppError)throw t;throw r.errorHandler.handleError(t,{operation:"revokeSignature",signatureId:e})}}async deleteSignature(e){try{let{error:t}=await this.supabase.from("document_signatures").delete().eq("id",e);if(t)throw t;s.logger.info("Signature supprimée",{signatureId:e})}catch(t){if(t instanceof r.AppError)throw t;throw r.errorHandler.handleError(t,{operation:"deleteSignature",signatureId:e})}}async hasSignatures(e){try{let{count:t,error:r}=await this.supabase.from("document_signatures").select("*",{count:"exact",head:!0}).eq("document_id",e).eq("status","signed");if(r)throw r;return(t||0)>0}catch(t){if(t instanceof r.AppError)throw t;throw r.errorHandler.handleError(t,{operation:"hasSignatures",documentId:e})}}generateValidationCode(){let e=Date.now(),t=Math.random().toString(36).substring(2,15);return`${e}-${t}`}async validateSignature(e,t){try{let r=await this.getSignatureById(e);return r.validation_code===t&&!0===r.is_valid}catch(e){return!1}}};e.s(["signatureService",0,a])},849200,e=>{"use strict";var t=e.i(920755);e.i(246704);var r=e.i(779478),s=e.i(790224),a=e.i(627404);let i=new class{supabase;constructor(e){this.supabase=e||(0,t.createClient)()}async getAll(e,t){try{let r={};return t?.studentId&&(r.student_id=t.studentId),t?.classId&&(r.class_id=t.classId),t?.programSessionId&&(r.session_id=t.programSessionId),t?.date&&(r.date=t.date),t?.status&&(r.status=t.status),(0,a.getAllByOrganization)(this.supabase,"attendance",e,{select:"*, students(id, first_name, last_name, student_number), classes(id, name), sessions(id, title, start_time)",filters:r,orderBy:{column:"date",ascending:!1}})}catch(t){if(t instanceof r.AppError)throw t;throw r.errorHandler.handleError(t,{organizationId:e,operation:"getAll"})}}async getByClassAndDate(e,t){try{let{data:s,error:a}=await this.supabase.from("attendance").select("*, students(id, first_name, last_name, student_number)").eq("class_id",e).eq("date",t).order("students(last_name)",{ascending:!0});if(a)throw r.errorHandler.handleError(a,{operation:"getByClassAndDate",classId:e,date:t});return s||[]}catch(s){if(s instanceof r.AppError)throw s;throw r.errorHandler.handleError(s,{operation:"getByClassAndDate",classId:e,date:t})}}async getBySessionAndDate(e,t){try{let{data:s,error:a}=await this.supabase.from("attendance").select("*, students(id, first_name, last_name, student_number)").eq("session_id",e).eq("date",t).order("students(last_name)",{ascending:!0});if(a)throw r.errorHandler.handleError(a,{operation:"getBySessionAndDate",sessionId:e,date:t});return s||[]}catch(s){if(s instanceof r.AppError)throw s;throw r.errorHandler.handleError(s,{operation:"getBySessionAndDate",sessionId:e,date:t})}}async upsert(e){if(e.session_id&&(e.latitude||e.longitude)){let t=await this.validateLocation(e.session_id,e.latitude,e.longitude);if(!t.valid)throw r.errorHandler.createValidationError(t.error||"Localisation invalide","location");e.location_verified=t.verified}try{let{data:t,error:a}=await this.supabase.from("attendance").upsert(e,{onConflict:"student_id,class_id,session_id,date"}).select().single();if(a){if("42501"===a.code)throw r.errorHandler.handleError(a,{code:r.ErrorCode.DB_RLS_POLICY_VIOLATION,operation:"upsert"});throw r.errorHandler.handleError(a,{operation:"upsert",attendance:e})}return s.logger.info("Émargement créé/mis à jour avec succès",{id:t?.id,studentId:e.student_id,date:e.date}),t}catch(t){if(t instanceof r.AppError)throw t;throw r.errorHandler.handleError(t,{operation:"upsert",attendance:e})}}async validateLocation(e,t,r){if(!t||!r)return{valid:!1,verified:!1,error:"Coordonnées GPS manquantes"};let{data:s,error:a}=await this.supabase.from("sessions").select("latitude, longitude, require_location_for_attendance, allowed_attendance_radius_meters").eq("id",e).single();if(a||!s)return{valid:!1,verified:!1,error:"Session non trouvée"};if(!s.require_location_for_attendance)return{valid:!0,verified:!1};if(!s.latitude||!s.longitude)return{valid:!0,verified:!1,error:"Session sans coordonnées GPS"};let i=this.calculateDistance(s.latitude,s.longitude,t,r);return s.allowed_attendance_radius_meters&&i>s.allowed_attendance_radius_meters?{valid:!1,verified:!1,error:`Vous \xeates trop loin de la session (${Math.round(i)}m, maximum: ${s.allowed_attendance_radius_meters}m)`,distance:i}:{valid:!0,verified:!0,distance:i}}calculateDistance(e,t,r,s){let a=e*Math.PI/180,i=r*Math.PI/180,n=(r-e)*Math.PI/180,o=(s-t)*Math.PI/180,l=Math.sin(n/2)*Math.sin(n/2)+Math.cos(a)*Math.cos(i)*Math.sin(o/2)*Math.sin(o/2);return 2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6371e3}async update(e,t){try{let{data:a,error:i}=await this.supabase.from("attendance").update(t).eq("id",e).select().single();if(i){if("PGRST116"===i.code||"42P01"===i.code)throw r.errorHandler.handleError(i,{code:r.ErrorCode.DB_NOT_FOUND,operation:"update",id:e});if("42501"===i.code)throw r.errorHandler.handleError(i,{code:r.ErrorCode.DB_RLS_POLICY_VIOLATION,operation:"update",id:e});throw r.errorHandler.handleError(i,{operation:"update",id:e,updates:t})}if(!a)throw r.errorHandler.createDatabaseError(`\xc9margement avec l'ID ${e} introuvable pour la mise \xe0 jour`,{id:e});return s.logger.info("Émargement mis à jour avec succès",{id:e,updates:t}),a}catch(s){if(s instanceof r.AppError)throw s;throw r.errorHandler.handleError(s,{operation:"update",id:e,updates:t})}}async markMultiple(e,t){let a=t.map(t=>({organization_id:e,...t,late_minutes:t.late_minutes||0}));try{if(!t||0===t.length)throw r.errorHandler.createValidationError("Aucun enregistrement à marquer","records");let{data:i,error:n}=await this.supabase.from("attendance").upsert(a,{onConflict:"student_id,class_id,session_id,date"}).select();if(n)throw r.errorHandler.handleError(n,{operation:"markMultiple",organizationId:e,count:t.length});return s.logger.info("Présences marquées en masse avec succès",{organizationId:e,count:i?.length||0}),i||[]}catch(t){if(t instanceof r.AppError)throw t;throw r.errorHandler.handleError(t,{operation:"markMultiple",organizationId:e})}}async getStudentStats(e,t,s){let a=this.supabase.from("attendance").select("status, date").eq("student_id",e);t&&(a=a.gte("date",t)),s&&(a=a.lte("date",s));try{let{data:e,error:t}=await a;if(t)throw t;let r=e?.length||0,s=e?.filter(e=>"present"===e.status).length||0,i=e?.filter(e=>"absent"===e.status).length||0,n=e?.filter(e=>"late"===e.status).length||0,o=e?.filter(e=>"excused"===e.status).length||0;return{total:r,present:s,absent:i,late:n,excused:o,attendanceRate:r>0?s/r*100:0}}catch(t){if(t instanceof r.AppError)throw t;throw r.errorHandler.handleError(t,{operation:"getStudentStats",studentId:e})}}async getClassStats(e,t){let s=this.supabase.from("attendance").select("status").eq("class_id",e);t&&(s=s.eq("date",t));try{let{data:a,error:i}=await s;if(i)throw r.errorHandler.handleError(i,{operation:"getClassStats",classId:e,date:t});let n=a?.length||0,o=a?.filter(e=>"present"===e.status).length||0,l=a?.filter(e=>"absent"===e.status).length||0;return{total:n,present:o,absent:l,attendanceRate:n>0?o/n*100:0}}catch(t){if(t instanceof r.AppError)throw t;throw r.errorHandler.handleError(t,{operation:"getClassStats",classId:e})}}async saveTeacherSignature(e,t){return this.update(e,{teacher_signature_url:t})}};e.s(["attendanceService",0,i])},818451,e=>{"use strict";var t=e.i(843476),r=e.i(271645),s=e.i(618566),a=e.i(266027),i=e.i(954616),n=e.i(912598),o=e.i(920755),l=e.i(849200),d=e.i(2034),c=e.i(51483),u=e.i(325715),m=e.i(167881),h=e.i(10708),g=e.i(346897);let _=(0,e.i(475254).default)("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);var f=e.i(898791),p=e.i(605631);function x({onLocationChange:e,required:s=!1,sessionLocation:a}){let[i,n]=(0,r.useState)(null),[o,l]=(0,r.useState)(""),[d,c]=(0,r.useState)(!1),[u,x]=(0,r.useState)(null),[y,w]=(0,r.useState)(null);(0,r.useEffect)(()=>{s&&v()},[s]),(0,r.useEffect)(()=>{if(i&&a?.latitude&&a?.longitude){let e=E(a.latitude,a.longitude,i.latitude,i.longitude);w(e),a.radius&&e>a.radius?x(`Vous \xeates trop loin (${Math.round(e)}m, maximum: ${a.radius}m)`):x(null)}},[i,a]);let v=async()=>{if(c(!0),x(null),!navigator.geolocation){x("Géolocalisation non supportée par votre navigateur"),c(!1);return}navigator.geolocation.getCurrentPosition(async t=>{let r={latitude:t.coords.latitude,longitude:t.coords.longitude,accuracy:t.coords.accuracy};n(r);try{let t=await fetch(`/api/geolocation/reverse-geocode?latitude=${r.latitude}&longitude=${r.longitude}`);if(t.ok){let s=await t.json();l(s.address||""),e?.({...r,address:s.address})}else e?.(r)}catch(t){e?.(r)}c(!1)},e=>{x(`Erreur de g\xe9olocalisation: ${e.message}`),c(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},E=(e,t,r,s)=>{let a=e*Math.PI/180,i=r*Math.PI/180,n=(r-e)*Math.PI/180,o=(s-t)*Math.PI/180,l=Math.sin(n/2)*Math.sin(n/2)+Math.cos(a)*Math.cos(i)*Math.sin(o/2)*Math.sin(o/2);return 2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6371e3};return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(h.Label,{children:["Géolocalisation ",s&&"*"]}),i&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-green-600",children:[(0,t.jsx)(p.CheckCircle,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Localisation capturée"})]})]}),i?(0,t.jsxs)("div",{className:"space-y-2 p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(g.MapPin,{className:"h-4 w-4 text-primary"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:o||`${i.latitude.toFixed(6)}, ${i.longitude.toFixed(6)}`}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Précision: ",Math.round(i.accuracy),"m",null!==y&&a&&(0,t.jsxs)("span",{className:"ml-2",children:["• Distance: ",Math.round(y),"m",a.radius&&(0,t.jsxs)("span",{className:y>a.radius?"text-red-600":"text-green-600",children:[" ","(",y>a.radius?"hors zone":"dans la zone",")"]})]})]})]})]}),u&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-red-600",children:[(0,t.jsx)(f.AlertCircle,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:u})]}),(0,t.jsxs)(m.Button,{variant:"outline",size:"sm",onClick:v,disabled:d,children:[(0,t.jsx)(_,{className:"h-4 w-4 mr-2"}),d?"Mise à jour...":"Mettre à jour la localisation"]})]}):(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(m.Button,{variant:"outline",onClick:v,disabled:d,className:"w-full",children:[(0,t.jsx)(_,{className:"h-4 w-4 mr-2"}),d?"Récupération de la localisation...":"Capturer ma localisation"]}),u&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-red-600",children:[(0,t.jsx)(f.AlertCircle,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:u})]})]})]})}var y=e.i(970065),w=e.i(871689),v=e.i(356909),E=e.i(738308),b=e.i(503116),N=e.i(522016),S=e.i(647163),j=e.i(846696);function I(){let e=(0,s.useParams)(),c=(0,s.useSearchParams)();(0,s.useRouter)();let h=e.sessionId,g=c.get("date")||new Date().toISOString().split("T")[0],_=c.get("slotId")||"",{user:I}=(0,u.useAuth)(),C=(0,o.createClient)(),D=(0,n.useQueryClient)(),{data:T}=(0,a.useQuery)({queryKey:["session-slot",_],queryFn:async()=>{if(!_)return null;let{data:e,error:t}=await C.from("session_slots").select("*").eq("id",_).single();return t?(console.warn("Erreur récupération séance:",t),null):e},enabled:!!_}),{data:q}=(0,a.useQuery)({queryKey:["session",h],queryFn:async()=>await d.sessionService.getSessionById(h)}),{data:B}=(0,a.useQuery)({queryKey:["session-enrollments",h],queryFn:async()=>{let{data:e,error:t}=await C.from("enrollments").select("*, students(*)").eq("session_id",h).in("status",["confirmed","completed"]).order("students(last_name)",{ascending:!0});if(t)throw t;return e||[]}}),{data:R,refetch:H}=(0,a.useQuery)({queryKey:["attendance-session",h,g],queryFn:()=>l.attendanceService.getBySessionAndDate(h,g)}),[O,M]=(0,r.useState)({});(0,r.useEffect)(()=>{if(R&&B){let e={};R.forEach(t=>{e[t.student_id]={status:t.status,lateMinutes:t.late_minutes,notes:t.notes||""}}),B.forEach(t=>{let r=t.student_id;e[r]||(e[r]={status:"present",lateMinutes:0,notes:""})}),M(e)}else if(B){let e={};B.forEach(t=>{e[t.student_id]={status:"present",lateMinutes:0,notes:""}}),M(e)}},[R,B]);let z=(e,t,r)=>{M(s=>({...s,[e]:{...s[e],[t]:r}}))},k=(0,i.useMutation)({mutationFn:async()=>{if(!I?.organization_id||!B)throw Error("Données manquantes");let e=B.map(e=>({student_id:e.student_id,session_id:h,date:g,status:O[e.student_id]?.status||"present",late_minutes:O[e.student_id]?.lateMinutes||0,teacher_id:I.id,notes:O[e.student_id]?.notes||void 0}));return l.attendanceService.markMultiple(I.organization_id,e)},onSuccess:()=>{H(),D.invalidateQueries({queryKey:["recent-attendance"]}),D.invalidateQueries({queryKey:["attendance-stats"]}),D.invalidateQueries({queryKey:["attendance-period-stats"]}),D.invalidateQueries({queryKey:["attendance"]}),D.invalidateQueries({queryKey:["monthly-attendance-report"]}),D.invalidateQueries({queryKey:["yearly-attendance-report"]}),j.toast.success("Émargement enregistré avec succès",{description:`${Object.keys(O).length} pr\xe9sences enregistr\xe9es pour le ${(0,S.formatDate)(g)}`})},onError:e=>{j.toast.error("Erreur lors de l'enregistrement",{description:e.message})}}),L=B?.map(e=>e.students).filter(Boolean)||[],U=L.length>0?{total:L.length,present:Object.values(O).filter(e=>"present"===e.status).length,absent:Object.values(O).filter(e=>"absent"===e.status).length,late:Object.values(O).filter(e=>"late"===e.status).length,excused:Object.values(O).filter(e=>"excused"===e.status).length}:null;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(N.default,{href:"/dashboard/attendance",children:(0,t.jsx)(m.Button,{variant:"ghost",size:"icon",children:(0,t.jsx)(w.ArrowLeft,{className:"h-4 w-4"})})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:["Émargement - ",q?.name||"Session"]}),(0,t.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:[(0,S.formatDate)(g),T&&(0,t.jsxs)("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-brand-blue-ghost text-brand-blue",children:["morning"===T.time_slot?"Matin":"afternoon"===T.time_slot?"Après-midi":"Journée complète"," • ",T.start_time," - ",T.end_time]}),q?.location&&` - ${q.location}`,T?.location&&!q?.location&&` - ${T.location}`]})]})]}),(0,t.jsxs)(m.Button,{onClick:()=>k.mutate(),disabled:k.isPending,children:[(0,t.jsx)(v.Save,{className:"mr-2 h-4 w-4"}),k.isPending?"Enregistrement...":"Enregistrer"]})]}),U&&(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,t.jsx)(y.Card,{children:(0,t.jsx)(y.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:U.total}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total"})]})})}),(0,t.jsx)(y.Card,{children:(0,t.jsx)(y.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-success-primary",children:U.present}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Présents"})]})})}),(0,t.jsx)(y.Card,{children:(0,t.jsx)(y.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600",children:U.absent}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Absents"})]})})}),(0,t.jsx)(y.Card,{children:(0,t.jsx)(y.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-warning-primary",children:U.late}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"En retard"})]})})}),(0,t.jsx)(y.Card,{children:(0,t.jsx)(y.CardContent,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:U.excused}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Justifiés"})]})})})]}),(0,t.jsxs)(y.Card,{children:[(0,t.jsx)(y.CardHeader,{children:(0,t.jsx)(y.CardTitle,{children:"Liste des participants"})}),(0,t.jsx)(y.CardContent,{children:L.length>0?(0,t.jsx)("div",{className:"space-y-4",children:L.map(e=>{let r=O[e.id]||{status:"present",lateMinutes:0,notes:""};return(0,t.jsxs)("div",{className:"flex items-center space-x-4 p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:e.photo_url?(0,t.jsx)("img",{src:e.photo_url,alt:`${e.first_name} ${e.last_name}`,className:"h-12 w-12 rounded-full object-cover"}):(0,t.jsxs)("div",{className:"h-12 w-12 rounded-full bg-primary text-white flex items-center justify-center font-semibold",children:[e.first_name.charAt(0),e.last_name.charAt(0)]})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("h3",{className:"font-semibold truncate",children:[e.first_name," ",e.last_name]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.student_number}),q?.require_location_for_attendance&&(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(x,{required:!1,sessionLocation:q?.latitude&&q?.longitude?{latitude:q.latitude,longitude:q.longitude,radius:q.allowed_attendance_radius_meters||void 0}:void 0,onLocationChange:t=>{z(e.id,"latitude",t.latitude),z(e.id,"longitude",t.longitude),z(e.id,"location_accuracy",t.accuracy)}})})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"flex space-x-2",children:["present","absent","late","excused"].map(s=>(0,t.jsx)("button",{type:"button",onClick:()=>z(e.id,"status",s),className:`p-2 rounded-lg transition-colors min-touch-target touch-manipulation ${r.status===s?"bg-primary text-white":"bg-gray-100 hover:bg-gray-200"}`,title:(e=>{switch(e){case"present":return"Présent";case"absent":return"Absent";case"late":return"En retard";case"excused":return"Justifié"}})(s),children:(e=>{switch(e){case"present":return(0,t.jsx)(p.CheckCircle,{className:"h-5 w-5 text-success-primary"});case"absent":return(0,t.jsx)(E.XCircle,{className:"h-5 w-5 text-red-600"});case"late":return(0,t.jsx)(b.Clock,{className:"h-5 w-5 text-warning-primary"});case"excused":return(0,t.jsx)(f.AlertCircle,{className:"h-5 w-5 text-blue-600"})}})(s)},s))}),"late"===r.status&&(0,t.jsxs)("div",{className:"w-20",children:[(0,t.jsx)("input",{type:"number",min:"0",value:r.lateMinutes||0,onChange:t=>z(e.id,"lateMinutes",parseInt(t.target.value)||0),className:"w-full px-2 py-1 text-sm border rounded focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"min"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground text-center mt-1",children:"min"})]}),(0,t.jsx)("div",{className:"w-32",children:(0,t.jsx)("input",{type:"text",value:r.notes||"",onChange:t=>z(e.id,"notes",t.target.value),className:"w-full px-2 py-1 text-sm border rounded focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Notes..."})})]})]},e.id)})}):(0,t.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:"Aucun participant inscrit à cette session"})})]}),k.error&&(0,t.jsx)("div",{className:"bg-destructive/10 text-destructive px-4 py-3 rounded-lg text-sm",children:k.error instanceof Error?k.error.message:"Une erreur est survenue lors de l'enregistrement"}),h&&I?.organization_id&&(0,t.jsx)(A,{sessionId:h,organizationId:I.organization_id})]})}function A({sessionId:e,organizationId:r}){let{data:s,isLoading:i}=(0,a.useQuery)({queryKey:["session-signatures",e,r],queryFn:()=>c.signatureService.getSignaturesBySession(e,r),enabled:!!e&&!!r});return i?(0,t.jsxs)(y.Card,{className:"mt-6",children:[(0,t.jsx)(y.CardHeader,{children:(0,t.jsx)(y.CardTitle,{children:"Historique des signatures"})}),(0,t.jsx)(y.CardContent,{children:(0,t.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"Chargement..."})})]}):s&&0!==s.length?(0,t.jsxs)(y.Card,{className:"mt-6",children:[(0,t.jsxs)(y.CardHeader,{children:[(0,t.jsx)(y.CardTitle,{children:"Historique des signatures"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Signatures des documents liés aux étudiants de cette session (",s.length," signature(s))"]})]}),(0,t.jsx)(y.CardContent,{children:(0,t.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,t.jsxs)("div",{className:"flex items-start gap-4 p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-24 h-16 border rounded bg-white p-1.5 flex items-center justify-center",children:(0,t.jsx)("img",{src:e.signature_data,alt:`Signature de ${e.signer_name}`,className:"max-w-full max-h-full object-contain"})}),(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("p",{className:"font-semibold",children:e.signer_name||e.signer?.full_name||"Signataire inconnu"}),"signed"===e.status&&e.is_valid&&(0,t.jsx)(p.CheckCircle,{className:"h-4 w-4 text-green-600"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.signer_role||e.signer?.role||"Rôle non spécifié"}),e.document&&(0,t.jsxs)("p",{className:"text-sm font-medium mt-1",children:["Document : ",e.document.title||"Sans titre"]}),e.document?.students&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Étudiant : ",e.document.students.first_name," ",e.document.students.last_name]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Signé le ",(0,S.formatDate)(e.signed_at)]}),e.comment&&(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-2 italic border-l-2 border-muted pl-2",children:['"',e.comment,'"']})]})})})]},e.id))})})]}):null}e.s(["default",()=>I],818451)}]);